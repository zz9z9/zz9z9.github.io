[ { "title": "JPA / MyBatis í˜¼ìš©ì‹œ ì£¼ì˜ì‚¬í•­ (in ë°°ì¹˜ ì• í”Œë¦¬ì¼€ì´ì…˜)", "url": "/posts/cautions-when-jpa-mybatis-together/", "categories": "JPA", "tags": "JPA, Hibernate", "date": "2026-02-10 22:00:00 +0900", "snippet": " JPAì™€ MyBatisëŠ” ì„œë¡œì˜ ì¡´ì¬ë¥¼ ëª¨ë¥¸ë‹¤. MyBatisëŠ” JDBCë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ë¯€ë¡œ JPA ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ìš°íšŒí•˜ì—¬ DBë¥¼ ë³€ê²½í•˜ê³ , JPAëŠ” ì´ë¥¼ ê°ì§€í•  ìˆ˜ ì—†ë‹¤. ê²°ê³¼ì ìœ¼ë¡œ JPA 1ì°¨ ìºì‹œì—ëŠ” ë³€ê²½ ì „ ë°ì´í„°(stale data)ê°€ ë‚¨ê²Œ ë˜ì–´ ë°ì´í„° ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•œë‹¤.ë¬¸ì œ ìƒí™© ì˜ˆì‹œ1. ê°™ì€ ì—”í‹°í‹°ë¥¼ JPAë¡œ ì½ê³  MyBatisë¡œ U...", "content": " JPAì™€ MyBatisëŠ” ì„œë¡œì˜ ì¡´ì¬ë¥¼ ëª¨ë¥¸ë‹¤. MyBatisëŠ” JDBCë¥¼ ì§ì ‘ ì‚¬ìš©í•˜ë¯€ë¡œ JPA ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ìš°íšŒí•˜ì—¬ DBë¥¼ ë³€ê²½í•˜ê³ , JPAëŠ” ì´ë¥¼ ê°ì§€í•  ìˆ˜ ì—†ë‹¤. ê²°ê³¼ì ìœ¼ë¡œ JPA 1ì°¨ ìºì‹œì—ëŠ” ë³€ê²½ ì „ ë°ì´í„°(stale data)ê°€ ë‚¨ê²Œ ë˜ì–´ ë°ì´í„° ë¶ˆì¼ì¹˜ê°€ ë°œìƒí•œë‹¤.ë¬¸ì œ ìƒí™© ì˜ˆì‹œ1. ê°™ì€ ì—”í‹°í‹°ë¥¼ JPAë¡œ ì½ê³  MyBatisë¡œ UPDATE@Beanpublic Step problematicStep() { return stepBuilder(\"step\") .&lt;BatchTarget, BatchTarget&gt;chunk(100, transactionManager) .reader(jpaReader()) // JPAë¡œ ì½ìŒ â†’ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìºì‹œ .processor(processor()) .writer(myBatisWriter()) // MyBatisë¡œ UPDATE â†’ DBë§Œ ë³€ê²½ .listener(new StepExecutionListener() { @Override public ExitStatus afterStep(StepExecution stepExecution) { // ë¬¸ì œ: ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ëŠ” ë³€ê²½ ì „ ë°ì´í„°ê°€ ë‚¨ì•„ìˆìŒ BatchTarget target = batchTargetRepository.findById(1L).get(); log.info(\"status: {}\", target.getStatus()); // ë³€ê²½ ì „ ê°’! return ExitStatus.COMPLETED; } }) .build();} ì£¼ì˜: afterStepì€ Step ì „ì²´ê°€ ëë‚œ í›„ í˜¸ì¶œëœë‹¤. ì´ ì‹œì ì—ì„œ ì²­í¬ íŠ¸ëœì­ì…˜ì€ ì´ë¯¸ ì»¤ë°‹ë˜ì—ˆì§€ë§Œ, ê°™ì€ EntityManagerê°€ ì‚´ì•„ìˆê³  clear()ë˜ì§€ ì•Šì•˜ë‹¤ë©´ 1ì°¨ ìºì‹œì— stale ë°ì´í„°ê°€ ë‚¨ì•„ ìˆì„ ìˆ˜ ìˆë‹¤. ë°˜ëŒ€ë¡œ íŠ¸ëœì­ì…˜ ì»¤ë°‹ê³¼ í•¨ê»˜ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì •ë¦¬ëœ ê²½ìš°ì—ëŠ” DBì—ì„œ ìƒˆë¡œ ì¡°íšŒë˜ë¯€ë¡œ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. EntityManagerì˜ ë¼ì´í”„ì‚¬ì´í´ì„ ë°˜ë“œì‹œ í™•ì¸í•´ì•¼ í•œë‹¤.2. Processorì—ì„œ JPA ì¡°íšŒ â†’ Writerì—ì„œ MyBatis INSERT í›„ ì¬ì¡°íšŒ@Beanpublic ItemProcessor&lt;SourceRecord, BatchResult&gt; processor() { return record -&gt; { // JPAë¡œ ëŒ€ìƒ ì¡°íšŒ â†’ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìºì‹œë¨ BatchTarget target = batchTargetRepository.findById(record.getTargetId()).get(); return BatchResult.builder() .target(target) .amount(record.getAmount()) .build(); };}@Beanpublic MyBatisBatchItemWriter&lt;BatchResult&gt; writer() { // MyBatisë¡œ INSERT (target_id í¬í•¨) // ë§Œì•½ ì´ INSERTê°€ BatchTarget í…Œì´ë¸”ë„ UPDATE í•œë‹¤ë©´? // â†’ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ BatchTargetì€ stale ìƒíƒœ}ê°™ì€ ì²­í¬ ë‚´ ë‹¤ìŒ item ì²˜ë¦¬ ì‹œ:@Beanpublic ItemProcessor&lt;SourceRecord, BatchResult&gt; processor() { return record -&gt; { // 1ì°¨ ìºì‹œì—ì„œ ë°˜í™˜ â†’ DB ë³€ê²½ì‚¬í•­ ë°˜ì˜ ì•ˆ ë¨! BatchTarget target = batchTargetRepository.findById(record.getTargetId()).get(); // target.getProcessedCount()ê°€ MyBatisì—ì„œ ì¦ê°€í–ˆëŠ”ë° ë°˜ì˜ ì•ˆ ë¨ return BatchResult.builder() .target(target) .amount(record.getAmount()) .build(); };}3. CompositeItemWriterì—ì„œ JPA + MyBatis í˜¼ìš©@Beanpublic CompositeItemWriter&lt;BatchResult&gt; compositeWriter() { CompositeItemWriter&lt;BatchResult&gt; writer = new CompositeItemWriter&lt;&gt;(); writer.setDelegates(List.of( myBatisResultWriter(), // 1. MyBatisë¡œ result INSERT jpaTargetWriter() // 2. JPAë¡œ target UPDATE )); return writer;}@Beanpublic ItemWriter&lt;BatchResult&gt; jpaTargetWriter() { return items -&gt; { for (BatchResult result : items) { // ë¬¸ì œ: MyBatisê°€ INSERTí•œ resultë¥¼ JPAê°€ ëª¨ë¦„ // result.getTarget()ì´ ì˜ì† ìƒíƒœë©´ ì—°ê´€ê´€ê³„ ë¶ˆì¼ì¹˜ ê°€ëŠ¥ BatchTarget target = result.getTarget(); target.setLastProcessedAt(result.getProcessedAt()); batchTargetRepository.save(target); } };}4. Skip/Retry ë¡œì§ì—ì„œ JPA ì¡°íšŒ@Beanpublic Step stepWithRetry() { return stepBuilder(\"step\") .&lt;Input, Output&gt;chunk(100, transactionManager) .reader(reader()) .processor(processor()) .writer(myBatisWriter()) .faultTolerant() .retryLimit(3) .retry(DeadlockLoserDataAccessException.class) .listener(new RetryListener() { @Override public &lt;T, E extends Throwable&gt; void onError( RetryContext context, RetryCallback&lt;T, E&gt; callback, Throwable throwable ) { // Retry ì‹œ JPAë¡œ ìƒíƒœ í™•ì¸í•˜ë ¤ í•˜ë©´ // ì´ì „ MyBatis ì‘ì—… ê²°ê³¼ê°€ rollback ë˜ì—ˆëŠ”ì§€ JPAëŠ” ëª¨ë¦„ Entity entity = jpaRepository.findById(id).get(); // stale ê°€ëŠ¥ } }) .build();}5. ê°™ì€ ì²­í¬ ë‚´ì—ì„œ Reader ì¬ì¡°íšŒ (Cursor vs Paging)@Beanpublic Step pagingStep() { return stepBuilder(\"step\") .&lt;Order, OrderSettlement&gt;chunk(100, transactionManager) .reader(jpaPagingReader()) // page 1 ì½ìŒ â†’ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— 100ê°œ .processor(processor()) .writer(myBatisBatchWriter()) // MyBatisë¡œ ìƒíƒœ UPDATE // ë‹¤ìŒ ì²­í¬ì—ì„œ page 2 ì½ì„ ë•Œ // â†’ ìƒˆ ì¿¼ë¦¬ì§€ë§Œ, ê°™ì€ ë°ì´í„°ê°€ ìˆë‹¤ë©´? // â†’ 1ì°¨ ìºì‹œì—ì„œ ë°˜í™˜ë  ìˆ˜ ìˆìŒ (stale) .build();} ì •í™•í•œ ë™ì‘ ì¡°ê±´: Spring BatchëŠ” ì²­í¬ ë‹¨ìœ„ë¡œ íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•œë‹¤. JpaPagingItemReaderëŠ” ìì²´ EntityManagerë¥¼ ìƒì„±í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ëŒ€ë¶€ë¶„ì´ë¯€ë¡œ ì²­í¬ íŠ¸ëœì­ì…˜ì˜ EntityManagerì™€ëŠ” ë³„ê°œë¡œ ë™ì‘í•œë‹¤. ë”°ë¼ì„œ ì´ ë¬¸ì œëŠ” Readerì™€ Stepì´ ë™ì¼í•œ EntityManagerë¥¼ ê³µìœ í•˜ëŠ” ê²½ìš°ì—ë§Œ ë°œìƒí•œë‹¤. Readerê°€ ìì²´ EntityManagerë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ì²­í¬ ê°„ ìºì‹œ ì´ìŠˆëŠ” ë°œìƒí•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤. ì‚¬ìš© ì¤‘ì¸ Readerì˜ EntityManager ê´€ë¦¬ ë°©ì‹ì„ ë°˜ë“œì‹œ í™•ì¸í•´ì•¼ í•œë‹¤.ì•ˆì „í•˜ê²Œ ì‚¬ìš©í•˜ë ¤ë©´ë°©ë²• 1: ì²­í¬ë§ˆë‹¤ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ í´ë¦¬ì–´@Beanpublic Step safeStep() { return stepBuilder(\"step\") .&lt;Input, Output&gt;chunk(100, transactionManager) .reader(reader()) .writer(myBatisWriter()) .listener(new ChunkListener() { @Override public void afterChunk(ChunkContext context) { entityManager.clear(); // ì²­í¬ ì™„ë£Œ í›„ 1ì°¨ ìºì‹œ í´ë¦¬ì–´ } }) .build();} clear() ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­ clear ì´í›„ ê¸°ì¡´ ì˜ì† ì—”í‹°í‹°ëŠ” detached ìƒíƒœê°€ ëœë‹¤. Lazy Loading ì—°ê´€ê´€ê³„ ì ‘ê·¼ ì‹œ LazyInitializationExceptionì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ë°˜ë“œì‹œ ë‹¤ì‹œ ì¡°íšŒí•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.ë°©ë²• 2: Reader/Writer ì™„ì „ ë¶„ë¦¬ JPAë¡œ ì½ëŠ” ì—”í‹°í‹°ì™€ MyBatisë¡œ ì“°ëŠ” ì—”í‹°í‹°ê°€ ì™„ì „íˆ ë‹¤ë¥´ê³  ì—°ê´€ê´€ê³„ê°€ ì—†ë‹¤ë©´ ì•ˆì „í•˜ë‹¤. ì„¤ê³„ ë‹¨ê³„ì—ì„œ ê°€ì¥ ë¨¼ì € ê³ ë ¤í•´ì•¼ í•  êµ¬ì¡°ì  í•´ê²°ì±…ì´ë‹¤.ë°©ë²• 3: JPA ë„¤ì´í‹°ë¸Œ ì¿¼ë¦¬ + ìë™ clear@Modifying(clearAutomatically = true, flushAutomatically = true)@Query(\"UPDATE batch_target SET status = :status WHERE id = :id\", nativeQuery = true)void updateStatus(@Param(\"id\") Long id, @Param(\"status\") String status); ì¿¼ë¦¬ ì‹¤í–‰ í›„ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ìë™ ì´ˆê¸°í™” MyBatisë¥¼ JPA ë„¤ì´í‹°ë¸Œ ì¿¼ë¦¬ë¡œ ëŒ€ì²´ ê°€ëŠ¥í•œ ê²½ìš° ê°€ì¥ ê°„ë‹¨í•œ í•´ê²°ì±…ë°©ë²• 4: í•œìª½ ê¸°ìˆ ë¡œ í†µì¼// Option A: MyBatisë¡œ í†µì¼@Beanpublic Step allMyBatisStep() { return stepBuilder(\"step\") .&lt;Map&lt;String, Object&gt;, BatchResult&gt;chunk(100, transactionManager) .reader(myBatisPagingReader()) .processor(processor()) .writer(myBatisBatchWriter()) .build();}// Option B: JPAë¡œ í†µì¼@Beanpublic Step allJpaStep() { return stepBuilder(\"step\") .&lt;BatchTarget, BatchResult&gt;chunk(100, transactionManager) .reader(jpaPagingReader()) .processor(processor()) .writer(jpaItemWriter()) .build();} ê°™ì€ í…Œì´ë¸”ì„ ì½ê³ /ì“°ëŠ” ê²½ìš° ë°˜ë“œì‹œ í•œìª½ìœ¼ë¡œ í†µì¼ ê°€ì¥ í™•ì‹¤í•˜ê³  ì•ˆì „í•œ í•´ê²°ì±…ë°©ë²• 5: TransactionManager í™•ì¸ JPAì™€ MyBatisê°€ ê°™ì€ DataSource / TransactionManagerë¥¼ ê³µìœ í•˜ëŠ”ì§€ ë°˜ë“œì‹œ í™•ì¸í•´ì•¼ í•œë‹¤. ì„œë¡œ ë‹¤ë¥¸ TransactionManagerë¥¼ ì‚¬ìš©í•˜ë©´ ìºì‹œ ë¬¸ì œë¥¼ ë„˜ì–´ íŠ¸ëœì­ì…˜ ì •í•©ì„± ë¬¸ì œë¡œ í™•ëŒ€ëœë‹¤.// ì˜ëª»ëœ ì˜ˆ: ì„œë¡œ ë‹¤ë¥¸ TransactionManager@Beanpublic PlatformTransactionManager jpaTransactionManager() { ... }@Beanpublic PlatformTransactionManager myBatisTransactionManager() { ... }// â†’ ì²­í¬ íŠ¸ëœì­ì…˜ì—ëŠ” í•˜ë‚˜ë§Œ ì°¸ì—¬ â†’ ì»¤ë°‹ ì‹œì  ë¶ˆì¼ì¹˜ ë°œìƒ// ì˜¬ë°”ë¥¸ ì˜ˆ: ë‹¨ì¼ TransactionManager@Beanpublic PlatformTransactionManager transactionManager(EntityManagerFactory emf) { return new JpaTransactionManager(emf);}// MyBatisë„ ê°™ì€ DataSource ì‚¬ìš© ì‹œ ë™ì¼ íŠ¸ëœì­ì…˜ ì°¸ì—¬ì •ë¦¬ ë°©ë²• ì ìš© ë‚œì´ë„ ì•ˆì „ì„± ë¹„ê³  ì²­í¬ë§ˆë‹¤ clear() ë‚®ìŒ ì¤‘ê°„ LazyInitializationException ì£¼ì˜ Reader/Writer ì—”í‹°í‹° ë¶„ë¦¬ ì¤‘ê°„ ë†’ìŒ ì„¤ê³„ ë‹¨ê³„ ê³ ë ¤ í•„ìš” @Modifying(clearAutomatically) ë‚®ìŒ ì¤‘ê°„ MyBatis ëŒ€ì²´ ê°€ëŠ¥ ì‹œ í•œìª½ ê¸°ìˆ ë¡œ í†µì¼ ë†’ìŒ ê°€ì¥ ë†’ìŒ ê°€ì¥ í™•ì‹¤í•œ í•´ê²°ì±… TransactionManager í†µì¼ ë‚®ìŒ í•„ìˆ˜ í˜¼ìš© ì‹œ ë°˜ë“œì‹œ í™•ì¸ " }, { "title": "ì´ìŠˆ - JpaItemWriterë¡œ ì—”í‹°í‹° ì €ì¥ì‹œ, ChunkSizeë§Œí¼ SELECT ì¿¼ë¦¬ ë°œìƒí•˜ëŠ” ìƒí™©", "url": "/posts/how-jpa-item-writer-merge-works/", "categories": "JPA", "tags": "JPA, Hibernate", "date": "2026-01-29 23:00:00 +0900", "snippet": "ìƒí™© ë°°ì¹˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ A í…Œì´ë¸”ì—ì„œ ì¡°íšŒ -&gt; ê°€ê³µ -&gt; B í…Œì´ë¸”ì— ì €ì¥ íë¦„ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì²­í¬ ê¸°ë°˜ì˜ Jobì´ ìˆìŒ B í…Œì´ë¸”ì— ì €ì¥ì‹œ JpaItemWriter ì‚¬ìš© B í…Œì´ë¸”ì— ì €ì¥í•˜ëŠ” ì—”í‹°í‹°ì˜ PKëŠ” A í…Œì´ë¸”ì˜ PKì™€ ë™ì¼. ì¦‰, A í…Œì´ë¸”ì—ì„œ ì¡°íšŒí•œ ì—”í‹°í‹°ì˜ PKê°€ ì‚¬ìš©ë¨ (Assigned ID + @Version ì—†ìŒ...", "content": "ìƒí™© ë°°ì¹˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ A í…Œì´ë¸”ì—ì„œ ì¡°íšŒ -&gt; ê°€ê³µ -&gt; B í…Œì´ë¸”ì— ì €ì¥ íë¦„ìœ¼ë¡œ ë™ì‘í•˜ëŠ” ì²­í¬ ê¸°ë°˜ì˜ Jobì´ ìˆìŒ B í…Œì´ë¸”ì— ì €ì¥ì‹œ JpaItemWriter ì‚¬ìš© B í…Œì´ë¸”ì— ì €ì¥í•˜ëŠ” ì—”í‹°í‹°ì˜ PKëŠ” A í…Œì´ë¸”ì˜ PKì™€ ë™ì¼. ì¦‰, A í…Œì´ë¸”ì—ì„œ ì¡°íšŒí•œ ì—”í‹°í‹°ì˜ PKê°€ ì‚¬ìš©ë¨ (Assigned ID + @Version ì—†ìŒ) ì €ì¥ì‹œ ChunkSize ë§Œí¼ì˜ SELECT ì¿¼ë¦¬ê°€ ë°œìƒí•¨ì›ì¸ íŒŒì•…ê²°ë¡  JpaItemWriterëŠ” ì—”í‹°í‹° ì €ì¥ì‹œ ê¸°ë³¸ì ìœ¼ë¡œ EntityManagerì˜ merge()ë¥¼ í˜¸ì¶œ (usePersistê°€ trueì¸ ê²½ìš°ëŠ” persist() í˜¸ì¶œ) merge()ëŠ” ì—”í‹°í‹°ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì—†ê³ , DB ì¡´ì¬ ì—¬ë¶€ë¥¼ íŒë‹¨í•  ìˆ˜ ì—†ëŠ” ê²½ìš° SELECTë¡œ ë¨¼ì € í™•ì¸ í›„ INSERT/UPDATEë¥¼ ê²°ì •í•  ìˆ˜ ìˆë‹¤SELECTê°€ ë°œìƒí•˜ëŠ” ëŒ€í‘œì ì¸ ìƒí™© assigned id version ì—†ìŒ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì—†ìŒ@Entity@Table(name = \"orders\")public class Order { @Id private String id; // â† assigned id private String status; // @Version ì—†ìŒ protected Order() {} public Order(String id, String status) { this.id = id; this.status = status; } public void changeStatus(String status) { this.status = status; }}@Transactionalpublic void detachedMerge(EntityManager em) { // ì´ë¯¸ DBì— ì¡´ì¬í•˜ëŠ” ì—”í‹°í‹° ì¡°íšŒ Order managed = em.find(Order.class, \"ORD-1\"); // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ë¹„ì›€ â†’ detached ìƒíƒœ em.clear(); // detached ê°ì²´ ìˆ˜ì • managed.changeStatus(\"DONE\"); // ë‹¤ì‹œ merge em.merge(managed); // â† ì—¬ê¸°ì„œ SELECT ê°€ëŠ¥}SELECTê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ” ëŒ€í‘œì ì¸ ìƒí™©ì´ë¯¸ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ìˆìŒ@Transactionalpublic void mergeWithoutSelect(EntityManager em) { // ì´ë¯¸ ì¡°íšŒë¨ â†’ ì˜ì† ìƒíƒœ Order managed = em.find(Order.class, \"ORD-1\"); // ê°’ ë³€ê²½ managed.changeStatus(\"DONE\"); // merge í˜¸ì¶œ em.merge(managed);}version ê¸°ë°˜@Entitypublic class Order { @Id private String id; @Version private Long version; private String status; protected Order() {} public Order(String id, String status) { this.id = id; this.status = status; }}@Transactionalpublic void mergeNewEntity(EntityManager em) { // version == null â†’ Hibernateê°€ \"ë¬´ì¡°ê±´ ìƒˆ ì—”í‹°í‹°\"ë¼ê³  íŒë‹¨ ê°€ëŠ¥ Order order = new Order(\"ORD-2\", \"READY\"); // merge í˜¸ì¶œ (ì„¤ëª… ëª©ì , ì‹¤ì œë¡œëŠ” ìƒˆ ì—”í‹°í‹°ì´ë¯€ë¡œ persist()ê°€ ë” ìì—°ìŠ¤ëŸ½ë‹¤.) // - DB ì¡´ì¬ ì—¬ë¶€ë¥¼ versionìœ¼ë¡œ íŒë‹¨ ê°€ëŠ¥ // - SELECT ì—†ì´ ë°”ë¡œ INSERT ìˆ˜í–‰ë¨ // - ì¦‰, ì´ ì¼€ì´ìŠ¤ì—ì„œëŠ” mergeë¼ë„ SELECT ë°œìƒí•˜ì§€ ì•ŠìŒ em.merge(order);}generated id ì „ëµ@Entitypublic class Order { @Id @GeneratedValue(strategy = GenerationType.SEQUENCE) // ë˜ëŠ” IDENTITY, AUTO private Long id; private String status;}@Transactionalpublic void mergeGeneratedId(EntityManager em) { // id == null â†’ Hibernateê°€ ìƒˆ ì—”í‹°í‹°ë¡œ í™•ì • ê°€ëŠ¥ Order order = new Order(); order.changeStatus(\"READY\"); // merge í˜¸ì¶œ (ì„¤ëª… ëª©ì , ì‹¤ì œë¡œëŠ” ìƒˆ ì—”í‹°í‹°ì´ë¯€ë¡œ persist()ê°€ ë” ìì—°ìŠ¤ëŸ½ë‹¤.) // - ID nullë§Œìœ¼ë¡œ unsaved íŒë‹¨ ê°€ëŠ¥ // - SELECT ì—†ì´ ë°”ë¡œ INSERT ìˆ˜í–‰ // - ë”°ë¼ì„œ ì´ ì¼€ì´ìŠ¤ë„ SELECT ë°œìƒí•˜ì§€ ì•ŠìŒ em.merge(order);}Assigned ID + @Versionì´ ì—†ëŠ” ì—”í‹°í‹° ì €ì¥ì‹œ ì½”ë“œ íë¦„ ì‚´í´ë³´ê¸°org.springframework.batch.item.database.JpaItemWriterâ””â”€â”€ entityManger.merge()â”‚â–¼org.hibernate.internal.SessionImplâ””â”€â”€ merge()â””â”€â”€ fireMerge()â”‚â–¼org.hibernate.event.internal.DefaultMergeEventListenerâ””â”€â”€ onMerge(MergeEvent)â””â”€â”€ onMerge(MergeEvent, MergeContext)â””â”€â”€ doMerge()â””â”€â”€ merge()â”‚â”œâ”€â”€ EntityState íŒë‹¨ (DETACHED / TRANSIENT / PERSISTENT)â”‚â–¼â””â”€â”€ entityIsDetached()â”‚â–¼source.get(entityName, id) âš ï¸ SELECT ë°œìƒ!â”‚â”œâ”€â”€ ê²°ê³¼ ì—†ìŒ â†’ entityIsTransient() â†’ INSERTâ””â”€â”€ ê²°ê³¼ ìˆìŒ â†’ copyValues() â†’ UPDATE1ë‹¨ê³„ : entityManger.merge()// org.springframework.batch.item.database.JpaItemWriterprotected void doWrite(EntityManager entityManager, Chunk&lt;? extends T&gt; items) { if (logger.isDebugEnabled()) { logger.debug(\"Writing to JPA with \" + items.size() + \" items.\"); } if (!items.isEmpty()) { long addedToContextCount = 0L; Chunk.ChunkIterator var5 = items.iterator(); while(var5.hasNext()) { T item = (T)var5.next(); if (!entityManager.contains(item)) { if (this.usePersist) { entityManager.persist(item); } else { entityManager.merge(item); } ++addedToContextCount; } } ... }}2ë‹¨ê³„ : merge() ì§„ì…ì // org.hibernate.internal.SessionImplpublic &lt;T&gt; T merge(T object) throws HibernateException { this.checkOpen(); return this.fireMerge(new MergeEvent((String) null, object, this));}private Object fireMerge(MergeEvent event) { // ... this.fastSessionServices.eventListenerGroup_MERGE .fireEventOnEachListener(event, MergeEventListener::onMerge); // ... return event.getResult();}3ë‹¨ê³„ : MergeEventListener í˜¸ì¶œ// org.hibernate.event.internal.DefaultMergeEventListenerpublic void onMerge(MergeEvent event) throws HibernateException { EventSource session = event.getSession(); EntityCopyObserver entityCopyObserver = this.createEntityCopyObserver(session); MergeContext mergeContext = new MergeContext(session, entityCopyObserver); try { // ì‹¤ì œ merge ì²˜ë¦¬ ì§„ì… this.onMerge(event, mergeContext); entityCopyObserver.topLevelMergeComplete(session); } finally { entityCopyObserver.clear(); mergeContext.clear(); }}public void onMerge(MergeEvent event, MergeContext copiedAlready) throws HibernateException { Object original = event.getOriginal(); if (original != null) { // proxy ì²´í¬ ë“± ì„ í–‰ ì²˜ë¦¬ (ìƒëµëœ ë¶€ë¶„) this.doMerge(event, copiedAlready, original); }}4ë‹¨ê³„ : EntityState íŒë‹¨// org.hibernate.event.internal.DefaultMergeEventListenerprivate void merge(MergeEvent event, MergeContext copiedAlready, Object entity) {EventSource source = event.getSession(); // org.hibernate.engine.spi.PersistenceContext PersistenceContext persistenceContext = source.getPersistenceContextInternal(); // org.hibernate.engine.spi.EntityEntry - 1ì°¨ ìºì‹œì—ì„œ ì¡°íšŒ EntityEntry entry = persistenceContext.getEntry(entity); EntityState entityState; if (entry == null) { // 1ì°¨ ìºì‹œì— ì—†ìŒ // org.hibernate.persister.entity.EntityPersister EntityPersister persister = source.getEntityPersister(event.getEntityName(), entity); originalId = persister.getIdentifier(entity, copiedAlready); if (originalId != null) { // IDê°€ ìˆìœ¼ë©´ EntityKey ìƒì„± í›„ ë‹¤ì‹œ í™•ì¸ // org.hibernate.engine.spi.EntityKey EntityKey entityKey = source.generateEntityKey(originalId, persister); Object managedEntity = persistenceContext.getEntity(entityKey); entry = persistenceContext.getEntry(managedEntity); if (entry != null) { entityState = EntityState.DETACHED; } else { // org.hibernate.event.internal.EntityState entityState = EntityState.getEntityState(entity, event.getEntityName(), entry, source, false); } } } // EntityStateì— ë”°ë¥¸ ë¶„ê¸° switch (entityState) { case DETACHED: this.entityIsDetached(event, copiedId, originalId, copiedAlready); // âš ï¸ SELECT ë°œìƒ break; case TRANSIENT: this.entityIsTransient(event, copiedId, copiedAlready); // SELECT ì—†ì´ INSERT break; case PERSISTENT: this.entityIsPersistent(event, copiedAlready); break; }} DETACHEDë¡œ íŒë³„ë˜ëŠ” ì´ìœ // org.hibernate.event.internal.EntityState#getEntityStatepublic static EntityState getEntityState(Object entity, String entityName, EntityEntry entry, SessionImplementor source, Boolean assumedUnsaved) { // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— EntityEntry ì¡´ì¬ ì—¬ë¶€ í™•ì¸ if (entry != null) { // â†’ ì´ë¯¸ ì˜ì† ìƒíƒœ (managed) if (entry.getStatus() != Status.DELETED) { return PERSISTENT; } return DELETED; } // Hibernateê°€ 'unsaved(= TRANSIENT)' ì—¬ë¶€ë¥¼ ë¨¼ì € íŒë‹¨ ì‹œë„ // í•µì‹¬ ë©”ì„œë“œ: // ForeignKeys.isTransient(...) // // ì—¬ê¸°ì„œ ë³´ëŠ” ê²ƒ: // - @Version ê°’ // - unsaved-value ì„¤ì • // - identifier generator ì „ëµ // - interceptor // // assigned id + @Version ì—†ìŒì´ë©´ // â†’ TRANSIENTë¼ê³  í™•ì •í•  ê·¼ê±°ê°€ ì—†ìŒ if (ForeignKeys.isTransient(entityName, entity, assumedUnsaved, source)) { // â†’ \"ìƒˆ ì—”í‹°í‹°\"ë¡œ í™•ì • ê°€ëŠ¥í•œ ê²½ìš°ë§Œ ì—¬ê¸°ë¡œ ë“¤ì–´ì˜´ // (ì˜ˆ: version == null, id == null ë“±) return TRANSIENT; } // ì‚­ì œëœ ì—”í‹°í‹° í‚¤ì¸ì§€ ì¶”ê°€ í™•ì¸ (íŠ¹ìˆ˜ ì¼€ì´ìŠ¤) final PersistenceContext persistenceContext = source.getPersistenceContextInternal(); if (persistenceContext.containsDeletedUnloadedEntityKeys()) { final EntityPersister entityPersister = source.getEntityPersister(entityName, entity); // assigned idì´ë¯€ë¡œ identifierëŠ” nullì´ ì•„ë‹˜ final Object identifier = entityPersister.getIdentifier(entity, source); final EntityKey entityKey = source.generateEntityKey(identifier, entityPersister); // \"ì‚­ì œëœ ìƒíƒœ\"ë¡œ í‘œì‹œëœ ì—”í‹°í‹°ì¸ì§€ í™•ì¸ if (persistenceContext.containsDeletedUnloadedEntityKey(entityKey)) { return EntityState.DELETED; } } // - PCì— ì—†ìŒ // - TRANSIENTë¼ê³  í™•ì • ëª»í•¨ // - ì‚­ì œ ìƒíƒœë„ ì•„ë‹˜ // // â‡’ Hibernate ê²°ë¡ : // \"DBì—ëŠ” ì¡´ì¬í•˜ëŠ” DETACHED ì—”í‹°í‹°ì¼ ê°€ëŠ¥ì„±ì´ ê°€ì¥ ë†’ë‹¤\" return DETACHED;}5ë‹¨ê³„: SELECT ë°œìƒ ì§€ì  (DETACHED ì²˜ë¦¬)// org.hibernate.event.internal.DefaultMergeEventListenerprotected void entityIsDetached(MergeEvent event, Object copiedId, Object originalId, MergeContext copyCache) { LOG.trace(\"Merging detached instance\"); Object entity = event.getEntity(); // org.hibernate.event.spi.EventSource EventSource source = event.getSession(); // org.hibernate.persister.entity.EntityPersister EntityPersister persister = source.getEntityPersister(event.getEntityName(), entity); Object clonedIdentifier = persister.getIdentifierType().deepCopy(originalId, event.getFactory()); // âš ï¸ï¸ SELECT ë°œìƒ ì§€ì  // org.hibernate.engine.spi.LoadQueryInfluencers Object result = source.getLoadQueryInfluencers() .fromInternalFetchProfile(CascadingFetchProfile.MERGE, () -&gt; { return source.get(entityName, clonedIdentifier); // DB ì¡°íšŒ! }); if (result == null) { // DBì— ì—†ìŒ // â†’ TRANSIENT ê²½ë¡œë¡œ ì „í™˜ (INSERT ëŒ€ìƒ ë“±ë¡) // â†’ ì‹¤ì œ INSERT SQLì€ flush ì‹œì ì— ì‹¤í–‰ë¨ LOG.trace(\"Detached instance not found in database\"); this.entityIsTransient(event, clonedIdentifier, copyCache); } else { // DBì— ìˆìŒ // â†’ ê¸°ì¡´ managed ì—”í‹°í‹°ì— ê°’ ë³µì‚¬ (UPDATE ëŒ€ìƒ ì¤€ë¹„) // â†’ ì‹¤ì œ UPDATE SQLì€ flush ì‹œì ì˜ dirty checking ì‹œ ì‹¤í–‰ë¨ copyCache.put(entity, result, true); this.copyValues(persister, entity, target, source, copyCache); event.setResult(result); }}" }, { "title": "JPA/Hibernate ID ìƒì„± ì „ëµ", "url": "/posts/jpa-id-generation-strategy/", "categories": "JPA", "tags": "JPA, Hibernate", "date": "2026-01-29 23:00:00 +0900", "snippet": "@GeneratedValue ê¸°ë³¸ í‚¤(primary key) ê°’ì˜ ìƒì„± ì „ëµì„ ì§€ì •í•˜ëŠ” ë° ì‚¬ìš© ì¦‰, ë°ì´í„°ë² ì´ìŠ¤ì— ìƒˆ ë ˆì½”ë“œë¥¼ ì‚½ì…í•  ë•Œ ê¸°ë³¸ í‚¤ ê°’ì„ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ì§€ì • @GeneratedValueëŠ” @Idì™€ í•¨ê»˜ ì—”í‹°í‹° ë˜ëŠ” ë§¤í•‘ëœ ìŠˆí¼í´ë˜ìŠ¤ì˜ ê¸°ë³¸ í‚¤ ì†ì„±ì´ë‚˜ í•„ë“œì— ì ìš©í•  ìˆ˜ ìˆë‹¤. @GeneratedValueëŠ” ë‹¨ìˆœ ê¸°ë³¸ í‚¤...", "content": "@GeneratedValue ê¸°ë³¸ í‚¤(primary key) ê°’ì˜ ìƒì„± ì „ëµì„ ì§€ì •í•˜ëŠ” ë° ì‚¬ìš© ì¦‰, ë°ì´í„°ë² ì´ìŠ¤ì— ìƒˆ ë ˆì½”ë“œë¥¼ ì‚½ì…í•  ë•Œ ê¸°ë³¸ í‚¤ ê°’ì„ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ë°©ë²•ì„ ì§€ì • @GeneratedValueëŠ” @Idì™€ í•¨ê»˜ ì—”í‹°í‹° ë˜ëŠ” ë§¤í•‘ëœ ìŠˆí¼í´ë˜ìŠ¤ì˜ ê¸°ë³¸ í‚¤ ì†ì„±ì´ë‚˜ í•„ë“œì— ì ìš©í•  ìˆ˜ ìˆë‹¤. @GeneratedValueëŠ” ë‹¨ìˆœ ê¸°ë³¸ í‚¤(ë‹¨ì¼ ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ì„±ëœ PK)ì— ëŒ€í•´ì„œë§Œ ì§€ì›ëœë‹¤. íŒŒìƒ ê¸°ë³¸ í‚¤(@MapsIdë¡œ ë‹¤ë¥¸ ì—”í‹°í‹°ë¡œë¶€í„° íŒŒìƒëœ PK)ì— ëŒ€í•œ @GeneratedValue ì‚¬ìš©ì€ ì§€ì›ë˜ì§€ ì•ŠëŠ”ë‹¤. ìƒì„± ì „ëµ ì „ëµ ì„¤ëª… AUTO JPA êµ¬í˜„ì²´ê°€ ì ì ˆí•œ ì „ëµì„ ìë™ ì„ íƒ IDENTITY DBì˜ auto_increment ì‚¬ìš© (MySQL ë“±) SEQUENCE DB ì‹œí€€ìŠ¤ ì‚¬ìš© (Oracle, PostgreSQL ë“±) TABLE ë³„ë„ì˜ í‚¤ ìƒì„± í…Œì´ë¸” ì‚¬ìš© // ì˜ˆì œ 1: ì‹œí€€ìŠ¤ ì „ëµ@Id@GeneratedValue(strategy=SEQUENCE, generator=\"CUST_SEQ\")@Column(name=\"CUST_ID\")public Long getId() { return id; }// â†’ \"CUST_SEQ\"ë¼ëŠ” ì‹œí€€ìŠ¤ë¡œ ID ìƒì„±// ì˜ˆì œ 2: í…Œì´ë¸” ì „ëµ@Id@GeneratedValue(strategy=TABLE, generator=\"CUST_GEN\")@Column(name=\"CUST_ID\")Long id;// â†’ \"CUST_GEN\"ì´ë¼ëŠ” í‚¤ ìƒì„± í…Œì´ë¸”ë¡œ ID ìƒì„±@MappedSuperclass ê³µí†µ í•„ë“œë¥¼ ìƒì†ì‹œí‚¤ê¸° ìœ„í•œ ë¶€ëª¨ í´ë˜ìŠ¤ ì´ í´ë˜ìŠ¤ ìì²´ëŠ” í…Œì´ë¸”ë¡œ ìƒì„±ë˜ì§€ ì•Šê³ , ìì‹ ì—”í‹°í‹°ë“¤ì´ í•„ë“œë¥¼ ë¬¼ë ¤ë°›ëŠ”ë‹¤. BaseEntityëŠ” í…Œì´ë¸”ì´ ìƒì„±ë˜ì§€ ì•ŠìŒ ê° ìì‹ ì—”í‹°í‹°ê°€ id í•„ë“œì™€ @GeneratedValue ì„¤ì •ì„ ê·¸ëŒ€ë¡œ ìƒì† ê³µí†µ í•„ë“œ(id, ìƒì„±ì¼, ìˆ˜ì •ì¼ ë“±)ë¥¼ í•œ ê³³ì—ì„œ ê´€ë¦¬í•  ìˆ˜ ìˆì–´ ì½”ë“œ ì¤‘ë³µ ì œê±°// ë§¤í•‘ëœ ìŠˆí¼í´ë˜ìŠ¤ (í…Œì´ë¸”ë¡œ ìƒì„±ë˜ì§€ ì•ŠìŒ)@MappedSuperclasspublic abstract class BaseEntity { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private Long id; // â† ì—¬ê¸°ì— @GeneratedValue ì ìš© private LocalDateTime createdAt; private LocalDateTime updatedAt; // getter, setter...}// ìì‹ ì—”í‹°í‹° 1@Entity@Table(name = \"users\")public class User extends BaseEntity {// id, createdAt, updatedAt í•„ë“œë¥¼ ìƒì†ë°›ìŒ private String username; private String email;}// ìì‹ ì—”í‹°í‹° 2@Entity@Table(name = \"products\")public class Product extends BaseEntity {// id, createdAt, updatedAt í•„ë“œë¥¼ ìƒì†ë°›ìŒ private String name; private int price;}@MapsId íŒŒìƒ ê¸°ë³¸ í‚¤ì˜ˆì‹œ Userì™€ UserProfileì´ 1:1 ê´€ê³„ì´ê³ , UserProfileì˜ PKê°€ Userì˜ PKë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©@Entitypublic class User { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private Long id; // PK ìë™ ìƒì„± private String username; @OneToOne(mappedBy = \"user\", cascade = CascadeType.ALL) private UserProfile profile;}@Entitypublic class UserProfile {@Idprivate Long id; // Userì˜ idë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš© (ìë™ ìƒì„± X) @OneToOne @MapsId // â† Userì˜ PKë¥¼ ì´ ì—”í‹°í‹°ì˜ PKë¡œ ë§¤í•‘ @JoinColumn(name = \"id\") private User user; private String bio; private String profileImageUrl;}ê²°ê³¼ í…Œì´ë¸” users Â  user_profile Â  id (PK) username id (PK, FK) bio 1 â€œkimâ€ 1 â€œì•ˆë…•í•˜ì„¸ìš”â€ 2 â€œleeâ€ 2 â€œë°˜ê°‘ìŠµë‹ˆë‹¤â€ â†’ UserProfile.idëŠ” í•­ìƒ User.idì™€ ë™ì¼í•œ ê°’ì™œ @GeneratedValueë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì„ê¹Œ ? íŒŒìƒ ê¸°ë³¸ í‚¤ëŠ” ì´ë¯¸ ê°’ì´ ì •í•´ì ¸ ìˆìœ¼ë¯€ë¡œ ìƒˆë¡œ ìƒì„±í•  í•„ìš”ê°€ ì—†ê³ , ìƒì„±í•˜ë©´ ì•ˆë¨// ì´ë ‡ê²Œ í•˜ë©´ ì•ˆ ë¨@Entitypublic class UserProfile { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) // ì¶©ëŒ! private Long id; @OneToOne @MapsId private User user;} @GeneratedValue: â€œë‚´ê°€ ìƒˆ ê°’ ë§Œë“¤ê²Œ!â€ (ì˜ˆ: 100) @MapsId: â€œUserì˜ id ê°’ ì¨!â€ (ì˜ˆ: 1)â†’ ë‘˜ ë‹¤ ì ìš©í•˜ë©´: idê°€ 100ì´ì–´ì•¼ í• ì§€, 1ì´ì–´ì•¼ í• ì§€ íŒë‹¨í•  ìˆ˜ ì—†ìŒ Â  @GeneratedValue @MapsId ê°’ì˜ ì¶œì²˜ DBê°€ ìë™ ìƒì„± ì—°ê´€ëœ ì—”í‹°í‹°(User)ë¡œë¶€í„° ë³µì‚¬ ê²°ì • ì‹œì  INSERT ì‹œ DBê°€ ê²°ì • ì—°ê´€ ê´€ê³„ ì„¤ì • ì‹œ ê²°ì • ì˜¬ë°”ë¥¸ ì‚¬ìš©ë²•@Entitypublic class UserProfile { @Id // @GeneratedValue ì—†ì´ @Idë§Œ! private Long id; @OneToOne @MapsId // User.id ê°’ì´ ìë™ìœ¼ë¡œ ì´ ì—”í‹°í‹°ì˜ idê°€ ë¨ @JoinColumn(name = \"id\") private User user;}// ì‚¬ìš© ì˜ˆì‹œUser user = new User();user.setUsername(\"kim\");// userë¥¼ ì €ì¥í•˜ë©´ id = 1 ìë™ ìƒì„±UserProfile profile = new UserProfile();profile.setUser(user); // ì´ ìˆœê°„ profile.idë„ 1ì´ ë¨profile.setBio(\"ì•ˆë…•í•˜ì„¸ìš”\");ID ìƒì„± ì „ëµ ê´€ë ¨ Hibernate ì½”ë“œì£¼ìš” í´ë˜ìŠ¤1. ì „ëµ ê²°ì • ë° ìƒì„±ê¸° ì„ íƒ org.hibernate.id.factory.internal.StandardIdentifierGeneratorFactory org.hibernate.id.IdentifierGenerator (ì¸í„°í˜ì´ìŠ¤)2. ê° ì „ëµë³„ êµ¬í˜„ í´ë˜ìŠ¤ ì „ëµ êµ¬í˜„ í´ë˜ìŠ¤ IDENTITY org.hibernate.id.IdentityGenerator SEQUENCE org.hibernate.id.enhanced.SequenceStyleGenerator TABLE org.hibernate.id.enhanced.TableGenerator AUTO ìœ„ ì¤‘ í•˜ë‚˜ë¥¼ ìë™ ì„ íƒ ì˜ˆì‹œ: IdentityGenerator í•µì‹¬ ì½”ë“œ// org.hibernate.id.IdentityGenerator (ê°„ëµí™”)public class IdentityGenerator implements IdentifierGenerator { @Override public Object generate(SharedSessionContractImplementor session, Object object) { // IDENTITY ì „ëµì€ DBê°€ ê°’ì„ ìƒì„±í•˜ë¯€ë¡œ // INSERT í›„ ìƒì„±ëœ ê°’ì„ ê°€ì ¸ì˜´ return IdentifierGeneratorHelper.POST_INSERT_INDICATOR; }}SimpleJpaRepository.save()ë¶€í„° ID ìƒì„±ê¹Œì§€ íë¦„ì „ì²´ íë¦„ ê°œìš”SimpleJpaRepository.save() â†“EntityManager.persist() â†“SessionImpl.persist() â†“DefaultPersistEventListener â†“AbstractSaveEventListener.saveWithGeneratedId() â†“IdentifierGenerator.generate() â†“INSERT ì‹¤í–‰ &amp; ID ë°˜í™˜1. SimpleJpaRepository.save() Spring Data JPAì˜ ì§„ì…ì . ìƒˆ ì—”í‹°í‹°ì¸ì§€ íŒë‹¨ í›„ persist ë˜ëŠ” merge í˜¸ì¶œ// org.springframework.data.jpa.repository.support.SimpleJpaRepository@Transactional@Overridepublic &lt;S extends T&gt; S save(S entity) { Assert.notNull(entity, \"Entity must not be null\"); if (entityInformation.isNew(entity)) { // ìƒˆ ì—”í‹°í‹°ë©´ persist entityManager.persist(entity); return entity; } else { // ê¸°ì¡´ ì—”í‹°í‹°ë©´ merge return entityManager.merge(entity); }}2. EntityManager.persist() Hibernate Session êµ¬í˜„ì²´. ì´ë²¤íŠ¸ ê¸°ë°˜ìœ¼ë¡œ persist ì²˜ë¦¬ë¥¼ ë¦¬ìŠ¤ë„ˆì—ê²Œ ìœ„ì„// org.hibernate.internal.SessionImpl@Overridepublic void persist(Object object) { checkOpen(); firePersist(new PersistEvent(null, object, this));}private void firePersist(PersistEvent event) { // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆì—ê²Œ ìœ„ì„ fastSessionServices.eventListenerGroup_PERSIST.fireEventOnEachListener(event, PersistEventListener::onPersist);}â€» Hibernateì—ì„œì˜ ì´ë²¤íŠ¸ Session ë‚´ë¶€ì—ì„œ ë°œìƒí•˜ëŠ” ì˜ì†ì„± í–‰ìœ„(persist, merge, delete â€¦)ë¥¼ ì—¬ëŸ¬ ë¦¬ìŠ¤ë„ˆì—ê²Œ ìœ„ì„í•˜ê¸° ìœ„í•œ êµ¬ì¡°ì  íŒ¨í„´ persist() ì‹œì ì— í•´ì•¼ í•  ì¼ë“¤: transient â†’ persistent ìƒíƒœ ì „ì´ identifier ìƒì„± ì „ëµ ì²˜ë¦¬ 1ì°¨ ìºì‹œì— ì—”í‹°í‹° ë“±ë¡ cascade persist entity ìƒíƒœ ê²€ì‚¬ Interceptor, Listener ê°œì… flush ì‹œì  ì‘ì—… ì¤€ë¹„ ì´ê±¸ if-else ë©ì–´ë¦¬ë¡œ SessionImpl ì•ˆì— ì‘ì„±í•˜ë©´ í™•ì¥ì„±, ìœ ì§€ë³´ìˆ˜ì„±ì´ ë§¤ìš° ë–¨ì–´ì§ ê·¸ë˜ì„œ HibernateëŠ”: â€œí–‰ìœ„ = ì´ë²¤íŠ¸â€ â€œí–‰ìœ„ì— ë°˜ì‘í•˜ëŠ” ë¡œì§ = ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆâ€ êµ¬ì¡°ë¥¼ íƒí•¨. 3. DefaultPersistEventListener persist ì´ë²¤íŠ¸ ì²˜ë¦¬. ì—”í‹°í‹° ìƒíƒœ(TRANSIENT, DETACHED ë“±)ì— ë”°ë¼ ë¶„ê¸°// org.hibernate.event.internal.DefaultPersistEventListener@Overridepublic void onPersist(PersistEvent event) throws HibernateException { onPersist(event, IdentityHashMap.newInstance(10));}@Overridepublic void onPersist(PersistEvent event, PersistContext createdAlready) {final Object object = event.getObject(); // ì—”í‹°í‹° ìƒíƒœ í™•ì¸ final EntityEntry entityEntry = event.getSession() .getPersistenceContextInternal() .getEntry(object); EntityState entityState = EntityState.getEntityState(object, ...); switch (entityState) { case TRANSIENT: // ìƒˆ ì—”í‹°í‹° â†’ ì €ì¥ ì²˜ë¦¬ entityIsTransient(event, createdAlready); break; // ... ë‹¤ë¥¸ ìƒíƒœë“¤ }}protected void entityIsTransient(PersistEvent event, PersistContext createdAlready) { // AbstractSaveEventListenerì˜ ë©”ì„œë“œ í˜¸ì¶œ saveWithGeneratedId(...);} Entity ìƒíƒœ https://docs.hibernate.org/orm/6.1/javadocs/org/hibernate/event/internal/EntityState.html Hibernate JPA TRANSIENT New PERSISTENT Managed DETACHED Detached DELETED Removed 4. AbstractSaveEventListener.saveWithGeneratedId() ID ìƒì„±ê¸°ë¥¼ í†µí•´ IDë¥¼ ìƒì„±í•˜ê³  ì €ì¥ ìˆ˜í–‰// org.hibernate.event.internal.AbstractSaveEventListenerprotected Object saveWithGeneratedId(Object entity, String entityName, Object anything,EventSource source, boolean requiresImmediateIdAccess) { // ì—”í‹°í‹° ë©”íƒ€ë°ì´í„° ê°€ì ¸ì˜¤ê¸° EntityPersister persister = source.getEntityPersister(entityName, entity); // â˜… ID ìƒì„±ê¸° ê°€ì ¸ì™€ì„œ ID ìƒì„± Object generatedId = persister.getIdentifierGenerator() .generate((SharedSessionContractImplementor) source, entity); // IDENTITY ì „ëµì¸ ê²½ìš° (POST_INSERT_INDICATOR ë°˜í™˜ë¨) if (generatedId == IdentifierGeneratorHelper.POST_INSERT_INDICATOR) { // INSERT í›„ IDë¥¼ ê°€ì ¸ì™€ì•¼ í•¨ return performSaveWithId(entity, null, persister, ...); } // SEQUENCE, TABLE ì „ëµì¸ ê²½ìš° (ì´ë¯¸ IDê°€ ìƒì„±ë¨) return performSaveWithId(entity, generatedId, persister, ...);}5. IdentifierGenerator êµ¬í˜„ì²´ë“¤ ê° ì „ëµì— ë§ê²Œ ì‹¤ì œ ID ê°’ì„ ìƒì„±IDENTITY// org.hibernate.id.IdentityGeneratorpublic class IdentityGenerator implements IdentifierGenerator { @Override public Object generate(SharedSessionContractImplementor session, Object object) { // DBê°€ IDë¥¼ ìƒì„±í•˜ë¯€ë¡œ \"ë‚˜ì¤‘ì— ê°€ì ¸ì˜¬ê²Œ\" í‘œì‹œë§Œ ë°˜í™˜ return IdentifierGeneratorHelper.POST_INSERT_INDICATOR; }}SEQUENCE// org.hibernate.id.enhanced.SequenceStyleGeneratorpublic class SequenceStyleGenerator implements IdentifierGenerator { @Override public Object generate(SharedSessionContractImplementor session, Object object) { // DB ì‹œí€€ìŠ¤ì—ì„œ ë‹¤ìŒ ê°’ ì¡°íšŒ // SELECT nextval('hibernate_sequence') return optimizer.generate( accessCallback // ì‹¤ì œ ì‹œí€€ìŠ¤ í˜¸ì¶œ ); }}TABLE ì „ëµ// org.hibernate.id.enhanced.TableGeneratorpublic class TableGenerator implements IdentifierGenerator { @Override public Object generate(SharedSessionContractImplementor session, Object object) { // í‚¤ ìƒì„± í…Œì´ë¸”ì—ì„œ ê°’ ì¡°íšŒ ë° ì—…ë°ì´íŠ¸ // SELECT, UPDATE ì‹¤í–‰ return optimizer.generate(accessCallback); }}6. INSERT ì‹¤í–‰ (IDENTITY ì „ëµì˜ ê²½ìš°) ì‹¤ì œ INSERT SQL ì‹¤í–‰ í›„ DBê°€ ìƒì„±í•œ IDë¥¼ ì¡°íšŒí•˜ì—¬ ë°˜í™˜// org.hibernate.id.insert.AbstractReturningDelegatepublic Object performInsert(PreparedStatementDetails insertStatementDetails,JdbcValueBindings jdbcValueBindings, Object entity, SharedSessionContractImplementor session) { // INSERT ì‹¤í–‰ session.getJdbcCoordinator() .getResultSetReturn() .executeUpdate(insertStatement); // DBì—ì„œ ìƒì„±ëœ ID ì¡°íšŒ // MySQL: SELECT LAST_INSERT_ID() // PostgreSQL: RETURNING id ResultSet rs = getInsertGeneratedIdentifierDelegate() .executeAndExtract(insertStatement, session); return rs.getLong(1); // ìƒì„±ëœ ID ë°˜í™˜}7. ì—”í‹°í‹°ì— ID ì„¤ì •// org.hibernate.event.internal.AbstractSaveEventListenerprotected Object performSaveOrReplicate(Object entity, Object id, EntityPersister persister, ...) { // ìƒì„±ëœ IDë¥¼ ì—”í‹°í‹°ì— ì„¤ì • persister.setIdentifier(entity, id, session); // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ë“±ë¡ source.getPersistenceContextInternal() .addEntity(entity, Status.MANAGED, ...);}ì „ëµë³„ SQL ì‹¤í–‰ ì‹œì  ë¹„êµâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ ì „ëµ â”‚ ì‹¤í–‰ íë¦„ â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ IDENTITY â”‚ generate() â†’ INSERT â†’ SELECT LAST_INSERT_ID â”‚â”‚ â”‚ (IDëŠ” INSERT í›„ì— ì•Œ ìˆ˜ ìˆìŒ) â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ SEQUENCE â”‚ SELECT nextval() â†’ generate() â†’ INSERT â”‚â”‚ â”‚ (IDë¥¼ ë¨¼ì € ì¡°íšŒ í›„ INSERT) â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ TABLE â”‚ SELECT &amp; UPDATE â†’ generate() â†’ INSERT â”‚â”‚ â”‚ (í‚¤ í…Œì´ë¸”ì—ì„œ ID í™•ë³´ í›„ INSERT) â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ë””ë²„ê¹… ë¸Œë ˆì´í¬í¬ì¸íŠ¸ ì¶”ì²œ ìœ„ì¹˜1. SimpleJpaRepository.save() // ì§„ì…ì 2. SessionImpl.persist() // Hibernate ì§„ì…3. AbstractSaveEventListener.saveWithGeneratedId() // â˜… í•µì‹¬4. IdentityGenerator.generate() // ì „ëµë³„ ë¶„ê¸°5. AbstractReturningDelegate.performInsert() // ì‹¤ì œ INSERTIDENTITY ì „ëµì—ì„œ Bulk Insertê°€ ì•ˆ ë˜ëŠ” ì´ìœ  IDENTITY ì „ëµì€ INSERTë¥¼ ì‹¤í–‰í•´ì•¼ë§Œ IDë¥¼ ì•Œ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, Hibernateê°€ batch insertë¥¼ ë¹„í™œì„±í™”í•œë‹¤.1. ActionQueueì—ì„œ batch ê°€ëŠ¥ ì—¬ë¶€ íŒë‹¨// org.hibernate.engine.spi.ActionQueuepublic void addAction(EntityInsertAction action) { // â˜… í•µì‹¬: ID ìƒì„± ë°©ì‹ í™•ì¸ if (action.isEarlyInsert()) { // IDENTITY ì „ëµ â†’ ì¦‰ì‹œ INSERT ì‹¤í–‰í•´ì•¼ í•¨ executeInsertNow(action); } else { // SEQUENCE, TABLE â†’ ë‚˜ì¤‘ì— batchë¡œ ëª¨ì•„ì„œ ì‹¤í–‰ ê°€ëŠ¥ addToInsertQueue(action); }}2. isEarlyInsert() íŒë‹¨ ë¡œì§// org.hibernate.action.internal.EntityInsertActionpublic boolean isEarlyInsert() { // ID ìƒì„±ê¸°ê°€ POST_INSERT íƒ€ì…ì¸ì§€ í™•ì¸ return persister.getIdentifierGenerator() instanceof PostInsertIdentifierGenerator;}// org.hibernate.id.IdentityGeneratorpublic class IdentityGenerator implements PostInsertIdentifierGenerator { // â† ì´ ì¸í„°í˜ì´ìŠ¤! // IDENTITYëŠ” PostInsertIdentifierGeneratorë¥¼ êµ¬í˜„ // = INSERT í›„ì—ì•¼ IDë¥¼ ì•Œ ìˆ˜ ìˆë‹¤ëŠ” ì˜ë¯¸}3. Batch ë¹„í™œì„±í™”// org.hibernate.engine.jdbc.batch.internal.BatchBuilderImplpublic Batch buildBatch(BatchKey key, JdbcCoordinator jdbcCoordinator) { // IDENTITY ì „ëµì´ë©´ batch sizeë¥¼ 1ë¡œ ê°•ì œ if (isIdentityInsert(key)) { return new NonBatchingBatch(key, jdbcCoordinator); } // ë‹¤ë¥¸ ì „ëµì€ ì„¤ì •ëœ batch size ì‚¬ìš© return new BatchingBatch(key, jdbcCoordinator, batchSize);}// org.hibernate.id.insert.AbstractReturningDelegatepublic Object performInsert(...) { // IDENTITY: ê° INSERTë§ˆë‹¤ ì¦‰ì‹œ ì‹¤í–‰í•˜ê³  ID ì¡°íšŒ jdbcCoordinator.getResultSetReturn().executeUpdate(insertStatement); // ìƒì„±ëœ ID ì¦‰ì‹œ ì¡°íšŒ (ì´ê²Œ batchë¥¼ ë§‰ëŠ” ì›ì¸) ResultSet rs = statement.getGeneratedKeys(); return rs.getLong(1);}ì˜ˆì‹œâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ SEQUENCE ì „ëµ (Batch ê°€ëŠ¥) â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ â”‚â”‚ 1. SELECT nextval() â†’ ID = 1 â”‚â”‚ 2. SELECT nextval() â†’ ID = 2 â”‚â”‚ 3. SELECT nextval() â†’ ID = 3 â”‚â”‚ â”‚â”‚ ì´ ì‹œì ì— ëª¨ë“  ì—”í‹°í‹°ì˜ IDë¥¼ ì•Œê³  ìˆìŒ! â”‚â”‚ â†’ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ë“±ë¡ ê°€ëŠ¥ â”‚â”‚ â†’ ì—°ê´€ê´€ê³„ ì„¤ì • ê°€ëŠ¥ â”‚â”‚ â”‚â”‚ 4. INSERT 3ê°œë¥¼ í•œ ë²ˆì— batch ì‹¤í–‰ â”‚â”‚ INSERT INTO user (id, name) VALUES (1, 'A'), (2, 'B')... â”‚â”‚ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ IDENTITY ì „ëµ (Batch ë¶ˆê°€) â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ â”‚â”‚ 1. INSERT user1 â†’ ID = ? (ëª¨ë¦„) â”‚â”‚ â”‚â”‚ ë¬¸ì œ: IDë¥¼ ëª¨ë¥´ë©´... â”‚â”‚ - ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ë“±ë¡ ë¶ˆê°€ (1ì°¨ ìºì‹œ keyê°€ ì—†ìŒ) â”‚â”‚ - ì—°ê´€ê´€ê³„ FK ì„¤ì • ë¶ˆê°€ â”‚â”‚ - ë‹¤ìŒ ì—”í‹°í‹° ì²˜ë¦¬ ë¶ˆê°€ â”‚â”‚ â”‚â”‚ â†’ INSERT ì‹¤í–‰í•˜ê³  LAST_INSERT_ID() ì¡°íšŒí•´ì•¼ í•¨ â”‚â”‚ â†’ ê·¸ë˜ì•¼ ë‹¤ìŒ ë‹¨ê³„ ì§„í–‰ ê°€ëŠ¥ â”‚â”‚ â”‚â”‚ 2. INSERT user2 â†’ ë§ˆì°¬ê°€ì§€ë¡œ ì¦‰ì‹œ ì‹¤í–‰ í•„ìš” â”‚â”‚ 3. INSERT user3 â†’ ë§ˆì°¬ê°€ì§€ â”‚â”‚ â”‚â”‚ ê²°ê³¼: ê°ê° ê°œë³„ INSERT ì‹¤í–‰ (batch ë¶ˆê°€ëŠ¥) â”‚â”‚ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ë“±ë¡ ì‹œ ID í•„ìš”// org.hibernate.engine.internal.StatefulPersistenceContextpublic void addEntity(EntityKey key, Object entity) { // â˜… EntityKey ìƒì„±ì— IDê°€ í•„ìˆ˜! // IDê°€ ì—†ìœ¼ë©´ 1ì°¨ ìºì‹œì— ë“±ë¡ ìì²´ê°€ ë¶ˆê°€ëŠ¥ entitiesByKey.put(key, entity);}// org.hibernate.engine.spi.EntityKeypublic EntityKey(Object id, EntityPersister persister) { this.identifier = id; // â† IDê°€ ë°˜ë“œì‹œ ìˆì–´ì•¼ í•¨ this.persister = persister;}ì—°ê´€ê´€ê³„ì—ì„œì˜ ë¬¸ì œ@Entitypublic class Order { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private Long id; @OneToMany(mappedBy = \"order\", cascade = CascadeType.ALL) private List&lt;OrderItem&gt; items;}@Entitypublic class OrderItem { @Id @GeneratedValue(strategy = GenerationType.IDENTITY) private Long id; @ManyToOne @JoinColumn(name = \"order_id\") private Order order; // â† FKë¡œ Order.id í•„ìš”!}// ì €ì¥ ì‹œOrder order = new Order();OrderItem item1 = new OrderItem();OrderItem item2 = new OrderItem();order.addItem(item1);order.addItem(item2);entityManager.persist(order);1. INSERT order â†’ ID ì¡°íšŒ (ì˜ˆ: 100) â†’ order.id = 100 ì„¤ì • â†’ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ë“±ë¡2. INSERT orderItem1 (order_id = 100) â†’ ID ì¡°íšŒ â†’ Order.idë¥¼ ì•Œì•„ì•¼ FK ì„¤ì • ê°€ëŠ¥!3. INSERT orderItem2 (order_id = 100) â†’ ID ì¡°íšŒâˆ´ Order INSERTê°€ ë¨¼ì € ì™„ë£Œë˜ì–´ì•¼ OrderItem INSERT ê°€ëŠ¥âˆ´ Batchë¡œ ë¬¶ì„ ìˆ˜ ì—†ìŒì •ë¦¬ ì „ëµ ID íšë“ ì‹œì  Batch ê°€ëŠ¥ ì´ìœ  IDENTITY INSERT í›„ X IDë¥¼ ëª°ë¼ì„œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ë“±ë¡, FK ì„¤ì • ë¶ˆê°€ SEQUENCE INSERT ì „ O ë¯¸ë¦¬ ID í™•ë³´ â†’ ëª¨ì•„ì„œ batch ì‹¤í–‰ ê°€ëŠ¥ TABLE INSERT ì „ O ë¯¸ë¦¬ ID í™•ë³´ â†’ ëª¨ì•„ì„œ batch ì‹¤í–‰ ê°€ëŠ¥ ê²°ë¡ : IDENTITYëŠ” â€œINSERT í•´ë´ì•¼ IDë¥¼ ì•ˆë‹¤â€ëŠ” ê·¼ë³¸ì  íŠ¹ì„± ë•Œë¬¸ì—, Hibernateê°€ ì•„ë¬´ë¦¬ ìµœì í™”í•´ë„ batch insertê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤.â€» ì°¸ê³  : Hibernate 6.6 BulkInsertionCapableIdentifierGeneratorIdentityGenerator (Hibernate 6.6.x)public class IdentityGeneratorimplements PostInsertIdentifierGenerator,BulkInsertionCapableIdentifierGenerator, // â† ì´ê²Œ ìˆì–´ì„œ bulk ê°€ëŠ¥?StandardGenerator { public boolean referenceColumnsInSql(Dialect dialect) { return dialect.getIdentityColumnSupport().hasIdentityInsertKeyword(); } public String[] getReferencedColumnValues(Dialect dialect) { return new String[]{dialect.getIdentityColumnSupport().getIdentityInsertString()}; } // ... ë‚˜ë¨¸ì§€ ì½”ë“œ}ê²°ë¡ ë¶€í„° ë§í•˜ë©´ BulkInsertionCapableIdentifierGeneratorëŠ” HQL/JPQLì˜ INSERT ... SELECT ë²Œí¬ êµ¬ë¬¸ì„ IDENTITY í…Œì´ë¸”ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì¸í„°í˜ì´ìŠ¤ ì¼ë°˜ì ì¸ persist() í˜¸ì¶œì˜ JDBC batch insertì™€ëŠ” ë¬´ê´€ ë”°ë¼ì„œ IDENTITY ì „ëµì—ì„œ persist() ë£¨í”„ì˜ batch insertëŠ” ì—¬ì „íˆ ë¶ˆê°€ëŠ¥ ì¦‰, ì—¬ì „íˆ ì¼ë°˜ì ì¸ entityManager.persist() ë£¨í”„ì—ì„œëŠ” batch insertê°€ ì•ˆë¨BulkInsertionCapableIdentifierGenerator ì¸í„°í˜ì´ìŠ¤ í™•ì¸// org.hibernate.id.BulkInsertionCapableIdentifierGeneratorpublic interface BulkInsertionCapableIdentifierGenerator extends IdentifierGenerator { /** * SQL êµ¬ë¬¸ì—ì„œ ID ì»¬ëŸ¼ì„ ì°¸ì¡°í•´ì•¼ í•˜ëŠ”ì§€? * (INSERT êµ¬ë¬¸ì— ID ì»¬ëŸ¼ì„ ëª…ì‹œì ìœ¼ë¡œ í¬í•¨í• ì§€ ì—¬ë¶€) */ boolean referenceColumnsInSql(Dialect dialect); /** * ID ì»¬ëŸ¼ì— ë“¤ì–´ê°ˆ ê°’ (í‚¤ì›Œë“œ ë“±) * ì˜ˆ: Oracleì˜ \"DEFAULT\", SQL Serverì˜ \"DEFAULT\" ë“± */ String[] getReferencedColumnValues(Dialect dialect);}ì´ ì¸í„°í˜ì´ìŠ¤ì˜ ì‹¤ì œ ìš©ë„HQL/JPQLì˜ bulk insert êµ¬ë¬¸ ì§€ì›String hql = \"INSERT INTO UserArchive (id, name, email) \" +\"SELECT u.id, u.name, u.email FROM User u WHERE u.status = 'INACTIVE'\";entityManager.createQuery(hql).executeUpdate(); ìƒì„±ë˜ëŠ” SQL:sql-- IDENTITY ì»¬ëŸ¼ì´ ìˆì–´ë„ bulk INSERT ... SELECT ê°€ëŠ¥í•˜ê²Œ í•¨INSERT INTO user_archive (id, name, email)SELECT id, name, email FROM user WHERE status = 'INACTIVE'ì½”ë“œ ë¶„ì„: referenceColumnsInSql()// IdentityGeneratorpublic boolean referenceColumnsInSql(Dialect dialect) { return dialect.getIdentityColumnSupport().hasIdentityInsertKeyword();}// ì˜ˆ: SQL Serverì˜ IdentityColumnSupportpublic class SQLServerIdentityColumnSupport extends IdentityColumnSupportImpl { @Override public boolean hasIdentityInsertKeyword() { return true; // SQL ServerëŠ” IDENTITY_INSERT í‚¤ì›Œë“œ ìˆìŒ } @Override public String getIdentityInsertString() { return \"default\"; // INSERT ì‹œ 'DEFAULT' í‚¤ì›Œë“œ ì‚¬ìš© }}// MySQLì˜ ê²½ìš°public class MySQLIdentityColumnSupport extends IdentityColumnSupportImpl { @Override public boolean hasIdentityInsertKeyword() { return false; // MySQLì€ ì—†ìŒ }}ì •ë¦¬: ë‘ ê°€ì§€ â€œBulk Insertâ€ì˜ ì°¨ì´ êµ¬ë¶„ JDBC Batch Insert HQL Bulk Insert ì‚¬ìš©ë²• persist() ì—¬ëŸ¬ ë²ˆ INSERT INTO ... SELECT ê´€ë ¨ ì¸í„°í˜ì´ìŠ¤ ì—†ìŒ (batch ì„¤ì •) BulkInsertionCapableIdentifierGenerator IDENTITYì—ì„œ X O ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ê° ì—”í‹°í‹° ê´€ë¦¬ë¨ ê´€ë¦¬ ì•ˆ ë¨ (ë²Œí¬ ì—°ì‚°) // JDBC Batch - IDENTITYì—ì„œ ë¶ˆê°€for (User u : users) {em.persist(u); // ê°œë³„ INSERT}// HQL Bulk - IDENTITYì—ì„œ ê°€ëŠ¥ (BulkInsertionCapableIdentifierGenerator ë•ë¶„)em.createQuery(\"INSERT INTO Archive SELECT u FROM User u\").executeUpdate();" }, { "title": "ì  í‚¨ìŠ¤ Pipeline ì•Œì•„ë³´ê¸°", "url": "/posts/jenkins-pipeline/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Jenkins", "date": "2026-01-26 22:25:00 +0900", "snippet": "Jenkins Pipeline CD(Continuous Delivery) íŒŒì´í”„ë¼ì¸ì„ ì½”ë“œë¡œ ì •ì˜í•˜ëŠ” Jenkins í”ŒëŸ¬ê·¸ì¸ ëª¨ìŒí•µì‹¬ ê°œë…Pipeline â””â”€â”€ Stage â””â”€â”€ Step ê°œë… ì„¤ëª… ì˜ˆì‹œ Pipeline ì „ì²´ ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ ì •ì˜ pipelin...", "content": "Jenkins Pipeline CD(Continuous Delivery) íŒŒì´í”„ë¼ì¸ì„ ì½”ë“œë¡œ ì •ì˜í•˜ëŠ” Jenkins í”ŒëŸ¬ê·¸ì¸ ëª¨ìŒí•µì‹¬ ê°œë…Pipeline â””â”€â”€ Stage â””â”€â”€ Step ê°œë… ì„¤ëª… ì˜ˆì‹œ Pipeline ì „ì²´ ë¹Œë“œ í”„ë¡œì„¸ìŠ¤ ì •ì˜ pipeline { } Node íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰í•˜ëŠ” ë¨¸ì‹  node { } (Scripted) Stage ë…¼ë¦¬ì  ì‘ì—… ë‹¨ìœ„ â€œBuildâ€, â€œTestâ€, â€œDeployâ€ Step ì‹¤ì œ ìˆ˜í–‰í•  ë‹¨ì¼ ì‘ì—… sh â€˜makeâ€™, echo â€˜helloâ€™ Pipelineì˜ ì¥ì  íŠ¹ì§• ì„¤ëª… Code íŒŒì´í”„ë¼ì¸ì„ ì½”ë“œë¡œ ì‘ì„± â†’ Git ë²„ì „ ê´€ë¦¬ ê°€ëŠ¥ Durable Jenkins ì¬ì‹œì‘í•´ë„ íŒŒì´í”„ë¼ì¸ ìœ ì§€ë¨ Pausable ì¤‘ê°„ì— ë©ˆì¶”ê³  ì‚¬ëŒì˜ ìŠ¹ì¸ì„ ê¸°ë‹¤ë¦´ ìˆ˜ ìˆìŒ Versatile ë¶„ê¸°(fork/join), ë°˜ë³µ(loop), ë³‘ë ¬ ì²˜ë¦¬ ì§€ì› Extensible í”ŒëŸ¬ê·¸ì¸/Shared Librariesë¡œ í™•ì¥ ê°€ëŠ¥ Jenkinsfile Jenkins Pipelineì„ ì •ì˜í•˜ëŠ” í…ìŠ¤íŠ¸ íŒŒì¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ í”„ë¡œì íŠ¸ ì €ì¥ì†Œ (Git) â”‚â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚ ğŸ“ src/ â”‚â”‚ ğŸ“ test/ â”‚â”‚ ğŸ“„ pom.xml â”‚â”‚ ğŸ“„ Jenkinsfile â† ì´ íŒŒì¼! â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ Jenkinsfileì€ í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— ìœ„ì¹˜í•˜ë©°, Jenkinsê°€ ì´ íŒŒì¼ì„ ì½ì–´ì„œ íŒŒì´í”„ë¼ì¸ì„ ì‹¤í–‰ì¥ì ê¸°ì¡´ ë°©ì‹ (Web UI) Jenkins ì›¹ í™”ë©´ì—ì„œ ì§ì ‘ ì„¤ì • ì„¤ì • ë³€ê²½ ì´ë ¥ ì¶”ì  ì–´ë ¤ì›€ ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì— ë³µì‚¬í•˜ê¸° ë²ˆê±°ë¡œì›€ ëˆ„ê°€ ë­˜ ë°”ê¿¨ëŠ”ì§€ ëª¨ë¦„ Jenkinsfile ë°©ì‹ (Pipeline as Code) Gitìœ¼ë¡œ ë²„ì „ ê´€ë¦¬ ì½”ë“œ ë¦¬ë·° ê°€ëŠ¥ ë³€ê²½ ì´ë ¥ ì¶”ì  ë¸Œëœì¹˜ë³„ ë‹¤ë¥¸ íŒŒì´í”„ë¼ì¸ ê°€ëŠ¥ì£¼ìš” ê¸°ëŠ¥ ê¸°ëŠ¥ ì„¤ëª… í™˜ê²½ë³€ìˆ˜ env.BUILD_ID, env.WORKSPACE ë“± ì‚¬ìš© ê°€ëŠ¥ Credentials credentials('credential-id')ë¡œ ë¹„ë°€ ì •ë³´ ì ‘ê·¼ íŒŒë¼ë¯¸í„° params.PARAM_NAMEìœ¼ë¡œ ë¹Œë“œ íŒŒë¼ë¯¸í„° ì‚¬ìš© ì‹¤íŒ¨ ì²˜ë¦¬ post { failure { ... } } ë¸”ë¡ í™œìš© ë‹¤ì¤‘ Agent Stageë³„ë¡œ ë‹¤ë¥¸ agent ì§€ì • ê°€ëŠ¥ ì£¼ìš” ë¬¸ë²• ìš”ì†Œpipeline { agent any // í•„ìˆ˜ stages { // í•„ìˆ˜ stage('X') { // ìµœì†Œ 1ê°œ steps { // í•„ìˆ˜ // ì‘ì—… ë‚´ìš© } } }} Directive ìš©ë„ ì˜ˆì‹œ agent ì‹¤í–‰ í™˜ê²½ ì§€ì • agent { docker 'maven:3.9' }, agent any(ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ë¬´ ë…¸ë“œì—ì„œ ì‹¤í–‰) environment í™˜ê²½ë³€ìˆ˜ ì„¤ì • environment { CC = 'clang' } options { } íŒŒì´í”„ë¼ì¸ ì˜µì…˜ (íƒ€ì„ì•„ì›ƒ, ì¬ì‹œë„ ë“±) options { timeout(time: 1, unit: â€˜HOURSâ€™) } parameters ë¹Œë“œ íŒŒë¼ë¯¸í„° parameters { string(name: 'ENV') } triggers ìë™ íŠ¸ë¦¬ê±° triggers { cron('H */4 * * 1-5') } when ì¡°ê±´ë¶€ ì‹¤í–‰ when { branch 'master' } post ë¹Œë“œ í›„ ì²˜ë¦¬ post { always { junit '**/*.xml' } } stages { } Stageë“¤ì„ ê°ì‹¸ëŠ” ë¸”ë¡ Â  stage('ì´ë¦„') { } ê°œë³„ ë‹¨ê³„ ì •ì˜ Â  sh 'command' ì‰˜ ëª…ë ¹ì–´ ì‹¤í–‰ Â  when ì¡°ê±´ ì¢…ë¥˜ branch â€˜patternâ€™ - ë¸Œëœì¹˜ ë§¤ì¹­ environment name: â€˜Xâ€™, value: â€˜Yâ€™ // í™˜ê²½ë³€ìˆ˜ ì¡°ê±´ expression { return true } // Groovy í‘œí˜„ì‹ allOf { }, anyOf { }, not { } // ë³µí•© ì¡°ê±´when { allOf { branch 'master' environment name: 'DEPLOY', value: 'true' not { expression { return false } } }}ë‘ ê°€ì§€ ë¬¸ë²• ìŠ¤íƒ€ì¼1. Declarative (ê¶Œì¥) êµ¬ì¡°í™”ëœ ë¬¸ë²•, ì½ê¸° ì‰¬ì›€, ë¬¸ë²• ê²€ì¦ ê°€ëŠ¥pipeline { agent any stages { stage('Build') { steps { sh 'make' } } stage('Test') { steps { sh 'make check' junit 'reports/**/*.xml' } } stage('Deploy') { steps { sh 'make publish' } } }}2. Scripted Groovy ììœ ë„ ë†’ìŒ, ë³µì¡í•œ ë¡œì§ì— ìœ ë¦¬node { stage('Build') { sh 'make' } stage('Test') { sh 'make check' junit 'reports/**/*.xml' } stage('Deploy') { sh 'make publish' }}Pipeline ì‹¤í–‰ íë¦„ê³¼ ì‹¤íŒ¨ ì „íŒŒ Jenkins Pipelineì€ ìœ„ì—ì„œ ì•„ë˜ë¡œ ìˆœì°¨ ì‹¤í–‰ë˜ë©°, ê¸°ë³¸ì ìœ¼ë¡œ í•˜ë‚˜ì˜ Stepì´ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ì „ì²´ íŒŒì´í”„ë¼ì¸ì´ ì‹¤íŒ¨í•œë‹¤.stage('Test') { steps { sh 'exit 1' // ì´ ì‹œì ì—ì„œ íŒŒì´í”„ë¼ì¸ ì‹¤íŒ¨ sh 'echo never called' }} ì‹¤íŒ¨í•œ Stage ì´í›„ StageëŠ” ì‹¤í–‰ë˜ì§€ ì•ŠìŒ ë‹¨, post ë¸”ë¡ì€ ì‹¤í–‰ë¨post ë¸”ë¡ postëŠ” íŒŒì´í”„ë¼ì¸ ë˜ëŠ” Stage ë‹¨ìœ„ë¡œ ì„ ì–¸ ê°€ëŠ¥í•˜ë‹¤.post { success { echo 'ë¹Œë“œ ì„±ê³µ' } failure { echo 'ë¹Œë“œ ì‹¤íŒ¨' } always { echo 'í•­ìƒ ì‹¤í–‰' }} ì¡°ê±´ ì„¤ëª… always í•­ìƒ ì‹¤í–‰ success ì„±ê³µ ì‹œ failure ì‹¤íŒ¨ ì‹œ unstable í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ë“±ìœ¼ë¡œ ë¶ˆì•ˆì • ìƒíƒœ aborted ì‚¬ìš©ìê°€ ì¤‘ë‹¨ changed ì´ì „ ë¹Œë“œì™€ ìƒíƒœê°€ ë‹¬ë¼ì¡Œì„ ë•Œ ê¸°íƒ€Stage ë‹¨ìœ„ agent ì§€ì • ì „ì²´ íŒŒì´í”„ë¼ì¸ì— agent anyë¥¼ ì“°ë”ë¼ë„, Stageë³„ë¡œ ë‹¤ë¥¸ ì‹¤í–‰ í™˜ê²½ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.pipeline { agent any stages { stage('Build') { agent { docker { image 'maven:3.9' } } steps { sh 'mvn clean package' } } stage('Deploy') { agent { label 'deploy-node' } steps { sh './deploy.sh' } } }} ë¹Œë“œ / ë°°í¬ í™˜ê²½ ë¶„ë¦¬í•  ë•Œ ë§¤ìš° ì¤‘ìš”parallel â€“ ë³‘ë ¬ ì‹¤í–‰ ì—¬ëŸ¬ Stageë¥¼ ë™ì‹œì— ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.stage('Test') { parallel { stage('Unit Test') { steps { sh './gradlew test' } } stage('Integration Test') { steps { sh './gradlew integrationTest' } } }} ì „ì²´ ë³‘ë ¬ ì¤‘ í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ì „ì²´ ì‹¤íŒ¨ í…ŒìŠ¤íŠ¸ ì‹œê°„ ë‹¨ì¶•ì— ë§¤ìš° ìœ ìš©input â€“ ì‚¬ëŒ ìŠ¹ì¸ ëŒ€ê¸° CD íŒŒì´í”„ë¼ì¸ì—ì„œ ìš´ì˜ ë°°í¬ ì „ ìŠ¹ì¸ ë°›ì„ ë•Œ ìì£¼ ì‚¬ìš©í•œë‹¤.stage('Approve') { steps { input message: 'ìš´ì˜ì— ë°°í¬í• ê¹Œìš”?', ok: 'Deploy' }} Jenkins UIì—ì„œ ë²„íŠ¼ í´ë¦­ ì „ê¹Œì§€ ëŒ€ê¸° ìŠ¹ì¸ ì´ë ¥ ë‚¨ìŒtry-catch (Scripted ë˜ëŠ” script ë¸”ë¡) Declarativeì—ì„œë„ script {} ë¸”ë¡ ì•ˆì—ì„œëŠ” Groovy ë¡œì§ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.stage('Deploy') { steps { script { try { sh './deploy.sh' } catch (e) { echo 'ë°°í¬ ì‹¤íŒ¨' currentBuild.result = 'FAILURE' throw e } } }} ì‹¤ë¬´ ê¶Œì¥ íŒ¨í„´ : Declarative + í•„ìš”í•œ ë¶€ë¶„ë§Œ script {}ì‹¤ë¬´ì—ì„œ ìì£¼ ì“°ëŠ” Jenkinsfile ë¼ˆëŒ€pipeline { agent any options { timeout(time: 30, unit: 'MINUTES') } parameters { choice(name: 'ENV', choices: ['dev', 'staging', 'prod']) } stages { stage('Checkout') { steps { checkout scm } } stage('Build &amp; Test') { steps { sh './gradlew build' } } stage('Deploy') { when { branch 'main' } steps { input message: 'ë°°í¬ ì§„í–‰?', ok: 'Deploy' sh './deploy.sh' } } } post { failure { echo 'ë¹Œë“œ ì‹¤íŒ¨ ì•Œë¦¼ ì „ì†¡' } }}ì°¸ê³  ìë£Œ https://www.jenkins.io/doc/book/pipeline/ https://www.jenkins.io/doc/book/pipeline/jenkinsfile/ https://www.jenkins.io/doc/book/pipeline/syntax/ Claude Code / Chat GPT" }, { "title": "EntityManagerì™€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸", "url": "/posts/jpa-entity-manager-persistence-context/", "categories": "JPA", "tags": "JPA, Hibernate", "date": "2026-01-25 23:00:00 +0900", "snippet": "Architecture HibernateëŠ” ORM ì†”ë£¨ì…˜ìœ¼ë¡œì„œ Java ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°ì´í„° ì ‘ê·¼ ê³„ì¸µê³¼ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ì´ì— ìœ„ì¹˜ Java ì• í”Œë¦¬ì¼€ì´ì…˜ì€ Hibernate APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ë°ì´í„°ë¥¼ ë¡œë“œ, ì €ì¥, ì¿¼ë¦¬í•œë‹¤.Data Access Layer (ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ) â†“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€...", "content": "Architecture HibernateëŠ” ORM ì†”ë£¨ì…˜ìœ¼ë¡œì„œ Java ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë°ì´í„° ì ‘ê·¼ ê³„ì¸µê³¼ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ì´ì— ìœ„ì¹˜ Java ì• í”Œë¦¬ì¼€ì´ì…˜ì€ Hibernate APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë„ë©”ì¸ ë°ì´í„°ë¥¼ ë¡œë“œ, ì €ì¥, ì¿¼ë¦¬í•œë‹¤.Data Access Layer (ë°ì´í„° ì ‘ê·¼ ê³„ì¸µ) â†“ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Java Persistence â”‚ Hibernate â”‚ â”‚ API â”‚ Native APIâ”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ Hibernate â”‚ â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚ JDBC â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†“ Relational DatabaseJPAì™€ Hibernate êµ¬í˜„ì²´ ê´€ê³„ JPA ì¸í„°í˜ì´ìŠ¤ Hibernate ì¸í„°í˜ì´ìŠ¤ Hibernate êµ¬í˜„ì²´ EntityManagerFactory SessionFactory SessionFactoryImpl EntityManager Session SessionImpl EntityTransaction Transaction TransactionImpl SessionFactory / EntityManagerFactory íŠ¹ì„± ì„¤ëª… ìŠ¤ë ˆë“œ ì•ˆì „ì„± Thread-safe, ë¶ˆë³€(immutable) ì—­í•  ì• í”Œë¦¬ì¼€ì´ì…˜ ë„ë©”ì¸ ëª¨ë¸ê³¼ DB ê°„ì˜ ë§¤í•‘ ì •ë³´ë¥¼ ë‹´ê³  ìˆìŒ ìƒì„± ë¹„ìš© ë§¤ìš° ë¹„ìŒˆ â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ë‹¹ í•˜ë‚˜ë§Œ ìƒì„±í•´ì•¼ í•¨ ê´€ë¦¬í•˜ëŠ” ê²ƒë“¤ 2ì°¨ ìºì‹œ, ì»¤ë„¥ì…˜ í’€, íŠ¸ëœì­ì…˜ ì‹œìŠ¤í…œ í†µí•© ë“± // ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì—ì„œ í•˜ë‚˜ë§Œ!@Configurationpublic class HibernateConfig { @Bean public LocalSessionFactoryBean sessionFactory() { ... }}Session / EntityManager íŠ¹ì„± ì„¤ëª… ìŠ¤ë ˆë“œ ì•ˆì „ì„± Thread-safe ì•„ë‹˜, ë‹¨ì¼ ìŠ¤ë ˆë“œì—ì„œë§Œ ì‚¬ìš© ìˆ˜ëª… ì§§ìŒ (ìš”ì²­ë‹¹ í•˜ë‚˜, íŠ¸ëœì­ì…˜ ë‹¨ìœ„) ê°œë… â€œUnit of Workâ€ íŒ¨í„´ êµ¬í˜„ ë‚´ë¶€ ë™ì‘ JDBC Connectionì„ ê°ì‹¸ê³  ìˆìŒ í•µì‹¬ ê¸°ëŠ¥ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(1ì°¨ ìºì‹œ) ìœ ì§€ // ìš”ì²­ë§ˆë‹¤ ìƒˆë¡œ ìƒì„±, ì§§ê²Œ ì‚¬ìš©@Transactionalpublic void doSomething() { // ì´ ë©”ì„œë“œ ì‹¤í–‰ ë™ì•ˆ Session/EntityManagerê°€ ì‚´ì•„ìˆìŒ // ë©”ì„œë“œ ëë‚˜ë©´ ë‹«í˜}Transaction / EntityTransaction íŠ¹ì„± ì„¤ëª… ìŠ¤ë ˆë“œ ì•ˆì „ì„± Thread-safe ì•„ë‹˜, ë‹¨ì¼ ìŠ¤ë ˆë“œì—ì„œë§Œ ì‚¬ìš© ìˆ˜ëª… ì§§ìŒ ì—­í•  ë¬¼ë¦¬ì  íŠ¸ëœì­ì…˜ ê²½ê³„ë¥¼ êµ¬ë¶„ ì¶”ìƒí™” JDBC íŠ¸ëœì­ì…˜ ë˜ëŠ” JTA íŠ¸ëœì­ì…˜ì„ ì¶”ìƒí™” Transaction tx = session.beginTransaction();try { // ì‘ì—… tx.commit();} catch (Exception e) { tx.rollback();}â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ Application â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ SessionFactory (= EntityManagerFactory) â”‚â”‚ â€¢ ì• í”Œë¦¬ì¼€ì´ì…˜ë‹¹ 1ê°œ â”‚â”‚ â€¢ Thread-safe â”‚â”‚ â€¢ 2ì°¨ ìºì‹œ, ì»¤ë„¥ì…˜ í’€ ê´€ë¦¬ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ creates â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ Session (= EntityManager) â”‚â”‚ â€¢ ìš”ì²­/íŠ¸ëœì­ì…˜ë‹¹ 1ê°œ â”‚â”‚ â€¢ Thread-safe ì•„ë‹˜ â”‚â”‚ â€¢ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(1ì°¨ ìºì‹œ) ë³´ìœ  â”‚â”‚ â€¢ JDBC Connection ë˜í•‘ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ creates â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ Transaction (= EntityTransaction) â”‚â”‚ â€¢ íŠ¸ëœì­ì…˜ ê²½ê³„ ê´€ë¦¬ â”‚â”‚ â€¢ begin(), commit(), rollback() â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–¼â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ Database â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â€» ì°¸ê³  : Spring Data JPAì—ì„œëŠ” ?@Servicepublic class UserService { @Autowired private UserRepository userRepository; // ë‚´ë¶€ì ìœ¼ë¡œ EntityManager ì‚¬ìš© @Transactional // Session, Transaction ìë™ ê´€ë¦¬ public void createUser(User user) { userRepository.save(user); // íŠ¸ëœì­ì…˜ ëë‚˜ë©´ ìë™ commit, Session ìë™ close }} Springì´ SessionFactoryë¥¼ ì‹±ê¸€í†¤ìœ¼ë¡œ ê´€ë¦¬í•˜ê³ , @Transactional ë©”ì„œë“œ ì§„ì… ì‹œ Sessionê³¼ Transactionì„ ìƒì„±í•˜ê³ , ë©”ì„œë“œ ì¢…ë£Œ ì‹œ ì •ë¦¬í•´ì¤ë‹ˆë‹¤.EntityManager ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì ‘ê·¼í•˜ì—¬ ì—”í‹°í‹°ì˜ CRUD ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” API(ì¸í„°í˜ì´ìŠ¤)jakarta.persistence.EntityManager ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(persistence context)ì™€ ìƒí˜¸ì‘ìš©í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì¸í„°í˜ì´ìŠ¤ EntityManagerFactoryë¡œë¶€í„° ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì–»ì–´ì•¼ í•˜ë©°, ì—°ê´€ëœ ì˜ì†ì„± ìœ ë‹›ì— ì†í•˜ëŠ” ì—”í‹°í‹°ë§Œ ê´€ë¦¬public interface EntityManager extends AutoCloseable { ...}EntityManager ìƒì„± ë°©ì‹1. ì• í”Œë¦¬ì¼€ì´ì…˜ ê´€ë¦¬ ë°©ì‹ EntityManagerFactory.createEntityManager()ë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒì„± ë°˜ë“œì‹œ close()ë¥¼ ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œí•˜ì—¬ ë¦¬ì†ŒìŠ¤ë¥¼ ì •ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤. ì´ ë°©ì‹ì€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì •ë¦¬ì™€ ì˜ˆì™¸ ê´€ë¦¬ì˜ ì±…ì„ì„ ê±°ì˜ ì „ì ìœ¼ë¡œ ë¶€ì—¬í•˜ë¯€ë¡œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê¸° ì‰½ìŠµë‹ˆë‹¤. ë” ì•ˆì „í•œ ë°©ë²•ìœ¼ë¡œ runInTransaction()ê³¼ callInTransaction() ë©”ì„œë“œ ì‚¬ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤: entityManagerFactory.runInTransaction(entityManager -&gt; { // ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‘ì—… ìˆ˜í–‰ ...});2. ì»¨í…Œì´ë„ˆ ê´€ë¦¬ ë°©ì‹ (Jakarta EE í™˜ê²½) ì˜ì¡´ì„± ì£¼ì…ì„ í†µí•´ ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” EntityManagerë¥¼ ì–»ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.@PersistenceContext(unitName=\"orderMgt\")EntityManager entityManager;ë¦¬ì†ŒìŠ¤ ë¡œì»¬ íŠ¸ëœì­ì…˜ ê´€ë¦¬ ì˜ì†ì„± ìœ ë‹›ì´ ë¦¬ì†ŒìŠ¤ ë¡œì»¬ íŠ¸ëœì­ì…˜ ê´€ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, getTransaction()ìœ¼ë¡œ ì–»ì€ EntityTransactionì„ ì‚¬ìš©í•˜ì—¬ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬í•´ì•¼ í•©ë‹ˆë‹¤:EntityManager entityManager = entityManagerFactory.createEntityManager();EntityTransaction transaction = entityManager.getTransaction();try { transaction.begin(); // ì‘ì—… ìˆ˜í–‰ ... transaction.commit();}catch (Exception e) { if (transaction.isActive()) transaction.rollback(); throw e;}finally { entityManager.close();}ì˜ì†ì„± ìœ ë‹› JPAì—ì„œ ê´€ë¦¬í•  ì—”í‹°í‹° í´ë˜ìŠ¤ë“¤ì˜ ë¬¶ìŒê³¼ ê·¸ ì„¤ì •ì„ ì •ì˜í•œ ê²ƒ ì¦‰, ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì–´ë–¤ ì—”í‹°í‹°ë“¤ì„ ì–´ë–¤ ë°ì´í„°ë² ì´ìŠ¤ì— ì–´ë–»ê²Œ ì—°ê²°í•  ê²ƒì¸ê°€ë¥¼ ì •ì˜í•œ ì„¤ì • ë‹¨ìœ„ persistence.xmlì— ì •ì˜&lt;persistence-unit name=\"orderMgt\"&gt; &lt;class&gt;com.example.Order&lt;/class&gt; &lt;class&gt;com.example.Customer&lt;/class&gt; &lt;properties&gt; &lt;property name=\"jakarta.persistence.jdbc.url\" value=\"jdbc:mysql://localhost/mydb\"/&gt; &lt;!-- ê¸°íƒ€ ì„¤ì • --&gt; &lt;/properties&gt;&lt;/persistence-unit&gt;ë¦¬ì†ŒìŠ¤ ë¡œì»¬ íŠ¸ëœì­ì…˜ JPAì—ëŠ” ë‘ ê°€ì§€ íŠ¸ëœì­ì…˜ ê´€ë¦¬ ë°©ì‹ì´ ìˆë‹¤: ë°©ì‹ ì„¤ëª… Â  JTA (Java Transaction API) ì»¨í…Œì´ë„ˆ(ì„œë²„)ê°€ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬. ì—¬ëŸ¬ ë°ì´í„°ë² ì´ìŠ¤ì— ê±¸ì¹œ ë¶„ì‚° íŠ¸ëœì­ì…˜ ê°€ëŠ¥. Jakarta EE í™˜ê²½ì—ì„œ ì£¼ë¡œ ì‚¬ìš©. Resource-Local ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì§ì ‘ íŠ¸ëœì­ì…˜ì„ ê´€ë¦¬. ë‹¨ì¼ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ì— ëŒ€í•´ì„œë§Œ ë™ì‘. Java SE í™˜ê²½ì´ë‚˜ Spring ë“±ì—ì„œ ì£¼ë¡œ ì‚¬ìš©. Â  // ë¦¬ì†ŒìŠ¤ ë¡œì»¬ ë°©ì‹EntityTransaction tx = entityManager.getTransaction();tx.begin();// ì‘ì—…tx.commit();Spring Data JPA ì‚¬ìš©ì‹œ ì˜ì†ì„± ìœ ë‹›ê³¼ ë¦¬ì†ŒìŠ¤ ë¡œì»¬ íŠ¸ëœì­ì…˜ Spring Data JPAë¥¼ ì‚¬ìš©í•˜ë©´ application.yml ë˜ëŠ” application.propertiesë¡œ ì„¤ì • Spring Bootê°€ ìë™ ì„¤ì •(Auto Configuration)ì„ í•´ì¤Œ # application.ymlspring: datasource: url: jdbc:mysql://localhost:3306/mydb username: root password: 1234 driver-class-name: com.mysql.cj.jdbc.Driver jpa: hibernate: ddl-auto: update properties: hibernate: dialect: org.hibernate.dialect.MySQLDialect ì´ ì„¤ì •ì´ ê³§ ì˜ì†ì„± ìœ ë‹› ì •ì˜ì…ë‹ˆë‹¤. Spring Bootê°€ ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ EntityManagerFactoryë¥¼ ìë™ ìƒì„±í•©ë‹ˆë‹¤. ì—”í‹°í‹° í´ë˜ìŠ¤ëŠ” @Entity ì–´ë…¸í…Œì´ì…˜ì´ ë¶™ì€ í´ë˜ìŠ¤ë“¤ì„ ìë™ ìŠ¤ìº”í•˜ì—¬ ë“±ë¡í•©ë‹ˆë‹¤. @Transactionalë¡œ ì„ ì–¸ì  ê´€ë¦¬@Service@RequiredArgsConstructorpublic class OrderService { private final UserRepository userRepository; private final OrderRepository orderRepository; @Transactional // ì´ê²Œ begin(), commit(), rollback()ì„ ëŒ€ì‹ í•¨ public void createOrder(User user, Order order) { userRepository.save(user); orderRepository.save(order); // ì˜ˆì™¸ ë°œìƒ ì‹œ ìë™ ë¡¤ë°±, ì •ìƒ ì¢…ë£Œ ì‹œ ìë™ ì»¤ë°‹ }}Persistence Context (ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸) ì—”í‹°í‹° ì¸ìŠ¤í„´ìŠ¤(@Entityê°€ ë¶™ì€ í´ë˜ìŠ¤ì˜ ê°ì²´)ë“¤ì„ ê´€ë¦¬í•˜ê³  ë³€ê²½ì„ ì¶”ì í•˜ëŠ” 1ì°¨ ìºì‹œ ì €ì¥ì†Œ(ë©”ëª¨ë¦¬ ê³µê°„) ê° EntityManager ì¸ìŠ¤í„´ìŠ¤ëŠ” ê³ ìœ í•œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì—°ê´€ë©ë‹ˆë‹¤. íŠ¹ì • ì˜ì† ì—”í‹°í‹° ì‹ë³„ì(ì—”í‹°í‹° íƒ€ì… + ê¸°ë³¸ í‚¤)ì— ëŒ€í•´ ìµœëŒ€ í•˜ë‚˜ì˜ ì—”í‹°í‹° ì¸ìŠ¤í„´ìŠ¤ë§Œ ì¡´ì¬ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì—°ê´€ëœ ì—”í‹°í‹° ì¸ìŠ¤í„´ìŠ¤ëŠ” ê´€ë¦¬ ê°ì²´(managed objects)ë¡œ ê°„ì£¼ë˜ë©°, ì˜ì†ì„± ì œê³µìì˜ ì œì–´ í•˜ì— ëª…í™•íˆ ì •ì˜ëœ ìƒëª…ì£¼ê¸°ë¥¼ ê°–ìŠµë‹ˆë‹¤.ì—”í‹°í‹° ìƒëª…ì£¼ê¸° ìƒíƒœ ìƒíƒœ ì„¤ëª… New (ë¹„ì˜ì†) ì˜ì† ì‹ë³„ìê°€ ì—†ê³ , ì–´ë–¤ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ë„ ì—°ê´€ë˜ì§€ ì•ŠìŒ Managed (ì˜ì†) ì˜ì† ì‹ë³„ìê°€ ìˆê³ , í˜„ì¬ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì—°ê´€ë¨ Detached (ì¤€ì˜ì†) ì˜ì† ì‹ë³„ìê°€ ìˆì§€ë§Œ, í™œì„± ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì—°ê´€ë˜ì§€ ì•ŠìŒ (ë˜ëŠ” ë” ì´ìƒ ì—°ê´€ë˜ì§€ ì•ŠìŒ) Removed (ì‚­ì œ) ì˜ì† ì‹ë³„ìê°€ ìˆê³ , ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì—°ê´€ë˜ì–´ ìˆìœ¼ë©°, íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì‹œ DBì—ì„œ ì‚­ì œ ì˜ˆì • EntityManager API ì£¼ìš” ê¸°ëŠ¥ EntityManager APIëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ìƒíƒœì— ì˜í–¥ì„ ì£¼ê±°ë‚˜ ê°œë³„ ì—”í‹°í‹° ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒëª…ì£¼ê¸° ìƒíƒœë¥¼ ìˆ˜ì •í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰ persist(Object) : ì—”í‹°í‹°ë¥¼ ì˜ì†í™” remove(Object) : ì—”í‹°í‹°ë¥¼ ì‚­ì œ ì˜ˆì • ìƒíƒœë¡œ ë³€ê²½ find() : ê¸°ë³¸ í‚¤ë¡œ ì—”í‹°í‹° ì¡°íšŒ ì¿¼ë¦¬ ì‹¤í–‰: ì—”í‹°í‹° íƒ€ì…ì— ëŒ€í•œ ì¿¼ë¦¬ ìˆ˜í–‰ detach(Object) : ì—”í‹°í‹°ë¥¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¶„ë¦¬ clear() : ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì™„ì „íˆ ë¹„ìš°ê³  ëª¨ë“  ì—”í‹°í‹°ë¥¼ ë¶„ë¦¬ merge() : ì¤€ì˜ì† ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒíƒœë¥¼ ë™ì¼í•œ ì˜ì† ì‹ë³„ìë¥¼ ê°€ì§„ ê´€ë¦¬ ì¸ìŠ¤í„´ìŠ¤ì— ë³‘í•©â€» ì°¸ê³ : ëª…ì‹œì ì¸ â€œupdateâ€ ì‘ì—…ì€ ì—†ìŠµë‹ˆë‹¤. ì—”í‹°í‹°ëŠ” ê´€ë¦¬ ê°ì²´ì´ë¯€ë¡œ, í™œì„± ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì—°ê´€ë˜ì–´ ìˆëŠ” í•œ ì˜ì† í•„ë“œ ë° ì†ì„±ì˜ ìˆ˜ì •ì´ ìë™ìœ¼ë¡œ ê°ì§€ë©ë‹ˆë‹¤.í”ŒëŸ¬ì‹œ(Flush) ë©”ì»¤ë‹ˆì¦˜ Flush : ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ë³€ê²½ ë‚´ìš©ì„ DBì— SQLë¡œ ì „ì†¡í•˜ëŠ” ê²ƒ (ë‹¨, ì»¤ë°‹ì€ ì•„ë‹˜)ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì—°ê´€ëœ ì—”í‹°í‹° ìƒíƒœ ìˆ˜ì •ì€ ì¦‰ì‹œ DBì™€ ë™ê¸°í™”ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.ë™ê¸°í™”ëŠ” í”ŒëŸ¬ì‹œ(flush) ê³¼ì •ì—ì„œ ë°œìƒí•©ë‹ˆë‹¤.[ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸] --flush--&gt; [DBë¡œ SQL ì „ì†¡] --commit--&gt; [DB í™•ì •] (ë©”ëª¨ë¦¬) (SQL ì‹¤í–‰) (íŠ¸ëœì­ì…˜ ì™„ë£Œ) í”ŒëŸ¬ì‹œ ëª¨ë“œ ë™ì‘ FlushModeType.COMMIT íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì „ì— í”ŒëŸ¬ì‹œ FlushModeType.AUTO (ê¸°ë³¸ê°’) ì»¤ë°‹ ì „ + í”ŒëŸ¬ì‹œë˜ì§€ ì•Šì€ ìˆ˜ì • ì‚¬í•­ì˜ ì˜í–¥ì„ ë°›ì„ ì¿¼ë¦¬ ì‹¤í–‰ ì „ì—ë„ í”ŒëŸ¬ì‹œ ì˜ˆì‹œ@Transactionalpublic void example() { Member member = new Member(\"í™ê¸¸ë™\"); em.persist(member); // â‘  ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ë§Œ ì €ì¥ (DBì— INSERT ì•„ì§ ì•ˆ í•¨) // â‘¡ ì´ ì‹œì ì— ì¡°íšŒí•˜ë©´? List&lt;Member&gt; members = em.createQuery(\"SELECT m FROM Member m\", Member.class) .getResultList();} AUTO ëª¨ë“œ (ê¸°ë³¸)â‘  persist() â†’ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥â‘¡ ì¿¼ë¦¬ ì‹¤í–‰ ì§ì „ â†’ ìë™ flush â†’ INSERT ì‹¤í–‰â‘¢ SELECT ì‹¤í–‰ â†’ \"í™ê¸¸ë™\" ì¡°íšŒë¨ COMMIT ëª¨ë“œâ‘  persist() â†’ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥â‘¡ ì¿¼ë¦¬ ì‹¤í–‰ â†’ flush ì•ˆ í•¨ â†’ INSERT ì•ˆ ë¨â‘¢ SELECT ì‹¤í–‰ â†’ \"í™ê¸¸ë™\" ì¡°íšŒ ì•ˆë¨ (ì•„ì§ DBì— ì—†ìŒ)â‘£ ì»¤ë°‹ ì‹œì  â†’ flush â†’ INSERT ì‹¤í–‰@Transactionalpublic void example() { // 1. ìƒˆ ë©¤ë²„ ì €ì¥ Member member = new Member(\"í™ê¸¸ë™\"); em.persist(member); // ì´ ì‹œì : ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ë§Œ ìˆìŒ, DBì—ëŠ” ì•„ì§ ì—†ìŒ // 2. ì´ë¦„ ë³€ê²½ member.setName(\"ê¹€ì² ìˆ˜\"); // ì´ ì‹œì : ë³€ê²½ ê°ì§€ë¨, í•˜ì§€ë§Œ UPDATE SQL ì•„ì§ ì•ˆ ë‚˜ê° // 3. JPQL ì¿¼ë¦¬ ì‹¤í–‰ List&lt;Member&gt; result = em.createQuery(\"SELECT m FROM Member m\").getResultList(); // AUTO ëª¨ë“œ: ì¿¼ë¦¬ ì§ì „ì— flush! // â†’ INSERT INTO member (name) VALUES ('ê¹€ì² ìˆ˜') ì‹¤í–‰ // â†’ SELECT * FROM member ì‹¤í–‰ // â†’ ê²°ê³¼ì— \"ê¹€ì² ìˆ˜\" í¬í•¨ë¨} // íŠ¸ëœì­ì…˜ ì¢…ë£Œ â†’ commit@Transactionalpublic void test() { Member member = new Member(\"í™ê¸¸ë™\"); em.persist(member); System.out.println(\"=== Foo ì¡°íšŒ ì „ ===\"); List&lt;Foo&gt; foos = em.createQuery(\"SELECT f FROM Foo f\", Foo.class) .getResultList(); System.out.println(\"=== Foo ì¡°íšŒ í›„ ===\");}// ì½˜ì†” ì¶œë ¥ (Hibernate):// === Foo ì¡°íšŒ ì „ ===// SELECT f FROM Foo f â† INSERT ì—†ì´ ë°”ë¡œ SELECT// === Foo ì¡°íšŒ í›„ ===// (ì»¤ë°‹ ì‹œì ì— INSERT ì‹¤í–‰)ì ê¸ˆ(Locking) ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ëŠ” íŠ¹ì • ì‹œì ì— ì—”í‹°í‹° ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•´ ë‚™ê´€ì (optimistic) ë˜ëŠ” ë¹„ê´€ì (pessimistic) ì ê¸ˆì„ ë³´ìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª…ì‹œì  LockModeTypeì„ ë°›ëŠ” ë©”ì„œë“œ: lock(Object, LockModeType) refresh(Object, LockModeType) find(Class, Object, LockModeType) ìºì‹œ ìƒí˜¸ì‘ìš© ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(1ì°¨ ìºì‹œ)ì™€ 2ì°¨ ìºì‹œ ê°„ì˜ ìƒí˜¸ì‘ìš©ì€ ë‹¤ìŒ ë©”ì„œë“œë¡œ ì œì–´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤: setCacheRetrieveMode(CacheRetrieveMode) setCacheStoreMode(CacheStoreMode) ì½”ë“œë¡œ ì‚´í´ë³´ëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ex : EntityManager.persist() í˜¸ì¶œì‹œ íë¦„EntityManager.persist(user) â†“SessionImpl.persist(user) // Hibernateì˜ EntityManager êµ¬í˜„ì²´ â†“DefaultPersistEventListener.onPersist() â†“StatefulPersistenceContext.addEntity(entityKey, user) // ì—¬ê¸°ì„œ Mapì— ì €ì¥!public class StatefulPersistenceContext implements PersistenceContext { private static final CoreMessageLogger LOG = (CoreMessageLogger)Logger.getMessageLogger(CoreMessageLogger.class, StatefulPersistenceContext.class.getName()); private static final int INIT_COLL_SIZE = 8; private final SharedSessionContractImplementor session; private EntityEntryContext entityEntryContext; private HashMap&lt;EntityKey, EntityHolderImpl&gt; entitiesByKey; ... private Map&lt;EntityKey, EntityHolderImpl&gt; getOrInitializeEntitiesByKey() { if (this.entitiesByKey == null) { this.entitiesByKey = CollectionHelper.mapOfSize(8); } return this.entitiesByKey; } public void addEntity(EntityKey key, Object entity) { this.addEntityHolder(key, entity); } public EntityHolder addEntityHolder(EntityKey key, Object entity) { Map&lt;EntityKey, EntityHolderImpl&gt; entityHolderMap = this.getOrInitializeEntitiesByKey(); EntityHolderImpl oldHolder = (EntityHolderImpl)entityHolderMap.get(key); EntityHolderImpl holder; if (oldHolder != null) { oldHolder.entity = entity; holder = oldHolder; } else { entityHolderMap.put(key, holder = StatefulPersistenceContext.EntityHolderImpl.forEntity(key, key.getPersister(), entity)); } holder.state = StatefulPersistenceContext.EntityHolderState.INITIALIZED; BatchFetchQueue fetchQueue = this.batchFetchQueue; if (fetchQueue != null) { fetchQueue.removeBatchLoadableEntityKey(key); } return holder; } ...}public final class EntityKey implements Serializable { private final @UnknownKeyFor @NonNull @Initialized Object identifier; private final @UnknownKeyFor @NonNull @Initialized int hashCode; private final @UnknownKeyFor @NonNull @Initialized EntityPersister persister; ...}ìš”ì•½SessionImpl (EntityManager êµ¬í˜„ì²´) â”‚ â””â”€â”€ StatefulPersistenceContext (ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ êµ¬í˜„ì²´) â”‚ â””â”€â”€ Map&lt;EntityKey, Object&gt; entitiesByKey â† ì´ê²Œ 1ì°¨ ìºì‹œ! â”‚ â”œâ”€â”€ Key: EntityKey(User, 1L) â”‚ Value: User(id=1, name=\"í™ê¸¸ë™\") â”‚ â”œâ”€â”€ Key: EntityKey(User, 2L) â”‚ Value: User(id=2, name=\"ê¹€ì² ìˆ˜\") â”‚ â””â”€â”€ Key: EntityKey(Order, 100L) Value: Order(id=100, ...)ì°¸ê³ ìë£Œ https://jakarta.ee/specifications/persistence/3.2/apidocs/jakarta.persistence/jakarta/persistence/entitymanager https://docs.hibernate.org/orm/6.6/userguide/html_single/ https://docs.hibernate.org/stable/entitymanager/reference/en/html_single/#d0e61" }, { "title": "AWS ë¦¬ì „ê³¼ ê°€ìš© ì˜ì—­", "url": "/posts/aws-regions-and-az/", "categories": "ì§€ì‹ ë”í•˜ê¸°, AWS", "tags": "AWS", "date": "2026-01-01 22:25:00 +0900", "snippet": " AWS ì„œë¹„ìŠ¤ëŠ” ì „ ì„¸ê³„ ì—¬ëŸ¬ ìœ„ì¹˜ì— ë¶„ì‚°ë˜ì–´ í˜¸ìŠ¤íŒ…ë˜ë©°, ì´ëŸ¬í•œ ìœ„ì¹˜ë“¤ì€ AWS Region, Availability Zone, Local Zone, Wavelength Zoneìœ¼ë¡œ êµ¬ì„±ëœë‹¤.AWS Regions ë¬¼ë¦¬ì ìœ¼ë¡œ ë¶„ë¦¬ëœ ë…ë¦½ì ì¸ ì§€ë¦¬ì  ì˜ì—­ì´ë‹¤.(ì¶œì²˜ : https://docs.aws.amazon.com/global-infrastru...", "content": " AWS ì„œë¹„ìŠ¤ëŠ” ì „ ì„¸ê³„ ì—¬ëŸ¬ ìœ„ì¹˜ì— ë¶„ì‚°ë˜ì–´ í˜¸ìŠ¤íŒ…ë˜ë©°, ì´ëŸ¬í•œ ìœ„ì¹˜ë“¤ì€ AWS Region, Availability Zone, Local Zone, Wavelength Zoneìœ¼ë¡œ êµ¬ì„±ëœë‹¤.AWS Regions ë¬¼ë¦¬ì ìœ¼ë¡œ ë¶„ë¦¬ëœ ë…ë¦½ì ì¸ ì§€ë¦¬ì  ì˜ì—­ì´ë‹¤.(ì¶œì²˜ : https://docs.aws.amazon.com/global-infrastructure/latest/regions/aws-regions-availability-zones.html) ê° Regionì€ ë‹¤ë¥¸ Regionê³¼ ì™„ì „íˆ ê²©ë¦¬ë˜ë„ë¡ ì„¤ê³„ë˜ì—ˆë‹¤. ì´ë¥¼ í†µí•´ ìµœëŒ€ ìˆ˜ì¤€ì˜ ì¥ì•  í—ˆìš©ì„±ê³¼ ì•ˆì •ì„±ì„ ë‹¬ì„±í•œë‹¤. ëŒ€ë¶€ë¶„ì˜ AWS ì„œë¹„ìŠ¤ëŠ” Region ë‹¨ìœ„ ë¦¬ì†ŒìŠ¤ë¥¼ ì§€ì›í•œë‹¤. AWS ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°íšŒí•  ë•ŒëŠ” ë°˜ë“œì‹œ Regionì„ ì§€ì •í•´ì•¼ í•˜ë©°, í•´ë‹¹ Regionì— ì†í•œ ë¦¬ì†ŒìŠ¤ë§Œ í‘œì‹œëœë‹¤. ì¼ë¶€ ë¦¬ì†ŒìŠ¤ëŠ” Region ê°„ ë³µì œê°€ ê°€ëŠ¥í•˜ì§€ë§Œ, AWSê°€ ì´ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜í–‰í•˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. ì¦‰, DR ì„¤ê³„ëŠ” ì‚¬ìš©ì ì±…ì„ ì˜ì—­ ê° Regionì€ ì—¬ëŸ¬ ê°œì˜ ë…ë¦½ì ì¸ ìœ„ì¹˜, ì¦‰ Availability Zoneìœ¼ë¡œ êµ¬ì„±ëœë‹¤. Region ë‚´ì˜ Availability Zoneë“¤ì€ ì „ìš© ë©”íŠ¸ë¡œ ê´‘ì„¬ìœ ë§ì„ í†µí•´ ì €ì§€ì—°, ê³ ëŒ€ì—­í­, ê³ ì¤‘ë³µì„± ë„¤íŠ¸ì›Œí¬ë¡œ ìƒí˜¸ ì—°ê²°ëœë‹¤. ì›Œí¬ë¡œë“œë¥¼ ë°°í¬í•˜ê¸° ì „ì—, ìš”êµ¬ ì‚¬í•­ì„ ê°€ì¥ ì˜ ì¶©ì¡±í•˜ëŠ” Region ë˜ëŠ” Regionsë¥¼ ê³ ë ¤í•´ì•¼ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, í•„ìš”í•œ AWS ì„œë¹„ìŠ¤ì™€ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” Regionì„ ì„ íƒí•´ì•¼ í•˜ë©°, ëŒ€ë‹¤ìˆ˜ ì‚¬ìš©ìì™€ ì§€ë¦¬ì ìœ¼ë¡œ ê°€ê¹Œìš´ Regionì„ ì„ íƒí•˜ë©´ ë„¤íŠ¸ì›Œí¬ ì§€ì—° ì‹œê°„ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤. ê³„ì • ìœ í˜• ì‚¬ìš©ìê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Regionì€ ê³„ì • ìœ í˜•ì— ì˜í•´ ê²°ì •ëœë‹¤.ì¼ë°˜ AWS ê³„ì • ì—¬ëŸ¬ Regionì„ ì œê³µí•˜ë©°, ì´ë¥¼ í†µí•´ ìš”êµ¬ ì‚¬í•­ì— ë§ëŠ” ìœ„ì¹˜ì— AWS ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìœ ëŸ½ ê³ ê°ê³¼ì˜ ê±°ë¦¬ ë‹¨ì¶•ì´ë‚˜ ë²•ì  ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±í•˜ê¸° ìœ„í•´ ìœ ëŸ½ Regionì— ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. GovCloud ê³„ì • AWS GovCloud (US-West) ë° AWS GovCloud (US-East) Regionì— ëŒ€í•œ ì ‘ê·¼ì„ ì œê³µí•œë‹¤. ë¯¸êµ­ ì •ë¶€Â·ê³µê³µê¸°ê´€Â·ê·œì œ ì‚°ì—… ì „ìš© ê³„ì •ìœ¼ë¡œ, ì¼ë°˜ AWS ê³„ì •ê³¼ ì™„ì „íˆ ë¶„ë¦¬ëœ Region ì§‘í•©ì¤‘êµ­ ê³„ì • ë² ì´ì§• ë° ë‹ìƒ¤(Ningxia) Regionì—ë§Œ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤. ì¦‰, ì¤‘êµ­ ë¦¬ì „ì€ ì¤‘êµ­ ë²•ê·œì— ë”°ë¼ ì™„ì „íˆ ë…ë¦½ ìš´ì˜AWS Availability Zones í•˜ë‚˜ì˜ Region ë‚´ë¶€ì— ì¡´ì¬í•˜ëŠ”, ì„œë¡œ ê²©ë¦¬ëœ ìœ„ì¹˜ì´ë‹¤.(ì¶œì²˜ : https://docs.aws.amazon.com/global-infrastructure/latest/regions/aws-regions-availability-zones.html) ê° Regionì—ëŠ” ìµœì†Œ ì„¸ ê°œì˜ Availability Zoneì´ ì¡´ì¬í•œë‹¤. ì´ëŠ” AWS ìƒì—ì„œ ê³ ê°€ìš©ì„± ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„¤ê³„í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•¨ì´ë‹¤. ì¦‰, ì¥ì•  + ìœ ì§€ë³´ìˆ˜ + í™•ì¥ ìƒí™©ì„ ë™ì‹œì— ê³ ë ¤í•˜ê¸° ìœ„í•¨ì´ë©° AWSì—ì„œ ë§í•˜ëŠ” ê³ ê°€ìš©ì„±(HA) ì„¤ê³„ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ Multi-AZë¥¼ ì „ì œë¡œ í•œë‹¤. ê° Availability Zoneì€ í•˜ë‚˜ ì´ìƒì˜ ë…ë¦½ëœ ë°ì´í„° ì„¼í„°ë¡œ êµ¬ì„±ë˜ë©°, ê° ë°ì´í„° ì„¼í„°ëŠ” ì „ì›Â·ë„¤íŠ¸ì›Œí¬Â·ì—°ê²°ì˜ ì¤‘ë³µ êµ¬ì„±ì„ ê°–ì¶”ê³  ì„œë¡œ ë‹¤ë¥¸ ì‹œì„¤ì— ìœ„ì¹˜í•œë‹¤. Availability Zoneë“¤ì€ ë¬¼ë¦¬ì ìœ¼ë¡œ ë¶„ë¦¬ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, í™”ì¬Â·í† ë„¤ì´ë„Â·í™ìˆ˜ì™€ ê°™ì€ ì¬ë‚œì´ ë°œìƒí•˜ë”ë¼ë„ í•˜ë‚˜ì˜ AZë§Œ ì˜í–¥ì„ ë°›ë„ë¡ ì„¤ê³„ë˜ì–´ ìˆë‹¤. Availability Zoneì˜ ì½”ë“œëŠ” Region ì½”ë“œ ë’¤ì— ë¬¸ì ì‹ë³„ìë¥¼ ë¶™ì¸ í˜•íƒœì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, us-east-2a, us-east-2b, us-east-2cëŠ” us-east-2 Regionì— ì†í•œ Availability Zoneë“¤ì´ë‹¤. 2025ë…„ 11ì›” ì´ì „ì— ìƒì„±ëœ ê³„ì •ì˜ ê²½ìš°, ì¼ë¶€ ì˜¤ë˜ëœ Regionì—ì„œëŠ” Availability Zoneê³¼ AZ ì½”ë“œ ê°„ì˜ ë§¤í•‘ì´ AWS ê³„ì •ë³„ë¡œ ë…ë¦½ì ìœ¼ë¡œ ì´ë£¨ì–´ì§„ë‹¤. ì´ë¡œ ì¸í•´, í•œ ê³„ì •ì—ì„œì˜ us-east-1aê°€ ë‹¤ë¥¸ ê³„ì •ì—ì„œì˜ us-east-1aì™€ ë™ì¼í•œ ë¬¼ë¦¬ì  ìœ„ì¹˜ê°€ ì•„ë‹ ìˆ˜ ìˆë‹¤. ë°˜ë©´, 2025ë…„ 11ì›” ì´í›„ì— ìƒì„±ëœ ê³„ì •ì€ Availability Zoneê³¼ ì½”ë“œê°€ ë™ì¼í•˜ê²Œ ë§¤í•‘ëœë‹¤. ê° Availability Zoneì—ëŠ” AZ IDê°€ ìˆìœ¼ë©°, ì´ëŠ” ëª¨ë“  AWS ê³„ì •ì—ì„œ ë™ì¼í•œ ë¬¼ë¦¬ì  ìœ„ì¹˜ë¥¼ ì˜ë¯¸í•œë‹¤. AZ IDëŠ” Region ì½”ë“œì˜ ì• ì„¸ ê¸€ì, Region ì½”ë“œ ëì˜ ìˆ«ì, -az, ê·¸ë¦¬ê³  ìˆ«ìë¥¼ ì¡°í•©í•œ í˜•ì‹ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, euw1-az1, euw1-az2, euw1-az3ì€ eu-west-1 Regionì˜ Availability Zoneì— ëŒ€í•œ AZ IDì´ë‹¤. â€œê°™ì€ ë°ì´í„°ì„¼í„°ì— ë‘ì§€ ì•Šê² ë‹¤â€ëŠ” ìš”êµ¬ ì‚¬í•­ì€ AZ ì½”ë“œê°€ ì•„ë‹ˆë¼ AZ ID ê¸°ì¤€ìœ¼ë¡œ ê²€ì¦í•´ì•¼ í•¨ ì°¸ê³  ìë£Œ https://docs.aws.amazon.com/global-infrastructure/latest/regions/aws-regions-availability-zones.html https://docs.aws.amazon.com/global-infrastructure/latest/regions/aws-regions.html https://docs.aws.amazon.com/global-infrastructure/latest/regions/aws-availability-zones.html ChatGPT" }, { "title": "AWS VPC(Virtual Private Cloud) - ê¸°ì´ˆ ê°œë…", "url": "/posts/aws-vpc/", "categories": "ì§€ì‹ ë”í•˜ê¸°, AWS", "tags": "AWS", "date": "2025-12-31 00:20:00 +0900", "snippet": "AWS VPC(Virtual Private Cloud) ë…¼ë¦¬ì ìœ¼ë¡œ ê²©ë¦¬ëœ ê°€ìƒ ë„¤íŠ¸ì›Œí¬ ë¬¼ë¦¬ì ìœ¼ë¡œ ì„œë²„ê°€ ë”°ë¡œ ìˆëŠ” ê±´ ì•„ë‹ˆì§€ë§Œ, ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œ(IP), ë¼ìš°íŒ…, ì ‘ê·¼ ê·œì¹™ ê´€ì ì—ì„œëŠ” ì™„ì „íˆ ë¶„ë¦¬ëœ ì „ìš© ë„¤íŠ¸ì›Œí¬ IP ëŒ€ì—­(CIDR), ì„œë¸Œë„· êµ¬ì¡°, ë¼ìš°íŒ… ë°©ì‹ ë“±ì„ ì‚¬ìš©ìê°€ ì§ì ‘ ì„¤ê³„ ì¦‰, AWS ì•ˆì— ë‚´ê°€ ì§ì ‘ ë§Œë“  ê°€ìƒ ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ë¥¼ í•˜...", "content": "AWS VPC(Virtual Private Cloud) ë…¼ë¦¬ì ìœ¼ë¡œ ê²©ë¦¬ëœ ê°€ìƒ ë„¤íŠ¸ì›Œí¬ ë¬¼ë¦¬ì ìœ¼ë¡œ ì„œë²„ê°€ ë”°ë¡œ ìˆëŠ” ê±´ ì•„ë‹ˆì§€ë§Œ, ë„¤íŠ¸ì›Œí¬ ì£¼ì†Œ(IP), ë¼ìš°íŒ…, ì ‘ê·¼ ê·œì¹™ ê´€ì ì—ì„œëŠ” ì™„ì „íˆ ë¶„ë¦¬ëœ ì „ìš© ë„¤íŠ¸ì›Œí¬ IP ëŒ€ì—­(CIDR), ì„œë¸Œë„· êµ¬ì¡°, ë¼ìš°íŒ… ë°©ì‹ ë“±ì„ ì‚¬ìš©ìê°€ ì§ì ‘ ì„¤ê³„ ì¦‰, AWS ì•ˆì— ë‚´ê°€ ì§ì ‘ ë§Œë“  ê°€ìƒ ì‚¬ì„¤ ë„¤íŠ¸ì›Œí¬ë¥¼ í•˜ë‚˜ ê°–ëŠ” ê²ƒ(ì¶œì²˜ : https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html) ì´ VPCëŠ” í•˜ë‚˜ì˜ ë¦¬ì „ ì•ˆì—ì„œ, ê° ê°€ìš© ì˜ì—­(Availability Zone, AZ)ë§ˆë‹¤ í•˜ë‚˜ì˜ ì„œë¸Œë„·ì„ ê°€ì§€ê³  ìˆë‹¤. ê° ì„œë¸Œë„· ì•ˆì—ëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ë“¤ì´ ì‹¤í–‰ë˜ê³  ìˆë‹¤. ê·¸ë¦¬ê³  VPC ë‚´ë¶€ ë¦¬ì†ŒìŠ¤ë“¤ê³¼ ì¸í„°ë„· ê°„ì˜ í†µì‹ ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ê¸° ìœ„í•´ Internet Gatewayê°€ ì—°ê²°ë˜ì–´ ìˆë‹¤.ì„œë¸Œë„· ì„œë¸Œë„·ì€ VPC ë‚´ë¶€ì—ì„œ ì‚¬ìš©ë˜ëŠ” IP ì£¼ì†Œ ë²”ìœ„ì˜ ë…¼ë¦¬ì  êµ¬íšVPCê°€ â€œë„¤íŠ¸ì›Œí¬ ì „ì²´ ê³µê°„â€ì´ë¼ë©´, ì„œë¸Œë„·ì€ ê·¸ ì•ˆì˜ ì‹¤ì œ ë¦¬ì†ŒìŠ¤ ë°°ì¹˜ ë‹¨ìœ„ ì„œë¸Œë„· = CIDR ë¸”ë¡ (ì˜ˆ: 10.0.1.0/24) ì´ ë²”ìœ„ ì•ˆì—ì„œë§Œ IPê°€ í• ë‹¹ë¨ VPC CIDRì˜ ë¶€ë¶„ ì§‘í•© ì˜ˆ: VPCê°€ 10.0.0.0/16ì´ë©´, ì„œë¸Œë„·ì€ 10.0.1.0/24, 10.0.2.0/24 ê°™ì€ í˜•íƒœ EC2 ì¸ìŠ¤í„´ìŠ¤ì™€ ê°™ì€ AWS ë¦¬ì†ŒìŠ¤ëŠ” ë°˜ë“œì‹œ íŠ¹ì • ì„œë¸Œë„·ì— ì†Œì†ë˜ì–´ ìƒì„±ëœë‹¤. ì–´ëŠ ì„œë¸Œë„·ì— ë‘ëŠëƒê°€ ê³§ ë³´ì•ˆ + ê°€ìš©ì„± + ì ‘ê·¼ì„± ê²°ì • ê¸°ë³¸ ê°œë… ê° ì„œë¸Œë„·ì€ í•˜ë‚˜ì˜ AZ ì•ˆì— ì™„ì „íˆ í¬í•¨ë˜ì–´ì•¼ í•˜ë©°, ì—¬ëŸ¬ AZì— ê±¸ì³ êµ¬ì„±ë  ìˆ˜ ì—†ë‹¤. ì¦‰, ì„œë¸Œë„· â†” AZëŠ” 1:1 ì¢…ì† ê´€ê³„ ì´ ì œì•½ì€ ë¬¼ë¦¬ì  ì¥ì•  ê²©ë¦¬ë¥¼ ìœ„í•œ ì„¤ê³„ ì›ì¹™ AWS ë¦¬ì†ŒìŠ¤ë¥¼ ì„œë¡œ ë‹¤ë¥¸ AZì— ë¶„ì‚° ë°°ì¹˜í•˜ë©´, íŠ¹ì • AZì— ì¥ì• ê°€ ë°œìƒí•˜ë”ë¼ë„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ ì¥ì• ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆë‹¤. ì„œë¸Œë„· IP ì£¼ì†Œ ë²”ìœ„ ì„œë¸Œë„·ì„ ìƒì„±í•  ë•ŒëŠ”, VPCì˜ IP êµ¬ì„± ë°©ì‹(IPv4 only, Dual stack, IPv6 only)ì— ë”°ë¼ ì„œë¸Œë„·ì˜ IP ì£¼ì†Œ ì²´ê³„ë¥¼ ì§€ì •í•´ì•¼ í•œë‹¤.IPv4 only IPv4 CIDR ë¸”ë¡ë§Œì„ ê°€ì§€ë©° IPv6 CIDR ë¸”ë¡ì€ í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ ì„œë¸Œë„·ì— ì†í•œ ë¦¬ì†ŒìŠ¤ëŠ” IPv4 í”„ë¡œí† ì½œì„ í†µí•´ì„œë§Œ í†µì‹ í•  ìˆ˜ ìˆë‹¤.Dual stack ë“€ì–¼ ìŠ¤íƒ ì„œë¸Œë„·ì€ IPv4ì™€ IPv6 CIDR ë¸”ë¡ì„ ëª¨ë‘ ê°€ì§„ë‹¤. ì´ë¥¼ ìœ„í•´ì„œëŠ” VPC ìì²´ë„ IPv4ì™€ IPv6 CIDR ë¸”ë¡ì„ ëª¨ë‘ ë³´ìœ í•´ì•¼ í•œë‹¤. ë“€ì–¼ ìŠ¤íƒ ì„œë¸Œë„·ì˜ ë¦¬ì†ŒìŠ¤ëŠ” IPv4ì™€ IPv6 ì–‘ìª½ ëª¨ë‘ë¡œ í†µì‹ í•  ìˆ˜ ìˆë‹¤.IPv6 only IPv6 ì „ìš© ì„œë¸Œë„·ì€ IPv6 CIDR ë¸”ë¡ë§Œì„ ê°€ì§€ë©° IPv4 CIDR ë¸”ë¡ì€ í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ë¥¼ ìœ„í•´ VPCëŠ” ë°˜ë“œì‹œ IPv6 CIDR ë¸”ë¡ì„ ê°€ì§€ê³  ìˆì–´ì•¼ í•œë‹¤. í•´ë‹¹ ì„œë¸Œë„·ì˜ ë¦¬ì†ŒìŠ¤ëŠ” IPv6ì„ í†µí•´ì„œë§Œ í†µì‹ í•œë‹¤. IPv6 ì „ìš© ì„œë¸Œë„·ì˜ ë¦¬ì†ŒìŠ¤ì—ëŠ” 169.254.0.0/16 ë²”ìœ„ì˜ IPv4 ë§í¬ ë¡œì»¬ ì£¼ì†Œê°€ ìë™ìœ¼ë¡œ í• ë‹¹ëœë‹¤. ì´ ì£¼ì†Œë“¤ì€ VPC ë‚´ë¶€ì—ì„œë§Œ ì œê³µë˜ëŠ” ì„œë¹„ìŠ¤ì™€ì˜ í†µì‹ ì— ì‚¬ìš©ëœë‹¤. ì„œë¸Œë„· ìœ í˜• ì„œë¸Œë„·ì˜ ìœ í˜•ì€ ë¼ìš°íŒ… í…Œì´ë¸” ì„¤ì • ë°©ì‹ì— ì˜í•´ ê²°ì •ëœë‹¤.Public subnet Internet Gatewayë¡œ í–¥í•˜ëŠ” ì§ì ‘ì ì¸ ë¼ìš°íŠ¸ê°€ ì„¤ì •ëœ ì„œë¸Œë„·ì´ë‹¤. ì´ ì„œë¸Œë„·ì˜ ë¦¬ì†ŒìŠ¤ëŠ” ê³µì¸ ì¸í„°ë„·ì— ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ALB, Bastion Host, NAT Gateway ë“± ìœ„ì¹˜ Private subnet Internet Gatewayë¡œ ì§ì ‘ ì—°ê²°ë˜ëŠ” ë¼ìš°íŠ¸ë¥¼ ê°€ì§€ì§€ ì•ŠëŠ”ë‹¤. í¼ë¸”ë¦­ ì¸í„°ë„· ì ‘ê·¼ì´ í•„ìš”í•  ê²½ìš° NAT ì¥ì¹˜ë¥¼ í†µí•´ì•¼ í•œë‹¤.VPN-only subnet Virtual Private Gatewayë¥¼ í†µí•´ Site-to-Site VPN ì—°ê²°ë¡œ í–¥í•˜ëŠ” ë¼ìš°íŠ¸ë¥¼ ê°€ì§„ë‹¤. Internet Gatewayë¡œì˜ ë¼ìš°íŠ¸ëŠ” ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤.Isolated subnet VPC ì™¸ë¶€ë¡œ ë‚˜ê°€ëŠ” ì–´ë–¤ ë¼ìš°íŠ¸ë„ ê°€ì§€ì§€ ì•ŠëŠ”ë‹¤. ì´ ì„œë¸Œë„·ì˜ ë¦¬ì†ŒìŠ¤ëŠ” ë™ì¼ VPC ë‚´ ë¦¬ì†ŒìŠ¤ì™€ë§Œ í†µì‹ í•  ìˆ˜ ìˆë‹¤.EVS subnet Amazon EVSë¥¼ ì‚¬ìš©í•´ ìƒì„±ë˜ëŠ” íŠ¹ìˆ˜í•œ ì„œë¸Œë„·ì´ë‹¤.ì„œë¸Œë„· ë¼ìš°íŒ… ê° ì„œë¸Œë„·ì€ ë°˜ë“œì‹œ í•˜ë‚˜ì˜ ë¼ìš°íŠ¸ í…Œì´ë¸”ê³¼ ì—°ê²°ë˜ì–´ì•¼ í•˜ë©°, ì´ ë¼ìš°íŠ¸ í…Œì´ë¸”ì€ í•´ë‹¹ ì„œë¸Œë„·ì—ì„œ ì™¸ë¶€ë¡œ ë‚˜ê°€ëŠ” íŠ¸ë˜í”½ì´ ì–´ë–¤ ê²½ë¡œë¡œ ë‚˜ê°ˆ ìˆ˜ ìˆëŠ”ì§€ë¥¼ ì •ì˜í•œë‹¤. í¼ë¸”ë¦­, í”„ë¼ì´ë¹— ì—¬ë¶€ëŠ” ì„œë¸Œë„· ìì²´ê°€ ì•„ë‹ˆë¼ ë¼ìš°íŠ¸ í…Œì´ë¸”ì´ ê²°ì • ìƒˆë¡œ ìƒì„±ë˜ëŠ” ëª¨ë“  ì„œë¸Œë„·ì€ ê¸°ë³¸ì ìœ¼ë¡œ VPCì˜ ë©”ì¸ ë¼ìš°íŠ¸ í…Œì´ë¸”(Main Route Table)ê³¼ ìë™ìœ¼ë¡œ ì—°ê²°ëœë‹¤. VPCì—ëŠ” ë°˜ë“œì‹œ Main Route Tableì´ 1ê°œ ì¡´ì¬ ì„œë¸Œë„·ê³¼ ë¼ìš°íŠ¸ í…Œì´ë¸”ì˜ ì—°ê²° ê´€ê³„ëŠ” ë³€ê²½í•  ìˆ˜ ìˆìœ¼ë©°, ë©”ì¸ ë¼ìš°íŠ¸ í…Œì´ë¸” ìì²´ì˜ ë¼ìš°íŒ… ê·œì¹™ ë˜í•œ ìˆ˜ì •í•  ìˆ˜ ìˆë‹¤.ì˜ˆì‹œ : í¼ë¸”ë¦­ ì„œë¸Œë„·ìš© Route Table ì¸í„°ë„·ê³¼ ì§ì ‘ í†µì‹  ê°€ëŠ¥í•œ ì„œë¸Œë„· Destination Target 10.0.0.0/16 local 0.0.0.0/0 igw-0a1b2c3d 10.0.0.0/16 â†’ local ê°™ì€ VPC ë‚´ë¶€ í†µì‹  ì¦‰, ì´ VPCì˜ CIDR ë²”ìœ„ ì•ˆì— ìˆëŠ” ëª¨ë“  IPë¡œ ê°€ëŠ” íŠ¸ë˜í”½ì€ VPC ë‚´ë¶€(local)ì—ì„œ ì²˜ë¦¬í•˜ë¼ëŠ” ì˜ë¯¸ ëª¨ë“  Route Tableì— ê¸°ë³¸ìœ¼ë¡œ ì¡´ì¬ AWS VPCëŠ” â€œVPC ë‚´ë¶€ í†µì‹ ì€ í•­ìƒ ê°€ëŠ¥í•´ì•¼ í•œë‹¤â€ë¼ëŠ” ì „ì œë¥¼ ê¹”ê³  ì„¤ê³„ë¨ ê·¸ë˜ì„œ VPC ìƒì„± ì‹œ, Route Table ìƒì„± ì‹œ Subnet ì—°ê²° ì—¬ë¶€ì™€ ë¬´ê´€í•˜ê²Œ VPC CIDR â†’ local ë¼ìš°íŠ¸ëŠ” ìë™ ìƒì„± 0.0.0.0/0 â†’ IGW VPC ë°–(ì¸í„°ë„·)ìœ¼ë¡œ ë‚˜ê°€ëŠ” ëª¨ë“  íŠ¸ë˜í”½ Internet Gatewayë¥¼ í†µí•´ ì§ì ‘ ì¸í„°ë„· ì ‘ê·¼ ê°€ëŠ¥ ì˜ˆì‹œ : í”„ë¼ì´ë¹— ì„œë¸Œë„·ìš© Route Table ì¸í„°ë„· ì§ì ‘ ë…¸ì¶œ ì—†ì´, ì•„ì›ƒë°”ìš´ë“œë§Œ í—ˆìš© Destination Target 10.0.0.0/16 local 0.0.0.0/0 nat-0f9e8d7c 10.0.0.0/16 â†’ local VPC ë‚´ë¶€ í†µì‹  0.0.0.0/0 â†’ NAT ì™¸ë¶€ ì¸í„°ë„·ìœ¼ë¡œ ë‚˜ê°ˆ ë•Œ NAT Gateway ê²½ìœ  ì™¸ë¶€ì—ì„œ ì§ì ‘ ë“¤ì–´ì˜¤ëŠ” ì¸ë°”ìš´ë“œëŠ” ë¶ˆê°€ ì„œë¸Œë„· ì„¤ì • ëª¨ë“  ì„œë¸Œë„·ì—ëŠ” í•´ë‹¹ ì„œë¸Œë„·ì—ì„œ ìƒì„±ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì— ê³µì¸ IPv4 ì£¼ì†Œ(ë° í•´ë‹¹ë˜ëŠ” ê²½ìš° IPv6 ì£¼ì†Œ)ë¥¼ ìë™ í• ë‹¹í• ì§€ ì—¬ë¶€ë¥¼ ê²°ì •í•˜ëŠ” ì„¤ì • ê°’ì´ ì¡´ì¬í•˜ë©°, ìˆ˜ì •ì´ ê°€ëŠ¥í•˜ë‹¤. ì´ ì„¤ì •ì€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í•´ë‹¹ ì„œë¸Œë„·ì— ìƒì„±í•  ë•Œ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì§€ëŠ” ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤(ì˜ˆ: eth0)ì—ë„ ì ìš©ëœë‹¤. ì„œë¸Œë„·ì˜ ê¸°ë³¸ ì„¤ì •ê³¼ ë¬´ê´€í•˜ê²Œ, ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ì‹œì ì— ê°œë³„ ì¸ìŠ¤í„´ìŠ¤ ë‹¨ìœ„ë¡œ ì´ ì„¤ì •ì„ ì¬ì •ì˜í•  ìˆ˜ ìˆë‹¤. ì˜ˆ : í¼ë¸”ë¦­ ì„œë¸Œë„·ì´ì§€ë§Œ íŠ¹ì • EC2ë§Œ ê³µì¸ IP ë¯¸ë¶€ì—¬ ê°€ëŠ¥ ì„œë¸Œë„· ë³´ì•ˆ AWS ë¦¬ì†ŒìŠ¤ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•´, AWSëŠ” í”„ë¼ì´ë¹— ì„œë¸Œë„· ì‚¬ìš©ì„ ê¶Œì¥í•œë‹¤. í”„ë¼ì´ë¹— ì„œë¸Œë„·ì— ìˆëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ì™€ ê°™ì€ ë¦¬ì†ŒìŠ¤ê°€ ì¸í„°ë„· ì ‘ê·¼ì´ í•„ìš”í•  ê²½ìš°, Bastion Host ë˜ëŠ” NAT ì¥ì¹˜ë¥¼ í†µí•´ ì ‘ê·¼í•˜ë„ë¡ êµ¬ì„±í•œë‹¤. Bastion Host: ê´€ë¦¬ ëª©ì  ì¸ë°”ìš´ë“œ ì ‘ê·¼ NAT Gateway / NAT Instance: ì•„ì›ƒë°”ìš´ë“œ ì¸í„°ë„· ì ‘ê·¼ ë³´ì•ˆ ê·¸ë£¹(Security Group)ì€ EC2 ì¸ìŠ¤í„´ìŠ¤ì™€ ê°™ì€ ê°œë³„ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ í—ˆìš©ë˜ëŠ” ì¸ë°”ìš´ë“œ ë° ì•„ì›ƒë°”ìš´ë“œ íŠ¸ë˜í”½ì„ ì œì–´í•œë‹¤. ë„¤íŠ¸ì›Œí¬ ACL(Network ACL)ì€ ì„œë¸Œë„· ë‹¨ìœ„ì—ì„œ ì¸ë°”ìš´ë“œ ë° ì•„ì›ƒë°”ìš´ë“œ íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ê±°ë‚˜ ì°¨ë‹¨í•œë‹¤. ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ë³´ì•ˆ ê·¸ë£¹ë§Œìœ¼ë¡œë„ ìš”êµ¬ë˜ëŠ” ë³´ì•ˆ ìˆ˜ì¤€ì„ ì¶©ì¡±í•  ìˆ˜ ìˆë‹¤. ì¶”ê°€ì ì¸ ë³´ì•ˆ ê³„ì¸µì´ í•„ìš”í•œ ê²½ìš°ì—ëŠ” ë„¤íŠ¸ì›Œí¬ ACLì„ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì„¤ê³„ìƒ ëª¨ë“  ì„œë¸Œë„·ì€ ë°˜ë“œì‹œ í•˜ë‚˜ì˜ ë„¤íŠ¸ì›Œí¬ ACLê³¼ ì—°ê²°ë˜ì–´ì•¼ í•œë‹¤. ìƒˆë¡œ ìƒì„±ë˜ëŠ” ëª¨ë“  ì„œë¸Œë„·ì€ ê¸°ë³¸ì ìœ¼ë¡œ VPCì˜ ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ACLê³¼ ìë™ ì—°ê²°ëœë‹¤. ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ACLì€ ëª¨ë“  ì¸ë°”ìš´ë“œ ë° ì•„ì›ƒë°”ìš´ë“œ íŠ¸ë˜í”½ì„ í—ˆìš©í•œë‹¤. ë³´ì•ˆ ê·¸ë£¹ (Security Groups, SG) ìì‹ ì´ ì—°ê²°ëœ ë¦¬ì†ŒìŠ¤ë¡œ ë“¤ì–´ì˜¤ê±°ë‚˜(Inbound) ë‚˜ê°€ëŠ”(Outbound) íŠ¸ë˜í”½ ì¤‘ í—ˆìš©ëœ íŠ¸ë˜í”½ë§Œì„ ì œì–´í•˜ëŠ” ë³´ì•ˆ ì •ì±… ì§‘í•© ì˜ˆë¥¼ ë“¤ì–´, ë³´ì•ˆ ê·¸ë£¹ì„ EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì—°ê²°í•˜ë©´ í•´ë‹¹ ë³´ì•ˆ ê·¸ë£¹ì´ ê·¸ ì¸ìŠ¤í„´ìŠ¤ì˜ ì¸ë°”ìš´ë“œ ë° ì•„ì›ƒë°”ìš´ë“œ íŠ¸ë˜í”½ì„ ì œì–´í•˜ê²Œ ëœë‹¤. í•˜ë‚˜ì˜ EC2ì— ì—¬ëŸ¬ SG ì—°ê²° ê°€ëŠ¥ ì—¬ëŸ¬ EC2ê°€ ê°™ì€ SG ê³µìœ  ê°€ëŠ¥ VPCë¥¼ ìƒì„±í•˜ë©´, í•´ë‹¹ VPCì—ëŠ” ê¸°ë³¸ ë³´ì•ˆ ê·¸ë£¹ì´ ìë™ìœ¼ë¡œ í•¨ê»˜ ìƒì„±ëœë‹¤. ê¸°ë³¸ SG íŠ¹ì§•: ì¸ë°”ìš´ë“œ : ì•„ë¬´ê²ƒë„ í—ˆìš© ì•ˆ í•¨ (ë‹¨, ìê¸° ìì‹  ì œì™¸) ì•„ì›ƒë°”ìš´ë“œ : ëª¨ë“  íŠ¸ë˜í”½ í—ˆìš© ê° ì¸ë°”ìš´ë“œ ê·œì¹™ì—ëŠ” íŠ¸ë˜í”½ì˜ ì¶œë°œì§€, í¬íŠ¸ ë²”ìœ„, í”„ë¡œí† ì½œì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤. ê° ì•„ì›ƒë°”ìš´ë“œ ê·œì¹™ì—ëŠ” ëª©ì ì§€, í¬íŠ¸ ë²”ìœ„, í”„ë¡œí† ì½œì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤. ë‹¤ìŒ ë‹¤ì´ì–´ê·¸ë¨ì€ VPC ì•ˆì— ì„œë¸Œë„·, Internet Gateway, ê·¸ë¦¬ê³  ë³´ì•ˆ ê·¸ë£¹ì´ ì¡´ì¬í•˜ëŠ” êµ¬ì¡°ë¥¼ ë³´ì—¬ì¤€ë‹¤.(ì¶œì²˜ : https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-groups.html) í•´ë‹¹ ì„œë¸Œë„·ì—ëŠ” EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ ì¡´ì¬í•˜ë©°, ì´ ì¸ìŠ¤í„´ìŠ¤ì—ëŠ” íŠ¹ì • ë³´ì•ˆ ê·¸ë£¹ì´ í• ë‹¹ë˜ì–´ ìˆë‹¤. ë³´ì•ˆ ê·¸ë£¹ì€ ê°€ìƒ ë°©í™”ë²½ì²˜ëŸ¼ ë™ì‘í•œë‹¤. ì¦‰, EC2 ì¸ìŠ¤í„´ìŠ¤ì— ì‹¤ì œë¡œ ë„ë‹¬í•˜ëŠ” íŠ¸ë˜í”½ì€ ë³´ì•ˆ ê·¸ë£¹ ê·œì¹™ì— ì˜í•´ ëª…ì‹œì ìœ¼ë¡œ í—ˆìš©ëœ íŠ¸ë˜í”½ë¿ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë³´ì•ˆ ê·¸ë£¹ì— ì‚¬ìš©ì ë„¤íŠ¸ì›Œí¬ë¡œë¶€í„°ì˜ ICMP íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ê·œì¹™ì´ ìˆë‹¤ë©´, ì‚¬ìš©ìëŠ” ìì‹ ì˜ ì»´í“¨í„°ì—ì„œ í•´ë‹¹ ì¸ìŠ¤í„´ìŠ¤ë¡œ pingì„ ë³´ë‚¼ ìˆ˜ ìˆë‹¤. ë°˜ëŒ€ë¡œ, ë³´ì•ˆ ê·¸ë£¹ì— SSH íŠ¸ë˜í”½ì„ í—ˆìš©í•˜ëŠ” ê·œì¹™ì´ ì—†ë‹¤ë©´, SSHë¥¼ ì‚¬ìš©í•´ ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•  ìˆ˜ ì—†ë‹¤. ê·œì¹™ ê¸°ë³¸ì ìœ¼ë¡œ ë™ì¼í•œ VPC ë‚´ì—ì„œ ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ì— í• ë‹¹í•  ìˆ˜ ìˆë‹¤. ë™ì¼ ë¦¬ì „ ë‚´ ë‹¤ë¥¸ VPCì— ëŒ€í•´ì„œëŠ” Security Group VPC Association ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ ë³´ì•ˆ ê·¸ë£¹ì„ ë‹¤ë¥¸ VPCì™€ ì—°ê²°í•œ ë’¤ í•´ë‹¹ VPCì˜ ë¦¬ì†ŒìŠ¤ì—ë„ í• ë‹¹í•  ìˆ˜ ìˆë‹¤. í•˜ë‚˜ì˜ ë¦¬ì†ŒìŠ¤ì—ëŠ” ì—¬ëŸ¬ ê°œì˜ ë³´ì•ˆ ê·¸ë£¹ì„ ë™ì‹œì— í• ë‹¹í•  ìˆ˜ ìˆë‹¤. ì´ëŸ° ê²½ìš°, í•˜ë‚˜ë¼ë„ í—ˆìš©í•˜ë©´ í†µê³¼ ë³´ì•ˆ ê·¸ë£¹ ì´ë¦„ì€: ë™ì¼ VPC ë‚´ì—ì„œ ìœ ì¼í•´ì•¼ í•œë‹¤. ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ì•ŠëŠ”ë‹¤. ìµœëŒ€ 255ìê¹Œì§€ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì•ŒíŒŒë²³, ìˆ«ì, ê³µë°± ë° ì§€ì •ëœ íŠ¹ìˆ˜ë¬¸ìë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì´ë¦„ì˜ ëì— ê³µë°±ì´ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´, í•´ë‹¹ ê³µë°±ì€ ì €ì¥ ì‹œ ìë™ìœ¼ë¡œ ì œê±°ëœë‹¤. sg-ë¡œ ì‹œì‘í•  ìˆ˜ ì—†ë‹¤. ë‹¤ìŒ íŠ¸ë˜í”½ì€ ë³´ì•ˆ ê·¸ë£¹ ê·œì¹™ê³¼ ë¬´ê´€í•˜ê²Œ í—ˆìš©ëœë‹¤: Amazon DNS ì„œë¹„ìŠ¤ Amazon DHCP ì„œë¹„ìŠ¤ EC2 ì¸ìŠ¤í„´ìŠ¤ ë©”íƒ€ë°ì´í„° ECS íƒœìŠ¤í¬ ë©”íƒ€ë°ì´í„° ì—”ë“œí¬ì¸íŠ¸ Windows ë¼ì´ì„ ìŠ¤ í™œì„±í™” í†µì‹  Amazon Time Sync Service ê¸°ë³¸ VPC ë¼ìš°í„°ê°€ ì‚¬ìš©í•˜ëŠ” ì˜ˆì•½ IP ì£¼ì†Œ ì œí•œ ì‚¬í•­: VPCë‹¹ ìƒì„± ê°€ëŠ¥í•œ ë³´ì•ˆ ê·¸ë£¹ ìˆ˜ ë³´ì•ˆ ê·¸ë£¹ë‹¹ ì¶”ê°€í•  ìˆ˜ ìˆëŠ” ê·œì¹™ ìˆ˜ í•˜ë‚˜ì˜ ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì— ì—°ê²°í•  ìˆ˜ ìˆëŠ” ë³´ì•ˆ ê·¸ë£¹ ìˆ˜ Stateful ë³´ì•ˆ ê·¸ë£¹ì€ ìƒíƒœ ì €ì¥(Stateful) ë°©ì‹ìœ¼ë¡œ ë™ì‘í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì™¸ë¶€ë¡œ ìš”ì²­ì„ ë³´ë‚¸ ê²½ìš°, ê·¸ ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ íŠ¸ë˜í”½ì€ ì¸ë°”ìš´ë“œ ê·œì¹™ê³¼ ë¬´ê´€í•˜ê²Œ í—ˆìš©ëœë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ, í—ˆìš©ëœ ì¸ë°”ìš´ë“œ íŠ¸ë˜í”½ì— ëŒ€í•œ ì‘ë‹µì€ ì•„ì›ƒë°”ìš´ë“œ ê·œì¹™ê³¼ ê´€ê³„ì—†ì´ ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ë‚˜ê°ˆ ìˆ˜ ìˆë‹¤. ì¦‰, ë³´ì•ˆ ê·¸ë£¹ì€ íŠ¸ë˜í”½ì„ íŒ¨í‚· ë‹¨ìœ„ê°€ ì•„ë‹ˆë¼ ìš”ì²­â€“ì‘ë‹µ ì„¸ì…˜ ë‹¨ìœ„ë¡œ ê¸°ì–µí•˜ê³  íŒë‹¨í•œë‹¤Statelessì˜€ë‹¤ë©´ ? ì˜ˆì‹œ : Network ACL Inbound : 22 í—ˆìš© Outbound : ì—†ìŒ ê²°ê³¼ : SSH ì ‘ì† ì•ˆë¨ (ì‘ë‹µ íŒ¨í‚·ì´ ì°¨ë‹¨ë¨) ê·¸ë˜ì„œ NACLì—ì„œëŠ” í•­ìƒ: Inbound 22 í—ˆìš© Outbound 1024-65535 í—ˆìš© ê°™ì€ ìŒ ê·œì¹™ì„ ë§Œë“¤ì–´ì•¼ í•¨ ì§ˆë¬¸ : sg1ì„ ë§Œë“¤ê³ , sg2ì˜ ì¸ë°”ìš´ë“œë¥¼ ì†ŒìŠ¤ë¥¼ sg1ìœ¼ë¡œ ì§€ì •í•˜ë©´ ?# sg2inbound rule:Source = sg1Protocol = TCPPort = 8080 ì´ ê·œì¹™ì˜ ì •í™•í•œ ì˜ë¯¸: sg1ì´ ë¶™ì–´ ìˆëŠ” ë¦¬ì†ŒìŠ¤ì—ì„œ ì˜¤ëŠ” íŠ¸ë˜í”½ë§Œ sg2ê°€ ë¶™ì–´ ìˆëŠ” ë¦¬ì†ŒìŠ¤ë¡œ ë“¤ì–´ì˜¤ëŠ” ê²ƒì„ í—ˆìš©í•œë‹¤ ì¦‰, íŠ¸ë˜í”½ì„ ë³´ë‚¸ ë¦¬ì†ŒìŠ¤ì˜ IP ì£¼ì†Œë‚˜ ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­ ê¸°ì¤€ì´ ì•„ë‹Œ ì†Œì† ë³´ì•ˆ ê·¸ë£¹ìœ¼ë¡œ íŒë‹¨ [EC2-A] --(sg1) ---&gt; [EC2-B] --(sg2)sg2 ì¸ë°”ìš´ë“œ : ALLOW TCP 8080 FROM sg1 ì‹œë„ ê²°ê³¼ ì´ìœ  EC2-A â†’ EC2-B:8080 í—ˆìš© sg1 â†’ sg2 ê·œì¹™ ì¡´ì¬ EC2-B â†’ EC2-A:8080 ì°¨ë‹¨ sg2 â†’ sg1 ê·œì¹™ ì—†ìŒ ë‹¤ë¥¸ EC2 â†’ EC2-B ì°¨ë‹¨ sg1 ì†Œì† ì•„ë‹˜ ë¦¬ì†ŒìŠ¤ê°€ ì–´ë–¤ ë³´ì•ˆ ê·¸ë£¹ì— â€˜ì†í•´ìˆë‹¤â€™ ? ê·¸ ë¦¬ì†ŒìŠ¤ì˜ ENI(Network Interface)ì— ì–´ë–¤ ë³´ì•ˆ ê·¸ë£¹ì´ ì—°ê²°ë˜ì–´ ìˆë‹¤. EC2 Instance â””â”€ ENI (eth0) â””â”€ Security Group: sg1ì°¸ê³  ìë£Œ https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html https://docs.aws.amazon.com/vpc/latest/userguide/configure-subnets.html#subnet-security https://docs.aws.amazon.com/vpc/latest/userguide/vpc-security-groups.html ChatGPT" }, { "title": "AWS EFS(Elastic File System) - ê¸°ì´ˆ ê°œë…", "url": "/posts/aws-efs/", "categories": "ì§€ì‹ ë”í•˜ê¸°, AWS", "tags": "AWS", "date": "2025-12-29 22:50:00 +0900", "snippet": "EFS (Elastic File System) ìŠ¤í† ë¦¬ì§€ ìš©ëŸ‰ì´ë‚˜ ì„±ëŠ¥ì„ ì‚¬ì „ì— í”„ë¡œë¹„ì €ë‹í•˜ê±°ë‚˜ ê´€ë¦¬í•˜ì§€ ì•Šê³ ë„ íŒŒì¼ ë°ì´í„°ë¥¼ ê³µìœ í•  ìˆ˜ ìˆëŠ” ì„œë²„ë¦¬ìŠ¤ íŒŒì¼ ìŠ¤í† ë¦¬ì§€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ë‹¨ ì—†ì´ í˜íƒ€ë°”ì´íŠ¸ ë‹¨ìœ„ê¹Œì§€ í•„ìš”ì— ë”°ë¼ í™•ì¥ë˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìœ¼ë©°, íŒŒì¼ì„ ì¶”ê°€í•˜ê±°ë‚˜ ì‚­ì œí•¨ì— ë”°ë¼ ìë™ìœ¼ë¡œ ì»¤ì§€ê³  ì¤„ì–´ë“ ë‹¤. ë‹¨ìˆœí•œ ì›¹ ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•˜ê¸° ë•Œë¬¸...", "content": "EFS (Elastic File System) ìŠ¤í† ë¦¬ì§€ ìš©ëŸ‰ì´ë‚˜ ì„±ëŠ¥ì„ ì‚¬ì „ì— í”„ë¡œë¹„ì €ë‹í•˜ê±°ë‚˜ ê´€ë¦¬í•˜ì§€ ì•Šê³ ë„ íŒŒì¼ ë°ì´í„°ë¥¼ ê³µìœ í•  ìˆ˜ ìˆëŠ” ì„œë²„ë¦¬ìŠ¤ íŒŒì¼ ìŠ¤í† ë¦¬ì§€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì¤‘ë‹¨ ì—†ì´ í˜íƒ€ë°”ì´íŠ¸ ë‹¨ìœ„ê¹Œì§€ í•„ìš”ì— ë”°ë¼ í™•ì¥ë˜ë„ë¡ ì„¤ê³„ë˜ì—ˆìœ¼ë©°, íŒŒì¼ì„ ì¶”ê°€í•˜ê±°ë‚˜ ì‚­ì œí•¨ì— ë”°ë¼ ìë™ìœ¼ë¡œ ì»¤ì§€ê³  ì¤„ì–´ë“ ë‹¤. ë‹¨ìˆœí•œ ì›¹ ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µí•˜ê¸° ë•Œë¬¸ì— íŒŒì¼ ì‹œìŠ¤í…œì„ ë¹ ë¥´ê³  ì‰½ê²Œ ìƒì„±í•˜ê³  êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. íŒŒì¼ ìŠ¤í† ë¦¬ì§€ ì¸í”„ë¼ ì „ì²´ë¥¼ ëŒ€ì‹  ê´€ë¦¬í•´ ì£¼ë¯€ë¡œ, ë³µì¡í•œ íŒŒì¼ ì‹œìŠ¤í…œ êµ¬ì„±ì„ ë°°í¬Â·íŒ¨ì¹˜Â·ìœ ì§€ë³´ìˆ˜í•˜ëŠ” ë¶€ë‹´ì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤. NFS(Network File System) ë²„ì „ 4 í”„ë¡œí† ì½œ(NFSv4.1, NFSv4.0)ì„ ì§€ì›í•œë‹¤. ë”°ë¼ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ë„êµ¬ë“¤ì´ Amazon EFSë¥¼ ë¡œì»¬ ë””ë ‰í„°ë¦¬ ì“°ë“¯ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. Amazon EC2, Amazon ECS, Amazon EKS, AWS Lambda, AWS Fargateë¥¼ í¬í•¨í•œ ëŒ€ë¶€ë¶„ì˜ AWS ì»´í“¨íŠ¸ ì„œë¹„ìŠ¤ì—ì„œ ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤.ê°€ìš©ì„±Â·ë‚´êµ¬ì„± ì„¤ê³„ ë†’ì€ í™•ì¥ì„±, ë†’ì€ ê°€ìš©ì„±, ë†’ì€ ë‚´êµ¬ì„±ì„ ê°–ë„ë¡ ì„¤ê³„ë˜ì—ˆë‹¤.Regional (ê¶Œì¥) Regional íŒŒì¼ ì‹œìŠ¤í…œì€ ê°™ì€ AWS ë¦¬ì „ ë‚´ ì—¬ëŸ¬ ê°€ìš© ì˜ì—­(AZ)ì— ê±¸ì³ ì§€ë¦¬ì ìœ¼ë¡œ ë¶„ì‚°í•˜ì—¬ ë°ì´í„°ë¥¼ ì¤‘ë³µ ì €ì¥í•œë‹¤.One Zone One Zone íŒŒì¼ ì‹œìŠ¤í…œì€ ë‹¨ì¼ ê°€ìš© ì˜ì—­(AZ) ì•ˆì— ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤.ì„±ëŠ¥ ë° ì²˜ë¦¬ëŸ‰ ë‹¤ì–‘í•œ ì›Œí¬ë¡œë“œì— í•„ìš”í•œ ì²˜ë¦¬ëŸ‰, IOPS, ë‚®ì€ ì§€ì—° ì‹œê°„ì„ ì œê³µí•œë‹¤.General Purpose ì§€ì—° ì‹œê°„ì— ë¯¼ê°í•œ ì• í”Œë¦¬ì¼€ì´ì…˜(ì›¹ ì„œë²„, CMS, í™ˆ ë””ë ‰í„°ë¦¬ ë“±)ì— ì í•©í•œ ì¼ë°˜ì ì¸ ì„±ëŠ¥ ëª¨ë“œElastic ì›Œí¬ë¡œë“œ í™œë™ì— ë”°ë¼ ì²˜ë¦¬ëŸ‰ì„ ìë™ìœ¼ë¡œ í™•ì¥Â·ì¶•ì†Œí•˜ëŠ” ì²˜ë¦¬ëŸ‰ ëª¨ë“œíŒŒì¼ ì ‘ê·¼ ë°©ì‹ ë° ë³´ì•ˆ Amazon EFSëŠ” ì—¬ëŸ¬ ì‹œìŠ¤í…œì´ ë™ì‹œì— íŒŒì¼ì— ì ‘ê·¼í•˜ë”ë¼ë„, ì¼ë°˜ì ì¸ íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ ê¸°ëŒ€ë˜ëŠ” ë°©ì‹ ê·¸ëŒ€ë¡œ ì•ˆì •ì ì¸ ì½ê¸°Â·ì“°ê¸° í™˜ê²½ì„ ì œê³µí•œë‹¤. ì´ë¥¼ í†µí•´ ë°ì´í„°ëŠ” í•­ìƒ ì¼ê´€ë˜ê²Œ ìœ ì§€ë˜ë©°, íŒŒì¼ ì ê¸ˆ ê¸°ëŠ¥ìœ¼ë¡œ ë™ì‹œ ì ‘ê·¼ ì‹œ ì¶©ëŒì„ ë°©ì§€í•  ìˆ˜ ìˆë‹¤. ë¦¬ëˆ…ìŠ¤ íŒŒì¼ ì‹œìŠ¤í…œê³¼ ë™ì¼í•œ POSIX ê¶Œí•œ ì²´ê³„ë¥¼ ì§€ì›í•˜ì—¬, ì‚¬ìš©ìì™€ ê·¸ë£¹ ë‹¨ìœ„ë¡œ íŒŒì¼ ë° ë””ë ‰í„°ë¦¬ì— ëŒ€í•œ ì ‘ê·¼ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤. íŒŒì¼ ì‹œìŠ¤í…œì„ ë³´í˜¸í•˜ê¸° ìœ„í•´ ì €ì¥ ì‹œ ì•”í˜¸í™”ì™€ ì „ì†¡ ì¤‘ ì•”í˜¸í™”, ë‘ ê°€ì§€ ì•”í˜¸í™” ë°©ì‹ì„ ì§€ì›í•œë‹¤. EFS íŒŒì¼ ì‹œìŠ¤í…œì„ ìƒì„±í•  ë•Œ ì €ì¥ ì‹œ ì•”í˜¸í™”ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì´ ì˜µì…˜ì„ í™œì„±í™”í•˜ë©´ íŒŒì¼ ë°ì´í„°ë¿ ì•„ë‹ˆë¼ ë””ë ‰í„°ë¦¬ êµ¬ì¡°ì™€ ê°™ì€ ëª¨ë“  ë©”íƒ€ë°ì´í„°ê¹Œì§€ ì•”í˜¸í™”ë˜ì–´ ì €ì¥ëœë‹¤. íŒŒì¼ ì‹œìŠ¤í…œì„ ë§ˆìš´íŠ¸í•  ë•Œ ì „ì†¡ ì¤‘ ì•”í˜¸í™”ë¥¼ ì ìš©í•˜ì—¬, ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ EFS ê°„ì˜ í†µì‹ ì„ ì•ˆì „í•˜ê²Œ ë³´í˜¸í•  ìˆ˜ ìˆë‹¤. Amazon EFSì— ëŒ€í•œ NFS í´ë¼ì´ì–¸íŠ¸ ì ‘ê·¼ì€ IAM ì •ì±…ê³¼ ë³´ì•ˆ ê·¸ë£¹ ê°™ì€ ë„¤íŠ¸ì›Œí¬ ë³´ì•ˆ ì„¤ì •ì„ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ ì œì–´ëœë‹¤. ì¦‰, ë„¤íŠ¸ì›Œí¬ ì°¨ì›ì—ì„œ ì ‘ê·¼ì´ í—ˆìš©ë˜ì–´ì•¼ í•˜ë©°, ë™ì‹œì— í•´ë‹¹ ë¦¬ì†ŒìŠ¤ì— EFS ì ‘ê·¼ ê¶Œí•œì´ ë¶€ì—¬ë˜ì–´ ìˆì–´ì•¼ ì‹¤ì œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤. ì£¼ìš” ê¸°ëŠ¥ì¸ì¦ê³¼ ì ‘ê·¼ ì œì–´ Amazon EFS ê´€ë¦¬ ì½˜ì†”ì„ ì‚¬ìš©í•˜ê±°ë‚˜ íŒŒì¼ ì‹œìŠ¤í…œ ìƒì„±ê³¼ ê°™ì€ EFS APIë¥¼ í˜¸ì¶œí•˜ë ¤ë©´ ìœ íš¨í•œ ì¸ì¦ ì •ë³´ê°€ í•„ìš”í•˜ë‹¤. ë˜í•œ EFS íŒŒì¼ ì‹œìŠ¤í…œë¿ ì•„ë‹ˆë¼, ì´ë¥¼ ì‚¬ìš©í•˜ëŠ” ë‹¤ë¥¸ AWS ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ì„œë„ ì ì ˆí•œ ì ‘ê·¼ ê¶Œí•œì´ í•¨ê»˜ ë¶€ì—¬ë˜ì–´ì•¼ í•œë‹¤. EFS ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ëª…ì‹œì ì¸ ê¶Œí•œì„ ë¶€ì—¬ë°›ì•„ì•¼ í•œë‹¤. IAM User / IAM Role ê¸°ë°˜ ê¶Œí•œ ëª¨ë¸ NFS í´ë¼ì´ì–¸íŠ¸ì— ëŒ€í•œ IAM ì¸ì¦ì€ ëŒ€ê·œëª¨ í™˜ê²½ì—ì„œ NFS ì ‘ê·¼ ê´€ë¦¬ë¥¼ ë‹¨ìˆœí™”í•˜ê¸° ìœ„í•´ IAMì„ í™œìš©í•˜ëŠ” ì¶”ê°€ì ì¸ ë³´ì•ˆ ì˜µì…˜ì´ë‹¤. IAM ê¸°ë°˜ NFS ì¸ì¦ì„ ì‚¬ìš©í•˜ë©´ IAMì„ í†µí•´ EFS íŒŒì¼ ì‹œìŠ¤í…œ ì ‘ê·¼ì„ í™•ì¥ì„± ìˆê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. ì¦‰, ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ê°€ ëŠ˜ì–´ë‚˜ë„ IP ê·œì¹™ì„ ì¼ì¼ì´ ê´€ë¦¬í•  í•„ìš”ê°€ ì—†ë‹¤. ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ í•˜ë‚˜ì˜ EFS íŒŒì¼ ì‹œìŠ¤í…œ ì•ˆì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ë¡œ ì ‘ê·¼ ê²½ë¡œë¥¼ ë¶„ë¦¬í•´ ì£¼ëŠ” ì§„ì… ì§€ì  ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ë¥¼ í†µí•´ ì´ë£¨ì–´ì§€ëŠ” ëª¨ë“  íŒŒì¼ ì‹œìŠ¤í…œ ìš”ì²­ì— ëŒ€í•´ íŠ¹ì • ì‚¬ìš©ì IDì™€ POSIX ê·¸ë£¹ ì •ë³´ë¥¼ ê°•ì œë¡œ ì ìš©í•  ìˆ˜ ìˆë‹¤.ì‚¬ìš©ì ID ë° ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ ê°•ì œ ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê³µìœ  ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ë•Œ ì ‘ê·¼ ê´€ë¦¬ë¥¼ ì‰½ê²Œ ë§Œë“¤ì–´ ì¤€ë‹¤. íŒŒì¼ ì‹œìŠ¤í…œì˜ ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ë¥¼ ë³„ë„ë¡œ ì§€ì •í•  ìˆ˜ ìˆì–´, í´ë¼ì´ì–¸íŠ¸ê°€ í•´ë‹¹ ë””ë ‰í„°ë¦¬ì™€ ê·¸ í•˜ìœ„ ê²½ë¡œì—ë§Œ ì ‘ê·¼í•˜ë„ë¡ ì œí•œí•  ìˆ˜ ìˆë‹¤.IAM ì •ì±…ê³¼ Access Point ì¡°í•© IAM ì •ì±…ì„ ì‚¬ìš©í•˜ë©´ íŠ¹ì • ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë°˜ë“œì‹œ íŠ¹ì • ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ë¥¼ í†µí•´ì„œë§Œ EFSì— ì ‘ê·¼í•˜ë„ë¡ ê°•ì œí•  ìˆ˜ ìˆë‹¤. IAM ì •ì±…ê³¼ ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ë³„ë¡œ íŠ¹ì • ë°ì´í„°ì…‹ì— ëŒ€í•œ ì•ˆì „í•œ ì ‘ê·¼ ê¶Œí•œì„ ì†ì‰½ê²Œ ì œê³µí•  ìˆ˜ ìˆë‹¤.Access pointsì™€ Mount Targetì˜ ê´€ê³„ ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë¨¼ì € VPCì— ìµœì†Œ í•˜ë‚˜ ì´ìƒì˜ ë§ˆìš´íŠ¸ íƒ€ê¹ƒì´ ìƒì„±ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤. ë§ˆìš´íŠ¸ íƒ€ê¹ƒì€ EFS íŒŒì¼ ì‹œìŠ¤í…œì— ëŒ€í•œ ë„¤íŠ¸ì›Œí¬ ì—°ê²°ì„ ì œê³µí•˜ê³ , ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ëŠ” ì ‘ê·¼ ì œì–´ì™€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ìš© ì§„ì… ì§€ì ì„ ì œê³µí•œë‹¤. ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ëŠ” ì—°ê²°ëœ ë§ˆìš´íŠ¸ íƒ€ê¹ƒì˜ ê°€ìš© ì˜ì—­(AZ) ë°°ì¹˜ë¥¼ ê·¸ëŒ€ë¡œ ë”°ë¥¸ë‹¤. ë³´ì•ˆ ê·¸ë£¹ì€ ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ê°€ ì•„ë‹ˆë¼ ë§ˆìš´íŠ¸ íƒ€ê¹ƒ ìˆ˜ì¤€ì—ì„œ ì ìš©ëœë‹¤. ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ ì œì–´ëŠ” ë§ˆìš´íŠ¸ íƒ€ê¹ƒ ì±…ì„ Access PointëŠ” ê¶Œí•œ/ë…¼ë¦¬ì  ì ‘ê·¼ ì œì–´ ë‹´ë‹¹ ë§ˆìš´íŠ¸ íƒ€ê¹ƒì´ ì¡´ì¬í•˜ëŠ” ëª¨ë“  ê°€ìš© ì˜ì—­ì—ì„œ ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ë¥¼ ì‚¬ìš©í•´ EFSë¥¼ ë§ˆìš´íŠ¸í•  ë•ŒëŠ” EFS ì „ìš© ë§ˆìš´íŠ¸ í—¬í¼ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.AccessedViaMountTarget IAM ì¡°ê±´ í‚¤ elasticfilesystem:AccessedViaMountTargetë¥¼ ì‚¬ìš©í•˜ë©´ ì§ì ‘ ë§ˆìš´íŠ¸ë“  ì•¡ì„¸ìŠ¤ í¬ì¸íŠ¸ë¥¼ í†µí•œ ë§ˆìš´íŠ¸ë“  ìƒê´€ì—†ì´, ë°˜ë“œì‹œ ë§ˆìš´íŠ¸ íƒ€ê¹ƒì„ í†µí•´ì„œë§Œ EFSì— ì ‘ê·¼í•˜ë„ë¡ ê°•ì œí•  ìˆ˜ ìˆë‹¤.ì°¸ê³  ìë£Œ https://docs.aws.amazon.com/efs/latest/ug/whatisefs.html https://docs.aws.amazon.com/efs/latest/ug/features.html https://docs.aws.amazon.com/efs/latest/ug/efs-access-points.html ChatGPT" }, { "title": "Github Actions - ê¸°ì´ˆ ê°œë…", "url": "/posts/github-actions-basic/", "categories": "ì§€ì‹ ë”í•˜ê¸°, Git & Github", "tags": "Github", "date": "2025-12-27 00:00:00 +0900", "snippet": "Github Actions GitHub ActionsëŠ” ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ë°°í¬ íŒŒì´í”„ë¼ì¸ì„ ìë™í™”í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” CI/CD í”Œë«í¼ ë¦¬í¬ì§€í† ë¦¬ì— ë“¤ì–´ì˜¤ëŠ” ëª¨ë“  PRì— ëŒ€í•´ ë¹Œë“œÂ·í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ì›Œí¬í”Œë¡œìš°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆê³ , ë¨¸ì§€ëœ PRì„ ìš´ì˜ í™˜ê²½ì— ë°°í¬í•˜ëŠ” ì›Œí¬í”Œë¡œìš°ë„ ë§Œë“¤ ìˆ˜ ìˆë‹¤. GitHub ActionsëŠ” ë‹¨ìˆœí•œ DevOpsë¥¼ ë„˜ì–´, ë¦¬...", "content": "Github Actions GitHub ActionsëŠ” ë¹Œë“œ, í…ŒìŠ¤íŠ¸, ë°°í¬ íŒŒì´í”„ë¼ì¸ì„ ìë™í™”í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” CI/CD í”Œë«í¼ ë¦¬í¬ì§€í† ë¦¬ì— ë“¤ì–´ì˜¤ëŠ” ëª¨ë“  PRì— ëŒ€í•´ ë¹Œë“œÂ·í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ì›Œí¬í”Œë¡œìš°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆê³ , ë¨¸ì§€ëœ PRì„ ìš´ì˜ í™˜ê²½ì— ë°°í¬í•˜ëŠ” ì›Œí¬í”Œë¡œìš°ë„ ë§Œë“¤ ìˆ˜ ìˆë‹¤. GitHub ActionsëŠ” ë‹¨ìˆœí•œ DevOpsë¥¼ ë„˜ì–´, ë¦¬í¬ì§€í† ë¦¬ì—ì„œ ë°œìƒí•˜ëŠ” ë‹¤ì–‘í•œ ì´ë²¤íŠ¸ì— ë°˜ì‘í•´ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ëˆ„êµ°ê°€ ìƒˆ ì´ìŠˆë¥¼ ë§Œë“¤ë©´ ìë™ìœ¼ë¡œ ì ì ˆí•œ ë¼ë²¨ì„ ë¶™ì´ëŠ” ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. GitHubëŠ” ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ì„ ìœ„í•´, Linux / Windows / macOS ê°€ìƒ ë¨¸ì‹ ì„ ì œê³µí•œë‹¤. ì§ì ‘ ê´€ë¦¬í•˜ëŠ” runner(self-hosted runner)ë¥¼ ë°ì´í„°ì„¼í„°ë‚˜ í´ë¼ìš°ë“œì— ë‘˜ ìˆ˜ë„ ìˆë‹¤.êµ¬ì„± ìš”ì†ŒWorkflow í•˜ë‚˜ ì´ìƒì˜ Jobì„ ì‹¤í–‰í•˜ëŠ” ì„¤ì • ê°€ëŠ¥í•œ ìë™í™” í”„ë¡œì„¸ìŠ¤ ì›Œí¬í”Œë¡œìš°ëŠ” ë¦¬í¬ì§€í† ë¦¬ì— ì»¤ë°‹ëœ YAML íŒŒì¼ë¡œ ì •ì˜ëœë‹¤. .github/workflows/*.yml í•˜ë‚˜ì˜ ë¦¬í¬ì§€í† ë¦¬ëŠ” ì—¬ëŸ¬ ê°œì˜ ì›Œí¬í”Œë¡œìš°ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ ë°©ë²•: ì´ë²¤íŠ¸ ë°œìƒ ì‹œ REST API í˜¸ì¶œ ìˆ˜ë™ ì‹¤í–‰ ìŠ¤ì¼€ì¤„(cron) í•œ ì›Œí¬í”Œë¡œìš°ì—ì„œ ë‹¤ë¥¸ ì›Œí¬í”Œë¡œìš°ë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤.Events ì›Œí¬í”Œë¡œìš° ì‹¤í–‰ì„ íŠ¸ë¦¬ê±°í•˜ëŠ” ë¦¬í¬ì§€í† ë¦¬ ë‚´ íŠ¹ì • í™œë™ ì˜ˆ: PR ìƒì„±, ì´ìŠˆ ìƒì„±, ì»¤ë°‹ í‘¸ì‹œJobs ê°™ì€ Runnerì—ì„œ ì‹¤í–‰ë˜ëŠ” Stepë“¤ì˜ ë¬¶ìŒ Jobë“¤ì€ ìˆœì°¨ ì‹¤í–‰ ë˜ëŠ” ë³‘ë ¬ ì‹¤í–‰ì´ ê°€ëŠ¥í•˜ë‹¤. ê°ê°ì˜ Jobì€ ìì‹ ë§Œì˜ Runner(VM) ë˜ëŠ” ì»¨í…Œì´ë„ˆ í™˜ê²½ì—ì„œ ì‹¤í–‰ëœë‹¤. Jobì€ í•˜ë‚˜ ì´ìƒì˜ Stepìœ¼ë¡œ êµ¬ì„±ë˜ë©°, Stepì€ ì§ì ‘ ì •ì˜í•œ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë˜ëŠ” ë¯¸ë¦¬ ë§Œë“¤ì–´ì§„ Action ì‹¤í–‰ ì¤‘ í•˜ë‚˜ë‹¤. Stepì€ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰ë˜ë©°, ì´ì „ Step ê²°ê³¼ì— ì˜ì¡´í•œë‹¤. ex : ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ Step -&gt; ë¹Œë“œ ê²°ê³¼ë¬¼ì„ í…ŒìŠ¤íŠ¸í•˜ëŠ” Step ê°™ì€ Runnerì—ì„œ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì—, Step ê°„ì— ë°ì´í„° ê³µìœ ê°€ ê°€ëŠ¥í•˜ë‹¤. Jobë“¤ê°„ì˜ ì˜ì¡´ì„±ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.Actions ì›Œí¬í”Œë¡œìš° ì•ˆì—ì„œ íŠ¹ì • ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë¯¸ë¦¬ ì •ì˜ëœ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì½”ë“œ ë¬¶ìŒ ì›Œí¬í”Œë¡œìš° íŒŒì¼ì—ì„œ ì¤‘ë³µ ì½”ë“œë¥¼ ì¤„ì—¬ì¤€ë‹¤. ì§ì ‘ Actionì„ ë§Œë“¤ ìˆ˜ë„ ìˆê³ , GitHub Marketplaceì— ìˆëŠ” Actionì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤. ì˜ˆ: actions/checkout actions/setup-java actions/checkout https://github.com/marketplace/actions/checkout GitHub Actionsì—ì„œ RunnerëŠ” ë¹ˆ VMìœ¼ë¡œ ì‹œì‘ ê·¸ë˜ì„œ ë¹Œë“œ / í…ŒìŠ¤íŠ¸ / íŒ¨í‚¤ì§•ì„ í•˜ë ¤ë©´, ì†ŒìŠ¤ ì½”ë“œë¥¼ ë¨¼ì € ê°€ì ¸ì™€ì•¼ í•¨ # ì´ê±¸ Actionìœ¼ë¡œ ìº¡ìŠí™”í•´ ë‘” ê²ƒgit clone https://github.com/org/repo.gitcd repogit checkout main actions/setup-java https://github.com/marketplace/actions/setup-java-jdk RunnerëŠ” ê¸°ë³¸ OSë§Œ ìˆì„ ë¿ì´ê³  Java ë²„ì „ì€ ë³´ì¥ë˜ì§€ ì•ŠìŒ ë˜ëŠ” í”„ë¡œì íŠ¸ ìš”êµ¬ì™€ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ ë”°ë¼ì„œ: ì§€ì •í•œ Java ë°°í¬íŒ ì„¤ì¹˜ JAVA_HOME ì„¤ì • PATHì— java/bin ë“±ë¡ í•„ìš” # ì´ê±¸ Actionìœ¼ë¡œ ìº¡ìŠí™”í•´ ë‘” ê²ƒapt install openjdk-21-jdkexport JAVA_HOME=/usr/lib/jvm/java-21java -versionRunners ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤ì œë¡œ ì‹¤í–‰í•˜ëŠ” ì„œë²„ í•˜ë‚˜ì˜ RunnerëŠ” í•œ ë²ˆì— í•˜ë‚˜ì˜ Jobë§Œ ì‹¤í–‰í•œë‹¤. GitHub-hosted Runnerì˜ ê²½ìš°, ë§¤ ì‹¤í–‰ë§ˆë‹¤ ì™„ì „íˆ ìƒˆ VMì´ ìƒì„±ëœë‹¤.ì°¸ê³  ìë£Œ https://docs.github.com/en/actions/get-started/understand-github-actions" }, { "title": "AWS ECR(Elastic Container Registry) - ê¸°ì´ˆ ê°œë…", "url": "/posts/aws-ecr/", "categories": "ì§€ì‹ ë”í•˜ê¸°, AWS", "tags": "AWS", "date": "2025-12-26 23:00:00 +0900", "snippet": "AWS ECR (Elastic Container Registry) AWS ê´€ë¦¬í˜• ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„œë¹„(AWS í™˜ê²½ ë‚´ì—ì„œ ë³´ì•ˆì„±, í™•ì¥ì„±, ì‹ ë¢°ì„±ì„ ê°–ì¶˜ Docker ì»¨í…Œì´ë„ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„œë¹„ìŠ¤ë¥¼ ì œê³µ) AWS IAMì„ ì‚¬ìš©í•œ ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ê¶Œí•œ(Resource-based permissions)ì„ í†µí•´ í”„ë¼ì´ë¹— ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì§€ì› ...", "content": "AWS ECR (Elastic Container Registry) AWS ê´€ë¦¬í˜• ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„œë¹„(AWS í™˜ê²½ ë‚´ì—ì„œ ë³´ì•ˆì„±, í™•ì¥ì„±, ì‹ ë¢°ì„±ì„ ê°–ì¶˜ Docker ì»¨í…Œì´ë„ˆ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„œë¹„ìŠ¤ë¥¼ ì œê³µ) AWS IAMì„ ì‚¬ìš©í•œ ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ê¶Œí•œ(Resource-based permissions)ì„ í†µí•´ í”„ë¼ì´ë¹— ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì§€ì› í¼ë¸”ë¦­ ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ë¦¬í¬ì§€í† ë¦¬ë„ ì§€ì› ì´ë¥¼ í†µí•´ ì§€ì •ëœ ì‚¬ìš©ì ë˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ë§Œ ì»¨í…Œì´ë„ˆ ë¦¬í¬ì§€í† ë¦¬ì™€ ì´ë¯¸ì§€ì— ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡ ì œì–´í•  ìˆ˜ ìˆìŒ ì„ í˜¸í•˜ëŠ” CLIë¥¼ ì‚¬ìš©í•˜ì—¬ Docker ì´ë¯¸ì§€, OCI ì´ë¯¸ì§€, ê·¸ë¦¬ê³  OCI í˜¸í™˜ ì•„í‹°íŒ©íŠ¸ë¥¼ push, pull, ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.OCI (Open Container Initiative) ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì™€ ëŸ°íƒ€ì„ì˜ í˜•ì‹ì„ í‘œì¤€í™”í•´, íŠ¹ì • ë²¤ë”ì— ì¢…ì†ë˜ì§€ ì•Šê³  ì–´ë””ì„œë‚˜ ë™ì¼í•˜ê²Œ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ë§Œë“  ê·œê²© (https://opencontainers.org/)OCI Image Spec â€œì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì˜ êµ¬ì¡°ëŠ” ì´ë ‡ê²Œ ìƒê²¨ì•¼ í•œë‹¤â€ ì˜ˆ: ë ˆì´ì–´ êµ¬ì¡° ë©”íƒ€ë°ì´í„° í˜•ì‹ image manifest ê·œì¹™ OCI Runtime Spec â€œì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  ë•Œ ì´ ê·œì¹™ì„ ë”°ë¼ë¼â€ ì˜ˆ: í”„ë¡œì„¸ìŠ¤ ì‹œì‘ ë°©ì‹ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ / cgroup ì„¤ì • rootfs ë§ˆìš´íŠ¸ ë°©ì‹ ê²°ë¡  ì‹¤ë¬´ ê´€ì ì—ì„œ: Dockerë¡œ ë§Œë“  ì´ë¯¸ì§€ë¥¼ ECR, Harbor ê°™ì€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì˜¬ë¦¬ê³  ECS, Kubernetes, containerd, CRI-Oì—ì„œ ê·¸ëŒ€ë¡œ ì‹¤í–‰ ê°€ëŠ¥ ì´ê²Œ ê°€ëŠ¥í•œ ì´ìœ ê°€ ë°”ë¡œ OCI í‘œì¤€ ë•ë¶„ ì£¼ìš” ê°œë…Registry ê° AWS ê³„ì •ë§ˆë‹¤ ì œê³µë˜ëŠ” í”„ë¼ì´ë¹— ë¦¬í¬ì§€í† ë¦¬ ê³µê°„ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì•ˆì—ì„œ í•˜ë‚˜ ì´ìƒì˜ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ ë¦¬í¬ì§€í† ë¦¬ëŠ” AWS í™˜ê²½ ë‚´ì—ì„œ Docker ì´ë¯¸ì§€, OCI ì´ë¯¸ì§€, ê¸°íƒ€ OCI í˜¸í™˜ ì•„í‹°íŒ©íŠ¸ë¥¼ ì €ì¥í•˜ê³  ë°°í¬í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.Repository Docker ì´ë¯¸ì§€, OCI ì´ë¯¸ì§€, ê¸°íƒ€ OCI í˜¸í™˜ ì•„í‹°íŒ©íŠ¸ë¥¼ ì €ì¥í•  ìˆ˜ ìˆëŠ” ê³µê°„ í•˜ë‚˜ì˜ Amazon ECR ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì•ˆì—ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ì •ë¦¬í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ ê°œì˜ ë¦¬í¬ì§€í† ë¦¬ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.Registry / Repositoryë¥¼ í´ë” êµ¬ì¡°ë¡œ ë¹„ìœ í•˜ë©´ECR Registry (AWS ê³„ì •ë‹¹ 1ê°œ)â”œâ”€ Repository: payment-apiâ”‚ â”œâ”€ payment-api:1.0â”‚ â”œâ”€ payment-api:1.1â”‚ â””â”€ payment-api:latestâ”‚â”œâ”€ Repository: settlement-batchâ”‚ â”œâ”€ settlement-batch:2025-01â”‚ â””â”€ settlement-batch:2025-02â”‚â””â”€ Repository: nginx â””â”€ nginx:stableRepository policy ë¦¬í¬ì§€í† ë¦¬ ì •ì±…ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬í¬ì§€í† ë¦¬ ë° ê·¸ ì•ˆì˜ ì½˜í…ì¸ ì— ëŒ€í•œ ì ‘ê·¼ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤.Authorization token í´ë¼ì´ì–¸íŠ¸ëŠ” ì´ë¯¸ì§€ë¥¼ push í•˜ê±°ë‚˜ pull í•˜ê¸° ì „ì—, AWS ì‚¬ìš©ìë¡œì„œ Amazon ECR í”„ë¼ì´ë¹— ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì¸ì¦í•´ì•¼ í•œë‹¤.Image ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ë¥¼ ë¦¬í¬ì§€í† ë¦¬ì— push í•˜ê±°ë‚˜, pull í•  ìˆ˜ ìˆë‹¤. ì´ ì´ë¯¸ì§€ë“¤ì€: ë¡œì»¬ ê°œë°œ í™˜ê²½ì—ì„œ ì‚¬ìš©í•  ìˆ˜ë„ ìˆê³  Amazon ECSì˜ íƒœìŠ¤í¬ ì •ì˜ë‚˜ Amazon EKSì˜ íŒŒë“œ ëª…ì„¸(pod specification)ì—ì„œ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤. ECRì˜ ê¸°ëŠ¥ Amazon ECRì€ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ì œê³µ1. Lifecycle policies ë¦¬í¬ì§€í† ë¦¬ì— ìˆëŠ” ì´ë¯¸ì§€ì˜ ìˆ˜ëª… ì£¼ê¸° ê´€ë¦¬ë¥¼ ë•ëŠ”ë‹¤. ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ë¯¸ì§€ë¥¼ ì •ë¦¬í•˜ë„ë¡ í•˜ëŠ” ê·œì¹™ì„ ì •ì˜í•  ìˆ˜ ìˆë‹¤. ì´ ê·œì¹™ì€ ì‹¤ì œ ì ìš©í•˜ê¸° ì „ì— í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆë‹¤.2. Image scanning ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ì— í¬í•¨ëœ ì†Œí”„íŠ¸ì›¨ì–´ ì·¨ì•½ì ì„ ì‹ë³„í•˜ëŠ” ë° ë„ì›€ì„ ì¤€ë‹¤. ê° ë¦¬í¬ì§€í† ë¦¬ëŠ” í‘¸ì‹œ ì‹œ ìŠ¤ìº”(scan on push)ì´ ë˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì´ ì„¤ì •ì„ í†µí•´ ë¦¬í¬ì§€í† ë¦¬ì— ìƒˆ ì´ë¯¸ì§€ê°€ í‘¸ì‹œë  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ìŠ¤ìº”ì´ ìˆ˜í–‰ëœë‹¤. ì´í›„ ì´ë¯¸ì§€ ìŠ¤ìº” ê²°ê³¼ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.3. Cross-Region ë° cross-account replication ë¦¬ì „ ë° ê³„ì • ê°„ ë³µì œëŠ” í•„ìš”í•œ ìœ„ì¹˜ì— ì´ë¯¸ì§€ë¥¼ ì‰½ê²Œ ë°°í¬í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤. ì´ ê¸°ëŠ¥ì€ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì„¤ì •ìœ¼ë¡œ êµ¬ì„±ë˜ë©°, ë¦¬ì „ ë‹¨ìœ„ë¡œ ì ìš©ëœë‹¤.4. Pull through cache rules ì—…ìŠ¤íŠ¸ë¦¼ ë ˆì§€ìŠ¤íŠ¸ë¦¬(upstream registry) ì˜ ë¦¬í¬ì§€í† ë¦¬ë¥¼, í”„ë¼ì´ë¹— Amazon ECR ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ìºì‹œí•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì œê³µ ì´ ë°©ë²•ì„ ì‚¬ìš©í•˜ë©´ Amazon ECRì€ ì£¼ê¸°ì ìœ¼ë¡œ ì—…ìŠ¤íŠ¸ë¦¼ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ì ‘ê·¼í•˜ì—¬, í”„ë¼ì´ë¹— Amazon ECR ë ˆì§€ìŠ¤íŠ¸ë¦¬ì— ìºì‹œëœ ì´ë¯¸ì§€ê°€ ìµœì‹  ìƒíƒœì¸ì§€ í™•ì¸5. Repository creation templates pull through cache, create on push, ë˜ëŠ” replication ì‘ì—… ì¤‘ Amazon ECRì´ ìë™ìœ¼ë¡œ ìƒì„±í•˜ëŠ” ë¦¬í¬ì§€í† ë¦¬ì˜ ì„¤ì •ì„ ì •ì˜í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. ë‹¤ìŒê³¼ ê°™ì€ ì„¤ì •ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤: íƒœê·¸ ë¶ˆë³€ì„± ì•”í˜¸í™” ì„¤ì • ë¦¬í¬ì§€í† ë¦¬ ì •ì±… ë¼ì´í”„ì‚¬ì´í´ ì •ì±… ë¦¬ì†ŒìŠ¤ íƒœê·¸ 6. Managed signing ì´ë¯¸ì§€ê°€ Amazon ECRì— í‘¸ì‹œë  ë•Œ ì•”í˜¸í•™ì  ì„œëª…(cryptographic signature)ì„ ìë™ìœ¼ë¡œ ìƒì„±í•˜ì—¬, ì»¨í…Œì´ë„ˆ ì´ë¯¸ì§€ ì„œëª… ê³¼ì •ì„ ë‹¨ìˆœí™”7. Access Control Amazon ECRì€ AWS Identity and Access Management(IAM)ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬í¬ì§€í† ë¦¬ì— ëŒ€í•œ ì ‘ê·¼ì„ ì œì–´ íŠ¹ì • ê¶Œí•œì„ ê°€ì§„ IAM ì‚¬ìš©ì, ê·¸ë£¹, ì—­í• ì„ ìƒì„±í•˜ì—¬ Amazon ECR ë¦¬í¬ì§€í† ë¦¬ì— ëŒ€í•´ push, pull, ê´€ë¦¬ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.ì°¸ê³  ìë£Œ https://docs.aws.amazon.com/AmazonECR/latest/userguide/what-is-ecr.html https://docs.aws.amazon.com/AmazonECR/latest/userguide/concept-and-components.html" }, { "title": "AWS ECS(Elastic Container Service) - ê¸°ì´ˆ ê°œë…", "url": "/posts/aws-ecs/", "categories": "ì§€ì‹ ë”í•˜ê¸°, AWS", "tags": "AWS", "date": "2025-12-25 00:25:00 +0900", "snippet": "AWS ECS (Elastic Container Service) ì»¨í…Œì´ë„ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‰½ê²Œ ë°°í¬, ê´€ë¦¬ ë° í™•ì¥í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì™„ì „ ê´€ë¦¬í˜•(fully managed) ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì„œë¹„ìŠ¤ Amazon ECSì—ëŠ” ì„¸ ê°€ì§€ ê³„ì¸µì´ ìˆë‹¤. Capacity : ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë˜ëŠ” ì¸í”„ë¼ Controller : ì»¨...", "content": "AWS ECS (Elastic Container Service) ì»¨í…Œì´ë„ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‰½ê²Œ ë°°í¬, ê´€ë¦¬ ë° í™•ì¥í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì™„ì „ ê´€ë¦¬í˜•(fully managed) ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ ì„œë¹„ìŠ¤ Amazon ECSì—ëŠ” ì„¸ ê°€ì§€ ê³„ì¸µì´ ìˆë‹¤. Capacity : ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë˜ëŠ” ì¸í”„ë¼ Controller : ì»¨í…Œì´ë„ˆì—ì„œ ì‹¤í–‰ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë°°í¬í•˜ê³  ê´€ë¦¬ Provisioning : ìŠ¤ì¼€ì¤„ëŸ¬ì™€ í•¨ê»˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë° ì»¨í…Œì´ë„ˆë¥¼ ë°°í¬ ë° ê´€ë¦¬í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë„êµ¬ (ì¶œì²˜ : https://docs.aws.amazon.com/AmazonECS/latest/developerguide/Welcome.html)Capacity ì»¨í…Œì´ë„ˆê°€ ì‹¤í–‰ë˜ëŠ” ì¸í”„ë¼1. EC2 ì¸ìŠ¤í„´ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ íƒ€ì…ì„ ì„ íƒí•˜ê³  ì¸ìŠ¤í„´ìŠ¤ ê°œìˆ˜ë¥¼ ê²°ì •í•˜ë©° capacityë¥¼ ì§ì ‘ ê´€ë¦¬ (CPU / ë©”ëª¨ë¦¬, ìŠ¤í† ë¦¬ì§€, Auto Scaling ì—¬ë¶€, íŒ¨ì¹˜ / ì¬ë¶€íŒ… / ì¥ì•  ëŒ€ì‘ ë“±)2. Fargate AWS í´ë¼ìš°ë“œì—ì„œì˜ ì„œë²„ë¦¬ìŠ¤ ë°©ì‹ FargateëŠ” ì‚¬ìš©í•œ ë§Œí¼ ë¹„ìš©ì„ ì§€ë¶ˆí•˜ëŠ”(serverless, pay-as-you-go) ì»´í“¨íŒ… ì—”ì§„ì…ë‹ˆë‹¤. Fargateë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒì´ í•„ìš” ì—†ë‹¤: ì„œë²„ ê´€ë¦¬ capacity ê³„íš ì»¨í…Œì´ë„ˆ ì›Œí¬ë¡œë“œ ê°„ ë³´ì•ˆì„ ìœ„í•œ ê²©ë¦¬ ì‘ì—… 3. ECS Managed Instances ê°€ì¥ ìµœê·¼(25.09.30)ì— ì¶œì‹œë¨ - ê´€ë ¨ ë¬¸ì„œ AWSê°€ ê¸°ë°˜ ì¸í”„ë¼ì˜ í”„ë¡œë¹„ì €ë‹, íŒ¨ì¹˜, ìŠ¤ì¼€ì¼ë§, ìœ ì§€ë³´ìˆ˜ë¥¼ ì²˜ë¦¬í•´ì£¼ëŠ” ë™ì•ˆ ì—¬ëŸ¬ ìœ í˜•ì˜ Amazon EC2 ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì»¨í…Œì´ë„ˆí™”ëœ ì›Œí¬ë¡œë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤. ì‰½ê²Œ ë§í•´, EC2ë¥¼ ì“°ê¸´ ì“°ëŠ”ë°, ì„œë²„ ê´€ë¦¬(ì„¤ì¹˜Â·íŒ¨ì¹˜Â·ì¦ì„¤Â·êµì²´)ëŠ” AWSê°€ ëŒ€ì‹  í•´ì£¼ê³ , ê°œë°œìëŠ” â€˜ì–´ë–¤ ì„±ëŠ¥ì˜ ì„œë²„ì—ì„œ ì»¨í…Œì´ë„ˆë¥¼ ëŒë¦´ì§€ë§Œâ€™ ê³ ë¥´ë©´ ëœë‹¤. Amazon ECS Managed Instancesë¥¼ ì‚¬ìš©í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì • ì»´í“¨íŒ… ê¸°ëŠ¥ì— ì ‘ê·¼í•  ìˆ˜ ìˆë‹¤: GPU ê°€ì† íŠ¹ì • CPU ì•„í‚¤í…ì²˜ ë†’ì€ ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ íŠ¹ìˆ˜ ëª©ì  ì¸ìŠ¤í„´ìŠ¤ íƒ€ì… ì˜ˆë¥¼ ë“¤ë©´, íŠ¹ì • ì»¨í…Œì´ë„ˆëŠ” GPU ìˆëŠ” ì„œë²„ì—ì„œ ì‹¤í–‰ ë˜ ë‹¤ë¥¸ ì»¨í…Œì´ë„ˆëŠ” ê³ ì† ë„¤íŠ¸ì›Œí¬ ì„œë²„ì—ì„œ ì‹¤í–‰ ì¦‰, ì»¨í…Œì´ë„ˆ ì‹¤í–‰ ìœ„ì¹˜ë¥¼ ê³ ê¸‰ ì‚¬ì–‘ìœ¼ë¡œ ì§€ì • ê°€ëŠ¥ 4.ì˜¨í”„ë ˆë¯¸ìŠ¤ ê°€ìƒ ë¨¸ì‹ (VM) ë˜ëŠ” ì„œë²„ Amazon ECS AnywhereëŠ” ì˜¨í”„ë ˆë¯¸ìŠ¤ ì„œë²„ë‚˜ ê°€ìƒ ë¨¸ì‹ (VM)ê³¼ ê°™ì€ ì™¸ë¶€ ì¸ìŠ¤í„´ìŠ¤ë¥¼ Amazon ECS í´ëŸ¬ìŠ¤í„°ì— ë“±ë¡í•  ìˆ˜ ìˆë„ë¡ ì§€ì›ë¹„êµ ìš”ì•½ êµ¬ë¶„ ECS + EC2 ECS + Managed Instances ECS + Fargate ê°œë… í•œ ì¤„ ìš”ì•½ EC2 ìœ„ì— ECSë¥¼ ì˜¬ë¦¬ê³  ì„œë²„ë¥¼ ì§ì ‘ ìš´ì˜ EC2ëŠ” ì“°ë˜ ì„œë²„ ìš´ì˜ì€ AWSê°€ ëŒ€í–‰ ì„œë²„ ê°œë… ì—†ì´ ì»¨í…Œì´ë„ˆë§Œ ì‹¤í–‰ ì„œë²„ ê´€ë¦¬ ì±…ì„ ì‚¬ìš©ì AWS AWS EC2 ì¸ìŠ¤í„´ìŠ¤ ì„ íƒ ì§ì ‘ ì„ íƒ ì„ íƒ ê°€ëŠ¥ ë¶ˆê°€ ì„œë²„ íŒ¨ì¹˜ / êµì²´ ì§ì ‘ AWS AWS Auto Scaling ì§ì ‘ êµ¬ì„± AWS ìë™ ì„œë²„ ì¥ì•  ëŒ€ì‘ ì§ì ‘ AWS AWS ì„œë²„ ì ‘ê·¼(SSH) ê°€ëŠ¥ ë¶ˆê°€ ë¶ˆê°€ CPU / ë©”ëª¨ë¦¬ ì§€ì • (EC2 ë‹¨ìœ„) (EC2 ë‹¨ìœ„) (Task ë‹¨ìœ„) GPU ì‚¬ìš© ê°€ëŠ¥ ê°€ëŠ¥ ë¶ˆê°€ íŠ¹ìˆ˜ ì¸ìŠ¤í„´ìŠ¤ ê°€ëŠ¥ ê°€ëŠ¥ ë¶ˆê°€ Provisioning ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ê¸° ì „ì—, ECSê°€ ë™ì‘í•  ìˆ˜ ìˆë„ë¡ í•„ìš”í•œ ê²ƒë“¤ì„ ë¯¸ë¦¬ ë§Œë“¤ì–´ ë‘ëŠ” ì‘ì—… Provisioning : ì‹œìŠ¤í…œ ìì›(ì„œë²„, ë„¤íŠ¸ì›Œí¬, ìŠ¤í† ë¦¬ì§€, ì†Œí”„íŠ¸ì›¨ì–´ ë“±)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìƒíƒœë¡œ ì¤€ë¹„í•˜ê³  ì„¤ì •í•˜ëŠ” ëª¨ë“  ì ˆì°¨ ECSê°€ ë™ì‘í•˜ë ¤ë©´ í•„ìš”í•œ ê²ƒë“¤: í´ëŸ¬ìŠ¤í„° íƒœìŠ¤í¬ ì •ì˜ (í•„ìš”í•˜ë©´) ì„œë¹„ìŠ¤ ë„¤íŠ¸ì›Œí¬ ì„¤ì • IAM Role ë¡œê·¸ ì„¤ì • Capacity (EC2 / Fargate / Managed) ì´ê±¸ ë§Œë“¤ì–´ ë‘ëŠ” í–‰ìœ„ ì „ì²´ê°€ ECS í”„ë¡œë¹„ì €ë‹Amazon ECSë¥¼ í”„ë¡œë¹„ì €ë‹í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ ê°€ì§€ ì˜µì…˜ AWS Management ì½˜ì†” Amazon ECS ë¦¬ì†ŒìŠ¤ ì•¡ì„¸ìŠ¤ì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì›¹ ì¸í„°í˜ì´ìŠ¤ë¥¼ ì œê³µ AWS Command Line Interface(AWS CLI) Amazon ECSë¥¼ í¬í•¨í•˜ì—¬ ë‹¤ì–‘í•œ AWS ì„œë¹„ìŠ¤ì— ëŒ€í•œ ëª…ë ¹ì„ ì œê³µ AWS SDK ì–¸ì–´ë³„ APIë¥¼ ì œê³µí•˜ê³  ë§ì€ ì—°ê²° ì„¸ë¶€ ì •ë³´ë¥¼ ì²˜ë¦¬ AWS CDK í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í´ë¼ìš°ë“œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¦¬ì†ŒìŠ¤ë¥¼ ëª¨ë¸ë§í•˜ê³  í”„ë¡œë¹„ì €ë‹í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ í”„ë ˆì„ì›Œí¬ë¥¼ ì œê³µ ECS êµ¬ì„± ìš”ì†Œ1. Task Definition ì»¨í…Œì´ë„ˆë¥¼ â€œì–´ë–»ê²Œ ì‹¤í–‰í• ì§€â€ì— ëŒ€í•œ ì„¤ê³„ì„œ ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒì´ í¬í•¨ë¨: Docker ì´ë¯¸ì§€ CPU / ë©”ëª¨ë¦¬ í™˜ê²½ ë³€ìˆ˜ í¬íŠ¸ ë¡œê·¸ ì„¤ì • ë³¼ë¥¨(EFS ë“±) ì˜ˆì‹œTask Definition: api-server-task- image: my-api-server:1.0- cpu: 512- memory: 1024- port: 8080- env: SPRING_PROFILES=prod2. Cluster ì»¨í…Œì´ë„ˆë¥¼ ì˜¬ë ¤ë‘˜ ì‹¤í–‰ í™˜ê²½ (ECSë¥¼ ì“°ë©´ ë¬´ì¡°ê±´ í´ëŸ¬ìŠ¤í„°ëŠ” ì¡´ì¬) ì„œë²„ ë¬¶ìŒ(EC2)ì¼ ìˆ˜ë„ ìˆê³ , ì„œë²„ ê°œë… ì—†ëŠ” Fargateì¼ ìˆ˜ë„ ìˆìŒ ì˜ˆì‹œCluster: api-cluster- capacity: Fargate3. Task Task Definitionì„ ë°”íƒ•ìœ¼ë¡œ ì‹¤í–‰ëœ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ë˜ê³ , ì¼í•˜ê³  ëë‚˜ë©´ ì¢…ë£Œë  ìˆ˜ë„ ìˆìŒ ìƒíƒœ ìˆìŒ (RUNNING / STOPPED)api-cluster â”œâ”€ Task #1 (RUNNING) â”‚ â””â”€ API Server Container â””â”€ Task #2 (RUNNING) â””â”€ API Server Container4. Service Taskë¥¼ ì§€ì •í•œ ê°œìˆ˜ë§Œí¼ ìœ ì§€í•´ì£¼ëŠ” ê´€ë¦¬ì Taskê°€ ì£½ìœ¼ë©´ ìë™ìœ¼ë¡œ ìƒˆ Task ì‹¤í–‰ íŠ¹ì§•: ì¥ê¸° ì‹¤í–‰ Stateless ì „ì œ desired count ê°œë… ì¡´ì¬ Service: api-server-service- task definition: api-server-task- desired count: 25. Account Settings ECS ê³„ì • ì „ì²´ì— ì ìš©ë˜ëŠ” ì„¤ì • ê°œë³„ ì„œë¹„ìŠ¤ë‚˜ íƒœìŠ¤í¬ê°€ ì•„ë‹ˆë¼ ê³„ì • ì „ì²´ ê¸°ì¤€ íŠ¹ì • ECS ê¸°ëŠ¥ í™œì„±í™”, ë¡œê·¸/ê¶Œí•œ ê´€ë ¨ ì„¤ì • ë“± ECS Exec ì‚¬ìš© ì—¬ë¶€ IAM role ì‚¬ìš© ì„¤ì • 6. Cluster Auto Scaling í´ëŸ¬ìŠ¤í„°ì— ë“±ë¡ëœ EC2 ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ë¥¼ ìë™ ì¡°ì ˆ (EC2 ê¸°ë°˜ ECSì—ì„œë§Œ í•´ë‹¹) ì»¨í…Œì´ë„ˆëŠ” ëŠ˜ì–´ë‚˜ëŠ”ë°, ì˜¬ë¦´ ì„œë²„ê°€ ë¶€ì¡±í•  ë•Œ ex : í˜„ì¬ EC2 2ëŒ€ - Task ì¦ê°€ â†’ EC2 4ëŒ€ë¡œ ìë™ í™•ì¥7. Service Auto Scaling Serviceê°€ ê´€ë¦¬í•˜ëŠ” Task ê°œìˆ˜ë¥¼ ìë™ ì¡°ì ˆ (CPU / ë©”ëª¨ë¦¬ / ìš”ì²­ëŸ‰ ë“±ì„ ê¸°ì¤€ìœ¼ë¡œ) ex : CPU 70% ì´ˆê³¼ â†’ Task 2ê°œ â†’ 5ê°œë¡œ ì¦ê°€ì°¸ê³  ìë£Œ https://docs.aws.amazon.com/AmazonECS/latest/developerguide/Welcome.html ChatGPT" }, { "title": "ì˜¤ëŠ˜ ë“œëŠ” ìƒê° (251224, ì˜³ì€ ê²°ì •)", "url": "/posts/daily-note-20251224/", "categories": "ë„ì ë„ì ", "tags": "", "date": "2025-12-24 23:20:00 +0900", "snippet": "11ì›” ì¤‘ìˆœë¶€í„° ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ì˜ ê°œë°œ ë¶€ë¶„ì„ ë¦¬ë“œí•˜ê²Œ ë¼ì„œ ë°”ìœ ë‚˜ë‚ ì„ ë³´ë‚´ê³  ìˆë‹¤.ì •ë‹µì´ ì—†ëŠ” ì„ íƒì˜ ê¸°ë¡œì—ì„œ ë‚˜ë¦„ëŒ€ë¡œì˜ ê·¼ê±°ë¥¼ ê°–ê³  ë…¼ì˜í•˜ê³  ê²°ì •ì„ ë‚´ë¦¬ê³  ìˆì§€ë§Œ, â€˜ì •ë§ ë‚´ê°€ ìƒê°í•œ ë°©í–¥ì´ ë§ì„ê¹Œâ€™í•˜ëŠ” ë¶ˆì•ˆê°ì´ ì—„ìŠµí•´ì˜¤ê¸°ë„ í•œë‹¤.ê·¸ëŸ¬ë‹¤, í‰ì†Œ ì¦ê²¨ë³´ëŠ” ì•ˆì„±ì¬ ì‰í”„ë‹˜ì˜ ìœ íŠœë¸Œ ì±„ë„ì—ì„œ ì¸ìƒê¹Šê²Œ ë´¤ë˜ ë§ì´ ë– ì˜¬ëë‹¤.â€œì˜³ì€ ê²°ì •ì€ ì—†ì–´, ê·¸ ê²°ì •ì„ ...", "content": "11ì›” ì¤‘ìˆœë¶€í„° ìƒˆë¡œìš´ í”„ë¡œì íŠ¸ì˜ ê°œë°œ ë¶€ë¶„ì„ ë¦¬ë“œí•˜ê²Œ ë¼ì„œ ë°”ìœ ë‚˜ë‚ ì„ ë³´ë‚´ê³  ìˆë‹¤.ì •ë‹µì´ ì—†ëŠ” ì„ íƒì˜ ê¸°ë¡œì—ì„œ ë‚˜ë¦„ëŒ€ë¡œì˜ ê·¼ê±°ë¥¼ ê°–ê³  ë…¼ì˜í•˜ê³  ê²°ì •ì„ ë‚´ë¦¬ê³  ìˆì§€ë§Œ, â€˜ì •ë§ ë‚´ê°€ ìƒê°í•œ ë°©í–¥ì´ ë§ì„ê¹Œâ€™í•˜ëŠ” ë¶ˆì•ˆê°ì´ ì—„ìŠµí•´ì˜¤ê¸°ë„ í•œë‹¤.ê·¸ëŸ¬ë‹¤, í‰ì†Œ ì¦ê²¨ë³´ëŠ” ì•ˆì„±ì¬ ì‰í”„ë‹˜ì˜ ìœ íŠœë¸Œ ì±„ë„ì—ì„œ ì¸ìƒê¹Šê²Œ ë´¤ë˜ ë§ì´ ë– ì˜¬ëë‹¤.â€œì˜³ì€ ê²°ì •ì€ ì—†ì–´, ê·¸ ê²°ì •ì„ ì˜³ê²Œ ë§Œë“œëŠ”ê±°ì•¼.â€ë¬¼ë¡ , ì•„ë¬´ ë…¼ë¦¬ë„ ì—†ì´ ê²°ì •í•˜ëŠ”ê±´ ì•ˆë˜ê² ì§€ë§Œ, ë‚˜ë¦„ì˜ ìƒê°ì„ ê°–ê³  ê²°ì •í–ˆë‹¤ë©´ ë¶ˆì•ˆê°ì— ì§‘ì¤‘í•˜ê¸° ë³´ë‹¤ëŠ” ê·¸ ê²°ì •ì„ ì˜³ê²Œ ë§Œë“¤ê¸° ìœ„í•œ ë…¸ë ¥ì„ í•˜ì." }, { "title": "IntelliJì—ì„œ í”„ë¡œì íŠ¸ ì„¸íŒ…í•˜ê¸° (Gradle, Spring Boot)", "url": "/posts/spring-boot-project-setting/", "categories": "ì§€ì‹ ë”í•˜ê¸°, Hello-World êµ¬í˜„", "tags": "Spring Boot, IntelliJ", "date": "2025-11-14 22:25:00 +0900", "snippet": "Gradle ê¸°ë°˜ ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ì„¸íŒ…í•´ë³´ì.í”„ë¡œì íŠ¸ ë§Œë“¤ê¸° ì‹¤ìŠµí™˜ê²½ : IntelliJ IDEA 2025.2 ê²½ë¡œ : File &gt; New &gt; Project...í”„ë¡œì íŠ¸ ì„¸íŒ… File &gt; Project StructureProject SDK í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•  JDK ë²„ì „ì„ ì§€ì • í”„ë¡œì íŠ¸ ë‚´ ëª¨ë“  ëª¨ë“ˆì´ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•  ê¸°...", "content": "Gradle ê¸°ë°˜ ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ë¥¼ ì„¸íŒ…í•´ë³´ì.í”„ë¡œì íŠ¸ ë§Œë“¤ê¸° ì‹¤ìŠµí™˜ê²½ : IntelliJ IDEA 2025.2 ê²½ë¡œ : File &gt; New &gt; Project...í”„ë¡œì íŠ¸ ì„¸íŒ… File &gt; Project StructureProject SDK í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•  JDK ë²„ì „ì„ ì§€ì • í”„ë¡œì íŠ¸ ë‚´ ëª¨ë“  ëª¨ë“ˆì´ ê³µí†µìœ¼ë¡œ ì‚¬ìš©í•  ê¸°ë³¸ SDK ë¹Œë“œ ê²°ê³¼ë¬¼ì˜ ì‹¤í–‰ í™˜ê²½(Java Runtime)ê³¼ ë§ì¶°ì•¼ ëŸ°íƒ€ì„ ì˜¤ë¥˜ë¥¼ ë°©ì§€í•  ìˆ˜ ìˆìŒLanguage level Java ë¬¸ë²•ì„ ì–´ëŠ ë²„ì „ê¹Œì§€ ì‚¬ìš©í• ì§€ ê²°ì • ì„¤ì • ì˜ë¯¸ JDK 21 + Language level 21 JDK21 ê¸°ëŠ¥ ëª¨ë‘ ì‚¬ìš© ê°€ëŠ¥ JDK 21 + Language level 17 Java 17 ë¬¸ë²•ìœ¼ë¡œë§Œ ì½”ë“œ ì‘ì„± ê°€ëŠ¥ JDK 17 + Language level 21 ë¶ˆê°€ëŠ¥ (SDKê°€ ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ëª»í•¨) JDK21ë¶€í„° ì§€ì›í•˜ëŠ” ë¬¸ë²• ì‚¬ìš©í•´ë³´ê¸° JDK 21 + Language level 17 JDK 17 + Language level 21 â€» ëª¨ë“ˆ ë‹¨ìœ„ë¡œ SDK, Language level ì„¤ì • ê°€ëŠ¥ ì˜ˆ : ë©€í‹°ëª¨ë“ˆ í”„ë¡œì íŠ¸ì—ì„œ ê° ëª¨ë“ˆì˜ Java ë²„ì „ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ core ëª¨ë“ˆ â†’ Java 17 admin ëª¨ë“ˆ â†’ Java 21 api ëª¨ë“ˆ â†’ Java 11 Compiler output ì»´íŒŒì¼í•œ .class íŒŒì¼ì„ ì–´ë””ì— ì €ì¥í• ì§€ ì •í•˜ëŠ” ê²½ë¡œ Maven/Gradle ë¹Œë“œ ì¶œë ¥(target/, build/)ì´ ì•„ë‹ˆë¼ IntelliJ ìì²´ ë¹Œë“œ í–ˆì„ ë•Œ .class íŒŒì¼ì„ ì €ì¥í•˜ëŠ” ë””ë ‰í„°ë¦¬.Platform Settings &gt; SDKs IntelliJ ì „ì²´(IDE ì°¨ì›)ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” JDK ëª©ë¡ì„ ë“±ë¡/ê´€ë¦¬í•˜ëŠ” ê³µê°„ ì¦‰, í”„ë¡œì íŠ¸ì— ì ìš©í•˜ê¸° ì „ì— IntelliJê°€ ì¸ì‹í•  ìˆ˜ ìˆëŠ” JDKë“¤ì„ ë“±ë¡í•´ë‘ëŠ” ê³³ ì´ê³³ì— ë“±ë¡ë˜ì–´ì•¼ í”„ë¡œì íŠ¸, ëª¨ë“ˆì—ì„œ SDK ì„ íƒí•  ìˆ˜ ìˆìŒ IDE ì„¤ì • IntelliJ IDEA &gt; settingsProject bytecode version ì»´íŒŒì¼ëœ .class íŒŒì¼ì˜ ë²„ì „(ë°”ì´íŠ¸ì½”ë“œ íƒ€ê²Ÿ)ì„ ì§€ì • ì˜ˆë¥¼ ë“¤ì–´: Language level: 21 SDK: JDK 21 Project bytecode version: 11 í•˜ì§€ë§Œ Java 21 ë¬¸ë²•ì„ Java 11 bytecodeë¡œ ë‹¤ìš´ê·¸ë ˆì´ë“œí•  ìˆ˜ ì—†ìŒ. ê·¸ë˜ì„œ, ëŒ€ë¶€ë¶„ì˜ ê²½ìš° Language Level = SDK = Bytecode Versionì„ ë§ì¶˜ë‹¤.Build Tool &gt; Gradle IntelliJì—ì„œ Gradleë¡œ í”„ë¡œì íŠ¸ ê´€ë¦¬ì‹œ ë‘ ê°€ì§€ ì»´íŒŒì¼ ë°©ì‹ì´ ìˆìŒ ë¹Œë“œ/ì‹¤í–‰ ë°©ë²• ì»´íŒŒì¼ ìˆ˜í–‰ ì£¼ì²´(ëˆ„ê°€ javacì„ ì‹¤í–‰ì‹œí‚¤ëŠ”ê°€?) ì‚¬ìš©ë˜ëŠ” javacì˜ JDK ë²„ì „ IntelliJ Build IntelliJ IDE Project SDKì˜ javac Gradle Build (./gradlew build or Run) Gradle(JavaCompile task) Gradle JVMì˜ javac ë˜ëŠ” Gradle toolchain GradleToolchain ê³µì‹ë¬¸ì„œ ì½”ë“œë¥¼ ì»´íŒŒì¼ í•  ë•Œ ì–´ë–¤ JDKë¥¼ ì‚¬ìš©í• ì§€ë¥¼ Gradleì´ ì§ì ‘ ë‹¤ìš´ë°›ì•„ ì§€ì •í•˜ëŠ” ê¸°ëŠ¥// build.gradlejava { toolchain { languageVersion = JavaLanguageVersion.of(21) }} Toolchainì´ ë‹¤ìš´ë¡œë“œí•œ ëª¨ë“  JDKëŠ” ~/.gradle/jdks/&lt;jdk-version&gt;/ì— ìˆìŒ Gradle Toolchainì´ JDKë¥¼ ë‹¤ìš´ë°›ëŠ” ê¸°ë³¸ ì €ì¥ì†Œ : Adoptium / Eclipse Temurin (ê¸°ë³¸ê°’) Gradleì€ ë‹¤ìŒ ìˆœì„œë¡œ JDKë¥¼ ì°¾ëŠ”ë‹¤: í™˜ê²½ë³€ìˆ˜ JAVA_HOME SDKMAN ì„¤ì¹˜ JDK ASDF ì„¤ì¹˜ JDK /usr/lib/jvm ê°™ì€ ì‹œìŠ¤í…œ JDK Windows ë ˆì§€ìŠ¤íŠ¸ë¦¬ì˜ JDK ê·¸ë˜ë„ ì—†ìœ¼ë©´ ê¸°ë³¸ ì €ì¥ì†Œì—ì„œ ë‹¤ìš´ë¡œë“œ ì˜ˆì‹œ ìƒí™© í™˜ê²½ Toolchain ì—†ìŒ Toolchain ìˆìŒ ë¡œì»¬ IntelliJ ë¹Œë“œ (Gradle Buildì¸ ê²½ìš°) IntelliJ Gradle JVM JDK Toolchain JDK ë¡œì»¬ í„°ë¯¸ë„ ./gradlew build $JAVA_HOME Toolchain JDK Jenkins ì„œë²„ ë¹Œë“œ Jenkinsì— ì„¤ì¹˜ëœ JDK Toolchain JDK GitHub Actions setup-javaë¡œ ì§€ì •í•œ JDK Toolchain JDK Docker ë¹Œë“œ Docker ì´ë¯¸ì§€ ë‚´ì˜ JDK Toolchain JDK ì¼ê´€ì„± ì„œë¡œ ë‹¤ë¦„ í•­ìƒ ë™ì¼ ì‚¬ëŒë§ˆë‹¤ / ì„œë²„ë§ˆë‹¤ JDK ë²„ì „ì´ ë‹¤ë¥´ë©´, ë¹Œë“œ ê²°ê³¼ì™€ ì—ëŸ¬ë„ ë‹¤ë¥´ê²Œ ë‚˜ì˜¬ ìˆ˜ ìˆë‹¤. ì˜ˆì‹œ: ê°œë°œì A: Java 21ë¡œ ë¹Œë“œ â†’ ì„±ê³µ ê°œë°œì B: Java 17ë¡œ ë¹Œë“œ â†’ ì‹¤íŒ¨ Jenkins: Java 11ë¡œ ë¹Œë“œ â†’ ì‹¤íŒ¨ â€œë¡œì»¬ì€ ë˜ëŠ”ë° ì„œë²„ì—ì„œëŠ” ì•ˆëœë‹¤â€ ë¬¸ì œ ë°œìƒì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹¤í–‰ ë°©ì‹ ì‹¤í–‰ ì£¼ì²´ ì‹¤í–‰ JDK íŠ¹ì§• Build and Run using IntelliJ IntelliJ Project SDK ê°œë°œ í¸ì˜ì„± ì¢‹ìŒ Build and Run using Gradle (./gradlew bootRun ì‹¤í–‰í•œ ê²ƒê³¼ ë™ì¼) Gradle Gradle JVM or Toolchain IDE/Gradle ì¼ê´€ì„± ./gradlew bootRun Gradle JAVA_HOME or Toolchain í„°ë¯¸ë„/CI ì¹œí™”ì  ./gradlew bootJar â€“&gt; java -jar OS JVM ì„œë²„ JDK ìš´ì˜ ë°°í¬ ë°©ì‹ Docker ì‹¤í–‰ Docker Docker JDK í™˜ê²½ ì™„ì „ ê²©ë¦¬ ì •ë¦¬ ì„¤ì • ì„¤ì • Project SDK Temurin 21 Project Language Level SDK Default Module Language Level Project Default Compiler â€“ bytecode version 21 Gradle JVM Project SDK (Temurin 21) Gradle Toolchain (build.gradle) ì—†ìŒ ë˜ëŠ” ê°™ìŒ(21) IntelliJ ë¹Œë“œ, Gradle ë¹Œë“œ, ëŸ°íƒ€ì„ ëª¨ë‘ JDK 21ë¡œ í†µì¼ë˜ë¯€ë¡œ ì˜ˆìƒì¹˜ ëª»í•œ ë¹Œë“œ ì˜¤ë¥˜, bytecode mismatch, IDE/Gradle ì¶©ëŒ ë¬¸ì œ ë“±ì„ ë°©ì§€ í•  ìˆ˜ ìˆìŒ" }, { "title": "Git - Submodule ì•Œì•„ë³´ê¸°", "url": "/posts/git-submodule/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Git", "date": "2025-11-12 22:25:00 +0900", "snippet": "ë°°ê²½ AWS í™˜ê²½ì—ì„œ ìš´ì˜ì‹œ ì‚¬ë‚´ nexusë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ì„œ, common ëª¨ë“ˆ ê°™ì€ ê³µí†µ ëª¨ë“ˆì„ ë³„ë„ í”„ë¡œì íŠ¸ë¡œ ê´€ë¦¬í•˜ê³ , git submoduleë¡œ í¬í•¨ì‹œí‚¨ë‹¤ëŠ”ë° ì´ê²Œ ì–´ë–¤ ì˜ë¯¸ì¼ê¹Œ ? ë³´í†µ ì‚¬ë‚´ì—ì„œ ë¹Œë“œëœ ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬(common module)ëŠ” Nexus (ë˜ëŠ” Artifactory) ê°™ì€ ì‚¬ì„¤ Maven Repositoryì— ì—…ë¡œë“œ...", "content": "ë°°ê²½ AWS í™˜ê²½ì—ì„œ ìš´ì˜ì‹œ ì‚¬ë‚´ nexusë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ì„œ, common ëª¨ë“ˆ ê°™ì€ ê³µí†µ ëª¨ë“ˆì„ ë³„ë„ í”„ë¡œì íŠ¸ë¡œ ê´€ë¦¬í•˜ê³ , git submoduleë¡œ í¬í•¨ì‹œí‚¨ë‹¤ëŠ”ë° ì´ê²Œ ì–´ë–¤ ì˜ë¯¸ì¼ê¹Œ ? ë³´í†µ ì‚¬ë‚´ì—ì„œ ë¹Œë“œëœ ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬(common module)ëŠ” Nexus (ë˜ëŠ” Artifactory) ê°™ì€ ì‚¬ì„¤ Maven Repositoryì— ì—…ë¡œë“œ ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì˜ì¡´ì„±ìœ¼ë¡œ ì´ë ‡ê²Œ ë¶ˆëŸ¬ì˜¨ë‹¤.dependencies { implementation 'com.company:common:1.2.3'} ì´ë ‡ê²Œ í•˜ë©´ ë¹Œë“œ ì‹œ Gradle/Mavenì´ Nexusì—ì„œ jarë¥¼ ë°›ì•„ì˜¨ë‹¤. ê·¸ëŸ°ë° AWS í™˜ê²½ì—ì„œëŠ” ì¢…ì¢… ë‹¤ìŒê³¼ ê°™ì€ ì´ìœ ë¡œ ì‚¬ë‚´ Nexusì— ì ‘ê·¼ì´ ë¶ˆê°€ëŠ¥í•  ìˆ˜ ìˆë‹¤: AWS VPC ë‚´ë¶€ë§ì—ì„œ ì‚¬ë‚´ë§(Nexus ì„œë²„) ìœ¼ë¡œ ì§ì ‘ ì ‘ê·¼ì´ ì°¨ë‹¨ë¨ VPN ì—°ê²° ì—†ì´ ì™¸ë¶€ë§(AWS)ì—ì„œ ë‚´ë¶€ë§(Nexus)ì— ì ‘ê·¼ ë¶ˆê°€ Nexus ì„œë²„ê°€ í”„ë¼ì´ë¹— ë„¤íŠ¸ì›Œí¬ì— ìˆê³ , ì¸í„°ë„·ì— ë…¸ì¶œë˜ì§€ ì•ŠìŒ ì¦‰, ì˜ì¡´ì„± ì•„í‹°íŒ©íŠ¸ë¥¼ ì›ê²© Repositoryì—ì„œ ë°›ì„ ìˆ˜ ì—†ëŠ” ìƒí™©ì´ ëœë‹¤.â€» Nexus ? Sonatype Nexus RepositoryëŠ” ë¹Œë“œ ê²°ê³¼ë¬¼(ì˜ˆ: jar, war, npm íŒ¨í‚¤ì§€, Docker ì´ë¯¸ì§€ ë“±)ì„ì¤‘ì•™ì—ì„œ ì €ì¥í•˜ê³  ë°°í¬í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” Artifact Repository(ì•„í‹°íŒ©íŠ¸ ì €ì¥ì†Œ)ì¦‰, Maven Centralì´ë‚˜ npmjs.org ê°™ì€ ê³µìš© ì €ì¥ì†Œì˜ ì‚¬ë‚´ ë²„ì „ í•„ìš”ì„± ì—¬ëŸ¬ í”„ë¡œì íŠ¸ì—ì„œ ê³µí†µ ë¼ì´ë¸ŒëŸ¬ë¦¬(core, util ë“±) ì‚¬ìš© ì™¸ë¶€ ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ì´ ì œí•œëœ í™˜ê²½ (AWS VPC, ë‚´ë¶€ë§ ë“±) íšŒì‚¬ ë‚´ë¶€ ì „ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ (ë³´ì•ˆìƒ ì™¸ë¶€ì— ê³µê°œ ë¶ˆê°€) ê·¸ë˜ì„œ â€œì‚¬ë‚´ ì „ìš© Maven Centralâ€ ê°™ì€ ì„œë²„ê°€ í•„ìš” ì—­í•  ì„¤ëª… Artifact ì €ì¥ì†Œ ë¹Œë“œ ê²°ê³¼ë¬¼(JAR, WAR, ZIP, Docker ì´ë¯¸ì§€ ë“±)ì„ ì—…ë¡œë“œ(Publish)í•˜ê³  ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œ ë‹¤ìš´ë¡œë“œ(Fetch) ê°€ëŠ¥ ì‚¬ì„¤ Repository ê´€ë¦¬ ì™¸ë¶€ ê³µê°œ ë¶ˆê°€ëŠ¥í•œ ë‚´ë¶€ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë³´ê´€ Proxy Cache Maven Central, npm registry ë“±ì˜ ìºì‹œ í”„ë¡ì‹œ ì—­í•  (ì™¸ë¶€ íŒ¨í‚¤ì§€ë¥¼ í•œ ë²ˆ ë°›ì•„ë‘ë©´ ë‚´ë¶€ì—ì„œ ë¹ ë¥´ê²Œ ì¬ì‚¬ìš© ê°€ëŠ¥) ë²„ì „ ê´€ë¦¬ ì•„í‹°íŒ©íŠ¸ì˜ ë²„ì „ì„ 1.0.0, 1.0.1, SNAPSHOT ë“±ìœ¼ë¡œ ê´€ë¦¬ ê¶Œí•œ ê´€ë¦¬ LDAP, SSO ì—°ë™ìœ¼ë¡œ íŒ€ë³„ ì ‘ê·¼ ê¶Œí•œ ì œì–´ ê°€ëŠ¥ AWS í™˜ê²½ì—ì„œëŠ” Nexus ëŒ€ì‹  AWS CodeArtifact(AWS ê´€ë¦¬í˜• Nexus ê°™ì€ ì„œë¹„ìŠ¤)ê°€ ê°™ì€ ì—­í• ì„ í•œë‹¤.Git Submodule í•˜ë‚˜ì˜ Git ì €ì¥ì†Œ ì•ˆì— ë‹¤ë¥¸ Git ì €ì¥ì†Œë¥¼ í•˜ìœ„ ë””ë ‰í„°ë¦¬ë¡œ í¬í•¨ì‹œí‚¤ëŠ” ê¸°ëŠ¥main-repo/â”œâ”€â”€ .gitmodulesâ”œâ”€â”€ app/â””â”€â”€ common-lib/ â† ë‹¤ë¥¸ Git ì €ì¥ì†Œ (submodule)ì£¼ìš” íŠ¹ì§• í•­ëª© ì„¤ëª… ë…ë¦½ ë²„ì „ ê´€ë¦¬ Submoduleì€ ìì²´ Git íˆìŠ¤í† ë¦¬ë¥¼ ê°€ì§€ê³  ìˆì–´ìš”. ë¶€ëª¨ ì €ì¥ì†Œì™€ ë³„ë„ë¡œ ì»¤ë°‹, í‘¸ì‹œ ê°€ëŠ¥. íŠ¹ì • ì»¤ë°‹ ê³ ì • ë¶€ëª¨ ì €ì¥ì†ŒëŠ” submoduleì˜ â€œë¸Œëœì¹˜â€ê°€ ì•„ë‹ˆë¼ â€œíŠ¹ì • ì»¤ë°‹ SHAâ€ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤. ì—…ë°ì´íŠ¸ëŠ” ìˆ˜ë™ submodule ìª½ì—ì„œ ë³€ê²½ì´ ìˆì–´ë„, ë¶€ëª¨ ì €ì¥ì†Œì—ì„œëŠ” git submodule updateë¡œ ì§ì ‘ ê°±ì‹ í•´ì•¼ ë°˜ì˜ë©ë‹ˆë‹¤. .gitmodules íŒŒì¼ submodule ê²½ë¡œì™€ ì›ê²© ì €ì¥ì†Œ URLì„ ê´€ë¦¬í•˜ëŠ” ì„¤ì • íŒŒì¼ì…ë‹ˆë‹¤. ë©€í‹°ëª¨ë“ˆ í”„ë¡œì íŠ¸ì™€ì˜ ì°¨ì´ ë¹„êµ í•­ëª© Git Submodule ë©€í‹°ëª¨ë“ˆ í”„ë¡œì íŠ¸ (ì˜ˆ: Gradle, Maven ë“±) ì†ŒìŠ¤ ê´€ë¦¬ ë‹¨ìœ„ ê° ëª¨ë“ˆì´ ì„œë¡œ ë‹¤ë¥¸ Git ì €ì¥ì†Œ í•˜ë‚˜ì˜ Git ì €ì¥ì†Œ ì•ˆì— ì—¬ëŸ¬ ëª¨ë“ˆ ë²„ì „ ê´€ë¦¬ ê° ëª¨ë“ˆì€ ìì²´ ë²„ì „, ì»¤ë°‹ íˆìŠ¤í† ë¦¬ë¥¼ ê°€ì§ ì „ì²´ê°€ í•œ ì»¤ë°‹ ë‹¨ìœ„ë¡œ ë²„ì „ ê´€ë¦¬ë¨ ì˜ì¡´ì„± ì—°ê²° ë°©ì‹ Git ì»¤ë°‹ ê¸°ë°˜ ë§í¬ (.gitmodules) ë¹Œë“œ ì‹œìŠ¤í…œ(Gradle, Maven)ì˜ settings.gradleì´ë‚˜ pom.xmlë¡œ ì—°ê²° ì—…ë°ì´íŠ¸ ë°©ì‹ ìˆ˜ë™ìœ¼ë¡œ git submodule update ìë™ìœ¼ë¡œ ê°™ì€ ë¸Œëœì¹˜/ì»¤ë°‹ ê¸°ì¤€ì—ì„œ ë¹Œë“œ ë¹Œë“œ í†µí•©ì„± ë…ë¦½ì  ë¹Œë“œ, í†µí•© ìë™í™” ì–´ë ¤ì›€ ì „ì²´ í”„ë¡œì íŠ¸ë¥¼ í•œ ë²ˆì— ë¹Œë“œ ê°€ëŠ¥ ì£¼ ì‚¬ìš© ëª©ì  ì™¸ë¶€ ê³µìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ë‚˜ ê³µí†µ ëª¨ë“ˆ ì¬ì‚¬ìš© ëŒ€ê·œëª¨ ë‹¨ì¼ í”„ë¡œì íŠ¸ë¥¼ ë…¼ë¦¬ì ìœ¼ë¡œ ë¶„ë¦¬ ì¥/ë‹¨ì  êµ¬ë¶„ ë‚´ìš© ì¥ì  - Nexusê°€ ì—†ì–´ë„ ê³µí†µ ëª¨ë“ˆ ì‚¬ìš© ê°€ëŠ¥- ê° ëª¨ë“ˆì˜ ë²„ì „ì„ Git ì»¤ë°‹ìœ¼ë¡œ ê³ ì • ê°€ëŠ¥- ë³„ë„ jar ë°°í¬ ì—†ì´ ì½”ë“œ ë™ê¸°í™” ê°€ëŠ¥ ë‹¨ì  - submodule ì—…ë°ì´íŠ¸ë¥¼ ìˆ˜ë™ìœ¼ë¡œ í•´ì•¼ í•¨ (git submodule update)- ì—¬ëŸ¬ í”„ë¡œì íŠ¸ê°€ ê°™ì€ submoduleì„ ì“°ë©´ ë²„ì „ ë™ê¸°í™”ê°€ ë²ˆê±°ë¡œìš¸ ìˆ˜ ìˆìŒ- ë¹Œë“œ ì‹œìŠ¤í…œ í†µí•© ê´€ë¦¬ê°€ ì–´ë ¤ì›€ ì ìš© ë””ë ‰í† ë¦¬ êµ¬ì¡°repo1/â”œâ”€â”€ .gitmodulesâ”œâ”€â”€ api/â”œâ”€â”€ admin/â”œâ”€â”€ web/â””â”€â”€ core/ â† submodule (repo2) ëª…ë ¹ì–´# repo1ì—ì„œ core ëª¨ë“ˆ(submodule) ì¶”ê°€# ì¦‰, repo1ì€ core ì €ì¥ì†Œì˜ íŠ¹ì • ì»¤ë°‹ SHAë¥¼ ê¸°ë¡ (.gitmodules íŒŒì¼ê³¼ ë‚´ë¶€ .git/configì— ì €ì¥ë¨)git submodule add https://github.com/company/repo2.git core# ì„œë¸Œëª¨ë“ˆ ì´ˆê¸°í™” ë° ì—…ë°ì´íŠ¸git submodule initgit submodule update repo1/settings.gradleinclude(\":api\", \":admin\", \":web\", \":core\")project(\":core\").projectDir = file(\"core\") repo1/build.gradledependencies { implementation project(\":core\")} core ì½”ë“œëŠ” ê°™ì€ ì›Œí¬ìŠ¤í˜ì´ìŠ¤ì— ì¡´ì¬í•˜ë¯€ë¡œ, AWS í™˜ê²½ì—ì„œë„ ë³„ë„ Nexus ì—†ì´ ë¹Œë“œ ê°€ëŠ¥í•´ì§„ë‹¤. ì´ë•Œ commonì€ ë³„ë„ì˜ Git ë ˆí¬ì§€í† ë¦¬ì´ë©°, main-project ì•ˆì—ëŠ” ê·¸ ë ˆí¬ì§€í† ë¦¬ì˜ íŠ¹ì • ì»¤ë°‹ì„ submoduleë¡œ ì—°ê²° ë¹Œë“œ ì‹œ commonì˜ ì†ŒìŠ¤ ì½”ë“œê°€ ë¡œì»¬ì— ê·¸ëŒ€ë¡œ ì¡´ì¬í•˜ë¯€ë¡œ, AWS í™˜ê²½ì—ì„œë„ ë„¤íŠ¸ì›Œí¬ë¥¼ í†µí•œ Nexus ì ‘ê·¼ ì—†ì´ ë°”ë¡œ ë¹Œë“œ ê°€ëŠ¥. ì¦‰, common ì½”ë“œë¥¼ ë¼ì´ë¸ŒëŸ¬ë¦¬ì²˜ëŸ¼ ì§ì ‘ í¬í•¨ì‹œí‚¤ëŠ” í˜•íƒœê°€ ë˜ëŠ” ê²ƒ main-project/settings.gradle:include(\":app\", \":common\")project(\":common\").projectDir = file(\"common\")ì‹¤ìŠµ submoduleì„ ì°¸ì¡°í•˜ëŠ” repo : repo1 submodule repo : repo2repo2ì—ì„œ ë°˜ì˜í•œ ìµœì‹  ë‚´ì—­ repo1ì—ì„œ ê°€ì ¸ì˜¤ê¸° repo1ì—ì„œëŠ” foo3 í˜¸ì¶œì¤‘ repo2ì—ì„œëŠ” foo4ë¡œ ë©”ì„œë“œëª… ë³€ê²½í•´ì„œ ë°˜ì˜í•œ ìƒíƒœ repo1ì—ì„œ repo2ì˜ ë³€ê²½ì‚¬í•­ ë°˜ì˜í•˜ê¸° 1. git submodule update --remote common2. push repo1ì—ì„œ repo2 ì½”ë“œ ë³€ê²½í•˜ê³  ë°˜ì˜í•˜ê¸°1. ì½”ë“œ ìˆ˜ì •2. cd common3. git add .4. git commit -m \"foo5 ë°˜ì˜\"5. git push origin master ì§€ê¸ˆ ì˜¤ë¥˜ ìƒí™©ì€ submoduleì„ detached HEAD ìƒíƒœì—ì„œ ì‘ì—…í–ˆê¸° ë•Œë¬¸ì— ë°œìƒ HEAD : í˜„ì¬ ì²´í¬ì•„ì›ƒëœ ë¸Œëœì¹˜ ë˜ëŠ” ì»¤ë°‹ì„ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„° detached HEAD : ë¸Œëœì¹˜ê°€ ì•„ë‹Œ íŠ¹ì • ì»¤ë°‹ ìœ„ì—ì„œ ì‘ì—…í•˜ëŠ” ìƒíƒœ Gitì€ í•­ìƒ HEAD â†’ ë¸Œëœì¹˜ â†’ ì»¤ë°‹ ìˆœìœ¼ë¡œ ì—°ê²°ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤. ex : HEAD â†’ master â†’ (a1b2c3) í•˜ì§€ë§Œ íŠ¹ì • ë¸Œëœì¹˜ê°€ ì•„ë‹ˆë¼, íŠ¹ì • ì»¤ë°‹(SHA)ì„ ì§ì ‘ checkoutí•˜ë©´ ì´ë ‡ê²Œ ë¨: HEAD â†’ (a1b2c3) master ê°™ì€ ë¸Œëœì¹˜ì— ì—°ê²°ë˜ì§€ ì•ŠìŒ ì¦‰, HEADê°€ â€œë¶„ë¦¬(detached)â€ëœ ìƒíƒœ. foo5 ë°˜ì˜ ì»¤ë°‹(a33f7410)ì€ ì•„ì§ ì‚¬ë¼ì§€ì§€ ì•Šì•˜ê³ , ë¸Œëœì¹˜ì—ì„œ ì—°ê²°ë˜ì§€ ì•Šì€ â€œë–  ìˆëŠ” ì»¤ë°‹â€ ìƒíƒœë¡œ ë‚¨ì•„ ìˆë‹¤. Gitì—ì„œëŠ” ì´ëŸ° ì»¤ë°‹ì„ dangling commitì´ë¼ê³  í•œë‹¤. git fsck --lost-found : dangling commit í™•ì¸ ì¦‰, a33f7410 ì»¤ë°‹ì€ ë¸Œëœì¹˜(master)ê°€ ì•„ë‹Œ, detached HEADì—ì„œ ë§Œë“  ì»¤ë°‹ì´ì—ˆê¸° ë•Œë¬¸ì— master ë¸Œëœì¹˜ë¡œ ì´ë™í•˜ë©´ì„œ ë¸Œëœì¹˜ íˆìŠ¤í† ë¦¬ì—ì„œ ë³´ì´ì§€ ì•Šê²Œ ëœ ê²ƒ. (dangling commit) dangling commitì„ submodule masterì— ë¶™ì´ê³  ì‹¶ìœ¼ë©´ git checkout master git cherry-pick a33f7410 git push origin master submoduleì´ detached HEAD ë˜ëŠ” ì´ìœ  ì„œë¸Œëª¨ë“ˆì€ í•­ìƒ â€œì»¤ë°‹ SHAâ€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì²´í¬ì•„ì›ƒë¨. ì¦‰, ë¸Œëœì¹˜ë¥¼ checkout í•œ ê²Œ ì•„ë‹ˆë¼ SHAë¥¼ checkout í•¨ â†’ detached HEAD ì—¬ê¸°ì„œ ì‘ì—… í›„ ì»¤ë°‹í•˜ë©´ â€œì„ì‹œ ì»¤ë°‹â€ì´ ë¨ ë‹¤ì‹œ master checkout í•˜ë‹ˆê¹Œ foo5 ì»¤ë°‹ì€ ìƒì–´ë²„ë¦° ê²ƒì²˜ëŸ¼ ë³´ì„ ê·¸ëŸ¬ë‹ˆ push ì‹œë„í•´ë„ ì•ˆ ëë˜ ê²ƒsubmodule ì½”ë“œ ìˆ˜ì •í•  ë•Œ ì˜¬ë°”ë¥¸ ì ˆì°¨1. git submodule update --remote2. cd common3. git switch master # ì´ì œ HEADê°€ ì •ìƒ ë¸Œëœì¹˜ì— ì—°ê²°ë¨: HEAD â†’ master4. ì½”ë“œ ìˆ˜ì •5. git add .6. git commit -m \"message\"7. git push" }, { "title": "AWS - ìƒí’ˆ ì‚´í´ë³´ê¸°", "url": "/posts/aws-intro/", "categories": "ì§€ì‹ ë”í•˜ê¸°, AWS", "tags": "AWS", "date": "2025-11-11 22:25:00 +0900", "snippet": "ê°‘ì‘ìŠ¤ëŸ½ê²Œ AWS ê´€ë ¨ í•™ìŠµì„ í•´ì•¼í•  ì¼ì´ ìƒê²¼ë‹¤.ê°ê°ì˜ ìƒí’ˆì— ëŒ€í•´ í•™ìŠµí•´ë³´ê¸° ì „ì— ì „ë°˜ì ìœ¼ë¡œ ì–´ë–¤ ëŠë‚Œì¸ê±´ì§€ GPTì—ê²Œ ë¬¼ì–´ë³´ì•˜ë‹¤.1. ë„¤íŠ¸ì›Œí¬ ë° ì¸í”„ë¼ ê¸°ë³¸VPC (Virtual Private Cloud) ê³µì‹ë¬¸ì„œ AWS ìƒì—ì„œ ë…¼ë¦¬ì ìœ¼ë¡œ ë¶„ë¦¬ëœ ë„¤íŠ¸ì›Œí¬ ê³µê°„ì„ ë§Œë“œëŠ” ì„œë¹„ìŠ¤. ì„œë¸Œë„·, ë¼ìš°íŒ… í…Œì´ë¸”, ê²Œì´íŠ¸ì›¨ì´ ë“±ì„ ì„¤ì •í•´ì„œ íŠ¸ë˜í”½ íë¦„...", "content": "ê°‘ì‘ìŠ¤ëŸ½ê²Œ AWS ê´€ë ¨ í•™ìŠµì„ í•´ì•¼í•  ì¼ì´ ìƒê²¼ë‹¤.ê°ê°ì˜ ìƒí’ˆì— ëŒ€í•´ í•™ìŠµí•´ë³´ê¸° ì „ì— ì „ë°˜ì ìœ¼ë¡œ ì–´ë–¤ ëŠë‚Œì¸ê±´ì§€ GPTì—ê²Œ ë¬¼ì–´ë³´ì•˜ë‹¤.1. ë„¤íŠ¸ì›Œí¬ ë° ì¸í”„ë¼ ê¸°ë³¸VPC (Virtual Private Cloud) ê³µì‹ë¬¸ì„œ AWS ìƒì—ì„œ ë…¼ë¦¬ì ìœ¼ë¡œ ë¶„ë¦¬ëœ ë„¤íŠ¸ì›Œí¬ ê³µê°„ì„ ë§Œë“œëŠ” ì„œë¹„ìŠ¤. ì„œë¸Œë„·, ë¼ìš°íŒ… í…Œì´ë¸”, ê²Œì´íŠ¸ì›¨ì´ ë“±ì„ ì„¤ì •í•´ì„œ íŠ¸ë˜í”½ íë¦„ê³¼ ë³´ì•ˆì„ ì œì–´í•¨ ì‰½ê²Œ ë§í•´, ë‚´ê°€ ì„¤ê³„í•œ ê°€ìƒ ë°ì´í„°ì„¼í„°Zone (Availability Zone) ê³µì‹ë¬¸ì„œ AWS ë¦¬ì „(ì˜ˆ: ap-northeast-2 = ì„œìš¸)ì— ìˆëŠ” ë¬¼ë¦¬ì ìœ¼ë¡œ ë¶„ë¦¬ëœ ë°ì´í„°ì„¼í„° ë‹¨ìœ„. ì—¬ëŸ¬ AZì— ì„œë²„ë¥¼ ë¶„ì‚° ë°°ì¹˜í•˜ë©´ ì¥ì•  ì‹œì—ë„ ì„œë¹„ìŠ¤ ì§€ì† ê°€ëŠ¥ â†’ ê³ ê°€ìš©ì„± í™•ë³´.2. ì»¨í…Œì´ë„ˆ ë° ë°°í¬ECR (Elastic Container Registry) ê³µì‹ë¬¸ì„œ Docker ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ê³  ECS/EKSì—ì„œ pull í•´ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ì„œë¹„ìŠ¤.ECS (Elastic Container Service) ê³µì‹ë¬¸ì„œ AWS ë„¤ì´í‹°ë¸Œ ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ â€” Docker ì»¨í…Œì´ë„ˆë¥¼ ìë™ ë°°í¬ ë° í™•ì¥.EKS (Elastic Kubernetes Service) ê³µì‹ë¬¸ì„œ ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ AWSì—ì„œ ì™„ì „ê´€ë¦¬í˜•ìœ¼ë¡œ ì œê³µ â€” ë…¸ë“œ ê´€ë¦¬, ì—…ê·¸ë ˆì´ë“œ, ë³´ì•ˆ ìë™ ì²˜ë¦¬.3. ì„œë¹„ìŠ¤ ì—°ê²° ë° íŠ¸ë˜í”½ ì œì–´AWS Cloud Map ê³µì‹ë¬¸ì„œ Consulê³¼ ìœ ì‚¬í•œ AWS ë„¤ì´í‹°ë¸Œ ì„œë¹„ìŠ¤ë¡œ, ì„œë¹„ìŠ¤ ì´ë¦„ ê¸°ë°˜ìœ¼ë¡œ ìë™ DNS ë“±ë¡/ê²€ìƒ‰.Route 53 ê³µì‹ë¬¸ì„œ AWSì˜ DNS ì„œë¹„ìŠ¤ ë„ë©”ì¸ ì´ë¦„ì„ IPë¡œ ë³€í™˜í•˜ê³  íŠ¸ë˜í”½ì„ ë¼ìš°íŒ….ALB (Application Load Balancer) ê³µì‹ë¬¸ì„œ HTTP/HTTPS(7ê³„ì¸µ) ë¶€í•˜ ë¶„ì‚°. ê²½ë¡œ ê¸°ë°˜/í˜¸ìŠ¤íŠ¸ ê¸°ë°˜ ë¼ìš°íŒ… ê°€ëŠ¥.4. ë³´ì•ˆ ë° ë¹„ë°€ ê´€ë¦¬WAF (Web Application Firewall) ê³µì‹ë¬¸ì„œ XSS, SQL Injection ë“± ì›¹ ê³µê²© ì°¨ë‹¨. ALB/CloudFrontì™€ í•¨ê»˜ ì‚¬ìš©.Secrets Manager ê³µì‹ë¬¸ì„œ DB ë¹„ë°€ë²ˆí˜¸, API í‚¤ ë“± ë¯¼ê°í•œ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ì €ì¥í•˜ê³  ê´€ë¦¬.5. ë¡œê·¸ ë° ëª¨ë‹ˆí„°ë§CloudWatch ê³µì‹ë¬¸ì„œ AWS ë¦¬ì†ŒìŠ¤ì˜ ìƒíƒœ ëª¨ë‹ˆí„°ë§, ë¡œê·¸ ìˆ˜ì§‘, ì•ŒëŒ ì„¤ì •, ìë™ ëŒ€ì‘ ê¸°ëŠ¥ì„ ì œê³µ.ELK (ElasticSearch, Logstash, Kibana) ë¡œê·¸ ìˆ˜ì§‘ â†’ ì €ì¥ â†’ ì‹œê°í™”. AWSì—ì„œëŠ” OpenSearch í˜•íƒœë¡œ ì œê³µ.ì •ë¦¬ ì„œë¹„ìŠ¤ í•µì‹¬ ì—­í•  VPC (Virtual Private Cloud) AWS ìƒì—ì„œ ë„¤íŠ¸ì›Œí¬(ì„œë¸Œë„·, ë¼ìš°íŒ…, ê²Œì´íŠ¸ì›¨ì´)ë¥¼ë…¼ë¦¬ì ìœ¼ë¡œ ë¶„ë¦¬ Availability Zone (AZ) í•˜ë‚˜ì˜ ë¦¬ì „ ë‚´ ë¬¼ë¦¬ì ìœ¼ë¡œ ë¶„ë¦¬ëœ ë°ì´í„°ì„¼í„° ECR Docker ì´ë¯¸ì§€ ì €ì¥ì†Œ ECS ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ (AWS ì „ìš©) EKS (MKS) ì™„ì „ê´€ë¦¬í˜• ì¿ ë²„ë„¤í‹°ìŠ¤ í´ëŸ¬ìŠ¤í„° Consul ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬, í—¬ìŠ¤ì²´í¬ AWS Cloud Map AWS ë„¤ì´í‹°ë¸Œ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ Route 53 DNS ë° ë¼ìš°íŒ… ALB HTTP/HTTPS ë¡œë“œ ë°¸ëŸ°ì‹± WAF ì›¹ ê³µê²© ì°¨ë‹¨ Secret Manager ë¯¼ê°ì •ë³´ ì•ˆì „ ì €ì¥/ê´€ë¦¬ CloudWatch ëª¨ë‹ˆí„°ë§Â·ë¡œê·¸Â·ì•ŒëŒÂ·ìë™í™” ELK (OpenSearch) ë¡œê·¸ ìˆ˜ì§‘/ì €ì¥/ì‹œê°í™” " }, { "title": "ì˜¤ëŠ˜ ë“œëŠ” ìƒê° (251109, ì „ì œì¡°ê±´)", "url": "/posts/daily-note-251109/", "categories": "ë„ì ë„ì ", "tags": "", "date": "2025-11-09 00:30:00 +0900", "snippet": "ì½”ë“œê°€ ì˜ë„ëŒ€ë¡œ ë™ì‘í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì „ì œì¡°ê±´ì´ ë§ìœ¼ë©´, í•˜ë‚˜ë¼ë„ ì–´ê¸‹ë‚¬ì„ ë•Œ ì˜ë„í•œ ëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•Šê²Œëœë‹¤.ë˜í•œ ìœ ì§€ë³´ìˆ˜ ì‹œ ì½”ë“œ ìƒì—ì„œ íŒŒì•…í•˜ê¸° ì–´ë ¤ìš´ ìˆ¨ê²¨ì§„ ì „ì œì¡°ê±´ì´ ì¡´ì¬í•œë‹¤ë©´, ì½”ë“œì˜ ë§¥ë½ì„ ì´í•´í•˜ëŠ” ë° ì˜ë¬¸ì´ ìƒê¸°ê³  ìˆ˜ì • ì‹œ ì˜ˆìƒì¹˜ ëª»í•œ ê²°ê³¼ë¥¼ ì´ˆë˜í•  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤ê³  ìƒê°í•œë‹¤.ê·¸ë˜ì„œ ìš”ì¦˜ì€ ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œ: ë¬´ì˜ì‹ì ìœ¼ë¡œ ê¹”ê³  ìˆëŠ” ì „ì œì¡°...", "content": "ì½”ë“œê°€ ì˜ë„ëŒ€ë¡œ ë™ì‘í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì „ì œì¡°ê±´ì´ ë§ìœ¼ë©´, í•˜ë‚˜ë¼ë„ ì–´ê¸‹ë‚¬ì„ ë•Œ ì˜ë„í•œ ëŒ€ë¡œ ë™ì‘í•˜ì§€ ì•Šê²Œëœë‹¤.ë˜í•œ ìœ ì§€ë³´ìˆ˜ ì‹œ ì½”ë“œ ìƒì—ì„œ íŒŒì•…í•˜ê¸° ì–´ë ¤ìš´ ìˆ¨ê²¨ì§„ ì „ì œì¡°ê±´ì´ ì¡´ì¬í•œë‹¤ë©´, ì½”ë“œì˜ ë§¥ë½ì„ ì´í•´í•˜ëŠ” ë° ì˜ë¬¸ì´ ìƒê¸°ê³  ìˆ˜ì • ì‹œ ì˜ˆìƒì¹˜ ëª»í•œ ê²°ê³¼ë¥¼ ì´ˆë˜í•  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤ê³  ìƒê°í•œë‹¤.ê·¸ë˜ì„œ ìš”ì¦˜ì€ ì½”ë“œë¥¼ ì‘ì„±í•  ë•Œ: ë¬´ì˜ì‹ì ìœ¼ë¡œ ê¹”ê³  ìˆëŠ” ì „ì œì¡°ê±´ì´ ë¬´ì—‡ì¸ì§€ ê·¸ ì „ì œì¡°ê±´ì„ ì—†ì•¨ ìˆ˜ ìˆëŠ”ì§€ ë§Œì•½ ì–´ê¸‹ë‚¬ì„ ë•ŒëŠ” ì–´ë–»ê²Œ ì²˜ë¦¬í•  ê²ƒì¸ì§€ ê·¸ë¦¬ê³  ìˆ¨ê²¨ì§„ ì „ì œì¡°ê±´ì´ ìˆë‹¤ë©´ ì´ë¥¼ ì½”ë“œ ìƒì—ì„œ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆëŠ”ì§€ ë³´ì´ì§€ ì•ŠëŠ” ì—°ê²°ê³ ë¦¬ë¥¼ ëŠì„ ìˆ˜ ìˆëŠ”ì§€ì— ëŒ€í•´ ê³ ë¯¼í•˜ê²Œ ë˜ëŠ” ê²ƒ ê°™ë‹¤.ë‚˜ì•„ê°€, ë‚˜ ìì‹ ë„ ì–´ë–¤ ì¼ì„ í•˜ë ¤ë©´ íŠ¹ì •í•œ í™˜ê²½ì´ë‚˜ ì¡°ê±´ì´ ê°–ì¶°ì ¸ì•¼ë§Œ í•˜ëŠ”ê²Œ ì•„ë‹Œ, ìµœì†Œí•œì˜ ì „ì œì¡°ê±´ìœ¼ë¡œë„ ì œ ì—­í• ì„ ë‹¤í•  ìˆ˜ ìˆëŠ” ì‚¬ëŒì´ ë˜ê³  ì‹¶ë‹¤." }, { "title": "Debezium MySQL Connector Snapshot ì•Œì•„ë³´ê¸°", "url": "/posts/debezium-mysql-connector-snapshot/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Infra", "date": "2025-10-31 22:00:00 +0900", "snippet": "Snapshot ì†ŒìŠ¤ DBì˜ í˜„ì¬ ë°ì´í„°ì™€ ìŠ¤í‚¤ë§ˆ êµ¬ì¡°ë¥¼ ìº¡ì²˜í•´, ë³€ê²½ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°ì˜ ê¸°ì¤€ì„ ì„ ë§Œë“œëŠ” ì´ˆê¸° ë™ê¸°í™” ê³¼ì • Debezium MySQL ì»¤ë„¥í„°ê°€ ì‹œì‘ë  ë•Œ, ë°ì´í„°ë² ì´ìŠ¤ì˜ ì¼ê´€ëœ ì´ˆê¸° ìŠ¤ëƒ…ìƒ·(initial consistent snapshot)ì„ ìˆ˜í–‰í•œë‹¤. ì´ ìŠ¤ëƒ…ìƒ·ì€ ì»¤ë„¥í„°ê°€ í˜„ì¬ ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœì˜ ê¸°ì¤€ì„ (baseline)ì„ ì„¤ì •...", "content": "Snapshot ì†ŒìŠ¤ DBì˜ í˜„ì¬ ë°ì´í„°ì™€ ìŠ¤í‚¤ë§ˆ êµ¬ì¡°ë¥¼ ìº¡ì²˜í•´, ë³€ê²½ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°ì˜ ê¸°ì¤€ì„ ì„ ë§Œë“œëŠ” ì´ˆê¸° ë™ê¸°í™” ê³¼ì • Debezium MySQL ì»¤ë„¥í„°ê°€ ì‹œì‘ë  ë•Œ, ë°ì´í„°ë² ì´ìŠ¤ì˜ ì¼ê´€ëœ ì´ˆê¸° ìŠ¤ëƒ…ìƒ·(initial consistent snapshot)ì„ ìˆ˜í–‰í•œë‹¤. ì´ ìŠ¤ëƒ…ìƒ·ì€ ì»¤ë„¥í„°ê°€ í˜„ì¬ ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœì˜ ê¸°ì¤€ì„ (baseline)ì„ ì„¤ì •í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤. Debeziumì€ ìŠ¤ëƒ…ìƒ·ì„ ì‹¤í–‰í•  ë•Œ ì—¬ëŸ¬ ê°€ì§€ ëª¨ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ì–´ë–¤ ëª¨ë“œë¡œ ì‹¤í–‰í• ì§€ëŠ” snapshot.mode ì„¤ì •ì— ì˜í•´ ê²°ì •ëœë‹¤. ì»¤ë„¥í„°ëŠ” ìŠ¤ëƒ…ìƒ·ì„ ìˆ˜í–‰í•  ë•Œ ì—¬ëŸ¬ ë‹¨ê³„ì˜ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©°, ì´ ë‹¨ê³„ë“¤ì€ ìŠ¤ëƒ…ìƒ· ëª¨ë“œì™€ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì ìš© ì¤‘ì¸ í…Œì´ë¸” ì ê¸ˆ ì •ì±…ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê¸€ë¡œë²Œ ì½ê¸° ì ê¸ˆ(global read lock) ë˜ëŠ” í…Œì´ë¸” ë‹¨ìœ„ ì ê¸ˆ(table-level locks)ì„ ì‚¬ìš©í•˜ëŠ” ì´ˆê¸° ìŠ¤ëƒ…ìƒ·ì„ ìˆ˜í–‰í•  ë•Œ, ê°ê¸° ë‹¤ë¥¸ ë‹¨ê³„ë¥¼ ê±°ì¹œë‹¤. ì»¤ë„¥í„°ê°€ ì‹œì‘ë  ë•Œ ? ì†ŒìŠ¤ DBì™€ ì—°ê²°(connection)ì„ ë§ºê³ , Taskë¥¼ ì‹¤í–‰í•˜ê¸° ì‹œì‘í•˜ëŠ” ì‹œì  ìƒí™© ì„¤ëª… ìƒˆ ì»¤ë„¥í„°ë¥¼ ë“±ë¡í•  ë•Œ /connectors POST í˜¸ì¶œ ì‹œ, ì»¤ë„¥í„° Taskê°€ ì²˜ìŒ ì‹œì‘ë¨ ê¸°ì¡´ ì»¤ë„¥í„°ë¥¼ ì¬ì‹œì‘í•  ë•Œ /connectors/{name}/restart ë˜ëŠ” Kafka Connect ìì²´ ì¬ì‹œì‘ ì‹œ ì»¤ë„¥íŠ¸ í´ëŸ¬ìŠ¤í„° ì¬ê¸°ë™ ì‹œ connect workerê°€ ì˜¬ë¼ì˜¤ë©´ì„œ taskê°€ ë‹¤ì‹œ ì‹œì‘ë¨ ì»¤ë„¥í„° ì„¤ì •ë§Œ ì—…ë°ì´íŠ¸í•  ë•Œ íŠ¹ì • config ë³€ê²½ ì‹œ Task ì¬ì‹œì‘ì´ í¬í•¨ë  ê²½ìš°ë§Œ í•´ë‹¹ snapshot.mode ì»¤ë„¥í„°ê°€ ì‹œì‘ë  ë•Œ ìŠ¤ëƒ…ìƒ·ì„ ì‹¤í–‰í• ì§€ ì—¬ë¶€ì™€ ì‹¤í–‰ ê¸°ì¤€ì„ ê²°ì • (Default : initial)always ì»¤ë„¥í„°ê°€ ì‹œì‘ë  ë•Œë§ˆë‹¤ í•­ìƒ ìŠ¤ëƒ…ìƒ·ì„ ìˆ˜í–‰í•œë‹¤. ìŠ¤ëƒ…ìƒ·ì—ëŠ” ìº¡ì²˜ ëŒ€ìƒ í…Œì´ë¸”ì˜ ìŠ¤í‚¤ë§ˆì™€ ë°ì´í„°ê°€ ëª¨ë‘ í¬í•¨ëœë‹¤.initial ì»¤ë„¥í„°ê°€ ì´ì „ì— ì˜¤í”„ì…‹ì„ ê¸°ë¡í•œ ì ì´ ì—†ê±°ë‚˜, ì´ì „ ìŠ¤ëƒ…ìƒ·ì´ ì™„ë£Œë˜ì§€ ëª»í•œ ìƒíƒœë¡œ ì¤‘ë‹¨ë˜ì—ˆì„ ë•Œë§Œ ìŠ¤ëƒ…ìƒ·ì„ ìˆ˜í–‰í•œë‹¤. ìŠ¤ëƒ…ìƒ·ì´ ì™„ë£Œëœ í›„ì—ëŠ” ë°”ì´ë„ˆë¦¬ ë¡œê·¸(binlog)ë¥¼ ì½ì–´ ë³€ê²½ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°ì„ ì‹œì‘í•œë‹¤.initial_only ì´ì „ì— ì˜¤í”„ì…‹ì´ ì—†ì„ ë•Œë§Œ ìŠ¤ëƒ…ìƒ·ì„ ìˆ˜í–‰í•œë‹¤. ìŠ¤ëƒ…ìƒ·ì´ ëë‚œ í›„ì—ëŠ” ì»¤ë„¥í„°ê°€ ì¢…ë£Œë˜ë©°, binlogë¥¼ í†µí•´ ë³€ê²½ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°ì„ í•˜ì§€ ì•ŠëŠ”ë‹¤.no_data í…Œì´ë¸” ë°ì´í„°ëŠ” ìº¡ì²˜í•˜ì§€ ì•Šê³ , ìŠ¤í‚¤ë§ˆ ì •ë³´ë§Œ ìº¡ì²˜í•œë‹¤. ì¦‰, ë°ì´í„°ì˜ ì¼ê´€ëœ ìŠ¤ëƒ…ìƒ·ì€ í•„ìš” ì—†ê³ , ìµœê·¼ì˜ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì‚¬í•­ë§Œ ë°˜ì˜í•˜ê³  ì‹¶ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“œì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ â€œë°ì´í„°ëŠ” ì´ë¯¸ target DBì— ìˆê³ , ìŠ¤í‚¤ë§ˆë§Œ ë§ì¶°ì•¼ í•˜ëŠ” ê²½ìš°â€ì— ìœ ìš© recovery ì†ìƒë˜ê±°ë‚˜ ìœ ì‹¤ëœ ìŠ¤í‚¤ë§ˆ íˆìŠ¤í† ë¦¬ í† í”½ì„ ë³µì›í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì»¤ë„¥í„°ê°€ ì¬ì‹œì‘ë˜ë©´, ì†ŒìŠ¤ í…Œì´ë¸”ì˜ êµ¬ì¡°ë¥¼ ì½ì–´ ìŠ¤í‚¤ë§ˆ íˆìŠ¤í† ë¦¬ í† í”½ì„ ë‹¤ì‹œ ë¹Œë“œí•œë‹¤. ë˜í•œ, ì˜ˆê¸°ì¹˜ ì•Šê²Œ ì»¤ì§„ ìŠ¤í‚¤ë§ˆ íˆìŠ¤í† ë¦¬ í† í”½ì„ ì£¼ê¸°ì ìœ¼ë¡œ ì •ë¦¬(prune) í•  ìˆ˜ë„ ìˆë‹¤. ë‹¨, ì»¤ë„¥í„°ê°€ ì¢…ë£Œëœ ì´í›„ DBì— ìƒˆë¡œìš´ ìŠ¤í‚¤ë§ˆ ë³€ê²½ì´ ì ìš©ëœ ê²½ìš°, ì´ ëª¨ë“œë¥¼ ì‚¬ìš©í•´ì„œëŠ” ì•ˆ ë©ë‹ˆë‹¤. (ìŠ¤í‚¤ë§ˆ ë¶ˆì¼ì¹˜ ìœ„í—˜)never ì»¤ë„¥í„°ê°€ ì‹œì‘ë  ë•Œ ìŠ¤ëƒ…ìƒ·ì„ ìˆ˜í–‰í•˜ì§€ ì•Šê³ , ì¦‰ì‹œ binlog ìŠ¤íŠ¸ë¦¬ë°ì„ ì‹œì‘í•œë‹¤. ì¦‰, ê¸°ì¡´ ë°ì´í„°ëŠ” ë¬´ì‹œí•˜ê³  ì´í›„ ë³€ê²½ë§Œ ì¶”ì í•œë‹¤. ì´ ì˜µì…˜ì€ ì•ìœ¼ë¡œ no_dataë¡œ ëŒ€ì²´ë  ì˜ˆì •ì´ë‹¤. (deprecated ì˜ˆì •)when_needed ì»¤ë„¥í„°ê°€ ì‹œì‘ëœ í›„, ì•„ë˜ ì¡°ê±´ ì¤‘ í•˜ë‚˜ë¼ë„ ì¶©ì¡±ë˜ë©´ ìë™ìœ¼ë¡œ ìŠ¤ëƒ…ìƒ·ì„ ìˆ˜í–‰í•œë‹¤: Kafka í† í”½ì—ì„œ ì´ì „ ì˜¤í”„ì…‹ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ëŠ” ê²½ìš° ì´ì „ì— ì €ì¥ëœ ì˜¤í”„ì…‹(binlog ìœ„ì¹˜ ë˜ëŠ” GTID)ì´ ì„œë²„ì—ì„œ ë” ì´ìƒ ìœ íš¨í•˜ì§€ ì•Šì€ ê²½ìš° (ì˜ˆ: binlogê°€ ì‚­ì œë¨, positionì´ ìœ íš¨í•˜ì§€ ì•ŠìŒ ë“±) ì¦‰, í•„ìš”í•  ë•Œë§Œ ìŠ¤ëƒ…ìƒ·ì„ ë‹¤ì‹œ ìˆ˜í–‰í•˜ëŠ” â€œìê¸° ë³µêµ¬í˜• ëª¨ë“œâ€ì´ë‹¤.configuration_based ì´ ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ë©´, snapshot.mode.configuration.based.* ë¡œ ì‹œì‘í•˜ëŠ” ì»¤ë„¥í„° ì„¤ì • ì†ì„±ì„ í†µí•´ ìŠ¤ëƒ…ìƒ· ë™ì‘ì„ ì„¸ë¶€ì ìœ¼ë¡œ ì§ì ‘ ì œì–´í•  ìˆ˜ ìˆë‹¤. ì¦‰, êµ¬ì„± íŒŒì¼ ê¸°ë°˜ìœ¼ë¡œ ì„¸ë°€í•œ ì¡°ê±´ ì§€ì •ì´ ê°€ëŠ¥í•˜ë‹¤.custom snapshot.mode.custom.name ì†ì„±ì— ì •ì˜ëœ ì‚¬ìš©ì êµ¬í˜„ì²´(io.debezium.spi.snapshot.Snapshotter ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„)ë¥¼ ì´ìš©í•´ ìŠ¤ëƒ…ìƒ·ì„ ìˆ˜í–‰í•œë‹¤. ì¦‰, ì‚¬ìš©ìê°€ ì§ì ‘ êµ¬í˜„í•œ ìŠ¤ëƒ…ìƒ· ë¡œì§ì„ ì‚¬ìš©í•œë‹¤.ê¸€ë¡œë²Œ ì½ê¸° ì ê¸ˆ(global read lock)ì„ ì‚¬ìš©í•˜ëŠ” ì´ˆê¸° ìŠ¤ëƒ…ìƒ·Step1 : ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°Step2 : ìº¡ì²˜í•  í…Œì´ë¸” ê²°ì • ê¸°ë³¸ì ìœ¼ë¡œ ì»¤ë„¥í„°ëŠ” ì‹œìŠ¤í…œ í…Œì´ë¸”ì„ ì œì™¸í•œ ëª¨ë“  í…Œì´ë¸”ì˜ ë°ì´í„°ë¥¼ ìº¡ì²˜í•œë‹¤. ì‹œìŠ¤í…œ í…Œì´ë¸” : MySQL ì„œë²„ì˜ ë™ì‘ ë° ì„¤ì •, ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ ë“±ì„ ìœ„í•œ ë‚´ë¶€ìš© í…Œì´ë¸” ì˜ˆ : information_schema.TABLES, performance_schema.threads, mysql.user ë“± ìŠ¤ëƒ…ìƒ·ì´ ì™„ë£Œëœ í›„, ì»¤ë„¥í„°ëŠ” ì§€ì •ëœ í…Œì´ë¸”ì˜ ë°ì´í„° ë³€ê²½ ì‚¬í•­ì„ ìŠ¤íŠ¸ë¦¬ë°í•œë‹¤. íŠ¹ì • í…Œì´ë¸”ë§Œ ìº¡ì²˜í•˜ê³  ì‹¶ë‹¤ë©´, table.include.list ë˜ëŠ” table.exclude.list ë“±ì˜ ì„¤ì •ì„ ì‚¬ìš©í•œë‹¤.Step3 : ê¸€ë¡œë²Œ ì½ê¸° ì ê¸ˆ íšë“ ìº¡ì²˜í•  í…Œì´ë¸”ì— ëŒ€í•´ ê¸€ë¡œë²Œ ì½ê¸° ì ê¸ˆì„ íšë“í•˜ì—¬ ë‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤ í´ë¼ì´ì–¸íŠ¸ì˜ ì“°ê¸° ì‘ì—…ì„ ì°¨ë‹¨í•œë‹¤. ë‹¨, ìŠ¤ëƒ…ìƒ· ìì²´ëŠ” ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ê°€ DDL ë¬¸ì„ ì‹¤í–‰í•˜ëŠ” ê²ƒì„ ì™„ì „íˆ ë§‰ì§€ëŠ” ëª»í•œë‹¤. ì´ëŸ¬í•œ DDLì€ ì»¤ë„¥í„°ê°€ binlog ìœ„ì¹˜ë‚˜ í…Œì´ë¸” ìŠ¤í‚¤ë§ˆë¥¼ ì½ëŠ” ê³¼ì •ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆë‹¤. ì»¤ë„¥í„°ëŠ” binlog ìœ„ì¹˜ë¥¼ ì½ëŠ” ë™ì•ˆ ì ê¸ˆì„ ìœ ì§€í•œë‹¤. Step4 : íŠ¸ëœì­ì…˜ ì‹œì‘ Repeatable Read ê²©ë¦¬ ìˆ˜ì¤€ìœ¼ë¡œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•˜ì—¬, ì´ íŠ¸ëœì­ì…˜ ë‚´ì˜ ëª¨ë“  ì½ê¸° ì‘ì—…ì´ ì¼ê´€ëœ ìŠ¤ëƒ…ìƒ· ìƒíƒœë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìˆ˜í–‰ë˜ë„ë¡ í•œë‹¤. ë§Œì•½ ìŠ¤ëƒ…ìƒ· ìˆ˜í–‰ ì‹œê°„ì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦°ë‹¤ë©´, ë‹¤ë¥¸ ê²©ë¦¬ ìˆ˜ì¤€ ì„¤ì •ì„ ì‚¬ìš©í•˜ê±°ë‚˜ ì´ˆê¸° ìŠ¤ëƒ…ìƒ·ì„ ê±´ë„ˆë›°ê³  ì¦ë¶„ ìŠ¤ëƒ…ìƒ·(incremental snapshot)ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ê³ ë ¤í•  ìˆ˜ ìˆë‹¤.Step5 : í˜„ì¬ì˜ binlog ìœ„ì¹˜ë¥¼ ì½ìŒ ì´ ìœ„ì¹˜ëŠ” ì´í›„ ë³€ê²½ ë°ì´í„° ìŠ¤íŠ¸ë¦¬ë°ì„ ì‹œì‘í•  ê¸°ì¤€ì ì´ ëœë‹¤.Step6 : ìº¡ì²˜ ëŒ€ìƒ í…Œì´ë¸”ë“¤ì˜ ìŠ¤í‚¤ë§ˆë¥¼ ìº¡ì²˜ ì»¤ë„¥í„°ëŠ” ìŠ¤í‚¤ë§ˆ ì •ë³´ë¥¼ ë‚´ë¶€ì˜ schema history í† í”½ì— ì €ì¥í•˜ë©°, ì´ ì•ˆì—ëŠ” í•„ìš”í•œ ëª¨ë“  DROP, CREATE DDL ë¬¸ë„ í¬í•¨ëœë‹¤. schema historyëŠ” ë³€ê²½ ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì„ ë•Œ ì ìš© ì¤‘ì¸ êµ¬ì¡°ì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ì»¤ë„¥í„°ëŠ” ë°ì´í„° ìº¡ì²˜ ì„¤ì • ì—¬ë¶€ì™€ ìƒê´€ì—†ì´ ëª¨ë“  í…Œì´ë¸”ì˜ ìŠ¤í‚¤ë§ˆë¥¼ ìº¡ì²˜í•œë‹¤. ë‹¨, ìº¡ì²˜ ëŒ€ìƒìœ¼ë¡œ ì§€ì •ë˜ì§€ ì•Šì€ í…Œì´ë¸”ì˜ ê²½ìš°, ë°ì´í„°ëŠ” ìº¡ì²˜í•˜ì§€ ì•Šê³ , êµ¬ì¡°ë§Œ ì €ì¥í•œë‹¤. Step7 : (3ë‹¨ê³„ì—ì„œ íšë“í•œ) ê¸€ë¡œë²Œ ì½ê¸° ì ê¸ˆ í•´ì œ ë‹¤ë¥¸ ë°ì´í„°ë² ì´ìŠ¤ í´ë¼ì´ì–¸íŠ¸ë“¤ì˜ ì“°ê¸° ì‘ì—…ì´ ê°€ëŠ¥í•´ì§„ë‹¤.Step8 : (5ë‹¨ê³„ì—ì„œ ì½ì€) binlog ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ, ì§€ì •ëœ í…Œì´ë¸”ë“¤ì„ ìŠ¤ìº”í•˜ê¸° ì‹œì‘ ì´ ê³¼ì •ì—ì„œ ì»¤ë„¥í„°ëŠ” ë‹¤ìŒ ì‘ì—…ë“¤ì„ ìˆ˜í–‰í•œë‹¤. ìŠ¤ëƒ…ìƒ· ì‹œì‘ ì „ì— ìƒì„±ëœ í…Œì´ë¸”ì¸ì§€ í™•ì¸ ìŠ¤ëƒ…ìƒ·ì´ ì‹œì‘ëœ í›„ ìƒˆë¡œ ìƒì„±ëœ í…Œì´ë¸”ì´ë¼ë©´ í•´ë‹¹ í…Œì´ë¸”ì€ ê±´ë„ˆëœ€ ë‹¤ë§Œ, ìŠ¤ëƒ…ìƒ·ì´ ëë‚˜ê³  ì»¤ë„¥í„°ê°€ ìŠ¤íŠ¸ë¦¬ë° ëª¨ë“œë¡œ ì „í™˜ëœ í›„ì—ëŠ”, ê·¸ ì‹œì  ì´í›„ ìƒì„±ëœ í…Œì´ë¸”ì— ëŒ€í•œ ë³€ê²½ ì´ë²¤íŠ¸ë¥¼ ìƒì„± í…Œì´ë¸”ì˜ ê° í–‰ì— ëŒ€í•´ read ì´ë²¤íŠ¸ë¥¼ ìƒì„± ì´ ì´ë²¤íŠ¸ë“¤ì€ ëª¨ë‘ ë™ì¼í•œ binlog ìœ„ì¹˜ë¥¼ í¬í•¨ ê° read ì´ë²¤íŠ¸ë¥¼ í•´ë‹¹ í…Œì´ë¸”ì— ëŒ€ì‘í•˜ëŠ” Kafka í† í”½ìœ¼ë¡œ ì „ì†¡ í•„ìš”í•˜ë‹¤ë©´, ì‚¬ìš©ëœ ë°ì´í„° í…Œì´ë¸” ì ê¸ˆì„ í•´ì œ ì¦‰, ì´ˆê¸° ìŠ¤ëƒ…ìƒ·ì€ ìº¡ì²˜ ëŒ€ìƒ í…Œì´ë¸”ì˜ ê° í–‰ì˜ í˜„ì¬ ìƒíƒœë¥¼ ì €ì¥í•œë‹¤. ì´ë ‡ê²Œ ìƒì„±ëœ ê¸°ì¤€ ìƒíƒœ(baseline)ë¥¼ ë°”íƒ•ìœ¼ë¡œ, ì»¤ë„¥í„°ëŠ” ì´í›„ ë°œìƒí•˜ëŠ” ëª¨ë“  ë³€ê²½ ì‚¬í•­ì„ ìˆœì°¨ì ìœ¼ë¡œ ìº¡ì²˜í•œë‹¤.Step9 : íŠ¸ëœì­ì…˜ ì»¤ë°‹Step10 : ìŠ¤ëƒ…ìƒ·ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŒì„ ì»¤ë„¥í„°ì˜ ì˜¤í”„ì…‹(offset)ì— ê¸°ë¡ ì´ ì˜¤í”„ì…‹ ì •ë³´ëŠ” ì´í›„ ì¬ì‹œì‘ ì‹œ ì»¤ë„¥í„°ê°€ ì–´ë””ì„œë¶€í„° ë°ì´í„°ë¥¼ ì½ì–´ì•¼ í•˜ëŠ”ì§€ë¥¼ ê²°ì •í•˜ëŠ” ê¸°ì¤€ì´ëœë‹¤.ì •ë¦¬(ì˜ˆì‹œ ìƒí™©) ì‹œê°„ ì•¡ì…˜ ì„¤ëª… 10:00 ê¸€ë¡œë²Œ ì½ê¸° ì ê¸ˆ íšë“ ë° íŠ¸ëœì­ì…˜ ì‹œì‘ consistent snapshot ìƒì„± 10:00 binlog pos = 20000 ê¸°ë¡ baseline ìœ„ì¹˜ ì €ì¥ 10:01 ì ê¸ˆ í•´ì œ ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ë“¤ì´ ë‹¤ì‹œ ì“°ê¸° ê°€ëŠ¥ 10:02 DML ë°œìƒ (UPDATE, INSERT ë“±) binlogì— pos 20001 ì´í›„ë¡œ ê¸°ë¡ë¨ 10:03 ~ 10:05 Debeziumì´ ìŠ¤ëƒ…ìƒ· ë°ì´í„° SELECT ì—¬ì „íˆ 10:00 ì‹œì  ìŠ¤ëƒ…ìƒ· ë·°ë¥¼ ì½ìŒ(Repeatable Read ê²©ë¦¬ ìˆ˜ì¤€ì˜ ì¼ê´€ëœ ì½ê¸°) 10:05 ì´í›„ Debeziumì´ binlog 20000ë¶€í„° ìŠ¤íŠ¸ë¦¬ë° ì‹œì‘ ìŠ¤ëƒ…ìƒ· ì¤‘ ë°œìƒí•œ ë³€ê²½ë¶€í„° ìˆœì„œëŒ€ë¡œ ë°˜ì˜ í…Œì´ë¸” ë‹¨ìœ„ ì ê¸ˆ(table-level lock)ì„ ì‚¬ìš©í•˜ëŠ” ì´ˆê¸° ìŠ¤ëƒ…ìƒ· ì¼ë¶€ ë°ì´í„°ë² ì´ìŠ¤ í™˜ê²½ì—ì„œëŠ” ê¸€ë¡œë²Œ ì½ê¸° ì ê¸ˆì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°ê°€ ìˆë‹¤. ì´ë•Œ Debezium MySQL ì»¤ë„¥í„°ëŠ” ê¸€ë¡œë²Œ ë½ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒì„ ê°ì§€í•˜ë©´, í…Œì´ë¸” ë‹¨ìœ„ ì ê¸ˆì„ ì‚¬ìš©í•˜ì—¬ ìŠ¤ëƒ…ìƒ·ì„ ìˆ˜í–‰í•œë‹¤. ì´ ë°©ì‹ì„ ì‚¬ìš©í•˜ë ¤ë©´, Debezium ì»¤ë„¥í„°ê°€ MySQLì— ì ‘ì†í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ ê³„ì •ì— LOCK TABLES ê¶Œí•œì´ ë°˜ë“œì‹œ ìˆì–´ì•¼ í•œë‹¤. ê¸€ë¡œë²Œ ì½ê¸° ì ê¸ˆë•Œì™€ ë™ì¼í•œ ë‹¨ê³„ëŠ” (ìœ„ì™€ ë™ì¼)ë¡œ í‘œì‹œStep1 : ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²° (ìœ„ì™€ ë™ì¼)Step2 : ìº¡ì²˜í•  í…Œì´ë¸” ê²°ì • (ìœ„ì™€ ë™ì¼)Step3 : í…Œì´ë¸” ë‹¨ìœ„ ì ê¸ˆ íšë“ ìº¡ì²˜ ëŒ€ìƒì´ ë˜ëŠ” ê° í…Œì´ë¸”ì— ëŒ€í•´ í…Œì´ë¸” ë‹¨ìœ„ ì ê¸ˆì„ íšë“í•œë‹¤. ê° í…Œì´ë¸” ë‹¨ìœ„ë¡œ ì½ê¸° ì „ìš© ì ê¸ˆ(READ LOCK)ì„ ì„¤ì •í•˜ì—¬ í•´ë‹¹ í…Œì´ë¸”ì— ì“°ê¸° ì‘ì—…ì´ ì¼ì‹œì ìœ¼ë¡œ ì°¨ë‹¨ëœë‹¤.Step4 : íŠ¸ëœì­ì…˜ ì‹œì‘ (ìœ„ì™€ ë™ì¼)Step5 : í˜„ì¬ì˜ binlog ìœ„ì¹˜ë¥¼ ì½ìŒ (ìœ„ì™€ ë™ì¼)Step6 : ìº¡ì²˜ ëŒ€ìƒ í…Œì´ë¸”ë“¤ì˜ ìŠ¤í‚¤ë§ˆë¥¼ ìº¡ì²˜ (ìœ„ì™€ ë™ì¼)Step7 : ë°ì´í„° ì½ê¸° (Step 5ì—ì„œ ì–»ì€) binlog ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ, ì»¤ë„¥í„°ëŠ” ìº¡ì²˜ ëŒ€ìƒ í…Œì´ë¸”ì„ ìˆœì„œëŒ€ë¡œ ìŠ¤ìº”í•˜ë©° ë°ì´í„°ë¥¼ ì½ìŠµë‹ˆë‹¤. ì´ ê³¼ì •ì—ì„œ ì»¤ë„¥í„°ëŠ” ë‹¤ìŒ ì‘ì—…ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤: ìŠ¤ëƒ…ìƒ·ì´ ì‹œì‘ë˜ê¸° ì „ì— ìƒì„±ëœ í…Œì´ë¸”ì¸ì§€ í™•ì¸ ë§Œì•½ ìŠ¤ëƒ…ìƒ· ë„ì¤‘ì— ìƒˆë¡œ ìƒì„±ëœ í…Œì´ë¸”ì´ë¼ë©´ ì´ ìŠ¤ëƒ…ìƒ·ì—ì„œëŠ” ê±´ë„ˆë›°ê³ , ë‚˜ì¤‘ì— ìŠ¤íŠ¸ë¦¬ë° ëª¨ë“œë¡œ ì „í™˜ë˜ë©´ ê·¸ë•Œë¶€í„° í•´ë‹¹ í…Œì´ë¸”ì˜ ë³€ê²½ ì´ë²¤íŠ¸ë¥¼ ìº¡ì²˜ ê° í…Œì´ë¸”ì˜ ëª¨ë“  í–‰ì„ ì½ì–´ â€œread eventâ€ë¥¼ ìƒì„± ì´ ì´ë²¤íŠ¸ì—ëŠ” Step5ì—ì„œ ì–»ì€ ë™ì¼í•œ binlog ìœ„ì¹˜ê°€ í¬í•¨ë˜ì–´ ìˆì–´, â€œìŠ¤ëƒ…ìƒ· ì „ì²´ê°€ ê°™ì€ ì‹œì ì—ì„œ ì°íŒ ë°ì´í„°ì„â€ì„ ë³´ì¥í•œë‹¤. ì´ë ‡ê²Œ ìƒì„±ëœ ì´ë²¤íŠ¸ë“¤ì„ Kafka í† í”½ìœ¼ë¡œ ì „ì†¡í•œë‹¤. í…Œì´ë¸” ë‹¨ìœ„ ì ê¸ˆì´ ì„¤ì •ë˜ì–´ ìˆì—ˆë‹¤ë©´, í…Œì´ë¸” ë°ì´í„°ë¥¼ ëª¨ë‘ ì½ì€ í›„ ì ê¸ˆì„ í•´ì œí•œë‹¤.Step8 : íŠ¸ëœì­ì…˜ ì»¤ë°‹Step9 : ì ê¸ˆ í•´ì œStep10 : ìŠ¤ëƒ…ìƒ·ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆìŒì„ ì»¤ë„¥í„°ì˜ ì˜¤í”„ì…‹(offset)ì— ê¸°ë¡ (ìœ„ì™€ ë™ì¼)ì •ë¦¬ (ì˜ˆì‹œ ìƒí™©) ì‹œê° ì´ë²¤íŠ¸ ì„¤ëª… 10:00 Debezium ìŠ¤ëƒ…ìƒ· ì‹œì‘ binlog pos = 1000 ê¸°ë¡ 10:00 í…Œì´ë¸” A ìŠ¤ìº” ì‹œì‘ (ë½ ìœ ì§€ ì¤‘) 10:01 ì‚¬ìš©ì UPDATE A (ë¶ˆê°€ â€” ì ê¸ˆ ì¤‘) ë§‰í˜ 10:01 ì‚¬ìš©ì UPDATE B binlog pos = 1001 10:02 í…Œì´ë¸” A ìŠ¤ìº” ì™„ë£Œ â†’ UNLOCK TABLE A Â  10:02 í…Œì´ë¸” B ìŠ¤ìº” ì‹œì‘ (ë½ ìœ ì§€ ì¤‘) 10:03 í…Œì´ë¸” B ìŠ¤ìº” ì™„ë£Œ Â  10:05 Debezium ìŠ¤ëƒ…ìƒ· ì™„ë£Œ Â  10:06 Debezium ìŠ¤íŠ¸ë¦¬ë° ëª¨ë“œ ì „í™˜ (binlog pos=1000ë¶€í„°) Â  - ê¸€ë¡œë²Œ ì½ê¸° ì ê¸ˆ : ì ê¸ˆ í•´ì œ --&gt; ë°ì´í„° ì½ìŒ- í…Œì´ë¸” ë‹¨ìœ„ ì ê¸ˆ : (í…Œì´ë¸”ë³„ë¡œ) ë°ì´í„° ì½ìŒ --&gt; ì ê¸ˆ í•´ì œì°¸ê³  ìë£Œ https://debezium.io/documentation//reference/stable/connectors/mysql.html https://debezium.io/documentation/reference/stable/connectors/mysql.html#mysql-property-snapshot-mode" }, { "title": "Debezium ì•Œì•„ë³´ê¸°", "url": "/posts/debezium-intro/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Infra", "date": "2025-10-29 22:00:00 +0900", "snippet": "Debezium Debeziumì€ CDC(Change Data Capture)ë¥¼ ìœ„í•œ ì˜¤í”ˆ ì†ŒìŠ¤ ë¶„ì‚° í”Œë«í¼ì´ë‹¤. (ê³µì‹ ì‚¬ì´íŠ¸) Kafka Connectì˜ Source Connector í”ŒëŸ¬ê·¸ì¸ ì¤‘ í•˜ë‚˜ (ë‚´ê°€ ì§€ê¸ˆê¹Œì§€ ì´í•´í•œ ì •ë„) Debeziumì€ Kafka Connectì™€ í˜¸í™˜ë˜ëŠ” ì†ŒìŠ¤ ì»¤ë„¥í„°(Source Connector)ë“¤ì„ ì œê³µí•œë‹¤. ...", "content": "Debezium Debeziumì€ CDC(Change Data Capture)ë¥¼ ìœ„í•œ ì˜¤í”ˆ ì†ŒìŠ¤ ë¶„ì‚° í”Œë«í¼ì´ë‹¤. (ê³µì‹ ì‚¬ì´íŠ¸) Kafka Connectì˜ Source Connector í”ŒëŸ¬ê·¸ì¸ ì¤‘ í•˜ë‚˜ (ë‚´ê°€ ì§€ê¸ˆê¹Œì§€ ì´í•´í•œ ì •ë„) Debeziumì€ Kafka Connectì™€ í˜¸í™˜ë˜ëŠ” ì†ŒìŠ¤ ì»¤ë„¥í„°(Source Connector)ë“¤ì„ ì œê³µí•œë‹¤. ê° ì»¤ë„¥í„°ëŠ” íŠ¹ì • DBMSì™€ ì—°ë™ë˜ë©°, DBMSì—ì„œ ë°œìƒí•˜ëŠ” ë°ì´í„° ë³€ê²½ ì‚¬í•­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ê°ì§€í•˜ì—¬ ê·¸ ê¸°ë¡ì„ Kafka í† í”½ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¬ë°í•œë‹¤. ê·¸ í›„, ì• í”Œë¦¬ì¼€ì´ì…˜ì€ Kafka í† í”½ì— ì €ì¥ëœ ì´ë²¤íŠ¸ ë ˆì½”ë“œë“¤ì„ ì½ì–´ì„œ í•´ë‹¹ ë³€ê²½ ë‚´ì—­ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Kafkaë¥¼ í™œìš©í•¨ìœ¼ë¡œì¨, Debeziumì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°œìƒí•œ ë³€ê²½ ì‚¬í•­ì„ ì •í™•í•˜ê³  ì™„ì „í•˜ê²Œ ì†Œë¹„í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ê°‘ì‘ìŠ¤ëŸ½ê²Œ ì¤‘ë‹¨ë˜ê±°ë‚˜ ì—°ê²°ì´ ëŠê¸°ë”ë¼ë„, ê·¸ ê¸°ê°„ ë™ì•ˆ ë°œìƒí•œ ì´ë²¤íŠ¸ë¥¼ ë†“ì¹˜ì§€ ì•ŠëŠ”ë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë‹¤ì‹œ ì‹œì‘ë˜ë©´, ì¤‘ë‹¨ë˜ì—ˆë˜ ì§€ì (topicì˜ offset ìœ„ì¹˜)ë¶€í„° ì´ì–´ì„œ ì´ë²¤íŠ¸ë¥¼ ì½ê¸° ì‹œì‘íŒë‹¤. ì•„í‚¤í…ì²˜ Debeziumì€ ì¼ë°˜ì ìœ¼ë¡œ Kafka Connectë¥¼ í†µí•´ ë°°í¬ëœë‹¤. Kafka ConnectëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‘ì—…ì„ êµ¬í˜„í•˜ê³  ìš´ì˜í•˜ê¸° ìœ„í•œ í”„ë ˆì„ì›Œí¬ì´ì ì‹¤í–‰ í™˜ê²½ì´ë‹¤: Debeziumì²˜ëŸ¼ Kafkaë¡œ ë ˆì½”ë“œë¥¼ ì „ì†¡í•˜ëŠ” ì†ŒìŠ¤ ì»¤ë„¥í„°(Source Connector) Kafka í† í”½ì˜ ë ˆì½”ë“œë¥¼ ë‹¤ë¥¸ ì‹œìŠ¤í…œìœ¼ë¡œ ì „ë‹¬í•˜ëŠ” ì‹±í¬ ì»¤ë„¥í„°(Sink Connector) (ì¶œì²˜ : https://debezium.io/documentation//reference/stable/architecture.html)â€» Debeziumì„ ë°°í¬í•œë‹¤ ? ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ CDCë¥¼ ìˆ˜í–‰í• ì§€ ì •í•œ ë’¤, ê·¸ì— ë§ê²Œ Debeziumì„ êµ¬ì„±í•˜ê³  ì‹¤í–‰ í™˜ê²½ì— ì˜¬ë¦¬ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. (ì°¸ê³ ) ì˜ˆì‹œ: ë°°í¬ ë°©ì‹ ì‹¤ì œë¡œ í•˜ëŠ” ì¼ ì„¤ëª… Kafka Connect ê¸°ë°˜ ë°°í¬ Debezium ì»¤ë„¥í„°ë¥¼ Kafka Connect í´ëŸ¬ìŠ¤í„°ì— ë“±ë¡í•˜ê³  ì‹¤í–‰ ì†ŒìŠ¤ ì»¤ë„¥í„°ë¡œ DBì˜ ë³€ê²½ì‚¬í•­ì„ ì½ì–´ Kafkaì— ë„£ìŒ Debezium Server ë°°í¬ Debezium Server ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ê³  í™˜ê²½ ì„¤ì • ì§€ì •(ì˜ˆ: DB ì—°ê²° ì •ë³´, ë©”ì‹œì§• ëŒ€ìƒ) Kafka ì—†ì´ Kinesis, Pub/Sub ë“±ìœ¼ë¡œ CDC ìŠ¤íŠ¸ë¦¬ë° Debezium Engine ë‚´ì¥í˜• ë°°í¬ Java ì• í”Œë¦¬ì¼€ì´ì…˜ì— Debezium ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í¬í•¨ì‹œì¼œ ì½”ë“œ ë ˆë²¨ì—ì„œ ì‹¤í–‰ ì•± ë‚´ë¶€ì—ì„œ CDC ìˆ˜í–‰ (Kafka Connect ë¶ˆí•„ìš”) # Kafka Connect ê¸°ë°˜ Debezium ë°°í¬ ì˜ˆì‹œdocker run -it --rm \\ -e GROUP_ID=1 \\ -e CONFIG_STORAGE_TOPIC=my_connect_configs \\ -e OFFSET_STORAGE_TOPIC=my_connect_offsets \\ -p 8083:8083 \\ debezium/connect:latest# Debezium Server ì‹¤í–‰ ì˜ˆì‹œjava -jar debezium-server.jar --config application.propertiesMySQL ì»¤ë„¥í„° ë“±ë¡í•˜ê¸° /connector APIë¥¼ í˜¸ì¶œí•´ì„œ ë“±ë¡ (Kafka Connect REST API) (ì°¸ê³  : Debezium, Kafka Connect, MySQL ë²„ì „ í˜¸í™˜ì„± : https://debezium.io/releases/) ë“±ë¡ëœ ì»¤ë„¥í„°ëŠ” MySQL ì„œë²„ì˜ binlogë¥¼ ê°ì‹œí•˜ê¸° ì‹œì‘í•œë‹¤. binlogì—ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ë°œìƒí•œ ëª¨ë“  íŠ¸ëœì­ì…˜ ê¸°ë¡(ê°œë³„ í–‰ì˜ ë³€ê²½ì´ë‚˜ ìŠ¤í‚¤ë§ˆì˜ ë³€ê²½ ë“±)ì´ ì €ì¥ëœë‹¤. ì»¤ë„¥í„°ëŠ” ì´ëŸ¬í•œ ë³€ê²½ì„ ê°ì§€í•˜ì—¬ change event(ë³€ê²½ ì´ë²¤íŠ¸)ë¥¼ ìƒì„±í•œë‹¤. ì•ìœ¼ë¡œì˜ ì˜ˆì‹œì—ì„œëŠ”, Kafkaê°€ ìë™ìœ¼ë¡œ í† í”½ì„ ìƒì„±í•˜ë„ë¡ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©°, ê° í† í”½ì€ ë³µì œë³¸(replica)ì´ 1ê°œë¿ì¸ ë‹¨ìˆœí•œ êµ¬ì„±ì„ ì‚¬ìš©í•œë‹¤ê³  ê°€ì •í•œë‹¤. ìš´ì˜ í™˜ê²½ì—ì„œëŠ” ë³´í†µ ë‘ ê°€ì§€ ë°©ë²• ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•œë‹¤: Kafka ë„êµ¬(Kafka CLI ë“±)ë¥¼ ì´ìš©í•´ í•„ìš”í•œ í† í”½ì„ ìˆ˜ë™ìœ¼ë¡œ ìƒì„±í•˜ê³ , ë³µì œ(replica) ê°œìˆ˜ ê°™ì€ ì„¸ë¶€ ì„¤ì •ì„ ì§ì ‘ ì§€ì • Kafka Connect ì„¤ì •ì„ í†µí•´, ìë™ìœ¼ë¡œ ìƒì„±ë˜ëŠ” í† í”½ì˜ ì„¤ì •ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§• ì˜ˆì‹œ:$ curl -i -X POST -H \"Accept:application/json\" -H \"Content-Type:application/json\" localhost:8083/connectors -d'{ \"name\": \"inventory-connector\", \"config\": { \"connector.class\": \"io.debezium.connector.mysql.MySqlConnector\", \"tasks.max\": \"1\", \"database.hostname\": \"mysql\", \"database.port\": \"3306\", \"database.user\": \"debezium\", \"database.password\": \"dbz\", \"database.server.id\": \"184054\", \"topic.prefix\": \"dbserver1\", \"database.include.list\": \"inventory\", \"schema.history.internal.kafka.bootstrap.servers\": \"kafka:9092\", \"schema.history.internal.kafka.topic\": \"schema-changes.inventory\" }}'(Request Bodyì— ë‹´ê¸´) ì»¤ë„¥í„° ê´€ë ¨ ì†ì„±ê°’ë“¤ì„ ì‚´í´ë³´ì.name ì»¤ë„¥í„°ì˜ ì´ë¦„ ì»¤ë„¥í„° ì¸ìŠ¤í„´ìŠ¤ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ ê³ ìœ í•œ ì´ë¦„ì„ ì§€ì •config ì»¤ë„¥í„°ê°€ ì–´ë–»ê²Œ ë™ì‘í• ì§€ë¥¼ ì •ì˜í•˜ëŠ” ì„¸ë¶€ ì„¤ì • í•­ëª©ë“¤(ì°¸ê³  : MySQL connector configuration properties)tasks.max ì»¤ë„¥í„°ê°€ ìƒì„±í•  ìˆ˜ ìˆëŠ” ìµœëŒ€ íƒœìŠ¤í¬(task)ì˜ ê°œìˆ˜ Kafka Connect ì„œë¹„ìŠ¤ëŠ” ì»¤ë„¥í„°ë¥¼ í†µí•´ í•˜ë‚˜ ì´ìƒì˜ íƒœìŠ¤í¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆìœ¼ë©°, ì‹¤í–‰ ì¤‘ì¸ íƒœìŠ¤í¬ë“¤ì„ Kafka Connect í´ëŸ¬ìŠ¤í„° ë‚´ì˜ ì—¬ëŸ¬ ë…¸ë“œì— ìë™ìœ¼ë¡œ ë¶„ì‚° ë°°ì¹˜í•œë‹¤. ë§Œì•½ ì–´ë–¤ ì„œë¹„ìŠ¤ê°€ ì¤‘ì§€ë˜ê±°ë‚˜ ì¶©ëŒí•˜ë”ë¼ë„, í•´ë‹¹ íƒœìŠ¤í¬ëŠ” ìë™ìœ¼ë¡œ ë‹¤ë¥¸ ì‹¤í–‰ ì¤‘ì¸ ì„œë¹„ìŠ¤ë¡œ ì¬í• ë‹¹ëœë‹¤. ë‹¤ë§Œ, MySQL ì»¤ë„¥í„°ëŠ” í•­ìƒ ë‹¨ì¼ íƒœìŠ¤í¬ë§Œ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì´ ê¸°ë³¸ê°’ì„ ë³€ê²½í•´ë„ ì•„ë¬´ëŸ° íš¨ê³¼ê°€ ì—†ë‹¤.â€» ë‹¨ì¼ íƒœìŠ¤í¬ ì‚¬ìš© ì´ìœ  Debezium MySQL ConnectorëŠ” MySQLì— replication í´ë¼ì´ì–¸íŠ¸(slave)ë¡œ ì—°ê²°í•´ì„œ binlog dump í”„ë¡œí† ì½œ(replication í”„ë¡œí† ì½œì˜ ì¼ë¶€)ì„ í†µí•´ ë³€ê²½ ì´ë²¤íŠ¸ë¥¼ ë°›ëŠ”ë‹¤. ì´ ìŠ¤íŠ¸ë¦¼ì€ í•˜ë‚˜ì˜ ì—°ì†ëœ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ì´ë¯€ë¡œ, ì—¬ëŸ¬ íƒœìŠ¤í¬ê°€ ë‚˜ëˆ ì„œ ë³‘ë ¬ë¡œ ì½ì„ ìˆ˜ ìˆëŠ” êµ¬ì¡°ê°€ ì•„ë‹ˆë‹¤. ë§Œì•½ ì—¬ëŸ¬ íƒœìŠ¤í¬ê°€ binlogë¥¼ ë³‘ë ¬ë¡œ ì½ëŠ”ë‹¤ë©´, ë™ì¼í•œ íŠ¸ëœì­ì…˜ ì´ë²¤íŠ¸ê°€ ì„œë¡œ ë‹¤ë¥¸ íƒœìŠ¤í¬ë¡œ ë¶„ì‚°ë˜ì–´ ìˆœì„œê°€ ê¹¨ì§ˆ ìˆ˜ ìˆë‹¤.database.hostname ë°ì´í„°ë² ì´ìŠ¤ í˜¸ìŠ¤íŠ¸ëª… Dockerë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, MySQL ì„œë²„ë¥¼ ì‹¤í–‰í•˜ëŠ” Docker ì»¨í…Œì´ë„ˆ ì´ë¦„ì´ë‹¤. ë§Œì•½ MySQLì´ ì¼ë°˜ì ì¸ ë„¤íŠ¸ì›Œí¬ í™˜ê²½(ì¦‰, Dockerê°€ ì•„ë‹Œ)ì—ì„œ ì‹¤í–‰ ì¤‘ì´ë¼ë©´, MySQL ì„œë²„ì˜ IP ì£¼ì†Œë‚˜ DNSë¡œ í•´ì„ ê°€ëŠ¥í•œ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ì§€ì •í•´ì•¼ í•œë‹¤.database.server.id Debezium ì»¤ë„¥í„°(MySQL í´ë¼ì´ì–¸íŠ¸)ì˜ ê³ ìœ  ìˆ«ì ID ì§€ì •ëœ IDëŠ” í˜„ì¬ MySQL í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ í”„ë¡œì„¸ìŠ¤ì™€ ì¤‘ë³µë˜ì§€ ì•Šì•„ì•¼í•œë‹¤. ì•ì„œ ì‚´í´ë³¸ë°”ì™€ ê°™ì´, Debezium MySQL ì»¤ë„¥í„°ëŠ” MySQLì˜ replication ê¸°ëŠ¥ì„ ì´ìš©í•´ì„œ binlogë¥¼ ì½ëŠ”ë‹¤. ì¦‰, Debeziumì€ MySQL ì…ì¥ì—ì„œ ë³´ë©´ í•˜ë‚˜ì˜ ë³µì œ ì„œë²„ì²˜ëŸ¼ ë™ì‘í•œë‹¤. MySQL ë³µì œ í™˜ê²½ì—ì„œëŠ” ê° ì„œë²„(ë§ˆìŠ¤í„°, ìŠ¬ë ˆì´ë¸Œ ë“±)ê°€ ì„œë¡œë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•´ server_idë¥¼ ì‚¬ìš©í•œë‹¤. ë”°ë¼ì„œ Debezium ì»¤ë„¥í„°ë„ database.server.id ê°’ì„ í†µí•´ ìì‹ ì„ MySQL í´ëŸ¬ìŠ¤í„° ë‚´ì—ì„œ ê³ ìœ í•˜ê²Œ ì‹ë³„í•´ì•¼ í•œë‹¤. ì´ ê°’ì´ ì¤‘ë³µë˜ë©´ MySQLì´ â€œê°™ì€ IDì˜ í´ë¼ì´ì–¸íŠ¸ê°€ ì´ë¯¸ ì—°ê²°ë˜ì–´ ìˆë‹¤â€ë©° ë³µì œë¥¼ ê±°ë¶€í•œë‹¤.topic.prefix ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ ë˜ëŠ” í´ëŸ¬ìŠ¤í„°ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤(namespace)ë¥¼ ì§€ì •í•˜ëŠ” ë¬¸ìì—´ ì´ ê°’ì€ Kafka í† í”½ ì´ë¦„ì˜ ì ‘ë‘ì‚¬ë¡œ ì‚¬ìš©ë˜ë©°, ì»¤ë„¥í„°ê°€ ìƒì„±í•˜ëŠ” ëª¨ë“  ì´ë²¤íŠ¸ í† í”½ ì´ë¦„ì´ ì´ ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ë‹¤. ë”°ë¼ì„œ ê° ì»¤ë„¥í„°ë§ˆë‹¤ ì´ ê°’ì€ ê³ ìœ í•´ì•¼ í•œë‹¤. ì˜ë¬¸ì, ìˆ«ì, í•˜ì´í”ˆ(-), ì (.), ë°‘ì¤„(_)ë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, topic.prefixê°€ dbserver1ì´ë¼ë©´ dbserver1.inventory.customers, dbserver1.inventory.ordersê³¼ ê°™ì´ í† í”½ì´ ìƒì„±ëœë‹¤. database.include.list ì»¤ë„¥í„°ê°€ ë³€ê²½ ì‚¬í•­ì„ ìº¡ì²˜í•  ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ì„ ì§€ì • (í•„ìˆ˜ ì˜µì…˜ì€ ì•„ë‹˜) ì‰¼í‘œ(,)ë¡œ êµ¬ë¶„ëœ ì •ê·œì‹ ëª©ë¡ìœ¼ë¡œ ì‘ì„±í•œë‹¤. ì»¤ë„¥í„°ëŠ” ì´ ë¦¬ìŠ¤íŠ¸ì— ëª…ì‹œëœ ì´ë¦„ê³¼ ì¼ì¹˜í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ë§Œ ìº¡ì²˜í•˜ë©°, ì—¬ê¸°ì— í¬í•¨ë˜ì§€ ì•Šì€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ ì‚¬í•­ì€ ìº¡ì²˜í•˜ì§€ ì•ŠëŠ”ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ(ì¦‰, ì´ ê°’ì„ ì§€ì •í•˜ì§€ ì•Šì€ ê²½ìš°), ì»¤ë„¥í„°ëŠ” ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ ì‚¬í•­ì„ ìº¡ì²˜í•œë‹¤.schema.history.internal.kafka.bootstrap.servers ì»¤ë„¥í„°ê°€ Kafka í´ëŸ¬ìŠ¤í„°ì— ì´ˆê¸° ì—°ê²°ì„ ë§ºì„ ë•Œ ì‚¬ìš©í•  í˜¸ìŠ¤íŠ¸/í¬íŠ¸ ìŒ ëª©ë¡ ì´ ì—°ê²°ì€ ë‘ ê°€ì§€ ëª©ì ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤: ì»¤ë„¥í„°ê°€ ì´ì „ì— Kafkaì— ì €ì¥í•œ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì´ë ¥ì„ ê°€ì ¸ì˜¬ ë•Œ ì†ŒìŠ¤ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì½ì–´ë“¤ì¸ DDLë¬¸ì„ Kafkaì— ê¸°ë¡í•  ë•Œ ë”°ë¼ì„œ ì´ ì„¤ì •ì€ ë°ì´í„° ë³€ê²½ ì´ë²¤íŠ¸ìš© Kafka ì—°ê²°ê³¼ëŠ” ë³„ê°œë¡œ, ìŠ¤í‚¤ë§ˆ ì´ë ¥ ê´€ë¦¬ìš© Kafka ì—°ê²°ì„ ì •ì˜í•˜ëŠ” ê²ƒì´ë‹¤.schema.history.internal.kafka.topic ì»¤ë„¥í„°ê°€ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì´ë ¥ì„ ì €ì¥í•˜ëŠ” Kafka í† í”½ì˜ ì „ì²´ ì´ë¦„ì„ ì§€ì • Debeziumì€ ë‹¨ìˆœíˆ ë°ì´í„°ì˜ ë³€ê²½ë§Œ ìº¡ì²˜í•˜ì§€ ì•Šê³ , í…Œì´ë¸” êµ¬ì¡°ë„ í•¨ê»˜ ì¶”ì í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ALTER TABLE customers ADD COLUMN phone VARCHAR(20); ì´ë•Œ Debeziumì€ ë‹¨ìˆœíˆ customers í…Œì´ë¸”ì˜ ë°ì´í„°ë§Œ ë°”ë€Œì—ˆë‹¤ê³  ì•Œë¦¬ëŠ” ê²Œ ì•„ë‹ˆë¼, â€œì´ ì‹œì ì— í…Œì´ë¸” êµ¬ì¡°ê°€ ì´ë ‡ê²Œ ë°”ë€Œì—ˆìŒâ€ ì´ë¼ëŠ” ìŠ¤í‚¤ë§ˆ ë³€ê²½ ì´ë ¥ì„ ë³„ë„ì˜ í† í”½ì— ê¸°ë¡í•´ ë‘”ë‹¤. ì´ë ‡ê²Œ í•´ì•¼ Debeziumì´ ì¬ì‹œì‘ë˜ê±°ë‚˜ ì¥ì•  ë³µêµ¬ í›„ì—ë„ ì •í™•í•œ ìŠ¤í‚¤ë§ˆ ì •ë³´ë¡œ binlogë¥¼ ë‹¤ì‹œ í•´ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì—­í•  ì„¤ëª… DDL ê¸°ë¡ í…Œì´ë¸” ìƒì„±, ì‚­ì œ, ì»¬ëŸ¼ ì¶”ê°€/ë³€ê²½ ë“±ì˜ DDL ë¬¸ì„ ì €ì¥ ìŠ¤í‚¤ë§ˆ ë³µì› ì»¤ë„¥í„°ê°€ ì¬ì‹œì‘ë˜ë©´, ì´ í† í”½ì—ì„œ ê³¼ê±° ìŠ¤í‚¤ë§ˆë¥¼ ë¶ˆëŸ¬ì™€ ì¬êµ¬ì„± ì´ë²¤íŠ¸ í•´ì„ ê¸°ì¤€ binlogì˜ ê° ì´ë²¤íŠ¸ë¥¼ ë‹¹ì‹œì˜ í…Œì´ë¸” êµ¬ì¡°ì— ë§ê²Œ í•´ì„í•˜ê¸° ìœ„í•¨ ë‚´ë¶€ ê´€ë¦¬ìš© ì´ í† í”½ì€ ë³´í†µ ë‚´ë¶€ ê´€ë¦¬ìš©ì´ë¯€ë¡œ ì™¸ë¶€ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ êµ¬ë…í•˜ì§€ ì•ŠìŒ Debeziumì€ ë‚´ë¶€ì ìœ¼ë¡œ ì´ëŸ° íë¦„ì„ ê°€ì§„ë‹¤:MySQL binlogâ†“Debezium Connectorâ”œâ”€ DDL ê°ì§€ (ìŠ¤í‚¤ë§ˆ ë³€ê²½)â”œâ”€ DML ê°ì§€ (ë°ì´í„° ë³€ê²½)â†“Kafkaâ”œâ”€ schema-changes.inventory â† ìŠ¤í‚¤ë§ˆ ì´ë ¥ ì €ì¥â””â”€ dbserver1.inventory.customers â† ë°ì´í„° ë³€ê²½ ì´ë²¤íŠ¸ ì €ì¥ë³€ê²½ ì´ë²¤íŠ¸ ì‚´í´ë³´ê¸° dbserver1.inventory.customers í† í”½ ê°€ì • ê° ì´ë²¤íŠ¸ëŠ” ë‘ ê°œì˜ JSON ë°ì´í„°ë¡œ êµ¬ì„±ëœë‹¤: Key : í•´ë‹¹ í–‰ì˜ ê¸°ë³¸ í‚¤ ì •ë³´ Value : ì‹¤ì œ ë°ì´í„° ë³€ê²½ ë‚´ìš© JSON ë°ì´í„°ëŠ” ë‘ ë¶€ë¶„ìœ¼ë¡œ êµ¬ì„±ëœë‹¤: schema : payloadì˜ êµ¬ì¡°ë¥¼ ì„¤ëª…í•˜ëŠ” Kafka Connect ìŠ¤í‚¤ë§ˆ ì •ì˜ payload : ì‹¤ì œ ë°ì´í„° ê°’ Create Event Key{ \"schema\": { \"type\": \"struct\", \"fields\": [ { \"type\": \"int32\", \"optional\": false, \"field\": \"id\" } ], \"optional\": false, \"name\": \"dbserver1.inventory.customers.Key\" }, \"payload\": { \"id\": 1004 }} Value{ \"schema\": { \"type\": \"struct\", \"fields\": [ { \"type\": \"struct\", \"fields\": [ { \"type\": \"int32\", \"optional\": false, \"field\": \"id\" }, { \"type\": \"string\", \"optional\": false, \"field\": \"first_name\" }, { \"type\": \"string\", \"optional\": false, \"field\": \"last_name\" }, { \"type\": \"string\", \"optional\": false, \"field\": \"email\" } ], \"optional\": true, \"name\": \"dbserver1.inventory.customers.Value\", \"field\": \"before\" }, { \"type\": \"struct\", \"fields\": [ { \"type\": \"int32\", \"optional\": false, \"field\": \"id\" }, { \"type\": \"string\", \"optional\": false, \"field\": \"first_name\" }, { \"type\": \"string\", \"optional\": false, \"field\": \"last_name\" }, { \"type\": \"string\", \"optional\": false, \"field\": \"email\" } ], \"optional\": true, \"name\": \"dbserver1.inventory.customers.Value\", \"field\": \"after\" }, { \"type\": \"struct\", \"fields\": [ { \"type\": \"string\", \"optional\": true, \"field\": \"version\" }, { \"type\": \"string\", \"optional\": false, \"field\": \"name\" }, { \"type\": \"int64\", \"optional\": false, \"field\": \"server_id\" }, { \"type\": \"int64\", \"optional\": false, \"field\": \"ts_sec\" }, { \"type\": \"string\", \"optional\": true, \"field\": \"gtid\" }, { \"type\": \"string\", \"optional\": false, \"field\": \"file\" }, { \"type\": \"int64\", \"optional\": false, \"field\": \"pos\" }, { \"type\": \"int32\", \"optional\": false, \"field\": \"row\" }, { \"type\": \"boolean\", \"optional\": true, \"field\": \"snapshot\" }, { \"type\": \"int64\", \"optional\": true, \"field\": \"thread\" }, { \"type\": \"string\", \"optional\": true, \"field\": \"db\" }, { \"type\": \"string\", \"optional\": true, \"field\": \"table\" } ], \"optional\": false, \"name\": \"io.debezium.connector.mysql.Source\", \"field\": \"source\" }, { \"type\": \"string\", \"optional\": false, \"field\": \"op\" }, { \"type\": \"int64\", \"optional\": true, \"field\": \"ts_ms\" }, { \"type\": \"int64\", \"optional\": true, \"field\": \"ts_us\" }, { \"type\": \"int64\", \"optional\": true, \"field\": \"ts_ns\" } ], \"optional\": false, \"name\": \"dbserver1.inventory.customers.Envelope\", \"version\": 1 }, \"payload\": { \"before\": null, \"after\": { \"id\": 1004, \"first_name\": \"Anne\", \"last_name\": \"Kretchmar\", \"email\": \"annek@noanswer.org\" }, \"source\": { \"version\": \"3.3.1.Final\", \"name\": \"dbserver1\", \"server_id\": 0, \"ts_sec\": 0, \"gtid\": null, \"file\": \"mysql-bin.000003\", \"pos\": 154, \"row\": 0, \"snapshot\": true, \"thread\": null, \"db\": \"inventory\", \"table\": \"customers\" }, \"op\": \"r\", \"ts_ms\": 1486500577691, \"ts_us\": 1486500577691547, \"ts_ns\": 1486500577691547930 }} ì´ ìŠ¤í‚¤ë§ˆëŠ” dbserver1.inventory.customers.Envelope (version 1)ë¼ëŠ” ì´ë¦„ì˜ Kafka Connect ìŠ¤í‚¤ë§ˆë¥¼ í¬í•¨í•˜ë©°, ë‹¤ì„¯ ê°€ì§€ í•„ë“œë¥¼ ê°€ì§„ë‹¤: op : ì´ë²¤íŠ¸ê°€ ì–´ë–¤ ì‘ì—…(operation) ì¸ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ìì—´ ê°’ (í•„ìˆ˜ í•„ë“œ) c - create (INSERT) u - update d - delete r - read (ìŠ¤ëƒ…ìƒ· ì‹œ ê¸°ì¡´ ë°ì´í„° ì½ì„ ë•Œ) before : ì„ íƒì (optional) í•„ë“œì´ë©°, ì¡´ì¬í•  ê²½ìš°, ì´ë²¤íŠ¸ ë°œìƒ ì´ì „ì˜ í–‰(row) ìƒíƒœë¥¼ í¬í•¨ after : ì„ íƒì  í•„ë“œì´ë©°, ì¡´ì¬í•  ê²½ìš°, ì´ë²¤íŠ¸ ë°œìƒ ì´í›„ì˜ í–‰(row) ìƒíƒœë¥¼ í¬í•¨ source : í•„ìˆ˜ í•„ë“œì´ë©°, ì´ë²¤íŠ¸ì˜ ì¶œì²˜(source) ë©”íƒ€ë°ì´í„°ë¥¼ ë‹´ê³  ìˆëŠ” êµ¬ì¡°ì²´ MySQL ì»¤ë„¥í„°ì˜ ê²½ìš°, source ì•ˆì—ëŠ” ë‹¤ìŒ ì •ë³´ë“¤ì´ í¬í•¨ëœë‹¤: ì»¤ë„¥í„° ì´ë¦„ (dbserver1 ë“±) ì´ë²¤íŠ¸ê°€ ê¸°ë¡ëœ binlog íŒŒì¼ ì´ë¦„ í•´ë‹¹ ì´ë²¤íŠ¸ê°€ binlog ë‚´ì—ì„œ ë‚˜íƒ€ë‚œ ìœ„ì¹˜(position) (í•œ binlog ì´ë²¤íŠ¸ì— ì—¬ëŸ¬ í–‰ì´ ìˆëŠ” ê²½ìš°) í–‰ì˜ ì¸ë±ìŠ¤ ì˜í–¥ì„ ë°›ì€ ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ ë° í…Œì´ë¸” ì´ë¦„ ë³€ê²½ì„ ìˆ˜í–‰í•œ MySQL ìŠ¤ë ˆë“œ ID ì´ ì´ë²¤íŠ¸ê°€ ìŠ¤ëƒ…ìƒ· ì¤‘ ë°œìƒí•œ ê²ƒì¸ì§€ ì—¬ë¶€ (ê°€ëŠ¥í•œ ê²½ìš°) MySQL ì„œë²„ ID ì´ë²¤íŠ¸ê°€ ê¸°ë¡ëœ íƒ€ì„ìŠ¤íƒ¬í”„ (ì´ˆ ë‹¨ìœ„) ts_ms : ì„ íƒì  í•„ë“œì´ë©°, ì¡´ì¬í•  ê²½ìš° ì´ ê°’ì€ ì»¤ë„¥í„°ê°€ ì´ë²¤íŠ¸ë¥¼ ì²˜ë¦¬í•œ ì‹œê°(ë°€ë¦¬ì´ˆ ë‹¨ìœ„)ì„ í¬í•¨. ì´ ì‹œê°„ì€ Kafka Connect ì‘ì—…ì´ ì‹¤í–‰ ì¤‘ì¸ JVMì˜ ì‹œìŠ¤í…œ ì‹œê³„ ê¸°ì¤€ â€» Avro ê³ ë ¤í•˜ê¸° AvroëŠ” ë°ì´í„°ë¥¼ ì»´í“¨í„°ê°€ ì´í•´í•˜ê³  ì €ì¥/ì „ì†¡í•˜ê¸° ì‰¬ìš´ ì´ì§„ í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” â€˜ë°ì´í„° ì§ë ¬í™” ì‹œìŠ¤í…œâ€™ì´ë‹¤. JSONê³¼ ë‹¬ë¦¬ ìŠ¤í‚¤ë§ˆ ì§„í™”(Schema Evolution)ë¥¼ ì§€ì›í•˜ì—¬ ë°ì´í„° êµ¬ì¡° ë³€ê²½ì„ ìœ ì—°í•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆì–´ ë¹…ë°ì´í„° ì‹œìŠ¤í…œì—ì„œ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤. Kafka Connectì˜ JSON ë³€í™˜ê¸°ëŠ” ëª¨ë“  ë©”ì‹œì§€ë§ˆë‹¤ keyì™€ valueì˜ ìŠ¤í‚¤ë§ˆ ì •ì˜ë¥¼ í•¨ê»˜ í¬í•¨í•˜ê¸° ë•Œë¬¸ì—, ì´ë²¤íŠ¸ ë©”ì‹œì§€ê°€ ë§¤ìš° ì¥í™©í•´ì§„ë‹¤. ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ Apache Avro í¬ë§·ì„ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤. ì¦‰, Kafka Connect ìŠ¤í‚¤ë§ˆë¥¼ Avro ìŠ¤í‚¤ë§ˆë¡œ ë³€í™˜í•˜ê³ , ì´ ìŠ¤í‚¤ë§ˆëŠ” ë³„ë„ì˜ Schema Registry ì„œë¹„ìŠ¤ì— ì €ì¥ë˜ë©°, ì‹¤ì œ ë©”ì‹œì§€ì—ëŠ” ìŠ¤í‚¤ë§ˆ ì „ì²´ê°€ ì•„ë‹ˆë¼ ê³ ìœ í•œ ìŠ¤í‚¤ë§ˆ ID ì™€ Avro ì¸ì½”ë”©ëœ ë°”ì´ë„ˆë¦¬ ë°ì´í„°ë§Œ í¬í•¨ëœë‹¤. ì´ ë°©ì‹ ë•ë¶„ì—, ë„¤íŠ¸ì›Œí¬ë¡œ ì „ì†¡ë˜ê±°ë‚˜ Kafkaì— ì €ì¥ë˜ëŠ” ë©”ì‹œì§€ í¬ê¸°ê°€ JSON í¬ë§·ì— ë¹„í•´ í›¨ì”¬ ì‘ì•„ì§„ë‹¤. ë˜í•œ Avro ConverterëŠ” ìŠ¤í‚¤ë§ˆ ì§„í™”(schema evolution) ê¸°ëŠ¥ì„ ì§€ì›í•˜ë¯€ë¡œ, Schema Registryì— ê° ìŠ¤í‚¤ë§ˆ ë²„ì „ì˜ ë³€ê²½ ì´ë ¥ì„ ê´€ë¦¬í•  ìˆ˜ë„ ìˆë‹¤.Update Event UPDATE customers SET first_name=â€™Anne Marieâ€™ WHERE id=1004; Key : ì „ê³¼ ë™ì¼ Value{ \"schema\": {...}, \"payload\": { \"before\": { \"id\": 1004, \"first_name\": \"Anne\", \"last_name\": \"Kretchmar\", \"email\": \"annek@noanswer.org\" }, \"after\": { \"id\": 1004, \"first_name\": \"Anne Marie\", \"last_name\": \"Kretchmar\", \"email\": \"annek@noanswer.org\" }, \"source\": { \"name\": \"3.3.1.Final\", \"name\": \"dbserver1\", \"server_id\": 223344, \"ts_sec\": 1486501486, \"gtid\": null, \"file\": \"mysql-bin.000003\", \"pos\": 364, \"row\": 0, \"snapshot\": null, \"thread\": 3, \"db\": \"inventory\", \"table\": \"customers\" }, \"op\": \"u\", \"ts_ms\": 1486501486308, \"ts_us\": 1486501486308910, \"ts_ns\": 1486501486308910814 }}Primary Key Update ê¸°ë³¸ í‚¤ í•„ë“œê°€ ë³€ê²½ë˜ëŠ” ê²½ìš°ì—ëŠ” ì¼ë°˜ì ì¸ UPDATE ì´ë²¤íŠ¸ ëŒ€ì‹ , ì»¤ë„¥í„°ê°€ ë‹¤ìŒê³¼ ê°™ì€ ë‘ ê°œì˜ ì´ë²¤íŠ¸ë¥¼ ìƒì„±í•œë‹¤: ê¸°ì¡´ í‚¤ì— ëŒ€í•œ DELETE ì´ë²¤íŠ¸ ë ˆì½”ë“œ ìƒˆ(ë³€ê²½ëœ) í‚¤ì— ëŒ€í•œ CREATE ì´ë²¤íŠ¸ ë ˆì½”ë“œ ë‘ ì´ë²¤íŠ¸ëŠ” ì¼ë°˜ì ì¸ ì´ë²¤íŠ¸ êµ¬ì¡°ì™€ ë‚´ìš©ì„ ê°€ì§€ì§€ë§Œ, ê¸°ë³¸ í‚¤ ë³€ê²½ê³¼ ê´€ë ¨ëœ íŠ¹ìˆ˜í•œ ë©”ì‹œì§€ í—¤ë”ê°€ ì¶”ê°€ë¡œ í¬í•¨ëœë‹¤. DELETE ì´ë²¤íŠ¸ ë ˆì½”ë“œì—ëŠ” __debezium.newkeyë¼ëŠ” ë©”ì‹œì§€ í—¤ë”ê°€ í¬í•¨ëœë‹¤. ì´ í—¤ë”ì˜ ê°’ì€ ë³€ê²½ëœ í–‰ì˜ ìƒˆë¡œìš´ primary keyê°’ ì¦‰, \"ì´ í–‰ì´ ì‚­ì œë˜ì—ˆì§€ë§Œ, ì‚¬ì‹¤ì€ ìƒˆ í‚¤ë¡œ ë‹¤ì‹œ ìƒì„±ë  ê²ƒì´ë‹¤\"ë¼ëŠ” ì˜ë¯¸ë¥¼ ë‹´ê³  ìˆë‹¤. CREATE ì´ë²¤íŠ¸ ë ˆì½”ë“œì—ëŠ” __debezium.oldkeyë¼ëŠ” ë©”ì‹œì§€ í—¤ë”ê°€ í¬í•¨ëœë‹¤. ì´ í—¤ë”ì˜ ê°’ì€ ì—…ë°ì´íŠ¸ ì´ì „ì˜(ì˜ˆì „) ê¸°ë³¸ í‚¤ ê°’ ì¦‰, \"ì´ ìƒˆ í–‰ì€ ì´ì „ì— ì´ í‚¤ë¥¼ ê°€ì§„ í–‰ìœ¼ë¡œë¶€í„° ì˜¨ ê²ƒì´ë‹¤\"ë¼ëŠ” ì •ë³´ë¥¼ ë‹´ê³  ìˆë‹¤. Delete Event DELETE FROM customers WHERE id=1004; í…Œì´ë¸”ì—ì„œ í•œ í–‰(row)ì„ ì‚­ì œí•˜ë©´, Debezium MySQL ì»¤ë„¥í„°ëŠ” ë‘ ê°œì˜ ì´ë²¤íŠ¸ë¥¼ Kafkaë¡œ ë³´ë‚¸ë‹¤.ì²«ë²ˆì§¸ ì´ë²¤íŠ¸ Key ì˜ì—­ : ì „ê³¼ ë™ì¼ Value ì˜ì—­{ \"schema\": {...}, \"payload\": { \"before\": { \"id\": 1004, \"first_name\": \"Anne Marie\", \"last_name\": \"Kretchmar\", \"email\": \"annek@noanswer.org\" }, \"after\": null, \"source\": { \"name\": \"3.3.1.Final\", \"name\": \"dbserver1\", \"server_id\": 223344, \"ts_sec\": 1486501558, \"gtid\": null, \"file\": \"mysql-bin.000003\", \"pos\": 725, \"row\": 0, \"snapshot\": null, \"thread\": 3, \"db\": \"inventory\", \"table\": \"customers\" }, \"op\": \"d\", \"ts_ms\": 1486501558315, \"ts_us\": 1486501558315901, \"ts_ns\": 1486501558315901687 }}ë‘ë²ˆì§¸ ì´ë²¤íŠ¸ tombstone event : keyëŠ” ë™ì¼í•˜ì§€ë§Œ, valueê°€ ì™„ì „íˆ nullì¸ ì´ë²¤íŠ¸ Key : ì „ê³¼ ë™ì¼ Value{ \"schema\": null, \"payload\": null} KafkaëŠ” log compactionì´ë¼ëŠ” ê¸°ëŠ¥ì„ ê°€ì§€ê³  ìˆë‹¤. ì´ëŠ” í† í”½ ë‚´ ë©”ì‹œì§€ë¥¼ key ê¸°ì¤€ìœ¼ë¡œ ì••ì¶•í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. ê° keyì— ëŒ€í•´ ê°€ì¥ ìµœì‹  ë©”ì‹œì§€ë§Œ ë‚¨ê¸°ê³ , ì´ì „ ë©”ì‹œì§€ë“¤ì€ ì‚­ì œí•  ìˆ˜ ìˆë‹¤. ì‚­ì œ(delete)ë¼ëŠ” ê°œë…ì„ í‘œí˜„í•˜ê¸° ìœ„í•´, KafkaëŠ” keyëŠ” ìˆê³  valueëŠ” nullì¸ tombstone eventë¥¼ ì‚¬ìš©í•œë‹¤. KafkaëŠ” ì´ë¥¼ ë³´ê³  â€œì´ keyì— ëŒ€í•œ ë°ì´í„°ëŠ” ì‚­ì œëœ ìƒíƒœë‹¤â€ë¼ê³  ì¸ì‹í•˜ê³ , í•´ë‹¹ keyì˜ ì´ì „ ëª¨ë“  ë©”ì‹œì§€ë¥¼ ì§€ìš´ë‹¤. ì¦‰ì‹œ ì‚­ì œë¥¼ ìˆ˜í–‰í•˜ì§€ëŠ” ì•Šê³ , Kafkaì˜ log cleaner ìŠ¤ë ˆë“œê°€ ì£¼ê¸°ì ìœ¼ë¡œ compactionì„ ìˆ˜í–‰í•  ë•Œ ì²˜ë¦¬ëœë‹¤. ì¦‰, compactionì´ ì‹¤í–‰ë˜ê¸° ì „ê¹Œì§€ëŠ” tombstoneê³¼ ì´ì „ ë©”ì‹œì§€ ëª¨ë‘ ë¡œê·¸ì— ë‚¨ì•„ ìˆì„ ìˆ˜ ìˆë‹¤. ì°¸ê³  ìë£Œ https://debezium.io/documentation//reference/stable/architecture.html https://debezium.io/documentation//reference/stable/tutorial.html https://debezium.io/documentation//reference/stable/connectors/mysql.html" }, { "title": "Kafka Connect ì•Œì•„ë³´ê¸°", "url": "/posts/kafka-connect-intro/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Infra", "date": "2025-10-27 22:50:00 +0900", "snippet": "Kafka Connect Apache Kafkaì™€ ë‹¤ë¥¸ ë°ì´í„° ì‹œìŠ¤í…œ ê°„ì—, ë°ì´í„°ë¥¼ í™•ì¥ ê°€ëŠ¥í•˜ê³  ì•ˆì •ì ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¬ë°í•˜ê¸° ìœ„í•œ ë„êµ¬ ëŒ€ê·œëª¨ ë°ì´í„°ë¥¼ Kafkaë¡œ ê°€ì ¸ì˜¤ê±°ë‚˜ Kafkaì—ì„œ ë‚´ë³´ë‚´ëŠ” ì»¤ë„¥í„°ë¥¼ ë¹ ë¥´ê³  ê°„ë‹¨í•˜ê²Œ ì •ì˜í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. ì „ì²´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜, ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ ì „ë°˜ì—ì„œ ìˆ˜ì§‘í•œ ë©”íŠ¸ë¦­(metrics)ì„ Kafka...", "content": "Kafka Connect Apache Kafkaì™€ ë‹¤ë¥¸ ë°ì´í„° ì‹œìŠ¤í…œ ê°„ì—, ë°ì´í„°ë¥¼ í™•ì¥ ê°€ëŠ¥í•˜ê³  ì•ˆì •ì ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¬ë°í•˜ê¸° ìœ„í•œ ë„êµ¬ ëŒ€ê·œëª¨ ë°ì´í„°ë¥¼ Kafkaë¡œ ê°€ì ¸ì˜¤ê±°ë‚˜ Kafkaì—ì„œ ë‚´ë³´ë‚´ëŠ” ì»¤ë„¥í„°ë¥¼ ë¹ ë¥´ê³  ê°„ë‹¨í•˜ê²Œ ì •ì˜í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. ì „ì²´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜, ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ ì „ë°˜ì—ì„œ ìˆ˜ì§‘í•œ ë©”íŠ¸ë¦­(metrics)ì„ Kafka í† í”½ìœ¼ë¡œ ì „ì†¡í•˜ì—¬ ë‚®ì€ ì§€ì—°(latency)ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ì— í™œìš©í•  ìˆ˜ ìˆë‹¤. ë‚´ë³´ë‚´ê¸° ì‘ì—…(export job)ì„ í†µí•´ Kafka í† í”½ì˜ ë°ì´í„°ë¥¼ ë³´ì¡° ìŠ¤í† ë¦¬ì§€ë‚˜ ì¡°íšŒ ì‹œìŠ¤í…œ, ë˜ëŠ” ë°°ì¹˜(batch) ì‹œìŠ¤í…œìœ¼ë¡œ ì „ë‹¬í•˜ì—¬ ì˜¤í”„ë¼ì¸ ë¶„ì„ì— ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤.ì£¼ìš” íŠ¹ì§•1. Kafka ì»¤ë„¥í„°ë¥¼ ìœ„í•œ ê³µí†µ í”„ë ˆì„ì›Œí¬ Kafka ConnectëŠ” ì™¸ë¶€ ë°ì´í„° ì‹œìŠ¤í…œê³¼ Kafka ê°„ì˜ í†µí•©ì„ í‘œì¤€í™”í•˜ì—¬, ì»¤ë„¥í„°ì˜ ê°œë°œÂ·ë°°í¬Â·ê´€ë¦¬ë¥¼ ë‹¨ìˆœí™”í•œë‹¤.2. ë¶„ì‚°(distributed) ëª¨ë“œì™€ ë‹¨ì¼(standalone) ëª¨ë“œ ì§€ì› ëŒ€ê·œëª¨ ì¤‘ì•™ ê´€ë¦¬í˜• ì„œë¹„ìŠ¤ë¡œ í™•ì¥í•˜ê±°ë‚˜, ê°œë°œÂ·í…ŒìŠ¤íŠ¸Â·ì†Œê·œëª¨ ìš´ì˜ í™˜ê²½ì— ë§ê²Œ ì¶•ì†Œí•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.3. REST ì¸í„°í˜ì´ìŠ¤ ì œê³µ ê°„ë‹¨í•œ REST APIë¥¼ í†µí•´ Kafka Connect í´ëŸ¬ìŠ¤í„°ì— ì»¤ë„¥í„°ë¥¼ ë“±ë¡í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤.4. ìë™ ì˜¤í”„ì…‹(offset) ê´€ë¦¬ ì»¤ë„¥í„°ê°€ ìµœì†Œí•œì˜ ì •ë³´ë§Œ ì œê³µí•´ë„ Kafka Connectê°€ ì˜¤í”„ì…‹ ì»¤ë°‹ ê³¼ì •ì„ ìë™ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤.5. ë¶„ì‚° ë° í™•ì¥ ê°€ëŠ¥ êµ¬ì¡° Kafka ConnectëŠ” Kafkaì˜ ê·¸ë£¹ ê´€ë¦¬ í”„ë¡œí† ì½œ(group management protocol)ì„ ê¸°ë°˜ìœ¼ë¡œ, ì›Œì»¤ë¥¼ ì¶”ê°€í•˜ê¸°ë§Œ í•´ë„ í´ëŸ¬ìŠ¤í„° ê·œëª¨ë¥¼ ì†ì‰½ê²Œ í™•ì¥í•  ìˆ˜ ìˆë‹¤.í•µì‹¬ ê°œë…1. Connectors Kafka Connectì˜ ì»¤ë„¥í„°(connector)ëŠ” ë°ì´í„°ê°€ ì–´ë””ì—ì„œ ì–´ë””ë¡œ ë³µì‚¬ë˜ì–´ì•¼ í•˜ëŠ”ì§€ë¥¼ ì •ì˜Source Connector ì™¸ë¶€ ë°ì´í„° ì†ŒìŠ¤ì—ì„œ ì „ì²´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê°€ì ¸ì˜¤ê³ , í…Œì´ë¸”ì˜ ë³€ê²½ ì‚¬í•­ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ Kafka í† í”½ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¬ë°â€» â€œì „ì²´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê°€ì ¸ì˜¨ë‹¤ (ingest entire database)â€ ? ë‹¨ìˆœíˆ DB ì „ì²´ë¥¼ í•œ ë²ˆì— ë³µì‚¬í•œë‹¤ëŠ” ëœ»ì´ ì•„ë‹ˆë¼, ì´ˆê¸° ë°ì´í„° ì ì¬ ë‹¨ê³„ì—ì„œì˜ ë™ì‘ì„ ì˜ë¯¸ ì´ˆê¸° ì ì¬ (Initial Snapshot / Full Load) CDC íŒŒì´í”„ë¼ì¸ì„ ì²˜ìŒ ì‹œì‘í•  ë•Œ, í˜„ì¬ ë°ì´í„°ë² ì´ìŠ¤ì— ë“¤ì–´ìˆëŠ” ëª¨ë“  í…Œì´ë¸”ì˜ ì „ì²´ ë°ì´í„°ë¥¼ í•œ ë²ˆ ì½ì–´ì„œ Kafkaë¡œ ë³´ë‚´ëŠ” ë‹¨ê³„ CDCëŠ” ì›ë˜ â€œë³€ê²½ ì‚¬í•­ë§Œ ê°ì§€â€í•˜ì§€ë§Œ, ì‹œìŠ¤í…œì´ ì²˜ìŒ ì‹œì‘í•  ë•ŒëŠ” â€œê¸°ì¡´ ë°ì´í„°â€ê°€ Kafkaì— ì—†ê¸° ë•Œë¬¸ì— ì´ˆê¸° ìŠ¤ëƒ…ìƒ·ì´ í•„ìš” ì˜ˆì‹œ: MySQLì˜ ê²½ìš°, Debeziumì´ ì²˜ìŒ ì‹œì‘í•  ë•Œ ê° í…Œì´ë¸”ì„ SELECT * FROM table ì‹ìœ¼ë¡œ ì½ìŒ. ê·¸ ë°ì´í„°ë¥¼ Kafka í† í”½ì— ë„£ì–´ â€œí˜„ì¬ ìƒíƒœâ€ë¥¼ ë§ì¶˜ ë’¤, ì´í›„ë¶€í„°ëŠ” binlog ê¸°ë°˜ì˜ ë³€ê²½ ì´ë²¤íŠ¸ë§Œ ì²˜ë¦¬. ë”°ë¼ì„œ, í…Œì´ë¸” í¬ê¸°ê°€ í¬ë©´, ì „ì²´ ìŠ¤ìº”(Full Table Scan), ë„¤íŠ¸ì›Œí¬ ì „ì†¡ (DB â†’ Kafka Connect), JSON ì§ë ¬í™” â†’ Kafka ë°œí–‰ê¹Œì§€ ë‹¤ í¬í•¨ë˜ì–´, DB I/O, ë„¤íŠ¸ì›Œí¬, Kafka ì „ì†¡ ì§€ì—°ì´ í•œêº¼ë²ˆì— ëˆ„ì ëœë‹¤. Debezium ì„¤ì • snapshot.modeë¡œ ìŠ¤ëƒ…ìƒ· ë°©ì‹ì„ ì œì–´í•  ìˆ˜ ìˆë‹¤. ëª¨ë“œ ì„¤ëª… initial (ê¸°ë³¸ê°’) ì „ì²´ ë°ì´í„°ë¥¼ í•œ ë²ˆ ì½ì€ ë’¤ binlogë¡œ ì „í™˜ schema_only ìŠ¤í‚¤ë§ˆë§Œ ê°€ì ¸ì˜¤ê³  ì‹¤ì œ ë°ì´í„°ëŠ” binlogë¡œë§Œ ë°˜ì˜ never ìŠ¤ëƒ…ìƒ· ìƒëµ, ì´ë¯¸ targetì´ ë™ê¸°í™”ë˜ì–´ ìˆëŠ” ê²½ìš° ì‚¬ìš© initial_only binlogë¡œ ë„˜ì–´ê°€ì§€ ì•Šê³  ìŠ¤ëƒ…ìƒ·ê¹Œì§€ë§Œ ìˆ˜í–‰ Sink Connector Kafka í† í”½ì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ì™¸ë¶€ ì‹œìŠ¤í…œìœ¼ë¡œ ë‚´ë³´ë‚´ëŠ” ì—­í•  ì»¤ë„¥í„°ê°€ êµ¬í˜„í•˜ê±°ë‚˜ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  í´ë˜ìŠ¤ëŠ” ì»¤ë„¥í„° í”ŒëŸ¬ê·¸ì¸(connector plugin) ì•ˆì— ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤. ì¦‰, â€œì»¤ë„¥í„° í”ŒëŸ¬ê·¸ì¸(plugin)â€ì€ ì½”ë“œ(í´ë˜ìŠ¤, ì„¤ì • ë“±)ê°€ ë“¤ì–´ ìˆëŠ” êµ¬í˜„ ë‹¨ìœ„, â€œì»¤ë„¥í„° ì¸ìŠ¤í„´ìŠ¤(instance)â€ëŠ” ê·¸ í”ŒëŸ¬ê·¸ì¸ì„ ì‹¤ì œë¡œ ì‹¤í–‰ ì¤‘ì¸ ì‘ì—… ë‹¨ìœ„ë¼ê³  í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‘˜ ë‹¤ â€œì»¤ë„¥í„°(connector)â€ë¼ê³  ë¶€ë¥´ê¸°ë„ í•˜ì§€ë§Œ, ë§¥ë½ì— ë”°ë¼ ì˜ë¯¸ê°€ êµ¬ë¶„ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, â€œinstall a connector(ì»¤ë„¥í„°ë¥¼ ì„¤ì¹˜í•œë‹¤)â€ â†’ í”ŒëŸ¬ê·¸ì¸(plugin)ì„ ì˜ë¯¸ â€œcheck the status of a connector(ì»¤ë„¥í„° ìƒíƒœë¥¼ í™•ì¸í•œë‹¤)â€ â†’ ì¸ìŠ¤í„´ìŠ¤(instance)ë¥¼ ì˜ë¯¸ ConfluentëŠ” ì‚¬ìš©ìê°€ ê°€ëŠ¥í•œ í•œ ê¸°ì¡´ ì»¤ë„¥í„°ë¥¼ í™œìš©í•  ê²ƒì„ ê¶Œì¥â€» Confluent ? https://www.confluent.io/ Apache Kafkaì˜ ìƒìš© ë°°í¬íŒì„ ë§Œë“  íšŒì‚¬ì´ì, Kafkaì˜ ì°½ì‹œìì¸ Jay Krepsê°€ ê³µë™ ì°½ë¦½í•œ íšŒì‚¬ í•­ëª© ì„¤ëª… Kafka Connect Apache Kafkaì˜ ê³µì‹ ì»´í¬ë„ŒíŠ¸ (ë°ì´í„° í†µí•© í”„ë ˆì„ì›Œí¬) Confluent Kafka ë° Connectë¥¼ í¬í•¨í•œ ìƒìš© ë°°í¬/ìš´ì˜ í”Œë«í¼ Confluent Platform Kafka Connect + Schema Registry + ksqlDB + ê´€ë¦¬ë„êµ¬ ë“± í¬í•¨ Confluent Cloud ì™„ì „ê´€ë¦¬í˜• Kafka ì„œë¹„ìŠ¤ (Kafka Connect í¬í•¨) 2. Tasks Taskê°€ ì‹¤ì œë¡œ ë°ì´í„°ë¥¼ ë³µì‚¬í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰ ê° ì»¤ë„¥í„° ì¸ìŠ¤í„´ìŠ¤(connector instance)ëŠ” ì—¬ëŸ¬ ê°œì˜ íƒœìŠ¤í¬(task)ë¥¼ ì¡°ì • ì»¤ë„¥í„°ê°€ í•˜ë‚˜ì˜ ì‘ì—…(job)ì„ ì—¬ëŸ¬ íƒœìŠ¤í¬ë¡œ ë‚˜ëˆ„ì–´ ë³‘ë ¬ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•¨ìœ¼ë¡œì¨, Kafka ConnectëŠ” ë³‘ë ¬ ì²˜ë¦¬(parallelism) ì™€ í™•ì¥ ê°€ëŠ¥í•œ ë°ì´í„° ë³µì œ(scalable data copying) ë¥¼ ë³µì¡í•œ ì„¤ì • ì—†ì´ë„ ê¸°ë³¸ì ìœ¼ë¡œ ì§€ì› ê° íƒœìŠ¤í¬ ìì²´ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ìƒíƒœ(state)ë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ì‹  íƒœìŠ¤í¬ì˜ ìƒíƒœ ì •ë³´ëŠ” Kafkaì˜ íŠ¹ë³„í•œ í† í”½ì— ì €ì¥ë©ë‹ˆë‹¤: config.storage.topic status.storage.topic ì´ ìƒíƒœë“¤ì€ í•´ë‹¹ ì»¤ë„¥í„° ì¸ìŠ¤í„´ìŠ¤ê°€ ê´€ë¦¬í•©ë‹ˆë‹¤. ì¦‰, íƒœìŠ¤í¬ëŠ” ë¬´ìƒíƒœ(stateless) ë¡œ ì„¤ê³„ë˜ì–´ ìˆê³ , í•„ìš”í•  ë•Œë§ˆë‹¤ Kafka ë‚´ë¶€ í† í”½ì„ í†µí•´ ìƒíƒœë¥¼ ë³µêµ¬í•˜ê±°ë‚˜ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. íƒœìŠ¤í¬ëŠ” ì–¸ì œë“ ì§€ ì‹œì‘(start), ì¤‘ì§€(stop), ì¬ì‹œì‘(restart) í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ëŸ° êµ¬ì¡° ë•ë¶„ì— Kafka ConnectëŠ” ì¥ì•  ë³µêµ¬(resilience) ì™€ í™•ì¥ì„±(scalability) ì„ ë™ì‹œì— ê°–ì¶˜ ì•ˆì •ì ì¸ ë°ì´í„° íŒŒì´í”„ë¼ì¸ì„ ì œê³µ(ì¶œì²˜ : https://docs.confluent.io/platform/current/connect/index.html)Task Rebalancing Kafka Connectì—ì„œ ì»¤ë„¥í„°ê°€ í´ëŸ¬ìŠ¤í„°ì— ì²˜ìŒ ë“±ë¡ë˜ë©´, í´ëŸ¬ìŠ¤í„° ë‚´ì˜ ëª¨ë“  ì›Œì»¤(worker)ë“¤ì´ í˜‘ë ¥í•˜ì—¬ ëª¨ë“  ì»¤ë„¥í„°ì™€ íƒœìŠ¤í¬ë¥¼ ì¬ë¶„ë°°(rebalance) í•©ë‹ˆë‹¤. ì´ ê³¼ì •ì„ í†µí•´ ê° ì›Œì»¤ëŠ” ëŒ€ëµ ë™ì¼í•œ ì–‘ì˜ ì‘ì—…ì„ ë‹´ë‹¹í•˜ê²Œ ë©ë‹ˆë‹¤. ë¦¬ë°¸ëŸ°ì‹± ì ˆì°¨ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì—ì„œë„ ìˆ˜í–‰ë©ë‹ˆë‹¤: ì»¤ë„¥í„°ê°€ í•„ìš”í•œ íƒœìŠ¤í¬ ê°œìˆ˜ë¥¼ ëŠ˜ë¦¬ê±°ë‚˜ ì¤„ì¼ ë•Œ ì»¤ë„¥í„°ì˜ ì„¤ì •ì´ ë³€ê²½ë  ë•Œ ì›Œì»¤ê°€ ì¥ì• ë¡œ ì¸í•´ ì¤‘ë‹¨ë˜ì—ˆì„ ë•Œ, ë‚¨ì•„ ìˆëŠ” í™œì„± ì›Œì»¤(active workers)ë“¤ë¡œ íƒœìŠ¤í¬ê°€ ì¬ë¶„ë°°ë¨ ì¦‰, í´ëŸ¬ìŠ¤í„°ëŠ” í•­ìƒ ë¶€í•˜ë¥¼ ê· ë“±í•˜ê²Œ ë¶„ì‚°ì‹œí‚¤ëŠ” ë°©í–¥ìœ¼ë¡œ ìë™ ì¡°ì •ëœë‹¤. íƒœìŠ¤í¬ê°€ ê°œë³„ì ìœ¼ë¡œ ì‹¤íŒ¨í–ˆì„ ë•Œ(task failure)ëŠ” ë¦¬ë°¸ëŸ°ì‹±ì´ ìë™ìœ¼ë¡œ íŠ¸ë¦¬ê±°ë˜ì§€ ì•ŠëŠ”ë‹¤. íƒœìŠ¤í¬ ì‹¤íŒ¨ëŠ” ì¼ë°˜ì ì¸ ìš´ì˜ ì‹œë‚˜ë¦¬ì˜¤ê°€ ì•„ë‹Œ ì˜ˆì™¸ì ì¸ ìƒí™©ìœ¼ë¡œ ê°„ì£¼ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ë”°ë¼ì„œ, ì‹¤íŒ¨í•œ íƒœìŠ¤í¬ëŠ” Kafka Connect í”„ë ˆì„ì›Œí¬ê°€ ìë™ìœ¼ë¡œ ì¬ì‹œì‘í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ëŒ€ì‹  REST API ë¥¼ í†µí•´ ìˆ˜ë™ìœ¼ë¡œ ì¬ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤. (ì¶œì²˜ : https://docs.confluent.io/platform/current/connect/index.html)3. Workers ì»¤ë„¥í„°(Connector) ì™€ íƒœìŠ¤í¬(Task) ëŠ” ë…¼ë¦¬ì ì¸ ì‘ì—… ë‹¨ìœ„ì´ë¯€ë¡œ, ì´ë“¤ì´ ì‹¤ì œë¡œ ì‹¤í–‰ë˜ê¸° ìœ„í•´ì„œëŠ” ì–´ë–¤ í”„ë¡œì„¸ìŠ¤(process) ìœ„ì— ìŠ¤ì¼€ì¤„ë§ë˜ì–´ì•¼ í•©ë‹ˆë‹¤. Kafka Connectì—ì„œëŠ” ì´ëŸ¬í•œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì›Œì»¤(Worker) ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.Standalone Workers (ë‹¨ì¼ ëª¨ë“œ ì›Œì»¤) Standalone ëª¨ë“œëŠ” ê°€ì¥ ë‹¨ìˆœí•œ ì‹¤í–‰ ëª¨ë“œì…ë‹ˆë‹¤.í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ê°€ ëª¨ë“  ì»¤ë„¥í„°ì™€ íƒœìŠ¤í¬ë¥¼ ì§ì ‘ ì‹¤í–‰í•©ë‹ˆë‹¤. íŠ¹ì§•: ì„¤ì •ì´ ë§¤ìš° ê°„ë‹¨ (ë‹¨ì¼ í”„ë¡œì„¸ìŠ¤ë§Œ ì‹¤í–‰) ê°œë°œ ì´ˆê¸° ë‹¨ê³„ë‚˜ í…ŒìŠ¤íŠ¸, ë˜ëŠ” ë‹¨ì¼ í˜¸ìŠ¤íŠ¸ì—ì„œ ë¡œê·¸ë¥¼ ìˆ˜ì§‘í•˜ëŠ” ë“±ì˜ ê°„ë‹¨í•œ ìƒí™©ì— ì í•© ëª¨ë“  ì‹¤í–‰ì´ í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì²˜ë¦¬ë¨ ì œí•œì : í™•ì¥ì„±(scalability) ì´ ì œí•œë¨ (í”„ë¡œì„¸ìŠ¤ 1ê°œê°€ ì „ë¶€) ì¥ì•  ë³µêµ¬(fault tolerance) ë¶ˆê°€ëŠ¥ (í”„ë¡œì„¸ìŠ¤ê°€ ì£½ìœ¼ë©´ ì „ì²´ ì¤‘ë‹¨) ì™¸ë¶€ ëª¨ë‹ˆí„°ë§ì„ ë¶™ì´ì§€ ì•Šìœ¼ë©´ ìë™ ë³µêµ¬ ê¸°ëŠ¥ ì—†ìŒ Distributed Workers (ë¶„ì‚° ëª¨ë“œ ì›Œì»¤) Kafka Connectì˜ í™•ì¥ì„±(scalability)ê³¼ ìë™ ì¥ì•  ë³µêµ¬(fault tolerance)ë¥¼ ì œê³µí•˜ëŠ” ìš´ì˜ í™˜ê²½ìš© ëª¨ë“œ íŠ¹ì§•: ì—¬ëŸ¬ ì›Œì»¤ í”„ë¡œì„¸ìŠ¤ë¥¼ ë™ì¼í•œ group.id ë¡œ ì‹¤í–‰í•˜ë©´, ì´ë“¤ì´ í•˜ë‚˜ì˜ Connect í´ëŸ¬ìŠ¤í„°ë¥¼ í˜•ì„±í•¨. ì›Œì»¤ë“¤ì´ ì„œë¡œ í˜‘ë ¥í•˜ì—¬ ì»¤ë„¥í„°ì™€ íƒœìŠ¤í¬ë¥¼ ìë™ìœ¼ë¡œ ë¶„ì‚° ë°°ì¹˜. ì›Œì»¤ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ì¤‘ë‹¨í•˜ê±°ë‚˜ ì¥ì• ê°€ ë°œìƒí•˜ë©´, ë‚¨ì€ ì›Œì»¤ë“¤ì´ ì´ë¥¼ ê°ì§€í•˜ê³  íƒœìŠ¤í¬ë¥¼ ìë™ ì¬ë¶„ë°°(rebalance) í•¨. ì´ ê³¼ì •ì€ Kafka Consumer Group ë¦¬ë°¸ëŸ°ì‹±ê³¼ ìœ ì‚¬í•œ ë°©ì‹ìœ¼ë¡œ ë™ì‘í•¨. ì˜ˆì‹œ: Worker A: group.id = connect-cluster-a Worker B: group.id = connect-cluster-a ë‘ ì›Œì»¤ëŠ” ìë™ìœ¼ë¡œ í•˜ë‚˜ì˜ í´ëŸ¬ìŠ¤í„° connect-cluster-a ë¥¼ í˜•ì„±í•¨. (ì¶œì²˜ : https://docs.confluent.io/platform/current/connect/index.html)4. Converters Kafka Connectê°€ ì™¸ë¶€ ì‹œìŠ¤í…œê³¼ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ì„ ë•Œ, ë°ì´í„°ë¥¼ Kafka ë‚´ë¶€ í˜•ì‹(ë°”ì´íŠ¸ ë°°ì—´)ê³¼ Connectì˜ ë‚´ë¶€ ë°ì´í„° êµ¬ì¡° ì‚¬ì´ì—ì„œ ë³€í™˜í•´ì£¼ëŠ” ì—­í•  ì¦‰, Taskê°€ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ë•Œ, ì»¨ë²„í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°”ì´íŠ¸ í˜•íƒœì˜ ë°ì´í„°ë¥¼ Kafka Connect ë‚´ë¶€ ë°ì´í„° í˜•ì‹ìœ¼ë¡œ ë³€í™˜í•˜ê±°ë‚˜, ë°˜ëŒ€ë¡œ ë‚´ë¶€ í˜•ì‹ì„ ë°”ì´íŠ¸ë¡œ ì§ë ¬í™” ì˜ˆì‹œ: ì»¨ë²„í„° ì„¤ëª… JsonConverter ë°ì´í„°ë¥¼ JSON í˜•íƒœë¡œ ë³€í™˜ StringConverter ë‹¨ìˆœ ë¬¸ìì—´ë¡œ ë³€í™˜ AvroConverter Avro ìŠ¤í‚¤ë§ˆë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë³€í™˜ (ì£¼ë¡œ Schema Registryì™€ í•¨ê»˜ ì‚¬ìš©) ProtobufConverter Protobuf í¬ë§·ìœ¼ë¡œ ì§ë ¬í™”/ì—­ì§ë ¬í™” ByteArrayConverter ì›ì‹œ ë°”ì´íŠ¸ ê·¸ëŒ€ë¡œ ì²˜ë¦¬ (ê°€ê³µ ì—†ì´ ì „ì†¡í•  ë•Œ) ì»¨ë²„í„°ëŠ” ì»¤ë„¥í„°ë¡œë¶€í„° ë…ë¦½ì ìœ¼ë¡œ ë¶„ë¦¬ë˜ì–´ ì„¤ê³„ë˜ì–´ ìˆë‹¤. ë”°ë¼ì„œ, ì»¤ë„¥í„°ëŠ” ìì‹ ì´ ë‹¤ë£¨ëŠ” ë°ì´í„° ì†ŒìŠ¤ë‚˜ íƒ€ê¹ƒ(DB, íŒŒì¼ ë“±)ì— ì§‘ì¤‘í•  ìˆ˜ ìˆê³  ë°ì´í„°ì˜ í‘œí˜„ ë°©ì‹(Avro, JSON, String ë“±)ì€ ì»¨ë²„í„°ê°€ ì „ë‹´ (ì¶œì²˜ : https://docs.confluent.io/platform/current/connect/index.html)5. Transforms í•˜ë‚˜ì˜ ë ˆì½”ë“œë¥¼ ì…ë ¥ë°›ì•„ ìˆ˜ì •ëœ ë ˆì½”ë“œë¥¼ ì¶œë ¥í•˜ëŠ” ê°„ë‹¨í•œ í•¨ìˆ˜ ë ˆì½”ë“œ ? ì»¤ë„¥í„°ê°€ ì£¼ê³ ë°›ëŠ” í•œ ê±´ì˜ ë°ì´í„° ì´ë²¤íŠ¸ë¥¼ ì˜ë¯¸ Source Connector â†’ Kafka ë¡œ ë°ì´í„°ë¥¼ ë³´ë‚¼ ë•Œ: SourceRecord Kafka â†’ Sink Connector ë¡œ ë°ì´í„°ë¥¼ ë³´ë‚¼ ë•Œ: SinkRecord orders í…Œì´ë¸”ì—ì„œ í•œ í–‰ì´ ë³€ê²½ëì„ë•Œ, Debezium ê°™ì€ Source Connectorê°€ ë‹¤ìŒê³¼ ê°™ì€ SourceRecord ë¥¼ ìƒì„±{ \"topic\": \"dbserver1.inventory.orders\", \"key\": { \"order_id\": 101 }, \"value\": { \"order_id\": 101, \"status\": \"SHIPPED\", \"amount\": 30000 }, \"timestamp\": 1735200000000, \"schema\": { ... }}Source Connectorì—ì„œì˜ Transform ë™ì‘ Source Connector â†’ Transform 1 â†’ Transform 2 â†’ â€¦ â†’ Kafka Source Connector ê°€ ìƒˆë¡œìš´ ì†ŒìŠ¤ ë ˆì½”ë“œë¥¼ ìƒì„±í•˜ë©´, Kafka ConnectëŠ” ê·¸ ë ˆì½”ë“œë¥¼ ì²« ë²ˆì§¸ ë³€í™˜(Transform)ìœ¼ë¡œ ì „ë‹¬í•œë‹¤. ë³€í™˜ì´ ìˆ˜í–‰ë˜ì–´ ìˆ˜ì •ëœ ìƒˆë¡œìš´ ë ˆì½”ë“œê°€ ìƒì„±ëœë‹¤. ì´ ê²°ê³¼ ë ˆì½”ë“œëŠ” ë‹¤ìŒ ë³€í™˜ìœ¼ë¡œ ì „ë‹¬ë˜ê³ , ê°™ì€ ë°©ì‹ìœ¼ë¡œ ë°˜ë³µëœë‹¤. ë§ˆì§€ë§‰ ë³€í™˜ì„ ê±°ì¹œ ìµœì¢… ë ˆì½”ë“œëŠ” ë°”ì´ë„ˆë¦¬ í˜•íƒœë¡œ ì§ë ¬í™”ë˜ì–´ Kafkaì— ì €ì¥ëœë‹¤.Sink Connectorì—ì„œì˜ Transform ë™ì‘ Kafka â†’ Transform 1 â†’ Transform 2 â†’ â€¦ â†’ Sink Connector Kafka ConnectëŠ” Kafka í† í”½ìœ¼ë¡œë¶€í„° ë©”ì‹œì§€ë¥¼ ì½ì–´ ë°”ì´ë„ˆë¦¬ ë°ì´í„°ë¥¼ Sink Record ë¡œ ë³€í™˜í•œë‹¤. ë³€í™˜ì´ ì„¤ì •ë˜ì–´ ìˆìœ¼ë©´, ê·¸ ë ˆì½”ë“œëŠ” ì²« ë²ˆì§¸ ë³€í™˜ì„ ê±°ì¹œë‹¤. ìˆ˜ì •ëœ ë ˆì½”ë“œëŠ” ë‹¤ìŒ ë³€í™˜ìœ¼ë¡œ ì „ë‹¬ë˜ì–´ ë˜ í•œ ë²ˆ ê°±ì‹ ëœë‹¤. ëª¨ë“  ë³€í™˜ì„ ê±°ì¹œ ìµœì¢… Sink Recordê°€ Sink Connector ë¡œ ì „ë‹¬ë˜ì–´ ìµœì¢… ì²˜ë¦¬ëœë‹¤.ì˜ˆì‹œ1 í† í”½ ì´ë¦„ ë³€ê²½ (RegexRouter ì‚¬ìš©)\"transforms\": \"routeByStatus\",\"transforms.routeByStatus.type\": \"org.apache.kafka.connect.transforms.RegexRouter\",\"transforms.routeByStatus.regex\": \"orders\",\"transforms.routeByStatus.replacement\": \"orders.${order_status}\" RegexRouter ë³€í™˜ì€ ë©”ì‹œì§€ê°€ ë“¤ì–´ê°€ëŠ” í† í”½ ì´ë¦„ì„ ë™ì ìœ¼ë¡œ ë³€ê²½í•œë‹¤. ${order_status} ê°™ì€ í•„ë“œë¥¼ ì‚¬ìš©í•´ ë©”ì‹œì§€ ê°’(value)ì— ë”°ë¼ ë¼ìš°íŒ…ì´ ê°€ëŠ¥ (ë‹¤ë§Œ ê¸°ë³¸ SMTëŠ” ê°’ ì°¸ì¡°ë¥¼ ì§ì ‘ ì§€ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ, ì»¤ìŠ¤í…€ Transformìœ¼ë¡œ êµ¬í˜„í•˜ê¸°ë„ í•œë‹¤.) ê²°ê³¼ì ìœ¼ë¡œ, orders.NEW, orders.CANCELLEDì²˜ëŸ¼ ì£¼ë¬¸ ìƒíƒœì— ë”°ë¼ ë‹¤ë¥¸ í† í”½ìœ¼ë¡œ ì „ì†¡ë¨ì˜ˆì‹œ2 íŠ¹ì • í•„ë“œ ì œê±°\"transforms\": \"removePII\",\"transforms.removePII.type\": \"org.apache.kafka.connect.transforms.ReplaceField$Value\",\"transforms.removePII.blacklist\": \"ssn,email\" ssn, email ê°™ì€ ê°œì¸ì •ë³´ í•„ë“œë¥¼ ë©”ì‹œì§€ì—ì„œ ì œê±°6. Dead Letter Queue Sink Connectorì—ì„œ ì²˜ë¦¬í•  ìˆ˜ ì—†ëŠ” ì˜ëª»ëœ ë ˆì½”ë“œë¥¼ ë³„ë„ í† í”½ìœ¼ë¡œ ë³´ë‚´ëŠ” ì—ëŸ¬ ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜ Dead Letter Queue(DLQ)ëŠ” Sink Connectorì—ì„œë§Œ ì‚¬ìš©ë˜ëŠ” ê¸°ëŠ¥ ì¦‰, Sink Connectorì—ì„œ í˜•ì‹ ë¶ˆì¼ì¹˜ë‚˜ ë³€í™˜ ì˜¤ë¥˜ ë“±ìœ¼ë¡œ íŠ¹ì • ë ˆì½”ë“œë¥¼ ì²˜ë¦¬í•  ìˆ˜ ì—†ì„ ë•Œ, ì‹¤íŒ¨í•œ ë ˆì½”ë“œë¥¼ íŠ¹ë³„í•œ Kafka í† í”½(Dead Letter Queue Topic)ìœ¼ë¡œ ë”°ë¡œ ë³´ê´€í•œë‹¤. ì˜ˆì‹œ : Kafka ë©”ì‹œì§€ëŠ” JSON í˜•ì‹ì¸ë°, Sink ConnectorëŠ” Avro í˜•ì‹ì„ ê¸°ëŒ€í•˜ê³  ìˆì„ ë•Œ ë©”ì‹œì§€ì— í•„ìˆ˜ í•„ë“œê°€ ëˆ„ë½ë˜ì—ˆì„ ë•Œ ìŠ¤í‚¤ë§ˆ í˜¸í™˜ì„± ë¬¸ì œë¡œ Sink ì‹œìŠ¤í…œì— ì“¸ ìˆ˜ ì—†ì„ ë•Œ ì´ëŸ° ê²½ìš°, Kafka ConnectëŠ” errors.tolerance ì„¤ì •ì— ë”°ë¼ ëŒ€ì‘í•œë‹¤. ì„¤ì •ê°’ ì˜ë¯¸ none (ê¸°ë³¸ê°’) - ì˜¤ë¥˜ ë°œìƒ ì‹œ ì¦‰ì‹œ íƒœìŠ¤í¬ ì‹¤íŒ¨. ì»¤ë„¥í„°ëŠ” ì‹¤íŒ¨ ìƒíƒœ(failed)ê°€ ë˜ì–´ ì¤‘ë‹¨ë¨ - ìš´ì˜ìëŠ” Worker ë¡œê·¸ë¥¼ í™•ì¸í•˜ê³  ì›ì¸ì„ ìˆ˜ì •í•œ ë’¤ ì»¤ë„¥í„°ë¥¼ ì¬ì‹œì‘í•´ì•¼ í•¨ all - ëª¨ë“  ì˜¤ë¥˜ë‚˜ ì˜ëª»ëœ ë ˆì½”ë“œë¥¼ ë¬´ì‹œí•˜ê³  ê³„ì† ì²˜ë¦¬. ë‹¤ë§Œ ë¡œê·¸ì—ëŠ” ê¸°ë¡ë˜ì§€ ì•ŠìŒ. - ë”°ë¼ì„œ, ì‹¤íŒ¨í•œ ë ˆì½”ë“œ ìˆ˜ë¥¼ í™•ì¸í•˜ë ¤ë©´ ë‚´ë¶€ ë©”íŠ¸ë¦­(metrics)ì´ë‚˜ ì›ë³¸ê³¼ ê²°ê³¼ì˜ ì¹´ìš´íŠ¸ë¥¼ ë¹„êµí•´ì•¼ í•œë‹¤. errors.tolerance=all ë¡œ ì„¤ì •ëœ ê²½ìš°, ì¶”ê°€ ì„¤ì •ì„ í†µí•´ ì‹¤íŒ¨í•œ ë ˆì½”ë“œë¥¼ DLQ í† í”½ìœ¼ë¡œ ìë™ ì „ì†¡í•  ìˆ˜ ìˆë‹¤.errors.tolerance = allerrors.deadletterqueue.topic.name = &lt;dead-letter-topic-name&gt; ê¸°ë³¸ì ìœ¼ë¡œ DLQ í† í”½ì—ëŠ” ë ˆì½”ë“œ ë°ì´í„°ë§Œ ì €ì¥ë˜ë©°, â€œì™œ ì‹¤íŒ¨í–ˆëŠ”ì§€â€ì— ëŒ€í•œ ì •ë³´ê°€ ì—†ë‹¤. ì•„ë˜ ì˜µì…˜ì„ ì¶”ê°€í•´ì„œ ì—ëŸ¬ ë©”íƒ€ë°ì´í„°ë¥¼ í•¨ê»˜ ê¸°ë¡í•  ìˆ˜ ìˆë‹¤.errors.deadletterqueue.context.headers.enable = true ì´ ì„¤ì •ì„ ì¼œë©´ DLQì— ì „ì†¡ë˜ëŠ” ë ˆì½”ë“œì˜ í—¤ë”ì— ì—ëŸ¬ ì›ì¸ ì •ë³´ê°€ ì¶”ê°€ëœë‹¤. í—¤ë” í‚¤ë“¤ì€ _connect.errors. ë¡œ ì‹œì‘í•˜ë©°, kafkacat ê°™ì€ ë„êµ¬ë¡œ ì´ í—¤ë”ë¥¼ ì½ì–´ë³´ë©´ ì‹¤íŒ¨ ì´ìœ ë¥¼ ì§ì ‘ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì˜ˆ:_connect.errors.exception.class=org.apache.kafka.connect.errors.DataException_connect.errors.exception.message=Invalid schemaì°¸ê³  ìë£Œ https://kafka.apache.org/documentation.html#connect https://docs.confluent.io/platform/current/connect/index.html" }, { "title": "CDC(Change Data Capture) ì•Œì•„ë³´ê¸°", "url": "/posts/cdc-intro/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Infra", "date": "2025-10-26 00:50:00 +0900", "snippet": "CDC(Change Capture Data)ë€ ? ë°ì´í„°ë² ì´ìŠ¤ë‚˜ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ ê°™ì€ ë°ì´í„° ì†ŒìŠ¤ì˜ ëª¨ë“  ë³€ê²½ ì‚¬í•­ì„ ì¶”ì í•˜ì—¬, ì´ëŸ¬í•œ ë³€ê²½ ë‚´ìš©ì„ ëŒ€ìƒ ì‹œìŠ¤í…œì— ë°˜ì˜í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê³¼ì •(ì¶œì²˜ : https://www.confluent.io/learn/change-data-capture/#quick-intro-to-cdc)ì£¼ìš” ì´ì 1. ëŒ€ìš©ëŸ‰ ...", "content": "CDC(Change Capture Data)ë€ ? ë°ì´í„°ë² ì´ìŠ¤ë‚˜ ë°ì´í„° ì›¨ì–´í•˜ìš°ìŠ¤ ê°™ì€ ë°ì´í„° ì†ŒìŠ¤ì˜ ëª¨ë“  ë³€ê²½ ì‚¬í•­ì„ ì¶”ì í•˜ì—¬, ì´ëŸ¬í•œ ë³€ê²½ ë‚´ìš©ì„ ëŒ€ìƒ ì‹œìŠ¤í…œì— ë°˜ì˜í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê³¼ì •(ì¶œì²˜ : https://www.confluent.io/learn/change-data-capture/#quick-intro-to-cdc)ì£¼ìš” ì´ì 1. ëŒ€ìš©ëŸ‰ ì¼ê´„ ì—…ë°ì´íŠ¸ ì œê±° CDCëŠ” ë³€ê²½ëœ ë°ì´í„°ë§Œì„ ì¦ë¶„ ë¡œë“œ(incremental loading)í•˜ê±°ë‚˜ ì‹¤ì‹œê°„ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¬ë° ë°©ì‹ìœ¼ë¡œ ëŒ€ìƒ ì €ì¥ì†Œì— ë°˜ì˜í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ëŒ€ê·œëª¨ ë°°ì¹˜ ì—…ë°ì´íŠ¸ê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤.2. ë¡œê·¸ ê¸°ë°˜ íš¨ìœ¨ì„±(Log-Based Efficiency) ë¡œê·¸ ê¸°ë°˜ CDCëŠ” íŠ¸ëœì­ì…˜ ë¡œê·¸ì—ì„œ ì§ì ‘ ë³€ê²½ ì‚¬í•­ì„ ìº¡ì²˜í•˜ê¸° ë•Œë¬¸ì— ì›ë³¸ ì‹œìŠ¤í…œì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ìµœì†Œí™”í•œë‹¤.3. ë¬´ì¤‘ë‹¨ ë§ˆì´ê·¸ë ˆì´ì…˜(Zero-Downtime Migrations) CDCê°€ ì œê³µí•˜ëŠ” ì‹¤ì‹œê°„ ë°ì´í„° ì´ë™ ê¸°ëŠ¥ì€ ë¬´ì¤‘ë‹¨ ë°ì´í„°ë² ì´ìŠ¤ ë§ˆì´ê·¸ë ˆì´ì…˜ì„ ì§€ì›í•œë‹¤. ì´ë¥¼ í†µí•´ ì‹¤ì‹œê°„ ë¶„ì„ ë° ë¦¬í¬íŒ…ì— í•„ìš”í•œ ìµœì‹  ë°ì´í„°ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤.4. ì‹œìŠ¤í…œ ê°„ ë™ê¸°í™”(Synchronization Across Systems) CDCëŠ” ì—¬ëŸ¬ ì‹œìŠ¤í…œ ê°„ì˜ ë°ì´í„°ë¥¼ ë™ê¸°í™” ìƒíƒœë¡œ ìœ ì§€í•œë‹¤. ì´ëŠ” ë°ì´í„° ì†ë„ê°€ ë¹ ë¥´ê³  ì¦‰ê°ì ì¸ ì˜ì‚¬ê²°ì •ì´ í•„ìš”í•œ í™˜ê²½ì—ì„œ íŠ¹íˆ ì¤‘ìš”í•˜ë‹¤.5. í´ë¼ìš°ë“œ ë° ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ ìµœì í™”(Optimized for Cloud and Stream Processing) CDCëŠ” ê´‘ì—­ ë„¤íŠ¸ì›Œí¬(WAN)ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì´ë™ì‹œí‚¬ ìˆ˜ ìˆì–´, í´ë¼ìš°ë“œ í™˜ê²½ ë°°í¬ë‚˜ Apache Kafkaì™€ ê°™ì€ ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬ ì†”ë£¨ì…˜ê³¼ì˜ í†µí•©ì— ì´ìƒì ì´ë‹¤.êµ¬í˜„ ë°©ì‹ CDCëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë‘ ê°€ì§€ ì£¼ìš” ë°©ì‹, Push ë˜ëŠ” Pull ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•œë‹¤.Push ì†ŒìŠ¤ ë°ì´í„°ë² ì´ìŠ¤ê°€ ì£¼ìš” ì—­í• ì„ ë‹´ë‹¹í•œë‹¤. ì¦‰, ë°ì´í„°ë² ì´ìŠ¤ ë‚´ì—ì„œ ë°œìƒí•œ ë³€ê²½ ì‚¬í•­ì„ ì§ì ‘ ê°ì§€(capture)í•˜ê³ , ê·¸ ë³€ê²½ëœ ë°ì´í„°ë¥¼ ëŒ€ìƒ ì‹œìŠ¤í…œìœ¼ë¡œ ì „ì†¡í•œë‹¤. ì´ ë°©ì‹ì˜ ê°€ì¥ í° ì¥ì ì€ ëŒ€ìƒ ì‹œìŠ¤í…œì´ ê±°ì˜ ì‹¤ì‹œê°„(near real-time)ìœ¼ë¡œ ìµœì‹  ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤. ë°ì´í„° ë³€ê²½ì´ ë°œìƒí•˜ë©´ ì¦‰ì‹œ ì „ì†¡ë˜ë¯€ë¡œ, ì§€ì—°ì´ ìµœì†Œí™”ë˜ê³  ë°ì´í„° ì¼ê´€ì„±ì´ ë†’ê²Œ ìœ ì§€ëœë‹¤. í•˜ì§€ë§Œ, ëŒ€ìƒ ì‹œìŠ¤í…œì´ ì¼ì‹œì ìœ¼ë¡œ ì ‘ì† ë¶ˆê°€í•˜ê±°ë‚˜ ì˜¤í”„ë¼ì¸ ìƒíƒœì¼ ê²½ìš°, ì „ì†¡ëœ ë³€ê²½ ë°ì´í„°ê°€ ì†ì‹¤ë  ìœ„í—˜ì´ ìˆë‹¤. ì´ëŸ¬í•œ ìœ„í—˜ì„ ì™„í™”í•˜ê¸° ìœ„í•´, ì¼ë°˜ì ìœ¼ë¡œ ì†ŒìŠ¤ì™€ ëŒ€ìƒ ì‹œìŠ¤í…œ ì‚¬ì´ì— ë©”ì‹œì§• ì‹œìŠ¤í…œì„ ë‘”ë‹¤. Pull ì†ŒìŠ¤ ë°ì´í„°ë² ì´ìŠ¤ê°€ ë³€ê²½ ë‚´ìš©ì„ ì§ì ‘ ì „ì†¡í•˜ëŠ” ëŒ€ì‹ , ê° í…Œì´ë¸”ì— ìˆëŠ” íŠ¹ì • ì»¬ëŸ¼(ì˜ˆ: last_updatedë‚˜ modified_at) ë“±ì— ë°ì´í„° ë³€ê²½ ë¡œê·¸ë¥¼ ê¸°ë¡í•œë‹¤. ê·¸ í›„ ëŒ€ìƒ ì‹œìŠ¤í…œì´ ì£¼ê¸°ì ìœ¼ë¡œ ì†ŒìŠ¤ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ í´ë§(polling)í•˜ì—¬ ë³€ê²½ëœ ë°ì´í„°ë¥¼ ê°ì§€í•˜ê³  í•„ìš”í•œ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤. ë”°ë¼ì„œ ì†ŒìŠ¤ ì‹œìŠ¤í…œì˜ ë¶€í•˜ê°€ ì ê³ , ë°ì´í„°ë² ì´ìŠ¤ì— ì¶”ê°€ì ì¸ ë¶€í•˜ ì—†ì´ ê°„ë‹¨í•˜ê²Œ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. ëŒ€ìƒ ì‹œìŠ¤í…œì´ ì¼ì‹œì ìœ¼ë¡œ ì˜¤í”„ë¼ì¸ì¼ ë•Œ ë°ì´í„° ì†ì‹¤ì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ì¤‘ê°„ì— ë©”ì‹œì§• ì‹œìŠ¤í…œì„ ë‘ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤. ë©”ì‹œì§• ì‹œìŠ¤í…œì€ ë³€ê²½ ë°ì´í„°ë¥¼ ì„ì‹œ ì €ì¥(ë²„í¼ë§) í•˜ì—¬, ëŒ€ìƒ ì‹œìŠ¤í…œì´ ë³µêµ¬ë˜ë©´ ì•ˆì „í•˜ê²Œ ì „ë‹¬ë  ìˆ˜ ìˆë„ë¡ ë³´ì¥í•œë‹¤. ì´ ë°©ì‹ì˜ ë‹¨ì ì€ ë°ì´í„° ë³€ê²½ì´ ì¦‰ì‹œ ë°˜ì˜ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ì´ë‹¤. ëŒ€ìƒ ì‹œìŠ¤í…œì´ ì¼ì • ì£¼ê¸°(ì˜ˆ: 1ë¶„, 5ë¶„, 10ë¶„)ì— í•œ ë²ˆì”©ë§Œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì—, ê·¸ ì‚¬ì´ì— ë°œìƒí•œ ë³€ê²½ ì‚¬í•­ì€ ë‹¤ìŒ í´ë§ ì‹œì ê¹Œì§€ ì§€ì—°ëœë‹¤. ë°ì´í„° ë³€ê²½ ê°ì§€ ë°©ì‹1. Timestamp-based í…Œì´ë¸”ì— LAST_MODIFIED, LAST_UPDATED ê°™ì€ íƒ€ì„ìŠ¤íƒ¬í”„ ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ì—¬ ê° ë ˆì½”ë“œì˜ ê°€ì¥ ìµœê·¼ ë³€ê²½ ì‹œê°ì„ ê¸°ë¡í•˜ëŠ” ë°©ì‹ ëŒ€ìƒ ì‹œìŠ¤í…œì€ ì´ ì»¬ëŸ¼ì„ ì¡°íšŒí•´ì„œ ë§ˆì§€ë§‰ ì‹¤í–‰ ì´í›„ ë³€ê²½ëœ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤. DELETE(ì‚­ì œ) ì—°ì‚°ì„ ì§ì ‘ ê°ì§€í•  ìˆ˜ ì—†ë‹¤. (ì¦‰, â€œì†Œí”„íŠ¸ ì‚­ì œâ€ë§Œ ê°€ëŠ¥ â€” ì‹¤ì œ ì‚­ì œê°€ ì•„ë‹Œ ìƒíƒœ í”Œë˜ê·¸ ì—…ë°ì´íŠ¸ ë°©ì‹) ëª¨ë“  í–‰(row)ì„ ìŠ¤ìº”í•´ì•¼ í•˜ë¯€ë¡œ ì†ŒìŠ¤ ì‹œìŠ¤í…œ ë¶€í•˜ê°€ ì»¤ì§ˆ ìˆ˜ ìˆë‹¤. ì–´ë–¤ ë°ì´í„°ê°€ ê°±ì‹ ë˜ì—ˆëŠ”ì§€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì „ì²´ í…Œì´ë¸”ì„ ì¡°íšŒí•´ì•¼ í•¨. DB ìŠ¤í‚¤ë§ˆ ë³€ê²½ì´ í•„ìš”í•˜ë‹¤. (LAST_UPDATED ì»¬ëŸ¼ ì¶”ê°€ ë“±)2. Trigger-based ë°ì´í„°ë² ì´ìŠ¤ê°€ ì œê³µí•˜ëŠ” íŠ¸ë¦¬ê±°(trigger) ê¸°ëŠ¥ì„ í™œìš©. ì¦‰, INSERT, UPDATE, DELETEê°€ ì‹¤í–‰ë  ë•Œë§ˆë‹¤ ìë™ìœ¼ë¡œ ì‹¤í–‰ë˜ëŠ” í”„ë¡œì‹œì €ë¥¼ ë“±ë¡ ê° íŠ¸ë¦¬ê±°ëŠ” ë³€ê²½ëœ ë°ì´í„°ë¥¼ ë³„ë„ì˜ í…Œì´ë¸”(â€œshadow tableâ€ ë˜ëŠ” â€œevent tableâ€)ì— ê¸°ë¡í•œë‹¤. í•„ìš”í•˜ë‹¤ë©´ ë©”ì‹œì§• ì‹œìŠ¤í…œì— ì´ë²¤íŠ¸ë¥¼ ì „ì†¡í•  ìˆ˜ë„ ìˆë‹¤. ì†ŒìŠ¤ DB ì„±ëŠ¥ì— ë¶€ì •ì ì¸ ì˜í–¥ì„ ë¯¸ì¹œë‹¤. (í•œ ë²ˆì˜ ë°ì´í„° ë³€ê²½ì´ ì—¬ëŸ¬ ë²ˆì˜ ì“°ê¸° ì‘ì—…ìœ¼ë¡œ ì´ì–´ì§ â€” ì›ë³¸ í…Œì´ë¸” + ì´ë²¤íŠ¸ í…Œì´ë¸”) DB ìŠ¤í‚¤ë§ˆ ë³€ê²½ì´ í•„ìš”í•©ë‹ˆë‹¤. (íŠ¸ë¦¬ê±° ë° ì´ë²¤íŠ¸ í…Œì´ë¸” ì¶”ê°€) íŠ¸ë¦¬ê±°ê°€ ë§ì•„ì§ˆìˆ˜ë¡ ê´€ë¦¬ ë³µì¡ë„ ì¦ê°€ (í…Œì´ë¸”ë§ˆë‹¤ 3ê°œì”© í•„ìš” â€” INSERT, UPDATE, DELETE)3. Log-based ë°ì´í„°ë² ì´ìŠ¤ëŠ” íŠ¸ëœì­ì…˜ ìˆ˜í–‰ ì‹œë§ˆë‹¤ ëª¨ë“  ë³€ê²½ì‚¬í•­ì„ íŠ¸ëœì­ì…˜ ë¡œê·¸ íŒŒì¼(MySQL - binlog, PostgreSQL - WAL, Oracle - redo log)ì— ê¸°ë¡ì´ ë¡œê·¸ëŠ” ì›ë˜ ë³µêµ¬ ìš©ë„ë¡œ ì‚¬ìš©ë˜ì§€ë§Œ, CDC ì‹œìŠ¤í…œì´ ì´ ë¡œê·¸ë¥¼ ì½ì–´ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³€ê²½ ì‚¬í•­ì„ ê°ì§€í•  ìˆ˜ë„ ìˆë‹¤. ì†ŒìŠ¤ ë°ì´í„°ë² ì´ìŠ¤ì— ë¶€í•˜ë¥¼ ê±°ì˜ ì£¼ì§€ ì•ŠëŠ”ë‹¤. (íŠ¸ëœì­ì…˜ ë¡œê·¸ë¥¼ ì½ê¸°ë§Œ í•˜ë¯€ë¡œ ì¿¼ë¦¬ ì‹¤í–‰ ë¶€ë‹´ ì—†ìŒ) ëª¨ë“  ë³€ê²½ ìœ í˜•(INSERT, UPDATE, DELETE)ì„ ê°ì§€í•  ìˆ˜ ìˆë‹¤. DB ìŠ¤í‚¤ë§ˆë¥¼ ë³€ê²½í•  í•„ìš”ê°€ ì—†ë‹¤. íŠ¸ëœì­ì…˜ ë¡œê·¸ í˜•ì‹ì´ í‘œì¤€í™”ë˜ì–´ ìˆì§€ ì•Šë‹¤. ì¦‰, DB ë²¤ë”(MySQL, Oracle, PostgreSQL ë“±)ë§ˆë‹¤ ë¡œê·¸ êµ¬ì¡°ê°€ ë‹¤ë¥´ë©°, ë²„ì „ë³„ë¡œ ë³€ê²½ë  ìˆ˜ ìˆë‹¤. ë¡¤ë°±ëœ ë³€ê²½ ë‚´ì—­ì„ ì‹ë³„ ë° ì œì™¸í•´ì•¼ í•œë‹¤. ë¡œê·¸ì—ëŠ” ì»¤ë°‹ë˜ì§€ ì•Šì€ ë³€ê²½ë„ ì¼ì‹œì ìœ¼ë¡œ ê¸°ë¡ë˜ê¸° ë•Œë¬¸ì—. ì°¸ê³  ìë£Œ https://www.confluent.io/learn/change-data-capture" }, { "title": "Cubridì—ì„œ MySQLë¡œì˜ ì—¬ì •(0) - ê°œìš”", "url": "/posts/dbms-migration-intro/", "categories": "ê²½í—˜í•˜ê¸°, ì‘ì—… ë…¸íŠ¸", "tags": "MySQL", "date": "2025-10-18 23:00:00 +0900", "snippet": "í”„ë¡œì íŠ¸ ê°œìš” ë‹´ë‹¹ ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ë˜ DBMSì¸ Cubridë¥¼ ê±·ì–´ë‚´ê³  MySQLë¡œ ì „í™˜ ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ Cubrid 9.3 ë²„ì „ì€ ì´ë¯¸ EOL(End of Life, 2023.03.31)ì´ ì§€ë‚˜ ì¥ê¸°ì ì¸ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ìš´ ìƒí™©ì´ì—ˆìŒ. DBA íŒ€ì— ë”°ë¥´ë©´ ìƒìœ„ ë²„ì „(10.x)ìœ¼ë¡œì˜ ì—…ê·¸ë ˆì´ë“œëŠ” ë°ì´í„° ì €ì¥ ë°©ì‹ê³¼ êµ¬ì¡° ì°¨ì´ë¡œ ì¸í•´ ë§ˆì´ê·¸ë ˆì´ì…˜ ...", "content": "í”„ë¡œì íŠ¸ ê°œìš” ë‹´ë‹¹ ì„œë¹„ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ë˜ DBMSì¸ Cubridë¥¼ ê±·ì–´ë‚´ê³  MySQLë¡œ ì „í™˜ ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ Cubrid 9.3 ë²„ì „ì€ ì´ë¯¸ EOL(End of Life, 2023.03.31)ì´ ì§€ë‚˜ ì¥ê¸°ì ì¸ ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë ¤ìš´ ìƒí™©ì´ì—ˆìŒ. DBA íŒ€ì— ë”°ë¥´ë©´ ìƒìœ„ ë²„ì „(10.x)ìœ¼ë¡œì˜ ì—…ê·¸ë ˆì´ë“œëŠ” ë°ì´í„° ì €ì¥ ë°©ì‹ê³¼ êµ¬ì¡° ì°¨ì´ë¡œ ì¸í•´ ë§ˆì´ê·¸ë ˆì´ì…˜ ê³¼ì •ì´ ë³µì¡í•˜ë‹¤ëŠ” íŒë‹¨ì´ ìˆì—ˆìŒ. ë˜í•œ, DBA íŒ€ì˜ ì¸ë ¥ êµ¬ì„±ìƒ MySQL ìš´ì˜ì´ ë” ìˆ˜ì›”í•˜ë‹¤ëŠ” í˜„ì‹¤ì ì¸ ì´ìœ ë„ ê³ ë ¤ë˜ì—ˆìŒ. ì„œë¹„ìŠ¤ ìœ ì§€ë³´ìˆ˜ ê´€ì ì—ì„œë„, ë ˆí¼ëŸ°ìŠ¤ê°€ í’ë¶€í•˜ê³  ë‹¤ì–‘í•œ ë¹…í…Œí¬ ê¸°ì—…ì—ì„œë„ í­ë„“ê²Œ ì‚¬ìš© ì¤‘ì¸ MySQLë¡œ ì „í™˜í•˜ëŠ” ê²ƒì´ ë” ìœ ë¦¬í•˜ë‹¤ê³  íŒë‹¨í•¨.ì§„í–‰ ê³¼ì •1. MySQLìš© ì¿¼ë¦¬ ê²€ì¦ MyBatisë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì—, MySQL ìš´ì˜ì„ ìœ„í•´ì„œëŠ” MySQL ì¿¼ë¦¬ ì‘ì„±ì´ í•„ìˆ˜. ë”°ë¼ì„œ MySQLìš© ì¿¼ë¦¬ì— ëŒ€í•œ ì¿¼ë¦¬ ê²€ì¦ì´ í•„ìˆ˜ ê²€ì¦ ëŒ€ìƒ: ì¿¼ë¦¬ ë¬¸ë²• ì—ëŸ¬ëŠ” ì—†ëŠ”ì§€ ì½ê¸°ì˜ ê²½ìš°, Cubridì™€ ë™ì¼í•œ ê²°ê³¼ê°’ì´ ì¡°íšŒë˜ëŠ”ì§€ ì“°ê¸°ì˜ ê²½ìš°, Cubridì™€ ë™ì¼í•˜ê²Œ ë°ì´í„° ë³€ê²½ì´ ë°œìƒí–ˆëŠ”ì§€ 2. Cubridì—ì„œ MySQLë¡œ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ë§ˆì´ê·¸ë ˆì´ì…˜ë˜ëŠ” ë™ì•ˆ ë°ì´í„° ë³€ê²½ì´ ì—†ë„ë¡ í•˜ê¸° ìœ„í•´, ì„œë¹„ìŠ¤ëŠ” Read Onlyë§Œ ê°€ëŠ¥í•˜ê²Œ ì‚¬ìš©ì ìš”ì²­ì´ ê°€ì¥ ì ì€ ìƒˆë²½ ì‹œê°„ëŒ€ì— ì§„í–‰ Read Onlyë¡œ ìš´ì˜ë˜ëŠ” ì‹œê°„ì„ ìµœì†Œí™”í•˜ê¸° ìœ„í•´, ë§ˆì´ê·¸ë ˆì´ì…˜ì— ê±¸ë¦¬ëŠ” ì‹œê°„ì„ ìµœì†Œí™” í•˜ëŠ” ë°©í–¥ì„ ìƒê°3. MySQLë¡œ ì„œë¹„ìŠ¤ ìš´ì˜ í˜¹ì‹œëª¨ë¥¼ Cubridë¡œì˜ ë¡¤ë°± ìƒí™©ì„ ëŒ€ë¹„í•´ì„œ Cubridì—ë„ ë™ì¼í•œ ë°ì´í„° ìŒ“ëŠ”ê²Œ í•„ìš” ì–‘ìª½ DBê°„ì˜ ìµœì†Œí•œì˜ ì •í•©ì„± ë³´ì¥ì„ ìœ„í•´ Spring Dataì—ì„œ ì œê³µí•˜ëŠ” ChainedTransactionManager(Deprecatedë¨) ì‚¬ìš©í•˜ì—¬ ë¶„ì‚° íŠ¸ëœì­ì…˜ ì²˜ë¦¬4. Cubrid Fadeout MySQLë¡œ ì¼ì • ê¸°ê°„ë™ì•ˆ ìš´ì˜ í›„ ì´ìŠˆ ì—†ì„ì‹œ, Cubrid Fadeout ê´€ë ¨ ì†ŒìŠ¤ ì½”ë“œ ëª¨ë‘ ì œê±° DB ì„œë²„ ë°˜ë‚©" }, { "title": "ì˜¤ëŠ˜ ë“œëŠ” ìƒê° (251016, ì€íƒ„í™˜)", "url": "/posts/daily-note-251016/", "categories": "ë„ì ë„ì ", "tags": "", "date": "2025-10-16 22:00:00 +0900", "snippet": "ê°œë°œìë¼ëŠ” ì§ì—…ì„ ê°–ê³ ë‚˜ì„œ â€œì€íƒ„í™˜ì€ ì—†ë‹¤â€ë¼ëŠ” ë§ì„ ë§ì´ ë“¤ì—ˆë˜ ê²ƒ ê°™ë‹¤.ì™œ ì€íƒ„í™˜ì€ ì—†ëŠ”ê±¸ê¹Œ ?ë‚´ ë‚˜ë¦„ëŒ€ë¡œì˜ ê²°ë¡ ì€, ëª¨ë“  ìƒí™©ì—ëŠ” ì €ë§ˆë‹¤ì˜ ë§¥ë½(context)ì´ ìˆê¸° ë•Œë¬¸ì¸ ê²ƒ ê°™ë‹¤.ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ì„œë¹„ìŠ¤ì˜ DBMSë¥¼ ë‹¤ë¥¸ DBMSë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•œë‹¤ê³  í•  ë•Œ ê³ ë ¤í•´ì•¼í•  ë§¥ë½ì€ ë‹¤ì–‘í•˜ë‹¤: ì„œë¹„ìŠ¤ì˜ ê¸°ìˆ  ìŠ¤íƒ, ë°ì´í„° ê·œëª¨,...", "content": "ê°œë°œìë¼ëŠ” ì§ì—…ì„ ê°–ê³ ë‚˜ì„œ â€œì€íƒ„í™˜ì€ ì—†ë‹¤â€ë¼ëŠ” ë§ì„ ë§ì´ ë“¤ì—ˆë˜ ê²ƒ ê°™ë‹¤.ì™œ ì€íƒ„í™˜ì€ ì—†ëŠ”ê±¸ê¹Œ ?ë‚´ ë‚˜ë¦„ëŒ€ë¡œì˜ ê²°ë¡ ì€, ëª¨ë“  ìƒí™©ì—ëŠ” ì €ë§ˆë‹¤ì˜ ë§¥ë½(context)ì´ ìˆê¸° ë•Œë¬¸ì¸ ê²ƒ ê°™ë‹¤.ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ì„œë¹„ìŠ¤ì˜ DBMSë¥¼ ë‹¤ë¥¸ DBMSë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ëŠ” í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•œë‹¤ê³  í•  ë•Œ ê³ ë ¤í•´ì•¼í•  ë§¥ë½ì€ ë‹¤ì–‘í•˜ë‹¤: ì„œë¹„ìŠ¤ì˜ ê¸°ìˆ  ìŠ¤íƒ, ë°ì´í„° ê·œëª¨, íŠ¹ì„± (ì‹¤ì‹œê°„ì„± ì—¬ë¶€, B2Cì¸ì§€ B2Bì¸ì§€, ì£¼ìš” ìš”ì²­ì´ ì¡°íšŒ ì¤‘ì‹¬ì¸ì§€, ì“°ê¸° ì¤‘ì‹¬ì¸ì§€ ë“±) ì ê²€ì„ ê±¸ê³  ì§„í–‰í•  ìˆ˜ ìˆëŠ”ì§€ ì—¬ë¶€ (ê°€ëŠ¥í•˜ë‹¤ë©´ í—ˆìš© ê°€ëŠ¥í•œ ì¤‘ë‹¨ ì‹œê°„) ì¸ë ¥ êµ¬ì„± (íˆ¬ì… ê°€ëŠ¥í•œ ê°œë°œì ìˆ˜, DBA íŒ€ì˜ ì¡´ì¬ ì—¬ë¶€ ë“±) í”„ë¡œì íŠ¸ ê¸°ê°„ ê¸°íƒ€ ë“±ë“± ..ì´ë¿ë§Œ ì•„ë‹ˆë¼ ì„œë¹„ìŠ¤ê°€ ì†í•œ ì‚°ì—…êµ°ì— ë”°ë¼ ë²•ë¥ ì  ì œì•½, ë³´ì•ˆ ì •ì±… ìˆ˜ì¤€ ë“±ë„ ëª¨ë‘ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤.ê·¸ëŸ¬ë¯€ë¡œ ì–´ë–¤ ë°©ë²•ë¡ ì´ë‚˜ ì €ëª…í•œ ì‚¬ëŒì˜ ë§, í˜¹ì€ Best Practiceë¥¼ ë¬´ì¡°ê±´ ë”°ë¥´ê¸°ë³´ë‹¤, í˜„ì¬ ì£¼ì–´ì§„ ë§¥ë½ ì†ì—ì„œ ìµœì„ ì˜ ì„ íƒì´ ë¬´ì—‡ì¼ê¹Œ ê³ ë¯¼í•˜ëŠ” ê°œë°œìê°€ ë˜ê³ ì‹¶ë‹¤." }, { "title": "ì˜¤ëŠ˜ ë“œëŠ” ìƒê° (251015, ì¼ê³¼ ê³µë¶€)", "url": "/posts/daily-note-251015/", "categories": "ë„ì ë„ì ", "tags": "", "date": "2025-10-15 22:00:00 +0900", "snippet": "í˜„ì‹¤ì ìœ¼ë¡œ ìƒê³„ë¥¼ ìœ ì§€í•˜ë ¤ë©´ ë‚´ ì¸ìƒì—ì„œ ì¼ì€ ê³„ì† í•´ì•¼í•˜ì§€ ì•Šì„ê¹Œ ìƒê°í•œë‹¤.í•˜ë£¨ 24ì‹œê°„ ì¤‘ ì¼ê³¼ ê´€ë ¨ëœ ì‹œê°„ì€: ì¶œí‡´ê·¼ (ì¶œê·¼ ì¤€ë¹„ì‹œê°„ í¬í•¨) : 2ì‹œê°„ íšŒì‚¬ì— ìˆëŠ” ì‹œê°„ : (8ì‹œê°„ ê·¼ë¬´ ê¸°ì¤€) 9ì‹œê°„11ì‹œê°„ ì •ë„ëœë‹¤.ë‹¨ìˆœ ê³„ì‚°ìœ¼ë¡œ ë¹„ìœ¨ì„ ë”°ì ¸ë³´ë©´: í•˜ë£¨ë¡œ ê³„ì‚°í–ˆì„ë•Œ, ì•½ 45% 1ë…„ ì›Œí‚¹ë°ì´(ëŒ€ëµ 250ì¼)ë¡œ ê³„ì‚°í–ˆì„ë•Œ, ì•½ 31%ëª‡ ì‚´...", "content": "í˜„ì‹¤ì ìœ¼ë¡œ ìƒê³„ë¥¼ ìœ ì§€í•˜ë ¤ë©´ ë‚´ ì¸ìƒì—ì„œ ì¼ì€ ê³„ì† í•´ì•¼í•˜ì§€ ì•Šì„ê¹Œ ìƒê°í•œë‹¤.í•˜ë£¨ 24ì‹œê°„ ì¤‘ ì¼ê³¼ ê´€ë ¨ëœ ì‹œê°„ì€: ì¶œí‡´ê·¼ (ì¶œê·¼ ì¤€ë¹„ì‹œê°„ í¬í•¨) : 2ì‹œê°„ íšŒì‚¬ì— ìˆëŠ” ì‹œê°„ : (8ì‹œê°„ ê·¼ë¬´ ê¸°ì¤€) 9ì‹œê°„11ì‹œê°„ ì •ë„ëœë‹¤.ë‹¨ìˆœ ê³„ì‚°ìœ¼ë¡œ ë¹„ìœ¨ì„ ë”°ì ¸ë³´ë©´: í•˜ë£¨ë¡œ ê³„ì‚°í–ˆì„ë•Œ, ì•½ 45% 1ë…„ ì›Œí‚¹ë°ì´(ëŒ€ëµ 250ì¼)ë¡œ ê³„ì‚°í–ˆì„ë•Œ, ì•½ 31%ëª‡ ì‚´ê¹Œì§€ ì¼ì„ í•  ìˆ˜ ìˆì„ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ, ì¸ìƒ ì „ì²´ë¥¼ ë†“ê³  ë³´ë”ë¼ë„ ì¼ì€ ë‚´ ì‚¶ì—ì„œ êµ‰ì¥íˆ ë§ì€ ì‹œê°„ì„ ì°¨ì§€í•´ì™”ê³  ì•ìœ¼ë¡œë„ ê·¸ëŸ´ê²ƒ ê°™ë‹¤. ì¸ìƒì˜ ë§ì€ ë¶€ë¶„ì„ ì°¨ì§€í•˜ëŠ” ë§Œí¼, ì´ì™•ì´ë©´ ê·¸ ì‹œê°„ë“¤ì´ íšŒì‚¬ì™€ ë‚˜ ëª¨ë‘ì—ê²Œ ê°€ì¹˜ìˆëŠ” ì‹œê°„ì´ë©´ ì¢‹ê² ë‹¤. ë¨¼ì €, íšŒì‚¬ ì…ì¥ì—ì„œ ë‚´ ì‹œê°„ì´ ê°€ì¹˜ìˆìœ¼ë ¤ë©´ ? (= ë‚˜í•œí…Œ ì£¼ëŠ” ì›”ê¸‰ì´ ì•ˆ ì•„ê¹Œìš°ë ¤ë©´)- ìµœì†Œí•œì˜ ë¦¬ì†ŒìŠ¤(ì‹œê°„, ì„œë²„ ë¹„ìš©, ê¸°ìˆ  ì„ íƒ ë“±)ë¡œ ì¼ì„ ì²˜ë¦¬í•œë‹¤.- ë‚œì´ë„ ìˆëŠ” ì—…ë¬´ë¥¼ ì˜ ìˆ˜í–‰í•´ë‚¸ë‹¤.- ë§ì€ ì‚¬ëŒë“¤ì˜ ì‹œê°„ì„ ë¶ˆí•„ìš”í•˜ê²Œ ê°‰ì•„ë¨¹ëŠ” ë¹„íš¨ìœ¨ì ì¸ ë¶€ë¶„ì„ ê°œì„ í•œë‹¤.- ë§¡ì€ ì„œë¹„ìŠ¤ë¥¼ ì§€ì† ì„±ì¥ ê°€ëŠ¥í•˜ë„ë¡ ê³ ë¯¼í•˜ë©´ì„œ ë§Œë“ ë‹¤.- ê¸°íƒ€ ë“±ë“±..ì´ê±´ í‰ì†Œì— ë§ì€ ê³ ë¯¼ê³¼ ê¾¸ì¤€í•œ ê³µë¶€ê°€ ë’·ë°›ì¹¨ë¼ì•¼ ê°€ëŠ¥í•˜ë‹¤ê³  ìƒê°í•œë‹¤. ë‹¤ìŒìœ¼ë¡œ, ë‚˜ì—ê²Œ ê°€ì¹˜ìˆëŠ” ì‹œê°„ì´ë€ ?1. ê·¸ ì‹œê°„ì´ ì¦ê²ë‹¤.- ë‚˜ëŠ” ë¬´ì–¸ê°€ë¥¼ í•  ë•Œ ì˜í•˜ë©´ ì¦ê±°ì›€ì„ ëŠë‚€ë‹¤.- ê·¸ë¦¬ê³  ìŠ¤ìŠ¤ë¡œ ëŠë¼ê¸°ì— ë§‰í˜ì´ ì—†ì„ ë•Œ + ì™¸ë¶€ì˜ ì¸ì •ìœ¼ë¡œë¶€í„° ì˜í•œë‹¤ëŠ” ê²ƒì„ ì¸ì§€í•˜ê²Œ ë˜ëŠ” ê²ƒ ê°™ë‹¤.2. ê·¸ ì‹œê°„ë“¤ì´ ìŒ“ì—¬ì„œ ì–»ëŠ” ê²°ê³¼ê°€ ê°’ì§€ë‹¤.- ë„ì „ì ìœ¼ë¡œ ëŠê»´ì§€ëŠ” ê²ƒë“¤ì„ í•´ë‚˜ê°€ë©° ì„±ì¥í•˜ëŠ” ê²ƒ- ìš°ë¦¬ ê°€ì¡±ì—ê²Œ ë” ë§ì€ ê²ƒì„ í•´ì¤„ìˆ˜ ìˆê²Œë˜ëŠ” ê²ƒ- ëˆ„êµ°ê°€ì—ê²Œ ë„ì›€ì„ ì¤„ ìˆ˜ ìˆëŠ” ê²ƒ- ê¸°íƒ€ ë“±ë“±..ì¦‰, ì¼í•˜ëŠ” ì‹œê°„ì´ íšŒì‚¬ì™€ ë‚˜ì—ê²Œ ëª¨ë‘ ê°€ì¹˜ìˆë‹¤ëŠ”ê±´: í‰ì†Œì— ë§ì´ ê³ ë¯¼í•˜ê³  ê¾¸ì¤€íˆ ê³µë¶€í•œ ì—­ëŸ‰ì„ ë°”íƒ•ìœ¼ë¡œ, ì¼ì„ ì˜í•´ì•¼í•˜ë©°, ì¡°ê¸ˆ ì–´ë µê³  í˜ë“¤ë”ë¼ë„ ê²¬ë””ë©°, ê·¸ ê³¼ì •ì„ í†µí•´ ì„±ì¥í•˜ëŠ” ê²ƒì´ë¼ê³  ìƒê°í•œë‹¤. ê·¸ëŸ¼, ì–´ë–¤ ê³µë¶€ë¥¼ í•˜ëŠ”ê²Œ ì¢‹ì„ê¹Œ ?1. ì—…ë¬´ë¥¼ ì§„í–‰í• ë•Œ ê±¸ë¦¼ëŒì´ ë˜ëŠ” ë¶€ë¶„ì„ ì—†ì• ê¸° ìœ„í•œ ê³µë¶€ (ë„ë©”ì¸, ì‚¬ìš©í•˜ëŠ” ê¸°ìˆ  ë“±)2. ë™ì¼í•œ ì—…ë¬´ë¥¼ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œë„ ì²˜ë¦¬í•  ìˆ˜ ìˆì„ì§€(íŠ¹íˆ, ì¢€ ë” ì–´ë ¤ìš´ ìƒí™©ì¸ ê²½ìš°ë¥¼ ê°€ì •í•´ì„œ)ì— ëŒ€í•œ ê³µë¶€ (ê¸°ìˆ  ë¸”ë¡œê·¸, ë°œí‘œ ë“± ì°¸ê³ í•  ê²ƒë“¤ì´ ë§ë‹¤.)3. í˜„ì¬ ë°©ì‹ì˜ ë¹„íš¨ìœ¨ì ì¸ ë¶€ë¶„, ì´ìŠˆê°€ ë ë§Œí•œ ë¶€ë¶„ì„ ì°¾ê³  ê°œì„ í•˜ëŠ”ë° í•„ìš”í•œ ê³µë¶€ (ë¨¼ì €, ë¬¸ì œë¥¼ ì¸ì‹í•  ìˆ˜ ìˆëŠ” ê°ê°ì„ í‚¤ìš°ëŠ”ê²Œ ì¤‘ìš”í•œ ê²ƒ ê°™ë‹¤. =&gt; ì…°í”„ë“¤ì´ ë¯¸ê°ì„ í›ˆë ¨í•˜ëŠ” ê²ƒì²˜ëŸ¼)4. (ë³„ë‹¤ë¥¸ ê³ ë¯¼ì—†ì´) ê´€ì„±ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê³ ìˆëŠ” ê²ƒë“¤ì„ ê¹Šì´ ì´í•´í•˜ê¸° ìœ„í•œ ê³µë¶€5. í˜„ì¬ íšŒì‚¬ì— ì˜ì¡´ì ì´ê²Œ ë˜ëŠ” ê²ƒì„ ê²½ê³„í•˜ê¸° ìœ„í•´, ì´ì§ì„ ìœ„í•œ ê³µë¶€ (ì‚¬ì‹¤ ì•ì„œ ì ì€ ê²ƒë“¤ì´ ê²°êµ­ ì´ì§í•  ë•Œ ê°€ì¥ ì¤‘ìš”í•œ ë¶€ë¶„ì¸ ê²ƒ ê°™ê¸´í•˜ë‹¤.)ê¾¸ì¤€íˆ ê³µë¶€ëŠ” í•´ì˜¤ê³ ìˆì§€ë§Œ, ëª…í™•í•œ ë°©í–¥ì„± ì—†ì´ ê°ˆíŒ¡ì§ˆíŒ¡í•˜ëŠ” ëŠë‚Œì„ ë°›ì€ ì ë“¤ì´ ê½¤ ìˆë˜ê²ƒ ê°™ì€ë°ì•ìœ¼ë¡œëŠ” ë‚˜ë¦„ëŒ€ë¡œ ì •ë¦¬í•œ ìš°ì„ ìˆœìœ„ì™€ ë¶„ëª…í•œ ëª©ì ì„ ê°–ê³  ê³µë¶€í•´ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤." }, { "title": "ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì–´ë µë‹¤ ?", "url": "/posts/thinking-about-maintenance/", "categories": "ìƒê°í•´ë³´ê¸°, ìœ ì§€ë³´ìˆ˜", "tags": "", "date": "2025-10-13 22:00:00 +0900", "snippet": "ë‚˜ëŠ” ì£¼ë¡œ ì–´ë–¤ ìƒí™©ì—ì„œ â€˜ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì–´ë µë‹¤â€™ë¼ê³  ëŠë‚„ê¹Œ ? ìœ ì§€ë³´ìˆ˜ì™€ ì–´ë µë‹¤ë¥¼ ê°ê° ê·¸ë™ì•ˆì˜ ë‚´ ê²½í—˜ì— ë¹„ì¶”ì–´ ìƒê°í•´ë³´ë©´ìœ ì§€ë³´ìˆ˜1. ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ (ë˜ëŠ” ì‹œìŠ¤í…œ ë‹¨ìœ„ì˜ ê°œë°œ)2. ìš”êµ¬ì‚¬í•­ ë³€ê²½ ë“±ìœ¼ë¡œ ì¸í•œ ê¸°ì¡´ ê¸°ëŠ¥ ìˆ˜ì •3. ì´ìŠˆ ë””ë²„ê¹… ë° ì¡°ì¹˜4. ê¸°ëŠ¥ì€ ë™ì‘í•˜ì§€ë§Œ ì‚¬ìš©ì ê²½í—˜ì´ ì¢‹ì§€ì•Šê±°ë‚˜, ì¶”í›„ ì´ìŠˆê°€ ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ” ë¶€ë¶„ ì¡°ì¹˜ì–´ë µë‹¤ ...", "content": "ë‚˜ëŠ” ì£¼ë¡œ ì–´ë–¤ ìƒí™©ì—ì„œ â€˜ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì–´ë µë‹¤â€™ë¼ê³  ëŠë‚„ê¹Œ ? ìœ ì§€ë³´ìˆ˜ì™€ ì–´ë µë‹¤ë¥¼ ê°ê° ê·¸ë™ì•ˆì˜ ë‚´ ê²½í—˜ì— ë¹„ì¶”ì–´ ìƒê°í•´ë³´ë©´ìœ ì§€ë³´ìˆ˜1. ìƒˆë¡œìš´ ê¸°ëŠ¥ ì¶”ê°€ (ë˜ëŠ” ì‹œìŠ¤í…œ ë‹¨ìœ„ì˜ ê°œë°œ)2. ìš”êµ¬ì‚¬í•­ ë³€ê²½ ë“±ìœ¼ë¡œ ì¸í•œ ê¸°ì¡´ ê¸°ëŠ¥ ìˆ˜ì •3. ì´ìŠˆ ë””ë²„ê¹… ë° ì¡°ì¹˜4. ê¸°ëŠ¥ì€ ë™ì‘í•˜ì§€ë§Œ ì‚¬ìš©ì ê²½í—˜ì´ ì¢‹ì§€ì•Šê±°ë‚˜, ì¶”í›„ ì´ìŠˆê°€ ë  ê²ƒìœ¼ë¡œ ì˜ˆìƒë˜ëŠ” ë¶€ë¶„ ì¡°ì¹˜ì–´ë µë‹¤ ê°œì¸ì ìœ¼ë¡œ â€˜ì–´ë µë‹¤ = ì˜¤ë˜ê±¸ë¦°ë‹¤â€™ ë¼ê³  ìƒê°í•˜ë©°, íŠ¹íˆ ìœ„ì˜ 2,3ë²ˆ ìœ ì§€ë³´ìˆ˜ ì—…ë¬´ë¥¼ í•  ë•Œ ì´ëŸ° ëŠë‚Œì„ ë°›ì„ë•Œê°€ ë§ì•˜ë˜ ê²ƒ ê°™ë‹¤. ê±¸ë¦¼ëŒì´ ë˜ì—ˆë˜ ìš”ì†Œë“¤ì„ ìƒê°í•´ë³´ë©´:1. ì½”ë“œë¥¼ ì´í•´í•˜ê¸°ê°€ ì–´ë µë‹¤.2. ë³€ê²½ ì‚¬í•­ì´ ê¸°ì¡´ ê¸°ëŠ¥ì— ì˜í–¥ì„ ì£¼ì§€ëŠ” ì•ŠëŠ”ì§€ ì¼ì¼ì´ í™•ì¸ì´ í•„ìš”í•˜ë‹¤.ë˜ëŠ”, ì˜í–¥ì„ ì£¼ê±°ë‚˜/ë°›ëŠ”ë‹¤ê³  ì˜ˆìƒí•˜ê¸° ì–´ë ¤ìš´ ë²”ìœ„ë¼ í™•ì¸ì„ ëª»í•œë‹¤.3. ìš”êµ¬ì‚¬í•­ ë³€ê²½ìœ¼ë¡œ ì¸í•´ ê³ ì³ì•¼í•  ë¶€ë¶„ì´ ë„ˆë¬´ ë§ë‹¤.4. ì´ìŠˆ ì¶”ì ì˜ ë‹¨ì„œê°€ ë ë§Œí•œ ë¡œê·¸ê°€ ì œëŒ€ë¡œ ë‚¨ê³  ìˆì§€ ì•Šë‹¤. (ex : ì—ëŸ¬ ë¡œê·¸, ì¿¼ë¦¬ ë¡œê·¸, api ìš”ì²­/ì‘ë‹µ íŒŒë¼ë¯¸í„°)5. ì–´ë–¤ ë°ì´í„°ì˜ ê°’ì„ ë³€ê²½í•˜ëŠ” ë¡œì§ì´ ì—¬ëŸ¬ ê³³ì— ìˆê³ , ì½”ë“œ repoë„ ë¶„ë¦¬ë˜ì–´ ìˆë‹¤. (ex : ì–´ë“œë¯¼, ë°°ì¹˜, api ê°ê° ë³„ë„ repo)ë”°ë¼ì„œ, ê°’ì˜ ë³€ê²½ì„ ì¶”ì í•˜ë ¤ë©´ ì–´ë””ì„œ ë³€ê²½í•œ ê²ƒì¸ì§€ ì´ê³³ ì €ê³³ì„ ì°¾ì•„ì•¼í•œë‹¤.6. í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ í•„ìš”í•œ ë¶€ë¶„(ë°ì´í„° ì„¸íŒ… ë“±)ì´ ë§ë‹¤.ì§€ê¸ˆê¹Œì§€ ì´ëŸ° ë¶€ë¶„ë“¤ì„ ëŠê¼ˆì„ë•Œ, í©ë‚ ë¦¬ë“¯ ë„ì ì—¬ë†¨ì—ˆëŠ”ë°ì•ìœ¼ë¡œëŠ” ìƒì„¸í•˜ê²Œ ì™œ ì–´ë ¤ì› ëŠ”ì§€, ì–´ë–»ê²Œ ê°œì„ í–ˆëŠ”ì§€ ë“±ì„ ì˜ ì •ë¦¬í•´ë†“ìœ¼ë©´ ì¢‹ì€ ìì‚°ì´ ë  ê²ƒ ê°™ë‹¤." }, { "title": "MySQL - Hash Join ì•Œì•„ë³´ê¸°", "url": "/posts/mysql-hash-join/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "MySQL", "date": "2025-10-04 00:20:00 +0900", "snippet": "Hash Join í•´ì‹œ í…Œì´ë¸”ì„ ì‚¬ìš©í•´ì„œ ë§¤ì¹­ë˜ëŠ” í–‰ì„ ì°¾ëŠ” ì¡°ì¸ ë°©ì‹ Hash Joinì€ í¬ê²Œ build phaseì™€ probe phase ë‘ ë‹¨ê³„ë¡œ êµ¬ì„±ëœë‹¤.1. Build PhaseSELECT given_name, country_nameFROM personsJOIN countries ON persons.country_id = countries...", "content": "Hash Join í•´ì‹œ í…Œì´ë¸”ì„ ì‚¬ìš©í•´ì„œ ë§¤ì¹­ë˜ëŠ” í–‰ì„ ì°¾ëŠ” ì¡°ì¸ ë°©ì‹ Hash Joinì€ í¬ê²Œ build phaseì™€ probe phase ë‘ ë‹¨ê³„ë¡œ êµ¬ì„±ëœë‹¤.1. Build PhaseSELECT given_name, country_nameFROM personsJOIN countries ON persons.country_id = countries.country_id; í•œìª½ ì…ë ¥ì„ ê¸°ë°˜ìœ¼ë¡œ in-memory í•´ì‹œ í…Œì´ë¸”ì„ ë§Œë“ ë‹¤. ì´ë•Œ í•´ì‹œ í…Œì´ë¸”ì˜ keyëŠ” ì¡°ì¸ ì¡°ê±´(ì—¬ê¸°ì„œëŠ” country_id)ì´ë‹¤. ë³´í†µ ë” ì‘ì€ ì…ë ¥(ë°”ì´íŠ¸ í¬ê¸° ê¸°ì¤€)ì„ í•´ì‹œ í…Œì´ë¸”ë¡œ ë§Œë“ ë‹¤. ë©”ëª¨ë¦¬ì— ì˜¬ë ¤ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì‘ì€ ìª½ì´ ìœ ë¦¬í•¨. ì˜ˆì‹œì—ì„œ countries í…Œì´ë¸”ì„ build inputìœ¼ë¡œ ì„ íƒí–ˆë‹¤ê³  ê°€ì •í•˜ë©´: countriesì˜ ëª¨ë“  country_idë¥¼ í‚¤ë¡œ í•´ì„œ í•´ì‹œ í…Œì´ë¸”ì— ì €ì¥ ì´ ê³¼ì •ì„ ë§ˆì¹˜ë©´ build phase ì¢…ë£Œ (ì¶œì²˜ : https://dev.mysql.com/blog-archive/hash-join-in-mysql-8/)2. Probe Phase ì´ì œ ì„œë²„ëŠ” probe input(ì˜ˆì œì—ì„œëŠ” persons)ì„ ì½ê¸° ì‹œì‘í•œë‹¤. ê° rowì— ëŒ€í•´: persons.country_id ê°’ì„ í‚¤ë¡œ í•´ì„œ, í•´ì‹œ í…Œì´ë¸”ì—ì„œ ë§¤ì¹­ë˜ëŠ” rowë¥¼ ì°¾ëŠ”ë‹¤. ë§¤ì¹­ë˜ëŠ” rowê°€ ìˆìœ¼ë©´, ê·¸ ë‘ rowë¥¼ í•©ì³ì„œ(joined row) í´ë¼ì´ì–¸íŠ¸ë¡œ ë³´ë‚¸ë‹¤. ì¦‰, personsì˜ ëª¨ë“  rowë¥¼ í•œ ë²ˆì”©ë§Œ ì½ê³ , í•´ì‹œ í…Œì´ë¸”ì—ì„œ ìƒìˆ˜ ì‹œê°„(constant time)ìœ¼ë¡œ ë§¤ì¹­ì„ ì°¾ê²Œ ëœë‹¤. ì´ ë°©ì‹ì´ ì˜ ë™ì‘í•˜ë ¤ë©´ build input ì „ì²´ë¥¼ ë©”ëª¨ë¦¬ì— ë‹´ì„ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. MySQLì—ì„œëŠ” ì‚¬ìš© ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬ í¬ê¸°ë¥¼ join_buffer_size ì‹œìŠ¤í…œ ë³€ìˆ˜ê°€ ì œì–´í•œë‹¤. ì´ ê°’ì€ ì‹¤í–‰ ì¤‘(runtime)ì—ë„ ì¡°ì •í•  ìˆ˜ ìˆë‹¤. (ì¶œì²˜ : https://dev.mysql.com/blog-archive/hash-join-in-mysql-8/)Spill to disk build inputì„ ë©”ëª¨ë¦¬ì— ë‹¤ ì˜¬ë¦´ ìˆ˜ ì—†ëŠ” ê²½ìš°, ì—¬ëŸ¬ ê°œì˜ íŒŒì¼ë¡œ ë‚˜ëˆ ì„œ ë””ìŠ¤í¬ì— ì €ì¥1. Probe Phaseì—ì„œì˜ Spill ì²˜ë¦¬ MySQLì€ build inputì„ ì—¬ëŸ¬ ê°œì˜ chunk íŒŒì¼ë¡œ ë‚˜ëˆ„ì–´ ì €ì¥: ì˜ˆë¥¼ ë“¤ì–´ build inputì´ 1GBì¸ë° ë©”ëª¨ë¦¬ëŠ” 256MBë¼ë©´ ëŒ€ëµ 4ê°œì˜ chunk íŒŒì¼ë¡œ ë‚˜ëˆ ì„œ ë””ìŠ¤í¬ì— ì“°ëŠ” ì‹ ë‹¨, MySQLì€ ë‚´ë¶€ì ìœ¼ë¡œ chunk íŒŒì¼ ìµœëŒ€ 128ê°œê¹Œì§€ë§Œ ë§Œë“¤ ìˆ˜ ìˆìŒ ì–´ë–¤ rowê°€ ì–´ë–¤ chunk íŒŒì¼ë¡œ ë“¤ì–´ê°ˆì§€ëŠ” ì¡°ì¸ í‚¤(ì˜ˆ: country_id)ì— ëŒ€í•´ í•´ì‹œ ê°’ì„ ê³„ì‚°í•´ì„œ ì •í•œë‹¤. ì¦‰, ê°™ì€ í‚¤ ê°’ì„ ê°€ì§„ rowë“¤ì€ í•­ìƒ ê°™ì€ chunk íŒŒì¼ì— ë“¤ì–´ê°€ê²Œëœë‹¤. ì´ë•Œ ì‚¬ìš©í•˜ëŠ” í•´ì‹œ í•¨ìˆ˜ëŠ”, ë‚˜ì¤‘ì— ë©”ëª¨ë¦¬ ì•ˆì—ì„œ ì‚¬ìš©í•˜ëŠ” í•´ì‹œ í•¨ìˆ˜ì™€ëŠ” ë‹¤ë¥´ë‹¤.2. Probe Phaseì—ì„œì˜ Spill ì²˜ë¦¬ build input í•´ì‹œ í…Œì´ë¸”ì— ì¼ì¹˜í•˜ëŠ” rowê°€ ìˆëŠ”ì§€ ì°¾ì•„ì•¼í•˜ëŠ”ë°, build inputì˜ ì¼ë¶€ê°€ ë””ìŠ¤í¬ì— ìˆê¸° ë•Œë¬¸ì— probe inputì˜ rowë„ ë””ìŠ¤í¬ì— ìˆëŠ” chunkì™€ ì§ì„ ë§ì¶°ì•¼ í•œë‹¤. ë”°ë¼ì„œ, probe inputë„ build inputì„ chunk fileì— ë¶„ë°°í• ë•Œ ì‚¬ìš©í•œ ë™ì¼í•œ í•´ì‹œ í•¨ìˆ˜ë¡œ ê³„ì‚°í•´ì„œ chunk íŒŒì¼ì„ ë§Œë“ ë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ì¡°ì¸ í‚¤ê°€ ê°™ì€ rowë“¤ì€ ë°˜ë“œì‹œ ê°™ì€ chunk ìŒ(= build chunk + probe chunk)ì— ë“¤ì–´ê°€ê²Œ ëœë‹¤. 3. Chunk File ì²˜ë¦¬ ëª¨ë“  chunk íŒŒì¼ ìŒì„ ì²˜ë¦¬: ì²« ë²ˆì§¸ build chunkë¥¼ ì½ì–´ì„œ ë©”ëª¨ë¦¬ì— í•´ì‹œ í…Œì´ë¸”ë¡œ ë§Œë“ ë‹¤. ê·¸ì— ëŒ€ì‘í•˜ëŠ” probe chunkë¥¼ ì½ì–´ì„œ í•´ì‹œ í…Œì´ë¸”ê³¼ ë§¤ì¹­ì‹œí‚¨ë‹¤. ëë‚˜ë©´ ë‘ ë²ˆì§¸ chunk ìŒìœ¼ë¡œ ë„˜ì–´ê°„ë‹¤. ì´ëŸ° ì‹ìœ¼ë¡œ ëª¨ë“  chunk íŒŒì¼ ìŒì„ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤. build chunkë¥¼ ì½ì–´ì„œ ë©”ëª¨ë¦¬ì— í•´ì‹œ í…Œì´ë¸”ë¡œ ë§Œë“¤ë•Œì˜ í•´ì‹œ í•¨ìˆ˜ëŠ” inputì„ chunk fileë¡œ ë¶„ë°°í•  ë•Œì˜ í•´ì‹œ í•¨ìˆ˜ì™€ëŠ” ë‹¤ë¥´ë‹¤. ê°™ì€ í•´ì‹œ í•¨ìˆ˜ë¥¼ ì“°ë©´, chunk íŒŒì¼ì— ìˆëŠ” rowë“¤ì´ ì „ë¶€ ê°™ì€ í•´ì‹œ ê°’ì— ëª°ë ¤ì„œ, í•´ì‹œ í…Œì´ë¸”ì´ í•œìª½ìœ¼ë¡œ ì ë¦¬ëŠ” ë¬¸ì œ(hash collision)ê°€ ìƒê¸´ë‹¤. (ì¶œì²˜ : https://dev.mysql.com/blog-archive/hash-join-in-mysql-8/)Chunk File ì‚­ì œëŠ” ? ì¡°ì¸ ê²°ê³¼ê°€ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ë‹¬ëœ ë’¤ ë°”ë¡œ ì‚­ì œ ëª¨ë“  chunk íŒŒì¼ ìŒì´ ì¡°ì¸ì„ ë§ˆì¹˜ë©´ ë‹¤ìŒì„ ìˆ˜í–‰: HashJoinIterator::EndOfIteration() í˜¸ì¶œ ë‚´ë¶€ì—ì„œ cleanup ë¡œì§ ì‹¤í–‰ MySQLì´ tmpdirì— ë§Œë“  ëª¨ë“  chunk íŒŒì¼ì„ ë‹«ê³  ì‚­ì œ: íŒŒì¼ í•¸ë“¤ì„ ë‹«ì€ ë‹¤ìŒ, OS ë ˆë²¨ì—ì„œ unlink() í˜¸ì¶œì„ ìˆ˜í–‰ í•´ì‹œ í…Œì´ë¸” ë©”ëª¨ë¦¬ë„ join_buffer_allocatorê°€ release ì‚¬ìš© ì¡°ê±´ ìœ í˜• ì„¤ëª… ì‚¬ìš© ê°€ëŠ¥í•œ ì¡°ì¸ ì¡°ê±´ (1) Hash Equi Join build í…Œì´ë¸”ì˜ ì¡°ì¸ í‚¤ë¥¼ í•´ì‹œ í…Œì´ë¸”ë¡œ ë§Œë“¤ê³ ,probe í…Œì´ë¸”ì—ì„œ ê°™ì€ í‚¤ íƒìƒ‰ ë“±ê°€ ì¡°ì¸ (=) ë° í•´ë‹¹ ì¡°ì¸ ì¡°ê±´ì— ì‚¬ìš© ê°€ëŠ¥í•œ ì¸ë±ìŠ¤ê°€ ì—†ëŠ” ê²½ìš°(ë¬¼ë¦¬ì ìœ¼ë¡œ ì¸ë±ìŠ¤ê°€ ìˆì–´ë„, í™œìš©í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ë„ í¬í•¨) (2) Hash Join (no condition) í•´ì‹œ í…Œì´ë¸”ë¡œ ì„ì‹œ ì €ì¥ í›„,probe ë‹¨ê³„ì—ì„œ í•„í„° ì¡°ê±´(&gt;, &lt;, ë“±)ìœ¼ë¡œ ë¹„êµ ë¹„ë“±ê°€ ì¡°ì¸, ì¡°ì¸ ì¡°ê±´ ì—†ëŠ” ê²½ìš° ì˜ˆì‹œ-- ê¸°ë³¸ Hash Join (equi-join), c1ì— ì¸ë±ìŠ¤ ì—†ìŒSELECT * FROM t1 JOIN t2 ON t1.c1 = t2.c1;-- í•„í„° ì¡°ê±´ë§Œ ìˆëŠ” Hash Join (ì¡°ì¸ ì¡°ê±´ ì—†ìŒ)SELECT * FROM t1 JOIN t2WHERE t1.c2 &gt; 50;-- Inner Non-Equi Join (ë¹„ë“±ê°€ ì¡°ì¸)SELECT * FROM t1 JOIN t2 ON t1.c1 &lt; t2.c1;-- Semijoin (IN ì„œë¸Œì¿¼ë¦¬)SELECT * FROM t1WHERE t1.c1 IN ( SELECT t2.c2 FROM t2 );-- Antijoin (NOT EXISTS)SELECT * FROM t2WHERE NOT EXISTS (SELECT * FROM t1 WHERE t1.c1 = t2.c1);-- Left Outer JoinSELECT * FROM t1 LEFT JOIN t2 ON t1.c1 = t2.c1; ì‹¤í–‰ê³„íš ê²°ê³¼ ìƒí™© Extra ì¶œë ¥ ì˜ë¯¸ ë“±ê°€ì¡°ì¸ Using join buffer (hash join) ì¼ë°˜ hash join (í‚¤ ê¸°ë°˜) ë¹„ë“±ê°€ì¡°ì¸ (&lt;, &gt;, !=) Using where; Using join buffer (hash join) hash join (no condition) â€” í‚¤ ë§¤ì¹­ ì—†ìŒ, í•„í„° ì¡°ê±´ìœ¼ë¡œ ë¹„êµ ì¡°ì¸ ì¡°ê±´ ì—†ìŒ (ì¹´í‹°ì…˜ ê³±) Using join buffer (hash join) ë˜ëŠ” Using where ì—†ì´ hash join (no condition) â€” ì „ í–‰ ì¡°í•© ë©”ëª¨ë¦¬ ê´€ë ¨ Hash Joinì—ì„œ ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ëŠ” join_buffer_size ë³€ìˆ˜ë¡œ ì œì–´ëœë‹¤. Hash Joinì€ í•„ìš”í•  ë•Œë§ˆë‹¤(join ì§„í–‰ ì¤‘) ë©”ëª¨ë¦¬ë¥¼ ì ì§„ì ìœ¼ë¡œ í• ë‹¹í•œë‹¤. ë”°ë¼ì„œ, join_buffer_sizeë¥¼ í¬ê²Œ ì„¤ì •í•´ë„ ì‘ì€ ì¿¼ë¦¬ê°€ ë¶ˆí•„ìš”í•˜ê²Œ í° ë²„í¼ë¥¼ ì ìœ í•˜ì§€ ì•ŠëŠ”ë‹¤. ë‹¨, Outer Joinì˜ ê²½ìš° ì „ì²´ ë²„í¼ë¥¼ í•œ ë²ˆì— í• ë‹¹í•œë‹¤. Hash Joinì´ í•„ìš”ë¡œ í•˜ëŠ” ë©”ëª¨ë¦¬ê°€ ì´ í¬ê¸°ë¥¼ ì´ˆê³¼í•˜ë©´, MySQLì€ ë””ìŠ¤í¬ ì„ì‹œ íŒŒì¼ì„ ì‚¬ìš©(spill)í•œë‹¤. ì´ë•Œ ë””ìŠ¤í¬ íŒŒì¼ ìˆ˜ê°€ open_files_limitì„ ë„˜ìœ¼ë©´ ì¡°ì¸ì´ ì‹¤íŒ¨í•  ìˆ˜ë„ ìˆë‹¤.ì°¸ê³  ìë£Œ https://dev.mysql.com/blog-archive/hash-join-in-mysql-8/ https://dev.mysql.com/doc/refman/8.4/en/hash-joins.html" }, { "title": "MySQL - Nested-Loop Join ì•Œì•„ë³´ê¸°", "url": "/posts/mysql-nested-loop-join/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "MySQL", "date": "2025-10-01 21:00:00 +0900", "snippet": "Nested-Loop Join Algorithm MySQLì€ í…Œì´ë¸” ê°„ ì¡°ì¸ì„ ìˆ˜í–‰í•  ë•Œ, ì¤‘ì²© ë£¨í”„ ì¡°ì¸(Nested-Loop Join, NLJ) ì•Œê³ ë¦¬ì¦˜(ë° ê·¸ ë³€í˜•)ì„ ì‚¬ìš©í•œë‹¤. MySQL 8.0.18ë¶€í„°ëŠ” Hash Joinë„ ì§€ì› NLJ : ë°”ê¹¥(outer) í…Œì´ë¸”ì—ì„œ í•œ í–‰ì”© ê°€ì ¸ì™€ ì•ˆìª½(inner) í…Œì´ë¸”ê³¼ ì¡°...", "content": "Nested-Loop Join Algorithm MySQLì€ í…Œì´ë¸” ê°„ ì¡°ì¸ì„ ìˆ˜í–‰í•  ë•Œ, ì¤‘ì²© ë£¨í”„ ì¡°ì¸(Nested-Loop Join, NLJ) ì•Œê³ ë¦¬ì¦˜(ë° ê·¸ ë³€í˜•)ì„ ì‚¬ìš©í•œë‹¤. MySQL 8.0.18ë¶€í„°ëŠ” Hash Joinë„ ì§€ì› NLJ : ë°”ê¹¥(outer) í…Œì´ë¸”ì—ì„œ í•œ í–‰ì”© ê°€ì ¸ì™€ ì•ˆìª½(inner) í…Œì´ë¸”ê³¼ ì¡°ì¸í•œë‹¤. outer : driving í…Œì´ë¸” / inner : driven í…Œì´ë¸” ì´ë¼ê³ ë„ ë¶ˆë¦¼ ì´ ê³¼ì •ì€ ì¡°ì¸í•´ì•¼ í•  ëª¨ë“  í…Œì´ë¸”ì— ëŒ€í•´ ë°˜ë³µëœë‹¤. MySQL ì˜µí‹°ë§ˆì´ì €ëŠ” í†µê³„ ì •ë³´(í…Œì´ë¸” í¬ê¸°, ì¸ë±ìŠ¤ ì¹´ë””ë„ë¦¬í‹° ë“±)ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìë™ìœ¼ë¡œ ì¡°ì¸ ìˆœì„œë¥¼ ì„ íƒí•œë‹¤. í•„ìš”ì‹œ STRAIGHT_JOIN / íŒíŠ¸ë¥¼ ì´ìš©í•´ ê°•ì œí•  ìˆ˜ ìˆë‹¤.FOR each row in Outer { FOR each row in Inner matching join condition { OUTPUT if row satisfies conditions }}NLJ ë¹„êµ ì•Œê³ ë¦¬ì¦˜ ë™ì‘ ë°©ì‹ ì‹œê°„ ë³µì¡ë„ ë¹„ê³  Simple NLJ Outer í–‰ë§ˆë‹¤ Inner ì „ì²´ ìŠ¤ìº” O(N Ã— M) ì¸ë±ìŠ¤ ì—†ê³  ìµœì í™” ë¶ˆê°€í•  ë•Œ (ê±°ì˜ ì•ˆ ì”€) Index NLJ Outer í–‰ë§ˆë‹¤ Inner ì¸ë±ìŠ¤ lookup O(N Ã— logM) ê°€ì¥ ì¼ë°˜ì ì¸ í˜•íƒœ, Inner í…Œì´ë¸”ì— ì¡°ì¸ í‚¤ ì¸ë±ìŠ¤ ì¡´ì¬ (ë°ì´í„°ê°€ ì ì€ í…Œì´ë¸”ì„ outer, ë§ì€ í…Œì´ë¸”ì„ innerë¡œ ë‘ëŠ” ê²ƒì´ íš¨ìœ¨ì ) Block NLJ Outer ì—¬ëŸ¬ í–‰ì„ ë©”ëª¨ë¦¬ì— ë‹´ì•„ Inner í•œ ë²ˆ ìŠ¤ìº” O(N Ã— M) (buffer ìµœì í™”) Innerì— ì¸ë±ìŠ¤ ì—†ìŒ, join_buffer_size í™œìš© Batched Key Access Outer ì—¬ëŸ¬ í‚¤ë¥¼ ëª¨ì•„ batchë¡œ ì¸ë±ìŠ¤ lookup O(N Ã— logM) (batched) MySQL 5.6+, optimizer_switch='batched_key_access=on' Hybrid / Pushdown ë³€í˜• ì¡°ê±´ì„ ê°€ëŠ¥í•œ ë°”ê¹¥ ë£¨í”„ë¡œ ì´ë™ N/A (ìƒí™© ì˜ì¡´) EXISTS, IN ì„œë¸Œì¿¼ë¦¬ ìµœì í™” ë“± â€» ì°¸ê³  : Block NLJëŠ” ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤. ê³µì‹ ë¬¸ì„œ Hash Join Optimization ë¶€ë¶„ ì°¸ê³  MySQL 8.0.20 ë²„ì „ ì´í›„ë¶€í„°, Block Nested Loopê°€ ë” ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•Šìœ¼ë©°, ì´ì „ê¹Œì§€ Block Nested Loopì´ ì‚¬ìš©ë˜ë˜ ê²½ìš°ì—ëŠ” ì–¸ì œë‚˜ Hash Joinì´ ëŒ€ì‹  ì‚¬ìš©ëœë‹¤.INNER JOINê³¼ NLJSELECT * FROM T1 INNER JOIN T2 ON T1.id = T2.id INNER JOIN T3 ON T2.key = T3.keyWHERE T1.value &gt; 100 AND T2.status = 'ACTIVE' AND T3.type = 'X';FOR each t1 in T1 such that (t1.value &gt; 100) { -- T1ì—ì„œ ë°”ë¡œ í•„í„°ë§ FOR each t2 in T2 such that (t1.id = t2.id AND t2.status='ACTIVE') { -- T2 ë£¨í”„ì—ì„œ ë°”ë¡œ í•„í„°ë§ FOR each t3 in T3 such that (t2.key = t3.key AND t3.type='X') { -- T3 ë£¨í”„ì—ì„œ ë°”ë¡œ í•„í„°ë§ OUTPUT t1||t2||t3 } }} INNER JOINì€ ì˜µí‹°ë§ˆì´ì €ê°€ ìˆœì„œë¥¼ ììœ ë¡­ê²Œ ë°”ê¿€ ìˆ˜ ìˆë‹¤. (T1 â†’ T2 â†’ T3 or T3 â†’ T2 â†’ T1 ë“±)ì¡°ê±´ í‘¸ì‹œë‹¤ìš´ (Condition Pushdown) WHERE ì¡°ê±´ì€ ê°€ëŠ¥í•œ ê²½ìš° ë°”ê¹¥ ë£¨í”„ë¡œ ì˜¬ë ¤ í‰ê°€ëœë‹¤. ì¡°ê±´ì´ ì°¸ì¡°í•˜ëŠ” ì»¬ëŸ¼ì´ ì´ë¯¸ ì½í˜€ ìˆëŠ” í…Œì´ë¸”ì—ë§Œ ì˜ì¡´í•œë‹¤ë©´, ê·¸ ì¡°ê±´ì€ ë” ë°”ê¹¥ìª½ ë£¨í”„ë¡œ ëŒì–´ì˜¬ë ¤ í‰ê°€í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ê° ë‹¨ê³„ì—ì„œ row ìˆ˜ë¥¼ ì¤„ì—¬, ë‚´ë¶€ ë£¨í”„ì˜ ë¶ˆí•„ìš”í•œ ë°˜ë³µì„ ì¤„ì¸ë‹¤. ìœ„ ì¿¼ë¦¬ì—ì„œ T1.value &gt; 100 ì¡°ê±´ì€, T1 í…Œì´ë¸”ì˜ ì»¬ëŸ¼ë§Œ ì¡°ê±´ì— ìˆìœ¼ë¯€ë¡œ T1ì„ ì½ëŠ” ê°€ì¥ ë°”ê¹¥ ë£¨í”„ì—ì„œ ë°”ë¡œ í•„í„°ë§ ê°€ëŠ¥. í‘¸ì‹œë‹¤ìš´ ë¶ˆê°€ëŠ¥í•œ ê²½ìš° : T1.value &gt; T2.some_val ë‘ í…Œì´ë¸”ì´ ëª¨ë‘ ì½íŒ ë’¤ì—ë§Œ í‰ê°€ ê°€ëŠ¥. FOR each t1 in T1 { FOR each t2 in T2 such that (T1.id = T2.id AND T1.value &gt; T2.some_val) { ... }} WHERE ì ˆì— ìˆëŠ” ì¡°ê±´ë“¤ì„ ë³´ê³ , ì–´ë–¤ ì¡°ê±´ì„ ì–´ëŠ ì‹œì ì—ì„œ í‰ê°€í•´ì•¼ ê°€ì¥ íš¨ìœ¨ì ì¸ì§€ INNER JOIN / OUTER JOINì˜ ì œì•½ ì¡°ê±´ì„ ë§Œì¡±í•˜ë©´ì„œ í‘¸ì‹œ ê°€ëŠ¥í•œì§€ë¥¼ ì˜µí‹°ë§ˆì´ì €ê°€ íŒë‹¨í•œë‹¤.OUTER JOINê³¼ NLJ OUTER JOINì—ì„œëŠ” NULL ë³´ì™„(NULL-complemented row)ì´ ì¶”ê°€ëœë‹¤. ì™¸ë¶€ í…Œì´ë¸”ì˜ ê° í–‰ì— ëŒ€í•´ ë‚´ë¶€ í…Œì´ë¸”ê³¼ ë§¤ì¹­ì´ ì—†ìœ¼ë©´ NULLë¡œ ì±„ìš´ í–‰ì´ ìƒì„±ëœë‹¤. ë”°ë¼ì„œ OUTER JOINì€ ì¡°ì¸ ìˆœì„œê°€ ê°•ì œëœë‹¤. (ì™¸ë¶€ í…Œì´ë¸”ì´ ë°˜ë“œì‹œ ë°”ê¹¥ ë£¨í”„ì— ìœ„ì¹˜) ë§¤ì¹­ì´ ì‹¤ì œ ë°œìƒí–ˆì„ ë•Œë§Œ ì¡°ê±´ì„ ì ìš©í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì—(ë§¤ì¹­ ì—†ì„ ë•ŒëŠ” NULL ë³´ì™„ í–‰ì„ ì‚´ë ¤ì•¼ í•˜ë¯€ë¡œ), INNER JOINì²˜ëŸ¼ ì¡°ê±´ í‘¸ì‹œë‹¤ìš´ì„ ë‹¨ìˆœ ì ìš©í•  ìˆ˜ ì—†ë‹¤. í”Œë˜ê·¸(flag) ê¸°ë°˜ ì¡°ê±´ë¶€ í‘¸ì‹œë‹¤ìš´ì„ ì‚¬ìš©í•œë‹¤. SELECT * FROM T1 LEFT JOIN T2 ON T1.id = T2.id AND T2.status = 'ACTIVE' -- C2 LEFT JOIN T3 ON T2.key = T3.key AND T3.type = 'X' -- C3WHERE T1.value &gt; 100; -- C1FOR each t1 in T1 such that (t1.value &gt; 100) { -- C1ì€ T1ì—ì„œ ë°”ë¡œ í‰ê°€ ê°€ëŠ¥ f1 := FALSE -- t1ì´ T2ì™€ ë§¤ì¹­ëëŠ”ì§€ ì—¬ë¶€ FOR each t2 in T2 such that (t1.id = t2.id) { f2 := FALSE -- (t1,t2)ê°€ T3ì™€ ë§¤ì¹­ëëŠ”ì§€ ì—¬ë¶€ FOR each t3 in T3 such that (t2.key = t3.key) { IF (t2.status='ACTIVE' AND t3.type='X') { -- ë§¤ì¹­ëœ ê²½ìš°ì—ë§Œ ì¡°ê±´ ê²€ì‚¬ OUTPUT t1||t2||t3 } f2 = TRUE f1 = TRUE } IF !f2 { -- T3 ë§¤ì¹­ì´ ì—†ì„ ë•Œ IF (t2.status='ACTIVE') { -- T2 ë§¤ì¹­ì€ ìˆì—ˆìœ¼ë¯€ë¡œ, ì¡°ê±´ë¶€ í‰ê°€ OUTPUT t1||t2||NULL } f1 = TRUE } } IF !f1 { -- T2 ë§¤ì¹­ì´ ì•„ì˜ˆ ì—†ì„ ë•Œ OUTPUT t1||NULL||NULL -- T2, T3 NULL ë³´ì™„ í–‰ ì¶œë ¥ -- ë‹¨, WHERE ì¡°ê±´ì—ì„œ C2, C3ëŠ” í‰ê°€í•˜ì§€ ì•ŠìŒ (NULL ë³´ì™„ì´ë¯€ë¡œ ë¬´ì¡°ê±´ í†µê³¼) }}ì •ë¦¬ JOIN ì‚¬ìš©ì‹œ ìƒê°í•´ë³¼ë§Œí•œ ê²ƒë“¤ inner í…Œì´ë¸”ì„ ì¸ë±ìŠ¤ íƒìƒ‰í•˜ëŠ”ì§€, outer / inner ìˆœì„œëŠ” ì ì ˆí•œì§€ í™•ì¸í•˜ì. ê°€ëŠ¥í•˜ë©´ í‘¸ì‹œë‹¤ìš´ì´ ì˜ ì ìš©(ìµœëŒ€í•œ ë§ì€ í–‰ì„ ì‚¬ì „ í•„í„°ë§)ë  ìˆ˜ ìˆë„ë¡ WHERE ì¡°ê±´ì„ êµ¬ì„±í•˜ì. ì¦‰, WHERE ì¡°ê±´ì´ ìµœëŒ€í•œ ì¼ì°(outer ë£¨í”„) í‰ê°€ë  ìˆ˜ ìˆë„ë¡ OUTER JOIN ì‚¬ìš©ì‹œ: ì´ ì¡°ì¸ì—ì„œ NULL ë³´ì™„ì´ ì •ë§ í•„ìš”í•œì§€, WHERE ì¡°ê±´ ë•Œë¬¸ì— ì–´ì°¨í”¼ INNER JOINì²˜ëŸ¼ ë™ì‘í•˜ì§€ ì•ŠëŠ”ì§€ ìƒê°í•´ë³´ì. ê°€ëŠ¥í•˜ë©´ INNER JOINìœ¼ë¡œ ë‹¨ìˆœí™”í•´ì„œ ì˜µí‹°ë§ˆì´ì €ê°€ ì¡°ì¸ ìˆœì„œ ìµœì í™”, ì¡°ê±´ í‘¸ì‹œë‹¤ìš´ì„ ìµœëŒ€í•œ í™œìš©í•˜ë„ë¡ ìœ ë„. ì¦‰, OUTER JOINì´ ì •ë§ í•„ìš”í•œì§€ ìƒê°í•´ë³´ì. ì°¸ê³  ìë£Œ https://dev.mysql.com/doc/refman/8.4/en/nested-loop-joins.html https://dev.mysql.com/doc/refman/8.4/en/nested-join-optimization.html" }, { "title": "ì˜¤ëŠ˜ ë“œëŠ” ìƒê° (250923, ì •ë‹µ)", "url": "/posts/daily-note-250923/", "categories": "ë„ì ë„ì ", "tags": "", "date": "2025-09-23 22:00:00 +0900", "snippet": "ì •ë‹µì„ ì°¾ëŠ”ë° ê¸‰ê¸‰í•´í•˜ì§€ ì•Šê³ , ì •ë‹µì´ ì•„ë‹ˆë©´ ì–´ì©Œë‚˜ ë¶ˆì•ˆí•´í•˜ì§€ ì•Šê³ , ì ì ˆí•œ ê·¼ê±°ì™€ ë…¼ë¦¬ì— ê¸°ë°˜í•œ ë‚´ ìƒê°ì„ ê°–ê³  ì‚´ ìˆ˜ ìˆê¸°ë¥¼.", "content": "ì •ë‹µì„ ì°¾ëŠ”ë° ê¸‰ê¸‰í•´í•˜ì§€ ì•Šê³ , ì •ë‹µì´ ì•„ë‹ˆë©´ ì–´ì©Œë‚˜ ë¶ˆì•ˆí•´í•˜ì§€ ì•Šê³ , ì ì ˆí•œ ê·¼ê±°ì™€ ë…¼ë¦¬ì— ê¸°ë°˜í•œ ë‚´ ìƒê°ì„ ê°–ê³  ì‚´ ìˆ˜ ìˆê¸°ë¥¼." }, { "title": "Spring Batch - Step ê°œë…", "url": "/posts/spring-batch-step/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Spring Batch", "date": "2025-09-18 22:00:00 +0900", "snippet": "ê°œë…Step Batch Jobì„ êµ¬ì„±í•˜ëŠ” ë…ë¦½ëœ ì‘ì—… BATCH_STEP_EXECUTION í…Œì´ë¸”ì— ì €ì¥ë¨ í•´ë‹¹ Stepì„ í¬í•¨í•˜ëŠ” JobExecution ì •ë³´(JOB_EXECUTION_ID)ë„ ê¸°ë¡ë¨ package org.springframework.batch.core;public interface Step {\tStrin...", "content": "ê°œë…Step Batch Jobì„ êµ¬ì„±í•˜ëŠ” ë…ë¦½ëœ ì‘ì—… BATCH_STEP_EXECUTION í…Œì´ë¸”ì— ì €ì¥ë¨ í•´ë‹¹ Stepì„ í¬í•¨í•˜ëŠ” JobExecution ì •ë³´(JOB_EXECUTION_ID)ë„ ê¸°ë¡ë¨ package org.springframework.batch.core;public interface Step {\tString STEP_TYPE_KEY = \"batch.stepType\";\tString getName();\tdefault boolean isAllowStartIfComplete() {\t\treturn false;\t}\tdefault int getStartLimit() {\t\treturn Integer.MAX_VALUE;\t}\tvoid execute(StepExecution stepExecution) throws JobInterruptedException;}@Beanpublic Step step1(JobRepository jobRepository, PlatformTransactionManager transactionManager, FlatFileItemReader&lt;Person&gt; reader, PersonItemProcessor processor, JdbcBatchItemWriter&lt;Person&gt; writer) { return new StepBuilder(\"step1\", jobRepository) .&lt;Person, Person&gt;chunk(2, transactionManager) .reader(reader) .processor(processor) .writer(writer) .allowStartIfComplete(true) .build();}// org.springframework.batch.core.job.SimpleJob#doExecute@Overrideprotected void doExecute(JobExecution execution)\t\tthrows JobInterruptedException, JobRestartException, StartLimitExceededException {\tStepExecution stepExecution = null;\tfor (Step step : steps) {\t\tstepExecution = handleStep(step, execution);\t\tif (stepExecution.getStatus() != BatchStatus.COMPLETED) {\t\t\t//\t\t\t// Terminate the job if a step fails\t\t\t//\t\t\tbreak;\t\t}\t}\t//\t// Update the job status to be the same as the last step\t//\tif (stepExecution != null) {\t\tif (logger.isDebugEnabled()) {\t\t\tlogger.debug(\"Upgrading JobExecution status: \" + stepExecution);\t\t}\t\texecution.upgradeStatus(stepExecution.getStatus());\t\texecution.setExitStatus(stepExecution.getExitStatus());\t}}StepExecution Step ì‹¤í–‰ ì •ë³´ë¥¼ ë‹´ê³ ìˆëŠ” ê°ì²´ í”„ë¡œí¼í‹° ì •ì˜ status ì‹¤í–‰ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” BatchStatus ê°ì²´. ì‹¤í–‰ ì¤‘ì´ë©´ STARTED, ì‹¤íŒ¨í•˜ë©´ FAILED, ì„±ê³µí•˜ë©´ COMPLETED. startTime java.time.LocalDateTime ì‹¤í–‰ì´ ì‹œì‘ëœ ì‹œê°„. Stepì´ ì‹œì‘ë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë¹„ì–´ ìˆìŒ. endTime java.time.LocalDateTime ì‹¤í–‰ì´ ì¢…ë£Œëœ ì‹œê°„ (ì„±ê³µ/ì‹¤íŒ¨ ì—¬ë¶€ì™€ ê´€ê³„ì—†ìŒ). Stepì´ ì•„ì§ ì¢…ë£Œë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë¹„ì–´ ìˆìŒ. exitStatus ì‹¤í–‰ ê²°ê³¼ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ExitStatus. ì¢…ë£Œ ì½”ë“œë¥¼ í¬í•¨í•´ í˜¸ì¶œìì—ê²Œ ë°˜í™˜ë¨. Jobì´ ì•„ì§ ì¢…ë£Œë˜ì§€ ì•Šì•˜ë‹¤ë©´ ë¹„ì–´ ìˆìŒ. executionContext ì‹¤í–‰ ê°„ì— ìœ ì§€í•´ì•¼ í•  ì‚¬ìš©ì ë°ì´í„°ë¥¼ ë‹´ëŠ” â€œproperty bagâ€. readCount ì„±ê³µì ìœ¼ë¡œ ì½ì€ ì•„ì´í…œ ìˆ˜. writeCount ì„±ê³µì ìœ¼ë¡œ ê¸°ë¡(write)í•œ ì•„ì´í…œ ìˆ˜. commitCount ì´ ì‹¤í–‰ì—ì„œ ì»¤ë°‹ëœ íŠ¸ëœì­ì…˜ ìˆ˜. rollbackCount Stepì´ ì œì–´í•˜ëŠ” íŠ¸ëœì­ì…˜ì´ ë¡¤ë°±ëœ íšŸìˆ˜. readSkipCount ì½ê¸° ì‹¤íŒ¨ë¡œ ì¸í•´ ìŠ¤í‚µëœ íšŸìˆ˜. processSkipCount ì²˜ë¦¬ ì‹¤íŒ¨ë¡œ ì¸í•´ ìŠ¤í‚µëœ íšŸìˆ˜. filterCount ItemProcessorì— ì˜í•´ â€œí•„í„°ë§â€ëœ ì•„ì´í…œ ìˆ˜. writeSkipCount ì“°ê¸° ì‹¤íŒ¨ë¡œ ì¸í•´ ìŠ¤í‚µëœ íšŸìˆ˜. BatchStatus vs ExitStatus ë³´í†µì€ BatchStatusì™€ ExitStatusê°€ ëª¨ë‘ COMPLETEDì´ê±°ë‚˜ FAILED Jobì€ ì •ìƒ ìˆ˜í–‰ë˜ì—ˆì§€ë§Œ, ì•„ë¬´ ì²˜ë¦¬ë„ í•˜ì§€ ì•Šì€ ê²½ìš°ì—ëŠ” BatchStatusëŠ” COMPLETED, ExitStatusëŠ” NOOPì¼ìˆ˜ë„ ìˆë‹¤. ì¢€ ë” ì„¸ë¶€ì ìœ¼ë¡œ ì²˜ë¦¬ê°€ í•„ìš”í•œ ê²½ìš° ExitStatusëŠ” ì»¤ìŠ¤í„°ë§ˆì´ì§•ì´ ê°€ëŠ¥í•˜ë‹¤. BatchStatus enum, ExitStatusëŠ” class package org.springframework.batch.core;public enum BatchStatus { COMPLETED, STARTING, STARTED, STOPPING, STOPPED, FAILED, ABANDONED, UNKNOWN; ...}package org.springframework.batch.core;...public class ExitStatus implements Serializable, Comparable&lt;ExitStatus&gt; { public static final ExitStatus UNKNOWN = new ExitStatus(\"UNKNOWN\"); public static final ExitStatus EXECUTING = new ExitStatus(\"EXECUTING\"); public static final ExitStatus COMPLETED = new ExitStatus(\"COMPLETED\"); public static final ExitStatus NOOP = new ExitStatus(\"NOOP\"); public static final ExitStatus FAILED = new ExitStatus(\"FAILED\"); public static final ExitStatus STOPPED = new ExitStatus(\"STOPPED\"); private final String exitCode; private final String exitDescription; public ExitStatus(String exitCode) { this(exitCode, \"\"); } public ExitStatus(String exitCode, String exitDescription) { super(); this.exitCode = exitCode; this.exitDescription = exitDescription == null ? \"\" : exitDescription; } ...} ì˜ˆ: ìƒí™© BatchStatus ExitStatus ì„¤ëª… ì •ìƒ ì²˜ë¦¬ ì™„ë£Œ COMPLETED COMPLETED ì•„ë¬´ ë¬¸ì œ ì—†ìŒ ì²˜ë¦¬ ì¤‘ ì‹¤íŒ¨ FAILED FAILED ì‹œìŠ¤í…œ ì˜¤ë¥˜ ë“±ìœ¼ë¡œ ì‹¤íŒ¨ ë°ì´í„° ì—†ìŒ COMPLETED NO DATA ì‹œìŠ¤í…œ ì…ì¥ì—ì„œëŠ” ì„±ê³µì ìœ¼ë¡œ ëë‚¬ì§€ë§Œ, ì²˜ë¦¬í•  ë°ì´í„°ê°€ ì—†ìŒ ì¼ë¶€ ìŠ¤í‚µ ë°œìƒ COMPLETED COMPLETED WITH SKIPS í”„ë ˆì„ì›Œí¬ëŠ” ì •ìƒ ì¢…ë£Œë¡œ ë³´ì§€ë§Œ, ë¹„ì¦ˆë‹ˆìŠ¤ìƒ ê²½ê³ ê°€ í•„ìš”í•¨ ì¬ì²˜ë¦¬ í•„ìš” COMPLETED RETRY NEEDED ì‹¤í–‰ ìì²´ëŠ” ì™„ë£Œë˜ì—ˆì§€ë§Œ, íŠ¹ì • ì¡°ê±´ìœ¼ë¡œ ì¸í•´ ë‹¤ì‹œ ëŒë ¤ì•¼ í•¨ Tasklet Chunk ê¸°ë°˜(reader â†’ processor â†’ writer) ì²˜ë¦¬ê°€ êµ³ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê²½ìš° (ì˜ˆ: DB stored procedure í˜¸ì¶œ, ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰, ë‹¨ìˆœ SQL update/delete batch ë“±) Tasklet ê¸°ë°˜ Stepì„ ì‚¬ìš©í•˜ë©´ Tasklet ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ê°ì²´ì˜ execute ë©”ì„œë“œë¥¼ ì‹¤í–‰í•œë‹¤.// org.springframework.batch.core.step.tasklet.Tasklet@FunctionalInterfacepublic interface Tasklet {\t@Nullable\tRepeatStatus execute(StepContribution contribution, ChunkContext chunkContext) throws Exception;} MethodInvokingTaskletAdapter ì‚¬ìš©@Beanpublic MethodInvokingTaskletAdapter myTasklet() {\tMethodInvokingTaskletAdapter adapter = new MethodInvokingTaskletAdapter();\tadapter.setTargetObject(fooDao());\tadapter.setTargetMethod(\"updateFoo\");\treturn adapter;} Tasklet ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„public class DemoTasklet implements Tasklet { @Override public RepeatStatus execute(StepContribution contribution, ChunkContext chunkContext) throws Exception { // doSomething return null; }}ì½”ë“œ ì‚´í´ë³´ê¸° TaskletStepBuilder ì‚¬ìš© (ì•„ë˜ì—ì„œ ì‹¤í´ë³¼ Chunk ê¸°ë°˜ì€ SimpleStepBuilder ì‚¬ìš©)@Beanpublic Step step1(JobRepository jobRepository, PlatformTransactionManager transactionManager, Tasklet demoTasklet) { return new StepBuilder(\"step1\", jobRepository) .tasklet(demoTasklet, transactionManager) .build();}// org.springframework.batch.core.step.builder.StepBuilder#taskletpublic TaskletStepBuilder tasklet(Tasklet tasklet, PlatformTransactionManager transactionManager) {\treturn new TaskletStepBuilder(this).tasklet(tasklet, transactionManager);}// org.springframework.batch.core.step.builder.TaskletStepBuilder#createTasklet@Overrideprotected Tasklet createTasklet() {\treturn tasklet;}Chunk ì²­í¬ ì§€í–¥ ì²˜ë¦¬ë€, ë°ì´í„°ë¥¼ í•œ ë²ˆì— í•˜ë‚˜ì”©(ItemReader) ì½ê³ , ì½ì€ ë°ì´í„°ë¥¼ ëª¨ì•„ì„œ ì²­í¬(chunk)ë¥¼ ë§Œë“œëŠ” ë°©ì‹. ì´ë ‡ê²Œ ëª¨ì€ ì²­í¬ëŠ” í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ ê²½ê³„ ì•ˆì—ì„œ ItemWriterë¥¼ í†µí•´ í•œë²ˆì— ì“°ì—¬ì§„ë‹¤. ì½ì€ ì•„ì´í…œì˜ ê°œìˆ˜ê°€ ì»¤ë°‹ ê°„ê²©(commit interval)ì— ë„ë‹¬í•˜ë©´, ItemWriterê°€ ì²­í¬ ì „ì²´ë¥¼ ê¸°ë¡í•˜ê³ , ê·¸ ì‹œì ì— íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹ëœë‹¤. Reader -&gt; Processor -&gt; Writer ì˜ì‚¬ ì½”ë“œList items = new Arraylist();for(int i = 0; i &lt; commitInterval; i++){ Object item = itemReader.read(); if (item != null) { items.add(item); }}List processedItems = new Arraylist();for(Object item: items){ Object processedItem = itemProcessor.process(item); if (processedItem != null) { processedItems.add(processedItem); }}itemWriter.write(processedItems);ì½”ë“œ ì‚´í´ë³´ê¸° SimpleStepBuilder ì‚¬ìš©@Beanpublic Step step1(JobRepository jobRepository, PlatformTransactionManager transactionManager, FlatFileItemReader&lt;Person&gt; reader, PersonItemProcessor processor, JdbcBatchItemWriter&lt;Person&gt; writer) { return new StepBuilder(\"step1\", jobRepository) .&lt;Person, Person&gt;chunk(2, transactionManager) .reader(reader) .processor(processor) .writer(writer) .allowStartIfComplete(true) .build();}// org.springframework.batch.core.step.builder.SimpleStepBuilder#chunk(int)public SimpleStepBuilder&lt;I, O&gt; chunk(int chunkSize) {\tAssert.state(completionPolicy == null || chunkSize == 0,\t\t\t\"You must specify either a chunkCompletionPolicy or a commitInterval but not both.\");\tthis.chunkSize = chunkSize;\treturn this;} FaultTolerantStepBuilder ì¶”ê°€ ê°€ëŠ¥@Beanpublic Step step1(JobRepository jobRepository, PlatformTransactionManager transactionManager, FlatFileItemReader&lt;Person&gt; reader, PersonItemProcessor processor, JdbcBatchItemWriter&lt;Person&gt; writer) { Step step1 = new StepBuilder(\"step1\", jobRepository) .&lt;Person, Person&gt;chunk(2, transactionManager) .reader(reader) .processor(processor) .writer(writer) .allowStartIfComplete(true) .faultTolerant() .skip() .retry() .reader() .build(); return step1;}// org.springframework.batch.core.step.builder.SimpleStepBuilder#faultTolerantpublic FaultTolerantStepBuilder&lt;I, O&gt; faultTolerant() {\treturn new FaultTolerantStepBuilder&lt;&gt;(this);} ChunkOrientedTasklet êµ¬í˜„ì²´ ìƒì„±// org.springframework.batch.core.step.builder.AbstractTaskletStepBuilderprotected abstract Tasklet createTasklet();public TaskletStep build() {\tregisterStepListenerAsChunkListener();\tTaskletStep step = new TaskletStep(getName());\tsuper.enhance(step);\tstep.setChunkListeners(chunkListeners.toArray(new ChunkListener[0]));\tif (this.transactionManager != null) {\t\tstep.setTransactionManager(this.transactionManager);\t}\tif (transactionAttribute != null) {\t\tstep.setTransactionAttribute(transactionAttribute);\t}\tif (stepOperations == null) {\t\tstepOperations = new RepeatTemplate();\t\tif (taskExecutor != null) {\t\t\tTaskExecutorRepeatTemplate repeatTemplate = new TaskExecutorRepeatTemplate();\t\t\trepeatTemplate.setTaskExecutor(taskExecutor);\t\t\trepeatTemplate.setThrottleLimit(throttleLimit);\t\t\tstepOperations = repeatTemplate;\t\t}\t\t((RepeatTemplate) stepOperations).setExceptionHandler(exceptionHandler);\t}\tstep.setStepOperations(stepOperations);\tstep.setTasklet(createTasklet()); // Tasklet êµ¬í˜„ì²´ ë§Œë“¤ê¸°\tstep.setStreams(streams.toArray(new ItemStream[0]));\ttry {\t\tstep.afterPropertiesSet();\t}\tcatch (Exception e) {\t\tthrow new StepBuilderException(e);\t}\treturn step;}// org.springframework.batch.core.step.builder.SimpleStepBuilder#createTasklet@Overrideprotected Tasklet createTasklet() {\tAssert.state(reader != null, \"ItemReader must be provided\");\tAssert.state(writer != null, \"ItemWriter must be provided\");\tRepeatOperations repeatOperations = createChunkOperations();\tSimpleChunkProvider&lt;I&gt; chunkProvider = new SimpleChunkProvider&lt;&gt;(getReader(), repeatOperations);\tSimpleChunkProcessor&lt;I, O&gt; chunkProcessor = new SimpleChunkProcessor&lt;&gt;(getProcessor(), getWriter());\tchunkProvider.setListeners(new ArrayList&lt;&gt;(itemListeners));\tchunkProvider.setMeterRegistry(this.meterRegistry);\tchunkProcessor.setListeners(new ArrayList&lt;&gt;(itemListeners));\tchunkProcessor.setMeterRegistry(this.meterRegistry);\tChunkOrientedTasklet&lt;I&gt; tasklet = new ChunkOrientedTasklet&lt;&gt;(chunkProvider, chunkProcessor);\ttasklet.setBuffering(!readerTransactionalQueue);\treturn tasklet;} ChunkOrientedTaskletë„ ê²°êµ­ Taskletì„ êµ¬í˜„í•œ í´ë˜ìŠ¤public class ChunkOrientedTasklet&lt;I&gt; implements Tasklet { ... @Nullable @Override public RepeatStatus execute(StepContribution contribution, ChunkContext chunkContext) throws Exception { @SuppressWarnings(\"unchecked\") Chunk&lt;I&gt; inputs = (Chunk&lt;I&gt;) chunkContext.getAttribute(INPUTS_KEY); if (inputs == null) { inputs = chunkProvider.provide(contribution); if (buffering) { chunkContext.setAttribute(INPUTS_KEY, inputs); } } chunkProcessor.process(contribution, inputs); chunkProvider.postProcess(contribution, inputs); // Allow a message coming back from the processor to say that we // are not done yet if (inputs.isBusy()) { logger.debug(\"Inputs still busy\"); return RepeatStatus.CONTINUABLE; } chunkContext.removeAttribute(INPUTS_KEY); chunkContext.setComplete(); if (logger.isDebugEnabled()) { logger.debug(\"Inputs not busy, ended: \" + inputs.isEnd()); } return RepeatStatus.continueIf(!inputs.isEnd()); }}ì‹¤í–‰ íë¦„// org.springframework.batch.core.job.SimpleStepHandler#handleStep@Overridepublic StepExecution handleStep(Step step, JobExecution execution)\t\tthrows JobInterruptedException, JobRestartException, StartLimitExceededException { ...\tif (shouldStart(lastStepExecution, execution, step)) {\t\tcurrentStepExecution = execution.createStepExecution(step.getName()); ...\t\ttry {\t\t\tstep.execute(currentStepExecution);\t\t\tcurrentStepExecution.getExecutionContext().put(\"batch.executed\", true);\t\t} ...\t}\treturn currentStepExecution;}// org.springframework.batch.core.step.AbstractStep#execute@Overridepublic final void execute(StepExecution stepExecution)\t\tthrows JobInterruptedException, UnexpectedJobExecutionException { ...\ttry (Observation.Scope scope = observation.openScope()) {\t\tgetCompositeListener().beforeStep(stepExecution);\t\topen(stepExecution.getExecutionContext());\t\ttry {\t\t\tdoExecute(stepExecution);\t\t}\t\tcatch (RepeatException e) {\t\t\tthrow e.getCause();\t\t}\t\texitStatus = ExitStatus.COMPLETED.and(stepExecution.getExitStatus()); ...\t}}protected abstract void doExecute(StepExecution stepExecution) throws Exception; Tasklet.executeëŠ” í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‹¤í–‰ëœë‹¤. (TransactionTemplate.executeì˜ ì½œë°± ë©”ì„œë“œë¡œ í˜¸ì¶œë˜ëŠ” ChunkTransactionCallback#doInTransactionë‚´ì—ì„œ Tasklet.executeê°€ í˜¸ì¶œë¨) stepOperations.iterate(new StepContextRepeatCallback(stepExecution) { ... }ë¥¼ í†µí•´ chunk ë‹¨ìœ„ë¡œ ë°˜ë³µ (ë”°ë¼ì„œ, chunk ë‹¨ìœ„ë¡œ íŠ¸ëœì­ì…˜ ë³´ì¥ë¨)// org.springframework.batch.core.step.tasklet.TaskletStep#doExecute@Overrideprotected void doExecute(StepExecution stepExecution) throws Exception { ...\t// Shared semaphore per step execution, so other step executions can run\t// in parallel without needing the lock\tfinal Semaphore semaphore = createSemaphore();\tstepOperations.iterate(new StepContextRepeatCallback(stepExecution) {\t\t@Override\t\tpublic RepeatStatus doInChunkContext(RepeatContext repeatContext, ChunkContext chunkContext)\t\t\t\tthrows Exception {\t\t\tStepExecution stepExecution = chunkContext.getStepContext().getStepExecution();\t\t\t// Before starting a new transaction, check for\t\t\t// interruption.\t\t\tinterruptionPolicy.checkInterrupted(stepExecution);\t\t\tRepeatStatus result;\t\t\ttry {\t\t\t\tresult = new TransactionTemplate(transactionManager, transactionAttribute)\t\t\t\t\t.execute(new ChunkTransactionCallback(chunkContext, semaphore));\t\t\t}\t\t\tcatch (UncheckedTransactionException e) {\t\t\t\t// Allow checked exceptions to be thrown inside callback\t\t\t\tthrow (Exception) e.getCause();\t\t\t}\t\t\tchunkListener.afterChunk(chunkContext);\t\t\t// Check for interruption after transaction as well, so that\t\t\t// the interrupted exception is correctly propagated up to\t\t\t// caller\t\t\tinterruptionPolicy.checkInterrupted(stepExecution);\t\t\treturn result == null ? RepeatStatus.FINISHED : result;\t\t}\t});}// org.springframework.batch.core.step.tasklet.TaskletStep.ChunkTransactionCallback#doInTransaction@Overridepublic RepeatStatus doInTransaction(TransactionStatus status) {\tTransactionSynchronizationManager.registerSynchronization(this);\tRepeatStatus result = RepeatStatus.CONTINUABLE;\tStepContribution contribution = stepExecution.createStepContribution();\tchunkListener.beforeChunk(chunkContext);\t// In case we need to push it back to its old value\t// after a commit fails...\toldVersion = new StepExecution(stepExecution.getStepName(), stepExecution.getJobExecution());\tcopy(stepExecution, oldVersion);\ttry {\t\ttry {\t\t\ttry {\t\t\t\tresult = tasklet.execute(contribution, chunkContext);\t\t\t\tif (result == null) {\t\t\t\t\tresult = RepeatStatus.FINISHED;\t\t\t\t}\t\t\t}\t\t\tcatch (Exception e) {\t\t\t\tif (transactionAttribute.rollbackOn(e)) {\t\t\t\t\tchunkContext.setAttribute(ChunkListener.ROLLBACK_EXCEPTION_KEY, e);\t\t\t\t\tthrow e;\t\t\t\t}\t\t\t}\t\t}\t\tfinally {\t\t\t// If the step operations are asynchronous then we need\t\t\t// to synchronize changes to the step execution (at a\t\t\t// minimum). Take the lock *before* changing the step\t\t\t// execution.\t\t\ttry {\t\t\t\tsemaphore.acquire();\t\t\t\tlocked = true;\t\t\t}\t\t\tcatch (InterruptedException e) {\t\t\t\tlogger.error(\"Thread interrupted while locking for repository update\");\t\t\t\tstepExecution.setStatus(BatchStatus.STOPPED);\t\t\t\tstepExecution.setTerminateOnly();\t\t\t\tThread.currentThread().interrupt();\t\t\t}\t\t\t// Apply the contribution to the step\t\t\t// even if unsuccessful\t\t\tif (logger.isDebugEnabled()) {\t\t\t\tlogger.debug(\"Applying contribution: \" + contribution);\t\t\t}\t\t\tstepExecution.apply(contribution);\t\t}\t\tstepExecutionUpdated = true;\t\tstream.update(stepExecution.getExecutionContext());\t\ttry {\t\t\t// Going to attempt a commit. If it fails this flag will\t\t\t// stay false and we can use that later.\t\t\tif (stepExecution.getExecutionContext().isDirty()) {\t\t\t\tgetJobRepository().updateExecutionContext(stepExecution);\t\t\t}\t\t\tstepExecution.incrementCommitCount();\t\t\tif (logger.isDebugEnabled()) {\t\t\t\tlogger.debug(\"Saving step execution before commit: \" + stepExecution);\t\t\t}\t\t\tgetJobRepository().update(stepExecution);\t\t}\t\tcatch (Exception e) {\t\t\t// If we get to here there was a problem saving the step\t\t\t// execution and we have to fail.\t\t\tString msg = \"JobRepository failure forcing rollback\";\t\t\tlogger.error(msg, e);\t\t\tthrow new FatalStepExecutionException(msg, e);\t\t}\t}\tcatch (Error e) {\t\tif (logger.isDebugEnabled()) {\t\t\tlogger.debug(\"Rollback for Error: \" + e.getClass().getName() + \": \" + e.getMessage());\t\t}\t\trollback(stepExecution);\t\tthrow e;\t}\tcatch (RuntimeException e) {\t\tif (logger.isDebugEnabled()) {\t\t\tlogger.debug(\"Rollback for RuntimeException: \" + e.getClass().getName() + \": \" + e.getMessage());\t\t}\t\trollback(stepExecution);\t\tthrow e;\t}\tcatch (Exception e) {\t\tif (logger.isDebugEnabled()) {\t\t\tlogger.debug(\"Rollback for Exception: \" + e.getClass().getName() + \": \" + e.getMessage());\t\t}\t\trollback(stepExecution);\t\t// Allow checked exceptions\t\tthrow new UncheckedTransactionException(e);\t}\treturn result;} ë°˜ë³µ í˜¸ì¶œ (stepOperations.iterate) ë‚´ë¶€// org.springframework.batch.repeat.support.RepeatTemplate#iterate@Overridepublic RepeatStatus iterate(RepeatCallback callback) { RepeatContext outer = RepeatSynchronizationManager.getContext(); RepeatStatus result = RepeatStatus.CONTINUABLE; try { // This works with an asynchronous TaskExecutor: the // interceptors have to wait for the child processes. result = executeInternal(callback); } finally { RepeatSynchronizationManager.clear(); if (outer != null) { RepeatSynchronizationManager.register(outer); } } return result;}private RepeatStatus executeInternal(final RepeatCallback callback) { // ë°˜ë³µ ì‹¤í–‰ì„ ìœ„í•œ RepeatContext ìƒì„± (ë£¨í”„ ìƒíƒœ ì¶”ì : ì™„ë£Œ ì—¬ë¶€, ë°˜ë³µ íšŸìˆ˜ ë“±) RepeatContext context = start(); // ì´ë¯¸ complete í‘œì‹œëœ ìƒíƒœë¼ë©´ ì‹¤í–‰ ì•ˆ í•¨ boolean running = !isMarkedComplete(context); // ëª¨ë“  ë¦¬ìŠ¤ë„ˆ(open) í˜¸ì¶œ (ë£¨í”„ ì‹œì‘ ì‹œ 1íšŒ ì‹¤í–‰) for (RepeatListener interceptor : listeners) { interceptor.open(context); // ë¦¬ìŠ¤ë„ˆê°€ complete ì‹œí‚¬ ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ ë‹¤ì‹œ ì²´í¬ running = running &amp;&amp; !isMarkedComplete(context); if (!running) break; } // ê¸°ë³¸ ê²°ê³¼ ìƒíƒœëŠ” CONTINUABLE (ê³„ì† ë°˜ë³µ ê°€ëŠ¥) RepeatStatus result = RepeatStatus.CONTINUABLE; // ë°˜ë³µ ìƒíƒœ ì¶”ì  ê°ì²´ (ì˜ˆì™¸ ëª¨ìŒ, ë¹„ë™ê¸° ê²°ê³¼ ë“±) RepeatInternalState state = createInternalState(context); Collection&lt;Throwable&gt; throwables = state.getThrowables(); // ì‹¤í–‰ ì¤‘ ë°œìƒí•œ ì˜ˆì™¸ ëª¨ìŒ Collection&lt;Throwable&gt; deferred = new ArrayList&lt;&gt;(); // ë‚˜ì¤‘ì— ì¬ë˜ì§ˆ ì¹˜ëª…ì  ì˜ˆì™¸ try { // ë°˜ë³µ ë£¨í”„ ì‹œì‘ (ì¡°ê±´ì´ ë§Œì¡±í•  ë•Œê¹Œì§€ ê³„ì† ì½œë°± ì‹¤í–‰) while (running) { // ê° ë°˜ë³µ(=ì²­í¬ ì‹¤í–‰) ì§ì „ì— before ë¦¬ìŠ¤ë„ˆ í˜¸ì¶œ for (RepeatListener interceptor : listeners) { interceptor.before(context); running = running &amp;&amp; !isMarkedComplete(context); // ì¤‘ê°„ì— complete ê°€ëŠ¥ } // ì—¬ì „íˆ running ìƒíƒœì¼ ë•Œë§Œ ì½œë°± ì‹¤í–‰ if (running) { try { // ì½œë°± ì‹¤í–‰ â†’ ì—¬ê¸°ì„œ ì‹¤ì œë¡œ doInChunkContext í˜¸ì¶œ // ì¦‰, íŠ¸ëœì­ì…˜ ì—´ê³  ì²­í¬ ë‹¨ìœ„ë¡œ ì½ê¸°/ì²˜ë¦¬/ì“°ê¸°/ì»¤ë°‹ ì§„í–‰ result = getNextResult(context, callback, state); // after ë¦¬ìŠ¤ë„ˆ í˜¸ì¶œ executeAfterInterceptors(context, result); } catch (Throwable throwable) { // ì½œë°± ì¤‘ ì˜ˆì™¸ ë°œìƒ ì‹œ ì²˜ë¦¬ (ì¬ì‹œë„/ìŠ¤í‚µ ì •ì±… ë“± ì ìš© ê°€ëŠ¥) doHandle(throwable, context, deferred); } // ë°˜ë³µ ì¢…ë£Œ ì¡°ê±´: // 1) ê²°ê³¼ê°€ FINISHED // 2) contextê°€ complete ìƒíƒœ // 3) deferred ì˜ˆì™¸ ì¡´ì¬ if (isComplete(context, result) || isMarkedComplete(context) || !deferred.isEmpty()) { running = false; } } } // ë¹„ë™ê¸° ì‹¤í–‰ ì‹œ ê²°ê³¼ ê¸°ë‹¤ë¦¬ê¸° result = result.and(waitForResults(state)); // throwables ëª¨ì•„ë‘” ê²ƒ ì²˜ë¦¬ for (Throwable throwable : throwables) { doHandle(throwable, context, deferred); } // ë‚´ë¶€ ìƒíƒœ í•´ì œ state = null; } finally { try { // deferred ì˜ˆì™¸ê°€ ë‚¨ì•„ ìˆë‹¤ë©´ fatal â†’ ê·¸ëŒ€ë¡œ ì¬ë˜ì§ if (!deferred.isEmpty()) { Throwable throwable = deferred.iterator().next(); if (logger.isDebugEnabled()) { logger.debug(\"Handling fatal exception explicitly (rethrowing first of \" + deferred.size() + \"): \" + throwable.getClass().getName() + \": \" + throwable.getMessage()); } rethrow(throwable); } } finally { try { // ëª¨ë“  ë¦¬ìŠ¤ë„ˆ close í˜¸ì¶œ (ë£¨í”„ ì¢…ë£Œ ì‹œì ) for (int i = listeners.length; i-- &gt; 0;) { RepeatListener interceptor = listeners[i]; interceptor.close(context); } } finally { // context ìì› ì •ë¦¬ context.close(); } } } // ìµœì¢… ê²°ê³¼ ë°˜í™˜ (CONTINUABLE or FINISHED) return result;} ë”ì´ìƒ ì½ì„ê²Œ ì—†ìœ¼ë©´, RepeatStatusê°€ FINISHEDë¡œ ëœë‹¤.// org.springframework.batch.core.step.item.ChunkOrientedTasklet#execute@Nullable@Overridepublic RepeatStatus execute(StepContribution contribution, ChunkContext chunkContext) throws Exception {\t@SuppressWarnings(\"unchecked\")\tChunk&lt;I&gt; inputs = (Chunk&lt;I&gt;) chunkContext.getAttribute(INPUTS_KEY);\tif (inputs == null) {\t\tinputs = chunkProvider.provide(contribution);\t\tif (buffering) {\t\t\tchunkContext.setAttribute(INPUTS_KEY, inputs);\t\t}\t} ...\treturn RepeatStatus.continueIf(!inputs.isEnd());}// org.springframework.batch.repeat.RepeatStatuspublic static RepeatStatus continueIf(boolean continuable) {\treturn continuable ? CONTINUABLE : FINISHED;}ì ì ˆí•œ ìƒí™© ìƒê°í•´ë³´ê¸° : Tasklet ê¸°ë°˜ êµ¬ì„± vs Chunk ê¸°ë°˜ êµ¬ì„± ê°ê°ì˜ íŠ¹ì§•ì„ ê³ ë ¤í•´ì„œ ìƒê°í•´ë³´ì Â  Tasklet ê¸°ë°˜ Chunk ê¸°ë°˜ íŠ¹ì§• - Taskletì˜ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ì§ì ‘ ë§Œë“¤ì–´ì„œ ì²˜ë¦¬ - Tasklet.executeê°€ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬ë¨ - ì˜ˆì™¸ ìƒí™©ì—ì„œì˜ ì¬ì‹œë„, skip ì²˜ë¦¬ ë“±ì„ ì§ì ‘ êµ¬í˜„í•´ì•¼í•¨ - Taskletì˜ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ChunkOrientedTaskletë¡œ ì´ë¯¸ ë§Œë“¤ì–´ë†“ìŒ - í•´ë‹¹ êµ¬í˜„ì²´ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ êµ¬ì„±ìš”ì†Œ í•„ìš” (reader, processor, writer) - chunkSize ë‹¨ìœ„ë¡œ íŠ¸ëœì­ì…˜ ë‚˜ëˆ ì„œ ì²˜ë¦¬ë¨ - ì˜ˆì™¸ ìƒí™©ì—ì„œ ì¬ì‹œë„, skip ë“±ì˜ ì²˜ë¦¬ë“¤ì„ ì„¤ì •(skip, retry, retryLimit, backOffPolicy ë“±)ìœ¼ë¡œ í¸ë¦¬í•˜ê²Œ ì²˜ë¦¬ ê°€ëŠ¥ ì ì ˆí•  ê²ƒ ê°™ì€ ìƒí™© - í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬í•´ë„ DBì— ë¶€í•˜ ë° ë½ìœ¼ë¡œ ì¸í•œ ì˜í–¥ë„ê°€ í¬ì§€ ì•Šì€ ê²½ìš° - êµ³ì´ chunk ë‹¨ìœ„ë¡œ ì‘ì—…í•  í•„ìš”ê°€ ì—†ëŠ” ê²½ìš° (íŠ¹ì • ì¼ìì˜ íŒŒì¼ ìƒì„±/ì‚­ì œ, ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë“±) - Job ì‹¤íŒ¨ì‹œ, ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì¬ì²˜ë¦¬í•´ë„ ë˜ëŠ” ê²½ìš°(ë°ì´í„°ê°€ ë§¤ìš° ì ê±°ë‚˜, ìƒíƒœê°’ ê°™ì€ê²Œ ìˆì–´ì„œ ì´ë¯¸ ì²˜ë¦¬ëœê±´ ë‹¤ì‹œ ì²˜ë¦¬ë˜ì§€ ì•ŠëŠ” ê²½ìš°) - í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸°ì—” DBì— ë¶€í•˜ ë° ë½ìœ¼ë¡œ ì¸í•œ ì˜í–¥ë„ê°€ í° ê²½ìš° - ì˜ˆì™¸ ìƒí™© ë°œìƒì‹œ retry, skip ë“±ì˜ ì²˜ë¦¬ê°€ í•„ìš”í•œ ê²½ìš° - Job ì‹¤íŒ¨ì‹œ, ì‹¤íŒ¨ ì§€ì ë¶€í„° ë‹¤ì‹œ ì‹œì‘í•˜ëŠ”ê²Œ íš¨ìœ¨ì ì¸ ê²½ìš° ì°¸ê³  ìë£Œ https://docs.spring.io/spring-batch/reference/domain.html https://docs.spring.io/spring-batch/reference/step/tasklet.html https://docs.spring.io/spring-batch/reference/step/chunk-oriented-processing.html https://docs.spring.io/spring-batch/reference/step/controlling-flow.html#batchStatusVsExitStatus" }, { "title": "ì˜¤ëŠ˜ ë“œëŠ” ìƒê° (250910, í™˜ê²½)", "url": "/posts/daily-note-250910/", "categories": "ë„ì ë„ì ", "tags": "", "date": "2025-09-10 22:00:00 +0900", "snippet": "í˜„ì¬ì˜ í™˜ê²½ì—ì„œ ì¢‹ì§€ì•Šì€ ì ì— ì§‘ì¤‘í•˜ì—¬ ë¹„ê´€ì ì¸ íƒœë„ë¥¼ ê°€ì§€ë©´ ì‹œê°„ë§Œ ë‚­ë¹„í•˜ê²Œë˜ëŠ” ê²ƒ ê°™ë‹¤.ì£¼ì–´ì§„ í™˜ê²½ì—ì„œ í•  ìˆ˜ ìˆëŠ” ìµœì„ ì„ ë‹¤í•˜ì.ê¸°ì—¬í•  ë¶€ë¶„ì´ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤ë©´, ë‚´ ì—­ëŸ‰ì´ ë¶€ì¡±í•œ ê²ƒì´ë‹¤.", "content": "í˜„ì¬ì˜ í™˜ê²½ì—ì„œ ì¢‹ì§€ì•Šì€ ì ì— ì§‘ì¤‘í•˜ì—¬ ë¹„ê´€ì ì¸ íƒœë„ë¥¼ ê°€ì§€ë©´ ì‹œê°„ë§Œ ë‚­ë¹„í•˜ê²Œë˜ëŠ” ê²ƒ ê°™ë‹¤.ì£¼ì–´ì§„ í™˜ê²½ì—ì„œ í•  ìˆ˜ ìˆëŠ” ìµœì„ ì„ ë‹¤í•˜ì.ê¸°ì—¬í•  ë¶€ë¶„ì´ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤ë©´, ë‚´ ì—­ëŸ‰ì´ ë¶€ì¡±í•œ ê²ƒì´ë‹¤." }, { "title": "Spring Batch - Job ê°œë…", "url": "/posts/spring-batch-job/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Spring Batch", "date": "2025-09-05 21:25:00 +0900", "snippet": "ê°œë…Job ë°°ì¹˜ ì‘ì—…(ì¶œì²˜ : https://docs.spring.io/spring-batch/reference/domain.html) í•˜ë‚˜ì˜ Jobì€ í•˜ë‚˜ ì´ìƒì˜ Stepì„ ê°€ì§€ë©°, ê°ê°ì˜ Stepì€ í•˜ë‚˜ì˜ ItemReader, í•˜ë‚˜ì˜ ItemProcessor, ê·¸ë¦¬ê³  í•˜ë‚˜ì˜ ItemWriterë¥¼ ê°€ì§„ë‹¤. ì¦‰, Jobì€ Step ì¸ìŠ¤í„´ìŠ¤ë“¤ì„ ë‹´...", "content": "ê°œë…Job ë°°ì¹˜ ì‘ì—…(ì¶œì²˜ : https://docs.spring.io/spring-batch/reference/domain.html) í•˜ë‚˜ì˜ Jobì€ í•˜ë‚˜ ì´ìƒì˜ Stepì„ ê°€ì§€ë©°, ê°ê°ì˜ Stepì€ í•˜ë‚˜ì˜ ItemReader, í•˜ë‚˜ì˜ ItemProcessor, ê·¸ë¦¬ê³  í•˜ë‚˜ì˜ ItemWriterë¥¼ ê°€ì§„ë‹¤. ì¦‰, Jobì€ Step ì¸ìŠ¤í„´ìŠ¤ë“¤ì„ ë‹´ëŠ” ì»¨í…Œì´ë„ˆì´ë‹¤. Jobì€ JobLauncherë¥¼ í†µí•´ ì‹¤í–‰ë˜ë©°, í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ë©”íƒ€ë°ì´í„°ëŠ” JobRepositoryì— ì €ì¥ëœë‹¤. JobRepository : Spring Batchì—ì„œ JobExecutionê³¼ StepExecution ê°™ì€ ë‹¤ì–‘í•œ ì˜ì†í™”ëœ ë„ë©”ì¸ ê°ì²´ë“¤ì— ëŒ€í•´ ê¸°ë³¸ì ì¸ CRUD(ìƒì„±, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ) ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ ì €ì¥ì†Œ JobInstance ë°°ì¹˜ ì‘ì—…ì˜ ì‹¤í–‰ ë‹¨ìœ„(ì¶œì²˜ : https://docs.spring.io/spring-batch/reference/domain.html) ì˜ˆë¥¼ ë“¤ì–´ (ìœ„ ê·¸ë¦¼ì˜) EndOfDay Jobì˜ ê²½ìš° í•˜ë£¨ë§ˆë‹¤ í•˜ë‚˜ì˜ ë…¼ë¦¬ì  JobInstanceê°€ ì¡´ì¬í•œë‹¤. ë§Œì•½ 1ì›” 1ì¼ ì‹¤í–‰ì´ ì²˜ìŒì— ì‹¤íŒ¨í•˜ê³  ë‹¤ìŒ ë‚  ë‹¤ì‹œ ì‹¤í–‰ëœë‹¤ í•˜ë”ë¼ë„, ê·¸ê²ƒì€ ì—¬ì „íˆ 1ì›” 1ì¼ ì‹¤í–‰ì´ë‹¤. ì‹¤í–‰ì€ ë³´í†µ ì²˜ë¦¬ë˜ëŠ” ë°ì´í„°ì™€ ëŒ€ì‘ëœë‹¤. ì¦‰, 1ì›” 1ì¼ ì‹¤í–‰ì€ 1ì›” 1ì¼ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ì¦‰, JobInstanceëŠ” ì—¬ëŸ¬ ë²ˆì˜ ì‹¤í–‰(JobExecution)ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. íŠ¹ì • Jobê³¼ ê·¸ê²ƒì„ ì‹ë³„í•˜ëŠ” JobParametersì— ëŒ€ì‘ë˜ëŠ” JobInstanceì€ ë™ì‹œì— í•˜ë‚˜ë§Œ(ë˜ëŠ” í•œë²ˆë§Œ) ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤. JobInstance = Job + ì‹ë³„ìš© JobParameters allowStartIfComplete ì†ì„±ì„ í™œìš©í•˜ë©´ ì™„ë£Œëœ Jobì„ ì¬ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. BATCH_JOB_INSTANCEì˜ JOB_KEYê°€ íŒŒë¼ë¯¸í„°ì˜ í•´ì‹œê°’ íŒŒë¼ë¯¸í„° ì—†ëŠ” ê²½ìš°ì—ë„ í•´ì‹œê°’ ë§Œë“¤ì–´ì§ ìƒˆë¡œìš´ JobInstanceë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ â€œì²˜ìŒë¶€í„° ì‹œì‘â€ì„ ì˜ë¯¸í•˜ë©°, ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ì¼ë°˜ì ìœ¼ë¡œ(ExecutionContextì„ í™œìš©í•˜ì—¬) â€œì´ì „ ì‹¤í–‰ ì§€ì ë¶€í„° ì´ì–´ì„œ ì‹œì‘â€ì„ ì˜ë¯¸í•œë‹¤.JobExecution â€˜ì‹¤í–‰ ì‹œë„â€™ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°œë… í•´ë‹¹ ì‹¤í–‰ê³¼ ì—°ê²°ëœ JobInstanceëŠ” ì‹¤í–‰ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œë  ë•Œê¹Œì§€ ì™„ë£Œëœ ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ì§€ ì•ŠëŠ”ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì•ì„œ ì„¤ëª…í•œ EndOfDay Jobì„ ê¸°ì¤€ìœ¼ë¡œ, 2017ë…„ 1ì›” 1ì¼ì˜ JobInstanceê°€ ì²« ì‹¤í–‰ì—ì„œ ì‹¤íŒ¨í–ˆë‹¤ê³  ê°€ì •í•´ ë³´ì. ë™ì¼í•œ ì‹ë³„ JobParameters(2017-01-01)ë¡œ ë‹¤ì‹œ ì‹¤í–‰í•˜ë©´ ìƒˆë¡œìš´ JobExecutionì´ ìƒì„±ëœë‹¤. ê·¸ëŸ¬ë‚˜ ì—¬ì „íˆ JobInstanceëŠ” í•˜ë‚˜ë¿ì´ë‹¤.ì˜ˆì‹œ ìƒí™© EndOfDayJob 2017-01-01 ì‹¤í–‰ (21:00 ì‹œì‘ â†’ 21:30 ì‹¤íŒ¨) ë‹¤ìŒë‚  ê°™ì€ íŒŒë¼ë¯¸í„°ë¡œ ì¬ì‹¤í–‰ â†’ ì„±ê³µ (21:00 â†’ 21:30) ì´ì–´ì„œ 2017-01-02 ì‹¤í–‰ â†’ ì„±ê³µ (21:31 â†’ 22:29) BATCH_JOB_INSTANCE í…Œì´ë¸” JOB_INST_ID JOB_NAME 1 EndOfDayJob 2 EndOfDayJob BATCH_JOB_EXECUTION í…Œì´ë¸” JOB_EXEC_ID JOB_INST_ID START_TIME END_TIME STATUS 1 1 2017-01-01 21:00 2017-01-01 21:30 FAILED 2 1 2017-01-02 21:00 2017-01-02 21:30 COMPLETED 3 2 2017-01-02 21:31 2017-01-02 22:29 COMPLETED ì½”ë“œ ì‚´ì§ ë“¤ì—¬ë‹¤ë³´ê¸°Job ê³„ì¸µêµ¬ì¡°Job (Interface) â””â”€â”€ AbstractJob (Abstract Class) â”œâ”€â”€ SimpleJob (Concrete Class) â””â”€â”€ FlowJob (Concrete Class)// org.springframework.batch.core.job.AbstractJobabstract protected void doExecute(JobExecution execution) throws JobExecutionException;@Overridepublic final void execute(JobExecution execution) {\tAssert.notNull(execution, \"jobExecution must not be null\");\texecution.getExecutionContext().put(SpringBatchVersion.BATCH_VERSION_KEY, SpringBatchVersion.getVersion()); ...\ttry (Observation.Scope scope = observation.openScope()) {\t\tjobParametersValidator.validate(execution.getJobParameters());\t\tif (execution.getStatus() != BatchStatus.STOPPING) {\t\t\texecution.setStartTime(LocalDateTime.now());\t\t\tupdateStatus(execution, BatchStatus.STARTED);\t\t\tlistener.beforeJob(execution);\t\t\ttry {\t\t\t\tdoExecute(execution); ...// org.springframework.batch.core.job.SimpleJob#doExecute@Overrideprotected void doExecute(JobExecution execution) throws JobInterruptedException, JobRestartException, StartLimitExceededException { StepExecution stepExecution = null; for (Step step : steps) { stepExecution = handleStep(step, execution); if (stepExecution.getStatus() != BatchStatus.COMPLETED) { // // Terminate the job if a step fails // break; } } // // Update the job status to be the same as the last step // if (stepExecution != null) { if (logger.isDebugEnabled()) { logger.debug(\"Upgrading JobExecution status: \" + stepExecution); } execution.upgradeStatus(stepExecution.getStatus()); execution.setExitStatus(stepExecution.getExitStatus()); }}JobInstanceëŠ” JobParametersë¡œ ì‹ë³„// org.springframework.batch.core.repository.dao.JdbcJobInstanceDao#createJobInstance@Overridepublic JobInstance createJobInstance(String jobName, JobParameters jobParameters) { Assert.notNull(jobName, \"Job name must not be null.\"); Assert.notNull(jobParameters, \"JobParameters must not be null.\"); Assert.state(getJobInstance(jobName, jobParameters) == null, \"JobInstance must not already exist\"); Long jobInstanceId = jobInstanceIncrementer.nextLongValue(); JobInstance jobInstance = new JobInstance(jobInstanceId, jobName); jobInstance.incrementVersion(); Object[] parameters = new Object[] { jobInstanceId, jobName, jobKeyGenerator.generateKey(jobParameters), jobInstance.getVersion() }; getJdbcTemplate().update(getQuery(CREATE_JOB_INSTANCE), parameters, new int[] { Types.BIGINT, Types.VARCHAR, Types.VARCHAR, Types.INTEGER }); return jobInstance;}íŠ¹ì • Jobê³¼ ê·¸ê²ƒì„ ì‹ë³„í•˜ëŠ” JobParametersì— ëŒ€ì‘ë˜ëŠ” JobInstanceì€ í•œë²ˆë§Œ ì‹¤í–‰ ê°€ëŠ¥ ê´€ë ¨ ì—ëŸ¬ ë©”ì„¸ì§€batch.core.job.SimpleStepHandler : Step already complete or not restartable, so no action to execute: StepExecution: id=10, version=5, name=step1, status=COMPLETED, exitStatus=COMPLETED, ... í˜¸ì¶œ íë¦„ jobì´ë¦„ , íŒŒë¼ë¯¸í„°ë¡œ ì‹¤í–‰ ë‚´ì—­ì„ ì°¾ëŠ”ë‹¤.// org.springframework.batch.core.launch.support.TaskExecutorJobLauncher#runjobExecution = jobRepository.createJobExecution(job.getName(), jobParameters);\t\ttry {\t\t\ttaskExecutor.execute(new Runnable() {\t\t\t\t@Override\t\t\t\tpublic void run() { ...\t\t\t\t\t\tjob.execute(jobExecution); ì°¾ì€ ì‹¤í–‰ ë‚´ì—­ì—ì„œ JobInstanceë¥¼ ê°€ì ¸ì˜¨ë‹¤.// org.springframework.batch.core.job.SimpleStepHandler#handleStepJobInstance jobInstance = execution.getJobInstance();StepExecution lastStepExecution = jobRepository.getLastStepExecution(jobInstance, step.getName());if (stepExecutionPartOfExistingJobExecution(execution, lastStepExecution)) {\t// If the last execution of this step was in the same job, it's\t// probably intentional so we want to run it again...\tif (logger.isInfoEnabled()) {\t\tlogger.info(String.format(\t\t\t\t\"Duplicate step [%s] detected in execution of job=[%s]. \"\t\t\t\t\t\t+ \"If either step fails, both will be executed again on restart.\",\t\t\t\tstep.getName(), jobInstance.getJobName()));\t}\tlastStepExecution = null;}StepExecution currentStepExecution = lastStepExecution;if (shouldStart(lastStepExecution, execution, step)) { ...} jobRepository.getLastStepExecution í˜¸ì¶œë¡œ ì‹¤í–‰ë˜ëŠ” ì¿¼ë¦¬-- org.springframework.batch.core.repository.dao.JdbcStepExecutionDao#GET_LAST_STEP_EXECUTIONSELECT ...FROM BATCH_JOB_EXECUTION JE JOIN BATCH_STEP_EXECUTION SE ON SE.JOB_EXECUTION_ID = JE.JOB_EXECUTION_IDWHERE JE.JOB_INSTANCE_ID = ? AND SE.STEP_NAME = ? StepExecutionì˜ stepStatus ê°€ COMPLETEDì¸ë° allowStartIfComplete ì†ì„±ì´ falseì´ê±°ë‚˜ stepStatusê°€ ABANDONED ì´ë©´ íŠ¹ì • jobì„ ë™ì¼í•œ íŒŒë¼ë¯¸í„°ë¡œ ì¬ì‹¤í–‰ ë¶ˆê°€ëŠ¥// org.springframework.batch.core.job.SimpleStepHandler#shouldStartprotected boolean shouldStart(StepExecution lastStepExecution, JobExecution jobExecution, Step step)\t\tthrows JobRestartException, StartLimitExceededException {\tBatchStatus stepStatus;\tif (lastStepExecution == null) {\t\tstepStatus = BatchStatus.STARTING;\t}\telse {\t\tstepStatus = lastStepExecution.getStatus();\t} ...\tif ((stepStatus == BatchStatus.COMPLETED &amp;&amp; !step.isAllowStartIfComplete())\t\t\t|| stepStatus == BatchStatus.ABANDONED) {\t\t// step is complete, false should be returned, indicating that the\t\t// step should not be started\t\tif (logger.isInfoEnabled()) {\t\t\tlogger.info(\"Step already complete or not restartable, so no action to execute: \" + lastStepExecution);\t\t}\t\treturn false;\t} ...}íŠ¹ì • Jobê³¼ ê·¸ê²ƒì„ ì‹ë³„í•˜ëŠ” JobParametersì— ëŒ€ì‘ë˜ëŠ” JobInstanceì€ ë™ì‹œì— í•˜ë‚˜ë§Œ ì‹¤í–‰ ê°€ëŠ¥ ê´€ë ¨ ì—ëŸ¬ ë©”ì„¸ì§€Caused by: org.springframework.batch.core.repository.JobExecutionAlreadyRunningException: A jobexecution for this job is already running: JobInstance: id=1, ...// org.springframework.batch.core.repository.support.SimpleJobRepository#createJobExecution@Overridepublic JobExecution createJobExecution(String jobName, JobParameters jobParameters)\t\tthrows JobExecutionAlreadyRunningException, JobRestartException, JobInstanceAlreadyCompleteException {\tAssert.notNull(jobName, \"Job name must not be null.\");\tAssert.notNull(jobParameters, \"JobParameters must not be null.\");\tJobInstance jobInstance = jobInstanceDao.getJobInstance(jobName, jobParameters);\tExecutionContext executionContext;\tif (jobInstance != null) {\t\tList&lt;JobExecution&gt; executions = jobExecutionDao.findJobExecutions(jobInstance);\t\tif (executions.isEmpty()) {\t\t\tthrow new IllegalStateException(\"Cannot find any job execution for job instance: \" + jobInstance);\t\t}\t\tfor (JobExecution execution : executions) {\t\t\tif (execution.isRunning()) {\t\t\t\tthrow new JobExecutionAlreadyRunningException(\t\t\t\t\t\t\"A job execution for this job is already running: \" + jobInstance);\t\t\t} ...\t\t}\t\texecutionContext = ecDao.getExecutionContext(jobExecutionDao.getLastJobExecution(jobInstance));\t} ...\treturn jobExecution;}// org.springframework.batch.core.BatchStatuspublic enum BatchStatus { /** * The batch job has successfully completed its execution. */ COMPLETED, /** * Status of a batch job prior to its execution. */ STARTING, /** * Status of a batch job that is running. */ STARTED, /** * Status of batch job waiting for a step to complete before stopping the batch job. */ STOPPING, /** * Status of a batch job that has been stopped by request. */ STOPPED, /** * Status of a batch job that has failed during its execution. */ FAILED, /** * Status of a batch job that did not stop properly and can not be restarted. */ ABANDONED, /** * Status of a batch job that is in an uncertain state. */ UNKNOWN; public boolean isRunning() { return this == STARTING || this == STARTED || this == STOPPING; } ...}ì°¸ê³  ìë£Œ https://docs.spring.io/spring-batch/reference/domain.html https://docs.spring.io/spring-batch/reference/job/configuring-repository.html" }, { "title": "Gradle ì•Œì•„ë³´ê¸°", "url": "/posts/what-is-gradle/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Gradle", "date": "2025-08-26 21:25:00 +0900", "snippet": "Gradle í”„ë¡œì íŠ¸ êµ¬ì¡°project â”œâ”€â”€ gradle/ (1) â”‚ â”œâ”€â”€ libs.versions.toml (2) â”‚ â””â”€â”€ wrapper/ â”‚ â”œâ”€â”€ gradle-wrapper.jar â”‚ â””â”€â”€ gradle-wrapper.properties â”‚ â”œâ”€â”€ gradle...", "content": "Gradle í”„ë¡œì íŠ¸ êµ¬ì¡°project â”œâ”€â”€ gradle/ (1) â”‚ â”œâ”€â”€ libs.versions.toml (2) â”‚ â””â”€â”€ wrapper/ â”‚ â”œâ”€â”€ gradle-wrapper.jar â”‚ â””â”€â”€ gradle-wrapper.properties â”‚ â”œâ”€â”€ gradlew (3) â”œâ”€â”€ gradlew.bat (3) â”œâ”€â”€ settings.gradle(.kts) (4) â”œâ”€â”€ subproject-a/ â”‚ â”œâ”€â”€ build.gradle(.kts) (5) â”‚ â””â”€â”€ src/ (6) â””â”€â”€ subproject-b/ â”œâ”€â”€ build.gradle(.kts) (5) â””â”€â”€ src/ (6)(1) : gradle/ Gradle ë””ë ‰í„°ë¦¬, wrapper íŒŒì¼ê³¼ ê¸°íƒ€ íŒŒì¼ ì €ì¥ì†Œ.(2) : libs.versions.toml Gradle version catalog íŒŒì¼, ì˜ì¡´ì„± ê´€ë¦¬ìš©. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ì„ í•œ ê³³ì—ì„œ ê´€ë¦¬í•˜ëŠ” ì¹´íƒˆë¡œê·¸. ì˜ˆì‹œ:[versions]spring-boot = \"3.2.0\"junit = \"5.10.0\"[libraries]spring-boot-starter-web = { module = \"org.springframework.boot:spring-boot-starter-web\", version.ref = \"spring-boot\" }junit-jupiter = { module = \"org.junit.jupiter:junit-jupiter\", version.ref = \"junit\" } ì´ë ‡ê²Œ ì •ì˜í•´ ë‘ë©´ ê° build.gradleì—ì„œ ë²„ì „ì„ ì§ì ‘ ì“°ì§€ ì•Šê³  ì´ë¦„ìœ¼ë¡œ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆìŒ(3) : gradlew, gradlew.bat Gradle wrapper ìŠ¤í¬ë¦½íŠ¸ gradlew (ë¦¬ëˆ…ìŠ¤/ë§¥), gradlew.bat (ìœˆë„ìš°) ë¡œì»¬ì— Gradleì´ ì—†ì–´ë„, í”„ë¡œì íŠ¸ê°€ ì§€ì •í•œ Gradle ë²„ì „ì„ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œí•´ì„œ ì‹¤í–‰ ê°€ëŠ¥. ì¦‰, ëª¨ë“  ê°œë°œìê°€ ê°™ì€ ë²„ì „ì˜ Gradleì„ ì“°ê²Œ ë³´ì¥.(4) : settings.gradle ë£¨íŠ¸ í”„ë¡œì íŠ¸ ì´ë¦„ê³¼ ì„œë¸Œí”„ë¡œì íŠ¸ë¥¼ ì •ì˜í•˜ëŠ” Gradle ì„¤ì • íŒŒì¼. ë©€í‹° í”„ë¡œì íŠ¸ì˜ êµ¬ì„±ë„ ê°™ì€ ê²ƒ. ì˜ˆì‹œ: rootProject.name = \"my-multi-app\"include(\"subproject-a\", \"subproject-b\") ì´ë ‡ê²Œ í•´ì•¼ Gradleì´ subproject-a, subproject-bë¥¼ ì¸ì‹. ë©€í‹° ëª¨ë“ˆ í”„ë¡œì íŠ¸ì—ì„œëŠ” í•´ë‹¹ íŒŒì¼ì´ ë°˜ë“œì‹œ í•„ìš”í•¨ (ë‹¨ì¼ ëª¨ë“ˆ í”„ë¡œì íŠ¸ì—ì„œëŠ” ì—†ì–´ë„ë¨)(5) : build.gradle ê° ì„œë¸Œí”„ë¡œì íŠ¸ì˜ ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ ê° ëª¨ë“ˆ(ì˜ˆ: subproject-a, subproject-b)ì´ ì–´ë–¤ ì–¸ì–´, ì–´ë–¤ ì˜ì¡´ì„±, ì–´ë–¤ í”ŒëŸ¬ê·¸ì¸ì„ ì“°ëŠ”ì§€ ë“±ì„ ì •ì˜plugins { id(\"java\")}dependencies { implementation(libs.spring.boot.starter.web) testImplementation(libs.junit.jupiter)}(6) : src/ í”„ë¡œì íŠ¸ì˜ ì†ŒìŠ¤ ì½”ë“œ ë° ê¸°íƒ€ íŒŒì¼.src/ â”œâ”€â”€ main/java/... # ì‹¤ì œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ â”œâ”€â”€ main/resources/ # ì„¤ì • íŒŒì¼, ì •ì  ë¦¬ì†ŒìŠ¤ â””â”€â”€ test/java/... # í…ŒìŠ¤íŠ¸ ì½”ë“œí•µì‹¬ ê°œë… Projects, Build Scripts, Dependencies, Tasks, Plugins1. Projects Gradle í”„ë¡œì íŠ¸ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‚˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì²˜ëŸ¼ ë¹Œë“œí•  ìˆ˜ ìˆëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ì¡°ê°ì´ë‹¤. ë‹¨ì¼ í”„ë¡œì íŠ¸ ë¹Œë“œëŠ” ë£¨íŠ¸ í”„ë¡œì íŠ¸ë¼ ë¶ˆë¦¬ëŠ” ë‹¨ì¼ í”„ë¡œì íŠ¸ë¥¼ í¬í•¨í•œë‹¤. ë©€í‹° í”„ë¡œì íŠ¸ ë¹Œë“œëŠ” í•˜ë‚˜ì˜ ë£¨íŠ¸ í”„ë¡œì íŠ¸ì™€ ì—¬ëŸ¬ ê°œì˜ í•˜ìœ„ í”„ë¡œì íŠ¸ë¥¼ í¬í•¨í•œë‹¤.my-app/ â””â”€â”€ build.gradlemy-multi-app/ â”œâ”€â”€ build.gradle # ë£¨íŠ¸ í”„ë¡œì íŠ¸ â”œâ”€â”€ settings.gradle # ì–´ë–¤ ì„œë¸Œí”„ë¡œì íŠ¸ ìˆëŠ”ì§€ ì„ ì–¸ â”œâ”€â”€ app/ # ì„œë¸Œ í”„ë¡œì íŠ¸1 â”‚ â””â”€â”€ build.gradle â””â”€â”€ library/ # ì„œë¸Œ í”„ë¡œì íŠ¸2 â””â”€â”€ build.gradle// settings.gradlerootProject.name = \"my-multi-app\"include(\"app\", \"library\")2. Build Scripts ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ëŠ” Gradleì—ê²Œ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê¸° ìœ„í•´ ì–´ë–¤ ë‹¨ê³„ë¥¼ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ì•Œë ¤ì¤€ë‹¤. ê° í”„ë¡œì íŠ¸ëŠ” í•˜ë‚˜ ì´ìƒì˜ ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í¬í•¨í•  ìˆ˜ ìˆë‹¤. ì˜ˆ : â€œì´ í”„ë¡œì íŠ¸ëŠ” ìë°”ì•¼, ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”í•´â€ë¼ê³  Gradleì—ê²Œ ì•Œë ¤ì£¼ëŠ” ì„¤ëª…ì„œ.// build.gradleplugins { id 'java' // ìë°” ê´€ë ¨ Taskë“¤ ìë™ ë“±ë¡}group = 'com.example'version = '1.0.0'repositories { mavenCentral() // ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì—¬ê¸°ì„œ ê°€ì ¸ì˜´}dependencies { implementation 'org.springframework.boot:spring-boot-starter-web:3.2.0' testImplementation 'org.junit.jupiter:junit-jupiter:5.10.0'}3. Dependencies and Dependency Management í”„ë¡œì íŠ¸ì— í•„ìš”í•œ ì™¸ë¶€ ë¦¬ì†ŒìŠ¤(=ì˜ì¡´ì„±)ë¥¼ ì„ ì–¸í•˜ê³  í•´ê²°í•˜ëŠ” ìë™í™”ëœ ê¸°ë²• ì˜ì¡´ì„±(Dependencies)ì—ëŠ” JAR, ë¼ì´ë¸ŒëŸ¬ë¦¬, ì†ŒìŠ¤ ì½”ë“œ ë“±ì´ í¬í•¨ë˜ë©°, ì´ëŠ” í”„ë¡œì íŠ¸ ë¹Œë“œë¥¼ ì§€ì›í•œë‹¤. Gradleì€ ì´ëŸ¬í•œ ì˜ì¡´ì„±ì„ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œí•˜ê³ , ìºì‹±í•˜ê³ , í•´ê²°í•´ì£¼ê¸° ë•Œë¬¸ì— ê°œë°œìê°€ ì§ì ‘ ê´€ë¦¬í•  í•„ìš”ê°€ ì—†ë‹¤. ë˜í•œ Gradleì€ ë²„ì „ ì¶©ëŒ ì²˜ë¦¬ë¥¼ í•´ì£¼ê³ , ìœ ì—°í•œ ë²„ì „ ì„ ì–¸ ë°©ì‹ë„ ì§€ì›í•œë‹¤.dependencies { implementation 'org.springframework.boot:spring-boot-starter-web:3.2.0'} Gradleì—ì„œëŠ” ì˜ì¡´ì„±ì„ Configuration(êµ¬ì„±) ë³„ë¡œ ê·¸ë£¹í™”í•˜ì—¬, ì–¸ì œ/ì–´ë–»ê²Œ ì‚¬ìš©ë˜ëŠ”ì§€ë¥¼ ì •ì˜í•œë‹¤. implementation: í”„ë¡œë•ì…˜ ì½”ë“œì˜ ì»´íŒŒì¼ ë° ì‹¤í–‰ì— í•„ìš”í•œ ì˜ì¡´ì„± api: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì†Œë¹„ìì—ê²Œë„ ê³µê°œë˜ì–´ì•¼ í•˜ëŠ” ì˜ì¡´ì„± (ì¦‰, ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì“°ëŠ” ìª½ì—ì„œë„ ì ‘ê·¼ ê°€ëŠ¥í•´ì•¼ í•˜ëŠ” ê²½ìš°) ì˜ì¡´ì„± íŠ¸ë¦¬ë¥¼ í™•ì¸í•˜ë ¤ë©´ dependencies ì‘ì—…ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ì˜ˆ: :app í”„ë¡œì íŠ¸ì˜ ì˜ì¡´ì„±ì„ ë³´ë ¤ë©´ $ ./gradlew :app:dependencies ë²„ì „ ì¹´íƒˆë¡œê·¸ ë¹Œë“œ ì „ì²´ì—ì„œ ì˜ì¡´ì„± ì¢Œí‘œ(group:name:version)ì™€ ë²„ì „ì„ ì¤‘ì•™ ì§‘ì¤‘ì ì´ê³  ì¼ê´€ë˜ê²Œ ê´€ë¦¬í•˜ëŠ” ë°©ë²•ì„ ì œê³µí•œë‹¤.ê° build.gradle(.kts) íŒŒì¼ë§ˆë‹¤ ë²„ì „ì„ ì§ì ‘ ì ëŠ” ëŒ€ì‹ , libs.versions.toml íŒŒì¼ì— í•œ ë²ˆë§Œ ì •ì˜í•˜ê³  ê³µí†µìœ¼ë¡œ ê°€ì ¸ë‹¤ ì“¸ ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ë‹¤ìŒì´ ì‰¬ì›Œì§„ë‹¤: ì—¬ëŸ¬ ì„œë¸Œí”„ë¡œì íŠ¸ ê°„ ê³µí†µ ì˜ì¡´ì„± ì„ ì–¸ ê³µìœ  ì¤‘ë³µ ë° ë²„ì „ ë¶ˆì¼ì¹˜ ë°©ì§€ ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ì—ì„œ ì˜ì¡´ì„±ê³¼ í”ŒëŸ¬ê·¸ì¸ ë²„ì „ ê°•ì œ ì¼ë°˜ì ìœ¼ë¡œ libs.versions.toml íŒŒì¼ì—ëŠ” 4ê°œì˜ ì„¹ì…˜ì´ ìˆë‹¤: [versions] â†’ í”ŒëŸ¬ê·¸ì¸ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì°¸ì¡°í•  ë²„ì „ ë²ˆí˜¸ ì„ ì–¸ [libraries] â†’ ë¹Œë“œ íŒŒì¼ì—ì„œ ì‚¬ìš©í•  ë¼ì´ë¸ŒëŸ¬ë¦¬ ì •ì˜ [bundles] â†’ ì—¬ëŸ¬ ì˜ì¡´ì„±ì„ ë¬¶ì–´ì„œ ì„¸íŠ¸ë¡œ ì •ì˜ [plugins] â†’ í”ŒëŸ¬ê·¸ì¸ ì •ì˜ ì˜ˆì‹œ:[versions]guava = \"32.1.2-jre\"juneau = \"8.2.0\"[libraries]guava = { group = \"com.google.guava\", name = \"guava\", version.ref = \"guava\" }juneau-marshall = { group = \"org.apache.juneau\", name = \"juneau-marshall\", version.ref = \"juneau\" }// build.gradledependencies { implementation(libs.guava) api(libs.juneau.marshall)}Dependency Configurations Gradle í”„ë¡œì íŠ¸ì—ì„œ ì„ ì–¸ë˜ëŠ” ëª¨ë“  ì˜ì¡´ì„±ì€ íŠ¹ì • ë²”ìœ„(scope)ì— ì ìš©ëœë‹¤. Dependency Configuration(ì˜ì¡´ì„± êµ¬ì„±)ì€ í”„ë¡œì íŠ¸ ì•ˆì—ì„œ ì„œë¡œ ë‹¤ë¥¸ ëª©ì ì— ë§ê²Œ ì˜ì¡´ì„±ì„ ë¶„ë¦¬í•˜ì—¬ ì •ì˜í•˜ëŠ” ë°©ë²•ì´ë‹¤. ì´ê²ƒì€ ë¹Œë“œ ê³¼ì •ì˜ ì—¬ëŸ¬ ë‹¨ê³„(ì»´íŒŒì¼, ì‹¤í–‰, í…ŒìŠ¤íŠ¸ ë“±)ì—ì„œ ì˜ì¡´ì„±ì´ ì–¸ì œ, ì–´ë–»ê²Œ ì‚¬ìš©ë ì§€ë¥¼ ê²°ì •í•œë‹¤. ConfigurationsëŠ” Gradleì˜ ì˜ì¡´ì„± í•´ì„(dependency resolution)ì—ì„œ ê¸°ë³¸ì ì¸ ì—­í• ì„ í•œë‹¤. Java Library Pluginì„ ì ìš©í•˜ë©´ í”„ë¡œì íŠ¸ê°€ Java ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ìƒì‚°í•  ìˆ˜ ìˆê³ , ì´ í”ŒëŸ¬ê·¸ì¸ì€ ì—¬ëŸ¬ Configurationì„ ìë™ìœ¼ë¡œ ì¶”ê°€í•œë‹¤. ì˜ˆ: ì†ŒìŠ¤ ì½”ë“œ ì»´íŒŒì¼, í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë“± ë‹¤ì–‘í•œ classpathì— í•„ìš”í•œ ì˜ì¡´ì„± ê·¸ë£¹. Configuration ì„¤ëª… ë¹„ê³  api ì»´íŒŒì¼ &amp; ì‹¤í–‰ ì‹œ ëª¨ë‘ í•„ìš”í•œ ì˜ì¡´ì„±. ë˜í•œ ë°°í¬ëœ APIì— í¬í•¨ëœë‹¤. java-library í”ŒëŸ¬ê·¸ì¸ ì „ìš© implementation ì»´íŒŒì¼ &amp; ì‹¤í–‰ ì‹œ í•„ìš”í•œ ì˜ì¡´ì„±. í•˜ì§€ë§Œ APIë¡œ ë…¸ì¶œë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. ì¼ë°˜ì ì¸ ê²½ìš° ê°€ì¥ ë§ì´ ì‚¬ìš© compileOnly ì»´íŒŒì¼ ì‹œì—ë§Œ í•„ìš”í•œ ì˜ì¡´ì„±. ì‹¤í–‰(runtime)ì´ë‚˜ ë°°í¬ ì‹œì—ëŠ” í¬í•¨ë˜ì§€ ì•ŠëŠ”ë‹¤. ì˜ˆ: Lombok, Annotation Processor compileOnlyApi ì»´íŒŒì¼ ì‹œì—ë§Œ í•„ìš”í•˜ì§€ë§Œ, ë°°í¬ëœ APIì—ëŠ” í¬í•¨ëœë‹¤. Â  runtimeOnly ì‹¤í–‰ ì‹œì—ë§Œ í•„ìš”í•œ ì˜ì¡´ì„±. ì»´íŒŒì¼ classpathì—ëŠ” ì—†ìŒ. ì˜ˆ: JDBC Driver, ë¡œê¹… êµ¬í˜„ì²´ testImplementation í…ŒìŠ¤íŠ¸ ì½”ë“œ ì»´íŒŒì¼ &amp; ì‹¤í–‰ì— í•„ìš”í•œ ì˜ì¡´ì„±. ì˜ˆ: JUnit testCompileOnly í…ŒìŠ¤íŠ¸ ì½”ë“œ ì»´íŒŒì¼ì—ë§Œ í•„ìš”í•œ ì˜ì¡´ì„±. ì‹¤í–‰ì—ëŠ” ë¶ˆí•„ìš”. Â  testRuntimeOnly í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì‹œì—ë§Œ í•„ìš”í•œ ì˜ì¡´ì„±. Â  annotationProcessorëŠ” ëª©ë¡ì— ì—†ì„ê¹Œ? ì´ìœ ëŠ”, annotationProcessorëŠ” Java í”ŒëŸ¬ê·¸ì¸/Java Library í”ŒëŸ¬ê·¸ì¸ì—ì„œ ì¶”ê°€ì ìœ¼ë¡œ ì •ì˜í•œ íŠ¹ìˆ˜ Configurationì´ê¸° ë•Œë¬¸ ì›ë˜ Gradle ê¸°ë³¸ ë¬¸ì„œì—ì„œ â€œì£¼ìš” Configurationâ€ë§Œ ì†Œê°œí–ˆì„ ë•ŒëŠ” annotationProcessorê°€ ë¹ ì ¸ ìˆìŒ annotationProcessorëŠ” ë‹¤ìŒì„ ìœ„í•´ ì‚¬ìš©ë¨: ì»´íŒŒì¼ ì‹œì— ì• ë…¸í…Œì´ì…˜ í”„ë¡œì„¸ì„œë¥¼ ì‹¤í–‰í•´ì•¼ í•  ë•Œ (ì˜ˆ: Lombok, MapStruct) ì‹¤í–‰(runtime)ì´ë‚˜ API ë°°í¬ì™€ëŠ” ë¬´ê´€í•˜ê²Œ, ì˜¤ì§ ì»´íŒŒì¼ ë‹¨ê³„ì—ì„œë§Œ í•„ìš” 4. Tasks ì‘ì—…(Task)ì€ ì½”ë“œë¥¼ ì»´íŒŒì¼í•˜ê±°ë‚˜ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒ ê°™ì€ ë…ë¦½ì ì¸ ì‘ì—… ë‹¨ìœ„ì´ë‹¤. ì¼ë°˜ì ì¸ ì‘ì—…(Task)ì˜ ìœ í˜•ì—ëŠ” ë‹¤ìŒì´ í¬í•¨ëœë‹¤: ì†ŒìŠ¤ ì½”ë“œ ì»´íŒŒì¼ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¶œë ¥ë¬¼ íŒ¨í‚¤ì§• (ì˜ˆ: JAR ë˜ëŠ” APK ìƒì„±) ë¬¸ì„œ ìƒì„± (ì˜ˆ: Javadoc) ë¹Œë“œ ì‚°ì¶œë¬¼ì„ ì €ì¥ì†Œì— ë°°í¬ ê° ì‘ì—…ì€ ë…ë¦½ì ì´ì§€ë§Œ, ë‹¤ë¥¸ ì‘ì—…ì´ ë¨¼ì € ì‹¤í–‰ë˜ì–´ì•¼ë§Œ ìˆ˜í–‰ë  ìˆ˜ë„ ìˆë‹¤. Gradleì€ ì´ ì •ë³´ë¥¼ ì‚¬ìš©í•´ì„œ ê°€ì¥ íš¨ìœ¨ì ì¸ ìˆœì„œë¡œ ì‘ì—…ë“¤ì„ ì‹¤í–‰í•˜ë©°, ì´ë¯¸ ìµœì‹  ìƒíƒœì¸ ì‘ì—…ì€ ê±´ë„ˆë›´ë‹¤. Gradle í”ŒëŸ¬ê·¸ì¸ê³¼ ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ëŠ” í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì‘ì—…ë“¤ì„ ì •ì˜í•œë‹¤. $ ./gradlew tasksë¡œ í™•ì¸ ê°€ëŠ¥ Task ì‹¤í–‰ ./gradlew &lt;Taskëª…&gt; ì‘ì—…ì„ ì‹¤í–‰í•˜ë ¤ë©´ í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ì—ì„œ Gradle Wrapperë¥¼ ì‚¬ìš©í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, build ì‘ì—…ì„ ì‹¤í–‰í•˜ë ¤ë©´: ./gradlew build ì´ ëª…ë ¹ì€ build ì‘ì—…ê³¼ ê·¸ì— í•„ìš”í•œ ëª¨ë“  ì˜ì¡´ ì‘ì—…ë“¤ì„ ì‹¤í–‰í•œë‹¤. Gradleì€ ì–´ë–¤ ì‘ì—…ì´ ë‹¤ë¥¸ ì–´ë–¤ ì‘ì—…ì— ì˜ì¡´í•˜ëŠ”ì§€ ì•Œê³  ìˆìœ¼ë©°, ì˜¬ë°”ë¥¸ ìˆœì„œë¡œ ìë™ìœ¼ë¡œ ì‹¤í–‰í•œë‹¤.$ ./gradlew build&gt; Task :app:compileJava&gt; Task :app:processResources NO-SOURCE&gt; Task :app:classes&gt; Task :app:jar&gt; Task :app:startScripts&gt; Task :app:distTar&gt; Task :app:distZip&gt; Task :app:assemble&gt; Task :app:check&gt; Task :app:buildBUILD SUCCESSFUL in 764ms7 actionable tasks: 7 executed5. Plugins Gradle ë¹Œë“œ ì‹œìŠ¤í…œì— ì¶”ê°€ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì†Œí”„íŠ¸ì›¨ì–´ ì¡°ê° ì¶”ê°€ ê¸°ëŠ¥ ì˜ˆ: ìƒˆë¡œìš´ ì‘ì—…(Task)ì„ ë¹Œë“œì— ì¶”ê°€í•œë‹¤ (ì˜ˆ: compileJava, test) ìƒˆë¡œìš´ ì„¤ì •(Configuration)ì„ ì¶”ê°€í•œë‹¤ (ì˜ˆ: implementation, runtimeOnly) ìƒˆë¡œìš´ DSL(Domain Specific Language, ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì“¸ ìˆ˜ ìˆëŠ” ì „ìš© ë¬¸ë²•) ìš”ì†Œë¥¼ ì œê³µí•œë‹¤ (ì˜ˆ: application {}, publishing {}) ì¦‰, Gradleì€ ê¸°ë³¸ì ìœ¼ë¡œ ìµœì†Œ ê¸°ëŠ¥ë§Œ ìˆê³  í”ŒëŸ¬ê·¸ì¸ì„ ë¶™ì´ë©´ ê¸°ëŠ¥ì´ ëŠ˜ì–´ë‚¨. ì˜ˆì‹œ:plugins { id(\"java\") // java í”ŒëŸ¬ê·¸ì¸ì„ ì ìš©}dependencies { implementation(\"org.springframework.boot:spring-boot-starter-web\") // ì½”ë“œ ì»´íŒŒì¼ ì‹œ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ testImplementation(\"org.junit.jupiter:junit-jupiter:5.10.0\") // í…ŒìŠ¤íŠ¸ ì „ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ runtimeOnly(\"com.h2database:h2\") // ì‹¤í–‰ ì‹œì—ë§Œ í•„ìš”í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬} java í”ŒëŸ¬ê·¸ì¸ì„ ì ìš©í•˜ê¸° ì „ì—ëŠ” implementation, testImplementation, runtimeOnly ê°™ì€ Configurationì´ ì—†ìŒ. í”ŒëŸ¬ê·¸ì¸ì„ ì ìš©í•˜ë©´ì„œ Gradleì´ ì´ëŸ° â€œì˜ì¡´ì„± ê·¸ë£¹â€ì„ ìë™ìœ¼ë¡œ ë§Œë“¤ì–´ì¤Œ.plugins { id(\"org.springframework.boot\") version \"3.2.0\"}tasks.named&lt;org.springframework.boot.gradle.tasks.run.BootRun&gt;(\"bootRun\") { args(\"--spring.profiles.active=dev\")} í”ŒëŸ¬ê·¸ì¸ì€ íŠ¹ì • ë„ë©”ì¸ì´ë‚˜ ì›Œí¬í”Œë¡œìš°ì— í•„ìš”í•œ ëª¨ë“  ë¡œì§ì„ ê°€ì ¸ì˜¨ë‹¤. ë„ë©”ì¸ = â€œíŠ¹ì •í•œ ë¬¸ì œ ì˜ì—­â€ (ì˜ˆ: Java ë¹Œë“œ, Spring Boot ì‹¤í–‰, Android ì•± íŒ¨í‚¤ì§• ë“±) í”ŒëŸ¬ê·¸ì¸ì€ ê·¸ ë„ë©”ì¸ì— í•„ìš”í•œ Task, Configuration, DSL ë¸”ë¡ì„ í•œêº¼ë²ˆì— ì œê³µí•œë‹¤. ì¦‰, ì–´ë–¤ ì›Œí¬í”Œë¡œìš°(íë¦„)ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ê²ƒë“¤ì„ ì „ë¶€ ì œê³µí•œë‹¤. Spring Boot í”ŒëŸ¬ê·¸ì¸ì„ ì ìš©í•˜ë©´: bootRun, bootJar ê°™ì€ Task ìë™ ì¶”ê°€ developmentOnly, runtimeClasspath ê°™ì€ Configuration ì¶”ê°€ springBoot {} ê°™ì€ DSL ë¸”ë¡ ì œê³µ ê²°ê³¼ì ìœ¼ë¡œ Spring Boot ì•± ë¹Œë“œ/ì‹¤í–‰/ë°°í¬ì— í•„ìš”í•œ ì „ ê³¼ì •ì„ ìë™í™”í•  ìˆ˜ ìˆìŒ. í”ŒëŸ¬ê·¸ì¸ ì¢…ë¥˜ Gradleì€ ì„¸ ê°€ì§€ íƒ€ì…ì˜ í”ŒëŸ¬ê·¸ì¸ì„ ì§€ì›í•œë‹¤1. ìŠ¤í¬ë¦½íŠ¸ í”ŒëŸ¬ê·¸ì¸ (Script plugins) ë‹¤ë¥¸ Gradle ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼(.gradle / .gradle.kts)ì„ ë¶ˆëŸ¬ë‹¤ ì“°ëŠ” ë°©ì‹. apply from: ë¬¸ë²•ìœ¼ë¡œ ì ìš©. í”íˆ ê³µí†µ ì„¤ì •ì„ common.gradle ê°™ì€ íŒŒì¼ë¡œ ë¶„ë¦¬í•´ì„œ ì—¬ëŸ¬ í”„ë¡œì íŠ¸ì—ì„œ ì¬ì‚¬ìš©í•  ë•Œ ì‚¬ìš©.// common.gradletasks.register(\"hello\") { doLast { println(\"Hello from common.gradle\") }}// build.gradleapply from: \"common.gradle\"2. ì‚¬ì „ ì»´íŒŒì¼ëœ í”ŒëŸ¬ê·¸ì¸ (Pre-compiled plugins) Kotlin ë˜ëŠ” Groovy ì½”ë“œë¡œ íŒ¨í‚¤ì§•ëœ í”ŒëŸ¬ê·¸ì¸. ì§ì ‘ í”ŒëŸ¬ê·¸ì¸ í´ë˜ìŠ¤ë¥¼ ì‘ì„±í•´ì„œ í”„ë¡œì íŠ¸ ë‚´ì—ì„œ ì¬ì‚¬ìš©. buildSrc/ ë””ë ‰í„°ë¦¬ì— ë„£ìœ¼ë©´ ìë™ìœ¼ë¡œ ì¸ì‹ë¨.project-root/ â”œâ”€â”€ buildSrc/ â”‚ â””â”€â”€ src/main/kotlin/MyConventionPlugin.kt â””â”€â”€ build.gradle.kts// buildSrc/src/main/kotlin/MyConventionPlugin.ktimport org.gradle.api.Pluginimport org.gradle.api.Projectclass MyConventionPlugin : Plugin&lt;Project&gt; { override fun apply(project: Project) { project.tasks.register(\"greet\") { doLast { println(\"Hello from MyConventionPlugin!\") } } }}// build.gradle.ktsplugins { id(\"my-convention-plugin\") // í´ë˜ìŠ¤ ì´ë¦„ ê¸°ë°˜ìœ¼ë¡œ ìë™ ì¸ì‹}3. ë°”ì´ë„ˆë¦¬ í”ŒëŸ¬ê·¸ì¸ (Binary plugins) íŒ¨í‚¤ì§•Â·ë°°í¬ëœ í”ŒëŸ¬ê·¸ì¸(Plugin Portal ë˜ëŠ” Mavenì— ì˜¬ë¼ì˜¨ ê²ƒ). ëŒ€ë¶€ë¶„ ìš°ë¦¬ê°€ ì“°ëŠ” ìœ ëª…í•œ í”ŒëŸ¬ê·¸ì¸ë“¤ (ì˜ˆ: java, application, spring-boot, spotless)plugins { id(\"java-library\") // Gradle ì½”ì–´ í”ŒëŸ¬ê·¸ì¸ (ë²„ì „ ì§€ì • í•„ìš” ì—†ìŒ) id(\"org.springframework.boot\") version \"3.2.0\" // ì»¤ë®¤ë‹ˆí‹° í”ŒëŸ¬ê·¸ì¸ id(\"com.diffplug.spotless\") version \"6.25.0\" // ì½”ë“œ í¬ë§·íŒ… í”ŒëŸ¬ê·¸ì¸}í”ŒëŸ¬ê·¸ì¸ ë°°í¬ ê²½ë¡œ Gradle í”ŒëŸ¬ê·¸ì¸ì€ ì—¬ëŸ¬ ì†ŒìŠ¤ì—ì„œ ì œê³µë˜ë©°, ìƒí™©ì— ë§ê²Œ ì„ íƒí•  ìˆ˜ ìˆë‹¤.1. ì½”ì–´ í”ŒëŸ¬ê·¸ì¸ (Core Plugins) Gradle ë°°í¬íŒì— í¬í•¨ëœ í”ŒëŸ¬ê·¸ì¸. (ëª©ë¡) Gradle íŒ€ì—ì„œ ê´€ë¦¬í•œë‹¤. ì˜ˆ: java-libraryplugins { id(\"java-library\")}2. ì»¤ë®¤ë‹ˆí‹° í”ŒëŸ¬ê·¸ì¸ (Community Plugins, Plugin Portal) Gradle ì»¤ë®¤ë‹ˆí‹°ê°€ ë§Œë“  í”ŒëŸ¬ê·¸ì¸. Gradle Plugin Portalì— ê³µê°œë˜ì–´ ìˆê³ , IDì™€ ë²„ì „ìœ¼ë¡œ ì ìš© ê°€ëŠ¥.plugins { id(\"org.springframework.boot\").version(\"3.1.5\")}3. ë¡œì»¬/ì»¤ìŠ¤í…€ í”ŒëŸ¬ê·¸ì¸ (Local or Custom Plugins) ì§ì ‘ ë§Œë“  í”ŒëŸ¬ê·¸ì¸. ë‹¨ì¼ í”„ë¡œì íŠ¸ì—ì„œë§Œ ì“°ê±°ë‚˜ ì—¬ëŸ¬ í”„ë¡œì íŠ¸ì—ì„œ ê³µìœ í•  ìˆ˜ ìˆë‹¤. ê°€ì¥ í”í•œ í˜•íƒœëŠ” Convention Plugin. buildSrc/ ë””ë ‰í† ë¦¬ë‚˜ ë³„ë„ build-logic ëª¨ë“ˆ ì•ˆì— ìœ„ì¹˜. Kotlin/Groovyë¡œ ì‘ì„±. Gradle Wrapper Gradle WrapperëŠ” í•­ìƒ ì‹ ë¢°í•  ìˆ˜ ìˆê³ , ì œì–´ë˜ê³ , í‘œì¤€í™”ëœ ë¹Œë“œ ì‹¤í–‰ì„ ë³´ì¥í•˜ê¸° ë•Œë¬¸ì— ê¶Œì¥ë˜ëŠ” Gradle ë¹Œë“œ ë°©ì‹ì´ë‹¤. Wrapper ìŠ¤í¬ë¦½íŠ¸ëŠ” ì„ ì–¸ëœ Gradle ë²„ì „ì„ í˜¸ì¶œí•˜ë©°, í•„ìš”í•˜ë‹¤ë©´ ë¨¼ì € ê·¸ê²ƒì„ ë‹¤ìš´ë¡œë“œí•œë‹¤. í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ì—ì„œ gradlew ë˜ëŠ” gradlew.bat íŒŒì¼ë¡œ ì œê³µëœë‹¤:rootâ”œâ”€â”€ gradlew // THE WRAPPERâ”œâ”€â”€ gradlew.bat // THE WRAPPERâ””â”€â”€ ... í”„ë¡œì íŠ¸ì— ì´ íŒŒì¼ë“¤ì´ ì—†ë‹¤ë©´, ê·¸ê²ƒì€ ì•„ë§ˆë„ Gradle í”„ë¡œì íŠ¸ê°€ ì•„ë‹ˆê±°ë‚˜, Wrapperê°€ ì•„ì§ ì„¤ì •ë˜ì§€ ì•Šì€ ê²ƒì¼ ìˆ˜ ìˆë‹¤. WrapperëŠ” ì¸í„°ë„·ì—ì„œ ì§ì ‘ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤. Gradleì´ ì„¤ì¹˜ëœ ë¨¸ì‹ ì—ì„œ gradle wrapper ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ ìƒì„±í•´ì•¼ í•œë‹¤. ì¶œì²˜ : https://docs.gradle.org/current/userguide/gradle_wrapper_basics.htmlWrapperê°€ ì œê³µí•˜ëŠ” ì´ì  ì§€ì •ëœ Gradle ë²„ì „ì„ ìë™ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œí•˜ê³  ì‚¬ìš©í•œë‹¤. í”„ë¡œì íŠ¸ë¥¼ íŠ¹ì • Gradle ë²„ì „ì— í‘œì¤€í™”í•œë‹¤. ì„œë¡œ ë‹¤ë¥¸ ì‚¬ìš©ì ë° í™˜ê²½(IDE, CI ì„œë²„ ë“±)ì— ë™ì¼í•œ Gradle ë²„ì „ì„ ì œê³µí•œë‹¤. Gradleì„ ì§ì ‘ ìˆ˜ë™ ì„¤ì¹˜í•˜ì§€ ì•Šê³ ë„ Gradle ë¹Œë“œë¥¼ ì‰½ê²Œ ì‹¤í–‰í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.ë§Œì•½ ì‹¤í–‰ í™˜ê²½ë³„ë¡œ ë²„ì „ì´ ë‹¤ë¥´ë©´ ?1. ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ ë¬¸ë²• ì°¨ì´ Gradleì€ ê³„ì† ë°œì „í•˜ë©´ì„œ DSL(Groovy/Kotlin) ë¬¸ë²•ì´ ì¶”ê°€Â·ë³€ê²½Â·Deprecated ë¨ ì˜ˆ: ì˜ˆì „ ë²„ì „ì—ì„œ ì“°ë˜ compile-&gt; implementationìœ¼ë¡œ ë³€ê²½ Gradle 4.xë¥¼ ì“°ë©´ compileì´ ì˜ ë™ì‘í•˜ì§€ë§Œ, Gradle 7.xì—ì„  ì—ëŸ¬ ë°œìƒ2. í”ŒëŸ¬ê·¸ì¸ í˜¸í™˜ì„± ë¬¸ì œ Spring Boot, Kotlin, Android ë“±ì€ Gradle ë²„ì „ì— ë§ì¶° í”ŒëŸ¬ê·¸ì¸ì„ ì—…ë°ì´íŠ¸ íŠ¹ì • ë²„ì „ì˜ Gradleì—ì„œëŠ” í”ŒëŸ¬ê·¸ì¸ì´ ì•„ì˜ˆ ë™ì‘í•˜ì§€ ì•Šê±°ë‚˜ ê²½ê³ /ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ. ì˜ˆ: ìµœì‹  Android Gradle Pluginì€ ìµœì†Œ Gradle 7.x ì´ìƒì„ ìš”êµ¬. ëˆ„êµ°ê°€ëŠ” 6.xë¥¼ ì“°ë©´ ë¹Œë“œ ìì²´ê°€ ë¶ˆê°€ëŠ¥. CI/CD ì„œë²„ë‚˜ ë‹¤ë¥¸ ê°œë°œì í™˜ê²½ì—ì„œ ë¹Œë“œ ê¹¨ì§.3. ë¹Œë“œ ê²°ê³¼ë¬¼ ì°¨ì´ ê°™ì€ ì½”ë“œë¥¼ ë¹Œë“œí•´ë„ Gradle ë‚´ë¶€ ë™ì‘(ìºì‹±, ë³‘ë ¬ ë¹Œë“œ ë°©ì‹, dependency resolution ë°©ì‹)ì´ ë²„ì „ì— ë”°ë¼ ë‹¬ë¼ì§‘ë‹ˆë‹¤. ì˜ˆ: Gradle 6.xì™€ 7.xëŠ” ì˜ì¡´ì„± ì¤‘ë³µ ì²˜ë¦¬ ë°©ì‹ì´ ë‹¬ë¼ì„œ, í•œìª½ì€ ì¶©ëŒ ë‚˜ê³  ë‹¤ë¥¸ í•œìª½ì€ ìë™ í•´ê²°ë  ìˆ˜ë„ ìˆìŒ. ë¡œì»¬ì—ì„œ í…ŒìŠ¤íŠ¸í•œ JAR/WARëŠ” ì˜ ëŒì•„ê°€ëŠ”ë°, ì„œë²„ì—ì„œ ë¹Œë“œëœ ê±´ ì˜¤ë¥˜ê°€ ë‚  ìˆ˜ ìˆìŒ.4. CI/CD í™˜ê²½ê³¼ ë¡œì»¬ í™˜ê²½ ë¶ˆì¼ì¹˜ ë¡œì»¬ ê°œë°œìëŠ” Gradle 8.x, CI ì„œë²„ëŠ” Gradle 7.x â†’ ì„œë²„ì—ì„œë§Œ ë¹Œë“œ ì—ëŸ¬ ë°œìƒ. ë¹Œë“œ ì‹¤íŒ¨ ì›ì¸ì„ íŒŒì•…í•˜ê¸° ì–´ë ¤ì›Œì§€ê³ , ì‹œê°„ì„ í—ˆë¹„í•˜ê²Œ ë¨.Wrapper êµ¬ì„± ìš”ì†Œ.â”œâ”€â”€ gradleâ”‚ â””â”€â”€ wrapperâ”‚ â”œâ”€â”€ gradle-wrapper.jarâ”‚ â””â”€â”€ gradle-wrapper.propertiesâ”œâ”€â”€ gradlewâ””â”€â”€ gradlew.bat gradle-wrapper.jar ì‘ì€ JAR íŒŒì¼ë¡œ, Gradle Wrapper ì½”ë“œë¥¼ ë‹´ê³  ìˆë‹¤. í”„ë¡œì íŠ¸ì— í•„ìš”í•œ Gradle ë²„ì „ì´ ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šìœ¼ë©´ ì´ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ì„¤ì¹˜í•˜ëŠ” ì—­í• ì„ í•œë‹¤. gradle-wrapper.properties Gradle Wrapperì— ëŒ€í•œ ì„¤ì • ì†ì„±ì„ ë‹´ê³  ìˆëŠ” íŒŒì¼ì´ë‹¤. ì˜ˆ: Gradleì„ ì–´ë””ì„œ ë‹¤ìš´ë¡œë“œí• ì§€(ë°°í¬ URL), ë°°í¬ ìœ í˜•(ZIP ë˜ëŠ” TARBALL). gradlew Unix ê³„ì—´ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš©í•˜ëŠ” ì…¸ ìŠ¤í¬ë¦½íŠ¸. gradle-wrapper.jarë¥¼ ê°ì‹¸ëŠ” ì—­í• ì„ í•˜ë©°, Gradleì„ ìˆ˜ë™ ì„¤ì¹˜í•˜ì§€ ì•Šê³ ë„ Gradle ì‘ì—…ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. gradlew.bat Windowsì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°°ì¹˜ ìŠ¤í¬ë¦½íŠ¸. ëª©ì ì€ gradlewì™€ ë™ì¼í•˜ë‹¤. ì‹¤í–‰ íë¦„ ì˜ˆì‹œ ./gradlew build gradlew (shell script) ë™ì‘: CLASSPATH=$APP_HOME/gradle/wrapper/gradle-wrapper.jar ì„¤ì • Java ì‹¤í–‰ê¸°ë¡œ gradle-wrapper.jarë¥¼ ì‹¤í–‰ ì´ë•Œ, gradle-wrapper.properties íŒŒì¼ë„ ì½ì–´ì„œ â€œGradle ëª‡ ë²„ì „, ì–´ë””ì„œ ë°›ì„ì§€â€ í™•ì¸ gradle-wrapper.jar ë™ì‘: ì§€ì •ëœ ë²„ì „ì˜ Gradle ì„¤ì¹˜ ì—¬ë¶€ í™•ì¸ ì—†ìœ¼ë©´ ë‹¤ìš´ë¡œë“œ (ZIPì´ë‚˜ TAR) í•´ë‹¹ Gradle ëŸ°ì²˜ë¥¼ í˜¸ì¶œí•´ì„œ ì‹¤ì œ ë¹Œë“œ ì‹¤í–‰ ì£¼ì˜ ì‚¬í•­ ì´ íŒŒì¼ë“¤ì€ ì ˆëŒ€ ì§ì ‘ ìˆ˜ì •í•´ì„œëŠ” ì•ˆ ëœë‹¤. Gradle ë²„ì „ì„ í™•ì¸í•˜ê±°ë‚˜ ì—…ë°ì´íŠ¸í•˜ë ¤ë©´ ëª…ë ¹ì¤„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì„ ì‚¬ìš©í•œë‹¤:$ ./gradlew --version$ ./gradlew wrapper --gradle-version 7.2ì°¸ê³  ìë£Œ https://docs.gradle.org/current/userguide/gradle_basics.html https://docs.gradle.org/current/userguide/dependency_management_basics.html https://docs.gradle.org/current/userguide/dependency_configurations.html https://docs.gradle.org/current/userguide/task_basics.html https://docs.gradle.org/current/userguide/task_basics.html" }, { "title": "Spring Batch - Multi-threaded Step ì•Œì•„ë³´ê¸°", "url": "/posts/spring-batch-multi-threaded-step/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Spring Batch", "date": "2025-08-23 12:25:00 +0900", "snippet": "ê°œìš” Spring BatchëŠ” ë³‘ë ¬ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë‹¤ì–‘í•œ ì˜µì…˜ì„ ì œê³µí•œë‹¤. í° í‹€ì—ì„œ ë³‘ë ¬ ì²˜ë¦¬ëŠ” ë‘ ê°€ì§€ ë°©ì‹ì´ ìˆë‹¤: Single-process Multi-threaded Step Parallel Steps Multi-process ...", "content": "ê°œìš” Spring BatchëŠ” ë³‘ë ¬ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë‹¤ì–‘í•œ ì˜µì…˜ì„ ì œê³µí•œë‹¤. í° í‹€ì—ì„œ ë³‘ë ¬ ì²˜ë¦¬ëŠ” ë‘ ê°€ì§€ ë°©ì‹ì´ ìˆë‹¤: Single-process Multi-threaded Step Parallel Steps Multi-process Remote Chunking of Step Partitioning a Step (Single or Multi-process) Multi-threaded Step ë³‘ë ¬ ì²˜ë¦¬ë¥¼ ì‹œì‘í•˜ëŠ” ê°€ì¥ ë‹¨ìˆœí•œ ë°©ë²•ì€ Step ì„¤ì •ì— TaskExecutorë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒ@Beanpublic TaskExecutor taskExecutor() { return new SimpleAsyncTaskExecutor(\"spring_batch\");}@Beanpublic Step sampleStep(TaskExecutor taskExecutor, JobRepository jobRepository, PlatformTransactionManager transactionManager) {\treturn new StepBuilder(\"sampleStep\", jobRepository)\t\t\t\t.&lt;String, String&gt;chunk(10, transactionManager)\t\t\t\t.reader(itemReader())\t\t\t\t.writer(itemWriter())\t\t\t\t.taskExecutor(taskExecutor) .throttleLimit(20) // default : 4 (ìŠ¤í”„ë§ ë°°ì¹˜ 5.0ë¶€í„°ëŠ” deprecated) .build();} ìœ„ ì„¤ì •ì„ í†µí•´, Stepì´ ì‹¤í–‰ë  ë•Œ ê° ì²­í¬(ì»¤ë°‹ ë‹¨ìœ„)ë¥¼ ë³„ë„ì˜ ìŠ¤ë ˆë“œì—ì„œ ì½ê³ , ì²˜ë¦¬í•˜ê³ , ì“°ê²Œ ëœë‹¤. ë”°ë¼ì„œ ì•„ì´í…œë“¤ì´ ìˆœì°¨ì ìœ¼ë¡œ ì²˜ë¦¬ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìœ¼ë©°, ë‹¨ì¼ ìŠ¤ë ˆë“œì˜ ê²½ìš°ì™€ ë‹¬ë¦¬ í•œ ì²­í¬ì— ì—°ì†ë˜ì§€ ì•ŠëŠ” ì•„ì´í…œì´ í¬í•¨ë  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì¶”ê°€ë¡œ, taskExecutor ìì²´ì˜ ì œí•œ(ì˜ˆ: ìŠ¤ë ˆë“œ í’€ì´ëƒ ì•„ë‹ˆëƒ) ì™¸ì—ë„, tasklet ì„¤ì •ì—ëŠ” throttleLimit(ê¸°ë³¸ê°’: 4)ì´ ì¡´ì¬í•©ë‹ˆë‹¤. ì¦‰, ë™ì‹œì— ìµœëŒ€ 4ê°œì˜ ì²­í¬ë§Œ ë³‘ë ¬ ì‹¤í–‰ ìŠ¤ë ˆë“œ í’€ì„ ì¶©ë¶„íˆ í™œìš©í•˜ë ¤ë©´ ì´ ì œí•œì„ ëŠ˜ë ¤ì•¼ í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.Throttle limit íê¸° ë²„ì „ 5.0ë¶€í„° throttle limitì€ deprecated ë˜ì—ˆìœ¼ë©° ëŒ€ì²´ì œê°€ ì—†ìŠµë‹ˆë‹¤. í˜„ì¬ ê¸°ë³¸ TaskExecutorRepeatTemplateì—ì„œ ì“°ì´ëŠ” ì“°ë¡œí‹€ë§ ë©”ì»¤ë‹ˆì¦˜ì„ ë°”ê¾¸ê³  ì‹¶ë‹¤ë©´, bounded task queueë¥¼ ê°€ì§„ TaskExecutor ê¸°ë°˜ì˜ ì»¤ìŠ¤í…€ RepeatOperations êµ¬í˜„ì²´ë¥¼ ë§Œë“¤ì–´ì„œ, StepBuilder#stepOperationsì— ë„£ì–´ì•¼ í•©ë‹ˆë‹¤:@Beanpublic Step sampleStep(RepeatOperations customRepeatOperations, JobRepository jobRepository, PlatformTransactionManager transactionManager) { return new StepBuilder(\"sampleStep\", jobRepository) .&lt;String, String&gt;chunk(10, transactionManager) .reader(itemReader()) .writer(itemWriter()) .stepOperations(customRepeatOperations) .build();}ì£¼ì˜ì‚¬í•­ Stepì˜ ë§ì€ êµ¬ì„± ìš”ì†Œ(ì˜ˆ: Reader, Writer)ëŠ” stateful í•©ë‹ˆë‹¤. FlatFileItemReaderëŠ” íŒŒì¼ í¬ì¸í„°(cursor)ë¥¼ ê°–ê³  ìˆì–´ì„œ ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ë™ì‹œì— ì ‘ê·¼í•˜ë©´ ê¼¬ì„. JdbcCursorItemReaderë„ DB ì»¤ì„œ ê¸°ë°˜ì´ë¼ ë©€í‹°ìŠ¤ë ˆë“œì— ì í•©í•˜ì§€ ì•ŠìŒ. ë°˜ë©´, JdbcPagingItemReaderëŠ” Stateless Reader ë§Œì•½ ì´ ìƒíƒœê°€ ìŠ¤ë ˆë“œë³„ë¡œ ë¶„ë¦¬ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´, ë©€í‹°ìŠ¤ë ˆë“œ Stepì—ì„œëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŠ¹íˆ, Spring Batchê°€ ì œê³µí•˜ëŠ” ëŒ€ë¶€ë¶„ì˜ Readerì™€ WriterëŠ” ë©€í‹°ìŠ¤ë ˆë“œ ìš©ë„ë¡œ ì„¤ê³„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜, stateless ë˜ëŠ” thread-safeí•œ Reader/Writerë¥¼ ì‚¬ìš©í•œë‹¤ë©´ ê°€ëŠ¥í•˜ë©°, Spring Batch ìƒ˜í”Œì—ì„œëŠ” DB ì…ë ¥ í…Œì´ë¸”ì— ì²˜ë¦¬ ì—¬ë¶€ í”Œë˜ê·¸(process indicator)ë¥¼ ë‘ì–´ ì–´ë–¤ ì•„ì´í…œì´ ì´ë¯¸ ì²˜ë¦¬ë˜ì—ˆëŠ”ì§€ ì¶”ì í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤ë‹ˆë‹¤. Spring BatchëŠ” ì¼ë¶€ ItemWriter, ItemReader êµ¬í˜„ì„ ì œê³µí•©ë‹ˆë‹¤. Javadocì— thread-safe ì—¬ë¶€ ë˜ëŠ” ë™ì‹œì„± í™˜ê²½ì—ì„œ í”¼í•´ì•¼ í•  ë¬¸ì œê°€ ëª…ì‹œë˜ì–´ ìˆëŠ” ê²½ìš°ê°€ ë§ìŠµë‹ˆë‹¤. ì •ë³´ê°€ ì—†ë‹¤ë©´ êµ¬í˜„ì²´ë¥¼ ì§ì ‘ í™•ì¸í•´ ìƒíƒœ(state)ê°€ ìˆëŠ”ì§€ ì‚´í´ì•¼ í•©ë‹ˆë‹¤. ë§Œì•½ Readerê°€ thread-safeí•˜ì§€ ì•Šë‹¤ë©´, SynchronizedItemStreamReaderë¡œ ê°ì‹¸ê±°ë‚˜, ì§ì ‘ ë™ê¸°í™” ë˜í¼ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. read() í˜¸ì¶œì„ ë™ê¸°í™”í•˜ë©´, ë¹„ë¡ ì½ê¸° ìì²´ëŠ” ì§ë ¬í™”ë˜ë”ë¼ë„, ì²˜ë¦¬(processing)ì™€ ì“°ê¸°(writing) ë‹¨ê³„ê°€ ì²­í¬ ë‚´ì—ì„œ ê°€ì¥ ë¹„ìš©ì´ í° ë¶€ë¶„ì´ë¼ë©´, ì „ì²´ Stepì€ ì—¬ì „íˆ ì‹±ê¸€ìŠ¤ë ˆë“œë³´ë‹¤ í›¨ì”¬ ë¹ ë¥´ê²Œ ëë‚  ìˆ˜ ìˆìŠµë‹ˆë‹¤.ì˜ˆì‹œ@Configuration@EnableBatchProcessingpublic class OrderBatchConfig { private final DataSource dataSource; public OrderBatchConfig(DataSource dataSource) { this.dataSource = dataSource; } // ë©€í‹°ìŠ¤ë ˆë“œìš© TaskExecutor @Bean public ThreadPoolTaskExecutor taskExecutor() { ThreadPoolTaskExecutor executor = new ThreadPoolTaskExecutor(); executor.setCorePoolSize(8); // ë™ì‹œì— ì‹¤í–‰í•  ìŠ¤ë ˆë“œ ìˆ˜ executor.setMaxPoolSize(8); // ìµœëŒ€ ìŠ¤ë ˆë“œ ìˆ˜ë„ ë™ì¼í•˜ê²Œ ì„¤ì • executor.setQueueCapacity(0); // bounded queue â†’ ë¬´í•œ í ë°©ì§€ executor.setThreadNamePrefix(\"spring_batch-\"); executor.initialize(); return executor; } // Reader (í˜ì´ì§• ê¸°ë°˜, ë©€í‹°ìŠ¤ë ˆë“œ ì•ˆì „) @Bean public JdbcPagingItemReader&lt;Order&gt; orderReader() throws Exception { JdbcPagingItemReader&lt;Order&gt; reader = new JdbcPagingItemReader&lt;&gt;(); reader.setDataSource(dataSource); reader.setPageSize(100); SqlPagingQueryProviderFactoryBean queryProvider = new SqlPagingQueryProviderFactoryBean(); queryProvider.setDataSource(dataSource); queryProvider.setSelectClause(\"id, customer_id, status\"); queryProvider.setFromClause(\"from orders\"); queryProvider.setWhereClause(\"where status = 'NEW'\"); queryProvider.setSortKeys(Map.of(\"id\", Order.ASCENDING)); reader.setQueryProvider(queryProvider.getObject()); reader.setRowMapper((rs, rowNum) -&gt; new Order( rs.getLong(\"id\"), rs.getLong(\"customer_id\"), rs.getString(\"status\") )); return reader; } // Processor (ìƒíƒœ ë³€ê²½) @Bean public ItemProcessor&lt;Order, Order&gt; orderProcessor() { return order -&gt; { order.setStatus(\"PROCESSED\"); return order; }; } // Writer (Batch update) @Bean public JdbcBatchItemWriter&lt;Order&gt; orderWriter() { return new JdbcBatchItemWriterBuilder&lt;Order&gt;() .dataSource(dataSource) .sql(\"UPDATE orders SET status = :status WHERE id = :id\") .beanMapped() .build(); } // Step ì •ì˜ (ë©€í‹°ìŠ¤ë ˆë“œ ì ìš©) @Bean public Step processOrdersStep(JobRepository jobRepository, PlatformTransactionManager transactionManager) throws Exception { return new StepBuilder(\"processOrdersStep\", jobRepository) .&lt;Order, Order&gt;chunk(100, transactionManager) .reader(orderReader()) .processor(orderProcessor()) .writer(orderWriter()) .taskExecutor(taskExecutor()) // ë©€í‹°ìŠ¤ë ˆë“œ ì‹¤í–‰ .build(); } // Job ì •ì˜ @Bean public Job orderJob(JobRepository jobRepository, Step processOrdersStep) { return new JobBuilder(\"orderJob\", jobRepository) .start(processOrdersStep) .build(); }}í˜ì´ì§• ì²˜ë¦¬ ë°©ì‹ JdbcPagingItemReaderëŠ” pageSize ë‹¨ìœ„ë¡œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•´ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì „ì²´ ì¡°íšŒ ëŒ€ìƒì´ 10000ê°œì´ê³  pageSize=100ì´ë©´: 1ì°¨ ì¿¼ë¦¬ : where status='NEW' order by id limit 100 offset 0 2ì°¨ ì¿¼ë¦¬ : where status='NEW' order by id limit 100 offset 100 ì´ëŸ° ì‹ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ ë‚ ë ¤ì„œ 10000ê°œë¥¼ ëŠì–´ì„œ ê°€ì ¸ì˜µë‹ˆë‹¤. ë”°ë¼ì„œ ì¤‘ë³µ ì—†ì´ ì „ì²´ 10000ê°œë¥¼ ë‹¤ ì½ìŠµë‹ˆë‹¤.(ë‹¨, ì—¬ê¸°ì„œ ì •ë ¬ ê¸°ì¤€ sortKeysë¥¼ ë°˜ë“œì‹œ ì§€ì •í•´ì•¼ ì•ˆì •ì ìœ¼ë¡œ pagingì´ ë©ë‹ˆë‹¤. ë³´í†µ id ASC ê°™ì€ ë‹¨ì¼ PK ê¸°ì¤€ì„ ë§ì´ ì”ë‹ˆë‹¤.) pageSize &gt; chunkSize ì´ë©´ ? ì´ ëŒ€ìƒ ë°ì´í„° : 10,000ê°œ (status=NEW) chunkSize = 100 pageSize = 1000 Reader DBì—ì„œ 1000ê°œë¥¼ í•œ ë²ˆì— select í•´ì™€ì„œ ë©”ëª¨ë¦¬ì— ë“¤ê³  ìˆìŒ. ì˜ˆ: id 1 ~ 1000 Processor &amp; Writer ì½ì–´ì˜¨ 1000ê°œ ì¤‘ 100ê°œì”© ì˜ë¼ì„œ Processor â†’ Writer â†’ commit ì‹¤í–‰. ì¦‰, ê°™ì€ 1000ê°œ ë°ì´í„°ë¥¼ ë‚´ë¶€ ë²„í¼ì—ì„œ 10ë²ˆ(=1000/100) ë°˜ë³µí•´ì„œ ì²˜ë¦¬. ë‹¤ìŒ Reader í˜¸ì¶œ Readerê°€ ë‹¤ì‹œ DBì— ì¿¼ë¦¬ â†’ ë‹¤ìŒ 1000ê°œ(id 1001~2000) ê°€ì ¸ì˜´. ê·¸ ì•ˆì—ì„œë„ chunk ë‹¨ìœ„(100)ë¡œ ë‚˜ëˆ ì„œ 10ë²ˆ commit. ê²°ê³¼ DBëŠ” 10ë²ˆ(=10000 / 1000)ë§Œ ì¡°íšŒí•¨. Processor/WriterëŠ” ì—¬ì „íˆ 100ê°œ ë‹¨ìœ„ë¡œ ë™ì‘í•´ì„œ ì´ 100ë²ˆ commit(=10000 / 100). ì¦‰, pageSizeëŠ” â€œDB fetch ë‹¨ìœ„â€, chunkSizeëŠ” â€œíŠ¸ëœì­ì…˜ ì²˜ë¦¬ ë‹¨ìœ„â€ë¼ëŠ” ì ì´ ë“œëŸ¬ë‚¨. ì°¸ê³  ìë£Œ https://docs.spring.io/spring-batch/reference/scalability.html" }, { "title": "Spring Batch ì•Œì•„ë³´ê¸°", "url": "/posts/what-is-spring-batch/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Spring Batch", "date": "2025-08-22 21:25:00 +0900", "snippet": "Spring Batch Spring BatchëŠ” ì—”í„°í”„ë¼ì´ì¦ˆ ì‹œìŠ¤í…œì˜ í•µì‹¬ ì¼ìƒ ì—…ë¬´(vital for the daily operations)ë¥¼ ìœ„í•œ ê²¬ê³ í•œ ë°°ì¹˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì„ ì§€ì›í•˜ëŠ” ê²½ëŸ‰Â·ì¢…í•© í”„ë ˆì„ì›Œí¬ Spring BatchëŠ” ìƒì‚°ì„±, POJO ê¸°ë°˜ ê°œë°œ, ì‰¬ìš´ ì‚¬ìš©ì„± ê°™ì€ ìŠ¤í”„ë§ íŠ¹ì„±ì„ ê³„ìŠ¹í•˜ë©´ì„œ, í•„ìš” ì‹œ ê³ ê¸‰ ì—”í„°í”„ë¼ì´ì¦ˆ ì„œë¹„ìŠ¤ë„ ...", "content": "Spring Batch Spring BatchëŠ” ì—”í„°í”„ë¼ì´ì¦ˆ ì‹œìŠ¤í…œì˜ í•µì‹¬ ì¼ìƒ ì—…ë¬´(vital for the daily operations)ë¥¼ ìœ„í•œ ê²¬ê³ í•œ ë°°ì¹˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì„ ì§€ì›í•˜ëŠ” ê²½ëŸ‰Â·ì¢…í•© í”„ë ˆì„ì›Œí¬ Spring BatchëŠ” ìƒì‚°ì„±, POJO ê¸°ë°˜ ê°œë°œ, ì‰¬ìš´ ì‚¬ìš©ì„± ê°™ì€ ìŠ¤í”„ë§ íŠ¹ì„±ì„ ê³„ìŠ¹í•˜ë©´ì„œ, í•„ìš” ì‹œ ê³ ê¸‰ ì—”í„°í”„ë¼ì´ì¦ˆ ì„œë¹„ìŠ¤ë„ ì‰½ê²Œ í™œìš©í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤. Spring BatchëŠ” ìŠ¤ì¼€ì¤„ë§ í”„ë ˆì„ì›Œí¬ê°€ ì•„ë‹ˆë‹¤. ìƒìš©Â·ì˜¤í”ˆì†ŒìŠ¤ ì˜ì—­ì—ëŠ” Quartz, Tivoli, Control-M ë“± í›Œë¥­í•œ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì´ë¯¸ ìˆë‹¤. ë”°ë¼ì„œ, Spring BatchëŠ” ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ëŒ€ì²´í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼ í•¨ê»˜ ë™ì‘í•˜ë„ë¡ ì„¤ê³„ë˜ì—ˆë‹¤. Spring BatchëŠ” ëŒ€ê·œëª¨ ë°ì´í„° ì²˜ë¦¬ì— í•„ìˆ˜ì ì¸ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ê¸°ëŠ¥(ë¡œê·¸/ì¶”ì , íŠ¸ëœì­ì…˜ ê´€ë¦¬, ì‹¤í–‰ í†µê³„, ì¬ì‹œì‘, ìŠ¤í‚µ, ë¦¬ì†ŒìŠ¤ ê´€ë¦¬)ì„ ì œê³µí•œë‹¤. ë˜í•œ ìµœì í™”Â·íŒŒí‹°ì…”ë‹ ê¸°ë²•ì„ í†µí•´ ì´ˆëŒ€ê·œëª¨Â·ê³ ì„±ëŠ¥ ë°°ì¹˜ ì‘ì—…ì„ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê³ ê¸‰ ê¸°ëŠ¥ë„ ì œê³µí•œë‹¤. ì¦‰, ëŒ€ê·œëª¨ ë°ì´í„° ì²˜ë¦¬ ì‘ì—… ë° ìš´ì˜ì„ ì•ˆì •ì ì´ê³  í¸ë¦¬í•˜ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” í”„ë ˆì„ì›Œí¬ì´ë‹¤.ì£¼ìš” ê°œë…Chunk-based processing ëŒ€ìš©ëŸ‰ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” í•µì‹¬ íŒ¨í„´ ë°ì´í„°ë¥¼ ì¼ì • ë‹¨ìœ„(ì˜ˆ: 1000ê±´)ë¡œ ë¬¶ì–´ ì²˜ë¦¬ ë©”ëª¨ë¦¬ ì ˆì•½, ì•ˆì •ì  ì²˜ë¦¬, ì¬ì‹œì‘ ìš©ì´Transaction management ë°°ì¹˜ ì²˜ë¦¬ì—ì„œ ë°ì´í„° ì¼ê´€ì„±ì„ ë³´ì¥ Chunk ë‹¨ìœ„ íŠ¸ëœì­ì…˜ ë³´ì¥ (ì‹¤íŒ¨ ì‹œ í•´ë‹¹ Chunkë§Œ ë¡¤ë°± ê°€ëŠ¥)Declarative I/O ë³µì¡í•œ I/O ë¡œì§ì„ ê°„ë‹¨í•œ ì„¤ì •ìœ¼ë¡œ ì²˜ë¦¬ ItemReader, ItemWriter ê°™ì€ í‘œì¤€ ì»´í¬ë„ŒíŠ¸ ì œê³µ ItemReader: ë°ì´í„°ë² ì´ìŠ¤, íŒŒì¼, ë©”ì‹œì§€ í ë“± ë‹¤ì–‘í•œ ì†ŒìŠ¤ì—ì„œ ë°ì´í„° ì½ê¸° ItemWriter: ë‹¤ì–‘í•œ í˜•íƒœë¡œ ë°ì´í„° ì¶œë ¥ (DB ì €ì¥, íŒŒì¼ ì“°ê¸°, API í˜¸ì¶œ ë“±) Start / Stop / Restart ë°°ì¹˜ ì‘ì—…ì˜ ìš´ì˜ í¸ì˜ì„±ì„ ì œê³µ JobRepository: ì‘ì—… ì‹¤í–‰ ìƒíƒœì™€ ë©”íƒ€ë°ì´í„°ë¥¼ ì €ì¥ ì‹¤í–‰í•œ Job/Stepì˜ ìƒíƒœ, ì‹œì‘Â·ì¢…ë£Œ ì‹œê°„, ì²˜ë¦¬ ê±´ìˆ˜, ì‹¤íŒ¨ ì›ì¸ ë“± Jobì˜ ì´ë ¥ ê´€ë¦¬ ê°€ëŠ¥ (ì–¸ì œ ì–´ë–¤ ë°ì´í„°ê°€ ì²˜ë¦¬ë˜ì—ˆëŠ”ì§€ ì¶”ì ) ì¬ì‹œì‘ ì§€ì›: ì‹¤íŒ¨ ì§€ì ë¶€í„° ë‹¤ì‹œ ì‹œì‘ ê°€ëŠ¥ (ì´ë¯¸ ì²˜ë¦¬ëœ ë¶€ë¶„ì€ ê±´ë„ˆëœ€) ì¤‘ë‹¨ í›„ ì¬ê°œ: ì•ˆì „í•˜ê²Œ ì‘ì—…ì„ ì¤‘ë‹¨í•˜ê³  ë‚˜ì¤‘ì— ì´ì–´ì„œ ì‹¤í–‰Retry / Skip ì˜¤ë¥˜ ìƒí™©ì— ëŒ€í•œ ìœ ì—°í•œ ì²˜ë¦¬ ì •ì±…ì„ ì œê³µ Retry: ì¼ì‹œì  ì˜¤ë¥˜(ë„¤íŠ¸ì›Œí¬ ëŠê¹€ ë“±) ë°œìƒ ì‹œ ì§€ì •ëœ íšŸìˆ˜ë§Œí¼ ì¬ì‹œë„ Skip: íŠ¹ì • ì˜¤ë¥˜ëŠ” ë¬´ì‹œí•˜ê³  ë‹¤ìŒ ë°ì´í„°ë¡œ ë„˜ì–´ê°€ê¸° ì •ì±… ì„¤ì •: ì–´ë–¤ ì˜ˆì™¸ì— ëŒ€í•´ ëª‡ ë²ˆ ì¬ì‹œë„í• ì§€, ì–´ë–¤ ì˜ˆì™¸ëŠ” ê±´ë„ˆë›¸ì§€ ì„¸ë°€í•˜ê²Œ ì œì–´Job / Step êµ¬ì¡° Job: í•˜ë‚˜ì˜ ë°°ì¹˜ ì‘ì—… ë‹¨ìœ„ (ì˜ˆ: â€œì›”ë§ ì •ì‚° ì‘ì—…â€) Step: Jobì„ êµ¬ì„±í•˜ëŠ” ì„¸ë¶€ ë‹¨ê³„ (ì˜ˆ: â€œDBì—ì„œ ë°ì´í„° ì½ê¸° â†’ ê°€ê³µ â†’ ê²°ê³¼ ì €ì¥â€) ì´ë¥¼ í†µí•´, êµ¬ì¡°í™”ëœ ëª¨ë¸ ë•ë¶„ì— ì‘ì—…ì„ ì˜ê²Œ ë‚˜ëˆ„ê³ , ì¬ì‚¬ìš©Â·ì¡°í•©ì´ ê°€ëŠ¥í•´ì§. ì˜ˆ: ë™ì¼í•œ DB ì½ê¸° Stepì„ ë‹¤ë¥¸ Jobì—ì„œë„ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŒ. Scalability ë©€í‹°ìŠ¤ë ˆë“œ Step: í•œ Stepì„ ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¡œ ë¶„í•  ì²˜ë¦¬ Partitioning: ë°ì´í„°ë¥¼ ì—¬ëŸ¬ íŒŒí‹°ì…˜ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ë³‘ë ¬ ì²˜ë¦¬ Remote Chunking: â€œì½ê¸°/ì²˜ë¦¬â€ì™€ â€œì“°ê¸°â€ë¥¼ ë¶„ì‚° ë…¸ë“œì—ì„œ ì‹¤í–‰ Remote Partitioning: Step ìì²´ë¥¼ ì›ê²© ì›Œì»¤ë“¤ì— ë¶„ì‚° ëŒ€ê·œëª¨ ë°ì´í„°ë„ ë¶„ì‚°Â·ë³‘ë ¬ í™˜ê²½ì—ì„œ ì²˜ë¦¬ ê°€ëŠ¥Tasklet Step ì•ˆì—ì„œ í•œ ë²ˆì— ì‹¤í–‰í•  ì‘ì—…(Task)ì„ êµ¬í˜„í•˜ëŠ” ë°©ì‹ ì¸í„°í˜ì´ìŠ¤: Tasklet â†’ RepeatStatus execute(StepContribution, ChunkContext) ë©”ì„œë“œ êµ¬í˜„ ë°˜ë³µ ì²˜ë¦¬(Chunk ê¸°ë°˜)ê°€ í•„ìš” ì—†ëŠ” ë‹¨ìˆœ ë¡œì§ì— ì í•© ì˜ˆ: íŠ¹ì • í…Œì´ë¸” ì´ˆê¸°í™”, íŒŒì¼ ì‚­ì œ, ì™¸ë¶€ API í•œ ë²ˆ í˜¸ì¶œ ì„ ì–¸í˜• Chunk ëª¨ë¸ë³´ë‹¤ Spring MVC + @Service ìŠ¤íƒ€ì¼ê³¼ ìœ ì‚¬ í•˜ì§€ë§Œ Spring Batch ì‹¤í–‰ ëª¨ë¸(Job/Step, JobRepository, ì¬ì‹œì‘ ì§€ì› ë“±) ìœ„ì—ì„œ ë™ì‘í•˜ë¯€ë¡œ, ë‹¨ìˆœ ë¡œì§ë„ ìš´ì˜ ë©”íƒ€ë°ì´í„° ê´€ë¦¬, ì¬ì‹œì‘, ìŠ¤ì¼€ì¤„ë§ ì—°ë™ í˜œíƒì„ ë°›ìŒ ì˜ˆì‹œ: ì•„ë˜ ì½”ë“œ ì‹¤í–‰ ì¤‘ ì™¸ë¶€ API í˜¸ì¶œì´ ë„¤íŠ¸ì›Œí¬ ë¬¸ì œë¡œ ì‹¤íŒ¨í–ˆë‹¤ë©´? Job ìƒíƒœê°€ FAILEDë¡œ ê¸°ë¡ë¨ restart í•˜ë©´ í•´ë‹¹ Stepë§Œ ë‹¤ì‹œ ì‹¤í–‰ â†’ ì¤‘ê°„ë¶€í„° ì´ì–´ì„œ ì²˜ë¦¬ ê°€ëŠ¥ @Beanpublic Step apiStep(JobRepository jobRepository, PlatformTransactionManager transactionManager) { return new StepBuilder(\"apiStep\", jobRepository) .tasklet((contribution, chunkContext) -&gt; { externalApi.call(...); // ì™¸ë¶€ API í˜¸ì¶œ return RepeatStatus.FINISHED; }, transactionManager) .allowStartIfComplete(false) // ì´ë¯¸ ì„±ê³µí•œ Stepì€ ì¬ì‹¤í–‰ ì•ˆ í•¨ .build();} Tasklet vs Chunk êµ¬ë¶„ Chunk ê¸°ë°˜ ì²˜ë¦¬ Tasklet ê¸°ë°˜ ì²˜ë¦¬ ì²˜ë¦¬ ë°©ì‹ ë°ì´í„°ë¥¼ ì½ê¸°-ì²˜ë¦¬-ì“°ê¸°(Reader/Processor/Writer) íŒ¨í„´ìœ¼ë¡œ ë°˜ë³µ ì‹¤í–‰ execute() ë©”ì„œë“œ ì•ˆì—ì„œ ë‹¨ì¼ ì‘ì—… ìˆ˜í–‰ ì í•©í•œ ì‹œë‚˜ë¦¬ì˜¤ - ëŒ€ëŸ‰ ë°ì´í„°(ìˆ˜ì²œ~ìˆ˜ì–µ ê±´)- ì£¼ê¸°ì ì¸ ì •ì‚°/ì§‘ê³„- DB â†’ íŒŒì¼, íŒŒì¼ â†’ DB ì ì¬- ë°ì´í„° ë³€í™˜, ETL íŒŒì´í”„ë¼ì¸ - ë‹¨ìˆœ ì‘ì—…(í•œë‘ ë²ˆ ì‹¤í–‰)- í…Œì´ë¸” ì´ˆê¸°í™”/ë°±ì—…- ì™¸ë¶€ API í˜¸ì¶œ 1íšŒ- íŒŒì¼ ì••ì¶•/ì‚­ì œ íŠ¸ëœì­ì…˜ ê´€ë¦¬ Chunk ë‹¨ìœ„ íŠ¸ëœì­ì…˜ (ì˜ˆ: 1000ê±´ì”© ì»¤ë°‹) â†’ ì‹¤íŒ¨ ì‹œ í•´ë‹¹ Chunkë§Œ ë¡¤ë°± ë³´í†µ ì „ì²´ Stepì´ 1 íŠ¸ëœì­ì…˜ â†’ ì‹¤íŒ¨ ì‹œ ì „ì²´ ë¡¤ë°± ì¬ì‹œì‘(Checkpoint) ë§ˆì§€ë§‰ ì»¤ë°‹ëœ Chunk ìœ„ì¹˜ë¶€í„° ì´ì–´ì„œ ì‹¤í–‰ ê°€ëŠ¥ Step ìì²´ê°€ ë‹¨ì¼ ì‹¤í–‰ ë‹¨ìœ„ â†’ ì‹¤íŒ¨ ì‹œ Step ì „ì²´ ì¬ì‹¤í–‰ Retry/Skip ì„ ì–¸ì ìœ¼ë¡œ ì„¤ì • ê°€ëŠ¥ (.retry(), .skip()) â†’ ë°ì´í„° ë‹¨ìœ„ ì˜ˆì™¸ ì²˜ë¦¬ ë³„ë„ ë¡œì§ ì‘ì„± í•„ìš” (try-catch ì•ˆì—ì„œ ìˆ˜ë™ êµ¬í˜„) ìš´ì˜ í¸ì˜ì„± ëŒ€ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ì‹œ ì•ˆì •ì„±, í™•ì¥ì„± ë›°ì–´ë‚¨ ë‹¨ìˆœ ë¡œì§ë„ Job/Step ë©”íƒ€ë°ì´í„°ì— ê¸°ë¡ë˜ë¯€ë¡œ ìš´ì˜ ì¶”ì  ê°€ëŠ¥ ë¹„êµ ë¹„ìœ  â€œì—‘ì…€ì—ì„œ 100ë§Œ í–‰ ë°ì´í„°ë¥¼ 1000í–‰ì”© ëŠì–´ì„œ ì²˜ë¦¬â€ â€œë²„íŠ¼ í•œ ë²ˆ ëˆ„ë¥´ë©´ í…Œì´ë¸” ì‚­ì œâ€ ê°™ì€ ë‹¨ì¼ íƒœìŠ¤í¬ ë¹„êµ : Spring MVC vs Spring Batch ì˜ˆì‹œ ìƒí™© : ëŒ€ëŸ‰ì˜ ì£¼ë¬¸ ì •ë³´ ì—…ë°ì´íŠ¸ê°€ í•„ìš”, ì—…ë°ì´íŠ¸ í•˜ë ¤ë©´ ì™¸ë¶€ api í˜¸ì¶œ í•„ìš”. Spring MVC ë°©ì‹@Servicepublic class OrderBatchService { @Transactional public void processOrders(List&lt;Order&gt; orders) { for (Order order : orders) { try { ApiResult result = externalApi.call(...); // ì™¸ë¶€ API í˜¸ì¶œ order.doSomething(result); // ì£¼ë¬¸ ìƒíƒœ ë³€ê²½ updateOrder(order); // DB ì—…ë°ì´íŠ¸ } catch (ApiException e) { // ì¬ì‹œë„ ë¡œì§ì„ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•¨ for (int i = 0; i &lt; 3; i++) { try { ApiResult result = externalApi.call(...); order.doSomething(result); updateOrder(order); break; // ì„±ê³µí•˜ë©´ íƒˆì¶œ } catch (Exception retryEx) { if (i == 2) { // ì‹¤íŒ¨ ê¸°ë¡ì„ ì§ì ‘ ê´€ë¦¬í•´ì•¼ í•¨ log.error(\"Order {} ì²˜ë¦¬ ì‹¤íŒ¨\", order.getId()); saveToFailedOrderTable(order); } } } } } }} Spring Batch@Configuration@EnableBatchProcessingpublic class OrderBatchConfig { @Bean public Job orderJob(JobRepository jobRepository, Step orderStep) { return new JobBuilder(\"orderJob\", jobRepository) .start(orderStep) .build(); } @Bean public Step orderStep(JobRepository jobRepository, PlatformTransactionManager transactionManager) { return new StepBuilder(\"orderStep\", jobRepository) .&lt;Order, Order&gt;chunk(1000, transactionManager) .reader(orderReader()) .processor(orderProcessor()) .writer(orderWriter()) .faultTolerant() .skip(ApiException.class) // íŠ¹ì • ì˜ˆì™¸ ê±´ë„ˆë›°ê¸° .skipLimit(100) // ìµœëŒ€ 100ê±´ê¹Œì§€ Skip í—ˆìš© .retry(ApiException.class) // API í˜¸ì¶œ ì‹¤íŒ¨ ì‹œ ì¬ì‹œë„ .retryLimit(3) // ìµœëŒ€ 3ë²ˆê¹Œì§€ ì¬ì‹œë„ .build(); } @Bean public JdbcPagingItemReader&lt;Order&gt; orderReader(DataSource dataSource) { return new JdbcPagingItemReaderBuilder&lt;Order&gt;() .name(\"orderReader\") .dataSource(dataSource) .selectClause(\"SELECT ...\") .fromClause(\"FROM orders\") .sortKeys(Collections.singletonMap(\"id\", Order.ASCENDING)) .pageSize(1000) .rowMapper(new BeanPropertyRowMapper&lt;&gt;(Order.class)) .build(); } @Bean public ItemProcessor&lt;Order, Order&gt; orderProcessor() { return order -&gt; { ApiResult result = externalApi.call(...); order.doSomething(result); return order; }; @Bean public JdbcBatchItemWriter&lt;Order&gt; orderWriter(DataSource dataSource) { return new JdbcBatchItemWriterBuilder&lt;Order&gt;() .dataSource(dataSource) .sql(\"UPDATE orders ...\") .beanMapped() .build(); }} í•­ëª© Spring MVC Spring Batch ì¬ì‹œë„ ì²˜ë¦¬ try-catch + ë°˜ë³µë¬¸ ì§ì ‘ êµ¬í˜„ í•„ìš” .retry(Exception.class).retryLimit(n) ìœ¼ë¡œ ì„ ì–¸ì  ì„¤ì • ìŠ¤í‚µ ì²˜ë¦¬ ì‹¤íŒ¨í•œ ê±´ì„ ë”°ë¡œ DB ì €ì¥ ë¡œì§ ì‘ì„± í•„ìš” .skip(Exception.class).skipLimit(n) ìœ¼ë¡œ ì„ ì–¸ì  ì„¤ì • ì‹¤íŒ¨ ë‚´ì—­ ê´€ë¦¬ ë³„ë„ í…Œì´ë¸”(failed_orders) ì§ì ‘ êµ¬í˜„ JobRepositoryì— ìë™ ì €ì¥ (ì‹¤íŒ¨ ê±´ìˆ˜, ì˜ˆì™¸ íƒ€ì… ë“±) ì¬ì²˜ë¦¬ ì‹¤íŒ¨ í…Œì´ë¸” ê¸°ë°˜ìœ¼ë¡œ ì¬ì²˜ë¦¬ Job ë”°ë¡œ ì‘ì„± ì‹¤íŒ¨ ì´ë ¥ ê¸°ë°˜ìœ¼ë¡œ Job/Step ì¬ì‹œì‘ ê°€ëŠ¥ ìš´ì˜ í¸ì˜ì„± ë¡œê·¸ + ìˆ˜ì‘ì—… í™•ì¸ í•„ìš” ì‹¤íŒ¨ ë‚´ì—­ì´ ë©”íƒ€DBì— ê¸°ë¡ â†’ ìš´ì˜ìê°€ ì¬ì‹¤í–‰ ê°€ëŠ¥ ê¸°íƒ€ê°œë°œ ë°°ê²½ https://docs.spring.io/spring-batch/reference/spring-batch-intro.html#springBatchBackground ì˜¤í”ˆì†ŒìŠ¤ ì»¤ë®¤ë‹ˆí‹°ëŠ” ì£¼ë¡œ ì›¹/ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ì— ì§‘ì¤‘í–ˆì§€ë§Œ, Java ê¸°ë°˜ ë°°ì¹˜ ì²˜ë¦¬ìš© ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜ í”„ë ˆì„ì›Œí¬ëŠ” ë¶€ì¡±í–ˆë‹¤. ê¸°ì—… IT í™˜ê²½ì—ì„œëŠ” ì—¬ì „íˆ ë°°ì¹˜ ì²˜ë¦¬ê°€ í•„ìš”í•œë°ë„ ë§ì´ë‹¤. í‘œì¤€ ë°°ì¹˜ í”„ë ˆì„ì›Œí¬ ë¶€ì¬ë¡œ ì¸í•´ ê¸°ì—…ë“¤ì€ ì œê°ê° ìì²´ ë°°ì¹˜ ì†”ë£¨ì…˜ì„ ê°œë°œí•´ì™”ë‹¤. SpringSource(í˜„ì¬ VMware)ì™€ Accentureê°€ ì´ë¥¼ ë°”ê¾¸ê¸° ìœ„í•´ í˜‘ë ¥í–ˆë‹¤. Accentureì˜ ì‚°ì—…/ë°°ì¹˜ ê²½í—˜, SpringSourceì˜ ê¸°ìˆ  ì „ë¬¸ì„±, Springì˜ í”„ë¡œê·¸ë˜ë° ëª¨ë¸ì´ í•©ì³ì ¸ ì—”í„°í”„ë¼ì´ì¦ˆ Javaì˜ ê³µë°±ì„ ë©”ìš°ëŠ” ê³ í’ˆì§ˆ ë°°ì¹˜ í”„ë ˆì„ì›Œí¬ê°€ íƒ„ìƒí–ˆë‹¤. ë‘ íšŒì‚¬ëŠ” ê³ ê°ë“¤ê³¼ í˜‘ë ¥í•˜ë©° Spring ê¸°ë°˜ ë°°ì¹˜ ì•„í‚¤í…ì²˜ë¥¼ êµ¬ì¶•í–ˆê³ , ì´ ê²½í—˜ì´ í˜„ì‹¤ ì œì•½ ì¡°ê±´ê³¼ ìš”êµ¬ì‚¬í•­ì„ ë°˜ì˜í•´ ì‹¤ì œ ë¬¸ì œì— ì ìš© ê°€ëŠ¥í•œ ì†”ë£¨ì…˜ì„ ë§Œë“œëŠ” ë° ê¸°ì—¬í–ˆë‹¤. AccentureëŠ” ê³¼ê±° ì‚¬ë‚´ ë…ì  ë°°ì¹˜ í”„ë ˆì„ì›Œí¬ì™€ ê°œë°œì ë¦¬ì†ŒìŠ¤ë¥¼ Spring Batchì— ê¸°ì—¬í•´ ê¸°ëŠ¥ í™•ì¥ê³¼ ì§€ì›ì„ ì œê³µí–ˆë‹¤. AccentureëŠ” ë©”ì¸í”„ë ˆì„ COBOL, ìœ ë‹‰ìŠ¤ C++, ìë°” ê¸°ë°˜ ì•„í‚¤í…ì²˜ ë“± ìˆ˜ì‹­ ë…„ê°„ì˜ ë°°ì¹˜ ê²½í—˜ì„ í† ëŒ€ë¡œ ê¸°ì—¬í–ˆë‹¤. Accentureì™€ SpringSourceì˜ í˜‘ë ¥ ëª©í‘œëŠ” ì—”í„°í”„ë¼ì´ì¦ˆ ITì—ì„œ ë°°ì¹˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ ì‹œ ì¬ì‚¬ìš© ê°€ëŠ¥í•œ í‘œì¤€ í”„ë ˆì„ì›Œí¬ë¥¼ ë§Œë“œëŠ” ê²ƒì´ì—ˆë‹¤. í‘œì¤€í™”ë˜ê³  ê²€ì¦ëœ ì†”ë£¨ì…˜ì„ ì›í•˜ëŠ” ê¸°ì—…Â·ì •ë¶€ ê¸°ê´€ì€ Spring Batchë¡œë¶€í„° í˜œíƒì„ ì–»ì„ ìˆ˜ ìˆë‹¤.ë³„ë„ì˜ í”„ë¡œì íŠ¸ ? Spring Framework í”„ë¡œì íŠ¸ì—ì„œ í•˜ë‚˜ì˜ ëª¨ë“ˆì´ ì•„ë‹Œ ë³„ë„ì˜ Spring Batch í”„ë¡œì íŠ¸ë¡œ ê´€ë¦¬ëœë‹¤. (ì°¸ê³  : github repo) Spring Web MVCëŠ” Spring Frameworkì˜ í•˜ë‚˜ì˜ ëª¨ë“ˆë¡œ ê´€ë¦¬ëœë‹¤. Spring Batchë„ spring-aop, spring-beans ë“±ì˜ í•µì‹¬ ëª¨ë“ˆì„ ì‚¬ìš©í•˜ëŠ”ë°, ì™œ ë³„ë„ì˜ í”„ë¡œì íŠ¸ë¡œ ë¶„ë¦¬ë˜ì—ˆì„ê¹Œ? GPTì—ê²Œ ë¬¼ì–´ë³´ì•˜ë‹¤. (ë§ëŠ”ì§€ëŠ” ëª¨ë¥´ê² ë‹¤)1. ì—­í• ê³¼ ì„±ê²©ì´ ë‹¤ë¥¸ ê¸°ëŠ¥- Spring FrameworkëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ë°˜ì˜ ê¸°ë°˜ ê¸°ëŠ¥(IOC ì»¨í…Œì´ë„ˆ, AOP, íŠ¸ëœì­ì…˜, ì›¹ MVC ë“±)ì„ ì œê³µí•˜ëŠ” í•µì‹¬ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.- Spring BatchëŠ” ë°°ì¹˜ ì²˜ë¦¬ì— íŠ¹í™”ëœ ê¸°ëŠ¥(ì¡/ìŠ¤í… ì •ì˜, ì¡ ì‹¤í–‰ ê´€ë¦¬, ë¦¬ìŠ¤íƒ€íŠ¸/ìŠ¤í‚µ/ë¦¬íŠ¸ë¼ì´, ì²­í¬ ê¸°ë°˜ ì²˜ë¦¬ ë“±)ì„ ì œê³µí•˜ëŠ” ì‘ìš© ê³„ì¸µ í”„ë ˆì„ì›Œí¬ì…ë‹ˆë‹¤.- ì¦‰, BatchëŠ” **ë„ë©”ì¸ íŠ¹í™” ê¸°ëŠ¥(DSF, Domain-Specific Framework)**ì— ê°€ê¹ê¸° ë•Œë¬¸ì—, ì½”ì–´ í”„ë ˆì„ì›Œí¬ì™€ ê°™ì€ ë ˆë²¨ì—ì„œ ê´€ë¦¬í•˜ê¸°ë³´ë‹¤ëŠ” ë³„ë„ì˜ ë…ë¦½ í”„ë¡œì íŠ¸ë¡œ ë¶„ë¦¬í•˜ëŠ” ê²Œ ë” ì ì ˆí–ˆìŠµë‹ˆë‹¤.2. ë¦´ë¦¬ìŠ¤ ì£¼ê¸° ë° ë²„ì „ ë…ë¦½ì„±- Spring FrameworkëŠ” ì „ë°˜ì ì¸ ìƒíƒœê³„ì— ì˜í–¥ì„ ì£¼ë¯€ë¡œ ì•ˆì •ì ì´ê³  ë³´ìˆ˜ì ì¸ ë¦´ë¦¬ìŠ¤ ì£¼ê¸°ê°€ í•„ìš”í•©ë‹ˆë‹¤.- Spring BatchëŠ” íŠ¹ì • ê¸°ì—… í™˜ê²½(ê¸ˆìœµ, ëŒ€ê·œëª¨ ë°ì´í„° ì²˜ë¦¬ ë“±) ìš”êµ¬ì‚¬í•­ì— ë§ì¶”ì–´ ë” ë¹ ë¥´ê²Œ ë°œì „í•˜ê±°ë‚˜ ë…ìì ìœ¼ë¡œ íŒ¨ì¹˜ë  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.- ë³„ë„ í”„ë¡œì íŠ¸ë¡œ ë¶„ë¦¬í•¨ìœ¼ë¡œì¨ Spring Framework ë¦´ë¦¬ìŠ¤ì™€ ê°•í•˜ê²Œ ë¬¶ì´ì§€ ì•Šê³ , ë…ìì ì¸ ë¦´ë¦¬ìŠ¤ ì£¼ê¸°ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.3. ì‚¬ìš©ì ëŒ€ìƒì˜ ë²”ìœ„ ì°¨ì´- Spring FrameworkëŠ” ê±°ì˜ ëª¨ë“  Spring ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œìê°€ ì‚¬ìš©í•˜ëŠ” ë²”ìš© í”Œë«í¼ì…ë‹ˆë‹¤.- Spring BatchëŠ” **ë°°ì¹˜ ì²˜ë¦¬(ETL, ëŒ€ê·œëª¨ DB ë§ˆì´ê·¸ë ˆì´ì…˜, ì •ì‚° ì‘ì—… ë“±)**ë¥¼ ìˆ˜í–‰í•˜ëŠ” íŠ¹ì • ì¼€ì´ìŠ¤ì—ì„œë§Œ í•„ìš”í•©ë‹ˆë‹¤.- ë”°ë¼ì„œ ì¼ë°˜ì ì¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œìê°€ ê¼­ ê°€ì ¸ê°€ì•¼ í•˜ëŠ” ëª¨ë“ˆì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì—, ì„ íƒì ìœ¼ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆë„ë¡ ë³„ë„ í”„ë¡œì íŠ¸ë¡œ ë¶„ë¦¬í•œ ê²ë‹ˆë‹¤.4. íŒ€/í”„ë¡œì íŠ¸ ê´€ë¦¬ìƒì˜ ì´ìœ - Spring BatchëŠ” ì´ˆê¸°ì— Accentureì™€ SpringSourceê°€ í˜‘ë ¥í•´ì„œ ë§Œë“  í”„ë¡œì íŠ¸ì…ë‹ˆë‹¤.- ì¦‰, ì‹œì‘ë¶€í„° **ì™¸ë¶€ íŒŒíŠ¸ë„ˆì‹­ê³¼ íŠ¹ì • ìš”êµ¬ì‚¬í•­(ê¸°ì—…ìš© ë°°ì¹˜ ì²˜ë¦¬)**ì„ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆê¸° ë•Œë¬¸ì— Spring Framework ì½”ì–´ì— ë°”ë¡œ ë“¤ì–´ê°€ê¸°ë³´ë‹¤ëŠ” ë…ë¦½ëœ í”„ë¡œì íŠ¸ë¡œ ì¶œë°œí•˜ëŠ” ê²Œ ìì—°ìŠ¤ëŸ¬ì› ìŠµë‹ˆë‹¤.- ì§€ê¸ˆë„ Spring íŒ€ì€ Framework, Boot, Data, Security, Batch ë“±ì„ í”„ë¡œì íŠ¸ ë‹¨ìœ„ë¡œ ê´€ë¦¬í•©ë‹ˆë‹¤.ì°¸ê³  ìë£Œ https://spring.io/projects/spring-batch#overview https://docs.spring.io/spring-batch/reference/spring-batch-intro.html" }, { "title": "Spring - Spring Boot ì•Œì•„ë³´ê¸°", "url": "/posts/what-is-spring-boot/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Spring", "date": "2025-08-21 21:25:00 +0900", "snippet": "Spring Bootì˜ ëª©í‘œ ëª¨ë“  Spring ê°œë°œì—ì„œ ê·¹ì ìœ¼ë¡œ ë¹ ë¥´ê³  ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ì ‘ê·¼ ê°€ëŠ¥í•œ ì‹œì‘ ê²½í—˜ì„ ì œê³µí•˜ëŠ” ê²ƒ.â†’ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•  ë•Œ ë³µì¡í•œ ì„¤ì • ì—†ì´ ë°”ë¡œ ê°œë°œì„ ì‹œì‘í•  ìˆ˜ ìˆê²Œ í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œëŠ” ê¶Œì¥ë˜ëŠ”(opinionated) ì„¤ì •ì„ ì œê³µí•˜ì§€ë§Œ, ê°œë°œ ìš”êµ¬ì‚¬í•­ì´ ê¸°ë³¸ê°’ì—ì„œ ë²—ì–´ë‚˜ë©´ ì‰½ê²Œ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•  ìˆ˜ ìˆë„ë¡ ...", "content": "Spring Bootì˜ ëª©í‘œ ëª¨ë“  Spring ê°œë°œì—ì„œ ê·¹ì ìœ¼ë¡œ ë¹ ë¥´ê³  ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ì ‘ê·¼ ê°€ëŠ¥í•œ ì‹œì‘ ê²½í—˜ì„ ì œê³µí•˜ëŠ” ê²ƒ.â†’ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•  ë•Œ ë³µì¡í•œ ì„¤ì • ì—†ì´ ë°”ë¡œ ê°œë°œì„ ì‹œì‘í•  ìˆ˜ ìˆê²Œ í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œëŠ” ê¶Œì¥ë˜ëŠ”(opinionated) ì„¤ì •ì„ ì œê³µí•˜ì§€ë§Œ, ê°œë°œ ìš”êµ¬ì‚¬í•­ì´ ê¸°ë³¸ê°’ì—ì„œ ë²—ì–´ë‚˜ë©´ ì‰½ê²Œ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê²ƒ. ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ì—ì„œ ê³µí†µì ìœ¼ë¡œ í•„ìš”í•œ ë¹„ê¸°ëŠ¥ì  ê¸°ëŠ¥ë“¤ì„ ì œê³µí•˜ëŠ” ê²ƒ.(ì˜ˆ: ë‚´ì¥ ì„œë²„, ë³´ì•ˆ, ë©”íŠ¸ë¦­ ìˆ˜ì§‘, í—¬ìŠ¤ ì²´í¬, ì™¸ë¶€í™”ëœ ì„¤ì • ë“±) (ë„¤ì´í‹°ë¸Œ ì´ë¯¸ì§€ íƒ€ê²Ÿì´ ì•„ë‹Œ ê²½ìš°) ì ˆëŒ€ ì½”ë“œ ìƒì„±ì— ì˜ì¡´í•˜ì§€ ì•Šê³ , XML ì„¤ì •ì„ ìš”êµ¬í•˜ì§€ ì•ŠëŠ” ê²ƒ.â†’ ì¦‰, ìˆœìˆ˜ ìë°”/ì• ë„ˆí…Œì´ì…˜ ê¸°ë°˜ êµ¬ì„±ë§Œìœ¼ë¡œ ì¶©ë¶„íˆ ê°œë°œí•  ìˆ˜ ìˆê²Œ í•œë‹¤. í•µì‹¬ ê°œë…1. Convention over Configuration (ê´€ìŠµì´ ì„¤ì •ë³´ë‹¤ ìš°ì„ ) ê°œë°œìê°€ ëª¨ë“  ê±¸ ì„¸ì„¸íˆ ì„¤ì •í•˜ì§€ ì•Šì•„ë„, ì¼ë°˜ì ìœ¼ë¡œ ê°€ì¥ ë§ì´ ì“°ëŠ” ë°©ì‹ëŒ€ë¡œ ìë™ ì„¤ì •í•´ ì¤ë‹ˆë‹¤. ì˜ˆ: spring-boot-starter-webë§Œ ì¶”ê°€í•˜ë©´ ë‚´ì¥ í†°ìº£, JSON ë³€í™˜ê¸°, DispatcherServletê¹Œì§€ ìë™ ì¤€ë¹„ë¨. ê°œë°œìëŠ” ì›í•˜ëŠ” ê²½ìš°ì—ë§Œ ì„¤ì •ì„ ë®ì–´ì”Œìš°ë©´ ë¨.2. Opinionated Defaults (ê¶Œì¥ë˜ëŠ” ê¸°ë³¸ê°’) Spring BootëŠ” â€œì‹¤ë¬´ì—ì„œ ê°€ì¥ í•©ë¦¬ì ì¸ ê¸°ë³¸ê°’â€ì„ ë¯¸ë¦¬ ì„ íƒí•´ ë‘¡ë‹ˆë‹¤. ì˜ˆ: HikariCPë¥¼ ê¸°ë³¸ ì»¤ë„¥ì…˜ í’€ë¡œ ì±„íƒ, UTF-8 ê¸°ë³¸ ì¸ì½”ë”©, actuatorë¡œ í—¬ìŠ¤ ì²´í¬ ì œê³µ. Springì—ì„œë¼ë©´ ì§ì ‘ ê³¨ë¼ì•¼ í•  ì„ íƒì§€ë¥¼ Spring Bootê°€ ëŒ€ì‹  ì •í•´ì¤Œ.3. Auto Configuration (ìë™ ì„¤ì •) í´ë˜ìŠ¤íŒ¨ìŠ¤ì— ì¡´ì¬í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ê°ì§€í•´ì„œ ê´€ë ¨ Beanì„ ìë™ êµ¬ì„±í•©ë‹ˆë‹¤. ì˜ˆ: spring-boot-starter-data-jpaë¥¼ ì¶”ê°€í•˜ë©´ EntityManager, Hibernate, JPA Repository ìë™ ë“±ë¡. 4. Standalone Application (ë…ë¦½ ì‹¤í–‰í˜• ì• í”Œë¦¬ì¼€ì´ì…˜) ë‚´ì¥ í†°ìº£/Jetty/Undertowë¥¼ í¬í•¨í•œ ì‹¤í–‰ ê°€ëŠ¥í•œ JARë¡œ ë°°í¬ ê°€ëŠ¥. ì™¸ë¶€ WAS ì„¤ì¹˜ ì—†ì´ java -jarë§Œìœ¼ë¡œ ì‹¤í–‰.5. Production-ready Features Spring Boot Actuator: í—¬ìŠ¤ ì²´í¬, ë©”íŠ¸ë¦­, ë¡œê·¸ë ˆë²¨ ì¡°ì •, í™˜ê²½ í™•ì¸ ë“± ìš´ì˜ ì¹œí™” ê¸°ëŠ¥ ì œê³µ. DevTools: ì½”ë“œ ë³€ê²½ ì‹œ ìë™ ì¬ì‹œì‘, LiveReload ë“± ê°œë°œ í¸ì˜ ê¸°ëŠ¥.ì£¼ìš” ëª¨ë“ˆ Spring Boot Repository README ì°¸ê³ spring-boot Spring Bootì˜ ë‹¤ë¥¸ ë¶€ë¶„ë“¤ì„ ì§€ì›í•˜ëŠ” ê¸°ëŠ¥ë“¤ì„ ì œê³µí•˜ëŠ” ë©”ì¸ ë¼ì´ë¸ŒëŸ¬ë¦¬1. SpringApplication í´ë˜ìŠ¤ ë…ë¦½ ì‹¤í–‰í˜• Spring ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‘ì„±í•  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì •ì  í¸ì˜ ë©”ì„œë“œ(SpringApplication.run(Application.class, args ë“±) ë¥¼ ì œê³µ. ì´ í´ë˜ìŠ¤ì˜ ìœ ì¼í•œ ì—­í• ì€ ì ì ˆí•œ Spring ApplicationContextë¥¼ ìƒì„±í•˜ê³  ê°±ì‹ (refresh)í•˜ëŠ” ê²ƒ.2. ë‚´ì¥ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ Tomcat, Jetty ê°™ì€ ì»¨í…Œì´ë„ˆ ì„ íƒ ê°€ëŠ¥.3. ì™¸ë¶€ ì„¤ì • ì§€ì› ì„¤ì •ê°’ì„ ì½”ë“œì— í•˜ë“œì½”ë”©í•˜ì§€ ì•Šê³ , ì™¸ë¶€ì—ì„œ ì£¼ì…ë°›ì„ ìˆ˜ ìˆë„ë¡ ë””ìì¸ë˜ì–´ ìˆìŒ ì˜ˆ: application.properties, í™˜ê²½ ë³€ìˆ˜ (OS level), ì»¤ë§¨ë“œë¼ì¸ ì¸ì (--server.port=8081) 4. í¸ë¦¬í•œ ApplicationContext ì´ˆê¸°í™” ë„êµ¬ Spring BootëŠ” ApplicationContextInitializerë¥¼ ë¯¸ë¦¬ êµ¬í˜„í•´ ë‘ì–´ì„œ, ë¡œê¹…ì´ë‚˜ í™˜ê²½ì„¤ì • ê°™ì€ ê²ƒë“¤ì´ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹œ ìë™ìœ¼ë¡œ ì´ˆê¸°í™”ë˜ë„ë¡ í•´ì¤ë‹ˆë‹¤. ì˜ˆ: SpringApplication ì‹¤í–‰ ì‹œ ìë™ìœ¼ë¡œ LoggingApplicationListener ê°™ì€ ë¦¬ìŠ¤ë„ˆë¥¼ ë¶™ì—¬ì¤Œ. 5. ë¡œê¹… ê¸°ë³¸ê°’ ì§€ì› í¬í•¨ ë³„ë„ ì„¤ì •ì„ í•˜ì§€ ì•Šì•„ë„ ê¸°ë³¸ ë¡œê¹…ì´ ì‘ë™í•©ë‹ˆë‹¤. ê¸°ë³¸ ë¡œê¹… í”„ë ˆì„ì›Œí¬ëŠ” SLF4J + Logback ë¡œê·¸ í¬ë§·, ë¡œê·¸ ë ˆë²¨(INFO), ì¶œë ¥ ëŒ€ìƒ(Console) ë“±ì´ ìë™ ì§€ì • í•„ìš”í•˜ë©´ application.propertiesì—ì„œ ê°„ë‹¨íˆ ë°”ê¿€ ìˆ˜ ìˆìŒ. spring-boot-autoconfigure Spring BootëŠ” í´ë˜ìŠ¤íŒ¨ìŠ¤ì— í¬í•¨ëœ ë‚´ìš©ì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë§ì€ ë¶€ë¶„ì„ ìë™ìœ¼ë¡œ ì„¤ì • ì˜ˆ : í´ë˜ìŠ¤íŒ¨ìŠ¤ì— spring-webmvcê°€ ìˆìœ¼ë©´ ìë™ìœ¼ë¡œ DispatcherServletì´ ë“±ë¡ (org.springframework.boot.webmvc.autoconfigure.DispatcherServletAutoConfigurationì„ í†µí•´) @EnableAutoConfiguration ì• ë„ˆí…Œì´ì…˜ì´ Spring ì»¨í…ìŠ¤íŠ¸ì˜ ìë™ ì„¤ì •ì„ íŠ¸ë¦¬ê±° ìë™ ì„¤ì •ì€ ì‚¬ìš©ìê°€ í•„ìš”ë¡œ í•  ìˆ˜ ìˆëŠ” Beanì„ ì¶”ë¡ í•˜ë ¤ê³  ì‹œë„ ì˜ˆë¥¼ ë“¤ì–´, HSQLDBê°€ í´ë˜ìŠ¤íŒ¨ìŠ¤ì— ìˆê³  ì‚¬ìš©ìê°€ ì–´ë–¤ ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°ë„ ì„¤ì •í•˜ì§€ ì•Šì•˜ë‹¤ë©´, ì¸ë©”ëª¨ë¦¬ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì •ì˜í•˜ê¸¸ ì›í•œë‹¤ê³  ì¶”ì • ì‚¬ìš©ìê°€ ì§ì ‘ Beanì„ ì •ì˜í•˜ë©´ ìë™ ì„¤ì •ì€ ë®ì–´ì”Œì›Œì§„ë‹¤. spring-boot-starters ìŠ¤íƒ€í„°(Starters)ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— í¬í•¨ì‹œí‚¬ ìˆ˜ ìˆëŠ” í¸ë¦¬í•œ ì˜ì¡´ì„±(descriptor) ì§‘í•©ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ í•„ìš”í•œ Spring ë° ê´€ë ¨ ê¸°ìˆ ì„ ì¼ì¼ì´ ìƒ˜í”Œ ì½”ë“œì—ì„œ ì°¾ì•„ ë¶™ì´ê±°ë‚˜ ì˜ì¡´ì„±ì„ ë³µì‚¬/ë¶™ì—¬ë„£ê¸° í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Springê³¼ JPAë¥¼ ì´ìš©í•œ ë°ì´í„°ë² ì´ìŠ¤ ì ‘ê·¼ì„ ì‹œì‘í•˜ê³  ì‹¶ë‹¤ë©´ spring-boot-starter-data-jpa ì˜ì¡´ì„±ì„ í”„ë¡œì íŠ¸ì— ì¶”ê°€í•˜ë©´ ë©ë‹ˆë‹¤.spring-boot-actuator Actuator ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì‚¬ìš©í•˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ëª¨ë‹ˆí„°ë§í•˜ê³  ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Spring Boot ActuatorëŠ” ì´ëŸ¬í•œ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ìœ„í•œ ê¸°ë°˜ ì¸í”„ë¼ë¥¼ ì œê³µí•©ë‹ˆë‹¤. Actuator ì—”ë“œí¬ì¸íŠ¸ìš© ì• ë„ˆí…Œì´ì…˜ ì§€ì›ì„ í¬í•¨í•˜ê³  ìˆìœ¼ë©°, HealthEndpoint, EnvironmentEndpoint, BeansEndpoint ë“± ë‹¤ì–‘í•œ ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤. /actuator/health â†’ ì• í”Œë¦¬ì¼€ì´ì…˜ í—¬ìŠ¤ ì²´í¬ /actuator/env â†’ í™˜ê²½ ë³€ìˆ˜ í™•ì¸ /actuator/beans â†’ ìŠ¤í”„ë§ ë¹ˆ ëª©ë¡ í™•ì¸ spring-boot-actuator-autoconfigure ì´ ëª¨ë“ˆì€ í´ë˜ìŠ¤íŒ¨ìŠ¤ ë‚´ìš©ê³¼ ì†ì„± ì§‘í•©ì— ê¸°ë°˜í•˜ì—¬ actuator ì—”ë“œí¬ì¸íŠ¸ì˜ ìë™ ì„¤ì •ì„ ì œê³µí•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Micrometerê°€ í´ë˜ìŠ¤íŒ¨ìŠ¤ì— ìˆìœ¼ë©´ MetricsEndpointë¥¼ ìë™ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤. HTTPë‚˜ JMXë¥¼ í†µí•œ ì—”ë“œí¬ì¸íŠ¸ ë…¸ì¶œì„ ìœ„í•œ ì„¤ì •ì„ í¬í•¨í•©ë‹ˆë‹¤. Spring Boot AutoConfigureì™€ ë§ˆì°¬ê°€ì§€ë¡œ ì‚¬ìš©ìê°€ ì§ì ‘ Beanì„ ì •ì˜í•˜ê¸° ì‹œì‘í•˜ë©´ ìë™ ì„¤ì •ì€ ë¬¼ëŸ¬ë‚©ë‹ˆë‹¤.spring-boot-test ì´ ëª¨ë“ˆì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í…ŒìŠ¤íŠ¸í•  ë•Œ ë„ì›€ì´ ë  ìˆ˜ ìˆëŠ” í•µì‹¬ í•­ëª©ê³¼ ì• ë„ˆí…Œì´ì…˜ì„ í¬í•¨í•©ë‹ˆë‹¤. ì˜ˆ : @SpringBootTest, @MockBean spring-boot-test-autoconfigure ë‹¤ë¥¸ Spring Boot ìë™ ì„¤ì • ëª¨ë“ˆê³¼ ë§ˆì°¬ê°€ì§€ë¡œ, spring-boot-test-autoconfigureëŠ” í´ë˜ìŠ¤íŒ¨ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ìë™ ì„¤ì •ì„ ì œê³µí•©ë‹ˆë‹¤. í…ŒìŠ¤íŠ¸í•˜ë ¤ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì¼ë¶€ë§Œ ìë™ìœ¼ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆëŠ” ë§ì€ ì• ë„ˆí…Œì´ì…˜ì„ í¬í•¨í•©ë‹ˆë‹¤. ì˜ˆ : @WebMvcTest, @DataJpaTest ë“±ì„ í†µí•´ ì „ì²´ ì»¨í…ìŠ¤íŠ¸ë¥¼ ë„ìš°ì§€ ì•Šê³  í•„ìš”í•œ ë¶€ë¶„ë§Œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥. spring-boot-loader Spring Boot LoaderëŠ” java -jarë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ë‹¨ì¼ jar íŒŒì¼ì„ ë¹Œë“œí•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë¹„ë°€ ì†ŒìŠ¤(secret sauce)ë¥¼ ì œê³µí•©ë‹ˆë‹¤. Fat JAR (ëª¨ë“  ì˜ì¡´ì„± í¬í•¨ JAR)ì„ ë§Œë“¤ì–´ì„œ ë…ë¦½ ì‹¤í–‰ ê°€ëŠ¥. ì¼ë°˜ì ìœ¼ë¡œëŠ” spring-boot-loaderë¥¼ ì§ì ‘ ì‚¬ìš©í•  í•„ìš”ëŠ” ì—†ìœ¼ë©°, ëŒ€ì‹  Gradleì´ë‚˜ Maven í”ŒëŸ¬ê·¸ì¸ê³¼ í•¨ê»˜ ì‚¬ìš©í•©ë‹ˆë‹¤.spring-boot-devtools spring-boot-devtools ëª¨ë“ˆì€ ìë™ ì¬ì‹œì‘ê³¼ ê°™ì€ ì¶”ê°€ ê°œë°œ ì‹œ ê¸°ëŠ¥ì„ ì œê³µí•˜ì—¬ ì›í™œí•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ê°œë°œì ë„êµ¬ëŠ” ì™„ì „íˆ íŒ¨í‚¤ì§•ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•  ë•ŒëŠ” ìë™ìœ¼ë¡œ ë¹„í™œì„±í™”ë©ë‹ˆë‹¤.ì •ë¦¬í•˜ë©´, Spring BootëŠ” ìœ„ ëª¨ë“ˆë“¤ì´ ì¡°í•©ë˜ì–´: ì‹¤í–‰(boot, loader) ìë™ ì„¤ì •(autoconfigure) ì˜ì¡´ì„± ê´€ë¦¬(starters) ìš´ì˜(actuator) í…ŒìŠ¤íŠ¸(test) ê°œë°œ í¸ì˜(devtools)ê¹Œì§€ ì „ ê³¼ì •(ê°œë°œâ€“ìš´ì˜â€“í…ŒìŠ¤íŠ¸â€“ë°°í¬)ì„ ì§€ì›í•˜ëŠ” í’€ íŒ¨í‚¤ì§€ í”„ë ˆì„ì›Œí¬ì´ë‹¤.ìŠ¤í”„ë§ ë¶€íŠ¸ë¡œ ê°œë°œí•œë‹¤ëŠ” ê²ƒ ?Spring Boot ì—†ì´ Spring MVC + Spring Data JPA ì‚¬ìš©&lt;dependencies&gt; &lt;!-- Spring Web MVC --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;5.3.32&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Spring Data JPA --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.data&lt;/groupId&gt; &lt;artifactId&gt;spring-data-jpa&lt;/artifactId&gt; &lt;version&gt;2.7.18&lt;/version&gt; &lt;/dependency&gt; &lt;!-- Hibernate (JPA êµ¬í˜„ì²´) --&gt; &lt;dependency&gt; &lt;groupId&gt;org.hibernate&lt;/groupId&gt; &lt;artifactId&gt;hibernate-core&lt;/artifactId&gt; &lt;version&gt;5.6.15.Final&lt;/version&gt; &lt;/dependency&gt; &lt;!-- MySQL Driver --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;8.0.33&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt;@Configuration@EnableTransactionManagement@EnableJpaRepositories(basePackages = \"com.example.repo\")@ComponentScan(basePackages = \"com.example\")public class AppConfig { @Bean public DataSource dataSource() { DriverManagerDataSource ds = new DriverManagerDataSource(); ds.setDriverClassName(\"com.mysql.cj.jdbc.Driver\"); ds.setUrl(\"jdbc:mysql://localhost:3306/testdb\"); ds.setUsername(\"root\"); ds.setPassword(\"1234\"); return ds; } @Bean public LocalContainerEntityManagerFactoryBean entityManagerFactory() { LocalContainerEntityManagerFactoryBean emf = new LocalContainerEntityManagerFactoryBean(); emf.setDataSource(dataSource()); emf.setPackagesToScan(\"com.example.entity\"); emf.setJpaVendorAdapter(new HibernateJpaVendorAdapter()); return emf; } @Bean public PlatformTransactionManager transactionManager(EntityManagerFactory emf) { return new JpaTransactionManager(emf); }}@Configuration@EnableWebMvcpublic class WebConfig implements WebMvcConfigurer { // JSON MessageConverter ìˆ˜ë™ ë“±ë¡ @Override public void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) { converters.add(new MappingJackson2HttpMessageConverter()); } // ë·° ë¦¬ì¡¸ë²„ (JSP ì˜ˆì‹œ) @Bean public InternalResourceViewResolver viewResolver() { InternalResourceViewResolver resolver = new InternalResourceViewResolver(); resolver.setPrefix(\"/WEB-INF/views/\"); resolver.setSuffix(\".jsp\"); return resolver; }}public interface UserRepository extends JpaRepository&lt;User, Long&gt; {}@Entitypublic class User { @Id @GeneratedValue private Long id; private String name;}@RestControllerpublic class UserController { @Autowired private UserRepository repo; @PostMapping(\"/users\") public String addUser(@RequestBody User user) { repo.save(user); return \"saved\"; } @GetMapping(\"/users\") public List&lt;User&gt; getUsers() { return repo.findAll(); }} DB ì—°ê²°, EntityManagerFactory, TransactionManager, JSON MessageConverter, ViewResolver ë“± ì „ë¶€ ì§ì ‘ Beanìœ¼ë¡œ ë“±ë¡í•´ì•¼ í•¨. ì‹¤í–‰ë„ WAR íŒŒì¼ ë§Œë“¤ì–´ì„œ ì™¸ë¶€ Tomcat ê°™ì€ WASì— ë°°í¬í•´ì•¼ í•¨.Spring Boot ì‚¬ìš©&lt;dependencies&gt; &lt;!-- Spring Boot Starter Web (MVC + Jackson + ë‚´ì¥ í†°ìº£) --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- Spring Boot Starter Data JPA (Spring Data JPA + Hibernate) --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- MySQL Driver --&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-j&lt;/artifactId&gt; &lt;/dependency&gt;&lt;/dependencies&gt;# application.propertiesspring.datasource.url=jdbc:mysql://localhost:3306/testdbspring.datasource.username=rootspring.datasource.password=1234spring.jpa.hibernate.ddl-auto=updatespring.jpa.show-sql=true@SpringBootApplicationpublic class Application { public static void main(String[] args) { SpringApplication.run(Application.class, args); }}// UserRepository, User Entity, UserControllerëŠ” ë™ì¼í•˜ê²Œ ì‘ì„± spring-boot-starter-data-jpa ë•ë¶„ì— DataSource, EntityManager, TxManager ìë™ ì„¤ì • spring-boot-starter-web ë•ë¶„ì— DispatcherServlet, JSON ë³€í™˜ê¸°(Jackson), ë‚´ì¥ í†°ìº£ ìë™ ì„¤ì • ì‹¤í–‰ì€ mvn spring-boot:run ë˜ëŠ” java -jar app.jar Spring Boot í•µì‹¬ ê°œë… Spring Spring Boot ì°¨ì´ í¬ì¸íŠ¸ 1. Convention over Configuration (ê´€ìŠµ &gt; ì„¤ì •) DispatcherServlet, ViewResolver, MessageConverterë¥¼ ê°œë°œìê°€ ì „ë¶€ ìˆ˜ë™ ë“±ë¡ spring-boot-starter-webìœ¼ë¡œ ìë™ êµ¬ì„± (DispatcherServlet, Jackson, ì •ì  ë¦¬ì†ŒìŠ¤ ë§¤í•‘ ë“±) í”íˆ ì“°ëŠ” ê´€ë¡€ì  ì„¤ì •ì„ Bootê°€ ìë™ ì œê³µ â†’ ê°œë°œìëŠ” ì„¤ì • ëŒ€ì‹  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ì§‘ì¤‘ 2. Opinionated Defaults (ê¶Œì¥ ê¸°ë³¸ê°’) DataSource í’€, Hibernate ì˜µì…˜, ë¡œê¹… ì„¤ì • ë“± ê°œë°œìê°€ ì„ íƒ HikariCP(ì»¤ë„¥ì…˜í’€), Logback, UTF-8, Hibernate ddl-auto ë“± í•©ë¦¬ì ì¸ ê¸°ë³¸ê°’ ì œê³µ ì‹¤ë¬´ì—ì„œ ê²€ì¦ëœ â€œì¢‹ì€ ì„ íƒì§€â€ë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì§€ì •í•´ì¤Œ 3. Auto-Configuration (ìë™ ì„¤ì •) DataSource, EntityManagerFactory, TransactionManager ì§ì ‘ Bean ë“±ë¡ spring.datasource.*, spring.jpa.* í”„ë¡œí¼í‹°ë§Œ ì‘ì„± â†’ ìë™ Bean ë“±ë¡ í´ë˜ìŠ¤íŒ¨ìŠ¤ ê¸°ë°˜ ìë™ ì„¤ì • â†’ Bean ìˆ˜ë™ ì„¤ì • í•„ìš” ìµœì†Œí™” 4. Standalone Application (ë…ë¦½ ì‹¤í–‰í˜•) WAR ë¹Œë“œ í›„ ì™¸ë¶€ Tomcat ê°™ì€ WASì— ë°°í¬í•´ì•¼ ì‹¤í–‰ ê°€ëŠ¥ ë‚´ì¥ Tomcat/Jetty í¬í•¨ â†’ java -jar í•œ ì¤„ë¡œ ì‹¤í–‰ ìš´ì˜ í™˜ê²½ì—ì„œ ë°”ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•œ ë…ë¦½ ì‹¤í–‰í˜• ì• í”Œë¦¬ì¼€ì´ì…˜ 5. Production-ready Features (ìš´ì˜ ì¹œí™” ê¸°ëŠ¥) ìš´ì˜ ëª¨ë‹ˆí„°ë§/í—¬ìŠ¤ì²´í¬ ê¸°ëŠ¥ ì—†ìŒ â†’ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•¨ spring-boot-starter-actuator ì¶”ê°€ë§Œ í•˜ë©´ /actuator/health, /metrics ë“± ì œê³µ ìš´ì˜ í™˜ê²½ì—ì„œ í•„ìš”í•œ ê¸°ëŠ¥(í—¬ìŠ¤ì²´í¬, ë©”íŠ¸ë¦­, ë¡œê·¸ê´€ë¦¬)ì„ ë‚´ì¥ ì°¸ê³  ìë£Œ https://github.com/spring-projects/spring-boot/wiki https://docs.spring.io/spring-boot/index.html https://github.com/spring-projects/spring-boot" }, { "title": "Spring - Spring Framework ì•Œì•„ë³´ê¸°", "url": "/posts/what-is-spring-framework/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Spring", "date": "2025-08-19 22:25:00 +0900", "snippet": "ìŠ¤í”„ë§ ? â€œSpringâ€ì´ë¼ëŠ” ìš©ì–´ëŠ” ë¬¸ë§¥ì— ë”°ë¼ ë‹¤ë¥¸ ì˜ë¯¸ë¥¼ ê°€ì§„ë‹¤. ì›ë˜ëŠ” Spring Framework í”„ë¡œì íŠ¸ ìì²´ë¥¼ ê°€ë¦¬í‚¤ëŠ” ë§ì´ì—ˆìœ¼ë©°, ê±°ê¸°ì„œ ëª¨ë“  ê²ƒì´ ì‹œì‘ëë‹¤. ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ Spring Framework ìœ„ì— ë‹¤ë¥¸ Spring í”„ë¡œì íŠ¸ë“¤ì´ ë§Œë“¤ì–´ì¡Œë‹¤. ì¦‰, ê° í”„ë¡œì íŠ¸ë“¤ì€ s...", "content": "ìŠ¤í”„ë§ ? â€œSpringâ€ì´ë¼ëŠ” ìš©ì–´ëŠ” ë¬¸ë§¥ì— ë”°ë¼ ë‹¤ë¥¸ ì˜ë¯¸ë¥¼ ê°€ì§„ë‹¤. ì›ë˜ëŠ” Spring Framework í”„ë¡œì íŠ¸ ìì²´ë¥¼ ê°€ë¦¬í‚¤ëŠ” ë§ì´ì—ˆìœ¼ë©°, ê±°ê¸°ì„œ ëª¨ë“  ê²ƒì´ ì‹œì‘ëë‹¤. ì‹œê°„ì´ ì§€ë‚˜ë©´ì„œ Spring Framework ìœ„ì— ë‹¤ë¥¸ Spring í”„ë¡œì íŠ¸ë“¤ì´ ë§Œë“¤ì–´ì¡Œë‹¤. ì¦‰, ê° í”„ë¡œì íŠ¸ë“¤ì€ spring-core, spring-aop, spring-context ë“±ì˜ í•µì‹¬ ëª¨ë“ˆë“¤ì„ ì‚¬ìš©í•˜ë©´ì„œìì‹ ë§Œì˜ ê¸°ëŠ¥ì„ ì¶”ê°€í•˜ê±°ë‚˜ í™•ì¥í•œë‹¤. Spring FrameworkëŠ” ì—¬ëŸ¬ ëª¨ë“ˆë¡œ ë‚˜ëˆ„ì–´ì ¸ ìˆìœ¼ë©°, ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í•„ìš”í•œ ëª¨ë“ˆë§Œ ì„ íƒí•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ê°€ì¥ ì¤‘ì‹¬ì—ëŠ” ì„¤ì • ëª¨ë¸ê³¼ ì˜ì¡´ì„± ì£¼ì…(Dependency Injection) ë©”ì»¤ë‹ˆì¦˜ì„ í¬í•¨í•œ ì½”ì–´ ì»¨í…Œì´ë„ˆ ëª¨ë“ˆì´ ìˆë‹¤. ê·¸ ì™¸ì—ë„ Spring FrameworkëŠ” ë©”ì‹œì§•, íŠ¸ëœì­ì…˜ ì²˜ë¦¬, ë°ì´í„° ì˜ì†ì„±, ì›¹ ë“± ë‹¤ì–‘í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì•„í‚¤í…ì²˜ë¥¼ ì§€ì›í•œë‹¤. ë˜í•œ ì„œë¸”ë¦¿ ê¸°ë°˜ì˜ Spring MVC ì›¹ í”„ë ˆì„ì›Œí¬ì™€, ë¦¬ì•¡í‹°ë¸Œ ë°©ì‹ì˜ Spring WebFlux ì›¹ í”„ë ˆì„ì›Œí¬ë„ í¬í•¨ë˜ì–´ ìˆë‹¤. ëª¨ë“ˆ ì˜ˆì‹œ: spring-core : ìŠ¤í”„ë§ì˜ í•µì‹¬ ê¸°ëŠ¥(ì˜ì¡´ì„± ì£¼ì…, IoC ì»¨í…Œì´ë„ˆ ë“±)ì„ ë‹´ì€ ëª¨ë“ˆ spring-beans : Bean ìƒì„±, ì„¤ì •, ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬ ê°™ì€ ê¸°ëŠ¥ì„ ë‹´ë‹¹ spring-context : ApplicationContext ê°™ì€ ê³ ìˆ˜ì¤€ ì»¨í…Œì´ë„ˆ ì œê³µ, êµ­ì œí™”(i18n), ì´ë²¤íŠ¸ ì‹œìŠ¤í…œ ë“± í¬í•¨ spring-aop : ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°(AOP) ì§€ì›ì„ ìœ„í•œ ëª¨ë“ˆ spring-jdbc : JDBCë¥¼ ë” ì‰½ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ëª¨ë“ˆ spring-tx : íŠ¸ëœì­ì…˜ ê´€ë¦¬ ê´€ë ¨ ê¸°ëŠ¥ ì œê³µ spring-web / spring-webmvc / spring-webflux : ì„œë¸”ë¦¿ ê¸°ë°˜ ì›¹ MVCì™€ ë¦¬ì•¡í‹°ë¸Œ ì›¹(WebFlux) ì§€ì› ëª¨ë“ˆ Spring Framework Repository ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ì˜ ì—­ì‚¬ ìŠ¤í”„ë§ì€ ì´ˆê¸° J2EE ëª…ì„¸ì˜ ë³µì¡ì„±ì— ëŒ€í•œ ëŒ€ì‘ìœ¼ë¡œ 2003ë…„ì— íƒ„ìƒí–ˆë‹¤. ì°¸ê³  : J2EE ì„¤ê³„ì™€ ê°œë°œ(expert one-on-one) ì¼ë¶€ ì‚¬ëŒë“¤ì€ Java EEì™€ ê·¸ í›„ì†ì¸ Jakarta EEê°€ ìŠ¤í”„ë§ê³¼ ê²½ìŸ ê´€ê³„ë¼ê³  ìƒê°í•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ìƒí˜¸ ë³´ì™„ì ì´ë‹¤. ìŠ¤í”„ë§ í”„ë¡œê·¸ë˜ë° ëª¨ë¸ì€ Jakarta EE í”Œë«í¼ ì „ì²´ ëª…ì„¸ë¥¼ ìˆ˜ìš©í•˜ì§€ ì•Šê³ , ì„ íƒì ìœ¼ë¡œ ëª‡ ê°€ì§€ ëª…ì„¸ë¥¼ í†µí•©í–ˆë‹¤: Servlet API (JSR 340) â†’ ì„œë¸”ë¦¿ API WebSocket API (JSR 356) â†’ ì›¹ì†Œì¼“ API Concurrency Utilities (JSR 236) â†’ ë™ì‹œì„± ìœ í‹¸ë¦¬í‹° JSON Binding API (JSR 367) â†’ JSON ë°”ì¸ë”© API Bean Validation (JSR 303) â†’ ë¹ˆ ê²€ì¦ JPA (JSR 338) â†’ ìë°” ì˜ì†ì„± API JMS (JSR 914) â†’ ìë°” ë©”ì‹œì§• ì„œë¹„ìŠ¤ ì˜ˆì‹œ êµ¬ë¶„ EE (í‘œì¤€) Spring (í”„ë ˆì„ì›Œí¬) íŠ¸ëœì­ì…˜ ê´€ë¦¬ JTA (Java Transaction API) @Transactional (ë‚´ë¶€ì ìœ¼ë¡œ í•„ìš” ì‹œ JTA í˜¸ì¶œ, ë‹¨ìˆœí™”) ë°ì´í„° ì ‘ê·¼ JPA (ìŠ¤í™, APIë§Œ ì •ì˜) Spring Data JPA (JPA ìœ„ì— ì–¹ì–´ ë” í¸ë¦¬í•œ API ì œê³µ) ì›¹ Servlet API, JSP Spring MVC (Servlet ê¸°ë°˜, ë” í¸ë¦¬í•œ MVC ëª¨ë¸ ì œê³µ) â€» ì°¸ê³  : EE ìŠ¤í™ ë³€í™” êµ¬ë¶„ J2EE (Java 2 EE) Java EE Jakarta EE ì‹œê¸° 1999ë…„ ~ 2006ë…„ 2006ë…„ ~ 2017ë…„ 2018ë…„ ~ í˜„ì¬ ëª…ì¹­ ë³€í™” Java 2 EE J2EE â†’ Java EEë¡œ ê°œëª… Java EE â†’ Jakarta EEë¡œ ê°œëª… ì£¼ìš” ê¸°ìˆ  EJB, Servlet, JSP JPA, CDI, Bean Validation ì¶”ê°€ Servlet, JPA, JMS, Bean Validation íŠ¹ì§• ë³µì¡í•˜ê³  ë¬´ê±°ì›€ J2EEë³´ë‹¤ ë‹¨ìˆœí™”, ê·¸ë˜ë„ ë³µì¡í•¨ Eclipse Foundation ê´€ë¦¬, ë” í˜„ëŒ€í™” ê´€ë¦¬ ì£¼ì²´ Sun Microsystems Oracle Eclipse Foundation ë„¤ì„ìŠ¤í˜ì´ìŠ¤ javax.* javax.* jakarta.* (EE 9ë¶€í„°) ë¹„ê³  ë„ˆë¬´ ë¬´ê±°ì›Œì„œ Spring ê°™ì€ ê²½ëŸ‰ í”„ë ˆì„ì›Œí¬ ë“±ì¥ ìƒì‚°ì„± ê°œì„ , í‘œì¤€í™” ê°•í™” í˜„ì¬ ê³µì‹ ìë°” ì—”í„°í”„ë¼ì´ì¦ˆ í‘œì¤€ â€» ì°¸ê³  : ì„œë¸”ë¦¿, í†°ìº£, Spring MVC Servlet ìŠ¤í™ = ì‹¤ì œ êµ¬í˜„ì²´ê°€ í•„ìš” Jakarta EE í‘œì¤€ API â†’ jakarta.servlet.* â€œìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ ì–´ë–»ê²Œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ”ê°€?â€ë¥¼ ì •ì˜í•œ ì¸í„°í˜ì´ìŠ¤ ê·œì¹™ Tomcat = Servlet ì»¨í…Œì´ë„ˆ (êµ¬í˜„ì²´) Servlet ìŠ¤í™ì„ êµ¬í˜„í•œ ì„œë²„ (Servlet ìŠ¤í™ì„ ì‹¤ì œë¡œ ì‹¤í–‰í•˜ëŠ” ì—”ì§„) ì£¼ìš” ì—­í• : HTTP ì²˜ë¦¬: TCP ì†Œì¼“ ì—´ê¸°, HTTP ìš”ì²­/ì‘ë‹µ íŒŒì‹± Servlet ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬: init(), service(), destroy() ì‹¤í–‰ ìŠ¤ë ˆë“œ í’€ ê´€ë¦¬: ìš”ì²­ë‹¹ ìŠ¤ë ˆë“œ í• ë‹¹ Filter/Listener ì‹¤í–‰: Servlet API í‘œì¤€ì— ì •ì˜ëœ ê¸°ëŠ¥ ìˆ˜í–‰ Spring MVC = Servlet ê¸°ë°˜ í”„ë ˆì„ì›Œí¬ Spring MVCëŠ” Servlet ìŠ¤í™ì„ ì§ì ‘ êµ¬í˜„í•œ ê²Œ ì•„ë‹ˆë¼, Servlet ìœ„ì—ì„œ ë™ì‘í•˜ëŠ” í”„ë ˆì„ì›Œí¬ í•µì‹¬ í´ë˜ìŠ¤: DispatcherServlet DispatcherServletì€ Servlet APIë¥¼ ìƒì†ë°›ì€ í´ë˜ìŠ¤ (extends HttpServlet) Tomcat ê°™ì€ ì»¨í…Œì´ë„ˆê°€ DispatcherServletì„ ì‹¤í–‰ì‹œì¼œ ì¤Œ ê·¸ ì•ˆì—ì„œ @Controller, @RequestMapping ë“±ì„ í•´ì„í•˜ê³  í˜¸ì¶œ ì¦‰, Spring MVCëŠ” Servletì„ í™œìš©í•´ ë” í¸ë¦¬í•œ MVC ê°œë°œ ëª¨ë¸ì„ ì œê³µí•˜ëŠ” ì¶”ìƒí™” ê³„ì¸µ ìŠ¤í”„ë§ì„ ì‚¬ìš©í•œë‹¤ëŠ” ê²ƒ ?1. ìŠ¤í”„ë§ì€ Java ì—”í„°í”„ë¼ì´ì¦ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆê²Œ í•´ì¤Œ ì—”í„°í”„ë¼ì´ì¦ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ = ê¸°ì—…ìš© ëŒ€ê·œëª¨ ì‹œìŠ¤í…œ (ex : ì‡¼í•‘ëª°, ì€í–‰, ERP ë“±) J2EE ì‹œì ˆ: ì„œë¸”ë¦¿, JDBC, íŠ¸ëœì­ì…˜, ë³´ì•ˆ ë“±ì„ ê°œë°œìê°€ ì¼ì¼ì´ ì²˜ë¦¬í•´ì•¼ í•¨. ì˜ˆ: DB ì—°ê²°, SQL ì‹¤í–‰, ì»¤ë„¥ì…˜ ë‹«ê¸°, ì˜ˆì™¸ ì²˜ë¦¬, íŠ¸ëœì­ì…˜ ë¡¤ë°± ë“± ì „ë¶€ ìˆ˜ë™ ê´€ë¦¬. ìŠ¤í”„ë§ ì‚¬ìš© ì‹œ: Spring JDBC / Spring Data JPA â†’ DB ì—°ê²°ê³¼ íŠ¸ëœì­ì…˜ ê´€ë¦¬ ìë™ ì²˜ë¦¬ Spring Security â†’ ë¡œê·¸ì¸/ê¶Œí•œ ê´€ë¦¬ ì‰½ê²Œ ì„¤ì • Spring MVC â†’ REST APIë‚˜ ì›¹ í™”ë©´ ì‰½ê²Œ ê°œë°œ ê°€ëŠ¥ ë”°ë¼ì„œ ê°œë°œìëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ë§Œ ì§‘ì¤‘í•  ìˆ˜ ìˆìŒ. ì˜ˆì‹œ : EJB 2.x ìŠ¤íƒ€ì¼ (íšŒì› ë“±ë¡)public interface MemberServiceHome extends EJBHome { MemberService create() throws RemoteException, CreateException;}public interface MemberService extends EJBObject { void registerMember(String name) throws RemoteException;}public class MemberServiceBean implements SessionBean { public void registerMember(String name) { // DB ì—°ê²°, SQL ì‹¤í–‰... }} â€œíšŒì› ë“±ë¡â€ í•˜ë‚˜ í•˜ë ¤ëŠ”ë°ë„, Home Interface / Remote Interface / Bean Classë¥¼ ë‹¤ ë§Œë“¤ì–´ì•¼ í–ˆìŠµë‹ˆë‹¤. ê°œë°œìê°€ ì›í•˜ëŠ” ê°„ë‹¨í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì‘ì„±í•˜ê¸° ìœ„í•´ì„œ, ì¸í„°í˜ì´ìŠ¤/ì„¤ì •/ë³´ì¼ëŸ¬í”Œë ˆì´íŠ¸ ì½”ë“œë¥¼ ë„ˆë¬´ ë§ì´ ì‘ì„±í•´ì•¼ í–ˆìŒ ë°°í¬í•  ë•Œë„ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„ ì¢…ì†ì ì´ë¼ í¬í„°ë¸”(portable)í•˜ì§€ ì•ŠìŒ ì‘ì€ í”„ë¡œì íŠ¸ì—ì„œëŠ” ê³¼ì‰ ì„¤ê³„ì˜€ìŒ EJB vs Spring EJB (ì´ˆì°½ê¸°): ë¬´ê²ê³  ë³µì¡ â†’ ìŠ¤í”„ë§ì´ â€œê²½ëŸ‰ ì»¨í…Œì´ë„ˆ(POJO ê¸°ë°˜ DI)â€ë¥¼ ë“¤ê³  ë“±ì¥ EJB 3.x ì´í›„: ìŠ¤í”„ë§ ì•„ì´ë””ì–´ë¥¼ ë§ì´ ê°€ì ¸ì™€ì„œ ë‹¨ìˆœí™” â†’ ìŠ¤í”„ë§ê³¼ ì–´ëŠ ì •ë„ ë‹®ì•„ì§ í˜„ì¬: ëŒ€ë¶€ë¶„ì˜ ê¸°ì—… í”„ë¡œì íŠ¸ëŠ” EJB ëŒ€ì‹  Springì„ ì„ íƒ 2. ìŠ¤í”„ë§ì€ ì—”í„°í”„ë¼ì´ì¦ˆ í™˜ê²½ì—ì„œ ìë°” ì–¸ì–´ë¥¼ í™œìš©í•˜ëŠ” ë° í•„ìš”í•œ ëª¨ë“  ê²ƒì„ ì œê³µ â€œì—”í„°í”„ë¼ì´ì¦ˆ í™˜ê²½ì—ì„œ í•„ìš”í•œ ëª¨ë“  ê²ƒâ€ = DB, ë³´ì•ˆ, ë©”ì‹œì§•, ë°°ì¹˜, ë¶„ì‚° íŠ¸ëœì­ì…˜ ë“± ì˜ˆì‹œ: ì€í–‰ ê³„ì¢Œ ì´ì²´ ì‹œìŠ¤í…œ í•„ìš”í•œ ìš”ì†Œ: íŠ¸ëœì­ì…˜(ê³„ì¢Œì—ì„œ ëˆ ë¹ ì§€ê³  ë‹¤ë¥¸ ê³„ì¢Œì— ëˆ ë“¤ì–´ê°€ëŠ” ê²ƒ, ë°˜ë“œì‹œ ì›ìì„± ë³´ì¥ í•„ìš”) ë©”ì‹œì§•(JMSë¡œ ë‹¤ë¥¸ ê¸ˆìœµ ê¸°ê´€ì— ì´ë²¤íŠ¸ ì „ë‹¬) ë³´ì•ˆ(ë¡œê·¸ì¸, 2FA, ê¶Œí•œ ë¶„ë¦¬) ìŠ¤ì¼€ì¤„ë§(ë§¤ì¼ ìì •ì— ì´ì ê³„ì‚° ë°°ì¹˜ ì‹¤í–‰) ìŠ¤í”„ë§ ì§€ì›: Spring Transaction Management â†’ íŠ¸ëœì­ì…˜ ìë™ ì²˜ë¦¬ Spring JMS â†’ ë©”ì‹œì§€ í ì—°ë™ Spring Security â†’ ë³´ì•ˆ ê¸°ëŠ¥ Spring Batch â†’ ë°°ì¹˜ ì‘ì—… ì‹¤í–‰ ë° ê´€ë¦¬ ì¦‰, ê°œë°œìê°€ ë³µì¡í•œ ì¸í”„ë¼(Infra) ì½”ë“œë¥¼ ì§ì ‘ ì‘ì„±í•˜ì§€ ì•Šê³ , ìŠ¤í”„ë§ì´ ì œê³µí•˜ëŠ” ëª¨ë“ˆì„ ê°€ì ¸ë‹¤ ì“°ë©´ ë¨. ìŠ¤í”„ë§ í•µì‹¬ ê°œë… IoC(Inversion of Control) DI(Dependency Injection) AOP(Aspect-Oriented Programming) â€œí•µì‹¬â€ì¸ ì´ìœ ëŠ” ì´ë¥¼ í†µí•´ ê°œë°œìëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ì§‘ì¤‘í•  ìˆ˜ ìˆìœ¼ë©°, ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê²°í•©ë„ë¥¼ ë‚®ì¶”ê³ , ì¬ì‚¬ìš©ì„±ì„ ë†’ì´ë©°, ìœ ì§€ë³´ìˆ˜ë¥¼ ìš©ì´í•˜ê²Œ ë§Œë“¤ì–´ ì£¼ê¸° ë•Œë¬¸IoC (Inversion of Control) ì œì–´ : ê°ì²´ì˜ ìƒì„±, ì£¼ì…, ìƒëª…ì£¼ê¸° ë“±ì„ ê´€ë¦¬í•˜ëŠ” ê²ƒì œì–´ì˜ ì—­ì „ : ê°œë°œìê°€ ê°ì²´ë¥¼ ì§ì ‘ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ëŠ” ëŒ€ì‹ , í”„ë ˆì„ì›Œí¬ê°€ ëŒ€ì‹  ê´€ë¦¬í•´ì£¼ëŠ” ê²ƒ ê°œë°œìê°€ ì§ì ‘ ì œì–´OrderService orderService = new OrderService(new OrderRepository()); í”„ë ˆì„ì›Œí¬ê°€ ì œì–´ ê°ì²´ ìƒì„±, ë¼ì´í”„ì‚¬ì´í´ ê´€ë¦¬, ì˜ì¡´ì„± ì£¼ì…ì€ Springì´ ì²˜ë¦¬í•˜ë¯€ë¡œ ê°œë°œìëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ì§‘ì¤‘í•  ìˆ˜ ìˆìŒ. ì˜ì¡´ ê´€ê³„ë¥¼ ì™¸ë¶€ ì„¤ì •(ApplicationContext)ì—ì„œ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì—, ì½”ë“œ ë³€ê²½ ìµœì†Œí™”. ì„¤ì •ë§Œ ë°”ê¾¸ë©´ ë‹¤ë¥¸ êµ¬í˜„ì²´ë¥¼ ì£¼ì…í•  ìˆ˜ ìˆìŒ. ì´ë¡œ ì¸í•´, í…ŒìŠ¤íŠ¸ ìš©ì´ì„±ë„ ë†’ì•„ì§ (ex : ì‰½ê²Œ MockRepositoryë¡œ êµì²´ ê°€ëŠ¥) @Serviceclass OrderService { private final OrderRepository orderRepository; @Autowired public OrderService(OrderRepository orderRepository) { this.orderRepository = orderRepository; // ì»¨í…Œì´ë„ˆê°€ ë„£ì–´ì¤Œ }}DI (Dependency Injection) ì˜ì¡´ì„± ì£¼ì… : ê°ì²´ ê°„ì˜ ì˜ì¡´ ê´€ê³„ë¥¼ ì™¸ë¶€ì—ì„œ ì£¼ì…í•´ì£¼ëŠ” ê²ƒ DIëŠ” ì œì–´ì˜ ì—­ì „ì„ í•˜ê¸° ìœ„í•œ ë°©ì‹ ì¤‘ í•˜ë‚˜ DIê°€ ì•„ë‹Œ ë‹¤ë¥¸ IoC ë°©ì‹ : Service Locator ê°ì²´ë¥¼ ì§ì ‘ ìƒì„±í•˜ì§€ ì•Šê³ , í•„ìš”í•œ ê°ì²´ë¥¼ ì°¾ëŠ” ë°©ì‹ í•˜ì§€ë§Œ, Service LocatorëŠ” ì½”ë“œê°€ Service Locatorì— ì˜ì¡´í•˜ê²Œ ë˜ì–´ í…ŒìŠ¤íŠ¸ê°€ ì–´ë ¤ì›Œì§. DIëŠ” ì˜ì¡´ì„±ì„ ì™¸ë¶€ì—ì„œ ì£¼ì…ë°›ê¸° ë•Œë¬¸ì—, ì½”ë“œê°€ ë” ìœ ì—°í•˜ê³  í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰¬ì›€. public class OrderController { private OrderService orderService; public OrderController() { // newëŠ” ì—†ì§€ë§Œ, ì—¬ì „íˆ ì½”ë“œê°€ ServiceLocatorì— ë¬¶ì—¬ìˆìŒ. this.orderService = ServiceLocator.getBean(OrderService.class); }}AOP (Aspect-Oriented Programming) íš¡ë‹¨ ê´€ì‹¬ì‚¬(íŠ¸ëœì­ì…˜, ë³´ì•ˆ, ë¡œê¹… ë“±)ë¥¼ ë³„ë„ì˜ Aspectë¡œ ë¶„ë¦¬í•˜ì—¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ì§‘ì¤‘í•  ìˆ˜ ìˆê²Œí•´ì¤Œ ì˜ˆë¥¼ ë“¤ì–´, íŠ¸ëœì­ì…˜ ì²˜ë¦¬ì‹œ AOPë¥¼ í™œìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì•„ë˜ì™€ ê°™ì€ ì½”ë“œê°€ ê³³ê³³ì— ì¤‘ë³µë˜ì–´ ë‚˜íƒ€ë‚˜ê²Œ ë  ê²ƒì´ë‹¤.public class OrderService { public void placeOrder() { System.out.println(\"íŠ¸ëœì­ì…˜ ì‹œì‘\"); // ì£¼ë¬¸ ì²˜ë¦¬ ë¡œì§ System.out.println(\"íŠ¸ëœì­ì…˜ ì»¤ë°‹\"); }} AOPë¥¼ ì‚¬ìš©í•˜ë©´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ì§‘ì¤‘í•  ìˆ˜ ìˆê³ , ì½”ë“œì˜ ì¤‘ë³µì„ ì¤„ì¼ ìˆ˜ ìˆë‹¤.@Servicepublic class OrderService { @Transactional public void placeOrder() { // ì£¼ë¬¸ ì²˜ë¦¬ ë¡œì§ë§Œ ì§‘ì¤‘ }}ì°¸ê³  ìë£Œ https://docs.spring.io/spring-framework/reference/overview.html" }, { "title": "WEB - HTTP Content-Disposition í—¤ë”", "url": "/posts/content-disposition-header/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "WEB", "date": "2025-08-05 21:25:00 +0900", "snippet": "Content-Disposition í—¤ë” ì½˜í…ì¸ ë¥¼ ë¸Œë¼ìš°ì €ì—ì„œ ì›¹í˜ì´ì§€ë¡œ ì§ì ‘ í‘œì‹œí• ì§€, ì•„ë‹ˆë©´ ì²¨ë¶€íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œí• ì§€ë¥¼ ì§€ì •Content-Disposition: inlineContent-Disposition: attachmentContent-Disposition: attachment; filename=\"file name.jpg\"Content-Dis...", "content": "Content-Disposition í—¤ë” ì½˜í…ì¸ ë¥¼ ë¸Œë¼ìš°ì €ì—ì„œ ì›¹í˜ì´ì§€ë¡œ ì§ì ‘ í‘œì‹œí• ì§€, ì•„ë‹ˆë©´ ì²¨ë¶€íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œí• ì§€ë¥¼ ì§€ì •Content-Disposition: inlineContent-Disposition: attachmentContent-Disposition: attachment; filename=\"file name.jpg\"Content-Disposition: attachment; filename*=UTF-8''file%20name.jpgíŠ¹ì§• inlineì´ë©´ ì›¹í˜ì´ì§€ë¡œ ë³´ì—¬ì§€ê³  attachmentì´ë©´ ë‹¤ìš´ë¡œë“œ ì°½ì´ ëœ¸ Content-Disposition í—¤ë”ëŠ” ì´ë©”ì¼ìš© MIME ë©”ì‹œì§€ì—ì„œ ì •ì˜ëœ ê²ƒì´ì§€ë§Œ, HTTPì—ì„œëŠ” ì¼ë¶€ íŒŒë¼ë¯¸í„°ë§Œ ì‚¬ìš© (form-data, name, filename) íŒŒì¼ëª… ì£¼ë³€ì˜ ë”°ì˜´í‘œëŠ” ì„ íƒ ì‚¬í•­ì´ì§€ë§Œ, ê³µë°± ë“±ì˜ íŠ¹ìˆ˜ë¬¸ìê°€ ìˆì„ ê²½ìš° í•„ìˆ˜ filename*ì€ RFC 5987ë¡œ ì¸ì½”ë”©ë¨ (ê³µë°±ì€ %20, í•œê¸€ì€ UTF-8ë¡œ percent-encode) ë¸Œë¼ìš°ì €ëŠ” / ë˜ëŠ” \\ ê°™ì€ ê²½ë¡œ êµ¬ë¶„ìë¥¼ _ë¡œ ë°”ê¾¸ëŠ” ë“±ì˜ ë³€í™˜ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŒ Chrome ë° Firefox 82 ì´ìƒì—ì„œëŠ” &lt;a download&gt; ì†ì„±ì´ Content-Disposition: inlineë³´ë‹¤ ìš°ì„ ì‹œë¨ (ê°™ì€ ì¶œì²˜ì˜ URLì— í•œí•¨)â€» percent ì¸ì½”ë”© ? ì¼ë°˜ì ìœ¼ë¡œ HTTP í—¤ë”ë‚˜ URLì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì œì•½ì´ ì¡´ì¬: ê³µë°±ì´ë‚˜ íŠ¹ìˆ˜ë¬¸ìëŠ” ë¬¸ì œê°€ ë  ìˆ˜ ìˆìŒ (HTTP íŒŒì„œ ì˜¤ë¥˜, ì˜ëª»ëœ URL ì¸ì‹ ë“±) ASCII ì´ì™¸ì˜ ë¬¸ì (ì˜ˆ: í•œê¸€, ì¼ë³¸ì–´ ë“±)ëŠ” ê¹¨ì§ˆ ìˆ˜ ìˆìŒ ë”°ë¼ì„œ, URLì´ë‚˜ HTTP í—¤ë”ì—ì„œ íŠ¹ìˆ˜ ë¬¸ì, ê³µë°±, ë¹„ASCII ë¬¸ì(ì˜ˆ: í•œê¸€) ë“±ì„ ì•ˆì „í•˜ê²Œ ì „ì†¡í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ì¸ì½”ë”© ë°©ì‹ìœ¼ë¡œ percent ì¸ì½”ë”©(URL ì¸ì½”ë”©)ì´ ì‚¬ìš©ë¨ ì˜ˆì‹œ : ë¬¸ìë“¤ì„ % + ASCII ì½”ë“œì˜ 16ì§„ìˆ˜ ê°’ìœ¼ë¡œ ë³€ê²½ ì›ë˜ ë¬¸ì Percent ì¸ì½”ë”© ê³µë°± (space) %20 \" (í°ë”°ì˜´í‘œ) %22 í•œê¸€ ê°€ %EA%B0%80 íŒŒì¼ ì´ë¦„.png íŒŒì¼%20ì´ë¦„.png filenameì—ì„œ percent ì¸ì½”ë”©ì´ ë¬¸ì œë˜ëŠ” ì´ìœ  ë¸Œë¼ìš°ì €ë³„ë¡œ ì²˜ë¦¬ë°©ì‹ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ (ì•„ë˜ ì˜ˆì‹œ ê¸°ì¤€): %20ì„ ê³µë°±ìœ¼ë¡œ ì˜ ë””ì½”ë”©í•¨ ë””ì½”ë”© ì•ˆ í•¨ â†’ ê·¸ëŒ€ë¡œ file%20name.png ì €ì¥ë¨ ì˜¤ë¥˜ ë°œìƒí•˜ê±°ë‚˜ íŒŒì¼ëª…ì´ ê¹¨ì§ Content-Disposition: attachment; filename=\"íŒŒì¼ ì´ë¦„.png\"Content-Disposition: attachment; filename=\"file%20name.png\" filename*ì€ RFC 5987ì— ë”°ë¼ UTF-8 + percent ì¸ì½”ë”©ì„ ì •ì‹ìœ¼ë¡œ í—ˆìš© ì˜ˆì‹œ : filename* â†’ ì¸ì½”ë”©ëœ ì§„ì§œ ì´ë¦„, filename â†’ fallbackìš© ASCII ì´ë¦„ (êµ¬í˜• ë¸Œë¼ìš°ì € ëŒ€ì‘) Content-Disposition: attachment; filename=\"fallback.png\"; filename*=UTF-8''íŒŒì¼%20ì´ë¦„.png multipart/form-data multipart/form-data ë³¸ë¬¸ì—ì„œëŠ” ê° í•„ë“œì— ëŒ€í•œ ì •ë³´ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ Content-Disposition í—¤ë”ê°€ í•„ìˆ˜ ì²« ë²ˆì§¸ ì§€ì‹œìëŠ” í•­ìƒ form-data ì¶”ê°€ ì§€ì‹œìëŠ” ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ì•Šìœ¼ë©°, = ë‹¤ìŒì— ë”°ì˜´í‘œë¡œ ê°ì‹¼ ê°’ì„ ê°€ì§€ê²Œë¨ ê° ì„œë¸Œ íŒŒíŠ¸ëŠ” Content-Type í—¤ë”ì— ì •ì˜ëœ boundaryë¡œ êµ¬ë¶„ ì˜ˆì‹œ : field1ì€ ì¼ë°˜ í…ìŠ¤íŠ¸ field2ëŠ” íŒŒì¼ ì—…ë¡œë“œ# í—¤ë”Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW# ë³¸ë¬¸------WebKitFormBoundary7MA4YWxkTrZu0gWContent-Disposition: form-data; name=\"field1\"value1------WebKitFormBoundary7MA4YWxkTrZu0gWContent-Disposition: form-data; name=\"field2\"; filename=\"example.txt\"Content-Type: text/plainvalue2------WebKitFormBoundary7MA4YWxkTrZu0gW--ì‹¤ì œ ì½”ë“œ ì˜ˆì‹œ https://start.spring.io/ ì—ì„œ GENERATE ë²„íŠ¼ ëˆŒë €ì„ ë•Œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•˜ëŠ” ì½”ë“œ (ì½”ë“œ ì¶œì²˜)// ProjectGenerationController.java@RequestMapping(path = \"/starter.zip\", method = { RequestMethod.GET, RequestMethod.POST })public ResponseEntity&lt;byte[]&gt; springZip(R request) throws IOException { ProjectGenerationResult result = this.projectGenerationInvoker.invokeProjectStructureGeneration(request); Path archive = createArchive(result, \"zip\", ZipArchiveOutputStream::new, ZipArchiveEntry::new, ZipArchiveEntry::setUnixMode); return upload(archive, result.getRootDirectory(), generateFileName(result.getProjectDescription().getArtifactId(), \"zip\"), \"application/zip\");}private ResponseEntity&lt;byte[]&gt; upload(Path archive, Path dir, String fileName, String contentType)\t\tthrows IOException {\tbyte[] bytes = Files.readAllBytes(archive);\tlogger.info(String.format(\"Uploading: %s (%s bytes)\", archive, bytes.length));\tResponseEntity&lt;byte[]&gt; result = createResponseEntity(bytes, contentType, fileName);\tthis.projectGenerationInvoker.cleanTempFiles(dir);\treturn result;}private ResponseEntity&lt;byte[]&gt; createResponseEntity(byte[] content, String contentType, String fileName) {\tString contentDispositionValue = \"attachment; filename=\\\"\" + fileName + \"\\\"\";\treturn ResponseEntity.ok()\t\t.header(\"Content-Type\", contentType)\t\t.header(\"Content-Disposition\", contentDispositionValue)\t\t.body(content);}ì°¸ê³  ìë£Œ https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Disposition" }, { "title": "Spring - Spring Boot ë²„ì „ í˜„í™© (25.07.26)", "url": "/posts/spring-versions/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Spring", "date": "2025-07-26 00:25:00 +0900", "snippet": "Spring Boot / Spring ë¦´ë¦¬ì¦ˆ ë° ì§€ì› ì¢…ë£Œ ì¼ì •Spring Boot Spring BootëŠ” 6ê°œì›”ë§ˆë‹¤ ìƒˆë¡œìš´ ë©”ì´ì € ë˜ëŠ” ë§ˆì´ë„ˆ ë²„ì „ì„ ë¦´ë¦¬ìŠ¤ (5ì›” / 11ì›”) (ë³´í†µ) ì„¸ ë²ˆì§¸ì£¼ ëª©ìš”ì¼ì— ë¦´ë¦¬ìŠ¤ë¥¼ ëª©í‘œë¡œ í•¨ Branch Initial Release End of OSS Support E...", "content": "Spring Boot / Spring ë¦´ë¦¬ì¦ˆ ë° ì§€ì› ì¢…ë£Œ ì¼ì •Spring Boot Spring BootëŠ” 6ê°œì›”ë§ˆë‹¤ ìƒˆë¡œìš´ ë©”ì´ì € ë˜ëŠ” ë§ˆì´ë„ˆ ë²„ì „ì„ ë¦´ë¦¬ìŠ¤ (5ì›” / 11ì›”) (ë³´í†µ) ì„¸ ë²ˆì§¸ì£¼ ëª©ìš”ì¼ì— ë¦´ë¦¬ìŠ¤ë¥¼ ëª©í‘œë¡œ í•¨ Branch Initial Release End of OSS Support End Enterprise Support 4.0.x 2025-11-20 2026-12-31 2027-12-31 3.5.x 2025-05-22 2026-06-30 2032-06-30 3.4.x 2024-11-21 2025-12-31 2026-12-31 3.3.x 2024-05-23 2025-06-30 2026-06-30 3.2.x 2023-11-23 2024-12-31 2025-12-31 3.1.x 2023-05-18 2024-06-30 2025-06-30 3.0.x 2022-11-24 2023-12-31 2024-12-31 2.7.x 2022-05-19 2023-06-30 2029-06-30 2.6.x 2021-11-17 2022-11-24 2024-02-24 2.5.x 2021-05-20 2022-05-19 2023-08-24 2.4.x 2020-11-12 2021-11-18 2023-02-23 2.3.x 2020-05-15 2021-05-20 2022-08-20 2.2.x 2019-10-16 2020-10-16 2022-01-16 2.1.x 2018-10-30 2019-10-30 2021-01-30 2.0.x 2018-03-01 2019-03-01 2020-06-01 1.5.x 2017-01-30 2019-08-06 2020-11-06 Spring Branch Initial Release End of OSS Support End Enterprise Support 7.0.x 2025-11-13 2027-06-30 2028-06-30 6.2.x 2024-11-14 2026-06-30 2032-06-30 6.1.x 2023-11-16 2025-06-30 2026-06-30 6.0.x 2022-11-16 2024-06-30 2025-06-30 5.3.x 2020-10-27 2023-06-30 2029-06-30 5.2.x 2019-09-30 2021-12-31 2023-12-31 5.1.x 2018-09-21 2020-12-31 2022-12-31 â€» ì°¸ê³  í•­ëª© OSS (ë¬´ë£Œ) Enterprise (ìœ ë£Œ â€“ VMware Tanzu) ë¹„ìš© ë¬´ë£Œ ìœ ë£Œ (ë¼ì´ì„ ìŠ¤ ë° ì„œë¹„ìŠ¤ ê³„ì•½) ì§€ì› Spring ì»¤ë®¤ë‹ˆí‹°ì—ì„œ Q&amp;A (ì˜ˆ: Stack Overflow, GitHub) VMware Spring íŒ€ì˜ ê³µì‹ ê¸°ìˆ  ì§€ì› ë³´ì•ˆ íŒ¨ì¹˜ ì»¤ë®¤ë‹ˆí‹°ê°€ ìœ ì§€ (EOL ì´í›„ì—” ì—†ìŒ) EOL ì´í›„ì—ë„ ë³´ì•ˆ íŒ¨ì¹˜ ë° ë²„ê·¸ ìˆ˜ì • ì§€ì› ì—…ë°ì´íŠ¸ ì£¼ê¸° ê³µê°œ ë¦´ë¦¬ìŠ¤ ì¼ì •ì— ë”°ë¦„ ì¥ê¸° ì§€ì›(LTS) ë³´ì¥ ê°€ëŠ¥ ëŒ€ìƒ ê°œì¸, ì¤‘ì†Œê¸°ì—…, ì˜¤í”ˆì†ŒìŠ¤ ì‚¬ìš©ì ëŒ€ê¸°ì—…, ê¸ˆìœµê¶Œ, ì •ë¶€, ê³ ê°€ìš©ì„± ì‹œìŠ¤í…œ ìš´ì˜ ì¡°ì§ ë²„ì „ í˜¸í™˜ì„±Spring / JDK / Java &amp; Jakarta EE Branch JDK ì§€ì› ë²”ìœ„ Java/Jakarta EE ë²„ì „ ì§€ì› ë„¤ì„ìŠ¤í˜ì´ìŠ¤ 7.0.x JDK 17 ~ 27 (ì˜ˆìƒ) Jakarta EE 11 jakarta 6.2.x JDK 17 ~ 25 (ì˜ˆìƒ) Jakarta EE 9 ~ 10 jakarta 6.1.x JDK 17 ~ 23 Jakarta EE 9 ~ 10 jakarta 6.0.x JDK 17 ~ 21 Jakarta EE 9 ~ 10 jakarta 5.3.x JDK 8 ~ 21 (5.3.26 ê¸°ì¤€) Java EE 7 ~ 8 javax Springì€ ì¥ê¸° ì§€ì›(JDK LTS) ë²„ì „ì— ëŒ€í•´ ì™„ì „í•œ í…ŒìŠ¤íŠ¸ì™€ ì§€ì›ì„ ì œê³µ. í˜„ì¬ ê¸°ì¤€ LTS ë²„ì „ì€ JDK 8, JDK 11, JDK 17, JDK 21 ë˜í•œ JDK 18, 19, 20ê³¼ ê°™ì€ ì¤‘ê°„ ë¦´ë¦¬ì¦ˆ ë²„ì „ë„ ê°€ëŠ¥í•œ í•œ ìµœì„ ì„ ë‹¤í•´ ì§€ì› ì¦‰, ë²„ê·¸ ë¦¬í¬íŠ¸ëŠ” ìˆ˜ìš©í•˜ë©° ê¸°ìˆ ì ìœ¼ë¡œ ê°€ëŠ¥í•œ ë²”ìœ„ ë‚´ì—ì„œ í•´ê²°í•˜ë ¤ê³  ë…¸ë ¥í•˜ì§€ë§Œ, ì„œë¹„ìŠ¤ ìˆ˜ì¤€ ë³´ì¥(SLA)ì€ ì œê³µí•˜ì§€ ì•ŠìŒ Spring Framework 6.x ë° 5.3.xë¥¼ ìš´ì˜ í™˜ê²½ì—ì„œ ì‚¬ìš©í•  ê²½ìš°, JDK 17 ë˜ëŠ” 21ì„ ê¶Œì¥ Spring Framework 5.3.xê°€ ì§€ì›í•˜ëŠ” ë§ˆì§€ë§‰ ëª…ì„¸ëŠ” javax ê¸°ë°˜ì˜ Java EE 8 (ì´ ëª…ì„¸ì—ëŠ” Servlet 4.0, JPA 2.2, Bean Validation 2.0ì´ í¬í•¨) Spring Framework 6.0ë¶€í„°ëŠ” ìµœì†Œ Jakarta EE 9ì„ í•„ìš”ë¡œ í•˜ë©°, Servlet 5.0, JPA 3.0, Bean Validation 3.0ì„ í¬í•¨ ìµœì‹ ì¸ Jakarta EE 10 (Servlet 6.0, JPA 3.1) ì‚¬ìš©ì„ ê¶Œì¥ Spring Boot / JDK / Spring Spring Boot ë²„ì „ ìµœì†Œ Java ë²„ì „ í•„ìš” Spring Framework ë¹„ê³  4.0 Java 17 ì´ìƒ Spring Framework 7.x Kotlin 2.2+ ì§€ì›, ìµœì‹  LTS Java ê¶Œì¥ 3.0 Java 17 ì´ìƒ Spring Framework 6.0 Java 8 ë¯¸ì§€ì› 2.0 Java 8 ì´ìƒ Spring Framework 5.0 Java 6, 7 ë¯¸ì§€ì› â€» ì°¸ê³  : Java EE / Jakarta EE ? ì›¹, DB, ë³´ì•ˆ ë“± ê¸°ì—…ìš© ê¸°ëŠ¥ì„ ìœ„í•œ ìë°” API ëª…ì„¸ ëª¨ìŒJava EE (Java Platform, Enterprise Edition) Oracleì´ ì£¼ë„í•˜ë˜ ê¸°ì—…ìš© ìë°” í‘œì¤€ í”Œë«í¼ ì›¹, íŠ¸ëœì­ì…˜, ë³´ì•ˆ, ë©”ì‹œì§• ë“± ì—”í„°í”„ë¼ì´ì¦ˆ ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œì— í•„ìš”í•œ APIë“¤ì„ ì •ì˜ ì£¼ìš” êµ¬ì„± ìš”ì†Œ: Servlet API (ì›¹ ìš”ì²­ ì²˜ë¦¬) JPA (ìë°” ê°ì²´ â†” ê´€ê³„í˜• DB ë§¤í•‘) Bean Validation (ì…ë ¥ ê²€ì¦) JMS (ìë°” ë©”ì‹œì§€ ì„œë¹„ìŠ¤) EJB, JAX-RS, ë“± Jakarta EE Java EEì˜ í›„ì† í”„ë¡œì íŠ¸ë¡œ, í˜„ì¬ëŠ” Eclipse Foundationì´ ì£¼ë„ Java EE 8ê¹Œì§€ëŠ” javax.* ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í–ˆì§€ë§Œ, Jakarta EE 9ë¶€í„°ëŠ” ëª¨ë“  APIê°€ jakarta.*ë¡œ ë°”ë€œ Springì€ ìì²´ í”„ë ˆì„ì›Œí¬ì§€ë§Œ, ìœ„ì™€ ê°™ì€ EE ìŠ¤í™ë“¤ì„ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê±°ë‚˜ í˜¸í™˜ë˜ë„ë¡ ì„¤ê³„ë˜ì–´ ìˆìŒ ê¸°ëŠ¥ ë‚´ë¶€ì ìœ¼ë¡œ EE API ì‚¬ìš© WebMVC Servlet API í•„ìš” (javax.servlet ë˜ëŠ” jakarta.servlet) JPA ì—°ë™ jakarta.persistence ë˜ëŠ” javax.persistence Bean Validation jakarta.validation or javax.validation JSON ë°”ì¸ë”© ì¼ë¶€ êµ¬í˜„ì²´ê°€ EE APIì— ì˜ì¡´ ì°¸ê³  ìë£Œ https://spring.io/projects/spring-boot#support https://spring.io/projects/spring-framework#support https://github.com/spring-projects/spring-framework/wiki/Spring-Framework-Versions https://github.com/spring-projects/spring-boot/wiki/Supported-Versions https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-3.0-Migration-Guide https://github.com/spring-projects/spring-boot/wiki/Spring-Boot-4.0-Migration-Guide" }, { "title": "ì·¨ë¯¸ ì½”ë”©", "url": "/posts/fake-it-till-you-make-it/", "categories": "ë„ì ë„ì ", "tags": "", "date": "2025-07-25 22:00:00 +0900", "snippet": "ì•ìœ¼ë¡œ ë‘ ë‹¬ê°„ ì·¨ë¯¸ë„ ì½”ë”©ì¸ ê²ƒì²˜ëŸ¼ ì‚´ì•„ë³´ê³ , ëŠê»´ì§€ëŠ”ê²Œ ìˆëŠ”ì§€ ì§€ì¼œë³´ì.", "content": "ì•ìœ¼ë¡œ ë‘ ë‹¬ê°„ ì·¨ë¯¸ë„ ì½”ë”©ì¸ ê²ƒì²˜ëŸ¼ ì‚´ì•„ë³´ê³ , ëŠê»´ì§€ëŠ”ê²Œ ìˆëŠ”ì§€ ì§€ì¼œë³´ì." }, { "title": "SXSSFë¥¼ ì‚¬ìš©í•˜ëŠ”ë° OOMì´ ë°œìƒí•œë‹¤ ?", "url": "/posts/sxssf-memory-flush/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "Java", "date": "2025-07-12 22:25:00 +0900", "snippet": "ìƒí™© ë°±ì˜¤í”¼ìŠ¤ ì‹œìŠ¤í…œì—ì„œ ì¡°íšŒ ê¸°ê°„ ê¸¸ê²Œí•´ì„œ ì—‘ì…€ íŒŒì¼ ë‹¤ìš´ë¡œë“œí–ˆë”ë‹ˆ OOM ë°œìƒ í•´ë‹¹ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë¡œì§ì—ì„œëŠ” íŒŒì¼ ìƒì„±ì„ ìœ„í•´ poi ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ SXSSF êµ¬í˜„ì²´ ì‚¬ìš©ì¤‘ ì „ì— XSSF êµ¬í˜„ì²´ì™€ ë¹„êµí–ˆì„ë•Œ, SXSSFëŠ” rowë¥¼ ë©”ëª¨ë¦¬ì—ì„œ ë””ìŠ¤í¬ë¡œ flush í•˜ë©´ì„œ ìƒì„±í•œë‹¤ê³  í–ˆëŠ”ë° ì™œ OOMì´ ë°œìƒí•œê±¸ê¹Œ ? (SXSSFRowê°€ 11ë§Œê°œë‚˜ ...", "content": "ìƒí™© ë°±ì˜¤í”¼ìŠ¤ ì‹œìŠ¤í…œì—ì„œ ì¡°íšŒ ê¸°ê°„ ê¸¸ê²Œí•´ì„œ ì—‘ì…€ íŒŒì¼ ë‹¤ìš´ë¡œë“œí–ˆë”ë‹ˆ OOM ë°œìƒ í•´ë‹¹ ì—‘ì…€ ë‹¤ìš´ë¡œë“œ ë¡œì§ì—ì„œëŠ” íŒŒì¼ ìƒì„±ì„ ìœ„í•´ poi ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ SXSSF êµ¬í˜„ì²´ ì‚¬ìš©ì¤‘ ì „ì— XSSF êµ¬í˜„ì²´ì™€ ë¹„êµí–ˆì„ë•Œ, SXSSFëŠ” rowë¥¼ ë©”ëª¨ë¦¬ì—ì„œ ë””ìŠ¤í¬ë¡œ flush í•˜ë©´ì„œ ìƒì„±í•œë‹¤ê³  í–ˆëŠ”ë° ì™œ OOMì´ ë°œìƒí•œê±¸ê¹Œ ? (SXSSFRowê°€ 11ë§Œê°œë‚˜ ìŒ“ì—¬ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤)ì›ì¸ íŒŒì•…1. SXSSF êµ¬í˜„ì²´ëŠ” ì–´ë–¤ ê¸°ì¤€ìœ¼ë¡œ rowë¥¼ flushí•˜ëŠ”ê±¸ê¹Œ ? ë¨¼ì € org.apache.poi.xssf.streaming.SXSSFSheet ì½”ë“œë¥¼ ì‚´í´ë³´ì SXSSFSheet ê¸°ì¤€ìœ¼ë¡œ rowìƒì„±ì‹œ SXSSFWorkbookì„ ìƒì„±í•  ë•Œ ë„˜ê¸´ rowAccessWindowSize(default :100)ë¼ ë¶ˆë¦¬ëŠ” ìœˆë„ìš° ì‚¬ì´ì¦ˆë¥¼ ì´ˆê³¼í•˜ë©´ ë©”ëª¨ë¦¬ìƒì˜ rowë¥¼ flushí•œë‹¤. ë‹¤ìŒì€ org.apache.poi.xssf.streaming.SXSSFWorkbookì˜ ì½”ë“œì´ë‹¤. SXSSFWorkbook.write í˜¸ì¶œì‹œ ê° ì‹œíŠ¸ë³„ë¡œ ë©”ëª¨ë¦¬ìƒì— ë‚¨ì•„ìˆëŠ” rowë¥¼ flushí•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.2. ì—‘ì…€ íŒŒì¼ ìƒì„± ê´€ë ¨ ì½”ë“œpublic void ì—‘ì…€ìƒì„±(...) { int excelTabNo = 1; int pagingSize = 10000; param.changePageSize(pagingSize); SXSSFWorkbook workbook = new SXSSFWorkbook(pagingSize); while (true) { List&lt;FooRow&gt; rows = ëª©ë¡_ì¡°íšŒ(pagingSize); if (rows.isEmpty()) { break; } // sheet ìƒì„± ë° row ì±„ìš°ê¸° Sheet sheet = workbook.createSheet(\"foo_\" + excelTabNo); ... excelTabNo++; } // ì—‘ì…€ íŒŒì¼ ìƒì„± workbook.write(...); ...} pagingSizeë§ˆë‹¤ ì—‘ì…€ ì‹œíŠ¸ê°€ ìƒˆë¡­ê²Œ ë§Œë“¤ì–´ì§€ê¸° ë•Œë¬¸ì—, í•˜ë‚˜ì˜ ì‹œíŠ¸ì— ìµœëŒ€ rowìˆ˜ëŠ” pagingSize rowAccessWindowSizeëŠ” pagingSizeì™€ ê°™ìœ¼ë¯€ë¡œ, ì‹œíŠ¸ë³„ë¡œ ë©”ëª¨ë¦¬ìƒì˜ rowìˆ˜ &gt; rowAccessWindowSizeê°€ ë  ìˆ˜ ì—†ìŒ. ë”°ë¼ì„œ, workbook.write í˜¸ì¶œì „ê¹Œì§€ëŠ” flush ë˜ì§€ì•Šê³  ë©”ëª¨ë¦¬ì— ê³„ì† ìŒ“ì´ê²Œë¨ì¡°ì¹˜ rowAccessWindowSizeëŠ” pagingSizeê°€ ì•„ë‹Œ default ê°’(100) ì‚¬ìš© ê·¸ë˜ë„ workbook.write ì „ê¹Œì§€ ì‹œíŠ¸ë³„ë¡œ ìµœëŒ€ 100ê°œì˜ rowëŠ” ë©”ëª¨ë¦¬ ìƒì— ìŒ“ì—¬ìˆê²Œë¨ ì‹œíŠ¸ê°€ ë§ì§€ëŠ” ì•Šìœ¼ë¯€ë¡œ ë©”ëª¨ë¦¬ì— ë¶€ë‹´ë˜ì§„ ì•Šì„ ê²ƒìœ¼ë¡œ ìƒê° 100ë³´ë‹¤ ë” ì‘ìœ¼ë©´ Disk I/Oê°€ ë„ˆë¬´ ë§ì´ ë°œìƒí•˜ì§€ ì•Šì„ê¹Œ ìƒê°í•¨ " }, { "title": "MySQL - LOCK ì‚´í´ë³´ê¸°", "url": "/posts/mysql-lock/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "MySQL", "date": "2025-07-01 21:00:00 +0900", "snippet": " ë½ì„ ì˜ ëª¨ë¥´ë©´ ë¹„íš¨ìœ¨ì ì¸ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ê±°ë‚˜, ë°ë“œë½ì„ ìœ ë°œí•˜ê±°ë‚˜, ë¶ˆí•„ìš”í•œ ì„±ëŠ¥ì €í•˜ ë“±ì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤ê³  ìƒê°í•œë‹¤. ë˜í•œ ë””ë²„ê¹…ì‹œ ì‹¤ë§ˆë¦¬ë¥¼ ëª»ì¡ì„ ìˆ˜ë„ ìˆë‹¤.ì´ëŸ° ì¼ì„ ìµœëŒ€í•œ ê²ªì§€ ì•Šë„ë¡ MySQLì—ì„œëŠ” ì–´ë–¤ ë½ì„ ì œê³µí•˜ëŠ”ì§€ ì‚´í´ë³´ì.Lock ìœ í˜• InnoDBëŠ” í–‰ ìˆ˜ì¤€(row-level) ì ê¸ˆì„ êµ¬í˜„í•˜ë©°(í…Œì´ë¸” ìˆ˜ì¤€ ì ê¸ˆë„ ì§€ì›), ê³µìœ (S...", "content": " ë½ì„ ì˜ ëª¨ë¥´ë©´ ë¹„íš¨ìœ¨ì ì¸ ì¿¼ë¦¬ë¥¼ ì‘ì„±í•˜ê±°ë‚˜, ë°ë“œë½ì„ ìœ ë°œí•˜ê±°ë‚˜, ë¶ˆí•„ìš”í•œ ì„±ëŠ¥ì €í•˜ ë“±ì„ ì¼ìœ¼í‚¬ ìˆ˜ ìˆë‹¤ê³  ìƒê°í•œë‹¤. ë˜í•œ ë””ë²„ê¹…ì‹œ ì‹¤ë§ˆë¦¬ë¥¼ ëª»ì¡ì„ ìˆ˜ë„ ìˆë‹¤.ì´ëŸ° ì¼ì„ ìµœëŒ€í•œ ê²ªì§€ ì•Šë„ë¡ MySQLì—ì„œëŠ” ì–´ë–¤ ë½ì„ ì œê³µí•˜ëŠ”ì§€ ì‚´í´ë³´ì.Lock ìœ í˜• InnoDBëŠ” í–‰ ìˆ˜ì¤€(row-level) ì ê¸ˆì„ êµ¬í˜„í•˜ë©°(í…Œì´ë¸” ìˆ˜ì¤€ ì ê¸ˆë„ ì§€ì›), ê³µìœ (S, Shared Lock) ì ê¸ˆê³¼ ë°°íƒ€(X, Exclusive Lock) ì ê¸ˆ ë‘ ê°€ì§€ ìœ í˜•ì´ ìˆë‹¤.Shared Lock ê³µìœ (S) ì ê¸ˆ í•´ë‹¹ ì ê¸ˆì„ ë³´ìœ í•œ íŠ¸ëœì­ì…˜ì´ í–‰ì„ ì½ì„ ìˆ˜ ìˆë„ë¡ í—ˆìš© íŠ¸ëœì­ì…˜ T1ì´ í–‰ rì— ëŒ€í•´ ê³µìœ (S) ì ê¸ˆì„ ë³´ìœ í•˜ê³  ìˆëŠ” ê²½ìš°, ë³„ê°œì˜ íŠ¸ëœì­ì…˜ T2ê°€ í–‰ rì— ëŒ€í•´ ì ê¸ˆì„ ìš”ì²­í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì²˜ë¦¬ëœë‹¤: T2ê°€ S ì ê¸ˆì„ ìš”ì²­í•œ ê²½ìš°, ì¦‰ì‹œ í—ˆìš©í•œë‹¤. ê·¸ ê²°ê³¼, T1ê³¼ T2ëŠ” ëª¨ë‘ rì— ëŒ€í•´ S ì ê¸ˆì„ ë³´ìœ í•˜ê²Œ ëœë‹¤. T2ê°€ X ì ê¸ˆì„ ìš”ì²­í•œ ê²½ìš°ëŠ” í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.Exclusive Lock ë°°íƒ€(X) ì ê¸ˆ í•´ë‹¹ ì ê¸ˆì„ ë³´ìœ í•œ íŠ¸ëœì­ì…˜ì´ í–‰ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ì‚­ì œí•  ìˆ˜ ìˆë„ë¡ í—ˆìš© íŠ¸ëœì­ì…˜ T1ì´ í–‰ rì— ëŒ€í•´ ë°°íƒ€(X) ì ê¸ˆì„ ë³´ìœ í•˜ê³  ìˆëŠ” ê²½ìš°, ë³„ê°œì˜ íŠ¸ëœì­ì…˜ T2ê°€ rì— ëŒ€í•´ ì–´ë–¤ ì¢…ë¥˜ì˜ ì ê¸ˆ(S ë˜ëŠ” X)ì„ ìš”ì²­í•˜ë”ë¼ë„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ì¦‰, íŠ¸ëœì­ì…˜ T2ëŠ” T1ì´ í–‰ rì— ëŒ€í•œ ì ê¸ˆì„ í•´ì œí•  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤.Lock ì¢…ë¥˜Intention Lock íŠ¸ëœì­ì…˜ì´ í…Œì´ë¸”ì˜ íŠ¹ì • í–‰ì— ëŒ€í•´ ë‚˜ì¤‘ì— ì–´ë–¤ ì¢…ë¥˜ì˜ ì ê¸ˆ(ê³µìœ  ë˜ëŠ” ë°°íƒ€)ì„ ì„¤ì •í•  ê²ƒì¸ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” í…Œì´ë¸” ìˆ˜ì¤€ì˜ ì ê¸ˆëª©ì  ë‹¤ì¤‘ ì„¸ë¶„í™” ì ê¸ˆ(multiple granularity locking)ì„ ì§€ì›í•˜ì—¬ í–‰ ì ê¸ˆ(row locks) ê³¼ í…Œì´ë¸” ì ê¸ˆ(table locks) ì´ ê³µì¡´í•˜ë©° íš¨ìœ¨ì ìœ¼ë¡œ ì‘ë™í•  ìˆ˜ ìˆê²Œ í•˜ê¸° ìœ„í•¨ì˜ˆì‹œë¥¼ í†µí•´ ì˜ë„ ì ê¸ˆ í•„ìš”ì„± ì´í•´í•˜ê¸°A íŠ¸ëœì­ì…˜ì´ IX ë½ì„ í…Œì´ë¸”ì— ê±¸ê³  ìˆëŠ” ìƒíƒœB íŠ¸ëœì­ì…˜ì´ LOCK TABLE my_table WRITEë¡œ í…Œì´ë¸” ì „ì²´ ë½ì„ ìš”ì²­â†’ IX ë½ì´ ì´ë¯¸ ìˆê¸° ë•Œë¬¸ì—, ë°”ë¡œ ì¶©ëŒ íŒë‹¨ í›„ BëŠ” blockë¨â†’ ì „ì²´ í–‰ ì ê¸ˆ ëª©ë¡ì„ ë‹¤ ë’¤ì ¸ë³¼ í•„ìš” ì—†ìŒâ€» ë‹¤ì¤‘ ì„¸ë¶„í™” ì ê¸ˆ(Multiple Granularity Locking) ? ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì—¬ëŸ¬ ìˆ˜ì¤€(granularity)ì˜ ê°ì²´ì— ëŒ€í•´ ë™ì‹œì— ì ê¸ˆì„ ì„¤ì •í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ë©”ì»¤ë‹ˆì¦˜ ì¦‰, í…Œì´ë¸”(table), í˜ì´ì§€(page), í–‰(row)ê³¼ ê°™ì´ ë°ì´í„° êµ¬ì¡°ì˜ ë‹¤ì–‘í•œ ìˆ˜ì¤€ì— ëŒ€í•´ ì„œë¡œ ë‹¤ë¥¸ í¬ê¸°ì˜ ì ê¸ˆì„ ë™ì‹œì— ì ìš©í•  ìˆ˜ ìˆê²Œ ë§Œë“œëŠ” ê¸°ë²•ì¢…ë¥˜ ì˜ë„ ê³µìœ  ì ê¸ˆ(IS ì ê¸ˆ) íŠ¸ëœì­ì…˜ì´ í…Œì´ë¸” ë‚´ ê°œë³„ í–‰ë“¤ì— ëŒ€í•´ ê³µìœ  ì ê¸ˆì„ ì„¤ì •í•˜ë ¤ê³  ì˜ë„í•˜ê³  ìˆìŒì„ ë‚˜íƒ€ë‚¸ë‹¤. ex : SELECT ... FOR SHARE ëŠ” IS ì ê¸ˆì„ ì„¤ì • ì˜ë„ ë°°íƒ€ ì ê¸ˆ(IX ì ê¸ˆ) íŠ¸ëœì­ì…˜ì´ í…Œì´ë¸” ë‚´ ê°œë³„ í–‰ë“¤ì— ëŒ€í•´ ë°°íƒ€ ì ê¸ˆì„ ì„¤ì •í•˜ë ¤ê³  ì˜ë„í•˜ê³  ìˆìŒì„ ë‚˜íƒ€ë‚¸ë‹¤. ex : SELECT ... FOR UPDATEëŠ” IX ì ê¸ˆì„ ì„¤ì • ë™ì‘ ë°©ì‹ íŠ¸ëœì­ì…˜ì´ í…Œì´ë¸”ì˜ í–‰ì— ëŒ€í•´ ê³µìœ  ì ê¸ˆì„ íšë“í•˜ë ¤ë©´, ë¨¼ì € í•´ë‹¹ í…Œì´ë¸”ì— ëŒ€í•´ IS ì ê¸ˆ ë˜ëŠ” ê·¸ë³´ë‹¤ ê°•í•œ ì ê¸ˆì„ íšë“í•´ì•¼ í•œë‹¤. íŠ¸ëœì­ì…˜ì´ í…Œì´ë¸”ì˜ í–‰ì— ëŒ€í•´ ë°°íƒ€ ì ê¸ˆì„ íšë“í•˜ë ¤ë©´, ë¨¼ì € í•´ë‹¹ í…Œì´ë¸”ì— ëŒ€í•´ IX ì ê¸ˆì„ íšë“í•´ì•¼ í•œë‹¤. íŠ¸ëœì­ì…˜ì€ ì¶©ëŒí•˜ëŠ” ì ê¸ˆì´ í•´ì œë  ë•Œê¹Œì§€ ëŒ€ê¸°í•œë‹¤. í•˜ì§€ë§Œ, ì ê¸ˆ ìš”ì²­ì´ ê¸°ì¡´ ì ê¸ˆê³¼ ì¶©ëŒí•˜ê³  ì´ë¡œ ì¸í•´ ë°ë“œë½(deadlock) ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤ë©´, ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.ì ê¸ˆ í˜¸í™˜ì„± ì˜ë„ ì ê¸ˆì€ ì „ì²´ í…Œì´ë¸” ì ê¸ˆ ìš”ì²­(ì˜ˆ: LOCK TABLES â€¦ WRITE)ì„ ì œì™¸í•˜ê³ ëŠ” ì•„ë¬´ê²ƒë„ ì°¨ë‹¨í•˜ì§€ ì•ŠëŠ”ë‹¤. í˜„ì¬ ì ê¸ˆ â†“ / ìš”ì²­ ì ê¸ˆ â†’ X IX S IS X âŒ âŒ âŒ âŒ IX âŒ âœ… âŒ âœ… S âŒ âŒ âœ… âœ… IS âŒ âœ… âœ… âœ… -- íŠ¸ëœì­ì…˜ ASTART TRANSACTION;SELECT * FROM my_table WHERE id = 1 FOR UPDATE; -- IX (on table) + X (on row id=1)-- íŠ¸ëœì­ì…˜ BSTART TRANSACTION;SELECT * FROM my_table WHERE id = 2 FOR UPDATE; -- IX (on table) + X (on row id=2) ë‘˜ ë‹¤ ê°™ì€ í…Œì´ë¸”ì—ì„œ ì‘ì—…í•˜ì§€ë§Œ ê°ê° ë‹¤ë¥¸ rowì— row-level X ë½ì„ ìš”ì²­ ê·¸ë˜ì„œ InnoDBëŠ” í…Œì´ë¸”ì— ê°ê° IX ì ê¸ˆì„ ì„¤ì •í•¨ IXì™€ IXëŠ” í˜¸í™˜ë˜ê¸° ë•Œë¬¸ì— ë™ì‹œì— ì‘ì—… ê°€ëŠ¥Record Lock ì¸ë±ìŠ¤ ë ˆì½”ë“œì— ì„¤ì •ë˜ëŠ” ì ê¸ˆ ì˜ˆë¥¼ ë“¤ì–´, SELECT c1 FROM t WHERE c1 = 10 FOR UPDATE; ëŠ” t.c1ì´ 10ì¸ í–‰ì„ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ ì‚½ì…, ìˆ˜ì •, ì‚­ì œí•˜ì§€ ëª»í•˜ë„ë¡ ë§‰ëŠ”ë‹¤. ë ˆì½”ë“œ ë½ì€ í•­ìƒ ì¸ë±ìŠ¤ ë ˆì½”ë“œë¥¼ ëŒ€ìƒìœ¼ë¡œ ì‘ë™í•˜ë©°, í…Œì´ë¸”ì— ì¸ë±ìŠ¤ê°€ ì—†ì–´ë„ ë§ˆì°¬ê°€ì§€ì´ë‹¤. ì¸ë±ìŠ¤ê°€ ì—†ëŠ” ê²½ìš°, InnoDBëŠ” ìˆ¨ê²¨ì§„ í´ëŸ¬ìŠ¤í„°í˜• ì¸ë±ìŠ¤ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•˜ê³ , ì´ë¥¼ ì‚¬ìš©í•´ ë ˆì½”ë“œ ì ê¸ˆì„ ìˆ˜í–‰í•œë‹¤.â€» ì¸ë±ìŠ¤ ë ˆì½”ë“œ ? ì¸ë±ìŠ¤ì— ì €ì¥ëœ ê° í•­ëª©(=í–‰ì˜ ìœ„ì¹˜ë¥¼ ê°€ë¦¬í‚¤ëŠ” ì—”íŠ¸ë¦¬)ì¦‰, ì‹¤ì œ í–‰ ë°ì´í„°ê°€ ì•„ë‹Œ ì¸ë±ìŠ¤ ë‚´ë¶€ì˜ í‚¤ì™€ í¬ì¸í„°ë¡œ êµ¬ì„±ëœ ë°ì´í„° êµ¬ì¡° InnoDBëŠ” ëª¨ë“  í…Œì´ë¸”ì„ í´ëŸ¬ìŠ¤í„°í˜• ì¸ë±ìŠ¤(Primary Key ê¸°ë°˜ B+íŠ¸ë¦¬) êµ¬ì¡°ë¡œ ì €ì¥ ë”°ë¼ì„œ, ì–´ë–¤ í–‰(row)ì„ ì°¾ê³  ìˆ˜ì •í•  ë•Œë„ í•­ìƒ ì¸ë±ìŠ¤ë¥¼ í†µí•´ ìœ„ì¹˜ë¥¼ ì°¾ê³  ì‘ì—… ì ê¸ˆì˜ ëŒ€ìƒì´ ë˜ëŠ” í–‰ì€ ê³§ ì¸ë±ìŠ¤ ë ˆì½”ë“œ ìƒì— ì¡´ì¬í•˜ëŠ” ì—”íŠ¸ë¦¬ì´ê¸° ë•Œë¬¸ì—, ì¸ë±ìŠ¤ ë ˆì½”ë“œ ë‹¨ìœ„ ë½ì„ ê±°ëŠ” ê²ƒì´ ì •í™•í•˜ê³  íš¨ìœ¨ì  gap lock, next-key lock ê°™ì€ ë½ ì „ëµë„ ì „ë¶€ ì¸ë±ìŠ¤ ë ˆì½”ë“œ ì‚¬ì´ ë˜ëŠ” ë ˆì½”ë“œ + ê°­ ì„ ê¸°ì¤€ìœ¼ë¡œ ë™ì‘Gap Lock ì¸ë±ìŠ¤ ë ˆì½”ë“œë“¤ ì‚¬ì´ì˜ ê°„ê²©ì´ë‚˜, ì²« ë²ˆì§¸ ì´ì „ ë˜ëŠ” ë§ˆì§€ë§‰ ì´í›„ì˜ ê°„ê²©ì— ì„¤ì •ë˜ëŠ” ì ê¸ˆì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ SELECT c1 FROM t WHERE c1 BETWEEN 10 and 20 FOR UPDATE; ì¿¼ë¦¬ëŠ”, í•´ë‹¹ ë²”ìœ„ ë‚´ì˜ ê¸°ì¡´ ê°’ì´ ì¡´ì¬í•˜ë“  ì•„ë‹ˆë“  ê´€ê³„ì—†ì´, ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ c1ì— 15ë¥¼ ì‚½ì…í•˜ì§€ ëª»í•˜ê²Œ ë§‰ëŠ”ë‹¤. ì´ëŠ” í•´ë‹¹ ë²”ìœ„ ë‚´ ëª¨ë“  ê°’ë“¤ ì‚¬ì´ì˜ ê°„ê²©ì— ê°­ ë½ì´ ê±¸ë¦¬ê¸° ë•Œë¬¸ì´ë‹¤. ê°­ì€ í•˜ë‚˜ì˜ ì¸ë±ìŠ¤ ê°’ ì‚¬ì´ì¼ ìˆ˜ë„ ìˆê³ , ì—¬ëŸ¬ ê°’ ì‚¬ì´ì¼ ìˆ˜ë„ ìˆìœ¼ë©°, ì‹¬ì§€ì–´ ì•„ë¬´ ê°’ì´ ì—†ì–´ë„ ê°­ì´ ì¡´ì¬í•  ìˆ˜ ìˆë‹¤. ê°­ ë½ì€ ì„±ëŠ¥ê³¼ ë™ì‹œì„± ê°„ì˜ ì ˆì¶©ì˜ ì¼ë¶€ë¡œ, ì¼ë¶€ íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œë§Œ ì‚¬ìš©ë˜ê³  ë‹¤ë¥¸ ìˆ˜ì¤€ì—ì„œëŠ” ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤. ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ë¥¼ í†µí•´ íŠ¹ì • í–‰ì„ ì°¾ëŠ” ì¿¼ë¦¬ëŠ” ê°­ ë½ì´ í•„ìš” ì—†ë‹¤. ë‹¨, ë‹¤ì¤‘ ì—´ ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ ì¤‘ ì¼ë¶€ ì—´ë§Œ ì¡°ê±´ì— í¬í•¨ëœ ê²½ìš°ì—ëŠ” ì˜ˆì™¸ë¡œ, ê°­ ë½ì´ ë°œìƒí•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, id ì»¬ëŸ¼ì— ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ê°€ ìˆë‹¤ë©´ ë‹¤ìŒ ì¿¼ë¦¬ëŠ” idê°€ 100ì¸ í–‰ì—ë§Œ ë ˆì½”ë“œ ì ê¸ˆë§Œ ê±¸ë¦¬ê³ , ë‹¤ë¥¸ ì„¸ì…˜ì´ ê·¸ ì•ì— ê°’ì„ ì‚½ì…í•˜ë”ë¼ë„ ë¬¸ì œë˜ì§€ ì•ŠëŠ”ë‹¤.SELECT * FROM child WHERE id = 100; ë§Œì•½ idê°€ ì¸ë±ìŠ¤ê°€ ì—†ê±°ë‚˜ ìœ ë‹ˆí¬í•˜ì§€ ì•Šì€ ì¸ë±ìŠ¤ë¼ë©´, í•´ë‹¹ ì¿¼ë¦¬ëŠ” ì•ìª½ ê°­ì—ë„ ì ê¸ˆì„ ê±´ë‹¤. ì—¬ê¸°ì„œ ì£¼ëª©í•  ì ì€, ì„œë¡œ ì¶©ëŒí•˜ëŠ” ë½ì´ ê°™ì€ ê°­ì— ëŒ€í•´ ì„œë¡œ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì— ì˜í•´ ìœ ì§€ë  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì¦‰, ê°­ ë½(gap lock)ì€ ê³µìœ /ë°°íƒ€(S/X)ë¼ëŠ” êµ¬ë¶„ì´ ìˆì§€ë§Œ, ì‹¤ì œë¡œëŠ” ì¶©ëŒí•˜ì§€ ì•ŠëŠ”ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, íŠ¸ëœì­ì…˜ Aê°€ ì–´ë–¤ ê°­ì— ëŒ€í•´ ê³µìœ  ê°­ ë½ì„ ê±¸ê³  ìˆëŠ” ë™ì‹œì—, íŠ¸ëœì­ì…˜ Bê°€ ë°°íƒ€ ê°­ ë½ì„ ê°™ì€ ê°­ì— ê±¸ ìˆ˜ë„ ìˆë‹¤. ì„œë¡œ ì¶©ëŒí•˜ëŠ” ê°­ ë½ì´ í—ˆìš©ë˜ëŠ” ì´ìœ ëŠ”, ì¸ë±ìŠ¤ì—ì„œ ì–´ë–¤ ë ˆì½”ë“œê°€ ì œê±°ë  ê²½ìš°, í•´ë‹¹ ë ˆì½”ë“œì— ê±¸ë¦° ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì˜ ê°­ ë½ì„ ë³‘í•©í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì´ë‹¤. InnoDBì˜ ê°­ ë½ì€ â€œìˆœìˆ˜í•˜ê²Œ ì–µì œìš©â€ ìœ¼ë¡œ, ê·¸ ëª©ì ì€ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì´ í•´ë‹¹ ê°­ì— ê°’ì„ ì‚½ì…í•˜ì§€ ëª»í•˜ê²Œ ë§‰ëŠ” ê²ƒë¿ì´ë‹¤. ê³µìœ  ê°­ ë½ê³¼ ë°°íƒ€ ê°­ ë½ì€ ì‹¤ì œë¡œ ì°¨ì´ê°€ ì—†ìœ¼ë©°, ì„œë¡œ ì¶©ëŒí•˜ì§€ ì•Šê³ , ê°™ì€ ì—­í• ì„ í•œë‹¤. ê°­ ë½ì€ ëª…ì‹œì ìœ¼ë¡œ ë¹„í™œì„±í™”ë  ìˆ˜ ìˆìœ¼ë©°, ì´ëŠ” íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì„ READ COMMITTEDë¡œ ë°”ê¿€ ë•Œ ë°œìƒí•œë‹¤. ì´ ê²½ìš°, ê°­ ë½ì€ ê²€ìƒ‰ì´ë‚˜ ì¸ë±ìŠ¤ ìŠ¤ìº”ì—ì„œëŠ” ì‚¬ìš©ë˜ì§€ ì•Šìœ¼ë©°, ì™¸ë˜ í‚¤ ì œì•½ ì¡°ê±´ì´ë‚˜ ì¤‘ë³µ í‚¤ ê²€ì‚¬ì—ë§Œ ì‚¬ìš©ëœë‹¤. READ COMMITTED ê²©ë¦¬ ìˆ˜ì¤€ì„ ì‚¬ìš©í•  ê²½ìš° ê¸°íƒ€ ë¶€ìˆ˜ì ì¸ íš¨ê³¼ë“¤ë„ ìˆë‹¤. WHERE ì¡°ê±´ì— ë§ì§€ ì•ŠëŠ” ë ˆì½”ë“œì— ê±¸ë¦° ì ê¸ˆì€, MySQLì´ ì¡°ê±´ì„ í‰ê°€í•œ í›„ ì¦‰ì‹œ í•´ì œëœë‹¤. UPDATE ë¬¸ì— ëŒ€í•´ì„œ InnoDBëŠ” â€œì„¸ë¯¸ ì¼ê´€ì„±(semi-consistent)â€ ì½ê¸°ë¥¼ ìˆ˜í–‰í•˜ëŠ”ë°, ì´ëŠ” MySQLì—ê²Œ ê°€ì¥ ìµœê·¼ ì»¤ë°‹ëœ ë²„ì „ì„ ì „ë‹¬í•˜ì—¬ í•´ë‹¹ í–‰ì´ WHERE ì¡°ê±´ì— ë§ëŠ”ì§€ íŒë‹¨í•˜ë„ë¡ í•˜ëŠ” ë°©ì‹ì´ë‹¤. â€» S/X ê°­ ë½ ì°¨ì´ê°€ ì—†ëŠ”ë° êµ¬ë¶„í•˜ëŠ” ì´ìœ  ? S Gap Lockê³¼ X Gap Lockì€ MySQL ì‚¬ìš©ìì˜ ê´€ì ì—ì„œëŠ” êµ¬ë¶„ë˜ì§€ë§Œ, ë‚´ë¶€ì ìœ¼ë¡œëŠ” â€œê°­ì— ëŒ€í•œ ì‚½ì… ì°¨ë‹¨â€ì´ë¼ëŠ” ë™ì¼í•œ íš¨ê³¼ë¥¼ ê°€ì§. ë”°ë¼ì„œ ì‹¤ì œë¡œëŠ” ê°­ì„ ì ê°”ëŠ”ì§€ ì—¬ë¶€ë§Œ ì¤‘ìš”. ì¦‰, ì‚½ì…ì´ ê°€ëŠ¥/ë¶ˆê°€ëŠ¥ì´ í•µì‹¬ì´ì§€, â€œê³µìœ ëƒ ë°°íƒ€ëƒâ€ëŠ” í° ì˜ë¯¸ê°€ ì—†ìŒ ë‹¤ë§Œ, ì‚¬ìš©ì ë˜ëŠ” SQL êµ¬ë¬¸ ë‹¨ìœ„ë¡œëŠ” ì •í™•í•œ íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ í‘œí˜„ì„ ìœ„í•´ êµ¬ë¶„í•¨. ì¦‰, ì¿¼ë¦¬ì˜ ì˜ë„(intent)ë¥¼ ëª…í™•íˆ í•˜ê¸° ìœ„í•´ SQL ë ˆë²¨ì—ì„œ êµ¬ë¶„í•˜ëŠ” ê²ƒ SELECT ... FOR UPDATE: \"ë‚˜ëŠ” ê°’ì„ ìˆ˜ì •í•  ìˆ˜ë„ ìˆì–´\" â†’ X Gap LockSELECT ... LOCK IN SHARE MODE: \"ë‚˜ëŠ” ì½ê¸°ë§Œ í•  ê±°ì•¼\" â†’ S Gap Lockâ€» í•„í„°ë§ ì¡°ê±´ê³¼ ê°­ ë½ ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ë¥¼ í†µí•´ íŠ¹ì • í–‰ì„ ì°¾ëŠ” ì¿¼ë¦¬ëŠ” ê°­ ë½ì´ í•„ìš” ì—†ë‹¤. ì™œëƒí•˜ë©´ ì´ ê²½ìš° InnoDBëŠ” ì •í™•íˆ í•˜ë‚˜ì˜ í–‰ë§Œ ì ê·¸ë©´ ë˜ë¯€ë¡œ, ë²”ìœ„ ì „ì²´ë¥¼ ì ê¸€ í•„ìš”ê°€ ì—†ìŒ ë‹¨, ë‹¤ì¤‘ ì—´ ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ ì¤‘ ì¼ë¶€ ì—´ë§Œ ì¡°ê±´ì— í¬í•¨ëœ ê²½ìš°ì—ëŠ” ì˜ˆì™¸ë¡œ, ê°­ ë½ì´ ë°œìƒí•œë‹¤. ì™œëƒí•˜ë©´ ì¡°ê±´ì´ ì• ë§¤í•˜ê±°ë‚˜ ë¶ˆì™„ì „í•˜ë©´ MySQLì´ ì •í™•íˆ í•˜ë‚˜ì˜ í–‰ì„ ì°¾ì•˜ëŠ”ì§€ í™•ì‹ í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ CREATE TABLE product ( category_id INT, code VARCHAR(50), price INT, UNIQUE(category_id, code));-- ì¿¼ë¦¬SELECT * FROM product WHERE category_id = 1 FOR UPDATE; (category_id, code)ëŠ” ë³µí•© ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ ê·¸ëŸ°ë° ê²€ìƒ‰ ì¡°ê±´ì€ category_id = 1ë§Œ í¬í•¨ë¨ (ë¶ˆì™„ì „ ì¡°ê±´) InnoDBëŠ” â€œì •í™•íˆ í•˜ë‚˜ì˜ í–‰ë§Œâ€ ì°¾ì•˜ëŠ”ì§€ ë³´ì¥í•  ìˆ˜ ì—†ìŒ ë”°ë¼ì„œ, ê²€ìƒ‰ëœ ë²”ìœ„ ì „ì²´ì— next-key lock (record + gap) ê±¸ê²Œë¨ SELECT * FROM product WHERE id = 123 FOR UPDATE LIMIT 1; ì •í™•í•œ ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•œ ì¡°ê±´ + LIMIT ì´ ê²½ìš°ëŠ” ì •í™•íˆ í•œ rowë§Œ ì°¾ì•„ì„œ ê·¸ rowë§Œ record lock (X) ê±¸ë¦¼Next-Key Lock ì¸ë±ìŠ¤ ë ˆì½”ë“œì— ëŒ€í•œ ë ˆì½”ë“œ ë½ê³¼, ê·¸ ì•ì— ìˆëŠ” ê°­ì— ëŒ€í•œ ê°­ ë½ì˜ ì¡°í•© InnoDBëŠ” í…Œì´ë¸” ì¸ë±ìŠ¤ë¥¼ ê²€ìƒ‰í•˜ê±°ë‚˜ ìŠ¤ìº”í•  ë•Œ, ë°œê²¬í•œ ì¸ë±ìŠ¤ ë ˆì½”ë“œì— ê³µìœ  ë˜ëŠ” ë°°íƒ€ ì ê¸ˆì„ ì„¤ì •í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í–‰ ìˆ˜ì¤€ ì ê¸ˆì„ ìˆ˜í–‰í•œë‹¤. ë”°ë¼ì„œ, í–‰ ìˆ˜ì¤€ ì ê¸ˆì€ ì‹¤ì œë¡œëŠ” ì¸ë±ìŠ¤ ë ˆì½”ë“œ ì ê¸ˆì´ë‹¤. ì¸ë±ìŠ¤ ìœ í˜• next-key lock ê¸°ì¤€ ì»¬ëŸ¼ ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ (ë‹¨ì¼/ë³µí•©) ëª¨ë“  ì¸ë±ìŠ¤ ì»¬ëŸ¼ì´ ì™„ì „íˆ ì¡°ê±´ì— í¬í•¨ë˜ì–´ì•¼ ì •í™•íˆ 1ê±´ë§Œ ì ê¸ˆ (â†’ gap lock ì—†ìŒ) ë¹„ìœ ë‹ˆí¬ ë³µí•© ì¸ë±ìŠ¤ ì²« ë²ˆì§¸ ì»¬ëŸ¼ ê¸°ì¤€ìœ¼ë¡œ ë²”ìœ„ ìŠ¤ìº”, ìŠ¤ìº”ëœ ë²”ìœ„ì˜ ëª¨ë“  ë ˆì½”ë“œì— next-key lock ë°œìƒ ì¸ë±ìŠ¤ ë ˆì½”ë“œì— ì„¤ì •ëœ ë„¥ìŠ¤íŠ¸í‚¤ ë½ì€ í•´ë‹¹ ì¸ë±ìŠ¤ ë ˆì½”ë“œ ë°”ë¡œ ì•ì˜ ê°­ì—ë„ ì˜í–¥ì„ ë¯¸ì¹œë‹¤. ì¦‰, ë„¥ìŠ¤íŠ¸í‚¤ ë½ì€ ì¸ë±ìŠ¤ ë ˆì½”ë“œ ì ê¸ˆ + ê·¸ ì• ê°­ì— ëŒ€í•œ ê°­ ë½ì´ë‹¤. ë”°ë¼ì„œ, í•œ ì„¸ì…˜ì´ ì¸ë±ìŠ¤ì—ì„œ ë ˆì½”ë“œ Rì— ëŒ€í•´ ê³µìœ  ë˜ëŠ” ë°°íƒ€ ì ê¸ˆì„ ê°€ì§€ê³  ìˆë‹¤ë©´, ë‹¤ë¥¸ ì„¸ì…˜ì€ R ë°”ë¡œ ì•ì˜ ê°­ì— ìƒˆë¡œìš´ ì¸ë±ìŠ¤ ë ˆì½”ë“œë¥¼ ì‚½ì…í•  ìˆ˜ ì—†ë‹¤.ì˜ˆì‹œ-- ì¸ë±ìŠ¤ì— ê°’ì´ 10, 11, 13, 20ì´ ìˆë‹¤ê³  ê°€ì •-- ì´ ì¸ë±ìŠ¤ì— ëŒ€í•´ ê°€ëŠ¥í•œ ë„¥ìŠ¤íŠ¸í‚¤ ë½ì€ ë‹¤ìŒ êµ¬ê°„ë“¤ì„ í¬í•¨-- (ì†Œê´„í˜¸ëŠ” ëì  ì œì™¸, ëŒ€ê´„í˜¸ëŠ” ëì  í¬í•¨)(-ë¬´í•œëŒ€, 10](10, 11](11, 13](13, 20](20, +ë¬´í•œëŒ€) ë§ˆì§€ë§‰ êµ¬ê°„ì—ì„œëŠ”, ë„¥ìŠ¤íŠ¸í‚¤ ë½ì´ ì¸ë±ìŠ¤ì—ì„œ ê°€ì¥ í° ê°’ë³´ë‹¤ ìœ„ì— ìˆëŠ” ê°­ê³¼, ì‹¤ì œ ì¸ë±ìŠ¤ ê°’ë³´ë‹¤ í° ê°’ì„ ê°€ì§€ëŠ” â€œsupremumâ€ ê°€ìƒ ë ˆì½”ë“œë¥¼ ì ê·¼ë‹¤. supremumì€ ì‹¤ì œ ì¸ë±ìŠ¤ ë ˆì½”ë“œê°€ ì•„ë‹ˆë¯€ë¡œ, ê²°êµ­ ì´ ë„¥ìŠ¤íŠ¸í‚¤ ë½ì€ ê°€ì¥ í° ì¸ë±ìŠ¤ ê°’ ì´í›„ì˜ ê°­ë§Œ ì ê·¸ëŠ” ê²ƒê³¼ ê°™ë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ InnoDBëŠ” REPEATABLE READ íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œ ë™ì‘í•œë‹¤. ì´ ê²½ìš° InnoDBëŠ” ê²€ìƒ‰ê³¼ ì¸ë±ìŠ¤ ìŠ¤ìº”ì— ë„¥ìŠ¤íŠ¸í‚¤ ë½ì„ ì‚¬ìš©í•˜ì—¬, íŒ¬í…€ ë ˆì½”ë“œ(phantom row)ì˜ ë°œìƒì„ ë°©ì§€í•œë‹¤.Insert Intention Locks INSERT ì‘ì—…ì´ í–‰ì„ ì‹¤ì œë¡œ ì‚½ì…í•˜ê¸° ì „ì— ì„¤ì •í•˜ëŠ” ì¼ì¢…ì˜ ê°­ ë½(gap lock) ì´ ì ê¸ˆì€ ê°™ì€ ì¸ë±ìŠ¤ ê°­ì— ì‚½ì…í•˜ë ¤ëŠ” ì˜ë„ë¥¼ í‘œì‹œí•˜ë©°, ì„œë¡œ ë‹¤ë¥¸ ìœ„ì¹˜ì— ì‚½ì…í•˜ëŠ” ê²½ìš°ì—ëŠ” íŠ¸ëœì­ì…˜ë¼ë¦¬ ì„œë¡œ ëŒ€ê¸°í•˜ì§€ ì•Šë„ë¡ í•´ì¤€ë‹¤.ì˜ˆì‹œ1-- ë°ì´í„° ì„¸íŒ…mysql&gt; CREATE TABLE child (id int(11) NOT NULL, PRIMARY KEY(id)) ENGINE=InnoDB;mysql&gt; INSERT INTO child (id) values (90),(102);-- íŠ¸ëœì­ì…˜ ASTART TRANSACTION;INSERT INTO child (id) VALUES (101); -- (90, 102) ê°­ì— Insert Intention Lockì´ ê±¸ë¦¼-- íŠ¸ëœì­ì…˜ BSTART TRANSACTION;INSERT INTO child (id) VALUES (95); íŠ¸ëœì­ì…˜ Bì—ì„œ ë™ì¼í•˜ê²Œ (90, 102) ê°­ì— Insert Intention Lockì„ ì¡ì§€ë§Œ Insert Intention Lockë¼ë¦¬ëŠ” í˜¸í™˜ë˜ë¯€ë¡œ ëŒ€ê¸°ì—†ì´ ë°”ë¡œ Insert ê°€ëŠ¥ì˜ˆì‹œ2-- ë°ì´í„° ì„¸íŒ…mysql&gt; CREATE TABLE child (id int(11) NOT NULL, PRIMARY KEY(id)) ENGINE=InnoDB;mysql&gt; INSERT INTO child (id) values (90),(102);-- íŠ¸ëœì­ì…˜ Amysql&gt; CREATE TABLE child (id int(11) NOT NULL, PRIMARY KEY(id)) ENGINE=InnoDB;mysql&gt; INSERT INTO child (id) values (90),(102);mysql&gt; START TRANSACTION;mysql&gt; SELECT * FROM child WHERE id &gt; 100 FOR UPDATE; -- 102 ë ˆì½”ë“œì— ë°°íƒ€ ì ê¸ˆ + ê·¸ ì• ê°­ì— ê°­ ë½ ë°œìƒ+-----+| id |+-----+| 102 |+-----+-- íŠ¸ëœì­ì…˜ Bmysql&gt; START TRANSACTION;mysql&gt; INSERT INTO child (id) VALUES (101); íŠ¸ëœì­ì…˜ Bì—ì„œ 101ì„ ì‚½ì…í•˜ë ¤ê³  í•˜ì§€ë§Œ, Aì˜ FOR UPDATEê°€ id &gt; 100 ë²”ìœ„ì˜ ê°­ì„ ì´ë¯¸ ì ê°€ë²„ë ¸ê¸° ë•Œë¬¸ì—, BëŠ” insert intention lockì„ ê±¸ê³  ê¸°ë‹¤ë¦¬ê²Œ ë¨. (ì¦‰, ê°­ ë½ê³¼ëŠ” í˜¸í™˜ë˜ì§€ ì•ŠìŒ)í™•ì¸í•´ë³´ê¸° ë°ì´í„° ì„¸íŒ…CREATE TABLE students ( id INT AUTO_INCREMENT PRIMARY KEY, class_no INT NOT NULL, name VARCHAR(100) NOT NULL, age INT, INDEX idx_class_no_name (class_no, name));INSERT INTO students (class_no, name, age) VALUES(1, 'Alice', 14),(1, 'Bob', 15),(2, 'Charlie', 13),(2, 'Alice', 14),(3, 'David', 16),(1, 'Eve', 14),(2, 'Frank', 15),(3, 'Grace', 13),(1, 'Bob', 15),(3, 'Heidi', 14);SELECT * FROM studentsORDER BY class_no; id class_no name age 1 1 Alice 14 2 1 Bob 15 6 1 Eve 14 9 1 Bob 15 3 2 Charlie 13 4 2 Alice 14 7 2 Frank 15 5 3 David 16 8 3 Grace 13 10 3 Heidi 14 â€» ì°¸ê³  ì¿¼ë¦¬ ìˆ˜í–‰í›„ ë½ ê´€ë ¨ ì •ë³´ëŠ” ë‹¤ìŒ ì¿¼ë¦¬ë¡œ í™•ì¸SELECT object_name, index_name, lock_type, lock_mode, lock_dataFROM performance_schema.data_locks;performance_schema.data_locksì—ì„œì˜ lock_mode í•´ì„ X ë³´í†µ Next-Key Lockì„ ì˜ë¯¸ í•˜ì§€ë§Œ, ì´ ì •ë³´ë§Œìœ¼ë¡œëŠ” ì •í™•í•˜ê²Œ Record-only Lockì¸ì§€ Next-Key Lockì¸ì§€ êµ¬ë¶„ì´ ì•ˆ ë  ìˆ˜ë„ ìˆìŒ X_REC_NOT_GAP ëª…í™•í•˜ê²Œ Record-only Lockì„ ì˜ë¯¸ ì¦‰, í•´ë‹¹ ë ˆì½”ë“œë§Œ ì ê·¸ê³  GAPì€ ì ê·¸ì§€ ì•ŠìŒ ëŒ€í‘œì ìœ¼ë¡œ Unique Indexë¡œ ì •í™•í•˜ê²Œ ì¼ì¹˜í•˜ëŠ” ê°’ì„ ì¡°íšŒí•  ë•Œ ë°œìƒ X,GAP Gap Lockë§Œ ë°œìƒí•œ ê²½ìš°ë¡œ, ë³´í†µ ë²”ìœ„ ì¡°ê±´ì´ë‚˜ ë²”ìœ„ ì™¸ ë ˆì½”ë“œê°€ ì—†ì„ ë•Œ ë°œìƒ TEST1SELECT * FROM studentsWHERE class_no = 1FOR UPDATE; object_name index_name lock_type lock_mode lock_data students (NULL) TABLE IX (NULL) students idx_class_no_name RECORD X,GAP 2, â€˜Aliceâ€™, 4 students idx_class_no_name RECORD X 1, â€˜Aliceâ€™, 1 students idx_class_no_name RECORD X 1, â€˜Bobâ€™, 2 students idx_class_no_name RECORD X 1, â€˜Eveâ€™, 6 students idx_class_no_name RECORD X 1, â€˜Bobâ€™, 9 students PRIMARY RECORD X_REC_NOT_GAP 1 students PRIMARY RECORD X_REC_NOT_GAP 2 students PRIMARY RECORD X_REC_NOT_GAP 6 students PRIMARY RECORD X_REC_NOT_GAP 9 TEST2SELECT * FROM studentsWHERE class_no = 1AND age &lt; 15FOR UPDATE; object_name index_name lock_type lock_mode lock_data students (NULL) TABLE IX (NULL) students idx_class_no_name RECORD X,GAP 2, â€˜Aliceâ€™, 4 students idx_class_no_name RECORD X 1, â€˜Aliceâ€™, 1 students idx_class_no_name RECORD X 1, â€˜Bobâ€™, 2 students idx_class_no_name RECORD X 1, â€˜Eveâ€™, 6 students idx_class_no_name RECORD X 1, â€˜Bobâ€™, 9 students PRIMARY RECORD X_REC_NOT_GAP 1 students PRIMARY RECORD X_REC_NOT_GAP 2 students PRIMARY RECORD X_REC_NOT_GAP 6 students PRIMARY RECORD X_REC_NOT_GAP 9 age &lt; 15ì¸ ì¡°ê±´ì— í¬í•¨ë˜ëŠ” ë ˆì½”ë“œëŠ” 2ê°œì§€ë§Œ, age = 15ì¸ ë ˆì½”ë“œë„ ìŠ¤ìº” ëŒ€ìƒì— ë“¤ì–´ê°€ì„œ ë¶ˆí•„ìš”í•˜ê²Œ ë½ì´ ì¡íˆê²Œëœë‹¤.TEST3SELECT * FROM studentsWHERE class_no = 1LIMIT 2FOR UPDATE; object_name index_name lock_type lock_mode lock_data students (NULL) TABLE IX (NULL) students idx_class_no_name RECORD X 1, â€˜Aliceâ€™, 1 students idx_class_no_name RECORD X 1, â€˜Bobâ€™, 2 students PRIMARY RECORD X_REC_NOT_GAP 1 students PRIMARY RECORD X_REC_NOT_GAP 2 ì²˜ìŒë¶€í„° 2ê°œë§Œ ìŠ¤ìº”í•˜ê¸° ë•Œë¬¸ì—, ì •ë ¬ëœ ìˆœì„œëŒ€ë¡œ 2ê°œë§Œ ë½ì´ ê±¸ë¦¼SELECT * FROM studentsWHERE class_no = 1LIMIT 2, 2FOR UPDATE; object_name index_name lock_type lock_mode lock_data students (NULL) TABLE IX (NULL) students idx_class_no_name RECORD X 1, â€˜Aliceâ€™, 1 students idx_class_no_name RECORD X 1, â€˜Bobâ€™, 2 students idx_class_no_name RECORD X 1, â€˜Eveâ€™, 6 students idx_class_no_name RECORD X 1, â€˜Bobâ€™, 9 students PRIMARY RECORD X_REC_NOT_GAP 1 students PRIMARY RECORD X_REC_NOT_GAP 2 students PRIMARY RECORD X_REC_NOT_GAP 6 students PRIMARY RECORD X_REC_NOT_GAP 9 LIMITìœ¼ë¡œ 2ê°œë§Œ ë¦¬í„´í•˜ì§€ë§Œ 2ë¶€í„°ì´ë¯€ë¡œ, ê²°êµ­ 4ê°œ ìŠ¤ìº”í•˜ëŠ”ê±°ë¼ 4ê°œ ëª¨ë‘ ë½ ê±¸ë¦¼TEST4SELECT * FROM studentsWHERE id &lt; 5FOR UPDATE; object_name index_name lock_type lock_mode lock_data students (NULL) TABLE IX (NULL) students PRIMARY RECORD X,GAP 5 students PRIMARY RECORD X 1 students PRIMARY RECORD X 2 students PRIMARY RECORD X 3 students PRIMARY RECORD X 4 4,5 ì‚¬ì´ì— ì•„ë¬´ê²ƒë„ ë“¤ì–´ê°ˆ ìˆ˜ ì—†ëŠ”ë° ì™œ ê°­ë½ì´ ê±¸ë¦´ê¹Œ ? ì‚¬ìš©ìê°€ ì–´ë–¤ ì œì•½ ì¡°ê±´ì„ ê°–ê³  ìˆë“  ê°„ì—, InnoDBëŠ” B+Tree ì¸ë±ìŠ¤ êµ¬ì¡°ë§Œ ë³´ê³  ë²”ìœ„ë¥¼ íŒë‹¨í•˜ê³  ì ê¸ˆì„ ê±´ë‹¤. ì¦‰, idê°€ AUTO_INCREMENTë“ , PRIMARY KEYë“ , ì¤‘ê°„ ì‚½ì…ì´ ë¶ˆê°€ëŠ¥í•˜ë“  ê·¸ê±´ InnoDB ì…ì¥ì—ì„œ ì•Œ ìˆ˜ ì—†ëŠ” ì •ë³´ ë²”ìœ„ ê±¸ë¦¬ëŠ” ì ê¸ˆ ì¢…ë¥˜ (-âˆ, 1) GAP only [1] X (Next-Key Lock) (1, 2) GAP í¬í•¨ â†’ [2]ë„ ë§ˆì°¬ê°€ì§€ [2] X (Next-Key Lock) â€¦ â€¦ [4] X (Next-Key Lock) (4, 5) â†’ id=5ì— X,GAP TEST5 ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ email ì¶”ê°€ Tx1 INSERT STUDENTS (class_no, email, name, age, flag) VALUES (5, 'email@test.com', 'lee', 10, 'N'); object_name index_name lock_type lock_mode lock_data students (NULL) TABLE IX (NULL) Tx2 INSERT STUDENTS (class_no, email, name, age, flag) VALUES (5, 'email@test.com', 'kim', 10, 'N'); object_name index_name lock_type lock_mode lock_data students (NULL) TABLE IX (NULL) students (NULL) TABLE IX (NULL) students idx_email RECORD X,REC_NOT_GAP â€˜email@test.comâ€™, 17 students idx_email RECORD S â€˜email@test.comâ€™, 17 Tx2ë„ ë™ì¼í•œ ì´ë©”ì¼ë¡œ INSERTë¥¼ ì‹œë„í•¨. MySQLì€ UNIQUE ì œì•½ ìœ„ë°˜ ê°€ëŠ¥ì„±ì´ ìˆìœ¼ë¯€ë¡œ ë‹¤ìŒì„ ìˆ˜í–‰: UNIQUE ì¸ë±ìŠ¤ë¥¼ ì¡°íšŒí•˜ì—¬ email@test.comì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ ì´ ê³¼ì •ì—ì„œ ì¸ë±ìŠ¤ í‚¤ email@test.com'ì—ëŒ€í•´ S Lock (ê³µìœ  ì ê¸ˆ)ì„ ê±¸ì–´ ì¡´ì¬ ìœ ë¬´ë¥¼ í™•ì¸ í•˜ì§€ë§Œ, Tx1ì´ ì´ë¯¸ ì¸ë±ìŠ¤ ë ˆì½”ë“œ ë½ (X, REC_NOT_GAP)ì„ ì¡ê³  ìˆì–´ì„œ, Tx2ëŠ” ëŒ€ê¸°(blocking) ìƒíƒœ ì°¸ê³  ìë£Œ https://dev.mysql.com/doc/refman/8.4/en/innodb-locking.html" }, { "title": "MySQL - ReadView ë“¤ì—¬ë‹¤ë³´ê¸°", "url": "/posts/mysql-readview/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ë“¤ì—¬ë‹¤ë³´ê¸°", "tags": "MySQL", "date": "2025-06-30 22:00:00 +0900", "snippet": " MySQL InnoDBì—ì„œ íŠ¸ëœì­ì…˜ ê²©ë¦¬ìˆ˜ì¤€ì´ READ COMMITTEDì´ë©´ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì»¤ë°‹ ì™„ë£Œí•œê±¸ ì½ì„ ìˆ˜ ìˆê³ , REPEATABLE READì´ë©´ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì»¤ë°‹ì„ ì™„ë£Œí–ˆë”ë¼ë„ í•´ë‹¹ ë°ì´í„°ë¥¼ ë¬´ì¡°ê±´ ì½ì„ ìˆ˜ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. ì´ê²Œ ì–´ë–»ê²Œ ê°€ëŠ¥í•œê±¸ê¹Œ ? ê²°ë¡ ë¶€í„° ë§í•˜ë©´, MVCC ë§¤ì»¤ë‹ˆì¦˜ì€ í˜„ì¬ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì–´ë–¤ ë ˆì½”ë“œ(...", "content": " MySQL InnoDBì—ì„œ íŠ¸ëœì­ì…˜ ê²©ë¦¬ìˆ˜ì¤€ì´ READ COMMITTEDì´ë©´ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì»¤ë°‹ ì™„ë£Œí•œê±¸ ì½ì„ ìˆ˜ ìˆê³ , REPEATABLE READì´ë©´ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì»¤ë°‹ì„ ì™„ë£Œí–ˆë”ë¼ë„ í•´ë‹¹ ë°ì´í„°ë¥¼ ë¬´ì¡°ê±´ ì½ì„ ìˆ˜ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. ì´ê²Œ ì–´ë–»ê²Œ ê°€ëŠ¥í•œê±¸ê¹Œ ? ê²°ë¡ ë¶€í„° ë§í•˜ë©´, MVCC ë§¤ì»¤ë‹ˆì¦˜ì€ í˜„ì¬ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì–´ë–¤ ë ˆì½”ë“œ(row)ë¥¼ ë³¼ ìˆ˜ ìˆëŠ”ì§€(ê°€ì‹œì„±)ë¥¼ íŒë‹¨í•˜ê¸° ìœ„í•´ ReadView ê°ì²´ë¥¼ í™œìš©í•œë‹¤. READ COMMITTED : ë§¤ SELECT ì§ˆì˜ë§ˆë‹¤ ReadView ìƒì„± REPEATABLE READ : ìµœì´ˆ SELECT ì§ˆì˜ì—ì„œë§Œ ReadView ìƒì„± REPEATABLE READ ì˜ˆì‹œ-- íŠ¸ëœì­ì…˜ ABEGIN;UPDATE users SET ... WHERE id = 1; -- ì•„ì§ SELECT ì—†ìŒ â†’ ReadView ìƒì„± ì•ˆ ë¨-- ì´ ì‚¬ì´ì— íŠ¸ëœì­ì…˜ Bê°€ COMMITSELECT * FROM users WHERE age &gt; 30; -- ì´ì œ ReadView ìƒì„± â†’ Bì˜ ê²°ê³¼ ë³´ì¼ ìˆ˜ ìˆìŒSELECT * FROM users WHERE age &gt; 30; -- ìœ„ì™€ ë™ì¼í•œ ReadView ì‚¬ìš©COMMIT;ë“¤ì–´ê°€ê¸°ì „ InnoDBì˜ ê° ë ˆì½”ë“œëŠ” db_trx_idì™€ db_roll_pointerë¼ëŠ” ë‘ ê°œì˜ ìˆ¨ê²¨ì§„ ì»¬ëŸ¼ì„ ê°€ì§€ê³  ìˆë‹¤. ê·¸ë¦¬ê³  í…Œì´ë¸”ì— í”„ë¼ì´ë¨¸ë¦¬ í‚¤ë‚˜ NULLì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ” ìœ ë‹ˆí¬ í‚¤ê°€ ì—†ë‹¤ë©´, ìë™ ì¦ê°€í•˜ëŠ” ìˆ¨ê²¨ì§„ ì»¬ëŸ¼ì¸ db_row_idë¥¼ ìƒì„±í•œë‹¤.db_trx_id ì´ ë ˆì½”ë“œë¥¼ ìµœì¢…ì ìœ¼ë¡œ ìˆ˜ì •í•œ íŠ¸ëœì­ì…˜ì˜ IDdb_roll_pointer ì´ ë ˆì½”ë“œì˜ ì´ì „ ë²„ì „(undo ë¡œê·¸) ìœ„ì¹˜ë¥¼ ê°€ë¦¬í‚¤ëŠ” í¬ì¸í„°db_row_id ê¸°ë³¸ í‚¤(PK)ë‚˜ NOT NULL ìœ ë‹ˆí¬ í‚¤ê°€ ì—†ì„ ê²½ìš°, ë‚´ë¶€ì ìœ¼ë¡œ ë ˆì½”ë“œë¥¼ ìœ ì¼í•˜ê²Œ ì‹ë³„í•˜ê¸° ìœ„í•œ ID ì¶œì²˜ : https://xialeistudio.medium.com/understanding-mvcc-in-mysql-innodb-116100a27b65 ReadView ì‚´í´ë³´ê¸° ReadView í´ë˜ìŠ¤ ë¬¸ì„œ ì°¸ê³ í•œ ì†ŒìŠ¤ì½”ë“œ mysql-server/storage/innobase/include/read0types.h mysql-server/storage/innobase/read/read0read.cc ë©¤ë²„ ë³€ìˆ˜ ë° ì´ˆê¸°í™”// mysql-server/storage/innobase/include/read0types.h private: trx_id_t m_low_limit_id; trx_id_t m_up_limit_id; trx_id_t m_creator_trx_id; ids_t m_ids; trx_id_t m_low_limit_no;// mysql-server/storage/innobase/read/read0read.ccvoid ReadView::prepare(trx_id_t id) { ut_ad(trx_sys_mutex_own()); m_creator_trx_id = id; m_low_limit_no = trx_get_serialisation_min_trx_no(); m_low_limit_id = trx_sys_get_next_trx_id_or_no(); ut_a(m_low_limit_no &lt;= m_low_limit_id); if (!trx_sys-&gt;rw_trx_ids.empty()) { copy_trx_ids(trx_sys-&gt;rw_trx_ids); } else { m_ids.clear(); } /* The first active transaction has the smallest id. */ m_up_limit_id = !m_ids.empty() ? m_ids.front() : m_low_limit_id; ut_a(m_up_limit_id &lt;= m_low_limit_id); ut_d(m_view_low_limit_no = m_low_limit_no); m_closed = false;} ë©¤ë²„ ë³€ìˆ˜ ì„¤ëª… ids_t m_ids ìŠ¤ëƒ…ìƒ·(ReadView)ì´ ë§Œë“¤ì–´ì§ˆë•Œ í™œì„±í™” ë˜ì–´ìˆë˜(ì»¤ë°‹ë˜ì§€ ì•Šì€) Read-Write íŠ¸ëœì­ì…˜ì˜ id ëª©ë¡. ì¦‰, ì´ ReadViewê°€ ë³¼ ìˆ˜ ì—†ì–´ì•¼ í•˜ëŠ” íŠ¸ëœì­ì…˜ ID ëª©ë¡. trx_id_t m_low_limit_id Read View ìƒì„± ì‹œì ì— ì•„ì§ ì‹œì‘ë˜ì§€ ì•Šì€ íŠ¸ëœì­ì…˜ì˜ ID (ì¦‰, ë‹¤ìŒìœ¼ë¡œ ë¶€ì—¬ë  trx_id). ë”°ë¼ì„œ, ì´ ê°’ ì´ìƒì˜ trx_idë¥¼ ê°€ì§„ ë ˆì½”ë“œëŠ” ë³´ì´ì§€ ì•ŠìŒ trx_id_t m_up_limit_id Read View ìƒì„± ì‹œì ì— í™œì„± ìƒíƒœì˜€ë˜ íŠ¸ëœì­ì…˜ë“¤ ì¤‘ ê°€ì¥ ì‘ì€ trx_id. ë”°ë¼ì„œ, ì´ ê°’ ë¯¸ë§Œì˜ trx_idë¥¼ ê°€ì§„ ë ˆì½”ë“œëŠ” ë³´ì„. â€» m_idsê°€ ë¹„ì–´ìˆìœ¼ë©´, m_low_limit_id ê°’ê³¼ ê°™ìŒ trx_id_t m_creator_trx_id ì´ ReadViewë¥¼ ë§Œë“  íŠ¸ëœì­ì…˜ì˜ ID. trx_id_t m_low_limit_no ì´ ê°’ë³´ë‹¤ ì‘ì€ íŠ¸ëœì­ì…˜ idëŠ” Undo ë¡œê·¸ë¥¼ ë³¼ í•„ìš”ê°€ ì—†ìŒ. ë”°ë¼ì„œ, Undo ë¡œê·¸ì—ì„œ ì‚­ì œí•´ë„ ë˜ëŠ” ìµœì†Œ íŠ¸ëœì­ì…˜ ë²ˆí˜¸ ê¸°ì¤€ (purge íŒë‹¨ ì‹œ ì‚¬ìš©). ì¦‰, í˜„ì¬ ì—´ë ¤ ìˆëŠ” ëª¨ë“  ReadView ì¤‘ ê°€ì¥ ì˜¤ë˜ëœ ê²ƒì˜ m_low_limit_no ë¥¼ ê¸°ì¤€ìœ¼ë¡œ, ê·¸ë³´ë‹¤ ì‘ì€ íŠ¸ëœì­ì…˜ì˜ undo ë¡œê·¸ëŠ” ëª¨ë‘ ì •ë¦¬ ê°€ëŠ¥ ê°€ì‹œì„± ì—¬ë¶€ íŒë‹¨// mysql-server/storage/innobase/include/read0types.h/** Check whether the changes by id are visible.@param[in] id transaction id to check against the view@param[in] name table name@return whether the view sees the modifications of id. */[[nodiscard]] bool changes_visible(trx_id_t id, const table_name_t &amp;name) const { ut_ad(id &gt; 0); if (id &lt; m_up_limit_id || id == m_creator_trx_id) { return (true); } check_trx_id_sanity(id, name); if (id &gt;= m_low_limit_id) { return (false); } else if (m_ids.empty()) { return (true); } const ids_t::value_type *p = m_ids.data(); return (!std::binary_search(p, p + m_ids.size(), id));}/**@param id transaction to check@return true if view sees transaction id */bool sees(trx_id_t id) const { return (id &lt; m_up_limit_id); }ë ˆì½”ë“œì˜ trx_idê°€ m_idsì— í¬í•¨ëœ(ì¦‰, ì•„ì§ í™œì„±í™”ëœ) íŠ¸ëœì­ì…˜ì´ë©´ ê°€ì‹œì„±ì€ falseì—¬ì•¼ í• í…ë°, ì´ ë¶€ë¶„ì€ ì–´ë”¨ì„ê¹Œ ? return (!std::binary_search(...)) ì´ ë¼ì¸ì´ m_idsì— í¬í•¨ë˜ë©´ false, í¬í•¨ë˜ì§€ ì•Šìœ¼ë©´ trueë¥¼ ë¦¬í„´í•˜ëŠ” ë¡œì§ std::binary_search(...)ëŠ” trueë¥¼ ë¦¬í„´ (trx_idê°€ m_idsì— í¬í•¨ë˜ì–´ ìˆìŒ) ì¦‰, !std::binary_search(...)ì´ë©´ í¬í•¨ë˜ì–´ ìˆì§€ ì•Šë‹¤ëŠ” ëœ» = ê°€ì‹œì„± ìˆìŒ ì°¸ê³  ìë£Œ https://dev.mysql.com/doc/dev/mysql-server/8.4.4/classReadView.html#ac5d400b93acde22a935a34a672641e3c https://xialeistudio.medium.com/understanding-mvcc-in-mysql-innodb-116100a27b65" }, { "title": "MySQL - CHAR vs VARCHAR", "url": "/posts/mysql-char-vs-varchar/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "MySQL", "date": "2025-05-29 23:00:00 +0900", "snippet": "CHAR vs VARCHAR ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ì¡°íšŒí•˜ëŠ” ë°©ì‹ì—ì„œ ì°¨ì´ê°€ ìˆìŒ ë˜í•œ, ìµœëŒ€ ê¸¸ì´ì™€ í›„í–‰ ê³µë°±(trailing spaces) ìœ ì§€ ì—¬ë¶€ì—ì„œë„ ì°¨ì´ê°€ ìˆìŒ ì—„ê²©í•œ(Strict) SQL ëª¨ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°, CHAR ë˜ëŠ” VARCHAR ì—´ì— í•´ë‹¹ ì—´ì˜ ìµœëŒ€ ê¸¸ì´ë¥¼ ì´ˆê³¼í•˜ëŠ” ê°’ì„ í• ë‹¹í•˜ë©´, ê·¸ ê°’ì€ ì—´ì˜ í¬ê¸°ì— ë§ê²Œ ì˜ë¦¬ê³ (...", "content": "CHAR vs VARCHAR ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  ì¡°íšŒí•˜ëŠ” ë°©ì‹ì—ì„œ ì°¨ì´ê°€ ìˆìŒ ë˜í•œ, ìµœëŒ€ ê¸¸ì´ì™€ í›„í–‰ ê³µë°±(trailing spaces) ìœ ì§€ ì—¬ë¶€ì—ì„œë„ ì°¨ì´ê°€ ìˆìŒ ì—„ê²©í•œ(Strict) SQL ëª¨ë“œê°€ í™œì„±í™”ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°, CHAR ë˜ëŠ” VARCHAR ì—´ì— í•´ë‹¹ ì—´ì˜ ìµœëŒ€ ê¸¸ì´ë¥¼ ì´ˆê³¼í•˜ëŠ” ê°’ì„ í• ë‹¹í•˜ë©´, ê·¸ ê°’ì€ ì—´ì˜ í¬ê¸°ì— ë§ê²Œ ì˜ë¦¬ê³ (truncated) ê²½ê³ ê°€ ë°œìƒ ê³µë°±ì´ ì•„ë‹Œ ë¬¸ìê°€ ì˜ë¦´ ê²½ìš°ì—ëŠ”, Strict SQL ëª¨ë“œë¥¼ ì‚¬ìš©í•˜ë©´ ê²½ê³  ëŒ€ì‹  ì˜¤ë¥˜ë¥¼ ë°œìƒì‹œí‚¤ê³  í•´ë‹¹ ê°’ì„ ì‚½ì…í•˜ì§€ ì•Šë„ë¡ í•  ìˆ˜ ìˆìŒCHAR CHAR(n) ì‹¤ì œ ë°ì´í„° ê¸¸ì´ì— ìƒê´€ì—†ì´ ì €ì¥ë˜ëŠ” ë°ì´í„° ê¸¸ì´ê°€ nìœ¼ë¡œ ê³ ì • nì€ 0 ~ 255ê¹Œì§€ ê°€ëŠ¥ ë¬¸ìì…‹ ë¬¸ìë‹¹ ë°”ì´íŠ¸ ìˆ˜ CHAR(255)ì˜ ìµœëŒ€ ë°”ì´íŠ¸ latin1 1 byte 255 bytes utf8 (3ë°”ì´íŠ¸) ìµœëŒ€ 3 bytes ìµœëŒ€ 765 bytes utf8mb4 (4ë°”ì´íŠ¸) ìµœëŒ€ 4 bytes ìµœëŒ€ 1020 bytes ì €ì¥ë ë•Œ në³´ë‹¤ ì‘ìœ¼ë©´ ë‚˜ë¨¸ì§€ ë¶€ë¶„ì€ ê³µë°±ìœ¼ë¡œ right-paddedë¨ ê°’ì´ ì¡°íšŒë ë•Œ PAD_CHAR_TO_FULL_LENGTHê°€ í™œì„±í™”ë˜ì–´ ìˆì§€ ì•ŠëŠ”ì´ìƒ (ê¸°ë³¸ì€ ë¹„í™œì„±í™”), right-paddedëœ ê³µë°±ì€ ì œê±°ë¼ì„œ ì¡°íšŒëœë‹¤. PAD_CHAR_TO_FULL_LENGTH ì†ì„±ì€ deprecatedë¨ ì´ˆê³¼ëœ í›„í–‰ ê³µë°±ì€ SQL ëª¨ë“œì™€ ê´€ê³„ì—†ì´ ì¡°ìš©íˆ(silently) ì˜ë¦°ë‹¤.VARCHAR ê°€ë³€ê¸¸ì´ ë°ì´í„° ê¸¸ì´ëŠ” 0 ~ 65,535ê¹Œì§€ ê°€ëŠ¥ VARCHARì˜ ì‹¤ì§ˆì ì¸ ìµœëŒ€ ê¸¸ì´ëŠ” ì „ì²´ í–‰(Row)ì˜ ìµœëŒ€ í¬ê¸°ì¸ 65,535ë°”ì´íŠ¸ì™€, ì‚¬ìš©í•˜ëŠ” ë¬¸ìì…‹ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤. ë¬¸ìì…‹ ë¬¸ìë‹¹ ë°”ì´íŠ¸ ì‹¤ì§ˆ ìµœëŒ€ VARCHAR ê¸¸ì´ (ë‹¨ì¼ ì»¬ëŸ¼ ê¸°ì¤€) latin1 1 byte ì•½ 65,532ì utf8 ìµœëŒ€ 3 bytes ì•½ 21,844ì utf8mb4 ìµœëŒ€ 4 bytes ì•½ 16,383ì CHARì™€ ë‹¤ë¥´ê²Œ ì €ì¥ë˜ëŠ” ê°’ì˜ ë°”ì´íŠ¸ë¥¼ ì•Œë ¤ì£¼ëŠ” 1ë°”ì´íŠ¸ ë˜ëŠ” 2ë°”ì´íŠ¸ì˜ prefix ë°ì´í„°ê°€ ë”°ë¼ ë¶™ëŠ”ë‹¤. ì €ì¥ë˜ëŠ” í˜•íƒœ : [ê¸¸ì´ prefix] + [ì‹¤ì œ ë¬¸ìì—´] ê¸¸ì´ prefix 1ë°”ì´íŠ¸ : ì €ì¥ë˜ëŠ” ê°’ì´ 255ë°”ì´íŠ¸ ì´í•˜ 2ë°”ì´íŠ¸ : ì €ì¥ë˜ëŠ” ê°’ì´ 255ë°”ì´íŠ¸ ì´ˆê³¼ ì €ì¥ë˜ëŠ” ë°ì´í„°ì˜ ê¸¸ì´ê°€ char(n)ì˜ në³´ë‹¤ ì‘ì•„ë„ ê³µë°±ì´ right-paddedë˜ì§€ ì•ŠëŠ”ë‹¤. ì—´ ê¸¸ì´ë¥¼ ì´ˆê³¼í•˜ëŠ” í›„í–‰ ê³µë°±ì€ ì‚½ì… ì „ì— ì˜ë¦¬ë©°, ì´ë•Œ SQL ëª¨ë“œì™€ ìƒê´€ì—†ì´ ê²½ê³ ê°€ ë°œìƒ í›„í–‰ ê³µë°±ì€ ê·¸ëŒ€ë¡œ ì €ì¥ ë° ì¡°íšŒëœë‹¤. ë”°ë¼ì„œ, abcë’¤ì— ê³µë°±ì´ ë¶™ì€ ìƒíƒœë¡œ VARCHAR ì»¬ëŸ¼ì— ì €ì¥ë˜ë©´ SELECT * FROM test WHERE col_varchar = 'abc'; ì¿¼ë¦¬ëŠ” col_varcharì— ì €ì¥ëœ ê°’ì´ â€˜abc â€˜ì´ë¯€ë¡œ ë§¤ì¹­ë˜ì§€ ì•ŠìŒ. CHARëŠ” ì¡°íšŒì‹œ í›„í–‰ ê³µë°±ì´ ì œê±°ë˜ë¯€ë¡œ ì¡°íšŒë¨â€» ì°¸ê³  : CHAR(n) ë˜ëŠ” VARCHAR(n)ì—ì„œ nì´ 0ì¸ ê²½ìš° ? ë¹„ì–´ ìˆëŠ” ë¬¸ìì—´ë§Œ í—ˆìš©ë˜ëŠ” ì»¬ëŸ¼ GPTì—ê²Œ ì–¸ì œ í•„ìš”í•  ê²ƒ ê°™ì€ì§€ ë¬¼ì–´ë³´ì•˜ë‹¤.-- ì§€ê¸ˆì€ typeì´ ì˜ë¯¸ ì—†ì§€ë§Œ,-- ë‚˜ì¤‘ì— typeì´ 'coupon', 'event', 'system' ë“±ì˜ ì˜ë¯¸ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŒCREATE TABLE event_flags ( user_id INT, type VARCHAR(16), -- ì§€ê¸ˆì€ VARCHAR(0)ì´ì§€ë§Œ í™•ì¥ ê°€ëŠ¥ UNIQUE (user_id, type)); ì²˜ìŒì—ëŠ” typeì´ í•­ìƒ ê³µë°±ì´ì§€ë§Œ, ë¯¸ë˜ì—ëŠ” ë‹¤ì–‘í•œ typeì„ ë„£ê³ , í•œ user_idì— ì—¬ëŸ¬ rowë¥¼ í—ˆìš©í•  ìˆ˜ ìˆê²Œ í™•ì¥ ê°€ëŠ¥ ì´ëŸ´ ê²½ìš° ê¸°ì¡´ ì¸ë±ìŠ¤/ì œì•½ ì¡°ê±´ êµ¬ì¡°ë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ ë„ í™•ì¥ ê°€ëŠ¥ê¸°íƒ€ InnoDBëŠ” 768ë°”ì´íŠ¸ ì´ìƒì¸ ê³ ì • ê¸¸ì´ í•„ë“œë¥¼ ë‚´ë¶€ì ìœ¼ë¡œ ê°€ë³€ ê¸¸ì´ í•„ë“œë¡œ ì¸ì½”ë”©í•˜ì—¬ ë°ì´í„° í˜ì´ì§€ ì™¸ë¶€(off-page)ì— ì €ì¥ ì˜ˆë¥¼ ë“¤ì–´ CHAR(255) ì»¬ëŸ¼ì€ utf8mb4 ê°™ì´ í•œ ê¸€ìê°€ ìµœëŒ€ 4ë°”ì´íŠ¸ì¸ ë¬¸ìì…‹ì„ ì‚¬ìš©í•˜ë©´, ì „ì²´ ê¸¸ì´ê°€ 1020ë°”ì´íŠ¸ê¹Œì§€ ë  ìˆ˜ ìˆì–´ 768ë°”ì´íŠ¸ë¥¼ ì´ˆê³¼ CHAR, VARCHAR, TEXT ì»¬ëŸ¼ ê°’ì€ í•´ë‹¹ ì»¬ëŸ¼ì— ì§€ì •ëœ ë¬¸ìì…‹ì˜ collation ê·œì¹™ì— ë”°ë¼ ì •ë ¬ ë° ë¹„êµ MySQLì˜ ëŒ€ë¶€ë¶„ì˜ Collationì€ PAD SPACE ì†ì„±ì„ ê°€ì§ ë‹¨, UCA 9.0.0 ì´ìƒì„ ê¸°ë°˜ìœ¼ë¡œ í•œ Unicode Collationì€ NO PAD ì†ì„±ì„ ê°€ì§ NO PAD ì†ì„±ì—ì„œëŠ” ë¬¸ìì—´ ë’¤ì˜ ê³µë°±ë„ ì˜ë¯¸ ìˆëŠ” ë¬¸ìë¡œ ì·¨ê¸‰ë˜ì–´ ë¹„êµ ì‹œ ì˜í–¥ì„ ë¯¸ì¹¨ PAD SPACE ì†ì„±ì—ì„œëŠ” ë¬¸ìì—´ ë’¤ì˜ ê³µë°±ì€ ë¬´ì‹œë˜ë©°, ë¹„êµ ì‹œ ì—†ëŠ” ê²ƒì²˜ëŸ¼ ì·¨ê¸‰ë¨ ì˜ˆì‹œ : NO PAD vs PAD SPACE-- ë‘ í…Œì´ë¸”ì€ ê°™ì€ êµ¬ì¡°ì§€ë§Œ ë‹¤ë¥¸ collation ì‚¬ìš©CREATE TABLE pad_space_test (val VARCHAR(10) COLLATE utf8mb4_general_ci -- PAD SPACE (ê¸°ë³¸ê°’));CREATE TABLE no_pad_test (val VARCHAR(10) COLLATE utf8mb4_0900_as_cs -- NO PAD);-- ë™ì¼í•œ ë¬¸ìì§€ë§Œ í›„í–‰ ê³µë°±ì´ ë‹¤ë¥¸ ê°’ì„ ì‚½ì…INSERT INTO pad_space_test VALUES ('abc'), ('abc ');INSERT INTO no_pad_test VALUES ('abc'), ('abc ');-- ë¹„êµ ê²°ê³¼SELECT 'PAD SPACE' AS collation, val FROM pad_space_test WHERE val = 'abc';SELECT 'NO PAD' AS collation, val FROM no_pad_test WHERE val = 'abc'; PAD SPACE: â€˜abcâ€™ì™€ â€˜abc â€˜ëŠ” ë™ì¼í•˜ë‹¤ê³  íŒë‹¨, ë”°ë¼ì„œ ë‘˜ ë‹¤ ì¡°íšŒë¨ collation val PAD SPACE abc PAD SPACE abc NO PAD: â€˜abc â€˜ëŠ” ë‹¤ë¥´ë‹¤ê³  íŒë‹¨ë¨, ë”°ë¼ì„œ â€˜abcâ€™ë§Œ ì¡°íšŒë¨ collation val NO PAD abc ì°¸ê³  ìë£Œ https://dev.mysql.com/doc/refman/8.4/en/char.html" }, { "title": "Spring - @Transactional ì‚´í´ë³´ê¸° (1) - AOP Proxy", "url": "/posts/spring-transactional-part1/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Spring", "date": "2025-05-25 00:25:00 +0900", "snippet": "AOP Proxy ìŠ¤í”„ë§ : https://docs.spring.io/spring-framework/reference/core/aop/introduction-proxies.html ìŠ¤í”„ë§ ë¶€íŠ¸ : https://docs.spring.vmware.com/spring-boot/docs/3.0.14/reference/htmlsingle/#features....", "content": "AOP Proxy ìŠ¤í”„ë§ : https://docs.spring.io/spring-framework/reference/core/aop/introduction-proxies.html ìŠ¤í”„ë§ ë¶€íŠ¸ : https://docs.spring.vmware.com/spring-boot/docs/3.0.14/reference/htmlsingle/#features.aop í”„ë ˆì„ì›Œí¬ AOP í”„ë¡ì‹œ ê¸°ë³¸ê°’ ì¡°ê±´ ì„¤ëª… Spring Framework JDK ë™ì  í”„ë¡ì‹œ ê¸°ë³¸ ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ì´ ê¶Œì¥ë˜ë¯€ë¡œ JDK Proxy ì„ í˜¸ Spring Boot CGLIB ê¸°ë³¸ (spring.aop.proxy-target-class=true) ì‹¤ìš©ì„±ê³¼ í˜¸í™˜ì„± ê³ ë ¤í•´ì„œ CGLIBì´ ê¸°ë³¸ê°’ Spring Boot 3.4.4 additional-spring-configuration-metadata.json íŒŒì¼ í™•ì¸í•´ë³´ê¸° additional-spring-configuration-metadata.json : Spring Bootì˜ application.properties / application.yml ìë™ì™„ì„± ê¸°ëŠ¥ì„ ì§€ì›í•˜ê¸° ìœ„í•œ ë©”íƒ€ë°ì´í„° íŒŒì¼ { \"name\": \"spring.aop.proxy-target-class\", \"type\": \"java.lang.Boolean\", \"description\": \"Whether subclass-based (CGLIB) proxies are to be created (true), as opposed to standard Java interface-based proxies (false).\", \"defaultValue\": true}Spring Framework Springì˜ ì² í•™ì€ â€œì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ í”„ë¡œê·¸ë˜ë°â€ì„ ê¶Œì¥ ë”°ë¼ì„œ í”„ë¡ì‹œë„ JDK ë™ì  í”„ë¡ì‹œ (ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜)ì„ ê¸°ë³¸ìœ¼ë¡œ ì„ íƒ í´ë˜ìŠ¤ì— ëŒ€í•´ í”„ë¡ì‹œë¥¼ ë§Œë“¤ë ¤ë©´ proxyTargetClass = true ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•¨Spring Boot â€œí¸ì˜ì„±ê³¼ ì¼ê´€ì„±â€ì„ ì¤‘ìš”ì‹œí•¨ ë§ì€ ê°œë°œìë“¤ì´ ì¸í„°í˜ì´ìŠ¤ ì—†ì´ë„ AOP ì‚¬ìš©ì„ ì›í•¨ íŠ¹íˆ @Transactional, @Async, @Scheduled ê°™ì€ ì–´ë…¸í…Œì´ì…˜ ê¸°ë°˜ ê¸°ëŠ¥ì€ í´ë˜ìŠ¤ì— ë¶™ëŠ” ê²½ìš°ê°€ ë§ìŒ ê·¸ë˜ì„œ Spring BootëŠ” ìë™ ì„¤ì •ìœ¼ë¡œ CGLIBì„ ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í•¨Cglib (Byte Code Generation Library) github repoì— ì íŒ ì„¤ëª…ì„ ë³´ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. Byte Code Generation Library is high level API to generate and transform Java byte code.It is used by AOP, testing, data access frameworks to generate dynamic proxy objects and intercept field access. ë°”ì´íŠ¸ì½”ë“œ ìƒì„± ë¼ì´ë¸ŒëŸ¬ë¦¬(Byte Code Generation Library)ëŠ” Java ë°”ì´íŠ¸ì½”ë“œë¥¼ ìƒì„±í•˜ê³  ë³€í˜•í•˜ê¸° ìœ„í•œ ê³ ìˆ˜ì¤€ APIì…ë‹ˆë‹¤.ì´ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” AOP(ê´€ì  ì§€í–¥ í”„ë¡œê·¸ë˜ë°), í…ŒìŠ¤íŠ¸, ë°ì´í„° ì ‘ê·¼ í”„ë ˆì„ì›Œí¬ ë“±ì—ì„œ ë™ì  í”„ë¡ì‹œ ê°ì²´ë¥¼ ìƒì„±í•˜ê±°ë‚˜ í•„ë“œ ì ‘ê·¼ì„ ê°€ë¡œì±„ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. Â  CGLIB ë¼ì´ë¸ŒëŸ¬ë¦¬ Spring ë‚´ì¥ CGLIB í´ë˜ìŠ¤ ê²½ë¡œ net.sf.cglib.proxy.Enhancer org.springframework.cglib.proxy.Enhancer ì†ŒìŠ¤ cglib GitHub Springì´ ìì²´ì ìœ¼ë¡œ ì¬í¬ì¥ ì™œ Springì€ CGLIBì„ ë‚´ì¥ì‹œì¼°ë‚˜ ? ë¼ì´ë¸ŒëŸ¬ë¦¬ ì¶©ëŒ ë°©ì§€ ì˜ˆì „ì—” ë‹¤ë¥¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë„ cglibì„ ì‚¬ìš©í–ˆëŠ”ë°, ë²„ì „ ì¶©ëŒì´ ìì£¼ ë°œìƒ Springì€ ì´ë¥¼ í”¼í•˜ê¸° ìœ„í•´ íŒ¨í‚¤ì§€ë¥¼ ë³€ê²½í•´ì„œ ìì²´ í¬í•¨ (shading) ê²½ëŸ‰ ì˜ì¡´ì„± êµ¬ì„± Spring Boot ì‚¬ìš© ì‹œ spring-core í•˜ë‚˜ë¡œ ì¶©ë¶„íˆ ë™ì‘ ê°œë°œìê°€ cglibë¥¼ ë³„ë„ë¡œ ì¶”ê°€í•  í•„ìš” ì—†ìŒ ì¼ê´€ì„± ë³´ì¥ Spring AOP, ProxyFactory, @Transactional ë“± ë‚´ë¶€ ë™ì‘ì´ cglibì— í¬ê²Œ ì˜ì¡´ ë²„ì „ ë³€í™”ë‚˜ API ë³€ê²½ì˜ ì˜í–¥ì„ ì¤„ì´ê¸° ìœ„í•´ org.springframework.cglib.*ë¡œ ê³ ì • Cglib AOP Proxy ì‚´í´ë³´ê¸° Controllerì—ì„œ ë³´ë©´ êµ¬í˜„ì²´ê°€ UserService$$SpringCGLIB$$ì¸ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.@Service@RequiredArgsConstructorpublic class UserService { private final UserRepository userRepository; private final UserHistoryRepository userHistoryRepository; public List&lt;User&gt; getAllUsers() { return userRepository.findAll(); } @Transactional public User create(User user) { userRepository.save(user); userHistoryRepository.save(UserHistory.from(user)); return user; }}ì–´ë””ì„œ ìƒì„±í•˜ëŠ”ê±¸ê¹Œ ?// org.springframework.aop.framework.CglibAopProxy#buildProxyprivate Object buildProxy(@Nullable ClassLoader classLoader, boolean classOnly) { if (logger.isTraceEnabled()) { logger.trace(\"Creating CGLIB proxy: \" + String.valueOf(this.advised.getTargetSource())); } try { ... this.validateClassIfNecessary(proxySuperClass, classLoader); Enhancer enhancer = this.createEnhancer(); ... enhancer.setSuperclass(proxySuperClass); enhancer.setInterfaces(AopProxyUtils.completeProxiedInterfaces(this.advised)); enhancer.setNamingPolicy(SpringNamingPolicy.INSTANCE); enhancer.setAttemptLoad(true); enhancer.setStrategy(KotlinDetector.isKotlinType(proxySuperClass) ? new ClassLoaderAwareGeneratorStrategy(classLoader) : new ClassLoaderAwareGeneratorStrategy(classLoader, undeclaredThrowableStrategy)); Callback[] callbacks = this.getCallbacks(rootClass); Class&lt;?&gt;[] types = new Class[callbacks.length]; for(x = 0; x &lt; types.length; ++x) { types[x] = callbacks[x].getClass(); } ProxyCallbackFilter filter = new ProxyCallbackFilter(this.advised.getConfigurationOnlyCopy(), this.fixedInterceptorMap, this.fixedInterceptorOffset); enhancer.setCallbackFilter(filter); enhancer.setCallbackTypes(types); Object var22; try { var22 = classOnly ? this.createProxyClass(enhancer) : this.createProxyClassAndInstance(enhancer, callbacks); } finally { filter.advised.reduceToAdvisorKey(); } return var22; } ...}Enhancer ìœ„ ì½”ë“œì—ì„œ ë³´ë©´, Enhancerê°€ í”„ë¡ì‹œ ìƒì„±ì—ì„œ ì¤‘ìš”í•œ ì—­í• ì„ ì—­í• ì„ í•˜ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì¸ë‹¤.org.springframework.cglib.proxy.Enhancer (CGLIBì˜ í•µì‹¬ í´ë˜ìŠ¤) CGLIBì€ ì¸í„°í˜ì´ìŠ¤ê°€ ì•„ë‹Œ í´ë˜ìŠ¤ ìì²´ë¥¼ ìƒì†í•˜ì—¬ í”„ë¡ì‹œë¥¼ ë§Œë“¤ ë•Œ ì‚¬ìš©ë¨ ì´ë•Œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ë§Œë“œëŠ” ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” ê²ƒì´ Enhancer. ì¦‰, CGLIB í”„ë¡ì‹œëŠ” í•­ìƒ Enhancerë¥¼ í†µí•´ ìƒì„±ë¨ EnhancerëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ASMì„ ì‚¬ìš©í•´ì„œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ìœ„í•œ ë°”ì´íŠ¸ì½”ë“œë¥¼ ìƒì„± ì´ ë°”ì´íŠ¸ì½”ë“œëŠ” JVMì˜ defineClass()ë¥¼ í†µí•´ ë©”ëª¨ë¦¬ì— ë¡œë“œë¨ ê¸°ëŠ¥ ì„¤ëª… setSuperclass(Class) ì–´ë–¤ í´ë˜ìŠ¤ë¥¼ ìƒì†í• ì§€ ì§€ì • (í”„ë¡ì‹œ ëŒ€ìƒ í´ë˜ìŠ¤) setCallbacks(Callback[]) ë©”ì„œë“œ í˜¸ì¶œ ì‹œ ì‹¤í–‰í•  ì¸í„°ì…‰í„° ì„¤ì • setCallbackFilter(CallbackFilter) ì–´ë–¤ ë©”ì„œë“œì— ì–´ë–¤ Callbackì„ ì ìš©í• ì§€ ê²°ì • create() ì‹¤ì œë¡œ í”„ë¡ì‹œ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ì¸ìŠ¤í„´ìŠ¤í™” // org.springframework.cglib.proxy.Enhancerpublic void setCallback(final Callback callback) { this.setCallbacks(new Callback[]{callback});}public void setCallbacks(Callback[] callbacks) { if (callbacks != null &amp;&amp; callbacks.length == 0) { throw new IllegalArgumentException(\"Array cannot be empty\"); } else { this.callbacks = callbacks; }}// org.springframework.cglib.proxy.MethodInterceptorpublic interface MethodInterceptor extends Callback { Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable;}ì˜ˆì œpublic class TempInterceptor implements MethodInterceptor { @Override public Object intercept(Object obj, Method method, Object[] args, MethodProxy proxy) throws Throwable { System.out.println(\"Before method: \" + method.getName()); Object result = proxy.invokeSuper(obj, args); // ì›ë³¸ ë©”ì„œë“œ í˜¸ì¶œ System.out.println(\"After method: \" + method.getName()); return result; }}import org.springframework.cglib.proxy.Enhancer;public class Main { public static void main(String[] args) { Enhancer enhancer = new Enhancer(); enhancer.setSuperclass(TempService.class); // ì›ë³¸ í´ë˜ìŠ¤ ì§€ì • enhancer.setCallback(new TempInterceptor()); // ì¸í„°ì…‰í„° ì§€ì • // í”„ë¡ì‹œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± TempService proxy = (TempService) enhancer.create(); // TempService$$EnhancerByCGLIB$$ // í”„ë¡ì‹œ ë©”ì„œë“œ í˜¸ì¶œ (intercept â†’ invokeSuper â†’ ì›ë³¸ í˜¸ì¶œ) proxy.hello(\"CGLIB\"); }} ê²°ê³¼ Before method: helloHello, CGLIBAfter method: hello final í´ë˜ìŠ¤ëŠ” í”„ë¡ì‹œ ìƒì„± ì•ˆë¨ (ìƒì†ì„ ëª»í•˜ê¸° ë•Œë¬¸ì—) Caused by: org.springframework.aop.framework.AopConfigException: Could not generate CGLIB subclass of class ... : Common causes of this problem include using a final class or a non-visible class @Transactionalë¡œ ì¸í•´ ìƒì„±ëœ í”„ë¡ì‹œ ê°ì²´ì—ëŠ” ì–´ë–¤ Interceptorê°€ ì„¸íŒ…ë ê¹Œ ?DynamicAdvisedInterceptor ì‹¤ì œ í”„ë¡ì‹œ ë©”ì„œë“œ ì‹¤í–‰ ì‹œ AOP adviceë¥¼ ì—°ê²°í•˜ëŠ” í•µì‹¬ ì¸í„°ì…‰í„° DynamicAdvisedInterceptor#intercept()ëŠ” í”„ë¡ì‹œëœ ë©”ì„œë“œê°€ í˜¸ì¶œë  ë•Œ, ì‹¤ì œ ë©”ì„œë“œ í˜¸ì¶œ ì „ ì´ ë©”ì„œë“œê°€ ë¨¼ì € ì‹¤í–‰ë¨ ì‹¤ì œ í˜¸ì¶œíë¦„â€» ì°¸ê³  : AOP ê´€ë ¨ ìš©ì–´ Advice : ì‹¤ì œë¡œ ì‹¤í–‰ë˜ëŠ” ë¶€ê°€ ê¸°ëŠ¥ ë¡œì§ (ì˜ˆ: ë¡œê¹…, íŠ¸ëœì­ì…˜ ì‹œì‘/ì»¤ë°‹, ë³´ì•ˆ ì²´í¬ ë“±) Pointcut : ì–´ë””ì— Adviceë¥¼ ì ìš©í• ì§€ ì§€ì •. (ì˜ˆ: com.example.service..(..)ì— ìˆëŠ” ëª¨ë“  ë©”ì„œë“œ) Advisor : Pointcut + Adviceì˜ ë¬¶ìŒ. ì¦‰, ì‹¤í–‰ ìœ„ì¹˜ + ì‹¤í–‰í•  ë¡œì§ì„ í•¨ê»˜ ë³´ìœ í•˜ëŠ” AOP êµ¬ì„± ë‹¨ìœ„ JoinPoint: ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì¤‘ì— AOPë¡œ ê°€ë¡œì±Œ ìˆ˜ ìˆëŠ” ëª¨ë“  ì§€ì  (Spring AOPì—ì„œëŠ” ì˜¤ì§ ë©”ì„œë“œ ì‹¤í–‰ë§Œ í•´ë‹¹)TransactionInterceptor, TransactionAspectSupport// org.springframework.transaction.interceptor.TransactionInterceptorpublic class TransactionInterceptor extends TransactionAspectSupport implements MethodInterceptor, Serializable { public TransactionInterceptor() { } public TransactionInterceptor(TransactionManager ptm, TransactionAttributeSource tas) { this.setTransactionManager(ptm); this.setTransactionAttributeSource(tas); } ... @Nullable public Object invoke(MethodInvocation invocation) throws Throwable { Class&lt;?&gt; targetClass = invocation.getThis() != null ? AopUtils.getTargetClass(invocation.getThis()) : null; Method var10001 = invocation.getMethod(); Objects.requireNonNull(invocation); return this.invokeWithinTransaction(var10001, targetClass, invocation::proceed); } ...}// org.springframework.transaction.interceptor.TransactionAspectSupport#invokeWithinTransaction@Nullableprotected Object invokeWithinTransaction(Method method, @Nullable Class&lt;?&gt; targetClass, final InvocationCallback invocation) throws Throwable { TransactionAttributeSource tas = this.getTransactionAttributeSource(); TransactionAttribute txAttr = tas != null ? tas.getTransactionAttribute(method, targetClass) : null; TransactionManager tm = this.determineTransactionManager(txAttr, targetClass); if (this.reactiveAdapterRegistry != null &amp;&amp; tm instanceof ReactiveTransactionManager rtm) { ... } else { PlatformTransactionManager ptm = this.asPlatformTransactionManager(tm); String joinpointIdentification = this.methodIdentification(method, targetClass, txAttr); if (txAttr != null &amp;&amp; ptm instanceof CallbackPreferringPlatformTransactionManager cpptm) { ... } else { TransactionInfo txInfo = this.createTransactionIfNecessary(ptm, txAttr, joinpointIdentification); Object retVal; try { retVal = invocation.proceedWithInvocation(); } catch (Throwable var23) { this.completeTransactionAfterThrowing(txInfo, var23); throw var23; } finally { this.cleanupTransactionInfo(txInfo); } if (retVal != null &amp;&amp; txAttr != null) { TransactionStatus status = txInfo.getTransactionStatus(); if (status != null) { ... } } this.commitTransactionAfterReturning(txInfo); return retVal; } }}" }, { "title": "WEB - nginx ì²˜ë¦¬ìœ¨ ì œí•œ ì‚´í´ë³´ê¸°", "url": "/posts/nginx-rate-limiting/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "WEB", "date": "2025-05-20 21:25:00 +0900", "snippet": " nginxëŠ” ì²˜ë¦¬ìœ¨ ì œí•œì„ ìœ„í•´ â€˜leaky bucket algorithmâ€™ ì‚¬ìš© leaky bucket algorithm ë¬¼ : ì‚¬ìš©ì ìš”ì²­ ë²„í‚· : ìš”ì²­ì´ ëŒ€ê¸°í•˜ëŠ” í ë„˜ì¹˜ëŠ” ë¬¼ : íê°€ ë‹¤ ì°¨ì„œ ê±°ì ˆë˜ëŠ” ìš”ì²­ ìƒˆëŠ” ë¬¼ : ì„œë²„ì— ì˜í•´ ì²˜ë¦¬ë˜ëŠ” ìš”ì²­ limit_req_zone $binary_...", "content": " nginxëŠ” ì²˜ë¦¬ìœ¨ ì œí•œì„ ìœ„í•´ â€˜leaky bucket algorithmâ€™ ì‚¬ìš© leaky bucket algorithm ë¬¼ : ì‚¬ìš©ì ìš”ì²­ ë²„í‚· : ìš”ì²­ì´ ëŒ€ê¸°í•˜ëŠ” í ë„˜ì¹˜ëŠ” ë¬¼ : íê°€ ë‹¤ ì°¨ì„œ ê±°ì ˆë˜ëŠ” ìš”ì²­ ìƒˆëŠ” ë¬¼ : ì„œë²„ì— ì˜í•´ ì²˜ë¦¬ë˜ëŠ” ìš”ì²­ limit_req_zone $binary_remote_addr zone=mylimit:10m rate=10r/s;server { location /login/ { limit_req zone=mylimit; proxy_pass http://my_upstream; }}limit_req_zone ë¬¸ë²• : limit_req_zone key zone=name:size rate=rate [sync]; Context : httpkey ì–´ë–¤ ê¸°ì¤€ìœ¼ë¡œ ìš”ì²­ì„ ì œí•œí• ì§€ë¥¼ ì§€ì • ì˜ˆì œì—ì„œëŠ” $binary_remote_addrë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ”ë°, ì´ ë³€ìˆ˜ëŠ” í´ë¼ì´ì–¸íŠ¸ì˜ IP ì£¼ì†Œë¥¼ ì´ì§„ í˜•íƒœë¡œ ë‚˜íƒ€ë‚¸ë‹¤. íŠ¹ì • api í˜¸ì¶œ ì „ì²´ë¥¼ ì œí•œí•˜ë ¤ë©´ ? $server_name ê°™ì€ ê³µí†µí‚¤ ì‚¬ìš© zone ì œí•œ ìƒíƒœ(ì˜ˆ: ê° IPê°€ ì–¼ë§ˆë‚˜ ìì£¼ ìš”ì²­í–ˆëŠ”ì§€ ë“±)ë¥¼ ì €ì¥í•˜ëŠ” ê³µìœ  ë©”ëª¨ë¦¬ ê³µê°„ì„ ì§€ì • ê³µìœ  ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì—, ì´ ì •ë³´ëŠ” ì—¬ëŸ¬ NGINX ì›Œì»¤ í”„ë¡œì„¸ìŠ¤ ê°„ì— ê³µìœ  IP ì£¼ì†Œ í•˜ë‚˜ë‹¹ ìƒíƒœ ì •ë³´ ì €ì¥ì— ì•½ 64ë°”ì´íŠ¸(32bit), 128ë°”ì´íŠ¸(64bit) ê°€ í•„ìš” ë”°ë¼ì„œ 32bit ê¸°ì¤€ 1MBë¡œ ì•½ 16,000ê°œ 64ë¹„íŠ¸ ê¸°ì¤€ ì•½ 8,000ê°œ ì €ì¥ ê°€ëŠ¥ ìƒˆë¡œìš´ í•­ëª©ì„ ë§Œë“¤ ë•Œë§ˆë‹¤ ìµœê·¼ 60ì´ˆ ë™ì•ˆ ì‚¬ìš©ë˜ì§€ ì•Šì€ í•­ëª© ìµœëŒ€ 2ê°œë¥¼ ì œê±°í•´ ë©”ëª¨ë¦¬ ê³ ê°ˆì„ ë°©ì§€ ë§Œì•½ ì €ì¥ ê³µê°„ì´ ê°€ë“ ì°¼ëŠ”ë° ìƒˆë¡œìš´ IP ì£¼ì†Œì˜ ìƒíƒœ ì •ë³´ë¥¼ ì €ì¥í•˜ë ¤ê³  í•˜ë©´: ê°€ì¥ ì˜¤ë˜ëœ í•­ëª©ì„ ì œê±°í•˜ê³ , ê·¸ë˜ë„ ê³µê°„ì´ ë¶€ì¡±í•˜ë©´ 503(Service Temporarily Unavailable) ìƒíƒœ ì½”ë“œë¥¼ ë°˜í™˜ rate ìµœëŒ€ ìš”ì²­ ì†ë„ë¥¼ ì§€ì • ì˜ˆë¥¼ ë“¤ì–´ 10r/së¼ê³  í•˜ë©´, ì´ˆë‹¹ 10ê±´ì˜ ìš”ì²­ë§Œ í—ˆìš© nginxëŠ” ë°€ë¦¬ì´ˆ ë‹¨ìœ„ë¡œ ìš”ì²­ì„ ì¶”ì í•˜ë¯€ë¡œ, ì´ ì„¤ì •ì€ 100msë§ˆë‹¤ 1ê°œì˜ ìš”ì²­ì„ í—ˆìš©í•œë‹¤ëŠ” ì˜ë¯¸ ì§€ì› ë‹¨ìœ„\t: ì´ˆ(r/s), ë¶„(r/m)sync ? ì›Œì»¤ í”„ë¡œì„¸ìŠ¤ê°€ ì—¬ëŸ¬ ê°œì¼ ë•Œ ê³µìœ  ë©”ëª¨ë¦¬(zone)ë¥¼ ì´ìš©í•´ rate limit ìƒíƒœë¥¼ ê³µìœ í•˜ì§€ë§Œ, ì›Œí¬ë¡œë“œì´ ë§ê±°ë‚˜ ê³ ì† ìš”ì²­ í™˜ê²½ì—ì„œëŠ” ë‹¤ìŒ ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤: ì›Œì»¤ í”„ë¡œì„¸ìŠ¤ë“¤ì´ ë™ì‹œì— zoneì„ ì—…ë°ì´íŠ¸í•˜ë©´ ë™ê¸°í™” ì§€ì—°ì´ë‚˜ race conditionì²˜ëŸ¼ ë³´ì´ëŠ” í˜„ìƒì´ ë°œìƒí•  ìˆ˜ ìˆìŒ ì¦‰, ì ê¹ ë™ì•ˆ ì´ˆê³¼ ìš”ì²­ì´ ì œí•œ ì—†ì´ ë“¤ì–´ê°€ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì¼ ìˆ˜ ìˆìŒ sync ì˜µì…˜ì€ ì´ëŸ° ìƒí™©ì—ì„œ: ì •í™•ë„ í–¥ìƒ : ìš”ì²­ ì œí•œ ì†ë„ë¥¼ ë³´ë‹¤ ì •í™•í•˜ê²Œ ì ìš© ë ˆì´ìŠ¤ ì»¨ë””ì…˜ ë°©ì§€ : ì›Œì»¤ ê°„ ë™ì‹œ ì—…ë°ì´íŠ¸ ì‹œ ì¶©ëŒ ì™„í™” Burst ì²˜ë¦¬ì˜ ì¼ê´€ì„± ê°œì„  : ì—¬ëŸ¬ ì›Œì»¤ê°€ ë™ì‹œì— burst íë¥¼ ì±„ìš°ëŠ” ìƒí™©ì„ ì œì–´ limit_req ë¬¸ë²• : limit_req zone=name [burst=number] [nodelay | delay=number]; Context : http, server, locationburst ë§Œì•½ ìœ„ ê°™ì€ ì˜ˆì‹œì—ì„œ ë™ì¼í•œ IPì—ì„œ 100ms ì´ë‚´ì— 2ê°œì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´, NGINXëŠ” ë‘ ë²ˆì§¸ ìš”ì²­ì— ëŒ€í•´ 503 (Service Temporarily Unavailable) ì‘ë‹µì„ ë³´ëƒ„ ë‹¤ë¥¸ ì‘ë‹µ ì½”ë“œë¥¼ ë³´ë‚´ê³  ì‹¶ìœ¼ë©´ limit_req_status í™œìš© í•˜ì§€ë§Œ ëŒ€ë¶€ë¶„ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ìˆœê°„ì ìœ¼ë¡œ ìš”ì²­ì´ ëª°ë¦¬ëŠ” í˜„ìƒ(burst)ì´ ë°œìƒlocation /login/ { limit_req zone=mylimit burst=20; proxy_pass http://my_upstream;} burst=20 : ì§€ì •ëœ ì†ë„(ì˜ˆ: ì´ˆë‹¹ 10íšŒ ìš”ì²­)ë¥¼ ì´ˆê³¼í•˜ëŠ” ìµœëŒ€ 20ê°œì˜ ìš”ì²­ê¹Œì§€ íì— ì €ì¥ ê°€ëŠ¥ ì˜ˆë¥¼ ë“¤ì–´, ë™ì‹œì— 21ê°œì˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´: ì²« ë²ˆì§¸ ìš”ì²­ì€ ì¦‰ì‹œ ì²˜ë¦¬ë‚˜ë¨¸ì§€ 20ê°œ ìš”ì²­ì€ íì— ì €ì¥ ì´í›„ 100msë§ˆë‹¤ í•˜ë‚˜ì”© ì²˜ë¦¬ë¨ (ì„¤ì •ëœ ì†ë„: 10r/sì— ë§ì¶°) ë§Œì•½ íê°€ ê½‰ ì°¬ ìƒíƒœì—ì„œ ë˜ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´, ê·¸ ìš”ì²­ì€ 503 ì—ëŸ¬ë¡œ ê±°ë¶€ë¨ nodelay burst ì„¤ì •ì€ ìš”ì²­ì„ ì¼ì • ê°„ê²©ìœ¼ë¡œ ì²˜ë¦¬í•˜ë¯€ë¡œ íŠ¸ë˜í”½ì´ ë¶€ë“œëŸ½ê²Œ íë¥´ì§€ë§Œ, ì‚¬ìš©ì ì…ì¥ì—ì„œëŠ” ì‚¬ì´íŠ¸ê°€ ëŠë ¤ì§„ ê²ƒì²˜ëŸ¼ ëŠê»´ì§ˆ ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íì˜ ë§ˆì§€ë§‰ ìš”ì²­(20ë²ˆì§¸)ì€ ìµœëŒ€ 2ì´ˆê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•˜ë©°, ì´ ì‘ë‹µì€ ì´ë¯¸ ì“¸ëª¨ ì—†ì–´ì¡Œì„ ìˆ˜ë„ ìˆë‹¤.location /login/ { limit_req zone=mylimit burst=20 nodelay; proxy_pass http://my_upstream;} nodelayëŠ” í ìŠ¬ë¡¯ì€ ìœ ì§€í•˜ì§€ë§Œ, íì— ë„£ì€ ìš”ì²­ì„ ì¦‰ì‹œ ì²˜ë¦¬ ë‹¨, ì†ë„ ì œí•œì€ ì—¬ì „íˆ ì ìš©ë˜ë©°, ìŠ¬ë¡¯ì„ ì°¨ì§€í•œ í›„ ì¼ì • ì‹œê°„(ì˜ˆ: 100ms)ì´ ì§€ë‚˜ì•¼ ìŠ¬ë¡¯ì´ ë‹¤ì‹œ ì‚¬ìš© ê°€ëŠ¥ ì¦‰, ë§¤100msë§ˆë‹¤ ìŠ¬ë¡¯ í•œ ê°œë¥¼ ë¹„ì›€ ì˜ˆì‹œ ìƒí™© íê°€ ë¹„ì–´ ìˆëŠ” ìƒíƒœì—ì„œ IP í•˜ë‚˜ê°€ ë™ì‹œì— 21ê°œì˜ ìš”ì²­ì„ ë³´ëƒ„ 21ê°œ ëª¨ë‘ ì¦‰ì‹œ ì²˜ë¦¬ ì´ ì¤‘ 20ê°œëŠ” í ìŠ¬ë¡¯ì„ â€˜ì ìœ  ì¤‘â€™ìœ¼ë¡œ í‘œì‹œ ìŠ¬ë¡¯ì€ ì´í›„ 100msë§ˆë‹¤ í•˜ë‚˜ì”© í•´ì œë¨ 501ms í›„ 20ê°œ ìš”ì²­ì´ ë“¤ì–´ì˜´ ìŠ¬ë¡¯ 5ê°œê°€ í•´ì œë˜ì–´ ìˆìŒ 5ê°œ ìš”ì²­ ì²˜ë¦¬, 15ê°œ ìš”ì²­ ê±°ë¶€ (503) delaylimit_req_zone $binary_remote_addr zone=ip:10m rate=5r/s;server { listen 80; location / { limit_req zone=ip burst=12 delay=8; proxy_pass http://website; }} delayë¥¼ ì§€ì •í•˜ë©´ ì¼ì • ê°œìˆ˜ê¹Œì§€ëŠ” ë°”ë¡œ ì²˜ë¦¬í•˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ì´ˆë‹¹ ìš”ì²­ ì œí•œ(rate)ì„ ì§€í‚¤ë©° ì²˜ë¦¬ ì¶œì²˜ : https://blog.nginx.org/blog/rate-limiting-nginx íŠ¹ì • IP ë³„ë„ ì²˜ë¦¬geo $limit { default 1; 10.0.0.0/8 0; 192.168.0.0/24 0;}map $limit $limit_key { 0 \"\"; 1 $binary_remote_addr;}limit_req_zone $limit_key zone=req_zone:10m rate=5r/s;server { location / { limit_req zone=req_zone burst=10 nodelay; # ... }} geo í´ë¼ì´ì–¸íŠ¸ IPë¥¼ ê¸°ë°˜ìœ¼ë¡œ $limit ë³€ìˆ˜ ê°’ì„ ì„¤ì • 10.0.0.0/8 ë° 192.168.0.0/24 ëŒ€ì—­ì— ì†í•œ IPëŠ” $limit = 0 ê·¸ ì™¸ IPëŠ” $limit = 1 (ê¸°ë³¸ê°’) map $limit ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ $limit_keyë¥¼ ì„¤ì • $limit == 0 â†’ $limit_key = \"\" (ë¹ˆ ë¬¸ìì—´) $limit == 1 â†’ $limit_key = $binary_remote_addr limit_req_zone $limit_keyë¥¼ ê¸°ì¤€ìœ¼ë¡œ ìš”ì²­ ì†ë„ë¥¼ ì œí•œ í‚¤ê°€ ë¹ˆ ë¬¸ìì—´(â€œâ€œ)ì´ë©´ ì†ë„ ì œí•œì´ ì ìš©ë˜ì§€ ì•ŠìŒ ì¦‰, í—ˆìš©ëœ IP(allowlist)ëŠ” ì œí•œ ì—†ì´ í†µê³¼ë˜ê³ , ë‚˜ë¨¸ì§€ëŠ” ì´ˆë‹¹ 5ê±´ìœ¼ë¡œ ì œí•œë¨ ì—¬ëŸ¬ ê°œì˜ limit_req ë””ë ‰í‹°ë¸Œë¥¼ ë™ì‹œì— ì‚¬ìš© ê° ì œí•œì´ ì„œë¡œ ì¶©ëŒí•˜ë©´: ê°€ì¥ ê°•í•œ ì œí•œ(ìµœì†Œ ì†ë„ or ê°€ì¥ ê¸´ ì§€ì—°)ì´ ì ìš©ë¨http { limit_req_zone $limit_key zone=req_zone:10m rate=5r/s; limit_req_zone $binary_remote_addr zone=req_zone_wl:10m rate=15r/s; server { location / { limit_req zone=req_zone burst=10 nodelay; limit_req zone=req_zone_wl burst=20 nodelay; # ... } }} ëŒ€ìƒ IP req_zone (5r/s) ì ìš© req_zone_wl (15r/s) ì ìš© ì‹¤ì œ ì œí•œ í—ˆìš©ëœ IP X (keyê°€ â€œâ€) O (binary IPë¡œ ì ìš©ë¨) 15r/s ì œí•œ í—ˆìš©ë˜ì§€ ì•Šì€ IP O O 5r/s ì œí•œ (ë” ì—„ê²©í•œ ì œí•œ ì ìš©ë¨) ë“œëŠ” ìƒê°1. ì •í™•í•œ ìš”ì²­ ìˆ˜ë¡œ ì œí•œí•´ì•¼í•˜ëŠ” ê²½ìš°ì—ëŠ” ì í•©í•˜ì§€ ì•Šì€ ê²ƒ ê°™ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, 1ì´ˆì— ìµœëŒ€ 1000ê°œì˜ ìš”ì²­ì„ í—ˆìš©í•˜ëŠ” ê²ƒì„ ê¸°ëŒ€í•˜ê³  1000r/së¡œ ì„¸íŒ…í•œ ê²½ìš°, busrt, nodelayë¥¼ ì‚¬ìš©í•˜ë©´ í•œë²ˆì— ë™ì‹œì— 1000ê°œ ìš”ì²­ì´ ì—…ìŠ¤íŠ¸ë¦¼ ì„œë²„ë¡œ ì „ë‹¬ë  ìˆ˜ ìˆì§€ë§Œ, 0.99ì´ˆì— 1000ê°œê°€ í•œë²ˆì— ë“¤ì–´ì˜¤ê³  1.01ì´ˆì— 1000ê°œê°€ ë˜ ë“¤ì–´ì˜¤ë©´ ì•„ì§ ì ìœ ëœ ìŠ¬ë¡¯ë“¤ì´ ëŒ€ë¶€ë¶„ í•´ì œë˜ì§€ ì•Šì€ ìƒíƒœë¼ ëŒ€ë¶€ë¶„ì˜ ìš”ì²­ì´ ê±°ì ˆë  ê²ƒ ë˜í•œ, limit_req_zoneì˜ sync ì„¤ëª…ì—ì„œì²˜ëŸ¼ ìš”ì²­ëŸ‰ì´ ë§ì€ ìƒí™©ì—ì„œ ê³µìœ  ë©”ëª¨ë¦¬ê°€ ì–´ëŠì •ë„ë¡œ ì˜ ë™ê¸°í™” ë˜ëŠ”ì§€ëŠ” ë¯¸ì§€ìˆ˜ì¸ ê²ƒ ê°™ìŒ ê°€ì¥ ê¸¸ê²Œ ì¤„ ìˆ˜ ìˆëŠ” ì§€ì—°ì´ 1r/m ì´ê¸° ë•Œë¬¸ì— ê·¸ ì´ìƒìœ¼ë¡œ ì œí•œí•˜ê¸°ëŠ” ì–´ë µë‹¤. rate=1r/60m ì´ëŸ°ì‹ì˜ ì„¤ì •ì´ ì•ˆë˜ëŠ” ì´ìœ  (ì•„ë˜ ì½”ë“œ ì°¸ê³ , r/s, r/më§Œ ê°€ëŠ¥)â€» ngx_http_limit_req_module.c// ngx_http_limit_req_module.cstatic char *ngx_http_limit_req_zone(ngx_conf_t *cf, ngx_command_t *cmd, void *conf){ ... if (ngx_strncmp(value[i].data, \"rate=\", 5) == 0) { len = value[i].len; p = value[i].data + len - 3; if (ngx_strncmp(p, \"r/s\", 3) == 0) { scale = 1; len -= 3; } else if (ngx_strncmp(p, \"r/m\", 3) == 0) { scale = 60; len -= 3; } rate = ngx_atoi(value[i].data + 5, len - 5); if (rate &lt;= 0) { ngx_conf_log_error(NGX_LOG_EMERG, cf, 0, \"invalid rate \\\"%V\\\"\", &amp;value[i]); return NGX_CONF_ERROR; } continue; } ...}2. 1ì°¨ì ì¸ ì–´ë·°ì§• ë°©ì§€ ìˆ˜ë‹¨ìœ¼ë¡œëŠ” ì ì ˆí•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì›¹ì‚¬ì´íŠ¸ì˜ ë©”ì¸ í˜ì´ì§€ì—ì„œ ë¡œê·¸ì¸í•˜ì§€ ì•Šì•„ë„ ì´ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ë“¤ì´ ìˆì„ ë•Œ, (ì‚¬ìš©ìì— ì˜í•´ì„œë“ , ë´‡ì— ì˜í•´ì„œë“ ) ë¶ˆí•„ìš”í•˜ê²Œ ë§ì´ í˜¸ì¶œë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ IP ê¸°ë°˜ìœ¼ë¡œ ì²˜ë¦¬ìœ¨ì„ ì œí•œí•˜ë©´ ë¶ˆí•„ìš”í•˜ê²Œ ì—…ìŠ¤íŠ¸ë¦¼ ì„œë²„ê¹Œì§€ ìš”ì²­ì´ ê°€ëŠ” ê²ƒì„ ì–´ëŠì •ë„ëŠ” ë§‰ì„ ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ìƒê°ì°¸ê³  ìë£Œ https://blog.nginx.org/blog/rate-limiting-nginx https://nginx.org/en/docs/http/ngx_http_limit_req_module.html#limit_req_zone https://nginx.org/en/docs/http/ngx_http_limit_req_module.html#limit_req" }, { "title": "ìë°”ì—ì„œ null ì²˜ë¦¬ì— ëŒ€í•´ ìƒê°í•´ë³´ê¸°", "url": "/posts/how-to-deal-with-null/", "categories": "ìƒê°í•´ë³´ê¸°, ì½”ë“œ ì‘ì„±", "tags": "", "date": "2025-05-04 10:25:00 +0900", "snippet": "ë‚˜ëŠ” ì–¸ì œ ì£¼ë¡œ nullì„ ì‚¬ìš©í–ˆì„ê¹Œ ? ì°¸ì¡°ê°’ì´ â€˜ì—†ìŒâ€™ì„ í‘œí˜„í•˜ëŠ” ê²½ìš° ë”°ë¼ì„œ, ë³´í†µ ì•„ë˜ì™€ ê°™ì´ ì½”ë“œë¥¼ ì‘ì„±í•˜ê²Œ ë˜ëŠ” ê²ƒ ê°™ë‹¤.if (obj != null) { // do something}if (obj == null) { // nullì¸ê²Œ ë¹„ì •ìƒì ì¸ ìƒí™©ì´ë¼ë©´ ì ì ˆí•œ ì˜ˆì™¸ ë°œìƒì‹œí‚¤ê¸°}// do somethingê·¸ë ‡ë‹¤ë©´, nullì˜...", "content": "ë‚˜ëŠ” ì–¸ì œ ì£¼ë¡œ nullì„ ì‚¬ìš©í–ˆì„ê¹Œ ? ì°¸ì¡°ê°’ì´ â€˜ì—†ìŒâ€™ì„ í‘œí˜„í•˜ëŠ” ê²½ìš° ë”°ë¼ì„œ, ë³´í†µ ì•„ë˜ì™€ ê°™ì´ ì½”ë“œë¥¼ ì‘ì„±í•˜ê²Œ ë˜ëŠ” ê²ƒ ê°™ë‹¤.if (obj != null) { // do something}if (obj == null) { // nullì¸ê²Œ ë¹„ì •ìƒì ì¸ ìƒí™©ì´ë¼ë©´ ì ì ˆí•œ ì˜ˆì™¸ ë°œìƒì‹œí‚¤ê¸°}// do somethingê·¸ë ‡ë‹¤ë©´, nullì˜ ë‹¨ì ì€ ë­ê°€ ìˆì„ê¹Œ ? í•´ë‹¹ ê°ì²´ë¥¼ ë‹¤ë£° ë•Œ ì£¼ì˜í•˜ì§€ ì•Šìœ¼ë©´ NPEê°€ ë°œìƒí•œë‹¤. ë”°ë¼ì„œ, nullì¸ì§€ë¥¼ í™•ì¸í•˜ëŠ” ì½”ë“œê°€ ë°˜ë³µì ìœ¼ë¡œ ë‚˜íƒ€ë‚˜ì•¼í•˜ê³  ì´ë¡œ ì¸í•´ ì½”ë“œê°€ ì§€ì €ë¶„í•´ì§ˆ ìˆ˜ ìˆë‹¤. ë˜í•œ, ì´ëŸ° null ê°ì²´ë“¤ì´ ì½”ë“œ ì´ê³³ ì €ê³³ì— ëŒì•„ë‹¤ë‹ˆë©´ NPEê°€ ë°œìƒí•  í™•ë¥ ì€ ë†’ì•„ì§ˆ ê²ƒì´ê³  ì´ë¡œ ì¸í•´ ì„œë¹„ìŠ¤ì˜ ì‹ ë¢°ì„±ì´ ë‚®ì•„ì§ˆ ìˆ˜ ìˆë‹¤. nullì„ ë¦¬í„´ë°›ëŠ” ì…ì¥ì—ì„œëŠ” ì´ê²Œ ì§„ì§œ ê°’ì´ ì—†ëŠ” ê²ƒì¸ì§€, ì–´ë–¤ ì—ëŸ¬ê°€ ë°œìƒí•œ ê²ƒì¸ì§€ ë“± í•´ë‹¹ ê°’ë§Œìœ¼ë¡œëŠ” ì •í™•í•œ ë§¥ë½ì„ íŒŒì•…í•  ìˆ˜ê°€ ì—†ê±°ë‚˜, ìƒì„¸ êµ¬í˜„ì„ í™•ì¸í•´ë´ì•¼ í•œë‹¤. ì •í™•í•œ ë§¥ë½ì„ íŒŒì•…í•  ìˆ˜ ì—†ë‹¤ëŠ” ê²ƒì€, ê·¸ì— ë”°ë¥¸ ì ì ˆí•œ ì²˜ë¦¬ë¥¼ í•˜ê¸°ê°€ ì–´ë µë‹¤ëŠ” ê²ƒ ê·¸ëŸ¼ ì–´ë–¤ì‹ìœ¼ë¡œ ì²˜ë¦¬í•˜ë©´ ì¢‹ì„ê¹Œ ?null ë¦¬í„´ private ë©”ì„œë“œì™€ ê°™ì´ ì‚¬ìš© ë²”ìœ„ê°€ ì œí•œì ì¸ ê²½ìš°ì˜ˆì™¸ ë°œìƒ ì°¸ì¡°ê°’ì´ ì—†ëŠ”ê²Œ ì˜ˆì™¸ë¡œ ê°„ì£¼ë˜ì–´ì•¼í•˜ëŠ” ê²½ìš°Optional ì´í™í‹°ë¸Œ ìë°”ë¥¼ ì°¸ê³ í•´ë³´ë©´, nullì¸ê²Œ ì˜ˆì™¸ì¸ì§€ ì•„ë‹Œì§€ ë“±ì„ í˜¸ì¶œí•œ ìª½ì—ì„œ ë§¥ë½ì— ë”°ë¼ íŒë‹¨í•´ì•¼í•˜ëŠ” ê²½ìš° Optionalì´ ê´œì°®ì€ ì„ íƒì¼ ìˆ˜ ìˆìŒ (CheckedExceptionì²˜ëŸ¼ í˜¸ì¶œìì—ê²Œ ì´ ë©”ì„œë“œë¥¼ í˜¸ì¶œí• ì‹œ â€˜ë¦¬í„´ê°’ì´ ì—†ì„ ìˆ˜ ìˆìŒâ€™ì„ ëª…í™•í•˜ê²Œ ì•Œë¦´ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—)ë¹ˆ ì»¬ë ‰ì…˜ new ArrayList&lt;&gt;();, Collections.emptyList(); ë“± NPEê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. ì´ì— ë”°ë¼, ì½”ë“œê°€ ì¡°ê¸ˆ ë” ê¹”ë”í•´ì§ˆ ìˆ˜ ìˆë‹¤. List&lt;Item&gt; items = getItems();// if (items != null &amp;&amp; !items.isEmpty()) -&gt; ì´ëŸ° ì²´í¬ê°€ ë¶ˆí•„ìš”for (Item item : items) { ...}null ì˜¤ë¸Œì íŠ¸ íŒ¨í„´public interface Result { void doSomething();}public class RealResult implements Result { @Override public void doSomething() { System.out.println(\"Doing real work\"); }}public class NullResult implements Result { @Override public void doSomething() { // do nothing }}public Result findById(String id) { if (/* not found */) { return new NullResult(); } else { return new RealResult(); }}Result result = findById(\"someId\");result.doSomething(); // null ì²´í¬ ì—†ì´ ì•ˆì „í•˜ê²Œ í˜¸ì¶œ" }, { "title": "ControllerëŠ” ì–´ë–¤ ë¶€ë¶„ì„ í…ŒìŠ¤íŠ¸ í•´ì•¼í• ê¹Œ ?", "url": "/posts/controller-test/", "categories": "ìƒê°í•´ë³´ê¸°, ì½”ë“œ ì‘ì„±", "tags": "", "date": "2025-04-29 22:20:00 +0900", "snippet": " ì›¹ ì„œë¹„ìŠ¤ì—ì„œ ë³´í¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë ˆì´ì–´ êµ¬ì¡°(Controller - Service - Repository)ì—ì„œ ControllerëŠ” ì–´ë–¤ ë¶€ë¶„ì„ í…ŒìŠ¤íŠ¸í•˜ë©´ ì¢‹ì„ì§€ ìƒê°í•´ë³´ì.í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ í•„ìš”ì„± ? ë‚´ê°€ ìƒê°í•˜ê¸°ì— í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ í•„ìš”í•œ ì´ìœ ëŠ” í¬ê²Œ ë‘ ê°€ì§€ê°€ ìˆì„ ê²ƒ ê°™ë‹¤. ì½”ë“œê°€ ë³€ê²½ëì„ ë•Œ, ë³€ê²½ëœ ë¶€ë¶„ì€ ì˜ë„í•œëŒ€ë¡œ ì˜ ë™ì‘í•˜ëŠ”ì§€, ê´€ë ¨ì´...", "content": " ì›¹ ì„œë¹„ìŠ¤ì—ì„œ ë³´í¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ë ˆì´ì–´ êµ¬ì¡°(Controller - Service - Repository)ì—ì„œ ControllerëŠ” ì–´ë–¤ ë¶€ë¶„ì„ í…ŒìŠ¤íŠ¸í•˜ë©´ ì¢‹ì„ì§€ ìƒê°í•´ë³´ì.í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ í•„ìš”ì„± ? ë‚´ê°€ ìƒê°í•˜ê¸°ì— í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ í•„ìš”í•œ ì´ìœ ëŠ” í¬ê²Œ ë‘ ê°€ì§€ê°€ ìˆì„ ê²ƒ ê°™ë‹¤. ì½”ë“œê°€ ë³€ê²½ëì„ ë•Œ, ë³€ê²½ëœ ë¶€ë¶„ì€ ì˜ë„í•œëŒ€ë¡œ ì˜ ë™ì‘í•˜ëŠ”ì§€, ê´€ë ¨ì´ ì—†ëŠ” ë¶€ë¶„ì€ ì›ë˜ëŒ€ë¡œ ì˜ ë™ì‘í•˜ëŠ”ì§€ì— ëŒ€í•œ ë³´ì¥ì„ ë°›ì„ ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ë¶ˆí•„ìš”í•˜ê²Œ ë°œìƒí•˜ëŠ” ìš´ì˜ ì´ìŠˆë¥¼ ì¤„ì´ê³  ì‹œìŠ¤í…œ ì¥ì• ë¥¼ ì˜ˆë°©í•¨ìœ¼ë¡œ ì¢€ ê²¬ê³ í•˜ê³  ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ê°€ ë  ìˆ˜ ìˆë‹¤. í…ŒìŠ¤íŠ¸í•˜ê³ ì í•˜ëŠ” ëŒ€ìƒ(ê¸°ëŠ¥, í´ë˜ìŠ¤ ë“±)ì´ ì–´ë–»ê²Œ ë™ì‘í•´ì•¼í•˜ëŠ”ì§€ì— ëŒ€í•œ ìµœì‹ í™”ëœ ëª…ì„¸ì„œê°€ ë  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ì½”ë“œ ë‚´ë¶€ë¥¼ ì¼ì¼ì´ ë‹¤ ì‚´í´ë³´ì§€ ì•Šì•„ë„ ì–´ë–¤ ì—­í• ì„ í•˜ëŠ” ì½”ë“œì¸ì§€ì— ëŒ€í•œ íŒŒì•…ì´ ê°€ëŠ¥í•˜ë‹¤.Controller ê·¸ë ‡ë‹¤ë©´, Controllerì˜ ì–´ë–¤ ë¶€ë¶„ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•´ì•¼ ì¢€ ë” ì•ˆì •ì ì¸ ì„œë¹„ìŠ¤ê°€ ë  ìˆ˜ ìˆì„ê¹Œ ë‚´ê°€ ìƒê°í•˜ëŠ” Controllerì˜ ì£¼ëœ ì—­í• ì€ í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ê³ , ìš”ì²­ì— ëŒ€í•œ ì²˜ë¦¬ ì‘ë‹µì„ ë‚´ì£¼ëŠ” ê²ƒì´ë‹¤. í´ë¼ì´ì–¸íŠ¸ì™€ ë§ë‹¿ì•„ ìˆê¸° ë•Œë¬¸ì—, Controllerê°€ ì˜ë„ì™€ ë‹¤ë¥´ê²Œ ë™ì‘í•˜ë©´ í˜¸ì¶œí•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ì—ì„œë„ ì˜ˆê¸°ì¹˜ ëª»í•œ ì´ìŠˆê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.ì •ìƒ ì¼€ì´ìŠ¤ ì •ìƒì ì¸ ìš”ì²­ì´ ì™”ì„ë•Œ ì •ìƒì ì¸ ì‘ë‹µì´ ë°˜í™˜ë˜ëŠ”ì§€ í™•ì¸. ì¦‰, í˜¸ì¶œí•˜ëŠ” ì…ì¥ì—ì„œ ê¸°ëŒ€í•œ ì‘ë‹µê°’ì´ ìˆëŠ” ê²ƒì„ ë³´ì¥. ì´ë¥¼ í†µí•´, ì˜ë„ì¹˜ì•Šê²Œ ì‘ë‹µ í•„ë“œê°€ ë³€ê²½ë˜ê±°ë‚˜ ë¹ ì§€ëŠ” ê²ƒ ë˜ëŠ” ì¶”ê°€ë˜ëŠ” ê²ƒ ë°©ì§€ ë°˜ë“œì‹œ ì¡´ì¬í•´ì•¼í•˜ëŠ” ì‘ë‹µê°’ ê²€ì¦ ê°€ëŠ¥ @WebMvcTest(FooController.class)class FooControllerTest { @Autowired private MockMvc mockMvc; @MockBean private FooService fooService; @Test void ì •ìƒ_ì‘ë‹µì—_a_bë§Œ_í¬í•¨ë˜ê³ _cëŠ”_ì—†ì–´ì•¼_í•œë‹¤() throws Exception { // Given ResultObject resultObject = new ResultObject(\"valueA\", \"valueB\", \"valueC\", \"valueD\"); given(fooService.doSomething(any(), any(), any())).willReturn(resultObject); RequestDTO requestDTO = new RequestDTO(\"param1\", \"param2\", \"param3\"); // When &amp; Then mockMvc.perform(post(\"/api/foo\") .contentType(MediaType.APPLICATION_JSON) .content(new ObjectMapper().writeValueAsString(requestDTO))) .andExpect(status().isOk()) .andExpect(jsonPath(\"$.data.a\").value(\"valueA\")) .andExpect(jsonPath(\"$.data.b\").value(\"valueB\")) .andExpect(jsonPath(\"$.data.c\").doesNotExist()); }}ë¹„ì •ìƒ ì¼€ì´ìŠ¤ ë¹„ì •ìƒì ì¸ ìš”ì²­ì´ ì™”ì„ë•Œ 1ì°¨ì ìœ¼ë¡œ Controllerì—ì„œ ë§‰ì„ ë¶€ë¶„ê³¼ ê·¸ì— ëŒ€í•œ ì‘ë‹µ ì²˜ë¦¬ê°€ ì ì ˆí•˜ê²Œ ë˜ëŠ”ì§€ í™•ì¸. ì´ë¥¼ í†µí•´ ë¹„ì •ìƒì ì¸ ìš”ì²­ìœ¼ë¡œ ì¸í•œ ì‹œìŠ¤í…œì— ì´ìŠˆê°€ ìƒê¸¸ ìˆ˜ ìˆëŠ” ë¶€ë¶„(ë°ì´í„°ê°€ ê¼¬ì´ê±°ë‚˜, ë¶ˆí•„ìš”í•œ ë°ì´í„°ê°€ ìŒ“ì´ê±°ë‚˜, ì˜ë„ì¹˜ì•Šê²Œ ë°ì´í„°ê°€ ì‚­ì œë˜ê±°ë‚˜, í˜ì´ì§• ì‚¬ì´ì¦ˆ ë„ˆë¬´ ì»¤ì„œ DBì— ë¶€í•˜ê°€ ë°œìƒí•˜ëŠ” ë“±) ë°©ì§€ í˜¸ì¶œí•˜ëŠ” ìª½ì—ì„œ ì‹¤ìˆ˜ë¡œ íŠ¹ì • ê°’ì„ ëˆ„ë½í•˜ëŠ” ë“±ì˜ ìƒí™©ì—ì„œ ì‘ë‹µì— í¬í•¨ëœ ì ì ˆí•œ ë©”ì„¸ì§€ë¡œ ì–´ë–¤ ë¬¸ì œì¸ì§€ ì¸ì§€í•  ìˆ˜ ìˆìŒ ì ì ˆí•œ status codeê°€ ì‘ë‹µë˜ëŠ”ì§€ @WebMvcTest(SearchController.class)class SearchControllerTest { @Autowired private MockMvc mockMvc; @MockBean private SearchService searchService; @Test void í•„ìˆ˜ê°’_ëˆ„ë½ì‹œ_400ê³¼_ì—ëŸ¬ë©”ì„¸ì§€ë¥¼_ë°˜í™˜í•œë‹¤() throws Exception { // Given: í•„ìˆ˜ í•„ë“œ ë¹ ì§„ ìš”ì²­ String invalidRequestJson = \"\"\" { \"page\": 1, \"size\": 100 // \"keyword\" ë¹ ì§ } \"\"\"; // When &amp; Then mockMvc.perform(post(\"/api/search\") .contentType(MediaType.APPLICATION_JSON) .content(invalidRequestJson)) .andExpect(status().isBadRequest()) .andExpect(jsonPath(\"$.success\").value(false)) .andExpect(jsonPath(\"$.errors\").isArray()) .andExpect(jsonPath(\"$.errors\", hasItem(\"ê²€ìƒ‰ì–´ëŠ” í•„ìˆ˜ì…ë‹ˆë‹¤.\"))); } @Test void ì‚¬ì´ì¦ˆê°€_500ì„_ì´ˆê³¼í•˜ë©´_400ê³¼_ì—ëŸ¬ë©”ì„¸ì§€ë¥¼_ë°˜í™˜í•œë‹¤() throws Exception { // Given: sizeê°€ 501ë¡œ ë„ˆë¬´ í° ìš”ì²­ PagingRequestDTO request = new PagingRequestDTO(1, 501, \"ê²€ìƒ‰ì–´\"); // When &amp; Then mockMvc.perform(post(\"/api/search\") .contentType(MediaType.APPLICATION_JSON) .content(new ObjectMapper().writeValueAsString(request))) .andExpect(status().isBadRequest()) .andExpect(jsonPath(\"$.success\").value(false)) .andExpect(jsonPath(\"$.errors\", hasItem(\"sizeëŠ” ìµœëŒ€ 500ê¹Œì§€ë§Œ í—ˆìš©í•©ë‹ˆë‹¤.\"))); }} ì´ëŸ° í…ŒìŠ¤íŠ¸ë“¤ì„ ê¸°ë°˜ìœ¼ë¡œ Spring Rest Docs ë“±ì„ í™œìš©í•˜ì—¬ API ëª…ì„¸ê¹Œì§€ ì œê³µí•œë‹¤ë©´, í˜¸ì¶œí•˜ëŠ” ì…ì¥ì—ì„œë„ ìš°ë¦¬ ì„œë¹„ìŠ¤ê°€ ì¢€ ë” ì˜ˆì¸¡ ê°€ëŠ¥í•˜ì§€ ì•Šì„ê¹Œí•˜ëŠ” ìƒê°ì´ë“ ë‹¤.ì‹¤ì œ ì‚¬ë¡€ ì°¸ê³  https://techblog.woowahan.com/14874/ ì»¨íŠ¸ë¡¤ëŸ¬ ìœ ë‹› í…ŒìŠ¤íŠ¸ëŠ” mockMvcë¥¼ ì‚¬ìš©í•˜ê³ , ServiceëŠ” í…ŒìŠ¤íŠ¸ ëŒ€ì—­ìœ¼ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤. =&gt; ì§€ê¸ˆ ì„ ë¬¼í•˜ê¸° ì‹œìŠ¤í…œì—ëŠ” í…ŒìŠ¤íŠ¸ì˜ í”¼ë“œë°± ì†ë„ê°€ ë” ì¤‘ìš”í–ˆê¸°ì— ì´ëŸ° íŠ¸ë ˆì´ë“œì˜¤í”„ì˜ ê²°ê³¼ë¡œ â€˜ìœ ë‹› í…ŒìŠ¤íŠ¸ ì‘ì„± ì‹œ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ìœ ë‹›ê³¼ ë‹¤ë¥¸ ìœ ë‹›ì˜ í˜‘ë™, ìœ„ì„ ê´€ê³„ê°€ ì¡´ì¬í•˜ëŠ” í…ŒìŠ¤íŠ¸ëŠ” ë‹¨ë… í…ŒìŠ¤íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ëŒ€ì—­ì„ ì ê·¹ ì‚¬ìš©í•œë‹¤.â€™ ë¼ëŠ” ì›ì¹™ì´ í•©ì˜ë˜ê³  @SpringBootTest ì• ë„ˆí…Œì´ì…˜ì„ ì œê±°í•˜ê²Œ ë©ë‹ˆë‹¤.=&gt; ê¸°ë³¸ì ìœ¼ë¡œ ê²©ë¦¬ëœ ë°©ì‹ìœ¼ë¡œ ì‰½ê²Œ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” ìœ ë‹›ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ëŠ” í˜‘ë™ í…ŒìŠ¤íŠ¸ë¥¼ ì ê·¹ ì‚¬ìš©í•œë‹¤.í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ìœ ë‹›ê³¼ ë‹¤ë¥¸ ìœ ë‹›ì˜ í˜‘ë™, ìœ„ì„ ê´€ê³„ê°€ ì¡´ì¬í•˜ëŠ” í…ŒìŠ¤íŠ¸ëŠ” ë‹¨ë… í…ŒìŠ¤íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ëŒ€ì—­ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. https://rieckpil.de/how-to-test-spring-boot-web-controller-the-right-way/ https://mosyarch.com/guide-spring-boot-controller-tests/=&gt; ì´í•´í•´ë³´ì" }, { "title": "Spring - Spring Rest Docsë€ ?", "url": "/posts/spring-restdocs/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Spring", "date": "2025-04-24 20:25:00 +0900", "snippet": "Spring REST Docs RESTful ì„œë¹„ìŠ¤ë¥¼ ë¬¸ì„œí™”í•˜ëŠ” ë° ë„ì›€ì„ ì£¼ëŠ” ë„êµ¬ Asciidoctorë¡œ ì‘ì„±í•œ ìˆ˜ë™ ë¬¸ì„œì™€ Spring MVC Testë¥¼ í†µí•´ ìë™ ìƒì„±ëœ ìŠ¤ë‹ˆí«ì„ ê²°í•©í•˜ì—¬ ì‚¬ìš© Spring WebFluxì˜ WebTestClientë‚˜ REST Assured 5 ì‚¬ìš©ë„ ê°€ëŠ¥ ì´ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ ì² í•™ ...", "content": "Spring REST Docs RESTful ì„œë¹„ìŠ¤ë¥¼ ë¬¸ì„œí™”í•˜ëŠ” ë° ë„ì›€ì„ ì£¼ëŠ” ë„êµ¬ Asciidoctorë¡œ ì‘ì„±í•œ ìˆ˜ë™ ë¬¸ì„œì™€ Spring MVC Testë¥¼ í†µí•´ ìë™ ìƒì„±ëœ ìŠ¤ë‹ˆí«ì„ ê²°í•©í•˜ì—¬ ì‚¬ìš© Spring WebFluxì˜ WebTestClientë‚˜ REST Assured 5 ì‚¬ìš©ë„ ê°€ëŠ¥ ì´ í”„ë¡œì íŠ¸ì˜ í•µì‹¬ ì² í•™ ì¤‘ í•˜ë‚˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ í†µí•´ ë¬¸ì„œë¥¼ ìƒì„±í•œë‹¤ëŠ” ì  ì´ëŠ” APIì˜ ì‹¤ì œ ë™ì‘ê³¼ í•­ìƒ ì¼ì¹˜í•˜ëŠ” ì •í™•í•œ ë¬¸ì„œê°€ ìƒì„±ë˜ë„ë¡ ë³´ì¥ í…ŒìŠ¤íŠ¸ë¥¼ ì‹¤í–‰í•˜ë©´ ìš”ì²­ê³¼ ê·¸ì— ëŒ€í•œ ì‘ë‹µì— ëŒ€í•œ ë¬¸ì„œ ìŠ¤ë‹ˆí«ì´ ìë™ìœ¼ë¡œ ìƒì„± Asciidoctor ? Asciidocì´ë¼ëŠ” ë§ˆí¬ì—… ì–¸ì–´ë¥¼ HTML, PDF ë“±ì˜ ë¬¸ì„œë¡œ ë³€í™˜í•´ì£¼ëŠ” ë„êµ¬ (ê³µì‹ ì‚¬ì´íŠ¸) Spring REST DocsëŠ” API ì„¤ëª…ì„œì˜ ë³¸ë¬¸ì„ Asciidoc í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ê²Œ í•˜ê³ , ì´ë¥¼ Asciidoctorë¡œ ë³€í™˜í•´ì„œ ìµœì¢… ë¬¸ì„œë¥¼ ìƒì„±Asciidoctorë¡œ ì‘ì„±í•œ ìˆ˜ë™ ë¬¸ì„œì™€ Spring MVC Testë¥¼ í†µí•´ ìë™ ìƒì„±ëœ ìŠ¤ë‹ˆí« ? Spring REST DocsëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•  ë•Œ, API ìš”ì²­ê³¼ ì‘ë‹µì„ ìë™ìœ¼ë¡œ ìº¡ì²˜í•´ì„œ â€œìŠ¤ë‹ˆí«(snippet)â€ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ì‘ì€ ë¬¸ì„œ ì¡°ê°ë“¤ì„ ìƒì„± Spring MVC í…ŒìŠ¤íŠ¸ @Testvoid helloRestDocs() throws Exception { mockMvc.perform(get(\"/api/hello\")) .andExpect(status().isOk()) .andDo(document(\"hello\", responseFields( fieldWithPath(\"message\").description(\"The hello message\") ) ));} ìŠ¤ë‹ˆí« ì˜ˆì‹œ curl-request.adoc: cURL ëª…ë ¹ì–´ ì˜ˆì‹œhttp-request.adoc: ìš”ì²­ í—¤ë”/ë³¸ë¬¸http-response.adoc: ì‘ë‹µ í—¤ë”/ë³¸ë¬¸response-fields.adoc: ì‘ë‹µ JSONì˜ í•„ë“œ ì„¤ëª… Asciidoctorë¡œ ì‘ì„±í•œ ìˆ˜ë™ ë¬¸ì„œ= API Documentation:toc: left= API ë¬¸ì„œì…ë‹ˆë‹¤.== Hello API=== `/api/hello`include::{snippets}/hello/http-request.adoc[] ìƒì„±ëœ HTML ë¬¸ì„œì°¸ê³  ìë£Œ https://spring.io/projects/spring-restdocs#overview https://www.baeldung.com/spring-rest-docs https://docs.spring.io/spring-restdocs/docs/current/reference/htmlsingle/" }, { "title": "OS - ë¦¬ëˆ…ìŠ¤ Load Average ì‚´í´ë³´ê¸°", "url": "/posts/load-average-part1/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "OS", "date": "2025-04-03 20:25:00 +0900", "snippet": "Load Average ? ë¦¬ëˆ…ìŠ¤ì˜ load averageëŠ” ì‹œìŠ¤í…œ ì „ì²´ì˜ ë¶€í•˜ í‰ê· ì„ ë‚˜íƒ€ë‚´ë©°, ì‹¤í–‰ ì¤‘ì´ê±°ë‚˜ ëŒ€ê¸° ì¤‘ì¸ ìŠ¤ë ˆë“œ(íƒœìŠ¤í¬)ì˜ ìˆ˜ë¥¼ í‰ê· ìœ¼ë¡œ ë‚˜íƒ€ë‚¸ ê²ƒ. ì¦‰, ì‹¤í–‰ ê°€ëŠ¥í•œ(runnable) íƒœìŠ¤í¬ë¿ë§Œ ì•„ë‹ˆë¼, uninterruptible sleep ìƒíƒœ(ì¤‘ë‹¨ ë¶ˆê°€ëŠ¥í•œ ëŒ€ê¸° ìƒíƒœ)ì— ìˆëŠ” íƒœìŠ¤í¬ë“¤ë„ ì¶”ì ì—­ì‚¬ ì²˜ìŒì—” ì‹¤í–‰ ê°€ëŠ¥í•œ íƒœìŠ¤í¬ì—...", "content": "Load Average ? ë¦¬ëˆ…ìŠ¤ì˜ load averageëŠ” ì‹œìŠ¤í…œ ì „ì²´ì˜ ë¶€í•˜ í‰ê· ì„ ë‚˜íƒ€ë‚´ë©°, ì‹¤í–‰ ì¤‘ì´ê±°ë‚˜ ëŒ€ê¸° ì¤‘ì¸ ìŠ¤ë ˆë“œ(íƒœìŠ¤í¬)ì˜ ìˆ˜ë¥¼ í‰ê· ìœ¼ë¡œ ë‚˜íƒ€ë‚¸ ê²ƒ. ì¦‰, ì‹¤í–‰ ê°€ëŠ¥í•œ(runnable) íƒœìŠ¤í¬ë¿ë§Œ ì•„ë‹ˆë¼, uninterruptible sleep ìƒíƒœ(ì¤‘ë‹¨ ë¶ˆê°€ëŠ¥í•œ ëŒ€ê¸° ìƒíƒœ)ì— ìˆëŠ” íƒœìŠ¤í¬ë“¤ë„ ì¶”ì ì—­ì‚¬ ì²˜ìŒì—” ì‹¤í–‰ ê°€ëŠ¥í•œ íƒœìŠ¤í¬ì— ëŒ€í•´ CPUê°€ ì²˜ë¦¬í•´ì•¼ í•  ì‘ì—…ëŸ‰ì„ ë‚˜íƒ€ë‚´ëŠ” ì§€í‘œì˜€ë‹¤. í•˜ì§€ë§Œ, ì´ë ‡ê²Œ í–ˆì„ë•Œ ìƒê¸¸ìˆ˜ ìˆëŠ” ë¬¸ì œì ì€: ì‹œìŠ¤í…œì€ ì „ì²´ì ìœ¼ë¡œ ëŠë ¤ì§€ì§€ë§Œ load averageëŠ” ë‚®ì•„ì§€ëŠ” ê²½ìš°ê°€ ìˆìŒ. ì˜ˆ : ë¹ ë¥¸ swap ë””ìŠ¤í¬ì—ì„œ ëŠë¦° swap ë””ìŠ¤í¬ë¡œ ë°”ê¾¼ ê²½ìš° ë¹ ë¥¸ ë””ìŠ¤í¬ : í”„ë¡œì„¸ìŠ¤ê°€ swapì„ ë¹¨ë¦¬ ëë‚´ê³  ë‹¤ì‹œ CPU ì‹¤í–‰ ëŒ€ê¸°ì—´ì— ë“¤ì–´ê°. runnable ìƒíƒœê°€ ë§ì•„ì§ â†’ load averageê°€ ë†’ê²Œ ë‚˜ì˜´ ëŠë¦° ë””ìŠ¤í¬ : í”„ë¡œì„¸ìŠ¤ê°€ swap ì¤‘ I/O wait ìƒíƒœë¡œ ì˜¤ë˜ ë¨¸ë¬´ë¦„ â†’ runnable ìƒíƒœì—ì„œ ë¹ ì§ (uninterruptible sleep ìƒíƒœë¡œ ë°”ë€œ) â†’ load averageì—ì„œ ì œì™¸ë¨ â†’ load averageê°€ ë‚®ê²Œ ë‚˜ì˜´ ë”°ë¼ì„œ, ì‹¤í–‰ ê°€ëŠ¥í•œ íƒœìŠ¤í¬ë§Œ í¬í•¨í•˜ê²Œë˜ë©´ ë¶€í•˜ë¡œ ì¸í•´ ì‹œìŠ¤í…œ ì„±ëŠ¥ì´ ì €í•˜ë˜ëŠ”ë° load averageëŠ” ë‚®ì•„ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í•´ë‹¹ ì§€í‘œê°€ ì§ê´€ì ì´ì§€ ì•Šê²Œë¨ ì™œ uninterruptible sleep ìƒíƒœì˜ ì‘ì—…ì´ ë§ì•„ì§€ë©´ ì‹œìŠ¤í…œì´ ëŠë ¤ì§ˆê¹Œ ? ì˜ˆì‹œ : swap-in/out, íŒŒì¼ ì‹œìŠ¤í…œ ë½, ë””ë°”ì´ìŠ¤ ì‘ë‹µ ëŒ€ê¸°, I/O wait ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ (ë³´í†µ ë””ìŠ¤í¬ I/O ë“±)uninterruptible sleep (D ìƒíƒœ)ì˜ íŠ¹ì§• ì»¤ë„ì´ ê¹° ìˆ˜ ì—†ë‹¤. sleep ìƒíƒœ(S)ëŠ” ì¸í„°ëŸ½íŠ¸ë‚˜ ì‹œê·¸ë„ë¡œ ê¹° ìˆ˜ ìˆëŠ”ë°, D ìƒíƒœëŠ” ì‹œìŠ¤í…œ ì½œì´ ëë‚  ë•Œê¹Œì§€ ë¬´ì¡°ê±´ ê¸°ë‹¤ë ¤ì•¼ í•œë‹¤. ë¦¬ì†ŒìŠ¤ë¥¼ ì ìœ í•œë‹¤. CPUë¥¼ ì§ì ‘ ì ìœ í•˜ì§„ ì•Šì§€ë§Œ, ë‹¤ìŒê³¼ ê°™ì€ ì‹œìŠ¤í…œ ìì›ì„ ê³„ì† ë¶™ì¡ê³  ìˆê²Œë¨: ë©”ëª¨ë¦¬ í˜ì´ì§€ I/O ë²„í¼ ë½ (íŒŒì¼ ì‹œìŠ¤í…œ ë½, inode ë½ ë“±) ìŠ¤ë ˆë“œ/í”„ë¡œì„¸ìŠ¤ slot ìì²´ ìŠ¤ì¼€ì¤„ëŸ¬ ì…ì¥ì—ì„œ â€œì¼ì´ ë°€ë¦¬ëŠ” ì¤‘â€ CPUê°€ ì§ì ‘ ì²˜ë¦¬í•˜ì§„ ì•Šë”ë¼ë„, í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ê°€ ë¦¬ì†ŒìŠ¤ë¥¼ ê¸°ë‹¤ë¦¬ë©° íì— ìŒ“ì´ê³  ìˆëŠ” ìƒíƒœ í‰ê· ì´ë€ ? 1ë¶„, 5ë¶„, 15ë¶„ ë™ì•ˆì˜ í‰ê· ì€ ì–´ë–»ê²Œ ê³„ì‚°ë˜ëŠ”ê±¸ê¹Œ ? load average ê´€ë ¨ ì»¤ë„ ì†ŒìŠ¤ ì½”ë“œë¥¼ ì°¸ê³ í•´ë³´ì•˜ë‹¤. loadavg.c loadavg.h í‰ê·  ê³„ì‚°ê³¼ ê´€ë ¨í•˜ì—¬ ì°¸ê³ í•œ ì£¼ì„ê³¼ ì½”ë“œëŠ” ì•„ë˜ì™€ ê°™ë‹¤.* The global load average is an exponentially decaying average of nr_running +* nr_uninterruptible.** Once every LOAD_FREQ:** nr_active = 0;* for_each_possible_cpu(cpu)*\tnr_active += cpu_of(cpu)-&gt;nr_running + cpu_of(cpu)-&gt;nr_uninterruptible;** avenrun[n] = avenrun[0] * exp_n + nr_active * (1 - exp_n)...avenrun[0] = calc_load_n(avenrun[0], EXP_1, active, n);avenrun[1] = calc_load_n(avenrun[1], EXP_5, active, n);avenrun[2] = calc_load_n(avenrun[2], EXP_15, active, n);...calc_load_n(unsigned long load, unsigned long exp, unsigned long active, unsigned int n){\treturn calc_load(load, fixed_power_int(exp, FSHIFT, n), active);}...#define LOAD_FREQ\t(5*HZ+1)\t/* 5 sec intervals */#define EXP_1\t\t1884\t\t/* 1/exp(5sec/1min) as fixed-point */#define EXP_5\t\t2014\t\t/* 1/exp(5sec/5min) */#define EXP_15\t\t2037\t\t/* 1/exp(5sec/15min) */calc_load(unsigned long load, unsigned long exp, unsigned long active){\tunsigned long newload;\tnewload = load * exp + active * (FIXED_1 - exp);\tif (active &gt;= load)\t\tnewload += FIXED_1-1;\treturn newload / FIXED_1;}ì˜ˆì‹œ : 1ë¶„ Load Average ê³„ì‚° ìœ„ ì½”ë“œë¥¼ ì˜¨ì „íˆ ì´í•´í•˜ê¸°ëŠ” ì–´ë ¤ì›Œì„œ ì£¼ì„ì— ìˆëŠ” avenrun[n] = avenrun[0] * exp_n + nr_active * (1 - exp_n) ì‹ì„ ê¸°ë°˜ìœ¼ë¡œ GPTì—ê²Œ ë¬¼ì–´ë³´ì•˜ë‹¤. (ê·¼ë° avenrun[0] ì´ ì•„ë‹ˆë¼ avenrun[n]ì´ ë˜ì–´ì•¼í•˜ì§€ ì•Šë‚˜ ?) - ê°€ì •: ë§¤ ìƒ˜í”Œ ì£¼ê¸°(LOAD_FREQ)ë§ˆë‹¤ nr_active = 10 (ì¦‰, ì‹¤í–‰ ë˜ëŠ” ëŒ€ê¸° ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ìˆ˜ê°€ 10ìœ¼ë¡œ ì¼ì •í•¨)- ì´ˆê¸° ê°’: t=0ì¼ ë•Œ load average ê°’=0- exp_1: 0.9200 (1ë¶„ì— í•´ë‹¹í•˜ëŠ” ì§€ìˆ˜ ìƒìˆ˜, 5ì´ˆ ê°„ê²©ìœ¼ë¡œ 1ë¶„ í‰ê· ì„ ë§ì¶”ê¸° ìœ„í•œ ê°ì‡ ìœ¨) ìƒ˜í”Œ ì£¼ê¸° (Tick) ì´ì „ load (old_load) ê³„ì‚°ì‹ ìƒˆë¡œìš´ load (new_load) 1 0 0 Ã— 0.9200 + 10 Ã— (1 - 0.9200) = 0 + 10 Ã— 0.0800 0.8 2 0.8 0.8 Ã— 0.9200 + 10 Ã— 0.0800 = 0.736 + 0.8 1.536 3 1.536 1.536 Ã— 0.9200 + 10 Ã— 0.0800 = 1.414 + 0.8 â‰ˆ 2.214 4 2.214 2.214 Ã— 0.9200 + 10 Ã— 0.0800 = 2.0369 + 0.8 â‰ˆ 2.837 5 2.837 2.837 Ã— 0.9200 + 10 Ã— 0.0800 = 2.613 + 0.8 â‰ˆ 3.413 â€¦ â€¦ â€¦ â€¦ ì§€ìˆ˜ í‰ê· ì˜ ì˜ë¯¸ 1ë¶„ load averageëŠ” ë‹¨ìˆœíˆ 60ë²ˆ ë°˜ë³µí•´ì„œ í‰ê· ì„ ë‚¸ ê°’ì´ ì•„ë‹ˆë¼, ì§€ìˆ˜ì ìœ¼ë¡œ ê³¼ê±°ë¥¼ ê°ì‡ í•˜ë©° í˜„ì¬ ê°’ì„ ë”í•´ê°€ëŠ” ë°©ì‹ ë‹¨ìˆœ í‰ê· : â€œ1ë¶„ ë™ì•ˆ 60ë²ˆ ì¬ì„œ ë”í•œ ë’¤ ë‚˜ëˆˆ ê°’â€ ì§€ìˆ˜ í‰ê·  : â€œ1ë¶„ ë™ì•ˆ ë¶€í•˜ê°€ ê³„ì† ìœ ì§€ë˜ì—ˆë‹¤ë©´ ì–´ë–¤ ê°’ìœ¼ë¡œ ìˆ˜ë ´í•˜ê² ëŠ”ê°€?â€ ìƒ˜í”Œ ì£¼ê¸° : LOAD_FREQ #define LOAD_FREQ\t(5*HZ+1)\t/* 5 sec intervals */ ìœ„ ì½”ë“œëŠ” load averageë¥¼ 5ì´ˆë§ˆë‹¤ ê°±ì‹ í•˜ë ¤ëŠ” ì˜ë„ HZ : â€œ1ì´ˆë‹¹ ëª‡ ë²ˆ ì‹œìŠ¤í…œ íƒ€ì´ë¨¸ ì¸í„°ëŸ½íŠ¸ê°€ ë°œìƒí•˜ëŠ”ê°€â€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’ (ì»¤ë„ì˜ ì‹œê°„ ë‹¨ìœ„, ë˜ëŠ” 1ì´ˆë¥¼ ëª‡ ê°œì˜ í‹±(jiffies)ìœ¼ë¡œ ë‚˜ëˆŒ ê²ƒì¸ê°€ë¥¼ ê²°ì •í•˜ëŠ” ìƒìˆ˜) 100 :\t1ì´ˆì— 100ë²ˆ ì¸í„°ëŸ½íŠ¸ ë°œìƒ â†’ 1 tick = 10ms 250\t: 1ì´ˆì— 250ë²ˆ ì¸í„°ëŸ½íŠ¸ â†’ 1 tick = 4ms 1000 : 1ì´ˆì— 1000ë²ˆ ì¸í„°ëŸ½íŠ¸ â†’ 1 tick = 1ms ì¦‰, HZê°€ ë†’ì„ìˆ˜ë¡ load average ê°±ì‹  ì£¼ê¸°ê°€ ë” ì„¸ë°€í•´ì§€ê³  ì •í™•í•´ì§ HZê°€ 100ì¸ ì‹œìŠ¤í…œ ê¸°ì¤€ìœ¼ë¡œëŠ” LOAD_FREQ â‰ˆ 501 jiffies â‰ˆ 5.01ì´ˆ ì°¸ê³  https://www.brendangregg.com/blog/2017-08-08/linux-load-averages.html" }, { "title": "iframeì´ ì—´ë¦¬ì§€ ì•ŠëŠ” ì´ìŠˆ (ancestor violates the following Content Security Policy directive)", "url": "/posts/csp-iframe-issue/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "HTTP", "date": "2025-03-15 22:25:00 +0900", "snippet": "ìƒí™© ê¸°ì¡´ì—ëŠ” http://alpha.domain.com ë¶€ëª¨ì°½ì—ì„œ http://alpha-foo.domain.com iframeì„ ì‚¬ìš©í•˜ëŠ” ì‹œìŠ¤í…œì—ì„œ, íŠ¹ì • ì‘ì—…ìœ¼ë¡œ ì¸í•´ http://alpha.domain.com ë¶€ëª¨ì°½ì—ì„œ https://test.alpha-foo.domain.com iframeì„ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆëŠ”ë°, ì½˜ì†”ì— ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ ë©”...", "content": "ìƒí™© ê¸°ì¡´ì—ëŠ” http://alpha.domain.com ë¶€ëª¨ì°½ì—ì„œ http://alpha-foo.domain.com iframeì„ ì‚¬ìš©í•˜ëŠ” ì‹œìŠ¤í…œì—ì„œ, íŠ¹ì • ì‘ì—…ìœ¼ë¡œ ì¸í•´ http://alpha.domain.com ë¶€ëª¨ì°½ì—ì„œ https://test.alpha-foo.domain.com iframeì„ ì‚¬ìš©í•˜ê²Œ ë˜ì—ˆëŠ”ë°, ì½˜ì†”ì— ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ ë©”ì„¸ì§€ê°€ ì°íˆë©´ì„œ í™”ë©´ì´ ëœ¨ì§€ ì•Šì•˜ë‹¤. http://alpha.domain.comì€ íƒ€ì‹œìŠ¤í…œì´ê³  iframeìœ¼ë¡œ ì œê³µí•˜ëŠ” í™”ë©´ì´ ë‚´ê°€ ê´€ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œì´ë‹¤.Refused to frame 'https://test.alpha-foo.domain.com' because an ancestor violates the following Content Security Policy directive: \"frame-ancestors 'self' *.domain.com\".ë‚´ê°€ ê´€ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œ Nginx ì„¤ì • add_header Content-Security-Policy \"frame-ancestors 'self' *.domain.com\";ì›ì¸ íŒŒì•… CSP ê´€ë ¨í•´ì„œ ì •ë¦¬í•˜ë©´ì„œ ì•Œê²Œë˜ì—ˆê³ , ì›ì¸ì€ êµ‰ì¥íˆ ê°„ë‹¨í–ˆë‹¤. ì•ì„œ ì„¸íŒ…ëœ ì„¤ì •ì— ë³´ë©´ *.domain.comìœ¼ë¡œ ë˜ì–´ìˆëŠ”ë°, ìŠ¤í‚¤ë§ˆê°€ ìƒëµë˜ë©´ CSPê°€ ì ìš©ëœ ì¶œì²˜(origin)ì˜ ìŠ¤í‚¤ë§ˆë¥¼ ë”°ë¼ê°€ê²Œëœë‹¤. ì¦‰, https://test.alpha-foo.domain.com iframe(origin)ì„ ë„ìš°ë ¤ë©´ ë¶€ëª¨ì°½(frame-ancestors)ë„ ë°˜ë“œì‹œ https://*.domain.comì˜ í˜•ì‹ì´ì–´ì•¼ í–ˆë˜ê²ƒì´ë‹¤. í•´ê²° ë°©ì•ˆ1. ì„¤ì • ë³€ê²½ add_header Content-Security-Policy \"frame-ancestors 'self' http://*.domain.com\"; httpë¡œ ëª…ì‹œí–ˆë”ë¼ë„, â€œë³´ì•ˆ ë‹¨ê³„ê°€ ë” ë†’ì€ ìŠ¤í‚¤ë§ˆë¡œ ì—…ê·¸ë ˆì´ë“œëœ ìš”ì²­ì€ ìë™ìœ¼ë¡œ í—ˆìš©â€ë˜ê¸° ë•Œë¬¸ì— httpsë„ í—ˆìš©ë¨ 2. ë¶€ëª¨ì°½ì—ì„œ https ì‚¬ìš©" }, { "title": "WEB - Content-Security-Policy(CSP) ì‚´í´ë³´ê¸°", "url": "/posts/content-security-policy/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "WEB", "date": "2025-03-15 22:25:00 +0900", "snippet": "Content-Security-Policy ? ì½˜í…ì¸  ë³´ì•ˆ ì •ì±…(CSP)ì€ íŠ¹ì • ìœ í˜•ì˜ ë³´ì•ˆ ìœ„í˜‘ì˜ ìœ„í—˜ì„ ë°©ì§€í•˜ê±°ë‚˜ ìµœì†Œí™”í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ë¸Œë¼ìš°ì €ë¡œ ë³´ë‚´ëŠ” ì¼ë ¨ì˜ ì§€ì¹¨ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ë¸Œë¼ìš°ì €ì—ì„œ ì½”ë“œê°€ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì— ì œí•œì„ ë‘ë„ë¡ ì§€ì‹œCSP ì „ë‹¬ ë°©ì‹ HTTP ì‘ë‹µ í—¤ë” ë©”ì¸ ë¬¸ì„œë¿ë§Œ ì•„...", "content": "Content-Security-Policy ? ì½˜í…ì¸  ë³´ì•ˆ ì •ì±…(CSP)ì€ íŠ¹ì • ìœ í˜•ì˜ ë³´ì•ˆ ìœ„í˜‘ì˜ ìœ„í—˜ì„ ë°©ì§€í•˜ê±°ë‚˜ ìµœì†Œí™”í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” ê¸°ëŠ¥ìœ¼ë¡œ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ë¸Œë¼ìš°ì €ë¡œ ë³´ë‚´ëŠ” ì¼ë ¨ì˜ ì§€ì¹¨ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆìœ¼ë©°, ë¸Œë¼ìš°ì €ì—ì„œ ì½”ë“œê°€ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì— ì œí•œì„ ë‘ë„ë¡ ì§€ì‹œCSP ì „ë‹¬ ë°©ì‹ HTTP ì‘ë‹µ í—¤ë” ë©”ì¸ ë¬¸ì„œë¿ë§Œ ì•„ë‹ˆë¼ ëª¨ë“  ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì— ì ìš©ë˜ì–´ì•¼ í•œë‹¤. &lt;meta&gt; íƒœê·¸ì˜ http-equiv ì†ì„±ìœ¼ë¡œ ì •ì˜ì •ì±… ì •ì±…ì€ ì„¸ë¯¸ì½œë¡ ìœ¼ë¡œ êµ¬ë¶„ëœ ì¼ë ¨ì˜ ì§€ì‹œë¬¸(Fetch directives)ìœ¼ë¡œ êµ¬ì„± ê° ì§€ì‹œë¬¸ì€ ë³´ì•ˆ ì •ì±…ì˜ ë‹¤ë¥¸ ì¸¡ë©´ì„ ì œì–´ì˜ˆì‹œ Content-Security-Policy: default-src 'self'; img-src 'self' example.com ì§€ì‹œë¬¸1 : default-src 'self' ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ ìœ í˜•ì— ëŒ€í•´ ë‹¤ë¥¸ ì •ì±…ì„ ì„¤ì •í•˜ëŠ” êµ¬ì²´ì ì¸ ì§€ì‹œì–´ê°€ ì—†ëŠ” í•œ, ë¬¸ì„œì™€ ë™ì¼í•œ ì¶œì²˜ì˜ ë¦¬ì†ŒìŠ¤ë§Œ ë¡œë“œí•˜ë¼ê³  ë¸Œë¼ìš°ì €ì— ì§€ì‹œ ì§€ì‹œë¬¸2 : img-src 'self' example.com ë¸Œë¼ìš°ì €ì— ë™ì¼í•œ ì¶œì²˜ì˜ ì´ë¯¸ì§€ë‚˜ example.comì—ì„œ ì œê³µëœ ì´ë¯¸ì§€ë¥¼ ë¡œë“œí•˜ë¼ê³  ì§€ì‹œ Fetch directives ë¦¬ì†ŒìŠ¤(JavaScript, CSS, ì´ë¯¸ì§€ ë“±)ì— ëŒ€í•œ í—ˆìš©ëœ ë²”ì£¼(ë„ë©”ì¸, URL, í”„ë¡œí† ì½œ, ë˜ëŠ” íŒ¨í„´ ë“±)ë¥¼ ì§€ì • ì˜ˆë¥¼ ë“¤ì–´, script-srcëŠ” JavaScript ë¡œë“œë¥¼ í—ˆìš©í•˜ëŠ” ë²”ì£¼ë¥¼ ì„¤ì • ì „ì²´ ì§€ì‹œì–´ ëª©ë¡ì€ ì—¬ê¸°ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤. default-src : ì§€ì‹œë¬¸ì´ ëª…ì‹œì ìœ¼ë¡œ ë‚˜ì—´ë˜ì§€ ì•Šì€ ëª¨ë“  ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ëŒ€ì²´ ì •ì±…ì„ ì„¤ì • ê° Fetch directivesëŠ” ë‹¨ì¼ í‚¤ì›Œë“œ 'none' ë˜ëŠ” ê³µë°±ìœ¼ë¡œ êµ¬ë¶„ëœ í•˜ë‚˜ ì´ìƒì˜ ì¶œì²˜ í‘œí˜„ì‹(source expressions)ìœ¼ë¡œ ì§€ì • none : í•´ë‹¹ ë¦¬ì†ŒìŠ¤ ë¡œë“œ ìì²´ë¥¼ ì°¨ë‹¨ self : ë¬¸ì„œ ìì²´ì™€ ë™ì¼í•œ ì¶œì²˜(origin)ì˜ ë¦¬ì†ŒìŠ¤ë§Œ í—ˆìš© ë‘ ê°œ ì´ìƒì˜ ì¶œì²˜ í‘œí˜„ì‹ì´ ë‚˜ì—´ëœ ê²½ìš° í•˜ë‚˜ë¼ë„ ë¦¬ì†ŒìŠ¤ë¥¼ í—ˆìš©í•˜ë©´ ë¦¬ì†ŒìŠ¤ê°€ í—ˆìš©ë¨ í•˜ì§€ë§Œ, ì˜ˆì™¸ì ìœ¼ë¡œ noneì´ ê°™ì´ ìˆìœ¼ë©´ ë‹¤ë¥¸ ì¶œì²˜ í‘œí˜„ì‹ë“¤ì€ ë¬´ì‹œë¨ ì˜ˆì‹œ Content-Security-Policy: default-src 'self'; img-src 'self' example.com default-srcëŠ” ë‹¨ì¼ ì¶œì²˜ í‘œí˜„ì‹ selfë¡œ êµ¬ì„±. img-srcëŠ” ë‘ ê°œì˜ ì¶œì²˜ í‘œí˜„ì‹ selfì™€ example.comìœ¼ë¡œ êµ¬ì„±â€» Fetch ? fetchëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì˜ì–´ì—ì„œ â€œê°€ì ¸ì˜¤ë‹¤â€ ë˜ëŠ” â€œë¶ˆëŸ¬ì˜¤ë‹¤â€ë¼ëŠ” ì˜ë¯¸ fetchëŠ” ë¸Œë¼ìš°ì €ê°€ ì™¸ë¶€ ë¦¬ì†ŒìŠ¤ë¥¼ ìš”ì²­í•˜ê±°ë‚˜ ê°€ì ¸ì˜¤ëŠ” í–‰ìœ„ ì¦‰, Fetch directivesë€ ì›¹ ë¬¸ì„œê°€ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ìˆëŠ” ë¦¬ì†ŒìŠ¤ì˜ ì¢…ë¥˜ë‚˜ ì¶œì²˜ë¥¼ ì œí•œí•˜ëŠ” ì§€ì‹œì–´ì¶œì²˜ í‘œí˜„ì‹ í˜•ì‹ ì‚´í´ë³´ê¸° &lt;host-source&gt; ë° &lt;scheme-source&gt; í˜•ì‹ì€ ë”°ì˜´í‘œë¡œ ë¬¶ì–´ì„œëŠ” ì•ˆë˜ë©°, ë‹¤ë¥¸ ëª¨ë“  í˜•ì‹ì€ ì‘ì€ ë”°ì˜´í‘œë¡œ ë¬¶ì–´ì•¼ í•œë‹¤.&lt;host-source&gt; í•´ë‹¹ ë¦¬ì†ŒìŠ¤ë¥¼ í—ˆìš©í•  ì¶œì²˜ì˜ URL ë˜ëŠ” í˜¸ìŠ¤íŠ¸ IP ì£¼ì†Œ ìŠ¤í‚¤ë§ˆ(ì˜ˆ: http, https), í¬íŠ¸ ë²ˆí˜¸, ê²½ë¡œ(path)ëŠ” ìƒëµí•  ìˆ˜ ìˆë‹¤. origin = &lt;scheme&gt; \"://\" &lt;host&gt; [ \":\" &lt;port&gt; ] ìŠ¤í‚¤ë§ˆë¥¼ ìƒëµí•˜ë©´, ë¬¸ì„œì˜ ì¶œì²˜(origin)ì—ì„œ ì‚¬ìš©ëœ ìŠ¤í‚¤ë§ˆê°€ ìë™ìœ¼ë¡œ ì ìš©ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´, iframeì—ì„œ Content-Security-Policy: frame-ancestors *.example.comìœ¼ë¡œ ì„¤ì •í–ˆê³  iframeì˜ url ìŠ¤í‚¤ë§ˆê°€ httpsë¼ë©´ ë¶€ëª¨ì°½ë„ ë°˜ë“œì‹œ https ì—¬ì•¼í•œë‹¤. CSP(Content-Security-Policy)ì—ì„œ ìŠ¤í‚¤ë§ˆë¥¼ ì§€ì •í•˜ë©´ ì›ì¹™ì ìœ¼ë¡œëŠ” ì •í™•í•œ ì¼ì¹˜ê°€ ìš”êµ¬ë˜ì§€ë§Œ, ë³´ì•ˆ ë‹¨ê³„ê°€ ë” ë†’ì€ ìŠ¤í‚¤ë§ˆë¡œ ì—…ê·¸ë ˆì´ë“œëœ ìš”ì²­ì€ ìë™ìœ¼ë¡œ í—ˆìš©ëœë‹¤. http://example.comì€ https://example.comì˜ ë¦¬ì†ŒìŠ¤ë„ í—ˆìš© ws://example.comì€ wss://example.orgì˜ ë¦¬ì†ŒìŠ¤ë„ í—ˆìš© ì™€ì¼ë“œì¹´ë“œ(*)ëŠ” ì„œë¸Œë„ë©”ì¸, í˜¸ìŠ¤íŠ¸ ì£¼ì†Œ ë° í¬íŠ¸ ë²ˆí˜¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ê° í•­ëª©ì—ì„œ ê°€ëŠ¥í•œ ëª¨ë“  ìœ íš¨í•œ ê°’ì´ í—ˆìš©ë¨ì„ ì˜ë¯¸í•œë‹¤. http://*.example.comì€ example.comì˜ ëª¨ë“  ì„œë¸Œë„ë©”ì¸ìœ¼ë¡œë¶€í„° ì˜¤ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ HTTP ë˜ëŠ” HTTPSë¡œ í—ˆìš© ê²½ë¡œê°€ /ë¡œ ëë‚˜ëŠ” ê²½ìš°, ê·¸ ê²½ë¡œë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  í•˜ìœ„ ê²½ë¡œë¥¼ ë§¤ì¹­í•œë‹¤. example.com/api/ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê²½ë¡œ ëª¨ë‘ í—ˆìš©: example.com/api/users example.com/api/users/list example.com/api/orders/123 ë§Œì•½ ê²½ë¡œê°€ /ë¡œ ëë‚˜ì§€ ì•ŠëŠ”ë‹¤ë©´, ì •í™•íˆ ê·¸ ê²½ë¡œ í•˜ë‚˜ë§Œ ë§¤ì¹­í•œë‹¤. example.com/api : example.com/apië§Œ í—ˆìš© &lt;scheme-source&gt; https:ì™€ ê°™ì€ schemeì„ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ì½œë¡ (:)ì´ í•„ìˆ˜ì ì´ë‹¤ ë³´ì•ˆ ì—…ê·¸ë ˆì´ë“œê°€ í—ˆìš©ë¨ httpë¥¼ í—ˆìš©í•˜ë©´ httpsë¡œ ë¡œë“œëœ ë¦¬ì†ŒìŠ¤ë„ í—ˆìš© wsë¥¼ í—ˆìš©í•˜ë©´ wssë¡œ ë¡œë“œëœ ë¦¬ì†ŒìŠ¤ë„ í—ˆìš© upgrade-insecure-requests ì§€ì‹œì–´ ì‚¬ì´íŠ¸ëŠ” ë•Œë•Œë¡œ ì£¼ìš” ë¬¸ì„œë¥¼ HTTPSë¥¼ í†µí•´ ì œê³µí•˜ì§€ë§Œ ë¦¬ì†ŒìŠ¤ëŠ” HTTPë¥¼ í†µí•´ ì œê³µí•œë‹¤.&lt;script src=\"http://example.org/my-cat.js\"&gt;&lt;/script&gt; ì´ë¥¼ mixed contentë¼ê³  í•˜ë©°, ì•ˆì „í•˜ì§€ ì•Šì€ ë¦¬ì†ŒìŠ¤ê°€ ìˆìœ¼ë©´ HTTPSì—ì„œ ì œê³µí•˜ëŠ” ë³´í˜¸ê°€ í¬ê²Œ ì•½í™”ëœë‹¤. ë¸Œë¼ìš°ì €ê°€ êµ¬í˜„í•˜ëŠ” mixed content ì•Œê³ ë¦¬ì¦˜ì— ë”°ë¼ ë¬¸ì„œê°€ HTTPSë¥¼ í†µí•´ ì œê³µë˜ëŠ” ê²½ìš° ì•ˆì „í•˜ì§€ ì•Šì€ ë¦¬ì†ŒìŠ¤ëŠ” â€œì—…ê·¸ë ˆì´ë“œ ê°€ëŠ¥í•œ ì½˜í…ì¸ â€ì™€ â€œì°¨ë‹¨ ê°€ëŠ¥í•œ ì½˜í…ì¸ â€ë¡œ ë¶„ë¥˜ëœë‹¤. mixed contentì— ëŒ€í•œ ê¶ê·¹ì ì¸ í•´ê²°ì±…ì€ ê°œë°œìê°€ ëª¨ë“  ë¦¬ì†ŒìŠ¤ë¥¼ HTTPSë¥¼ í†µí•´ ë¡œë“œí•˜ëŠ” ê²ƒì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ì‚¬ì´íŠ¸ê°€ ëª¨ë“  ì½˜í…ì¸ ë¥¼ HTTPSë¥¼ í†µí•´ ì œê³µí•  ìˆ˜ ìˆë”ë¼ë„ ê°œë°œìê°€ ë¦¬ì†ŒìŠ¤ë¥¼ ë¡œë“œí•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” ëª¨ë“  URLì„ ë‹¤ì‹œ ì‘ì„±í•˜ëŠ” ê²ƒì€ ì—¬ì „íˆ ë§¤ìš° ì–´ë ¤ì›€ (ì•„ì¹´ì´ë¸Œëœ ì½˜í…ì¸ ì™€ ê´€ë ¨ëœ ê²½ìš° ì‚¬ì‹¤ìƒ ë¶ˆê°€ëŠ¥í•  ìˆ˜ë„ ìˆìŒ). upgrade-insecure-requests ì§€ì‹œë¬¸ì€ ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ì‚¬ìš©ëœë‹¤. Content-Security-Policy: upgrade-insecure-requests ì´ ì§€ì‹œë¬¸ì´ ë¬¸ì„œì— ì„¤ì •ëœ ê²½ìš° ë¸Œë¼ìš°ì €ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš° ëª¨ë“  HTTP URLì„ HTTPSë¡œ ìë™ ì—…ê·¸ë ˆì´ë“œí•œë‹¤. ë¦¬ì†ŒìŠ¤(ì˜ˆ: ì´ë¯¸ì§€, ìŠ¤í¬ë¦½íŠ¸ ë“±)ë¥¼ ë¡œë“œí•˜ëŠ” ìš”ì²­ ë¬¸ì„œì™€ ë™ì¼í•œ ì¶œì²˜ì¸ íƒìƒ‰ ìš”ì²­(ì˜ˆ: ë§í¬ ëŒ€ìƒ) ì¤‘ì²©ëœ ë¸Œë¼ìš°ì§• ì»¨í…ìŠ¤íŠ¸ì˜ íƒìƒ‰ ìš”ì²­(ì˜ˆ: iframe) form ì œì¶œ í•˜ì§€ë§Œ, ëŒ€ìƒì´ ë‹¤ë¥¸ ì¶œì²˜ì¸ ìµœìƒìœ„ íƒìƒ‰(top-level navigation) ìš”ì²­ì€ ì—…ê·¸ë ˆì´ë“œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Top-level navigationì€ ë¸Œë¼ìš°ì €ê°€ í˜„ì¬ í˜ì´ì§€ì—ì„œ ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì§ì ‘ ì´ë™í•˜ëŠ” ìš”ì²­ì„ ì˜ë¯¸ &lt;a href=\"...\"&gt; ë§í¬ë¥¼ í´ë¦­í•´ì„œ ë‹¤ë¥¸ í˜ì´ì§€ë¡œ ì´ë™í•˜ê±°ë‚˜, ì£¼ì†Œì°½ì— URLì„ ì§ì ‘ ì…ë ¥í•´ì„œ ì´ë™í•˜ê±°ë‚˜, ë¸Œë¼ìš°ì €ì—ì„œ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ë‹¤ë¥¸ ì›¹ì‚¬ì´íŠ¸ë¡œ ì§ì ‘ ì´ë™í•˜ëŠ” ë“± ì˜ˆë¥¼ ë“¤ì–´, https://example.orgì˜ ë¬¸ì„œê°€ upgrade-insecure-requests ì§€ì‹œì–´ë¥¼ í¬í•¨í•˜ëŠ” CSPì™€ í•¨ê»˜ ì œê³µë˜ê³  í•´ë‹¹ ë¬¸ì„œì— ë‹¤ìŒê³¼ ê°™ì€ ë§ˆí¬ì—…ì´ í¬í•¨ë˜ì–´ ìˆë‹¤ê³  ê°€ì •í–ˆì„ ë•Œ, ë¸Œë¼ìš°ì €ëŠ” ë‘ ìš”ì²­ì„ ëª¨ë‘ ìë™ìœ¼ë¡œ HTTPSë¡œ ì—…ê·¸ë ˆì´ë“œí•œë‹¤. &lt;script src=\"http://example.org/my-cat.js\"&gt;&lt;/script&gt;&lt;script src=\"http://not-example.org/another-cat.js\"&gt;&lt;/script&gt; í•˜ì§€ë§Œ, ë‹¤ìŒì˜ ê²½ìš° ë¸Œë¼ìš°ì €ëŠ” ì²« ë²ˆì§¸ ë§í¬ëŠ” HTTPSë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ì§€ë§Œ, ë‘ ë²ˆì§¸ ë§í¬ëŠ” ë‹¤ë¥¸ ì¶œì²˜ë¡œ ì´ë™í•˜ê¸° ë•Œë¬¸ì— ì—…ê·¸ë ˆì´ë“œí•˜ì§€ ì•ŠëŠ”ë‹¤. &lt;a href=\"http://example.org/more-cats\"&gt;See some more cats!&lt;/a&gt;&lt;a href=\"http://not-example.org/even-more-cats\"&gt;More cats, on another site!&lt;/a&gt; CSPë¡œ ì•…ì˜ì ì¸ ê³µê²© ë§‰ëŠ” ì˜ˆì‹œì™¸ë¶€ ìŠ¤í¬ë¦½íŠ¸ ì£¼ì… ì˜ˆì‹œ : &lt;script src=\"https://evil.example.com/hacker.js\"&gt;&lt;/script&gt; ë°©ì–´ : Content-Security-Policy: script-src 'self'; í˜„ì¬ ë„ë©”ì¸ì˜ ìŠ¤í¬ë¦½íŠ¸ë§Œ í—ˆìš© ì¸ë¼ì¸ JavaScript ì°¨ë‹¨ ì˜ˆì‹œ &lt;script&gt; console.log(\"You've been hacked!\");&lt;/script&gt; ë°©ì–´ Content-Security-Policy: script-src 'self'; &lt;script&gt; ë‚´ë¶€ì˜ ì¸ë¼ì¸ JavaScript ì‹¤í–‰ ì°¨ë‹¨ ('unsafe-inlineâ€™ í‚¤ì›Œë“œê°€ ì—†ìœ¼ë©´ ì¸ë¼ì¸ JavaScript ì‹¤í–‰ ì°¨ë‹¨ë¨) ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì°¨ë‹¨ ì˜ˆì‹œ : &lt;img onmouseover=\"console.log(You've been hacked!)\" /&gt; ë°©ì–´ : Content-Security-Policy: script-src 'self'; ìœ„ì™€ ë§ˆì°¬ê°€ì§€ë¡œ 'unsafe-inline'ì„ ì œê±°í•˜ë©´ onmouseover, onclick ê°™ì€ ì¸ë¼ì¸ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ì°¨ë‹¨ ì°¸ê³  ìë£Œ https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/frame-ancestors" }, { "title": "Hello 2025", "url": "/posts/hello2025/", "categories": "ë„ì ë„ì ", "tags": "", "date": "2025-02-28 22:00:00 +0900", "snippet": "ì§€ë‚œ ì‹œê°„ë“¤ì„ ë˜ëŒì•„ë³´ë©° ë‹¤ì§í•´ë³¸ë‹¤.ê°ì‚¬í•˜ì.ê²¸ì†í•˜ì.ê¾¸ì¤€í•˜ì.ë„“ê²Œë³´ì.ì§„ì§œê°€ ë˜ì.", "content": "ì§€ë‚œ ì‹œê°„ë“¤ì„ ë˜ëŒì•„ë³´ë©° ë‹¤ì§í•´ë³¸ë‹¤.ê°ì‚¬í•˜ì.ê²¸ì†í•˜ì.ê¾¸ì¤€í•˜ì.ë„“ê²Œë³´ì.ì§„ì§œê°€ ë˜ì." }, { "title": "Java - try-with-resources ì•Œì•„ë³´ê¸°", "url": "/posts/try-with-resources/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2025-02-23 18:29:00 +0900", "snippet": "try-with-resourcesë€ ? ìë°”7ë¶€í„° ë“±ì¥í•œ êµ¬ë¬¸ìœ¼ë¡œ try ë¸”ë¡ì´ ì¢…ë£Œë  ë•Œ AutoClosable ë˜ëŠ” Closable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ (JVMì´) ìë™ìœ¼ë¡œ close()ë¥¼ í˜¸ì¶œí•œë‹¤.ê¸°ì¡´(try-finally) ë°©ì‹static String readFirstLineFromFileWithFinallyBlock(Strin...", "content": "try-with-resourcesë€ ? ìë°”7ë¶€í„° ë“±ì¥í•œ êµ¬ë¬¸ìœ¼ë¡œ try ë¸”ë¡ì´ ì¢…ë£Œë  ë•Œ AutoClosable ë˜ëŠ” Closable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ (JVMì´) ìë™ìœ¼ë¡œ close()ë¥¼ í˜¸ì¶œí•œë‹¤.ê¸°ì¡´(try-finally) ë°©ì‹static String readFirstLineFromFileWithFinallyBlock(String path) throws IOException { FileReader fr = new FileReader(path); BufferedReader br = new BufferedReader(fr); try { return br.readLine(); } finally { br.close(); fr.close(); }} ë¦¬ì†ŒìŠ¤ í•´ì œë¥¼ ìœ„í•´ì„œëŠ” ì§ì ‘ close()ë¥¼ í˜¸ì¶œí•´ì•¼í•œë‹¤. ë§Œì•½ br.close()ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´, fr.close()ê°€ ì‹¤í–‰ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ. (ìì› ëˆ„ìˆ˜ ë°œìƒ ê°€ëŠ¥)try-with-resources ë°©ì‹static String readFirstLineFromFileWithFinallyBlock(String path) throws IOException { try (FileReader fr = new FileReader(path); BufferedReader br = new BufferedReader(fr) ) { return br.readLine(); }}â€» ìë°” 9ë¶€í„°ëŠ” ì´ë¯¸ ì„ ì–¸ëœ ë¦¬ì†ŒìŠ¤ë„ try-with-resourcesì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.static String readFirstLineFromFileWithFinallyBlock(String path) throws IOException { FileReader fr = new FileReader(path); BufferedReader br = new BufferedReader(fr); try (fr; br) { return br.readLine(); }}ì˜ˆì™¸ ë°œìƒ ì‹œtry (MyResource resource = new MyResource()) { throw new Exception(\"Exception in try block\");} catch (Exception e) { System.out.println(\"Main Exception: \" + e.getMessage()); for (Throwable suppressed : e.getSuppressed()) { System.out.println(\"Suppressed Exception: \" + suppressed.getMessage()); }}Main Exception: Exception in try blockSuppressed Exception: Exception in close() try ë¸”ë¡ì—ì„œ ì˜ˆì™¸ ë°œìƒ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë”ë¼ë„ close()ëŠ” ìë™ìœ¼ë¡œ í˜¸ì¶œë¨ try ë¸”ë¡ê³¼ close()ì—ì„œ ëª¨ë‘ ì˜ˆì™¸ ë°œìƒ try ë¸”ë¡ì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ê°€ ì£¼ëœ ì˜ˆì™¸(primary exception)ê°€ ë˜ê³  close()ì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ëŠ” ì–µì œëœ ì˜ˆì™¸(suppressed exception)ê°€ ë¨ â€» Suppressed Exception ? ìœ„ì—ì„œ ì‚´í´ë³´ì•˜ë“¯ì´ try-with-resourcesì—ì„œëŠ” ë‘ ê°œ ì´ìƒì˜ ì˜ˆì™¸ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ ì´ëŸ° ê²½ìš° ì˜ˆì™¸ê°€ ë®ì–´ì”Œì›Œì ¸ ì‹¤ì œ ì›ì¸(ì£¼ ì˜ˆì™¸)ì´ ì‚¬ë¼ì§ˆ ìˆ˜ ìˆê³ , ì´ë¡œ ì¸í•´ ë””ë²„ê¹…ì´ ì–´ë ¤ì›Œì§ˆ ìˆ˜ ìˆìŒ ë”°ë¼ì„œ, try ë¸”ë¡ì—ì„œ ë°œìƒí•œ ì˜ˆì™¸ë¥¼ ìœ ì§€í•˜ê³ , close() ì¤‘ ë°œìƒí•œ ì˜ˆì™¸ëŠ” ì–µì œ(Suppressed)í•¨ ìë°” 7ì—ì„œ Throwableì— ì¶”ê°€ëœ getSuppressed ë©”ì„œë“œë¥¼ ì´ìš©í•´ì„œ ì–µì œëœ ì˜ˆì™¸ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŒìì› í•´ì œ ìˆœì„œ ë‹«íˆëŠ” ìˆœì„œëŠ” ìƒì„± ìˆœì„œì˜ ë°˜ëŒ€ (LIFO, í›„ì…ì„ ì¶œ) ì¦‰, writer.close() â†’ zf.close() ìˆœì„œë¡œ ì‹¤í–‰ë¨ try ( java.util.zip.ZipFile zf = new java.util.zip.ZipFile(zipFileName); java.io.BufferedWriter writer = java.nio.file.Files.newBufferedWriter(outputFilePath, charset)) { for (java.util.Enumeration entries = zf.entries(); entries.hasMoreElements();) { String zipEntryName = ((java.util.zip.ZipEntry) entries.nextElement()).getName(); writer.write(zipEntryName); }}Closable vs AutoClosable Java 7ì—ì„œ try-with-resourcesë¥¼ ì¶”ê°€í•˜ë©´ì„œ ê¸°ì¡´ Closeable(Java 5ì—ì„œ ë“±ì¥)ì„ ìˆ˜ì •í•˜ë©´ í•˜ìœ„ í˜¸í™˜ì„±ì´ ê¹¨ì§ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— AutoCloseableì„ ìƒˆë¡œ ë§Œë“¤ê³ , Closeableì´ ì´ë¥¼ í™•ì¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í•´ê²°.public interface AutoCloseable { void close() throws Exception;}public interface Closeable extends AutoCloseable { public void close() throws IOException;}ì˜ˆì™¸ ì²˜ë¦¬ ê´€ì  Closeableì€ IO ìŠ¤íŠ¸ë¦¼ ì „ìš©ìœ¼ë¡œ ì„¤ê³„ë˜ì—ˆìœ¼ë©°, IOExceptionì„ ë˜ì§„ë‹¤. AutoCloseableì€ ì¼ë°˜ Exceptionì„ ë˜ì§ˆ ìˆ˜ ìˆìŒ ì¦‰, AutoCloseableì€ ì¼ë°˜ì ì¸ ìì› ê´€ë¦¬ì— ë” ë„“ê²Œ ì ìš©ë  ìˆ˜ ìˆìŒ. í•˜ì§€ë§Œ, êµ¬ì²´ì ì¸ ì˜ˆì™¸(IOException, SQLException ë“±)ë¥¼ ë˜ì§€ëŠ” ê²ƒì´ ê¶Œì¥ë¨. ë§Œì•½ close()ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ì—†ë‹¤ë©´, ì˜ˆì™¸ë¥¼ ë˜ì§€ì§€ ì•ŠëŠ” ê²ƒì´ ë” ë°”ëŒì§í•˜ë‹¤. AutoCloseable êµ¬í˜„ì‹œ close()ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ìˆëŠ” ê²½ìš°, ë°˜ë“œì‹œ ë¦¬ì†ŒìŠ¤ë¥¼ ë¨¼ì € í•´ì œí•´ì•¼ í•œë‹¤. ë§Œì•½ close()ì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤ë©´, ë¦¬ì†ŒìŠ¤ë¥¼ ë¨¼ì € í•´ì œí•˜ê³  ì˜ˆì™¸ë¥¼ ë˜ì§€ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤. ì˜ˆì™¸ê°€ ë°œìƒí•´ë„ ë¦¬ì†ŒìŠ¤ê°€ í•´ì œë˜ì§€ ì•Šìœ¼ë©´, ìì› ëˆ„ìˆ˜(resource leak)ê°€ ë°œìƒí•  ìˆ˜ ìˆìŒ. ë©±ë“±ì„± ê´€ì  Closeableì€ idempotent(ë©±ë“±ì„±) ì„ ë³´ì¥ ì˜ˆë¥¼ ë“¤ì–´, FileInputStream.close()ë¥¼ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œí•´ë„ ì¶”ê°€ì ì¸ ì˜ˆì™¸ ì—†ì´ ì•ˆì „í•˜ê²Œ ì¢…ë£Œë¨. AutoCloseableì€ ì´ëŸ¬í•œ ë³´ì¥ì„ ì œê³µí•˜ì§€ëŠ” ì•Šì§€ë§Œ, ë¦¬ì†ŒìŠ¤ë¥¼ ì—¬ëŸ¬ ë²ˆ ë‹«ë”ë¼ë„ ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ì„¤ê³„í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤. ì¦‰, close()ëŠ” ì¼ë°˜ì ìœ¼ë¡œ í•œ ë²ˆë§Œ í˜¸ì¶œë˜ì§€ë§Œ, ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œë  ê°€ëŠ¥ì„±ë„ ê³ ë ¤í•´ì•¼ í•œë‹¤. ì°¸ê³  ìë£Œ https://stackoverflow.com/questions/13141302/implements-closeable-or-implements-autocloseable https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html https://docs.oracle.com/javase/8/docs/api/java/lang/AutoCloseable.html" }, { "title": "HashMapì˜ put ë©”ì„œë“œ ë“¤ì—¬ë‹¤ë³´ê¸°", "url": "/posts/java-hashmap-put/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ë“¤ì—¬ë‹¤ë³´ê¸°", "tags": "Java", "date": "2025-02-21 22:25:00 +0900", "snippet": " ìë°” 17 ê¸°ì¤€, GPT ì„ ìƒë‹˜ê³¼ í•¨ê»˜ ê³µë¶€í•´ë³´ì•˜ë‹¤.static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; { final int hash; final K key; V value; Node&lt;K,V&gt; next; Node(int hash, K key, V valu...", "content": " ìë°” 17 ê¸°ì¤€, GPT ì„ ìƒë‹˜ê³¼ í•¨ê»˜ ê³µë¶€í•´ë³´ì•˜ë‹¤.static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; { final int hash; final K key; V value; Node&lt;K,V&gt; next; Node(int hash, K key, V value, Node&lt;K,V&gt; next) { this.hash = hash; this.key = key; this.value = value; this.next = next; } public final K getKey() { return key; } public final V getValue() { return value; } public final String toString() { return key + \"=\" + value; } public final int hashCode() { return Objects.hashCode(key) ^ Objects.hashCode(value); } public final V setValue(V newValue) { V oldValue = value; value = newValue; return oldValue; } public final boolean equals(Object o) { if (o == this) return true; return o instanceof Map.Entry&lt;?, ?&gt; e &amp;&amp; Objects.equals(key, e.getKey()) &amp;&amp; Objects.equals(value, e.getValue()); }}transient Node&lt;K,V&gt;[] table; // (0)public V put(K key, V value) { return putVal(hash(key), key, value, false, true);}final V putVal(int hash, K key, V value, boolean onlyIfAbsent, boolean evict) { Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i; // (1) if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; // (2) if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); // (3) else { Node&lt;K,V&gt; e; K k; // (3-1) if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; // (3-2) else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); // (3-3) else { for (int binCount = 0; ; ++binCount) { if ((e = p.next) == null) { p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; } if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e; } } // (4) if (e != null) { V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue; } } // (5) ++modCount; if (++size &gt; threshold) resize(); // (6) afterNodeInsertion(evict); return null;}(0) Node&lt;K,V&gt;[] tabletransient Node&lt;K,V&gt;[] table; HashMapì€ Nodeê°ì²´ë¥¼ ë‹´ê³ ìˆëŠ” ë°°ì—´ë¡œ êµ¬í˜„ëœë‹¤.(1) í…Œì´ë¸” í¬ê¸° í™•ì¸ ë° ì´ˆê¸°í™”if ((tab = table) == null || (n = tab.length) == 0) n = (tab = resize()).length; tableì´ ì•„ì§ ìƒì„±ë˜ì§€ ì•Šì•˜ê±°ë‚˜, ê¸¸ì´ê°€ 0ì´ë©´ resize()ë¥¼ í˜¸ì¶œí•˜ì—¬ ì´ˆê¸°í™”í•œë‹¤. í•´ì‹œ í…Œì´ë¸”(table)ì´ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ í¬ê¸°(DEFAULT_INITIAL_CAPACITY = 16)ë¡œ ì´ˆê¸°í™”ëœë‹¤.(2) í•´ì‹œ ì¶©ëŒ ì—†ì´ ë°”ë¡œ ì €ì¥ ê°€ëŠ¥í•œ ê²½ìš°if ((p = tab[i = (n - 1) &amp; hash]) == null) tab[i] = newNode(hash, key, value, null); (n - 1) &amp; hash ì—°ì‚°ì„ ìˆ˜í–‰í•˜ì—¬ í•´ì‹œ ê°’ì„ ë°°ì—´ ì¸ë±ìŠ¤ë¡œ ë³€í™˜í•œë‹¤. (n - 1) &amp; hashëŠ” hash % nê³¼ ë™ì¼í•œ ì—­í• ì„ í•˜ë©´ì„œ ì„±ëŠ¥ì„ ìµœì í™”í•œë‹¤. í•´ë‹¹ ìœ„ì¹˜(tab[i])ê°€ nullì´ë©´ ìƒˆë¡œìš´ ë…¸ë“œë¥¼ ìƒì„±í•˜ì—¬ ì €ì¥í•œë‹¤.(3) í•´ì‹œ ì¶©ëŒí•œ ê²½ìš° ì¦‰, tab[i = (n - 1) &amp; hash]ê°€ nullì´ ì•„ë‹Œ ê²½ìš°(3-1) ì´ë¯¸ ì¡´ì¬í•˜ëŠ” í‚¤ì¸ ê²½ìš°if (p.hash == hash &amp;&amp; ((k = p.key) == key || (key != null &amp;&amp; key.equals(k)))) e = p; p.hash == hashì´ê³  p.key.equals(key)ë¼ëŠ”ê±´ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” í‚¤ (4)ì—ì„œ ê¸°ì¡´ ê°’ì„ í˜„ì¬ ê°’ìœ¼ë¡œ ë®ì–´ì“´ë‹¤. (e.value = value)(3-2) íŠ¸ë¦¬ë¡œ ì €ì¥í•´ì•¼ í•˜ëŠ” ê²½ìš°else if (p instanceof TreeNode) e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value); ê¸°ì¡´ ë…¸ë“œ pê°€ íŠ¸ë¦¬ êµ¬ì¡°(TreeNode)ë¡œ ì €ì¥ëœ ê²½ìš° íŠ¸ë¦¬ì— ê°’ì„ ì¶”ê°€í•œë‹¤. HashMapì€ íŠ¹ì • ì¡°ê±´(TREEIFY_THRESHOLD = 8)ì—ì„œ ì—°ê²° ë¦¬ìŠ¤íŠ¸ ëŒ€ì‹  ë ˆë“œ-ë¸”ë™ íŠ¸ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤. (3-3ì—ì„œ ì‚´í´ë´„) (3-3) ì—°ê²° ë¦¬ìŠ¤íŠ¸ë¡œ ì €ì¥í•´ì•¼ í•˜ëŠ” ê²½ìš°for (int binCount = 0; ; ++binCount) { if ((e = p.next) == null) { p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; } if (e.hash == hash &amp;&amp; ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) break; p = e;} ë‹¤ìŒ ë…¸ë“œë¥¼ ê°€ë¦¬í‚¤ëŠ” p.nextë¥¼ í†µí•´ ì—°ê²° ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒ ë™ì¼í•œ í‚¤ë¥¼ ì°¾ì•˜ë‹¤ë©´ (4)ì—ì„œ ê¸°ì¡´ ê°’ì„ í˜„ì¬ ê°’ìœ¼ë¡œ ë®ì–´ì“´ë‹¤. ë™ì¼í•œ í‚¤ë¥¼ ì°¾ì§€ ëª»í•˜ë©´ ì—°ê²° ë¦¬ìŠ¤íŠ¸ì˜ ë§ˆì§€ë§‰ ë…¸ë“œì˜ ë‹¤ìŒ(p.next)ì— ìƒˆë¡œìš´ ë…¸ë“œ ì¶”ê°€ ë…¸ë“œ ì¶”ê°€ì‹œ ì—°ê²° ë¦¬ìŠ¤íŠ¸ì˜ í¬ê¸°ê°€ 8ì´ ëœë‹¤ë©´ TreeNode êµ¬ì¡°ë¡œ ë³€ê²½ (4) ê¸°ì¡´ í‚¤ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš° ê°’ ë®ì–´ì“°ê¸°if (e != null) { // existing mapping for key V oldValue = e.value; if (!onlyIfAbsent || oldValue == null) e.value = value; afterNodeAccess(e); return oldValue;} ê¸°ì¡´ í‚¤ê°€ ì¡´ì¬í•˜ë©´(eê°€ nullì´ ì•„ë‹˜) ê°’ì„ ë®ì–´ì”Œìš´ë‹¤. onlyIfAbsentê°€ trueì´ë©´ ê¸°ì¡´ ê°’ì´ ì—†ì„ ë•Œë§Œ ë³€ê²½. afterNodeAccess(e)ëŠ” LRU ìºì‹œ ê°™ì€ êµ¬ì¡°ì—ì„œ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤.(5) HashMap í¬ê¸° ì¦ê°€ ë° ë¦¬ì‚¬ì´ì§•++modCount;if (++size &gt; threshold) resize(); modCountëŠ” êµ¬ì¡°ì  ë³€ê²½(ì‚½ì…/ì‚­ì œ ë“±) íšŸìˆ˜ë¥¼ ì˜ë¯¸í•˜ë©°, ë°˜ë³µë¬¸ì—ì„œ ë³€ê²½ ê°ì§€ë¥¼ ìœ„í•´ ì‚¬ìš©ëœë‹¤. size(í˜„ì¬ ìš”ì†Œ ê°œìˆ˜)ê°€ threshold(ìš©ëŸ‰ * loadFactor)ë³´ë‹¤ í¬ë©´ í•´ì‹œ í…Œì´ë¸”ì„ ë‘ ë°°ë¡œ í™•ì¥í•œë‹¤.(6) í›„ì²˜ë¦¬ ë° ë°˜í™˜afterNodeInsertion(evict);return null; afterNodeInsertion(evict)ëŠ” LRU ìºì‹œ ê°™ì€ ê²½ìš° íŠ¹ì • ì¡°ê±´ì—ì„œ ë…¸ë“œë¥¼ ì œê±°í•  ë•Œ ì‚¬ìš©ëœë‹¤. ìƒˆ ê°’ì„ ì¶”ê°€í•œ ê²½ìš° nullì„ ë°˜í™˜í•œë‹¤.ê¶ê¸ˆí•œ ë¶€ë¶„1. HashMapì˜ ì—°ê²° ë¦¬ìŠ¤íŠ¸ì™€ LinkedList ë¹„êµ ë¹„êµ í•­ëª© HashMapì˜ ì—°ê²° ë¦¬ìŠ¤íŠ¸ LinkedList (Java java.util.LinkedList) ëª©ì  í•´ì‹œ ì¶©ëŒ í•´ê²° (ì²´ì´ë‹) ì¼ë°˜ì ì¸ ìë£Œêµ¬ì¡° í™œìš© ì‚¬ìš© ë°©ì‹ Node&lt;K,V&gt;ì˜ next í•„ë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì§ì ‘ ì—°ê²° ë¦¬ìŠ¤íŠ¸ êµ¬í˜„ Node&lt;E&gt; í´ë˜ìŠ¤ë¥¼ ë‚´ë¶€ì ìœ¼ë¡œ ì‚¬ìš© ì´ì¤‘ ì—°ê²° ë¦¬ìŠ¤íŠ¸ ì—¬ë¶€ X O 2. binCount, treeifyBinì—ì„œ ì“°ëŠ” binì´ë€ ? 3-3 ì½”ë“œfor (int binCount = 0; ; ++binCount) { if ((e = p.next) == null) { p.next = newNode(hash, key, value, null); if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st treeifyBin(tab, hash); break; } ...slot, bin, bucket ìš©ì–´ ì •ë¦¬slot slotì€ ì¼ë°˜ì ì¸ í•´ì‹œ í…Œì´ë¸” ê°œë…ì—ì„œ í•´ì‹œ í…Œì´ë¸”ì˜ ì¸ë±ìŠ¤ í•˜ë‚˜ë¥¼ ì˜ë¯¸ ì˜ˆë¥¼ ë“¤ì–´, table[3]ì— ê°’ì´ ì €ì¥ë˜ì—ˆë‹¤ë©´ 3ë²ˆ ìŠ¬ë¡¯(slot)ì— ì €ì¥ëœê²ƒbin(=bucket) HashMapì„ ì„¤ëª…í•  ë•Œ ë³´í†µ bucketì´ë¼ëŠ” ë‹¨ì–´ë¥¼ ë§ì´ ì‚¬ìš© table[index]ì— ì—¬ëŸ¬ ê°œì˜ ê°’ì´ ì €ì¥ë  ê²½ìš°, ì´ ê³µê°„ì„ bucket(ë²„í‚·)ì´ë¼ê³  ë¶€ë¥¸ë‹¤. ì¦‰, bin(bucket)ì€ ê°™ì€ í•´ì‹œê°’ì„ ê°€ì§„ ë…¸ë“œë“¤ì´ ì €ì¥ë˜ëŠ” ê³µê°„ HashMap ë‚´ë¶€ (ë°°ì—´ + ì—°ê²° ë¦¬ìŠ¤íŠ¸)Index (Slot) Bucket (bin) ë‚´ìš©-----------------------------------table[0] â†’ nulltable[1] â†’ (5, \"X\") -&gt; (15, \"Y\") -&gt; nulltable[2] â†’ (10, \"A\") -&gt; (20, \"B\") -&gt; nulltable[3] â†’ (30, \"C\") -&gt; nulltable[4] â†’ nullë²„í‚· ì¶©ëŒ ? ì—„ë°€íˆ ë§í•˜ë©´ â€œìŠ¬ë¡¯ì´ ì¶©ëŒí•œë‹¤â€ëŠ” í‘œí˜„ì´ ë” ì •í™•í•˜ì§€ë§Œ, â€œë²„í‚·ì— ì¶©ëŒì´ ë°œìƒí•œë‹¤â€ëŠ” í‘œí˜„ì´ ì¼ë°˜ì ìœ¼ë¡œ ë§ì´ ì‚¬ìš©ë¨" }, { "title": "API í˜¸ì¶œì‹œ íƒ€ì„ì•„ì›ƒì´ ë°œìƒí•˜ë©´ ? (caller ê´€ì ì—ì„œ)", "url": "/posts/response-timeout(caller)/", "categories": "ìƒê°í•´ë³´ê¸°, what-if", "tags": "", "date": "2025-01-25 00:29:00 +0900", "snippet": "ìƒí™© ê°€ì • ì‚¬ìš©ì ìš”ì²­ì„ ì²˜ë¦¬í•  ë•Œ ì™¸ë¶€ API í˜¸ì¶œì´ í•„ìš”í•˜ê³ , í•´ë‹¹ API(api/foo) í˜¸ì¶œì— ëŒ€í•´ íƒ€ì„ì•„ì›ƒì´ ë°œìƒ (client ---&gt; ë‚´ ì„œë²„ ---X ì™¸ë¶€ ì„œë²„) ìƒê°í•´ë³¼ ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ íƒ€ì„ì•„ì›ƒ ìƒí™© ì™¸ë¶€ ì„œë²„ì—ì„œ api/fooì— ëŒ€í•œ ì²˜ë¦¬ê°€ ëŠ¦ì–´ì§ api/foo ìš”ì²­ì´ ì™¸ë¶€ ì„œë²„ì— ëŠ¦ê²Œ ë„ì°© ...", "content": "ìƒí™© ê°€ì • ì‚¬ìš©ì ìš”ì²­ì„ ì²˜ë¦¬í•  ë•Œ ì™¸ë¶€ API í˜¸ì¶œì´ í•„ìš”í•˜ê³ , í•´ë‹¹ API(api/foo) í˜¸ì¶œì— ëŒ€í•´ íƒ€ì„ì•„ì›ƒì´ ë°œìƒ (client ---&gt; ë‚´ ì„œë²„ ---X ì™¸ë¶€ ì„œë²„) ìƒê°í•´ë³¼ ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ íƒ€ì„ì•„ì›ƒ ìƒí™© ì™¸ë¶€ ì„œë²„ì—ì„œ api/fooì— ëŒ€í•œ ì²˜ë¦¬ê°€ ëŠ¦ì–´ì§ api/foo ìš”ì²­ì´ ì™¸ë¶€ ì„œë²„ì— ëŠ¦ê²Œ ë„ì°© api/fooì— ëŒ€í•œ ì‘ë‹µì´ ë‚´ ì„œë²„ì— ë„ì°©í•˜ì§€ ì•Šê±°ë‚˜ ëŠ¦ê²Œ ë„ì°©í•¨ ê¸°íƒ€ ë“±ë“±â€¦ ê°€ì¥ ì‹¬í”Œí•œ ì¼€ì´ìŠ¤ api/fooì— ëŒ€í•œ ì‘ë‹µ ì—†ì´ ì‚¬ìš©ì ìš”ì²­ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•œ ê²½ìš° íŠ¹ì • ë°ì´í„°ëŠ” ë¹ˆ ìƒíƒœë¡œ ì¡°íšŒ ì‘ë‹µ ë‚´ë ¤ì¤„ ìˆ˜ ìˆëŠ” ìƒí™© ë˜ëŠ”, ì •ì±…ì ìœ¼ë¡œ í˜‘ì˜ê°€ ë˜ì–´ì„œ api/fooì— ëŒ€í•œ ì¬ì‹œë„ê°€ í•„ìš”í•˜ì§€ ì•Šì€ ìƒí™©ì¡°ê¸ˆ ë” ìƒê°ì´ í•„ìš”í•œ ì¼€ì´ìŠ¤ ìš”ì²­ì„ ì²˜ë¦¬í•˜ë ¤ë©´ api/fooì— ëŒ€í•œ ì‘ë‹µì´ ë°˜ë“œì‹œ í•„ìš”í•œ ê²½ìš° (ì¦‰, ì¬ì‹œë„ í•„ìš”)api/fooê°€ ë©±ë“±ì„±ì´ ë³´ì¥ë˜ëŠ” APIë¼ë©´ ? ì‚¬ìš©ì ìš”ì²­ì´ ì²˜ë¦¬ë¼ì•¼í•˜ëŠ” ì „ì²´ ì‹œê°„ì„ ê³ ë ¤í•˜ì—¬ ë°”ë¡œ ì¬ì‹œë„í•˜ê±°ë‚˜ ë˜ëŠ” ì‚¬ìš©ìì—ê²Œ â€œì ì‹œ í›„ ì¬ì‹œë„í•´ì£¼ì„¸ìš”â€ ë“±ì˜ ì‘ë‹µì„ ë‚´ë ¤ì¤€ë‹¤.api/fooê°€ ë©±ë“±ì„±ì´ ë³´ì¥ë˜ì§€ ì•ŠëŠ” APIë¼ë©´ ? ì™¸ë¶€ ì„œë²„ì™€ í˜‘ì˜í•œ í‚¤ ê°’ì„ í†µí•´ api/fooì˜ ì²˜ë¦¬ ìƒíƒœë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆëŠ” API(api/bar) í˜¸ì¶œ ì¦‰, ì‚¬ìš©ì ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë¡œì§ì—ì„œ api/foo í˜¸ì¶œ ì „ api/barë¥¼ í˜¸ì¶œí•˜ëŠ” ë¡œì§ì´ ìˆì–´ì•¼ë¨ api/barì˜ ì²˜ë¦¬ ìƒíƒœ í™•ì¸ í›„ ì‹¤íŒ¨ì´ë©´ ì¬ì‹œë„, ì„±ê³µì´ë©´ ì‚¬ìš©ì ìš”ì²­ì— ëŒ€í•œ ë‚˜ë¨¸ì§€ ë¡œì§ ì²˜ë¦¬ â€˜ì‹¤íŒ¨â€™ì¸ ê²½ìš° ì¬ì‹œë„ ê°€ëŠ¥í•œ ê²½ìš°, ì¬ì‹œë„ ê°€ëŠ¥í•˜ì§€ ì•Šì€ ê²½ìš°ê¹Œì§€ êµ¬ë¶„ì´ ê°€ëŠ¥í•˜ë‹¤ë©´ ì´ ë¶€ë¶„ë„ í˜‘ì˜í•˜ë©´ ì¢‹ì„ ê²ƒìœ¼ë¡œ ìƒê° ë§Œì•½ api/barë¡œ ì¡°íšŒí•œ ìƒíƒœê°€ â€˜ì²˜ë¦¬ì¤‘â€™ì´ë©´ ? ì‚¬ìš©ìì—ê²Œ â€œì²˜ë¦¬ê°€ ì§€ì—°ë˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”.â€ ë“±ì˜ ì‘ë‹µì„ ë‚´ë ¤ì¤€ë‹¤. ë§Œì•½ ê³„ì† â€˜ì²˜ë¦¬ì¤‘â€™ì¸ ìƒí™©ì´ ì§€ì†ë˜ëŠ” ê²½ìš°, ì™¸ë¶€ ì„œë²„ì™€ í˜‘ì˜ëœ ì‹œê°„ì´ ì§€ë‚˜ë©´ ì¬ì‹œë„ë¥¼ í•œë‹¤ë˜ì§€ ì™¸ë¶€ì‚¬ì— ë¬¸ì˜í•œë‹¤ë˜ì§€ ë“±ì˜ ì •ì±…ì´ í•„ìš”í•  ê²ƒìœ¼ë¡œ ìƒê° ë§Œì•½ api/barë¡œ ì¡°íšŒí–ˆëŠ”ë° ê°’ì´ ì—†ë‹¤ë©´ ? api/foo ìš”ì²­ì´ ìœ ì‹¤ëê±°ë‚˜, api/barë¡œ ì¡°íšŒí•œ ì‹œì ë³´ë‹¤ ëŠ¦ê²Œ ì™¸ë¶€ ì„œë²„ì— ë„ì°©í•œ ê²½ìš° ìœ„ì—ì„œ ì‚´í´ë³¸ ëª¨ë“  ìƒí™©ì—ì„œ í˜‘ì˜ê°€ í•„ìš”í•˜ê² ì§€ë§Œ, ì´ ì¼€ì´ìŠ¤ëŠ” ë°˜ë“œì‹œ í•„ìš”í•˜ë‹¤ê³  ìƒê° í˜‘ì˜ë¥¼ í•œë‹¤ë©´ ì–´ë–¤ ë¶€ë¶„ì— ëŒ€í•´ í•  ìˆ˜ ìˆì„ê¹Œ ? ì¬ì‹œë„í–ˆì„ë•Œ ë©±ë“±ì„±ì´ ë³´ì¥ë˜ë„ë¡ ê²°ê³¼ ì—†ìŒì— ëŒ€í•œ ìš”ì²­ì„ ë”°ë¡œ ë³´ê´€ (íŠ¹ì • ì‹œê°„ì´ ê²½ê³¼í•˜ë©´) ìš´ì˜íŒ€ì—ì„œ í•´ë‹¹ ì—…ì²´ì™€ ì—°ë½í•´ì„œ í™•ì¸ ê¸°íƒ€ ë“±ë“±.. ê´€ë ¨ ê¸€ ì°¾ì•„ë³´ê¸°1. zalando ê¸°ìˆ  ë¸”ë¡œê·¸íƒ€ì„ì•„ì›ƒ ê°’ ì„¤ì • ê´€ë ¨ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ ì¤‘ ë¹„íš¨ìœ¨ì ìœ¼ë¡œ ê¸´ íƒ€ì„ì•„ì›ƒì´ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •ëœ ê²½ìš°ë“¤ë„ ìˆë‹¤ íƒ€ì„ì•„ì›ƒì„ ìµœëŒ€ê°’(p99.9)ìœ¼ë¡œ ì„¤ì • íƒ€ì„ì•„ì›ƒì„ ìµœëŒ€í•œ ê¸¸ê²Œ ì„¤ì •í•˜ì—¬ ê±°ì˜ ëª¨ë“  ìš”ì²­ì´ ì‘ë‹µì„ ë°›ì„ ìˆ˜ ìˆë„ë¡ í•¨. ê²°ê³¼ì ìœ¼ë¡œ False Timeout Rateë¥¼ 0.1%ë¡œ ìœ ì§€. íƒ€ì„ì•„ì›ƒì„ ì§§ê²Œ ì„¤ì •í•˜ê³  ì¬ì‹œë„ë¥¼ í™œì„±í™” íƒ€ì„ì•„ì›ƒì„ p99.9ë³´ë‹¤ ë‚®ê²Œ ì„¤ì •í•´ ë¹ ë¥´ê²Œ ì‹¤íŒ¨ë¥¼ ê°ì§€í•˜ê³ , í•„ìš”í•œ ê²½ìš° ìš”ì²­ì„ ì¬ì‹œë„. ë‹¨, ì§§ì€ íƒ€ì„ì•„ì›ƒì€ ì‹¤íŒ¨ë¥¼ ë” ìì£¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì¬ì‹œë„ ì •ì±…ì„ ì‹ ì¤‘íˆ ì„¤ê³„í•´ì•¼ í•¨. ì¬ì‹œë„ ê´€ë ¨ ë©±ë“±ì„±ì´ ë³´ì¥ë˜ëŠ” APIëŠ” ì•ˆì „í•˜ê²Œ ì¬ì‹œë„ ê°€ëŠ¥ ê·¸ë ‡ì§€ ì•Šì€ APIëŠ” ì¬ì‹œë„í•˜ëŠ” ê²½ìš° ë°ì´í„° ì¼ê´€ì„±ì´ ê¹¨ì§€ëŠ” ë“±ì˜ ì´ìŠˆê°€ ìˆì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— Idempotency-Key í—¤ë” ë“±ì„ ì´ìš©í•´ì„œ ë©±ë“±ì„±ì„ ë³´ì¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì‘ì—…í•˜ëŠ” ê²ƒì„ ì¶”ì²œ ì„œí‚· ë¸Œë ˆì´ì»¤ë¥¼ ì‚¬ìš©í•´ì„œ ì¬ì‹œë„ê°€ ë„ˆë¬´ ë§ì€ ë¶€í•˜ë¥¼ ìœ ë°œí•˜ëŠ” ê²ƒì„ ë°©ì§€ Exponential backoff (ì§€ìˆ˜ì  ì¬ì‹œë„) ë°©ì‹ì„ í†µí•´ ì¬ì‹œë„ ê°„ê²©ì„ ëŠ˜ë¦°ë‹¤. ì¬ì‹œë„í•˜ê¸° ì í•©í•œ ìƒí™© p50ê³¼ p99 ì‚¬ì´ì˜ ì°¨ì´ê°€ í¼ ì¦‰, ëŒ€ë¶€ë¶„ì˜ ìš”ì²­ì€ ì •ìƒì ì¸ ì†ë„ë¡œ ì‘ë‹µí•˜ì§€ë§Œ, ì¼ë¶€ ìš”ì²­ì´ ë¹„ì •ìƒì ìœ¼ë¡œ ì§€ì—°ë˜ëŠ” ê²½ìš°. ë„¤íŠ¸ì›Œí¬ ì¼ì‹œì  ì§€ì—° ë“±ì¼ í™•ë¥ ì´ ë†’ê¸° ë•Œë¬¸ì— ë‹¤ìŒ ìš”ì²­ì€ ì •ìƒ ì†ë„ë¡œ ì²˜ë¦¬ë  ê°€ëŠ¥ì„±ì´ ë†’ìŒ ì¬ì‹œë„í•˜ê¸° ì í•©í•˜ì§€ ì•Šì€ ìƒí™© p50ê³¼ p99ê°€ ë¹„ìŠ·í•œ ê²½ìš° ì¦‰, íŠ¹ì • ìš”ì²­ë§Œ ëŠë¦° ê²Œ ì•„ë‹ˆë¼, ì „ì²´ì ìœ¼ë¡œ ëŠë¦° êµ¬ì¡°ì ì¸ ë¬¸ì œê°€ ì¡´ì¬í•  í™•ë¥ ì´ ë†’ìŒ ì¬ì‹œë„ë³´ë‹¤ëŠ” íƒ€ì„ì•„ì›ƒ ê°’ì„ ìµœì í™”í•˜ê±°ë‚˜, ì‹œìŠ¤í…œ ìì²´ë¥¼ íŠœë‹í•˜ëŠ” ê²ƒì´ ë” íš¨ê³¼ì ì¼ ìˆ˜ ìˆìŒ 2. AWSê¸€ ì‹¤íŒ¨ í™•ë¥ ì„ ì¤„ì´ë„ë¡ ì‹œìŠ¤í…œì„ ì„¤ê³„í•˜ì§€ë§Œ ê²°ì½” ì‹¤íŒ¨í•˜ì§€ ì•ŠëŠ” ì‹œìŠ¤í…œì„ êµ¬ì¶•í•˜ëŠ” ê²ƒì€ ë¶ˆê°€ëŠ¥ Amazonì—ì„œëŠ” ì‹¤íŒ¨ í™•ë¥ ì„ í—ˆìš©í•˜ê³  ì¤„ì´ê³ , ì‘ì€ ë¹„ìœ¨ì˜ ì‹¤íŒ¨ê°€ ì™„ì „í•œ ì¤‘ë‹¨ìœ¼ë¡œ í™•ëŒ€ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ë„ë¡ ì‹œìŠ¤í…œì„ ì„¤ê³„ íƒ€ì„ì•„ì›ƒì„ ì •í•˜ëŠ” ì¢‹ì€ ê¸°ì¤€ì€ p99.9ì™€ ê°™ì€ ì§€í‘œë“¤ì´ ìˆë‹¤. ëŒ€ë¶€ë¶„ì˜ ê²½ìš°ì—ëŠ” ì˜ ì‘ë™í•˜ì§€ë§Œ ëª‡ ê°€ì§€ í•¨ì •ì´ ìˆë‹¤. p99.9ì™€ p50ì˜ ì§€ì—° ê°’ì´ ë¹„ìŠ·í•œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ì í•©í•˜ì§€ ì•ŠìŒì–´ë–¤ ì„œë¹„ìŠ¤ëŠ” ì§€ì—° ê°’ì˜ ë¶„í¬ê°€ ë§¤ìš° ë¹¡ë¹¡í•´ì„œ p99.9 ê°’ì´ p50(í‰ê· ì ì¸ ì§€ì—°) ê°’ì— ê·¼ì ‘í•œ ê²½ìš°ê°€ ìˆìŠµë‹ˆë‹¤. ì´ëŸ° ê²½ìš°, íƒ€ì„ì•„ì›ƒ ê°’ì— ì•½ê°„ì˜ ì—¬ìœ (padding)ë¥¼ ë”í•´ì„œ, ì‘ì€ ì§€ì—° ì¦ê°€ë¡œ ì¸í•´ ëŒ€ëŸ‰ì˜ íƒ€ì„ì•„ì›ƒì´ ë°œìƒí•˜ëŠ” ê²ƒì„ ë°©ì§€í•©ë‹ˆë‹¤. íƒ€ì„ì•„ì›ƒì— ëŒ€í•œ ì¬ì‹œë„ì‹œ ìƒê°í•´ë³¼ ê²ƒë“¤ ì¼ì‹œì ì¸ ì—ëŸ¬ë¼ë©´ ì¬ì‹œë„í•´ì„œ ì„±ê³µí•  ìˆ˜ë„ ìˆê² ì§€ë§Œ ê·¸ê²Œ ì•„ë‹ˆë¼ ë¶€í•˜ê°€ ë§ì´ ëª°ë¦° ìƒí™©ì´ë¼ë©´ ì¬ì‹œë„ ìš”ì²­ë“¤ì´ ë¶€í•˜ë¥¼ ê°€ì¤‘ì‹œì¼œ ìƒí™©ì„ ë” ì•…í™”ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ì—¬ëŸ¬ ë§ˆì´í¬ë¡œ ì„œë¹„ìŠ¤ë¥¼ ê±°ì¹˜ëŠ” ìš”ì²­ì´ë¼ë©´, DBì— ë¶€í•˜ê°€ ë” ë§ì´ ê°ˆ ìˆ˜ ìˆë‹¤. ì¬ì‹œë„ í• ë§Œí•œ ê°€ì¹˜ê°€ ìˆëŠ”ì§€ (4xx ì—ëŸ¬, 5xx ì—ëŸ¬ ë“±) ì‹¤íŒ¨í•œ ëª¨ë“  ìš”ì²­ì´ ê°™ì€ ì‹œê°„ì— ë°±ì˜¤í”„ í›„ ì¬ì‹œë„ë¥¼ í•˜ë©´, ë‹¤ì‹œ í•œ ë²ˆ ê³¼ë¶€í•˜ë‚˜ ê²½ìŸì´ ë°œìƒí•  ìˆ˜ ìˆìŒ ì§€í„°ëŠ” ë°±ì˜¤í”„ì— ì¼ì •í•œ ëœë¤ì„±(randomness)ì„ ì¶”ê°€í•˜ì—¬ ì¬ì‹œë„ê°€ ì‹œê°„ì ìœ¼ë¡œ ë¶„ì‚°ë˜ë„ë¡ ë§Œë“œëŠ” ë°©ë²•ì…ë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ìš”ì²­ì´ íŠ¹ì • ì‹œê°„ì— ëª°ë¦¬ì§€ ì•Šê²Œ ë˜ì–´ ê³¼ë¶€í•˜ ë¬¸ì œë¥¼ ì™„í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë” ë‚˜ì•„ê°€, ì§€í„°ëŠ” ì¬ì‹œë„ë¿ ì•„ë‹ˆë¼ ëª¨ë“  ì£¼ê¸°ì ì¸ ì‘ì—…(timers, periodic jobs ë“±)ì—ë„ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 3. AWSê¸€ì¬ì‹œë„ì‹œ ì¤‘ë³µ ì²˜ë¦¬ë¥¼ ë°©ì§€í•˜ëŠ” ë°©ë²• Amazonì€ API ê³„ì•½ì— ê³ ìœ í•œ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ ì‹ë³„ìë¥¼ í¬í•¨ì‹œí‚¤ëŠ” ë°©ì‹ì„ ì„ í˜¸ ì´ë¯¸ ìƒì„±ëœ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ ì¬ì‹œë„ í•˜ëŠ” ê²½ìš° ì„œë¹„ìŠ¤ëŠ” â€œë¦¬ì†ŒìŠ¤ê°€ ì´ë¯¸ ì¡´ì¬í•œë‹¤(ResourceAlreadyExists)â€ëŠ” ì‘ë‹µì„ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤. ì´ëŸ° ì‘ë‹µì€ ê¸°ë³¸ì ìœ¼ë¡œ ë©±ë“±ì„±ì„ ë§Œì¡±í•˜ì§€ë§Œ, í´ë¼ì´ì–¸íŠ¸ì—ê²Œ í˜¼ë€ì„ ì¤„ ìˆ˜ ìˆë‹¤. ì¦‰, ì´ë²ˆ ìš”ì²­ìœ¼ë¡œ ì¸í•´ ë¦¬ì†ŒìŠ¤ê°€ ìƒì„±ëœ ê²ƒì¸ì§€, ì´ì „ ìš”ì²­ì˜ ê²°ê³¼ë¡œ ìƒì„±ëœ ê²ƒì¸ì§€ ì•Œ ìˆ˜ ì—†ìŒ ë”°ë¼ì„œ í´ë¼ì´ì–¸íŠ¸ëŠ” â€œë¦¬ì†ŒìŠ¤ê°€ ì´ë¯¸ ì¡´ì¬í•˜ëŠ”â€ ìƒí™©ì„ ë³„ë„ë¡œ ì²˜ë¦¬í•´ì•¼ í•˜ë©°, ì´ëŠ” í´ë¼ì´ì–¸íŠ¸ ì½”ë“œì˜ ë³µì¡ì„±ì„ ì¦ê°€ì‹œí‚´ ë©±ë“±ì„± ì„¤ê³„ ë°©ì‹ ìš”ì²­ì˜ íŒŒë¼ë¯¸í„°ë¥¼ í•´ì‹œ(hash)ë¡œ ë³€í™˜í•˜ì—¬ ì¤‘ë³µ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ëŠ” ë°©ë²•ì´ ìˆìŒ. í•˜ì§€ë§Œ, ì´ ë°©ë²•ì´ í•­ìƒ ìœ íš¨í•˜ì§€ ì•ŠìŒ. ì˜ˆ: EC2 ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ìš”ì²­ì´ë¼ë©´? â†’ ë™ì¼í•œ ìš”ì²­ì´ë”ë¼ë„, ì‚¬ìš©ìëŠ” ì‹¤ì œë¡œ ë‘ ê°œì˜ EC2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì›í•  ìˆ˜ë„ ìˆìŒ. ë”°ë¼ì„œ, ê° API ìš”ì²­ì— ê³ ìœ í•œ ìš”ì²­ ì‹ë³„ì(Client Token)ë¥¼ ì¶”ê°€í•˜ë„ë¡ ì„¤ê³„. ì¦‰, ë™ì¼í•œ Client Tokenì„ ê°€ì§„ ìš”ì²­ì€ ë™ì¼í•œ ì‘ì—…ìœ¼ë¡œ ê°„ì£¼. ìš”ì²­ì„ ì²˜ìŒ ë°›ì„ ë•Œ Client Tokenì„ ê¸°ë¡ ì‘ì—…ì´ ì›ìì ìœ¼ë¡œ ì‹¤í–‰ë˜ë„ë¡ ë³´ì¥ ë™ì¼í•œ Client Tokenì„ ê°€ì§„ ìš”ì²­ì´ ë‹¤ì‹œ ë“¤ì–´ì˜¤ë©´, ê°™ì€ ì‘ë‹µì„ ë°˜í™˜ ë¶„ì‚° ì‹œìŠ¤í…œì—ì„œ ìš”ì²­ì´ ì§€ì—°ë˜ì–´ ë„ì°©í•˜ëŠ” ê²½ìš°, ë©±ë“±ì„± ì²˜ë¦¬ ê³¼ì •ì—ì„œ ë³µì¡í•œ ìƒí™©ì´ ë°œìƒí•  ìˆ˜ ìˆìŒ ì˜ˆë¥¼ ë“¤ì–´ : ì²« ë²ˆì§¸ ìš”ì²­ì´ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•¨. ë‘ ë²ˆì§¸ ìš”ì²­ì´ ì¬ì‹œë„ë˜ê¸° ì „ì— ëˆ„êµ°ê°€ ë¦¬ì†ŒìŠ¤ë¥¼ ì‚­ì œí•¨. ì¬ì‹œë„ëœ ìš”ì²­ì´ ë„ì°©í–ˆì„ ë•Œ, ì„œë¹„ìŠ¤ëŠ” ì–´ë–»ê²Œ ë°˜ì‘í•´ì•¼ í• ê¹Œ? AWSì˜ í•´ê²°ì±… Amazon EC2 RunInstancesì˜ ê²½ìš°, ì´ëŸ¬í•œ ìƒí™©ì—ì„œë„ ìµœì´ˆì˜ ë©±ë“±ì„± ê³„ì•½(idempotent contract)ì„ ì¡´ì¤‘ ì¦‰, ì‚­ì œëœ ë¦¬ì†ŒìŠ¤ì˜ ìƒíƒœë¥¼ ë°˜ì˜í•˜ë˜, ì˜ë¯¸ì ìœ¼ë¡œ ë™ì¼í•œ ì‘ë‹µì„ ë°˜í™˜í•¨ìœ¼ë¡œì¨ ê³ ê°ì´ í˜¼ë€ìŠ¤ëŸ¬ì›Œí•˜ì§€ ì•Šë„ë¡ í•©ë‹ˆë‹¤. Client Token ì €ì¥ ì´ìŠˆ ë„ˆë¬´ ì˜¤ë˜ ë³´ê´€í•˜ë©´ ì´ì „ ìš”ì²­ê³¼ì˜ ì‹ë³„ì ì¶©ëŒ ë¬¸ì œê°€ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ìˆìŒ. ì„œë¹„ìŠ¤ ë° ë¦¬ì†ŒìŠ¤ ìœ í˜•ì— ë”°ë¼ ë©±ë“±ì„± ì •ë³´ ìœ ì§€ ê¸°ê°„ì´ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ. EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ê²½ìš°, ì •ë³´ ìœ ì§€ ê¸°ê°„ì„ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ì˜ ìƒì•  ì£¼ê¸°(lifetime) + ì¶”ê°€ì ì¸ ì¼ì • ê¸°ê°„ìœ¼ë¡œ ì œí•œ. ì´ë ‡ê²Œ í•˜ë©´ ëŠ¦ê²Œ ë„ì°©í•˜ëŠ” ìš”ì²­(ì¬ì‹œë„ ìš”ì²­ í¬í•¨)ì´ ë„ì°©í•  ê°€ëŠ¥ì„±ì´ ìˆëŠ” ê¸°ê°„ê¹Œì§€ë§Œ ì •ë³´ë¥¼ ìœ ì§€í•˜ê³ , ì´í›„ì—ëŠ” ì œê±°í•˜ì—¬ ë¶ˆí•„ìš”í•œ ì¶©ëŒì„ ë°©ì§€í•¨. " }, { "title": "DB ë¡¤ì²´ì¸ì§€ í›„ ì• í”Œë¦¬ì¼€ì´ì…˜ í—¬ìŠ¤ì²´í¬ê°€ ì •ìƒì ìœ¼ë¡œ ë˜ì§€ ì•Šì€ ì´ìŠˆ (feat. DB ì»¤ë„¥ì…˜ í’€)", "url": "/posts/after-db-role-change-issue/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "DBCP", "date": "2024-10-14 22:25:00 +0900", "snippet": "ìƒí™© L4/L7 ìŠ¤ìœ„ì¹˜ --- WEB --- WAS(ì• í”Œë¦¬ì¼€ì´ì…˜)ë¡œ êµ¬ì„±ëœ í™˜ê²½ì—ì„œ 2~3ì´ˆ ê°„ê²©ìœ¼ë¡œ L4/L7 ìŠ¤ìœ„ì¹˜ì—ì„œ í—¬ìŠ¤ì²´í¬ ì‹ í˜¸ë¥¼ ë³´ëƒ„ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í—¬ìŠ¤ì²´í¬ë¥¼ ìœ„í•´ DBì— SELECT 1 ì§ˆì˜í•˜ê²Œ ë˜ì–´ìˆìŒ ì¸í”„ë¼íŒ€ ì‘ì—… ì´ìŠˆë¡œ ë§ˆìŠ¤í„° DB ì„œë²„ ë©”ëª¨ë¦¬ ì ìœ ìœ¨ì´ ë„ˆë¬´ ë†’ì•„ì ¸ DBê°€ ë¡¤ì²´ì¸ì§€ ë¨(ì•½ 12ì´ˆ ì •ë„ ì†Œìš”) ë¡¤ì²´ì¸ì§€ ë˜ì—ˆëŠ”ë°ë„...", "content": "ìƒí™© L4/L7 ìŠ¤ìœ„ì¹˜ --- WEB --- WAS(ì• í”Œë¦¬ì¼€ì´ì…˜)ë¡œ êµ¬ì„±ëœ í™˜ê²½ì—ì„œ 2~3ì´ˆ ê°„ê²©ìœ¼ë¡œ L4/L7 ìŠ¤ìœ„ì¹˜ì—ì„œ í—¬ìŠ¤ì²´í¬ ì‹ í˜¸ë¥¼ ë³´ëƒ„ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í—¬ìŠ¤ì²´í¬ë¥¼ ìœ„í•´ DBì— SELECT 1 ì§ˆì˜í•˜ê²Œ ë˜ì–´ìˆìŒ ì¸í”„ë¼íŒ€ ì‘ì—… ì´ìŠˆë¡œ ë§ˆìŠ¤í„° DB ì„œë²„ ë©”ëª¨ë¦¬ ì ìœ ìœ¨ì´ ë„ˆë¬´ ë†’ì•„ì ¸ DBê°€ ë¡¤ì²´ì¸ì§€ ë¨(ì•½ 12ì´ˆ ì •ë„ ì†Œìš”) ë¡¤ì²´ì¸ì§€ ë˜ì—ˆëŠ”ë°ë„ ì• í”Œë¦¬ì¼€ì´ì…˜ í—¬ìŠ¤ì²´í¬ëŠ” down ìƒíƒœ (DB ì—°ê²°ì´ ê³„ì† ì•ˆë¨) ì• í”Œë¦¬ì¼€ì´ì…˜ ì¬ì‹œì‘í•˜ë‹ˆê¹Œ ë‹¤ì‹œ ì •ìƒ ë™ì‘ ì´í›„ì— DBAê°€ ë¡¤ì²´ì¸ì§€ í–ˆì„ë•Œ ì•½ 2ì´ˆ ì •ë„ ì†Œìš”ë˜ì—ˆê³ , í—¬ìŠ¤ì²´í¬ ì ê¹ down ë˜ì—ˆë‹¤ê°€ ë‹¤ì‹œ ì˜ ì˜¬ë¼ì˜´â€œì™œ ë¡¤ì²´ì¸ì§€ì— 12ì´ˆê°€ ê±¸ë ¸ì„ ë•ŒëŠ” DBê°€ ì •ìƒí™”ë˜ì—ˆëŠ”ë°ë„ ì—°ê²°ì´ ì•ˆëê³ , 2ì´ˆê°€ ê±¸ë ¸ì„ ë•ŒëŠ” ë‹¤ì‹œ ì—°ê²°ì´ ì˜ ëì„ê¹Œ ?â€ì—ëŸ¬ ë¡œê·¸ ì‚´í´ë³´ê¸°ë¡¤ì²´ì¸ì§€ 12ì´ˆ 1, 2, 3 ìˆœì„œëŒ€ë¡œ ë‚˜íƒ€ë‚œ í›„, 3ë²ˆì´ ê³„ì† ë°˜ë³µë¨1. com.mysql.cj.exceptions.CJCommunicationsException: Communications link failure2. java.sql.SQLNonTransientConnectionException: Could not create connection to database server. Attempted reconnect 3 times. Giving up.3. java.sql.SQLNonTransientConnectionException: No operations allowed after connection closed.ë¡¤ì²´ì¸ì§€ 2ì´ˆ com.mysql.cj.jdbc.exceptions.CommunicationsException: Communications link failuredb ê´€ë ¨ ì„¤ì • ì‚´í´ë³´ê¸° db ì ‘ì† ì •ë³´ autoReconnectê°€ ì‚¬ìš©ë˜ê³  ìˆìŒ jdbc:mysql://{ip}:{port}/{db}?autoReconnect=true&amp;useLocalSessionState=true ì»¤ë„¥ì…˜ í’€(í†°ìº£ DBCP) eviction ìŠ¤ë ˆë“œ ê´€ë ¨ ì„¤ì •dataSource.setTestOnBorrow(false);dataSource.setTestOnReturn(false);dataSource.setTestWhileIdle(false);ì›ì¸ íŒŒì•…í•˜ê¸° ë””ë²„ê¹…í•œ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ ê°„ë‹¨í•˜ê²Œ ë‚˜íƒ€ë‚¸ ê·¸ë¦¼ (í‹€ë¦´ ìˆ˜ ìˆìŒ)ë¡¤ì²´ì¸ì§€ 12ì´ˆ ë•Œì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ íë¦„ í•˜ë‚˜ì˜ DB ì»¤ë„¥ì…˜ ê´€ì ì—ì„œì˜ íë¦„ L4ì—ì„œ í—¬ìŠ¤ì²´í¬ ìš”ì²­ ë“¤ì–´ì˜´ -&gt; DBì— ì§ˆì˜ ìš”ì²­ ì§ˆì˜ ì‹¤íŒ¨ ( autoReconnect trueì´ë©´, ë‹¤ìŒ ì§ˆì˜ ë•Œ ì§ˆì˜ ë‚ ë¦¬ê¸° ì „ ë¨¼ì € ping ê²€ì‚¬í•˜ë¼ëŠ” ë³€ìˆ˜(needsPing)ë¥¼ trueë¡œ ë§Œë“¦) Communications link failure ì˜ˆì™¸ ë°œìƒ (health check down) L4ì—ì„œ í—¬ìŠ¤ì²´í¬ ìš”ì²­ ë“¤ì–´ì˜´ -&gt; DBì— ì§ˆì˜ ìš”ì²­ì „ ë¨¼ì € ping ê²€ì‚¬ ìˆ˜í–‰ ping ì‹¤íŒ¨ì‹œ DB ì„¸ì…˜ì— ë‹¤ì‹œ ì—°ê²°(reconnect)í•˜ëŠ” ê³¼ì • ìˆ˜í–‰ (ë¨¼ì € NativeSession close í›„) reconnect ìµœëŒ€ ì¬ì‹œë„ íšŸìˆ˜(default : 3)ê¹Œì§€ ì‹¤íŒ¨ Could not create connection to database server. Attempted reconnect 3 times. Giving up. ì˜ˆì™¸ ë°œìƒ L4ì—ì„œ í—¬ìŠ¤ì²´í¬ ìš”ì²­ ë“¤ì–´ì˜´ -&gt; DB ì§ˆì˜ë¥¼ ìœ„í•´ PreparedStatement ë§Œë“œëŠ” ê³¼ì •ì—ì„œ ì»¤ë„¥ì…˜ì— ë§¤í•‘ëœ NativeSessionì´ ë‹«í˜€ìˆëŠ”ì§€ ë¨¼ì € í™•ì¸ 5ë²ˆì—ì„œ NativeSession closeí•˜ê³  ì¬ì—°ê²°ì—ë„ ì‹¤íŒ¨í–ˆê¸° ë•Œë¬¸ì— NativeSessionì€ ë‹«í˜€ìˆëŠ” ìƒíƒœì´ë¯€ë¡œ, No operations allowed after connection closed. ì˜ˆì™¸ ë°œìƒ ì¦‰,Â NativeSessionë§ŒÂ ì²´í¬í•˜ê³ Â ì˜ˆì™¸Â ë˜ì§€ë¯€ë¡œÂ DBê°€Â ë¡¤ì²´ì¸ì§€Â ë˜ì–´Â ì‚´ì•„ë‚œÂ ê²ƒê³¼ëŠ”Â ê´€ê³„ì—†ì´Â ì§ˆì˜ë¥¼Â í• Â ìˆ˜Â ì—†ê²Œë¨ â€» ë¡¤ì²´ì¸ì§€ 2ì´ˆë•ŒëŠ” 3ë˜ëŠ” 4ì—ì„œ ì„±ê³µí•œ ê²ƒìœ¼ë¡œ ë³´ì„ì‹¤í–‰ íë¦„ ì½”ë“œ ì°¸ê³  1~4 : com.mysql.cj.NativeSession#execSQL 5 : com.mysql.cj.jdbc.ConnectionImpl#connectWithRetries com.mysql.cj.LocalizedErrorMessage.properties 6 : com.mysql.cj.jdbc.ConnectionImpl#prepareStatement,com.mysql.cj.NativeSession#checkClosed com.mysql.cj.LocalizedErrorMessage.propertiesì¡°ì¹˜ ë” ì´ìƒ ìœ íš¨í•˜ì§€ ì•Šì€ DB ì„¸ì…˜ì„ ë¬¼ê³ ìˆëŠ” ì»¤ë„¥ì…˜ì„ ì»¤ë„¥ì…˜ í’€ì—ì„œ ì •ë¦¬ì»¤ë„¥ì…˜ í’€ ì˜µì…˜ ë³€ê²½ AS-ISdataSource.setTestOnBorrow(false);dataSource.setTestOnReturn(false);dataSource.setTestWhileIdle(false); TO-BE PoolCleaner(org.apache.tomcat.jdbc.pool.ConnectionPool.PoolCleaner)ê°€ 5ì´ˆ(timeBetweenEvictionRunsMillis ê¸°ë³¸ê°’)ì— í•œë²ˆì”© idle íì— ìˆëŠ” ì»¤ë„¥ì…˜ë“¤ì˜ DB ì„¸ì…˜ ìœ íš¨ì„± ê²€ì‚¬dataSource.setTestOnBorrow(false);dataSource.setTestOnReturn(false);dataSource.setTestWhileIdle(true);dataSource.setValidationQuery(\"SELECT 1\");dataSource.setMinEvictableIdleTimeMillis(-1);í—¬ìŠ¤ì²´í¬ ë°©ì‹ ë³€ê²½ DBì— ì§ˆì˜í•˜ì§€ ì•Šê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ê³  ìˆëŠ”ì§€ ì—¬ë¶€ë¡œ íŒë‹¨í•˜ë„ë¡ (ìš”ì²­ ìì²´ê°€ ëª»ë“¤ì–´ì˜¤ëŠ” ê²ƒë³´ë‹¤ëŠ” ì„œë²„ ì—ëŸ¬ë¼ê³  ì‘ë‹µ ì£¼ëŠ”ê²Œ ë‚«ë‹¤ê³  ìƒê°)" }, { "title": "MySQLì—ì„œ 4bytes ì´ëª¨ì§€ê°€ ë¬¼ìŒí‘œë¡œ ì €ì¥ë˜ëŠ” ì´ìŠˆ", "url": "/posts/4bytes-emoji-to-question-marks/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "MySQL", "date": "2024-06-04 22:25:00 +0900", "snippet": "ìƒí™© MySQL DBì— ğŸƒì´ëª¨ì§€ ì €ì¥ì‹œ â€˜????â€™ë¡œ ì €ì¥ë˜ì—ˆê³ , connection properties(jdbc urlì— ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ìœ¼ë¡œ ë¶™ëŠ” ê°’ë“¤)ë¥¼ ë³€ê²½í•´ê°€ë©° í…ŒìŠ¤íŠ¸ í•´ ë³¸ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ì•˜ë‹¤. connection properties í˜„ìƒ mysql-connector-j ë²„ì „ mysql ë²„ì „ ...", "content": "ìƒí™© MySQL DBì— ğŸƒì´ëª¨ì§€ ì €ì¥ì‹œ â€˜????â€™ë¡œ ì €ì¥ë˜ì—ˆê³ , connection properties(jdbc urlì— ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ìœ¼ë¡œ ë¶™ëŠ” ê°’ë“¤)ë¥¼ ë³€ê²½í•´ê°€ë©° í…ŒìŠ¤íŠ¸ í•´ ë³¸ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ì•˜ë‹¤. connection properties í˜„ìƒ mysql-connector-j ë²„ì „ mysql ë²„ì „ characterEncoding=UTF-8 ì´ëª¨ì§€ ì €ì¥ ì•ˆë¨ (ì—ëŸ¬ ë°œìƒ) 5.1.12 8.0.35 characterEncoding=UTF-8&amp;connectionCollation=utf8mb4_bin ì´ëª¨ì§€ê°€ ????ë¡œ ì €ì¥ë¨ 5.1.12 8.0.35 characterEncoding=UTF-8&amp;connectionCollation=utf8mb4_bin ì´ëª¨ì§€ ì €ì¥ ì œëŒ€ë¡œ ë¨ 8.0.28 8.0.35 â€» ë“¤ì–´ê°€ê¸° ì „ ì°¸ê³  : ìœ ë‹ˆì½”ë“œëŠ” ë¬¸ìë¥¼ ë§¤í•‘ëœ ì½”ë“œ í¬ì¸íŠ¸ë¡œ ê´€ë¦¬ ì¶œì²˜ : https://www.iemoji.com/view/emoji/256/smileys-people/jack-o-lanternMySQLì— ë¬¸ìê°€ ì €ì¥ë˜ê¸°ê¹Œì§€ì˜ ê³¼ì • ê³µì‹ ë¬¸ì„œ ë° chat gpt ë‹µë³€ ì°¸ê³ í•˜ì—¬ ì¶”ì¸¡ ë‹¤ìŒ ì‹œìŠ¤í…œ ë³€ìˆ˜ê°€ ì¤‘ìš” : character_set_client, character_set_connection ì• í”Œë¦¬ì¼€ì´ì…˜(í´ë¼ì´ì–¸íŠ¸)ì—ì„œ ì¿¼ë¦¬ë¬¸ ë³´ëƒ„ ì„œë²„ì—ì„œëŠ” ìˆ˜ì‹ í•œ ì¿¼ë¦¬ë¬¸ì„ character_set_clientì— ì •ì˜ëœ ë°©ì‹ìœ¼ë¡œ ë””ì½”ë”©í•˜ì—¬ ìœ ë‹ˆì½”ë“œ ì½”ë“œ í¬ì¸íŠ¸ë¡œ ë§Œë“¦ ë§Œë“¤ì–´ì§„ ì½”ë“œ í¬ì¸íŠ¸ë¥¼ character_set_connectionì— ì •ì˜ëœ ë°©ì‹ìœ¼ë¡œ ì¸ì½”ë”©í•˜ì—¬ ìµœì¢… ê°’ ì €ì¥ ë‚´ìš© ì¶”ê°€ : í¬ìŠ¤íŒ…1ê³¼ í¬ìŠ¤íŒ…2ë¥¼ ë³´ë‹ˆ character_set_clientì™€ character_set_connectionì´ ë™ì¼í•œ ê²½ìš°ì—ëŠ” ë³€í™˜ì´ ì¼ì–´ë‚˜ì§€ ì•ŠëŠ”ë‹¤ê³  í•œë‹¤. ì¦‰, ê·¸ë¦¼ì—ì„œ ì•„ë˜ íë¦„ì€ í‹€ë¦¼ì´ëª¨ì§€ ì €ì¥ ì‹¤íŒ¨ íë¦„ MySQLì€ ì§ˆì˜ë¬¸ì´ ìµœëŒ€Â 3ë°”ì´íŠ¸ UTF-8ë¡œ ì¸ì½”ë”© ëë‹¤ê³  ìƒê°(character_set_client=utf8 (utf8mb3)) utf8mb3ì€ ì½”ë“œ í¬ì¸íŠ¸ U+0000 ~ U+FFFF(BMP ë¬¸ì)ì˜ ìœ ë‹ˆì½”ë“œ ë¬¸ìë§Œ ì§€ì› (ìµœëŒ€ 3ë°”ì´íŠ¸) - ê³µì‹ë¬¸ì„œ ì°¸ê³  í•˜ì§€ë§Œ, 4ë°”ì´íŠ¸ ë¬¸ìëŠ” ì¼ë°˜ì ìœ¼ë¡œ ìœ ë‹ˆì½”ë“œ ì½”ë“œ í¬ì¸íŠ¸ U+10000 ~ U+10FFFFì— í•´ë‹¹ (ğŸƒ â€“&gt; U+1F383) ë”°ë¼ì„œ, character_set_client=utf8 (utf8mb3)ì¸ ê²½ìš° ìµœëŒ€ 3ë°”ì´íŠ¸ ë¬¸ìë§Œ ì²˜ë¦¬í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ 4ë°”ì´íŠ¸ ë¬¸ìë¥¼ ìœ ë‹ˆì½”ë“œ ì½”ë“œ í¬ì¸íŠ¸ë¡œ ë””ì½”ë”©í•˜ì§€ ëª»í•¨ ì´ ì‹¤íŒ¨ë¡œ ì¸í•´ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê±°ë‚˜ ì§€ì›ë˜ì§€ ì•ŠëŠ” ë¬¸ìê°€ ì¢…ì¢… ????ë¡œ ëŒ€ì²´ë¨â€» ì°¸ê³  utf8mb3ì€ deprecatedë¨ ìœ„ì—ì„œ ì–¸ê¸‰í•œ ê³µì‹ë¬¸ì„œì—ë„ UTF-8 ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ì§€ë§Œ supplementary character(ì´ëª¨ì§€ ê°™ì€ BMPì´ì™¸ì˜ ë¬¸ì)ì— ëŒ€í•œ ì§€ì›ì´ í•„ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ utf8mb3 ëŒ€ì‹  utf8mb4ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.ë¼ê³  ë˜ì–´ìˆìŒìƒí™©ë³„ character_set_client, character_set_connection ì‚´í´ë³´ê¸° MySQL ë²„ì „ì€ 8.0.35ë¡œ ë™ì¼ connection properties mysql-connector-j ë²„ì „ mysql ë²„ì „ character_set_client character_set_connection characterEncoding=UTF-8 5.1.12 8.0.35 utf8 utf8 characterEncoding=UTF-8&amp;connectionCollation=utf8mb4_bin 5.1.12 8.0.35 utf8 utf8mb4 ë³„ë„ ì„¸íŒ… ì—†ìŒ 8.0.28 8.0.35 utf8mb4 utf8mb4 characterEncoding=UTF-8 8.0.28 8.0.35 utf8mb4 utf8mb4 characterEncoding=UTF-8&amp;connectionCollation=utf8mb4_bin 8.0.28 8.0.35 utf8mb4 utf8mb4 mysql-connector-j 5.1.12 ë²„ì „ì—ì„œëŠ” character_set_clientê°€ utf8 ì¦‰, utf8mb3ì´ë¼ ìµœëŒ€ 3ë°”ì´íŠ¸ê¹Œì§€ ë°–ì— ì§€ì›ì´ ì•ˆë¼ì„œìœ„ ì‹¤íŒ¨ íë¦„ì—ì„œ ì‚´í´ë³¸ ê²ƒì²˜ëŸ¼ 4ë°”ì´íŠ¸ ì´ëª¨ì§€ê°€ ì œëŒ€ë¡œ ì €ì¥ë˜ì§€ ì•Šì•˜ë˜ ê²ƒâ€» character_set_client, character_set_connection í™•ì¸ ì¿¼ë¦¬SELECT * FROM performance_schema.session_variablesWHERE VARIABLE_NAME IN ('character_set_client', 'character_set_connection');character_set_clientê³¼ character_set_connection ê°’ì— ì˜í–¥ì„ ë¯¸ì¹˜ëŠ” ìš”ì†Œ https://dev.mysql.com/doc/connector-j/en/connector-j-connp-props-session.htmlcharacterEncoding character_set_client ë° character_set_connectionì„ ì§€ì •ëœ Java ë¬¸ì ì¸ì½”ë”©ì— ëŒ€í•´ MySQLì´ ì§€ì›í•˜ëŠ” ê¸°ë³¸ ë¬¸ì ì§‘í•©ìœ¼ë¡œ ì„¤ì • characterEncoding=UTF-8 (java) =&gt; utf8 or utf8mb4 (mysql) characterEncoding=ISO-8859-1 (java) =&gt; latin1 (mysql) collation_connectionì„ ì´ ë¬¸ì ì§‘í•©ì˜ ê¸°ë³¸ collationìœ¼ë¡œ ì„¤ì •â€» ì°¸ê³  (ë¬¸ì ì§‘í•©ë³„ ê¸°ë³¸ collation í™•ì¸) SHOW CHARACTER SETconnectionCollation ì„¸ì…˜ ì‹œìŠ¤í…œ ë³€ìˆ˜ collation_connectionì„ ì§€ì •ëœ collationìœ¼ë¡œ ì„¤ì •í•˜ê³  character_set_client ë° character_set_connectionì„ ìƒì‘í•˜ëŠ” ë¬¸ì ì§‘í•©ìœ¼ë¡œ ì„¤ì • ì´ ì†ì„±ì€ characterEncodingì´ êµ¬ì„±ë˜ì§€ ì•Šì•˜ê±°ë‚˜ collationê³¼ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ë¬¸ì ì§‘í•©ìœ¼ë¡œ êµ¬ì„±ëœ ê²½ìš°ì—ë§Œ ì´ collationì´ ì†í•œ ê¸°ë³¸ ë¬¸ì ì§‘í•©ìœ¼ë¡œ characterEncoding ê°’ì„ ì¬ì •ì˜â€» ì´ ì¼€ì´ìŠ¤ ë‹¤ì‹œ ìƒê°í•´ë³´ê¸° connection properties mysql-connector-j ë²„ì „ mysql ë²„ì „ character_set_client character_set_connection characterEncoding=UTF-8&amp;connectionCollation=utf8mb4_bin 5.1.12 8.0.35 utf8 utf8mb4 connectionCollation=utf8mb4_binì— ìƒì‘í•˜ëŠ” ë¬¸ì ì§‘í•©ì´ë©´ character_set_clientë„ utf8mb4ì´ ë˜ì–´ì•¼í•˜ì§€ ì•Šë‚˜? connector/j 5.1.13 ë¶€í„° ë³€ê²½ëœ ë¶€ë¶„ (5.1.12 ë²„ì „ê¹Œì§€ëŠ”) Connector/JëŠ” mysql ì„œë²„ 5.5.2 ì´ìƒì— ëŒ€í•´ utf8mb4ë¥¼ ì§€ì›í•˜ì§€ ì•Šì•˜ìŒ 5.1.13 ë²„ì „ë¶€í„° Connector/JëŠ” character_set_server=utf8mb4ë¡œ êµ¬ì„±ëœ ì„œë²„ë¥¼ ìë™ ê°ì§€ ë˜ëŠ”, characterEncoding=UTF-8ì„ ì‚¬ìš©í•˜ì—¬ ì „ë‹¬ëœ Java ì¸ì½”ë”© utf-8ì„ utf8mb4ë¡œ ì²˜ë¦¬ characterEncoding, connectionCollation ë‘˜ ë‹¤ ì„¤ì • ì•ˆë˜ì–´ìˆëŠ” ê²½ìš° Connector/J 8.0.25 ì´í•˜ : ì„œë²„ì˜ ê¸°ë³¸ ë¬¸ì ì§‘í•©ì„ ì‚¬ìš©(character_set_server ê°’) Connector/J 8.0.26 ì´ìƒ : utf8mb4 ì‚¬ìš©" }, { "title": "í”„ë¡ì‹œë¥¼ í†µí•´ API í˜¸ì¶œí•  ë•Œ ì§€ì—°ë˜ëŠ” ì´ìŠˆ", "url": "/posts/api-call-through-proxy-issue/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "", "date": "2024-01-11 22:25:00 +0900", "snippet": "ìƒí™© í”„ë¡ì‹œ ì„œë²„ë¥¼ í†µí•´ APIë¥¼ í˜¸ì¶œí•  ë•Œ ì‘ë‹µì´ ì§€ì—°ë˜ëŠ” ì¼€ì´ìŠ¤ê°€ ìˆì—ˆê³ , tcpdumpë¥¼ í†µí•´ í™•ì¸í•´ë³¸ ê²°ê³¼ í”„ë¡ì‹œ ì„œë²„ì— ìš”ì²­ì„ í–ˆë‹¤ê°€ ì‘ë‹µì´ ì—†ìœ¼ë‹ˆ ì§ì ‘ ìš”ì²­ ì„œë²„ë¡œ ì ‘ê·¼í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. í”„ë¡ì‹œ ì„œë²„ì—ì„œ ì‘ë‹µì„ ëª» ë°›ì€ ì´ìœ ëŠ” ë„¤íŠ¸ì›Œí¬ ACL ì‹ ì²­ì´ ëˆ„ë½ë˜ì–´ì„œì˜€ìœ¼ë©° ACL ë“±ë¡ ì´í›„ í•´ë‹¹ í˜„ìƒì€ ë‚˜íƒ€ë‚˜ì§€ ì•Šì•˜ë‹¤.ì˜ë¬¸ì  ì•„ë˜ ...", "content": "ìƒí™© í”„ë¡ì‹œ ì„œë²„ë¥¼ í†µí•´ APIë¥¼ í˜¸ì¶œí•  ë•Œ ì‘ë‹µì´ ì§€ì—°ë˜ëŠ” ì¼€ì´ìŠ¤ê°€ ìˆì—ˆê³ , tcpdumpë¥¼ í†µí•´ í™•ì¸í•´ë³¸ ê²°ê³¼ í”„ë¡ì‹œ ì„œë²„ì— ìš”ì²­ì„ í–ˆë‹¤ê°€ ì‘ë‹µì´ ì—†ìœ¼ë‹ˆ ì§ì ‘ ìš”ì²­ ì„œë²„ë¡œ ì ‘ê·¼í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. í”„ë¡ì‹œ ì„œë²„ì—ì„œ ì‘ë‹µì„ ëª» ë°›ì€ ì´ìœ ëŠ” ë„¤íŠ¸ì›Œí¬ ACL ì‹ ì²­ì´ ëˆ„ë½ë˜ì–´ì„œì˜€ìœ¼ë©° ACL ë“±ë¡ ì´í›„ í•´ë‹¹ í˜„ìƒì€ ë‚˜íƒ€ë‚˜ì§€ ì•Šì•˜ë‹¤.ì˜ë¬¸ì  ì•„ë˜ ì½”ë“œë¡œ ë¡œì»¬ì—ì„œ ì¬í˜„í•´ë´¤ì„ë•Œ ìë°” ë²„ì „ì— ë”°ë¼ ê²°ê³¼ê°€ ë‹¤ë¥¸ ê²ƒì„ ì•Œê²Œë˜ì—ˆë‹¤. java.net.ConnectException: Connection timed out: connect ë°œìƒ (jdk ë²„ì „ : jdk8u362-b09) ì´ìŠˆ ìƒí™©ì²˜ëŸ¼ ì§€ì—° ì‘ë‹µì˜´ (jdk ë²„ì „ : openjdk 1.8.0-242) public class ProxyTest { public static void main(String[] args) { Scanner sc = new Scanner(System.in); String url = sc.nextLine(); String ipAddr = \"ì ‘ê·¼ë˜ì§€ ì•ŠëŠ” ì„œë²„ ip\"; String port = \"ì„ì˜ì˜ í¬íŠ¸\"; try { Properties systemSettings = System.getProperties(); systemSettings.put(\"http.proxyHost\", ipAddr); systemSettings.put(\"http.proxyPort\", port); systemSettings.put(\"https.proxyHost\", ipAddr); systemSettings.put(\"https.proxyPort\", port); HttpURLConnection con = (HttpURLConnection) new URL(url).openConnection(); System.out.println(con.getResponseCode() + \" : \" + con.getResponseMessage()); } catch (Exception e) { e.printStackTrace(); } }}ì›ì¸ íŒŒì•…í•˜ê¸° ì‹¤í–‰ íë¦„ì„ í™•ì¸í•´ë³´ê¸° ìœ„í•´ ì§€ì—° ì‘ë‹µì´ ì˜¤ëŠ” openjdk 1.8.0-242 ë²„ì „ì—ì„œ í”„ë¡ì‹œ ì„œë²„ë¿ ì•„ë‹ˆë¼, ìš”ì²­ url ì„œë²„ë„ ì ‘ê·¼ì´ ë˜ì§€ ì•Šë„ë¡ í•´ë³´ì•˜ë‹¤. ì¢Œ : jdk8u362-b09, ìš° : openjdk 1.8.0-242 í‘œì‹œí•œ ë¶€ë¶„ë¶€í„° ì‹¤í–‰íë¦„ì´ ë‹¬ë¼ì§€ëŠ”ê±¸ ë³¼ ìˆ˜ ìˆì—ˆê³ , ì´ì „ í˜¸ì¶œì„ ë”°ë¼ê°€ë³¸ ê²°ê³¼ sun.net.www.protocol.http.HttpURLConnection.plainConnect0ì—ì„œ í”„ë¡ì‹œ ì„œë²„ë¡œ ì—°ê²° í›„ ì˜ˆì™¸ê°€ ë°œìƒí–ˆì„ ë•Œ, êµ¬í˜„ì´ ë‹¤ë¥´ê²Œ ë˜ì–´ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. ì¢Œ : jdk8u362-b09 (í”„ë¡ì‹œ ì„œë²„ë¡œ ì¬ìš”ì²­), ìš° : openjdk 1.8.0-242 (í”„ë¡ì‹œ ì„œë²„ nullë¡œ ì„¸íŒ…í•˜ê³  ì¬ìš”ì²­) RestTemplate ì‚¬ìš©í•˜ë©´ ? ë‚´ë¶€ì ìœ¼ë¡œ HttpURLConnection ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ë™ì¼í•˜ë‹¤.ì°¸ê³  https://bugs.openjdk.org/browse/JDK-8268881 í•´ë‹¹ ì´ìŠˆëŠ” ë²„ê·¸ ë¦¬í¬íŒ… ë˜ì—ˆì—ˆê³  8u311 ë²„ì „ì—ì„œ í•´ê²°ëœ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤." }, { "title": "MyBatis-Spring íŠ¸ëœì­ì…˜ ê´€ë¦¬", "url": "/posts/how-mybatis-spring-transaction-works/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ë“¤ì—¬ë‹¤ë³´ê¸°", "tags": "MyBatis", "date": "2024-01-02 22:25:00 +0900", "snippet": " í•´ë‹¹ í¬ìŠ¤íŒ…ì—ì„œ mybatis, mybatis-spring ì‚¬ìš©ë²•ì„ ê°„ë‹¨íˆ ì‚´í´ë³´ì•˜ë‹¤. ì´ë²ˆì—ëŠ” ê°œì¸ì ìœ¼ë¡œ ê°€ì¥ ê¶ê¸ˆí–ˆë˜ mybatis-springì—ì„œ íŠ¸ëœì­ì…˜ì„ ë‹¤ë£¨ëŠ” ë¶€ë¶„ì´ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì‚´í´ë³´ë ¤ê³  í•œë‹¤. (ì˜ˆì œ ì½”ë“œëŠ” í›‘ì–´ë³´ê¸° í¸ì—ì„œ ì‚¬ìš©ëœ ì½”ë“œ)ë“¤ì–´ê°€ê¸° ì „ : ì˜ˆì œ ì½”ë“œ ë‹¤ì‹œ ì‚´í´ë³´ê¸° SqlSessionì˜ êµ¬í˜„ì²´ë¡œ SqlSe...", "content": " í•´ë‹¹ í¬ìŠ¤íŒ…ì—ì„œ mybatis, mybatis-spring ì‚¬ìš©ë²•ì„ ê°„ë‹¨íˆ ì‚´í´ë³´ì•˜ë‹¤. ì´ë²ˆì—ëŠ” ê°œì¸ì ìœ¼ë¡œ ê°€ì¥ ê¶ê¸ˆí–ˆë˜ mybatis-springì—ì„œ íŠ¸ëœì­ì…˜ì„ ë‹¤ë£¨ëŠ” ë¶€ë¶„ì´ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ ì‚´í´ë³´ë ¤ê³  í•œë‹¤. (ì˜ˆì œ ì½”ë“œëŠ” í›‘ì–´ë³´ê¸° í¸ì—ì„œ ì‚¬ìš©ëœ ì½”ë“œ)ë“¤ì–´ê°€ê¸° ì „ : ì˜ˆì œ ì½”ë“œ ë‹¤ì‹œ ì‚´í´ë³´ê¸° SqlSessionì˜ êµ¬í˜„ì²´ë¡œ SqlSessionTemplate ì£¼ì…í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, sqlSession.insert í˜¸ì¶œí•˜ë©´ auto-commitë¨public class MybatisSpringMemberQueryServiceImpl implements MemberQueryService { private final SqlSession sqlSession; public MybatisSpringMemberQueryServiceImpl(SqlSession sqlSession) { this.sqlSession = sqlSession; } @Override public void createMember(String id, String name) { Member newMember = new Member(id, name); sqlSession.insert(\"member.save\", newMember); sqlSessionTemplate.insert(\"memberHistory.save\", MemberHistory.forJoin(newMember)); }} ë°˜ë©´ ìœ„ì™€ ë™ì¼í•˜ê²Œ SqlSessionTemplate ì£¼ì…í•´ì„œ ì‚¬ìš©í•˜ë”ë¼ë„, ì•„ë˜ ì½”ë“œëŠ” sqlSession.insert í˜¸ì¶œí•˜ë©´ auto-commit ë˜ì§€ ì•Šê³  transactionManager.commit ì‹œì ì—ì„œ ì»¤ë°‹ë¨public class MybatisSpringMemberQueryServiceImpl implements MemberQueryService { private final SqlSession sqlSession; private final PlatformTransactionManager transactionManager; public MybatisSpringMemberQueryServiceImpl(SqlSession sqlSession, PlatformTransactionManager transactionManager) { this.sqlSession = sqlSession; this.transactionManager = transactionManager; } @Override public void createMember(String id, String name) { TransactionStatus txStatus = transactionManager.getTransaction(new DefaultTransactionDefinition()); Member newMember = new Member(id, name); sqlSession.insert(\"member.save\", newMember); sqlSession.insert(\"memberHistory.save\", MemberHistory.forJoin(newMember)); transactionManager.commit(txStatus); }} ì´ê²Œ ì–´ë–»ê²Œ ê°€ëŠ¥í•œ ê²ƒì¸ì§€ íŒŒì•…í•˜ê¸° ìœ„í•´ ì•„ë˜ ìˆœì„œë¡œ ë‚´ë¶€ íë¦„ì„ ì‚´í´ë³¼ ì˜ˆì •ì´ë‹¤. transactionManager.getTransaction sqlSession.insert // ì²«ë²ˆì§¸ insert 1. transactionManager.getTransaction ë‚´ë¶€ì ìœ¼ë¡œëŠ” ë‹¤ì–‘í•œ ì¡°ê±´ë“¤ì— ì˜í•´ ë” ë³µì¡í•˜ê²Œ ë¶„ê¸°ì²˜ë¦¬ ë˜ì§€ë§Œ, ìœ„ ì˜ˆì œ ì½”ë“œê°€ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ”ì§€ì˜ íë¦„ì„ íŒŒì•…í•˜ëŠ” ì •ë„ë¡œë§Œ ì‹œí€€ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ì„ ê·¸ë ¤ë´¤ë‹¤. (ì²˜ìŒì´ë¼ ì œëŒ€ë¡œ ê·¸ë¦°ê²ƒì¸ì§€ëŠ” ì˜ ëª¨ë¥´ê² ì§€ë§Œ â€¦) transactionManager.getTransaction í˜¸ì¶œì‹œ íë¦„ì„ ë‚´ê°€ ì´í•´í•œëŒ€ë¡œ ì •ë¦¬í•˜ë©´, ì¶”ìƒ í´ë˜ìŠ¤ì¸ AbstractPlatformTransactionManagerëŠ” ì‹¤ì œ êµ¬í˜„ì²´ì¸ DataSourceTransactionManagerì—ê²Œ íŠ¸ëœì­ì…˜ì„ ë‹¤ë£¨ê¸° ìœ„í•œ ê°ì²´ë¥¼ ë§Œë“¤ì–´ë‹¬ë¼ê³  ìš”ì²­í•œë‹¤. ë™ì¼í•œ íŠ¸ëœì­ì…˜ ë‚´ë¶€ì—ì„œëŠ” í•˜ë‚˜ì˜ ì»¤ë„¥ì…˜ì´ ì‚¬ìš©ë˜ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì—, ê·¸ëŸ¬í•œ ì»¤ë„¥ì…˜ì„ ê´€ë¦¬í•  ConnectionHolderê°€ í•„ìš”í•˜ë‹¤(íŠ¸ëœì­ì…˜ ë™ê¸°í™”). ë”°ë¼ì„œ, íŠ¸ëœì­ì…˜ì„ ë‹¤ë£¨ê¸° ìœ„í•œ ê°ì²´ëŠ” ConnectionHolderë¥¼ í•„ìš”ë¡œí•˜ê³  ì´ë¥¼ ì–»ê¸° ìœ„í•´ TransactionSynchronizationManagerì—ê²Œ ìš”ì²­í•œë‹¤. AbstractPlatformTransactionManagerëŠ” ì–»ì€ íŠ¸ëœì­ì…˜ ê°ì²´(DataSourceTransactionObject)ê°€ ì´ë¯¸ ì²˜ë¦¬í•˜ê³  ìˆëŠ” íŠ¸ëœì­ì…˜ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤. ì—†ëŠ” ê²½ìš°, íŠ¸ëœì­ì…˜ ì²˜ë¦¬ë¥¼ ì‹œì‘í•˜ê¸° ìœ„í•œ ì¤€ë¹„ë¥¼ í•œë‹¤. (íŠ¸ëœì­ì…˜ ê°ì²´ì— ConnectionHolder ì„¸íŒ…, ConnectionHolderì— íŠ¸ëœì­ì…˜ ë™ê¸°í™” ì—¬ë¶€ ì„¸íŒ…, ConnectionHolderì—ì„œ ê´€ë¦¬í•˜ëŠ” Connectionì— auto-commit false ì„¸íŒ…, TransactionSynchronizationManagerì— ConnectionHolder ì„¸íŒ…ë˜ë„ë¡ ë“±) íŠ¸ëœì­ì…˜ ë° íŠ¸ëœì­ì…˜ ë™ê¸°í™”ì™€ ê´€ë ¨ëœ ì†ì„±ë“¤ì„ TransactionSynchronizationManagerìª½ì— ì„¸íŒ…í•œë‹¤. ì¦‰, transactionManager.getTransactionëŠ” â€œê¸°ì¡´ì— ì²˜ë¦¬ë˜ê³  ìˆëŠ” íŠ¸ëœì­ì…˜ì´ ìˆëŠ”ì§€ í™•ì¸(1)í•˜ê³ , ì—†ìœ¼ë©´ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ë¥¼ ìœ„í•´ ì¤€ë¹„(2)í•˜ëŠ” ê³¼ì •â€ ì´ë¼ê³  ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤. ì°¸ê³  : org.springframework.jdbc.datasource.DataSourceTransactionManager#doBeginprotected void doBegin(Object transaction, TransactionDefinition definition) { DataSourceTransactionObject txObject = (DataSourceTransactionObject)transaction; Connection con = null; try { if (!txObject.hasConnectionHolder() || txObject.getConnectionHolder().isSynchronizedWithTransaction()) { Connection newCon = this.obtainDataSource().getConnection(); if (this.logger.isDebugEnabled()) { this.logger.debug(\"Acquired Connection [\" + newCon + \"] for JDBC transaction\"); } txObject.setConnectionHolder(new ConnectionHolder(newCon), true); } txObject.getConnectionHolder().setSynchronizedWithTransaction(true); con = txObject.getConnectionHolder().getConnection(); Integer previousIsolationLevel = DataSourceUtils.prepareConnectionForTransaction(con, definition); txObject.setPreviousIsolationLevel(previousIsolationLevel); txObject.setReadOnly(definition.isReadOnly()); if (con.getAutoCommit()) { txObject.setMustRestoreAutoCommit(true); if (this.logger.isDebugEnabled()) { this.logger.debug(\"Switching JDBC Connection [\" + con + \"] to manual commit\"); } con.setAutoCommit(false); } this.prepareTransactionalConnection(con, definition); txObject.getConnectionHolder().setTransactionActive(true); int timeout = this.determineTimeout(definition); if (timeout != -1) { txObject.getConnectionHolder().setTimeoutInSeconds(timeout); } if (txObject.isNewConnectionHolder()) { TransactionSynchronizationManager.bindResource(this.obtainDataSource(), txObject.getConnectionHolder()); } } catch (Throwable var7) { if (txObject.isNewConnectionHolder()) { DataSourceUtils.releaseConnection(con, this.obtainDataSource()); txObject.setConnectionHolder((ConnectionHolder)null, false); } throw new CannotCreateTransactionException(\"Could not open JDBC Connection for transaction\", var7); }} ì°¸ê³  : org.springframework.transaction.support.AbstractPlatformTransactionManager#prepareSynchronizationprotected void prepareSynchronization(DefaultTransactionStatus status, TransactionDefinition definition) { if (status.isNewSynchronization()) { TransactionSynchronizationManager.setActualTransactionActive(status.hasTransaction()); TransactionSynchronizationManager.setCurrentTransactionIsolationLevel(definition.getIsolationLevel() != -1 ? definition.getIsolationLevel() : null); TransactionSynchronizationManager.setCurrentTransactionReadOnly(definition.isReadOnly()); TransactionSynchronizationManager.setCurrentTransactionName(definition.getName()); TransactionSynchronizationManager.initSynchronization(); }}2. ì²«ë²ˆì§¸ sqlSession.insert TransactionSynchronizationManagerì—ê²Œ íŠ¸ëœì­ì…˜ ë™ê¸°í™”ê°€ í™œì„±í™” ë˜ì–´ìˆëŠ”ì§€ í™•ì¸. í™œì„±í™”ë˜ì–´ ìˆìœ¼ë©´ ë™ê¸°í™”ì— í•„ìš”í•œ SqlSessionHolderê°€ ìˆëŠ”ì§€ í™•ì¸ SqlSessionHolderê°€ ì—†ìœ¼ë©´ ìƒì„±í•˜ì—¬ TransactionSynchronizationManagerì— ë°”ì¸ë”© DBì— ì§ˆì˜í•˜ê¸° ìœ„í•´ ì–»ì–´ì˜¨ SqlSessionì˜ êµ¬í˜„ì²´ DefaultSqlSessionë¥¼ í†µí•´ DBì— ì§ˆì˜ ì§ˆì˜ì‹œ 1ë²ˆ ë‹¨ê³„(transactionManager.getTransaction)ì—ì„œ ì„¸íŒ…í•œ ConnectionHolderì˜ Connectionì´ ì‚¬ìš©ëœë‹¤. íŠ¸ëœì­ì…˜ ë™ê¸°í™”ì¤‘ì¸ì§€ í™•ì¸ë’¤, ë™ê¸°í™” ì¤‘ì´ì§€ ì•Šìœ¼ë©´ ì§ˆì˜í•œ ê²ƒ ë°”ë¡œ commit í›„ SqlSession.close() ë™ê¸°í™” ì¤‘ì´ë©´, commit í•˜ì§€ì•Šê³  ë™ê¸°í™”ì— ì‚¬ìš©ë˜ëŠ” SqlSessionHolderì˜ SqlSessionì„ release ìš”ì•½í•˜ë©´, (1) íŠ¸ëœì­ì…˜ ë™ê¸°í™”ì¤‘ì¸ì§€ í™•ì¸í›„ ë™ê¸°í™”ë¥¼ ìœ„í•œ SqlSessionHolder ë“± ì¤€ë¹„ (2) ë™ê¸°í™” ì¤‘ì´ë©´, DBì— ì§ˆì˜ í›„ SqlSessionì„ commit &amp; closeí•˜ì§€ ì•Šê³ , SqlSessionì„ release SqlSessionì˜ êµ¬í˜„ì²´ë¡œ ì‚¬ìš©ë˜ëŠ” SqlSessionTemplateì˜ ë‚´ë¶€ì—ì„œthis.sqlSessionProxy = (SqlSession)Proxy.newProxyInstance(SqlSessionFactory.class.getClassLoader(), new Class[]{SqlSession.class}, new SqlSessionInterceptor());" }, { "title": "JDBC / MyBatis / MyBatis-Spring í›‘ì–´ë³´ê¸°", "url": "/posts/hello-mybatis/", "categories": "ì§€ì‹ ë”í•˜ê¸°, Hello-World êµ¬í˜„", "tags": "Mybatis", "date": "2023-12-21 22:25:00 +0900", "snippet": " JDBCë¶€í„° mybatis-springê¹Œì§€ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í•´ë³´ë©´ì„œ ë“œëŠ” ê°œì¸ì ì¸ ìƒê°ì„ ì ì–´ë³´ì. ì‹œë‚˜ë¦¬ì˜¤ : íšŒì› í…Œì´ë¸”ì— íšŒì› ì •ë³´ ì €ì¥ í›„, íšŒì› ì´ë ¥ í…Œì´ë¸”ì— ì´ë ¥ ì €ì¥í•˜ê¸° ì „ ì˜ˆì™¸ ë°œìƒ ìƒí™©1 : íšŒì› ì •ë³´ëŠ” ì €ì¥ë¨ ìƒí™©2 : íšŒì›, ì´ë ¥ í…Œì´ë¸”ì— ëª¨ë‘ ì €ì¥ë˜ì§€ ì•ŠìŒ JDBC ìƒí™©1public class...", "content": " JDBCë¶€í„° mybatis-springê¹Œì§€ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í•´ë³´ë©´ì„œ ë“œëŠ” ê°œì¸ì ì¸ ìƒê°ì„ ì ì–´ë³´ì. ì‹œë‚˜ë¦¬ì˜¤ : íšŒì› í…Œì´ë¸”ì— íšŒì› ì •ë³´ ì €ì¥ í›„, íšŒì› ì´ë ¥ í…Œì´ë¸”ì— ì´ë ¥ ì €ì¥í•˜ê¸° ì „ ì˜ˆì™¸ ë°œìƒ ìƒí™©1 : íšŒì› ì •ë³´ëŠ” ì €ì¥ë¨ ìƒí™©2 : íšŒì›, ì´ë ¥ í…Œì´ë¸”ì— ëª¨ë‘ ì €ì¥ë˜ì§€ ì•ŠìŒ JDBC ìƒí™©1public class JdbcMemberQueryServiceImpl implements MemberQueryService { @Override public void createMember(String id, String name) { try(Connection con = getConnection()) { PreparedStatement createMemberStmt = con.prepareStatement(\"INSERT INTO member (member_id, member_name) VALUES (?, ?)\"); createMemberStmt.setString(1, id); createMemberStmt.setString(2, name); createMemberStmt.executeUpdate(); PreparedStatement createMemberHistStmt = con.prepareStatement(\"INSERT INTO member_history (member_id, action_type, registered_at) VALUES (?, ?, ?)\"); createMemberHistStmt.setString(1, id); createMemberHistStmt.setString(2, \"JOIN\"); long epochSec = LocalDateTime.now().atZone(ZoneId.systemDefault()).toInstant().getEpochSecond(); createMemberHistStmt.setDate(3, new Date(epochSec)); causeException(); createMemberHistStmt.executeUpdate(); } catch (SQLException e) { e.printStackTrace(); } } private Connection getConnection() throws SQLException { String url = \"jdbc:mysql://localhost:3306/STUDY\"; String user = \"root\"; String password = \"root\"; return DriverManager.getConnection(url, user, password); }} ìƒí™©2public class JdbcMemberQueryServiceImpl implements MemberQueryService { @Override public void createMember(String id, String name) { try(Connection con = getConnection()) { con.setAutoCommit(false); // ìœ„ì™€ ë™ì¼ ... causeException(); createMemberHistStmt.executeUpdate(); con.commit(); } catch (SQLException e) { e.printStackTrace(); } }}ìƒê°í•˜ëŠ” ë¬¸ì œì  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§(ë©¤ë²„ ì €ì¥)ì— DBê´€ë ¨ ë¡œì§(ì»¤ë„¥ì…˜ ê°€ì ¸ì˜¤ê¸°, SQLë¬¸ ë§Œë“¤ê¸° ë“±)ì´ ì„ì´ê²Œëœë‹¤. ìœ„ì™€ ê°™ì€ DBê´€ë ¨ ì½”ë“œê°€ ì—¬ëŸ¬ ë¡œì§ì— ì¤‘ë³µí•´ì„œ ë‚˜íƒ€ë‚˜ê²Œëœë‹¤. ì¿¼ë¦¬ë¬¸ ì‘ì„±ì‹œ ì˜¤íƒ€ë‚  ìˆ˜ ìˆëŠ” ê°€ëŠ¥ì„±ì´ ìˆê³ , ìˆì–´ë„ ì»´íŒŒì¼ ì‹œì ì—ì„  ì•Œ ìˆ˜ ì—†ë‹¤. statementì— íŒŒë¼ë¯¸í„° ì„¸íŒ…ì‹œ í•´ë‹¹ íŒŒë¼ë¯¸í„°ì˜ ë°ì´í„° íƒ€ì…ì„ ë‹¤ ì•Œê³ ìˆì–´ì•¼í•œë‹¤. ì¦‰, DBì— ê°•í•˜ê²Œ ê²°í•©ëœ ë¡œì§ì´ ë  ìˆ˜ë°–ì— ì—†ë‹¤. java.sql íŒ¨í‚¤ì§€ì— ì •ì˜ëœ ë°ì´í„° íƒ€ì…ì´ ê°•ì œëœë‹¤.MyBatis ì˜ì¡´ì„± ì¶”ê°€ : implementation 'org.mybatis:mybatis:3.5.14' MyBatis ê´€ë ¨ ì„¤ì • íŒŒì¼ ì„¸íŒ… : mybatis-config.xml&lt;?xml version = \"1.0\" encoding = \"UTF-8\"?&gt;&lt;!DOCTYPE configuration PUBLIC \"-//mybatis.org//DTD Config 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;&lt;configuration&gt; &lt;environments default = \"development\"&gt; &lt;environment id = \"development\"&gt; &lt;transactionManager type = \"JDBC\"/&gt; &lt;dataSource type = \"POOLED\"&gt; &lt;property name = \"driver\" value = \"com.mysql.cj.jdbc.Driver\"/&gt; &lt;property name = \"url\" value = \"jdbc:mysql://localhost:3306/STUDY\"/&gt; &lt;property name = \"username\" value = \"root\"/&gt; &lt;property name = \"password\" value = \"root\"/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;mappers&gt; &lt;mapper resource = \"mybatis-mapper/member.xml\"/&gt; &lt;mapper resource = \"mybatis-mapper/memberHistory.xml\"/&gt; &lt;/mappers&gt;&lt;/configuration&gt; ë§¤í¼ íŒŒì¼ ì„¸íŒ…&lt;!-- member.xml--&gt;&lt;?xml version = \"1.0\" encoding = \"UTF-8\"?&gt;&lt;!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;&lt;mapper namespace = \"member\"&gt; &lt;insert id = \"save\" parameterType = \"hello.persistence.model.Member\"&gt; INSERT INTO member (member_id, member_name) VALUES (#{id}, #{name}) &lt;/insert&gt;&lt;/mapper&gt;&lt;!--memberHistory.xml--&gt;&lt;?xml version = \"1.0\" encoding = \"UTF-8\"?&gt;&lt;!DOCTYPE mapper PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\" \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;&lt;mapper namespace = \"memberHistory\"&gt; &lt;insert id = \"save\" parameterType = \"hello.persistence.model.MemberHistory\"&gt; INSERT INTO member_history (member_id, action_type, registered_at) VALUES (#{member.id}, #{actionType}, NOW()) &lt;/insert&gt;&lt;/mapper&gt; ìƒí™©1public class MybatisMemberQueryServiceImpl implements MemberQueryService { private static SqlSessionFactory sqlSessionFactory; private static Reader reader; static { try { reader = Resources.getResourceAsReader(\"mybatis-config.xml\"); sqlSessionFactory = new SqlSessionFactoryBuilder().build(reader); } catch (IOException e) { e.printStackTrace(); } } @Override public void createMember(String id, String name) { try(SqlSession sqlSession = sqlSessionFactory.openSession()) { // autoCommit : true (default) Member newMember = new Member(id, name); sqlSession.insert(\"member.save\", newMember); causeException(); sqlSession.insert(\"memberHistory.save\", MemberHistory.forJoin(newMember)); } catch (Exception e) { e.printStackTrace(); } }} ìƒí™©2public class MybatisMemberQueryServiceImpl implements MemberQueryService { ... @Override public void createMember(String id, String name) { try(SqlSession sqlSession = sqlSessionFactory.openSession(false)) { ... causeException(); sqlSession.insert(\"memberHistory.save\", MemberHistory.forJoin(newMember)); sqlSession.commit(); } catch (Exception e) { e.printStackTrace(); } }}JDBCì™€ ë¹„êµí•´ì„œ ë‚˜ì•„ì¡Œë‹¤ê³  ëŠë¼ëŠ” ë¶€ë¶„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ê´€ë ¨ì—†ëŠ” DB ê´€ë ¨ ë¡œì§(ì»¤ë„¥ì…˜ ì–»ì–´ì˜¤ê¸°, statement ë§Œë“¤ê¸° ë“±)ì´ ì–´ëŠì •ë„ ë¶„ë¦¬ë¨ if, choose ë“±ì˜ ê¸°ëŠ¥ì„ í†µí•´ Dynamic ì¿¼ë¦¬ë¥¼ ë³´ë‹¤ ì‰½ê²Œ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.ìƒê°í•˜ëŠ” ë¬¸ì œì  ì»´íŒŒì¼ ì‹œì ì— ì¿¼ë¦¬ ì˜¤ë¥˜ ì•Œ ìˆ˜ ì—†ìŒ (+ mapper idë„ â€œmember.saveâ€ì™€ ê°™ì´ ë¬¸ìì—´ë¡œ ë°›ëŠ”ë‹¤.) ì„¸ì…˜ì„ ì—´ê³  ë‹«ëŠ” ë¶€ë¶„ì„ ì‹ ê²½ì¨ì•¼í•œë‹¤. (ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— DB ê´€ë ¨ ë¡œì§ì´ ë‚¨ì•„ìˆìŒ) ë§¤í¼ íŒŒì¼ì´ ìƒê¸¸ë•Œë§ˆë‹¤ ì„¤ì •ì— ì¶”ê°€í•´ì¤˜ì•¼í•˜ëŠ” ë²ˆê±°ë¡œì›€MyBatis-Spring ì˜ì¡´ì„± ì¶”ê°€ : implementation â€˜org.mybatis:mybatis-spring:2.1.2â€™ ê³µì‹ ë¬¸ì„œ ì— ë‚˜ì™€ìˆëŠ” ë²„ì „ í˜¸í™˜ì„± MyBatis-Spring MyBatis Spring Framework Spring Batch Java 3.0 3.5+ 6.0+ 5.0+ Java 17+ 2.1 3.5+ 5.x 4.x Java 8+ 2.0 3.5+ 5.x 4.x Java 8+ 1.3 3.4+ 3.2.2+ 2.1+ Java 6+ SqlSessionTemplate ì£¼ì…@Configurationpublic class AppConfig { @Bean public DataSource dataSource() { String dbUrl = \"jdbc:mysql://localhost:3306/STUDY\"; String user = \"root\"; String pw = \"root\"; DriverManagerDataSource dataSource = new DriverManagerDataSource(dbUrl, user, pw); dataSource.setDriverClassName(\"com.mysql.cj.jdbc.Driver\"); return dataSource; } @Bean public SqlSessionFactory sqlSessionFactory() throws Exception { SqlSessionFactoryBean factoryBean = new SqlSessionFactoryBean(); factoryBean.setDataSource(dataSource()); factoryBean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(\"classpath:mybatis-mapper/*.xml\")); return factoryBean.getObject(); } @Bean public SqlSessionTemplate sqlSession() throws Exception { return new SqlSessionTemplate(sqlSessionFactory()); } @Bean public MemberQueryService memberQueryService() throws Exception { return new MybatisSpringMemberQueryServiceImpl(sqlSession()); }}public class PersistenceDemoApp { public static void main(String[] args) { ApplicationContext ctx = new AnnotationConfigApplicationContext(AppConfig.class); MemberQueryService memberQueryService = (MemberQueryService) ctx.getBean(\"memberQueryService\"); memberQueryService.createMember(\"user1\", \"Kevin\"); }} ìƒí™©1public class MybatisSpringMemberQueryServiceImpl implements MemberQueryService { private final SqlSession sqlSession; public MybatisSpringMemberQueryServiceImpl(SqlSession sqlSession) { this.sqlSession = sqlSession; } @Override public void createMember(String id, String name) { Member newMember = new Member(id, name); sqlSession.insert(\"member.save\", newMember); causeException(); sqlSessionTemplate.insert(\"memberHistory.save\", MemberHistory.forJoin(newMember)); }} ìœ„ ì˜ˆì œì—ì„œ sqlSessionì˜ êµ¬í˜„ì²´ì¸ sqlSessionTemplateì—ì„œ commit, rollbackì„ ì§ì ‘í˜¸ì¶œí•˜ë©´ UnsupportedOperationException ë°œìƒ, ê¸°ë³¸ì ìœ¼ë¡œëŠ” autoCommitëœë‹¤. ë˜í•œ SqlSessionì—ëŠ” setAutoCommití•˜ëŠ” ë¶€ë¶„ë„ ì—†ë‹¤.ë”°ë¼ì„œ, ìƒí™©2ë¥¼ ìœ„í•´ì„œëŠ” org.springframework.transaction.TransactionManagerê°€ í•„ìš” ê³µì‹ ë¬¸ì„œì— ë”°ë¥´ë©´ â€œë§ˆì´ë°”í‹°ìŠ¤ ìŠ¤í”„ë§ ì—°ë™ëª¨ë“ˆì„ ì‚¬ìš©í•˜ëŠ” ì¤‘ìš”í•œ ì´ìœ ì¤‘ í•˜ë‚˜ëŠ” ë§ˆì´ë°”í‹°ìŠ¤ê°€ ìŠ¤í”„ë§ íŠ¸ëœì­ì…˜ì— ìì—°ìŠ¤ëŸ½ê²Œ ì—°ë™ë ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ë§ˆì´ë°”í‹°ìŠ¤ì— ì¢…ì†ë˜ëŠ” ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ ê´€ë¦¬ë¥¼ ë§Œë“œëŠ” ê²ƒë³´ë‹¤ëŠ” ë§ˆì´ë°”í‹°ìŠ¤ ìŠ¤í”„ë§ ì—°ë™ëª¨ë“ˆì´ ìŠ¤í”„ë§ì˜ DataSourceTransactionManagerê³¼ ìœµí•©ë˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.â€ ë¼ê³  ë˜ì–´ìˆëŠ”ê²Œ mybatis-spring ìì²´ì ìœ¼ë¡œëŠ” íŠ¸ëœì­ì…˜ ê´€ë¦¬í•˜ëŠ” ë¶€ë¶„ì„ ì œê³µí•˜ì§€ ì•Šê³  ìŠ¤í”„ë§ìª½ì˜ TransactionManagerê°€ í•„ìš”í•˜ë‹¤ëŠ” ì–˜ê¸°ì¸ ê²ƒ ê°™ê¸°ë„í•˜ë‹¤. AppConfig.javaì— PlatformTransactionManager ë¹ˆ ì„ ì–¸ ë° MemberQueryServiceì— ì£¼ì…@Beanpublic PlatformTransactionManager transactionManager() { return new DataSourceTransactionManager(dataSource());}@Beanpublic MemberQueryService memberQueryService() throws Exception { return new MybatisSpringMemberQueryServiceImpl(sqlSession(), transactionManager());} ìƒí™©2public class MybatisSpringMemberQueryServiceImpl implements MemberQueryService { private final SqlSession sqlSession; private final PlatformTransactionManager transactionManager; public MybatisSpringMemberQueryServiceImpl(SqlSession sqlSession, PlatformTransactionManager transactionManager) { this.sqlSession = sqlSession; this.transactionManager = transactionManager; } @Override public void createMember(String id, String name) { TransactionStatus txStatus = transactionManager.getTransaction(new DefaultTransactionDefinition()); Member newMember = new Member(id, name); sqlSession.insert(\"member.save\", newMember); causeException(); sqlSession.insert(\"memberHistory.save\", MemberHistory.forJoin(newMember)); transactionManager.commit(txStatus); }}MyBatisì™€ ë¹„êµí•´ì„œ ë‚˜ì•„ì¡Œë‹¤ê³  ëŠë¼ëŠ” ë¶€ë¶„ SqlSessionFactory ì‚¬ìš©í•´ì„œ SqlSessionì„ ë§¤ë²ˆ ìƒì„±í•˜ê³  ì»¤ë°‹/ë¡¤ë°±í›„ ë‹«ëŠ” ì‘ì—…ì„ ì•ˆí•´ì¤˜ë„ëœë‹¤. SqlSessionTemplateì€ Thread-safeí•˜ë‹¤. (ì°¸ê³ )ìƒê°í•˜ëŠ” ë¬¸ì œì  íŠ¸ëœì­ì…˜ ì²˜ë¦¬ë¥¼ ìœ„í•´ TransactionManager, TransactionStatus ë“± ì´ì „ì— ë¹„í•´ ì˜ì¡´í•´ì•¼ë  ê°ì²´ë“¤ì´ ë” ìƒê¸´ë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— íŠ¸ëœì­ì…˜ ê´€ë ¨ ì²˜ë¦¬ ì½”ë“œê°€ ì„ì¸ë‹¤. statement ë¬¸ìì—´ë¡œ ì„ ì–¸ìœ„ ìƒí™©2 ê°œì„ í•´ë³´ê¸° : @Transactional ì‚¬ìš© AppConfig.javaì— @EnableTransactionManagement ì„ ì–¸public class MybatisSpringMemberQueryServiceImpl implements MemberQueryService { private final SqlSession sqlSession; public MybatisSpringMemberQueryServiceImpl(SqlSession sqlSession) { this.sqlSession = sqlSession; } @Override @Transactional public void createMember(String id, String name) { Member newMember = new Member(id, name); sqlSession.insert(\"member.save\", newMember); causeException(); sqlSession.insert(\"memberHistory.save\", MemberHistory.forJoin(newMember)); }}ì „ê³¼ ë¹„êµí•´ì„œ ë‚˜ì•„ì¡Œë‹¤ê³  ëŠë¼ëŠ” ë¶€ë¶„ TransactionStatus, PlatformTransactionManagerì— ì˜ì¡´í•˜ì§€ ì•Šì•„ë„ëœë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ íŠ¸ëœì­ì…˜ ê´€ë ¨ ë¶€ë¶„ì´ ì‚¬ë¼ì§„ë‹¤.Statement id ë¬¸ìì—´ë¡œ ì…ë ¥í•˜ëŠ” ë¶€ë¶„ ê°œì„ í•˜ê¸° : ë§¤í¼ ì¸í„°í˜ì´ìŠ¤ ì‚¬ìš©public interface MemberMapper { void save(Member member);}public interface MemberHistoryMapper { void save(MemberHistory memberHistory);} AppConfig.javaì— Mapper ë¹ˆ ì¶”ê°€@Beanpublic MemberMapper memberMapper() throws Exception { MapperFactoryBean&lt;MemberMapper&gt; factoryBean = new MapperFactoryBean&lt;&gt;(MemberMapper.class); factoryBean.setSqlSessionFactory(sqlSessionFactory()); return factoryBean.getObject();}@Beanpublic MemberHistoryMapper memberHistoryMapper() throws Exception { MapperFactoryBean&lt;MemberHistoryMapper&gt; factoryBean = new MapperFactoryBean&lt;&gt;(MemberHistoryMapper.class); factoryBean.setSqlSessionFactory(sqlSessionFactory()); return factoryBean.getObject();}@Beanpublic MemberQueryService memberQueryService() throws Exception { return new MybatisSpringMemberQueryServiceImpl(memberMapper(), memberHistoryMapper());} ë˜ëŠ”, @MapperScanì„ ì‚¬ìš©í•˜ë©´ @Configuration@MapperScan(\"hello.persistence.mybatis.mapper\")public class AppConfig { @Bean public MemberQueryService memberQueryService() throws Exception { // TODO : MapperScan ì‚¬ìš©í•  ë•ŒëŠ” ì˜ì¡´ì„± ì£¼ì… ì–´ë–»ê²Œí•˜ì§€ ?? }} ë§¤í¼ íŒŒì¼ì˜ namespaceì—ëŠ” ë§¤í¼ ì¸í„°í˜ì´ìŠ¤ì˜ full package ëª…ì„ ì ì–´ì•¼í•œë‹¤. member.xml : &lt;mapper namespace = \"hello.persistence.mybatis.mapper.MemberMapper\"&gt; memberHistory.xml : &lt;mapper namespace = \"hello.persistence.mybatis.mapper.MemberHistoryMapper\"&gt; public class MybatisSpringMemberQueryServiceImpl implements MemberQueryService { private MemberMapper memberMapper; private MemberHistoryMapper memberHistoryMapper; public MybatisSpringMemberQueryServiceImpl(MemberMapper memberMapper, MemberHistoryMapper memberHistoryMapper) { this.memberMapper = memberMapper; this.memberHistoryMapper = memberHistoryMapper; } @Override @Transactional public void createMember(String id, String name) { Member newMember = new Member(id, name); memberMapper.save(newMember); causeException(); memberHistoryMapper.save(MemberHistory.forJoin(newMember)); }}ì „ê³¼ ë¹„êµí•´ì„œ ë‚˜ì•„ì¡Œë‹¤ê³  ëŠë¼ëŠ” ë¶€ë¶„ DB ê´€ë ¨ëœ ì½”ë“œê°€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ì™„ì „íˆ ë¶„ë¦¬ëœë‹¤. Statement idê°€ ì˜ëª» ë§µí•‘ëœ ê²½ìš° ì»´íŒŒì¼ ì‹œì ì—ì„œ ë°œê²¬ë  ìˆ˜ ìˆë‹¤. (ì¦‰, ë¬¸ìì—´ ì˜¤íƒ€ ë“±ìœ¼ë¡œ ì¸í•´ ì—†ëŠ” Statement í˜¸ì¶œí•  ì¼ì€ ì—†ìŒ)" }, { "title": "í‚¤ë¦´ë¬¸ìë¥¼ ì•„ì‹œë‚˜ìš” ?", "url": "/posts/cyrillic-alphabet-issue/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "", "date": "2023-11-28 10:25:00 +0900", "snippet": "ìƒí™© ë‹´ë‹¹í•˜ëŠ” ì„œë¹„ìŠ¤ì—ì„œ ë°œí–‰í•œ ì¿ í° ë²ˆí˜¸ë¥¼ ì‚¬ìš©ìê°€ ì•±ì—ì„œ ì…ë ¥í–ˆëŠ”ë° ë“±ë¡ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” CSê°€ ì ‘ìˆ˜ ë¡œê·¸ì— ë‚¨ì€ í•´ë‹¹ ì¿ í°ì˜ ì•ìë¦¬ë¥¼ ë³µì‚¬í•˜ì—¬ DBì—ì„œ ì¡°íšŒí•´ë´¤ëŠ”ë° ê²°ê³¼ê°€ ì—†ìŒ í•˜ì§€ë§Œ, ì‚¬ìš©ìê°€ ë³´ë‚´ì¤€ ìŠ¤í¬ë¦°ìƒ·ì— ìˆëŠ” ì¿ í° ë²ˆí˜¸ë¥¼ ì§ì ‘ ì…ë ¥í•´ì„œ ì¡°íšŒí•˜ë©´ ê²°ê³¼ê°€ ìˆìŒì›ì¸ íŒŒì•…í•˜ê¸° ì•„ë˜ ì½”ë“œë¡œ ë¡œê·¸ì—ì„œ ë³µì‚¬í•œ ê²½ìš°ì™€ ì§ì ‘ ì…ë ¥í•œ ê²½ìš°ë¥¼ ë¹„êµí•´ë³´ì•˜...", "content": "ìƒí™© ë‹´ë‹¹í•˜ëŠ” ì„œë¹„ìŠ¤ì—ì„œ ë°œí–‰í•œ ì¿ í° ë²ˆí˜¸ë¥¼ ì‚¬ìš©ìê°€ ì•±ì—ì„œ ì…ë ¥í–ˆëŠ”ë° ë“±ë¡ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” CSê°€ ì ‘ìˆ˜ ë¡œê·¸ì— ë‚¨ì€ í•´ë‹¹ ì¿ í°ì˜ ì•ìë¦¬ë¥¼ ë³µì‚¬í•˜ì—¬ DBì—ì„œ ì¡°íšŒí•´ë´¤ëŠ”ë° ê²°ê³¼ê°€ ì—†ìŒ í•˜ì§€ë§Œ, ì‚¬ìš©ìê°€ ë³´ë‚´ì¤€ ìŠ¤í¬ë¦°ìƒ·ì— ìˆëŠ” ì¿ í° ë²ˆí˜¸ë¥¼ ì§ì ‘ ì…ë ¥í•´ì„œ ì¡°íšŒí•˜ë©´ ê²°ê³¼ê°€ ìˆìŒì›ì¸ íŒŒì•…í•˜ê¸° ì•„ë˜ ì½”ë“œë¡œ ë¡œê·¸ì—ì„œ ë³µì‚¬í•œ ê²½ìš°ì™€ ì§ì ‘ ì…ë ¥í•œ ê²½ìš°ë¥¼ ë¹„êµí•´ë³´ì•˜ë‹¤.import java.util.Scanner;public class Main { public static void main(String[] args) { Scanner sc = new Scanner(System.in); String s = sc.nextLine(); char[] chars = s.toCharArray(); for (char c : chars) { System.out.println(\"char to int for \"+ c + \"=\" +(int) c); } }} ì¢Œ : ë¡œê·¸ì—ì„œ ë³µì‚¬, ìš° : ì§ì ‘ ì…ë ¥ ì• ë„¤ ê¸€ì(M3AE)ì˜ decimal codeê°€ ë‹¤ë¥¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë¡œê·¸ì—ì„œ ë³µì‚¬í•œ M3AEëŠ” í‚¤ë¦´ ë¬¸ìë¼ê³  ë¶ˆë¦¬ëŠ” ë¬¸ìì—´ì´ë¼ê³  í•œë‹¤. ì™¼ìª½ì´ í‚¤ë¦´ ë¬¸ì, ì˜¤ë¥¸ìª½ì´ ë¼í‹´ ë¬¸ì (ì¼ë°˜ ì•ŒíŒŒë²³) - ì°¸ê³  ì‚¬ì´íŠ¸ìƒí™©ì¬í˜„1) (ì•„ì´í° ê¸°ì¤€) í‚¤ë¦´ ë¬¸ì í‚¤ë³´ë“œ ì„¸íŒ… 2) M3AEëŠ” í‚¤ë¦´ ë¬¸ì í‚¤ë³´ë“œë¡œ, ë‚˜ë¨¸ì§€ ë¬¸ìëŠ” ì¼ë°˜ ì˜ì–´ í‚¤ë³´ë“œë¡œ ì…ë ¥ 3) ì„œë²„ ë¡œê·¸ì—ì„œë„ M3AE ë¶€ë¶„ì€ í‚¤ë¦´ë¬¸ìë¡œ ì°í˜í•˜ì§€ë§Œ ì‹¤ì œ ì‚¬ìš©ìê°€ ì´ë ‡ê²Œ ì…ë ¥í–ˆì„ë¦¬ëŠ” ì ˆëŒ€ ì—†ì„ ê²ƒ ê°™ë‹¤.ê²°ë¡  ì‚¬ìš©ìë¶„ê»˜ í™•ì¸í•œ ê²°ê³¼ í‚¤ë³´ë“œ ì–´í”Œì„ ì‚¬ìš©í•˜ì…¨ê³  ê¸°ë³¸ í‚¤ë³´ë“œë¡œ ì…ë ¥í–ˆì„ ë•Œ ì •ìƒ ë“±ë¡ë¨ì„ í™•ì¸í–ˆë‹¤." }, { "title": "javax.net.ssl.SSLHandshakeException - No appropriate protocol (protocol is disabled or cipher suites are inappropriate)ì˜ ì›ì¸ì„ ì°¾ì•„ì„œ", "url": "/posts/mysql-ssl-handshake-fail/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "MySQL, SSL/TLS", "date": "2023-09-05 10:25:00 +0900", "snippet": "ìƒí™© ì‹ ê·œ ì´ì „í•œ ì„œë²„ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë„ìš°ëŠ”ë° ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ë¥¼ ë§ˆì£¼í•˜ê²Œëë‹¤. ì´ì „ ì„œë²„ì—ì„œì™€ ë‹¬ë¼ì§„ ì ì€ CentOS 7.4ì—ì„œ 7.9ë¡œ ë°”ë€ ê²ƒë°–ì— ì—†ëŠ”ë° ë­ê°€ ë¬¸ì œì¼ê¹Œ ì´í•´ê°€ ì˜ë˜ì§€ ì•Šì•˜ë‹¤.ë˜í•œ ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” ë¬¸ì œì—†ì´ ì‹¤í–‰ë˜ëŠ” ìƒí™©ì´ë¼ ì¶”ì ì´ ë” ì–´ë ¤ì› ë‹¤.Caused by: javax.net.ssl.SSLHandshakeException...", "content": "ìƒí™© ì‹ ê·œ ì´ì „í•œ ì„œë²„ì—ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë„ìš°ëŠ”ë° ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ë¥¼ ë§ˆì£¼í•˜ê²Œëë‹¤. ì´ì „ ì„œë²„ì—ì„œì™€ ë‹¬ë¼ì§„ ì ì€ CentOS 7.4ì—ì„œ 7.9ë¡œ ë°”ë€ ê²ƒë°–ì— ì—†ëŠ”ë° ë­ê°€ ë¬¸ì œì¼ê¹Œ ì´í•´ê°€ ì˜ë˜ì§€ ì•Šì•˜ë‹¤.ë˜í•œ ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” ë¬¸ì œì—†ì´ ì‹¤í–‰ë˜ëŠ” ìƒí™©ì´ë¼ ì¶”ì ì´ ë” ì–´ë ¤ì› ë‹¤.Caused by: javax.net.ssl.SSLHandshakeException: No appropriate protocol (protocol is disabled or cipher suites are inappropriate)\tat sun.security.ssl.HandshakeContext.&lt;init&gt;(HandshakeContext.java:171)\tat sun.security.ssl.ClientHandshakeContext.&lt;init&gt;(ClientHandshakeContext.java:103)\tat sun.security.ssl.TransportContext.kickstart(TransportContext.java:220)\tat sun.security.ssl.SSLSocketImpl.startHandshake(SSLSocketImpl.java:433)\tat com.mysql.jdbc.ExportControlled.transformSocketToSSLSocket(ExportControlled.java:186) ì—ëŸ¬ ë¡œê·¸ë¥¼ ë´¤ì„ë•Œ SSL í•¸ë“œì…°ì´í¬í•˜ëŠ” ê³¼ì •ì—ì„œ ì í•©í•œ í”„ë¡œí† ì½œ ë˜ëŠ” Cipher Suiteê°€ ì—†ì–´ì„œ ë°œìƒí•œ ì—ëŸ¬ë¡œ ë³´ì¸ë‹¤. ì—ëŸ¬ê°€ ë°œìƒí•œ ë¶€ë¶„ì˜ ì½”ë“œë¥¼ ì‚´í´ë³´ì sun.security.ssl.HandshakeContext#HandshakeContext ê²°ê³¼ì ìœ¼ë¡œ activeProtocolsê°€ ë¹ˆ ë¦¬ìŠ¤íŠ¸ë¼ ë°œìƒí•œ ì—ëŸ¬ì„ì„ ì•Œ ìˆ˜ ìˆë‹¤. ë¡œì»¬ í™˜ê²½ì—ì„œ ë””ë²„ê±°ë¡œ ì¶”ì í•´ë³´ì•˜ì„ ë•Œ, getActiveProtocols ë©”ì„œë“œì˜ ì²« ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì¸ enabledProtocolsì— ì„¸íŒ…ëœ í”„ë¡œí† ì½œì€ TLS1.0, TLS1.1ì´ì—ˆë‹¤. ì›ì¸ íŒŒì•…ì„ ìœ„í•´ì„œëŠ” ë‹¤ìŒ ë‘ ê°€ì§€ ì‚´í´ë´ì•¼ í•  ê²ƒ ê°™ë‹¤. enabledProtocolsì—” ì–´ë–»ê²Œ TLS1.0, TLS1.1ì´ ì„¸íŒ…ëœ ê²ƒì¼ê¹Œ ì™œ ê¸°ì¡´ ì„œë²„ì™€ ë¡œì»¬ì—ì„œëŠ” ë˜ê³  ì‹ ê·œ ì„œë²„ì—ì„œëŠ” ì•ˆë ê¹Œ ? ê·¸ëŸ¼, ë¨¼ì € ì „ë°˜ì ì¸ í˜¸ì¶œ íë¦„ì„ ì‚´í´ë³´ìí˜¸ì¶œ íë¦„ ì‚´í´ë³´ê¸° ì—ëŸ¬ ë¡œê·¸ ì½œ ìŠ¤íƒì—ì„œë„ ë³¼ ìˆ˜ ìˆë“¯ì´, ê°ì²´ í˜¸ì¶œ íë¦„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. com.mysql.jdbc.ExportControlled.transformSocketToSSLSocket-&gt; sun.security.ssl.SSLSocketImpl.startHandshake-&gt; sun.security.ssl.TransportContext.kickstart-&gt; sun.security.ssl.ClientHandshakeContext.&lt;init&gt;-&gt; sun.security.ssl.HandshakeContext.&lt;init&gt; ë‘ ë²ˆì§¸ ë‹¨ê³„ì¸ SSLSocketImplì˜ í´ë˜ìŠ¤ë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ SSLContextImpl, TransportContext í´ë˜ìŠ¤ë¥¼ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ì„ ì–¸í•˜ê³  ìˆê³  finalë¡œ ë˜ì–´ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ì¦‰, SSLSocketImplì´ ìƒì„±ë  ë•Œ, SSLContextImpl, TransportContext ê°ì²´ë„ ë°˜ë“œì‹œ í•¨ê»˜ ìƒì„±ë˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. public final class SSLSocketImpl extends BaseSSLSocketImpl implements SSLTransport { final SSLContextImpl sslContext; final TransportContext conContext; \t...} TransportContext.kickstart ì´í›„ì˜ íë¦„ì€ ClientHandshakeContext ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì¸ë°, ë§¨ ì²˜ìŒ sun.security.ssl.HandshakeContext#HandshakeContextì„ ë‹¤ì‹œ ì‚´í´ë³´ë©´ ìƒì„±ì íŒŒë¼ë¯¸í„°ë¡œ SSLContextImplê³¼ TransportContextê°€ í•„ìš”í•œ ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë‹¤ì‹œ ê±°ê¾¸ë¡œ ì •ë¦¬í•˜ë©´, ClientHandshakeContextëŠ” ìƒì„±ì‹œ HandshakeContext ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ê³ , HandshakeContextë¥¼ ìƒì„±í•˜ê¸° ìœ„í•´ì„œëŠ” SSLSocketImplì˜ SSLContextImplê³¼ TransportContextê°€ ë°˜ë“œì‹œ í•„ìš”í•˜ë‹¤. ê·¸ë¦¬ê³ , ì´ ë‘ ê°ì²´ëŠ” SSLSocketImplì´ ìƒì„±ë  ë•Œ í•¨ê»˜ ì„¸íŒ…ëœë‹¤. ë”°ë¼ì„œ, ExportControlled.transformSocketToSSLSocketì—ì„œ ì–´ë–»ê²Œ SSLSocketImplë¥¼ ìƒì„±í•˜ëŠ”ì§€, ê·¸ë¦¬ê³  ì—¬ê¸°ì— ì„¸íŒ…ë˜ëŠ” SSLContextImplê³¼ TransportContextì¤‘ íŠ¹íˆ (getActiveProtocolsì˜ íŒŒë¼ë¯¸í„°ê°€ ë˜ëŠ”) TransportContextì˜ SSLConfigurationì´ ì–´ë–¤ì§€ê°€ ì¤‘ìš”í•  ê²ƒ ê°™ë‹¤. ì´ì œ ìœ„ íë¦„ì„ ìƒê°í•˜ë©´ì„œ ì›ì¸ íŒŒì•…ì„ ìœ„í•œ ë‘ ê°€ì§€ ë¶€ë¶„ì„ ì²´í¬í•´ë³´ì.1. enabledProtocolsì—” ì–´ë–»ê²Œ TLS1.0, TLS1.1ì´ ì„¸íŒ…ëœ ê²ƒì¼ê¹Œ ? ExportControlled.transformSocketToSSLSocketì—ì„œëŠ” SocketFactoryë¥¼ í†µí•´ SSLSocketì„ ìƒì„±í•œë‹¤. (mysqlIO.mysqlconnection = sslFact.connect) ê·¸ë¦¬ê³  ë§¨ ì•„ë˜ ((SSLSocket) mysqlIO.mysqlConnection).setEnabledProtocols(allowedProtocols.toArray(new String[0])) ë¶€ë¶„ì„ ì£¼ëª©í•´ì„œ ë³´ì. ì—ëŸ¬ê°€ ë°œìƒí•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ DB ì„œë²„ëŠ” MySQL 5.7ë²„ì „ì„ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì—, ë”°ë¡œ enabledTLSProtocols ì˜µì…˜ì„ ì£¼ì§€ ì•Šì€ ì´ìƒ tryProtocols = new String[] { TLSv1_1, TLSv1 }; ì´ ë¶€ë¶„ì„ íƒˆ ê²ƒì´ê³ , configuredProtocolsì— ì´ ë‘ ê°œì˜ í”„ë¡œí† ì½œì´ ì„¸íŒ…ëœë‹¤. ê²°ê³¼ì ìœ¼ë¡œ, if (jvmSupportedProtocols.contains(protocol) &amp;&amp; configuredProtocols.contains(protocol)) ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” í”„ë¡œí† ì½œì€ TLS1.1, TLS1.0ë°–ì— ì—†ê¸°ë•Œë¬¸ì— enabledTLSProtocolsì— ë‘ ê°œì˜ í”„ë¡œí† ì½œì´ ì„¸íŒ…ëœë‹¤.2. ì™œ ë¡œì»¬ì—ì„œëŠ” ë˜ê³  ì„œë²„ì—ì„œëŠ” ì•ˆë ê¹Œ ? HandshakeContextì˜ getActiveProtocols ë©”ì„œë“œì—ì„œ algorithmConstraints.permits ë¶€ë¶„ì„ ìì„¸íˆ ì‚´í´ë³´ì•˜ë‹¤. sun.security.ssl.SSLAlgorithmConstraints#permitsì˜ tlsDisabledAlgConstraints.permits ë¶€ë¶„ì„ íƒ€ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. sun.security.util.DisabledAlgorithmConstraints#permits ìš”ì•½í•˜ìë©´, checkAlgorithmì—ì„œ í†µê³¼í•˜ì§€ ëª»í•œ TLS í”„ë¡œí† ì½œì€ availableí•˜ì§€ ì•ŠëŠ” í”„ë¡œí† ì½œì´ë©°, ì´ëŠ” í•´ë‹¹ í”„ë¡œí† ì½œì´ disabledAlgorithms ëª©ë¡ì— ìˆëŠ”ì§€ë¡œ íŒë‹¨í•œë‹¤. @Overridepublic final boolean permits(Set&lt;CryptoPrimitive&gt; primitives, String algorithm, AlgorithmParameters parameters) { if (!checkAlgorithm(disabledAlgorithms, algorithm, decomposer)) { return false; } if (parameters != null) { return algorithmConstraints.permits(algorithm, parameters); } return true;} disabledAlgorithmsì€ DisabledAlgorithmConstraintsê°€ ìƒì„±ë ë•Œ ì„¸íŒ…ëœë‹¤. PROPERTY_TLS_DISABLED_ALGSì€ \"jdk.tls.disabledAlgorithms\"ë¡œ ì„ ì–¸ë˜ì–´ìˆë‹¤. final class SSLAlgorithmConstraints implements AlgorithmConstraints { private static final AlgorithmConstraints tlsDisabledAlgConstraints = new DisabledAlgorithmConstraints(PROPERTY_TLS_DISABLED_ALGS, new SSLAlgorithmDecomposer()); public DisabledAlgorithmConstraints(String propertyName, AlgorithmDecomposer decomposer) { super(decomposer); disabledAlgorithms = getAlgorithms(propertyName); // propertyName = \"jdk.tls.disabledAlgorithms\" getAlgorithmsì€ $JAVA_HOME/jre/lib/security/java.security íŒŒì¼ì—ì„œ propertyNameì¸ jdk.tls.disabledAlgorithmsì— ì •ì˜ëœ ì•Œê³ ë¦¬ì¦˜(í”„í† í† ì½œ) ëª©ë¡ì„ ê°€ì ¸ì˜¨ë‹¤. ë¡œì»¬ì—ì„œ í™•ì¸í•´ë³´ë‹ˆ í•´ë‹¹ í”„ë¡œí¼í‹°ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì„ ì–¸ë˜ì–´ ìˆì—ˆë‹¤. (openjdk-1.8.0.242 ë²„ì „) jdk.tls.disabledAlgorithms=SSLv3, RC4, DES, MD5withRSA, DH keySize &lt; 1024, \\ EC keySize &lt; 224, 3DES_EDE_CBC, anon, NULL ì—¬ê¸°ì„œ ë¬¸ë“, ì‹ ê·œ ì„œë²„ì˜ ìë°” ë¦´ë¦¬ì¦ˆ ë²„ì „ì€ ë­ì§€? ë¼ëŠ” ìƒê°ì´ ë“¤ì—ˆê³ , í™•ì¸í•´ë³´ë‹ˆ ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ openjdk-1.8.0.242ì´ ì•„ë‹Œ openjdk8u362-b09 ë²„ì „ì´ ì‚¬ìš©ë˜ê³  ìˆì—ˆë‹¤. í•´ë‹¹ ë²„ì „ì„ ë¡œì»¬ì— ì„¤ì¹˜í•´ì„œ ì‚´í´ë³¸ ê²°ê³¼, jdk.tls.disabledAlgorithms í”„ë¡œí¼í‹°ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì„ ì–¸ë˜ì–´ ìˆì—ˆë‹¤. (TLSv1, TLSv1.1ì´ ì¶”ê°€ë˜ì–´ìˆë‹¤) jdk.tls.disabledAlgorithms=SSLv3, TLSv1, TLSv1.1, RC4, DES, MD5withRSA, \\ DH keySize &lt; 1024, EC keySize &lt; 224, 3DES_EDE_CBC, anon, NULL, \\ include jdk.disabled.namedCurves ì´ë¡œì¨ ê¸°ë‚˜ê¸´ ì‚½ì§ˆì˜ ì‹œê°„ì„ ëë‚¼ ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤..!ì •ë¦¬ MySQL ë“œë¼ì´ë²„(mysql-connector-java 5.1.46 ë²„ì „ ê¸°ì¤€)ì—ì„œ enabledTLSProtocolsê³¼ ê°™ì€ ì„¸íŒ…ì´ ë³„ë„ë¡œ ì •ì˜ë˜ì–´ìˆì§€ ì•Šìœ¼ë©´, MySQL 5.7 ì„œë²„ì™€ SSL í•¸ë“œì…°ì´í¬ë¥¼ ìœ„í•œ í”„ë¡œí† ì½œë¡œ TLS1.0, TLS.1.1ì´ ì‚¬ìš©ëœë‹¤. ê°™ì€ ìë°” ë²„ì „ì´ë”ë¼ë„ ë¦´ë¦¬ì¦ˆ ë²„ì „ì— ë”°ë¼ SSL í†µì‹ ì‹œ disableëœ í”„ë¡œí† ì½œì´ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤. ì´ë¡œ ì¸í•´, SSL í•¸ë“œì…°ì´í¬ê°€ ì œëŒ€ë¡œ ì´ë£¨ì–´ì§€ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤. (ì´ì „ê³¼ ë‹¬ë¼ì§„ê²Œ ì—†ëŠ”ë° ì™œ ë¬¸ì œê°€ ìƒê¸°ì§€..? ë¼ê³  ì„£ë¶ˆë¦¬ ìƒê°í•˜ì§€ ë§ì)ìƒê°í•´ë³¸ ì¡°ì¹˜ ë°©ì•ˆ MySQL ë²„ì „ ì—…ê·¸ë ˆì´ë“œ enabledTLSProtocols ì •ì˜ jdbc:mysql://{ip}:{port}/{dbName}?&amp;enabledTLSProtocols={TLS_VERSION} í•´ë‹¹ MySQL ì„œë²„ì—ì„œ ì§€ì›í•˜ëŠ” TLS í”„ë¡œí† ì½œì´ì–´ì•¼í•œë‹¤. ì§€ì›í•˜ëŠ” í”„ë¡œí† ì½œ í™•ì¸ ë°©ë²• : show variables like 'tls_%'; useSSL=false (í•´ë‹¹ ì˜µì…˜ì„ ì£¼ë©´ SSL í†µì‹  ìì²´ë¥¼ í•˜ì§€ ì•ŠëŠ”ë‹¤.) jdbc:mysql://{ip}:{port}/{dbName}?&amp;useSSL=false com.mysql.jdbc.MysqlIO#doHandshake if (!this.connection.getUseSSL()) { ... } else { negotiateSSLConnection(user, password, database, packLength); " }, { "title": "HTTPS ìš”ì²­ì´ HTTPë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë˜ëŠ” í˜„ìƒ", "url": "/posts/https-to-http-redirect/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "HTTP", "date": "2023-06-14 22:25:00 +0900", "snippet": "ìƒí™© ì„œë²„ ì´ì „ ì‘ì—… í›„ ë‹´ë‹¹ ì›¹ì‚¬ì´íŠ¸ì—ì„œ URL ë¦¬ë‹¤ì´ë ‰íŠ¸ì‹œ í˜ì´ì§€ ì‘ë‹µì´ ì—†ëŠ” ê²½ìš°ê°€ ë°œìƒí•¨ íŠ¹ì • ì‚¬ìš©ìì—ê²Œì„œëŠ” ì´ëŸ° í˜„ìƒì´ ë°œìƒí•˜ì§€ ì•ŠìŒ í™•ì¸í•´ë³´ë‹ˆ HTTPS ìš”ì²­ì´ HTTPë¡œ ë°”ê»´ì„œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¨ì›ì¸ íŒŒì•…í•˜ê¸° ìš”ì²­ì´ WASì— ë„ë‹¬í•˜ê¸°ê¹Œì§€ì˜ íë¦„ (ë¸Œë¼ìš°ì €) ---- https ---- (L4/L7 ìŠ¤ìœ„ì¹˜) ---- http...", "content": "ìƒí™© ì„œë²„ ì´ì „ ì‘ì—… í›„ ë‹´ë‹¹ ì›¹ì‚¬ì´íŠ¸ì—ì„œ URL ë¦¬ë‹¤ì´ë ‰íŠ¸ì‹œ í˜ì´ì§€ ì‘ë‹µì´ ì—†ëŠ” ê²½ìš°ê°€ ë°œìƒí•¨ íŠ¹ì • ì‚¬ìš©ìì—ê²Œì„œëŠ” ì´ëŸ° í˜„ìƒì´ ë°œìƒí•˜ì§€ ì•ŠìŒ í™•ì¸í•´ë³´ë‹ˆ HTTPS ìš”ì²­ì´ HTTPë¡œ ë°”ê»´ì„œ ë¦¬ë‹¤ì´ë ‰íŠ¸ë¨ì›ì¸ íŒŒì•…í•˜ê¸° ìš”ì²­ì´ WASì— ë„ë‹¬í•˜ê¸°ê¹Œì§€ì˜ íë¦„ (ë¸Œë¼ìš°ì €) ---- https ---- (L4/L7 ìŠ¤ìœ„ì¹˜) ---- https ---- (ì›¹ì„œë²„) ---- http ---- (WAS) ì¸í„°ì…‰í„°ì—ì„œ HttpServletResponse.sendRedirect í•˜ëŠ” ë¶€ë¶„ì„ íƒ€ê³  ë“¤ì–´ê°€ë‹¤ë³´ë©´ í—¤ë”ì— Locationì„ ì„¸íŒ…í•˜ëŠ” ì½”ë“œë¥¼ ë§Œë‚  ìˆ˜ ìˆë‹¤. org.apache.catalina.connector.Response#sendRedirect elseì ˆì— toAbsoulte ë©”ì„œë“œì—ì„œ ìš”ì²­ í”„ë¡œí† ì½œì€ request.getScheme() ì„ í†µí•´ ê°€ì ¸ì˜¨ë‹¤.org.apache.catalina.connector.Response#toAbsoluteì¦‰, WEBì—ì„œ WASë¡œ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì€ httpì´ë¯€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ urlì´ httpë¡œ ë§Œë“¤ì–´ì§€ê²Œ ë˜ì—ˆë˜ ê²ƒì˜ë¬¸ì  ì´ì „ ì„œë²„ êµ¬ì„±ì—ì„œëŠ” ì´ëŸ° ì´ìŠˆ ì œë³´ëœ ì ì´ ì—†ì—ˆìŒ =&gt; ì´ì „ L4/L7 ìŠ¤ìœ„ì¹˜ì—ì„œ 80 í¬íŠ¸ê°€ í—ˆìš© ë˜ì–´ìˆì—ˆìŒ íŠ¹ì • ì‚¬ìš©ìëŠ” ì ‘ê·¼ì´ ë¨=&gt; HSTSë¡œ ì¸í•´ HTTPSë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ ë˜ì—ˆìŒ (ì›¹ì„œë²„ ì„¤ì • : Strict-Transport-Security: max-age=31536000) â€» HSTSë€ ? ê³µì‹ë¬¸ì„œ ì°¸ê³  HTTP Strict-Transport-Security ì‘ë‹µ í—¤ë”(ì¢…ì¢… HSTSë¡œ ì¶•ì•½ë¨)ëŠ” ì‚¬ì´íŠ¸ê°€ HTTPSë¥¼ í†µí•´ì„œë§Œ ì ‘ê·¼ë˜ì–´ì•¼ í•˜ë©° í–¥í›„ HTTPë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ì´íŠ¸ì— ì ‘ê·¼í•˜ë ¤ëŠ” ëª¨ë“  ì‹œë„ëŠ” ìë™ìœ¼ë¡œ HTTPSë¡œ ë³€í™˜ë˜ì–´ì•¼ í•¨ì„ ë¸Œë¼ìš°ì €ì— ì•Œë¦½ë‹ˆë‹¤. HTTPSë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ì´íŠ¸ì— ì²˜ìŒìœ¼ë¡œ ì ‘ê·¼í•˜ê³  Strict-Transport-Security í—¤ë”ë¥¼ ë°˜í™˜í•˜ë©´ ë¸Œë¼ìš°ì €ê°€ ì´ ì •ë³´ë¥¼ ê¸°ë¡í•˜ê³ , ì´í›„ì— HTTPë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ì´íŠ¸ë¥¼ ë¡œë“œí•˜ë ¤ê³  ì‹œë„í•  ë•Œ ìë™ìœ¼ë¡œ HTTPSë¥¼ ëŒ€ì‹  ì‚¬ìš©í•©ë‹ˆë‹¤.ì¡°ì¹˜í•´ê²°ë°©ë²•1 : í†°ìº£ use-relative-redirects ì†ì„± ì‚¬ìš© ê³µì‹ë¬¸ì„œ ì„¤ëª… â€œsendRedirect í˜¸ì¶œë¡œ ìƒì„±ëœ HTTP 1.1 ì´ìƒì˜ Location í—¤ë”ê°€ ìƒëŒ€ ë¦¬ë””ë ‰ì…˜ì„ ì‚¬ìš©í• ì§€ ì ˆëŒ€ ë¦¬ë””ë ‰ì…˜ì„ ì‚¬ìš©í• ì§€ ì—¬ë¶€ (ê¸°ë³¸ê°’ : false)â€ server.tomcat.use-relative-redirects=trueë¡œ ì„¸íŒ…í•˜ë©´ response.sendRedirect(\"/ìƒëŒ€ê²½ë¡œ\")ë¡œ í˜¸ì¶œì‹œ ë¦¬ë‹¤ì´ë ‰íŠ¸ urlì´ ìƒëŒ€ê²½ë¡œë¡œ ì§€ì •ë¨ (ìš”ì²­ í”„ë¡œí† ì½œ ê·¸ëŒ€ë¡œ ì‚¬ìš©) ê´€ë ¨ ì½”ë“œ (ìœ„ì—ì„œ ì‚´í´ë³¸ org.apache.catalina.connector.Response#sendRedirectì˜ ifì ˆ) ë¦¬ë‹¤ì´ë ‰íŠ¸ urlì´ ìƒëŒ€ê²½ë¡œë¡œ ì§€ì •ëì„ë•Œ, httpsë¡œ ì¬ìš”ì²­í•˜ëŠ” ëª¨ìŠµí•´ê²°ë°©ë²•2 : í†°ìº£ì—ì„œ X-Forwarded-Proto ì¸ì‹í•  ìˆ˜ ìˆë„ë¡ í•˜ê¸° ì›¹ ì„œë²„ì—ì„œ í†°ìº£ìœ¼ë¡œ ìš”ì²­ì‹œ X-Forwarded-Proto í—¤ë”ì— httpsë¥¼ ë‹´ì•„ì„œ ë³´ë‚¸ë‹¤. ê´€ë ¨ ì•„íŒŒì¹˜ ì„¤ì • :RequestHeader set X-Forwarded-Proto \"https\" í†°ìº£ì—ì„œ ë¦¬ë‹¤ì´ë ‰íŠ¸ url ì§€ì •ì‹œ requestì— ë‹´ê¸´ X-Forwarded-Proto í™œìš©í•˜ê²Œ í•œë‹¤. ì´ë ‡ê²Œ í•˜ë ¤ë©´ response.sendRedirectì‹œ response êµ¬í˜„ì²´ê°€ org.springframework.web.filter íŒ¨í‚¤ì§€ì˜ ForwardedHeaderFilter.ForwardedHeaderExtractingResponseê°€ ë˜ë„ë¡ í•´ì•¼í•¨ ì´ë¥¼ ìœ„í•´, ì•„ë˜ì™€ ê°™ì´ í•„í„°ë¥¼ ë¹ˆìœ¼ë¡œ ë“±ë¡ (ë¶€íŠ¸ 2.1 ë²„ì „ë¶€í„°ëŠ” ì§ì ‘ë“±ë¡í•˜ì§€ ì•Šê³  í†°ìº£ì— ê´€ë ¨ ì„¤ì •ë§Œ í•´ì£¼ë©´ ìë™ìœ¼ë¡œ ì„¸íŒ…ë˜ëŠ” ê²ƒ ê°™ìŒ : ê´€ë ¨ ê¸€Â - ë‹´ë‹¹ ì›¹ì‚¬ì´íŠ¸ëŠ” 2.0.3v ì‚¬ìš©) @Configurationpublic class XForwardedFilterConfig { @Bean public FilterRegistrationBean&lt;ForwardedHeaderFilter&gt; forwardedHeaderFilter() { FilterRegistrationBean&lt;ForwardedHeaderFilter&gt; registrationBean = new FilterRegistrationBean&lt;&gt;(); registrationBean.setFilter(new ForwardedHeaderFilter()); return registrationBean; }} ë¦¬ë‹¤ì´ë ‰íŠ¸ urlì´ httpsë¡œ ì„¸íŒ…ë¨ì°¸ê³ . HTTP ë¦¬ë‹¤ì´ë ‰íŠ¸ ê´€ë ¨ ìƒíƒœ ì½”ë“œ Â  301 302 303 307 308 Status Moved Permanently Found See Other Temporary Redirect Permanent Redirect ì˜êµ¬ì  ë¦¬ë‹¤ì´ë ‰ì…˜ O X X X O ê¸°ì¡´ ìš”ì²­ ë³€ê²½ O (POST -&gt; GET) O (POST -&gt; GET) O (ë¬´ì¡°ê±´ GETìœ¼ë¡œ ë³€ê²½) X X â€» ì˜êµ¬ì  ë¦¬ë‹¤ì´ë ‰ì…˜ì—ì„œëŠ” ê¸°ì¡´ URLì— ëŒ€í•œ ëª¨ë“  SEO ê°’ê³¼ ë§í¬ ë¦¬ì†ŒìŠ¤ê°€ ìƒˆ URLë¡œ ì´ì „." }, { "title": "wait_timeoutì„ ì´ˆê³¼í•œ ì»¤ë„¥ì…˜ì„ ì‚¬ìš©í•´ì„œ ê²ªì€ ì´ìŠˆ (The last packet successfully received from the server was ... milliseconds ago)", "url": "/posts/wait-timeout-exceed-connection/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "Connection Pool, MySQL", "date": "2023-05-02 10:25:00 +0900", "snippet": "ìƒí™© ìµœê·¼ ë°°ì¹˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì»¤ë„¥ì…˜ í’€ ê´€ë ¨ ì„¤ì •ì„ ë³€ê²½í•œ í›„ MMS ë°œì†¡í•˜ëŠ” jobì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ ë°œìƒ Cause: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException:The last packet successfully received from the server was 104,983,...", "content": "ìƒí™© ìµœê·¼ ë°°ì¹˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì»¤ë„¥ì…˜ í’€ ê´€ë ¨ ì„¤ì •ì„ ë³€ê²½í•œ í›„ MMS ë°œì†¡í•˜ëŠ” jobì—ì„œ ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ ë°œìƒ Cause: com.mysql.jdbc.exceptions.jdbc4.CommunicationsException:The last packet successfully received from the server was 104,983,345 milliseconds ago.The last packet sent successfully to the server was 104,983,347 milliseconds ago.is longer than the server configured value of 'wait_timeout'. ì»¤ë„¥ì…˜ í’€ ê´€ë ¨ ì„¤ì • ë³€ê²½ ì „ initial-size: 0 // ì»¤ë„¥ì…˜ í’€ ìµœì´ˆ ì‚¬ì´ì¦ˆmax-active: 8 // ìµœëŒ€ë¡œ í™œì„±í™”í•  ì»¤ë„¥ì…˜ ê°¯ìˆ˜max-idle: 8 // ì»¤ë„¥ì…˜ í’€ì— ìœ ì§€í•  ìµœëŒ€ ì»¤ë„¥ì…˜ ê°¯ìˆ˜min-idle: 0 // ì»¤ë„¥ì…˜ í’€ì— ìœ ì§€í•  ìµœì†Œ ì»¤ë„¥ì…˜ ê°¯ìˆ˜max-wait : 3ì´ˆ // DB ì»¤ë„¥ì…˜ ì–»ê¸°ìœ„í•´ ëŒ€ê¸°í•˜ëŠ” ìµœëŒ€ ì‹œê°„ ë³€ê²½ í›„ initial-size: 20 // ì»¤ë„¥ì…˜ í’€ ìµœì´ˆ ì‚¬ì´ì¦ˆmax-active: 20 // ìµœëŒ€ë¡œ í™œì„±í™”í•  ì»¤ë„¥ì…˜ ê°¯ìˆ˜max-idle: 20 // ì»¤ë„¥ì…˜ í’€ì— ìœ ì§€í•  ìµœëŒ€ ì»¤ë„¥ì…˜ ê°¯ìˆ˜min-idle: 20 // ì»¤ë„¥ì…˜ í’€ì— ìœ ì§€í•  ìµœì†Œ ì»¤ë„¥ì…˜ ê°¯ìˆ˜max-wait : 5ì´ˆ // DB ì»¤ë„¥ì…˜ ì–»ê¸°ìœ„í•´ ëŒ€ê¸°í•˜ëŠ” ìµœëŒ€ ì‹œê°„ ì—ëŸ¬ ì›ì¸ ì°¾ê¸° ì¶œì²˜ : https://kakaocommerce.tistory.com/45 MySQL ì„œë²„ ì…ì¥ì—ì„œ JDBC ì»¤ë„¥ì…˜ì´ Idleì¸ ìƒíƒœë¡œ wait_timeout(default 28800ì´ˆ) ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•Šì„ ê²½ìš°í•´ë‹¹ ì»¤ë„¥ì…˜ì„ close í•˜ì—¬ í• ë‹¹ëœ ë¦¬ì†ŒìŠ¤ë¥¼ íšŒìˆ˜í•˜ê²Œ ëœë‹¤.ì´ëŸ° ê²½ìš° TCP ë ˆë²¨ì—ì„œ í•´ë‹¹ socketì´ ì •ë¦¬ê°€ ë˜ë”ë¼ë„ JDBC ë“œë¼ì´ë²„ë‚˜ ì»¤ë„¥ì…˜ í’€ì—ì„œëŠ” close ì—¬ë¶€ë¥¼ ë°”ë¡œ ì•Œ ìˆ˜ ì—†ê³ í•´ë‹¹ ì»¤ë„¥ì…˜ì„ ì‚¬ìš©í•˜ë ¤ê³  ì‹œë„ í•  ë•Œì—ì„œì•¼ ë¹„ë¡œì†Œ ì»¤ë„¥ì…˜ì— ë¬¸ì œê°€ ìˆëŠ” ê²ƒì„ ì•Œê²Œ ëœë‹¤.ì´ëŸ° ìƒí™©ì¼ ê²½ìš° ìµœê·¼ì— ì„±ê³µí•œ í†µì‹ ì´ XXX,XXX milliseonds ì´ì „ì´ë¼ê³  ìœ„ì™€ ê°™ì€ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•˜ê²Œ ëœë‹¤. â€» ì°¸ê³  CUBRIDëŠ” ìì²´ì ìœ¼ë¡œ ì»¤ë„¥ì…˜ì„ ê´€ë¦¬í•˜ê³  ìë™ìœ¼ë¡œ ë‹¤ì‹œ ì—°ê²°í•˜ë„ë¡ êµ¬í˜„ë˜ì–´ìˆë‹¤ê³  í•œë‹¤. (ì¶œì²˜ : https://d2.naver.com/helloworld/5102792)ì—ëŸ¬ ì¬í˜„í•´ë³´ê¸° ê²€ì¦í•´ë³´ê³  ì‹¶ì€ ë¶€ë¶„ idle ìƒíƒœì¸ ì»¤ë„¥ì…˜ì¤‘ wait_timeout ì§€ë‚˜ë©´ mysql ì„œë²„ì—ì„œ í•´ë‹¹ ì»¤ë„¥ì…˜ ë§Œí¼ì˜ ì„¸ì…˜(ìŠ¤ë ˆë“œ) ê°¯ìˆ˜ê°€ ê°ì†Œí•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë‹«íŒ ì„¸ì…˜ì— ë§µí•‘ëœ ì»¤ë„¥ì…˜ìœ¼ë¡œ ì§ˆì˜ ìš”ì²­í•˜ëŠ” ê²½ìš° ìœ„ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. ê²€ì¦ ì½”ë“œ ê²€ì¦ ê³¼ì • ì½”ë“œ ì‹¤í–‰ ì „ mysql workbenchì—ì„œ í™•ì¸í•œ í˜„ì¬ ì—´ë ¤ìˆëŠ” ì»¤ë„¥ì…˜ ê°¯ìˆ˜ (show status where variable_name = 'Threads_connected';) ì»¤ë„¥ì…˜ ì—°ê²° (ë‘ ê°œì˜ ì»¤ë„¥ì…˜ ì¤‘ í•˜ë‚˜ì˜ ì»¤ë„¥ì…˜ì—ë§Œ wait_timeout 5ì´ˆ ì„¤ì • : â‘ , ë‚˜ë¨¸ì§€ í•˜ë‚˜ëŠ” default ê°’ì¸ 28800ì´ˆ) wait_timeout ì´ìƒ ëŒ€ê¸° (â‘¡) â€œidle ìƒíƒœì¸ ì»¤ë„¥ì…˜ì¤‘ wait_timeout ì§€ë‚˜ë©´ mysql ì„œë²„ì—ì„œ í•´ë‹¹ ì»¤ë„¥ì…˜ ë§Œí¼ì˜ ì„¸ì…˜(ìŠ¤ë ˆë“œ) ê°¯ìˆ˜ê°€ ê°ì†Œí•œ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.â€ ì— ëŒ€í•´ ê²€ì¦ ì™„ë£Œ mysql ì„œë²„ì—ì„œ ë‹«íŒ ì»¤ë„¥ì…˜ì— ì§ˆì˜í• ì‹œ ë™ì¼í•œ ì—ëŸ¬ ë°œìƒ(â‘¢) â€œë‹«íŒ ì„¸ì…˜ì— ë§µí•‘ëœ ì»¤ë„¥ì…˜ìœ¼ë¡œ ì§ˆì˜ ìš”ì²­í•˜ëŠ” ê²½ìš° ìœ„ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤.â€ ì— ëŒ€í•´ ê²€ì¦ ì™„ë£Œ Exception in thread \"main\" com.mysql.cj.jdbc.exceptions.CommunicationsException:The last packet successfully received from the server was 107,054 milliseconds ago. (ì¤‘ëµ ...) ì˜ë¬¸ì  MMS ë°œì†¡ jobì€ 5ë¶„ë§ˆë‹¤ ëŒë©´ì„œ ë°œì†¡ ëŒ€ìƒì´ ìˆëŠ”ì§€ ì¡°íšŒí•œë‹¤. ê·¸ë¦¬ê³  ë°œì†¡ job ì´ì™¸ì—ë„ ì£¼ê¸°ì ìœ¼ë¡œ ë„ëŠ” ë‹¤ë¥¸ jobë“¤ë„ ìˆê¸° ë•Œë¬¸ì— ì»¤ë„¥ì…˜ í’€ì— ìˆëŠ” ì»¤ë„¥ì…˜ë“¤ì´ ì£¼ê¸°ì ìœ¼ë¡œ ì‚¬ìš©ë  ê²ƒ ê°™ì€ë° ì™œ ì»¤ë„¥ì…˜ì´ ëŠì–´ì§„ê±¸ê¹Œ ?ì»¤ë„¥ì…˜ í’€ ë‚´ë¶€ ì‚´í´ë³´ê¸° tomcat-jdbc-7.0.56 org.apache.tomcat.jdbc.pool.ConnectionPoolì»¤ë„¥ì…˜ í’€ ì´ˆê¸°í™” BlockingQueue êµ¬í˜„ í´ë˜ìŠ¤ í• ë‹¹ idle ì»¤ë„¥ì…˜ íëŠ” FairBlockingQueue(https://tomcat.apache.org/tomcat-7.0-doc/api/org/apache/tomcat/jdbc/pool/FairBlockingQueue.html) ì‹¤ì œ ì»¤ë„¥ì…˜ í• ë‹¹ (busy íì— ë“¤ì–´ê°€ê²Œë¨) busy í -&gt; idle íë¡œ ì´ë™ ì»¤ë„¥ì…˜ ê°€ì ¸ì˜¤ê¸° idle íì˜ ë§¨ ì•ì— ìˆëŠ” ì»¤ë„¥ì…˜ ê°€ì ¸ì˜´ì»¤ë„¥ì…˜ ë°˜ë‚© idle íì˜ offer ë©”ì„œë“œ í˜¸ì¶œ ë°˜ë‚©ëœ ì»¤ë„¥ì…˜ì´ ë§¨ ì•ì— ë“¤ì–´ê°€ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì˜ë¬¸ì  í•´ê²°í•˜ê¸° MMS ë°œì†¡ jobì€ 5ë¶„ë§ˆë‹¤ ëŒë©´ì„œ ë°œì†¡ ëŒ€ìƒì´ ìˆëŠ”ì§€ ì¡°íšŒí•œë‹¤. ê·¸ë¦¬ê³  ë°œì†¡ job ì´ì™¸ì—ë„ ì£¼ê¸°ì ìœ¼ë¡œ ë„ëŠ” ë‹¤ë¥¸ jobë“¤ë„ ìˆê¸° ë•Œë¬¸ì— ì»¤ë„¥ì…˜ í’€ì— ìˆëŠ” ì»¤ë„¥ì…˜ë“¤ì´ ì£¼ê¸°ì ìœ¼ë¡œ ì‚¬ìš©ë  ê²ƒ ê°™ì€ë° ì™œ ì»¤ë„¥ì…˜ì´ ëŠì–´ì§„ê±¸ê¹Œ ? MMS ë°œì†¡ ë¡œì§ ë°œì†¡ ëŒ€ìƒ ì¡°íšŒ(ì»¤ë„¥ì…˜1) -&gt; ë°œì†¡ &amp; ë°œì†¡ ê´€ë ¨ ì •ë³´ ì—…ë°ì´íŠ¸(ë¹„ë™ê¸° í˜¸ì¶œ, ì»¤ë„¥ì…˜2..n) ì‚¬ìš©ë˜ëŠ” ì»¤ë„¥ì…˜ ê°¯ìˆ˜ ì¶”ì •í•´ë³´ê¸° idle íì— ë³´ê´€ë˜ëŠ” ì»¤ë„¥ì…˜ ì¤‘ MMS ë°œì†¡ ê±´ì´ ì—†ëŠ” ê²½ìš°ì—” ë§¨ ì• ì»¤ë„¥ì…˜ í•˜ë‚˜ ë˜ëŠ” ìˆë”ë¼ë„ ë§¨ ì•ë¶€í„° nê°œì˜ ì»¤ë„¥ì…˜ì´ ì‚¬ìš©ë  ê²ƒ (ë™ì‹œ ë°œì†¡ ê±´ìˆ˜ê°€ ë§ì§€ ì•Šìœ¼ë©´ nì˜ í¬ê¸°ê°€ ì‘ì„ ê²ƒ.) MMS ë°œì†¡ job ì´ì™¸ì— ì»¤ë„¥ì…˜ì„ ì—¬ëŸ¬ ê°œ ì‚¬ìš©í•˜ëŠ” jobë“¤ì€ ê±°ì˜ ì—†ê³  ë˜í•œ ë™ì‹œì— jobë“¤ì´ ë„ëŠ” ê²½ìš°ë„ ë§ì§€ ì•Šê¸° ë•Œë¬¸ì— nê°œì˜ ì»¤ë„¥ì…˜ì´ ì‚¬ìš©ëœë‹¤ í•˜ë”ë¼ë„ nì˜ í¬ê¸°ëŠ” ì‘ì„ ê²ƒì´ë‹¤. ìœ„ì—ì„œ ì‚´í´ë³´ì•˜ë“¯ì´ ì»¤ë„¥ì…˜ ë°˜ë‚©ì‹œ íì˜ ë§¨ ë’¤ê°€ ì•„ë‹Œ ë§¨ ì•ì— ì¶”ê°€ë˜ê¸° ë•Œë¬¸ì—, ì‚¬ìš©ë˜ëŠ” ì»¤ë„¥ì…˜ë§Œ ê³„ì† ì‚¬ìš©ë  ê²ƒ ê²°ê³¼ì ìœ¼ë¡œ, ì•ì— ëª‡ ê°œì˜ ì»¤ë„¥ì…˜ë§Œ ê³„ì† ì‚¬ìš©ë˜ë‹¤ê°€ MMS ë°œì†¡ê±´ì´ ì—¬ëŸ¬ ê±´ì¸ ê²½ìš° 8ì‹œê°„(wait_timeout)ì´ìƒ ì‚¬ìš©ë˜ì§€ ì•Šì•˜ë˜ ë’¤ìª½ì˜ ì»¤ë„¥ì…˜(ì´ë¯¸ ì„¸ì…˜ì´ ë‹«íŒ)ê¹Œì§€ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì—ëŸ¬ê°€ ë°œìƒí–ˆë˜ ê²ƒë¬¸ì œ í•´ê²°í•˜ê¸°1. ì»¤ë„¥ì…˜ í’€ì— idle ì»¤ë„¥ì…˜ ê°¯ìˆ˜ 0ê°œë¡œ ìœ ì§€ ì»¤ë„¥ì…˜ ì •ë¦¬ëŠ” ConnectionPool.PoolCleanerì—ì„œ ë‹´ë‹¹ (Evictor ìŠ¤ë ˆë“œ) ì‚¬ì‹¤ìƒ ì»¤ë„¥ì…˜ í’€ ì‚¬ìš©í•˜ëŠ” ì´ì ì´ ì‚¬ë¼ì§€ëŠ” ê²ƒ(?) íŠ¸ë˜í”½ ë§ì§€ ì•Šì•„ì„œ í˜„ì¬ë¡œì„œ ìš´ì˜ìƒ ì´ìŠˆëŠ” ì—†ìŒ2. PoolCleanerì—ì„œ ì£¼ê¸°ì ìœ¼ë¡œ ì»¤ë„¥ì…˜ ìœ íš¨ì„± ì²´í¬í•˜ë„ë¡ validationQuery, timeBetweenEvictionRunsMillis, testWhileIdle ë“±ì˜ ì†ì„± í™œìš©í•˜ì—¬ ì£¼ê¸°ì ìœ¼ë¡œ ì»¤ë„¥ì…˜ ìœ íš¨ì„± ê²€ì‚¬ ìœ ì˜ì‚¬í•­ (ì¶œì²˜ : https://d2.naver.com/helloworld/5102792) - commons dbcp 1.x ê¸°ì¤€ Evictor ìŠ¤ë ˆë“œëŠ” ë™ì‘ ì‹œì— ì»¤ë„¥ì…˜ í’€ì— ì ê¸ˆ(lock)ì„ ê±¸ê³  ë™ì‘í•˜ê¸° ë•Œë¬¸ì— ë„ˆë¬´ ìì£¼ ì‹¤í–‰í•˜ë©´ ì„œë¹„ìŠ¤ ì‹¤í–‰ì— ë¶€ë‹´ì„ ì¤„ ìˆ˜ ìˆë‹¤. ë˜í•œ numTestsPerEvictionRun ê°’ì„ í¬ê²Œ ì„¤ì •í•˜ë©´ Evictor ìŠ¤ë ˆë“œê°€ ê²€ì‚¬í•´ì•¼ í•˜ëŠ” ì»¤ë„¥ì…˜ ê°œìˆ˜ê°€ ë§ì•„ì ¸ ì ê¸ˆ ìƒíƒœì— ìˆëŠ” ì‹œê°„ì´ ê¸¸ì–´ì§€ë¯€ë¡œ ì—­ì‹œ ì„œë¹„ìŠ¤ ì‹¤í–‰ì— ë¶€ë‹´ì„ ì¤„ ìˆ˜ ìˆë‹¤. ê²Œë‹¤ê°€ ì»¤ë„¥ì…˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìœ„í•œ í…ŒìŠ¤íŠ¸ ì˜µì…˜(testOnBorrow, testOnReturn, testWhileIdle)ì„ ì–´ë–»ê²Œ ì„¤ì •í•˜ëŠëƒì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì•ˆì •ì„±ê³¼ DBMSì˜ ë¶€í•˜ê°€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë¯€ë¡œ Evictor ìŠ¤ë ˆë“œì™€ í…ŒìŠ¤íŠ¸ ì˜µì…˜ì„ ì‚¬ìš©í•  ë•ŒëŠ” ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ìì™€ ìƒì˜í•´ì„œ ì‚¬ìš©í•˜ëŠ” DBMSì— ìµœì í™”ë  ìˆ˜ ìˆëŠ” ì˜µì…˜ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤. 3. autoReconnect ? ë™ì‘ ë°©ì‹ ì»¤ë„¥ì…˜ì´ ëŠì–´ì§„ ê²½ìš° ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ê³  í•´ë‹¹ íŠ¸ëœì­ì…˜ ì¢…ë£Œì‹œí‚´. ì´í›„ ìƒˆë¡œìš´ íŠ¸ëœì­ì…˜ì—ì„œ í•´ë‹¹ ì»¤ë„¥ì…˜ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ë‹¤ì‹œ ì—°ê²° ì‹œë„. ë”°ë¼ì„œ, autoReconnect ì†ì„±ì´ trueì´ë”ë¼ë„ ì»¤ë„¥ì…˜ì´ ëŠê²¨ì„œ ë°œìƒí•˜ëŠ” ìµœì´ˆì˜ ì—ëŸ¬ë¥¼ ë§‰ì„ìˆ˜ëŠ” ì—†ë‹¤. ê³µì‹ ë¬¸ì„œ ì—ì„œëŠ” ë°ì´í„° ì¼ê´€ì„±, ì„¸ì…˜ ìƒíƒœ ë“±ì˜ ì´ìœ ë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•˜ì§€ ì•ŠëŠ”ë‹¤." }, { "title": "MySQLì—ì„œ ì‹œê°„,ë‚ ì§œ ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ ë°˜ì˜¬ë¦¼ë˜ëŠ” í˜„ìƒ (2)", "url": "/posts/mysql-round-up-part2/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "MySQL, MyBatis", "date": "2023-03-29 22:25:00 +0900", "snippet": "ìƒí™© ì´ì „ í¬ìŠ¤íŒ… ì—ì„œ MySQL ë°˜ì˜¬ë¦¼ í˜„ìƒìœ¼ë¡œ ì¸í•´ ê²ªì—ˆë˜ ì´ìŠˆë¥¼ ì‚´í´ë³´ì•˜ë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” í•´ë‹¹ ì´ìŠˆë¥¼ í•´ê²°í•˜ë©´ì„œ ê¶ê¸ˆí–ˆë˜ ì†Œìˆ˜ì  ì´ˆê°€ ì œê±°ë˜ê¸°ê¹Œì§€ì˜ ìë£Œí˜• ë³€í™˜ ê³¼ì •ì„ ë“¤ì—¬ë‹¤ë³´ì.ì†Œìˆ˜ì  ì´ˆê°€ ì œê±°ë˜ê¸°ê¹Œì§€ì˜ ê³¼ì • ì‚´í´ë³´ê¸°public void ìƒí’ˆê¶Œìƒì„±() { ìƒí’ˆê¶Œìƒì„±ì •ë³´ info = new ìƒí’ˆê¶Œìƒì„±ì •ë³´(param1, param2, ...", "content": "ìƒí™© ì´ì „ í¬ìŠ¤íŒ… ì—ì„œ MySQL ë°˜ì˜¬ë¦¼ í˜„ìƒìœ¼ë¡œ ì¸í•´ ê²ªì—ˆë˜ ì´ìŠˆë¥¼ ì‚´í´ë³´ì•˜ë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” í•´ë‹¹ ì´ìŠˆë¥¼ í•´ê²°í•˜ë©´ì„œ ê¶ê¸ˆí–ˆë˜ ì†Œìˆ˜ì  ì´ˆê°€ ì œê±°ë˜ê¸°ê¹Œì§€ì˜ ìë£Œí˜• ë³€í™˜ ê³¼ì •ì„ ë“¤ì—¬ë‹¤ë³´ì.ì†Œìˆ˜ì  ì´ˆê°€ ì œê±°ë˜ê¸°ê¹Œì§€ì˜ ê³¼ì • ì‚´í´ë³´ê¸°public void ìƒí’ˆê¶Œìƒì„±() { ìƒí’ˆê¶Œìƒì„±ì •ë³´ info = new ìƒí’ˆê¶Œìƒì„±ì •ë³´(param1, param2, ...); ì¤‘ëµ ... giftRepository.save(info);}public ìƒí’ˆê¶Œìƒì„±ì •ë³´(param1, param2, ...) {\t\t... this.registerExpireYmdt = getExpirationDate();}private Date getExpirationDate() { LocalDateTime ë“±ë¡ë§Œë£Œì¼ì‹œ = LocalDateTime.now() .plusYears(1) .withMonth(12) .withDayOfMonth(31) .withHour(23) .withMinute(59) .withSecond(59) .withNano(0); // LocalDateTime -&gt; Dateí˜•ìœ¼ë¡œ ë³€í™˜ Instant instant = ë“±ë¡ë§Œë£Œì¼ì‹œ.atZone(ZoneId.systemDefault()).toInstant(); return Date.from(instant);} ì‹¤ì œ DBì— ì¿¼ë¦¬ë¥¼ ë‚ ë¦¬ê¸° ìœ„í•´ JDBC ë ˆë²¨ì—ì„œ ë‹¤ë£¨ëŠ” ë‚ ì§œ ê´€ë ¨ ìë£Œí˜•ì€ java.sql.Timestamp ë”°ë¼ì„œ ë§Œë£Œì¼ì‹œê°€ ì¿¼ë¦¬ì— ì„¸íŒ…ë˜ê¸°ê¹Œì§€ ìë£Œí˜• ë³€í™˜ì€ java.time.LocalDateTime â†’ java.util.Date â†’ java.sql.Timestampì˜ ê³¼ì •ì„ ê±°ì¹¨ LocalDateTime â†’ Dateë¡œì˜ ë³€í™˜ì€ getExpirationDateì— ìˆì§€ë§Œ Date â†’ Timestampë¡œì˜ ë³€í™˜ì€ MyBatisì—ì„œ í•´ì¤€ë‹¤.â€» ì°¸ê³  MySQL 8.0ë¶€í„°ëŠ” JDBC ë“œë¼ì´ë²„ ì´ë¦„ì´ mysql-connector-java -&gt; mysql-connector-jë¡œ ë³€ê²½ë¨ (https://dev.mysql.com/doc/relnotes/connector-j/8.0/en/news-8-0-31.html1. java.time.LocalDateTime â†’ java.util.Date ë³€í™˜Instant instant = ë“±ë¡ë§Œë£Œì¼ì‹œ.atZone(ZoneId.systemDefault()).toInstant();return Date.from(instant); Instant instant = ë“±ë¡ë§Œë£Œì¼ì‹œ.atZone(ZoneId.systemDefault()).toInstant(); LocalDateTimeì„ Instantë¡œ ë³€í™˜ Instant ëŠ” í˜„ì¬ ìˆœê°„(ì‹œê°)ì„ secondsì™€ nanosë¡œ í‘œí˜„í•¨ seconds : 1970-01-01T00:00:00Zë¶€í„° í˜„ì¬ê¹Œì§€ ê²½ê³¼í•œ ì‹œê°„ì„ ì´ˆë¡œ ë‚˜íƒ€ë‚¸ ê²ƒ. ì°¸ê³  : Epoch Time nanos : í˜„ì¬ ì‹œê°„ì„ ë‚˜ë…¸ì´ˆ ì •ë°€ë„(ì†Œìˆ˜ì  9ìë¦¬ê¹Œì§€)ë¡œ í‘œí˜„ Date.from(instant) java.util.Dateì˜ ì •ë°€ë„ëŠ” ë°€ë¦¬ì„¸ì»¨ë“œ public static Date from(Instant instant) { try { return new Date(instant.toEpochMilli()); } catch (ArithmeticException ex) { throw new IllegalArgumentException(ex); } } toEpochMilli () 1970-01-01T00:00:00Zë¶€í„°ì˜ epoch timeì„ ë°€ë¦¬ì´ˆ ë‹¨ìœ„ë¡œ ë³€í™˜ ì¦‰, Instantì˜ ì •ë°€ë„ëŠ” ë‚˜ë…¸ì´ˆì´ì§€ë§Œ Dateì˜ ì •ë°€ë„ëŠ” ë°€ë¦¬ì´ˆì´ê¸° ë•Œë¬¸ì—toEpochMilli()ë¡œ ë³€í™˜. public long toEpochMilli() { if (seconds &lt; 0 &amp;&amp; nanos &gt; 0) { long millis = Math.multiplyExact(seconds+1, 1000); long adjustment = nanos / 1000_000 - 1000; return Math.addExact(millis, adjustment); } else { long millis = Math.multiplyExact(seconds, 1000); return Math.addExact(millis, nanos / 1000_000); } } ìš”ì•½ LocalDateTime, InstantëŠ” ë‚˜ë…¸ì´ˆ ì •ë°€ë„(2024-12-31 23:59:59.123456789) ê¹Œì§€ í‘œí˜„í•  ìˆ˜ ìˆê³  DateëŠ” ë°€ë¦¬ì´ˆ ì •ë°€ë„(2024-12-31 23:59:59.123) ê¹Œì§€ í‘œí˜„í•  ìˆ˜ ìˆë‹¤. LocalDateTimeì˜ nanoê°€ 0ì´ë©´ Dateê°€ í‘œí˜„í•  ìˆ˜ ìˆëŠ” ë°€ë¦¬ì´ˆ ë¶€ë¶„ë„ 0ì´ ëœë‹¤. 2. java.util.Date â†’ java.sql.Timestamp ë³€í™˜ org.apache.ibatis.type.DateTypeHandlerê°€ ì¤‘ê°„ì—ì„œ ë³€í™˜í•´ì¤Œ parameter.getTime()// java.util.Date public long getTime() { return getTimeImpl(); } private final long getTimeImpl() { if (cdate != null &amp;&amp; !cdate.isNormalized()) { normalize(); } return fastTime; } new Timestamp(parameter.getTime()) - (java.sql.Timestamp ëŠ” ë‚˜ë…¸ì´ˆ ì •ë°€ë„ë¥¼ ê°–ëŠ”ë‹¤.)// java.sql.Timestamp public Timestamp(long time) { super((time/1000)*1000); nanos = (int)((time%1000) * 1000000); if (nanos &lt; 0) { nanos = 1000000000 + nanos; super.setTime(((time/1000)-1)*1000); } } ì •í™•íˆ ì´ê²Œ ì–´ë–¤ ë™ì‘ì„ í•˜ëŠ” ê²ƒì¸ì§€ íŒŒì•…í•˜ê¸°ê°€ ì–´ë ¤ì›Œì„œ ì½”ë“œ ì‹¤í–‰ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì•˜ë‹¤. ì˜ˆì‹œ Date : 2024ë…„ 12ì›” 31ì¼ 23ì‹œ 59ë¶„ 59.123ì´ˆ Date.getTime() : 1735657199123 // Epoch Time (ë°€ë¦¬ì´ˆ ë‹¨ìœ„ê¹Œì§€ í‘œí˜„) new Timestamp(Date.getTime()) Timestamp.getTime() : 1735657199123 // Epoch Time (ë°€ë¦¬ì´ˆ ë‹¨ìœ„ê¹Œì§€ í‘œí˜„) Timestamp.getNanos() : 123000000 // ë‚˜ë…¸ì´ˆ ì •ë°€ë„ê¹Œì§€ í‘œí˜„ (ë°€ë¦¬ì´ˆ ë‹¨ìœ„ê¹Œì§€ë§Œ ê°–ëŠ” Dateë¡œë¶€í„° ë³€í™˜ë˜ì—ˆê¸° ë•Œë¬¸ì— ë°€ë¦¬ì´ˆ ì´í›„ë¡œëŠ” 0) Date : 2024ë…„ 12ì›” 31ì¼ 23ì‹œ 59ë¶„ 59ì´ˆ.000ì´ˆ Date.getTime() : 1735657199000 new Timestamp(Date.getTime()) Timestamp.getTime() : 1735657199000 Timestamp.getNanos() : 0 LocalDateTime â†’ Date â†’ Timestamp ë³€í™˜ê³¼ì •ì„ ìš”ì•½í•˜ë©´ â€œLocalDateTimeì—ì„œì˜ nanoì´ˆê°€ 0ì´ë©´ Dateì˜ ë°€ë¦¬ì´ˆê°€ 0ì´ë˜ê³ , ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±í•œ Timestampì˜ nanoì´ˆ ë˜í•œ 0ì´ë‹¤.â€3. ì¿¼ë¦¬ë¬¸ì— ê°’ ì„¸íŒ… ë¡œê·¸ì— ì°í˜”ë˜ 2024-12-31 23:59:59, ì¦‰ ì¿¼ë¦¬ë¬¸ì— ì‹¤ì œë¡œ ì„¸íŒ…ë˜ëŠ” ê°’ì´ ì–´ë–¤ì‹ìœ¼ë¡œ ë§Œë“¤ì–´ì§€ëŠ” ê²ƒì¸ì§€ í™•ì¸í•´ë³´ê¸°. 2ë²ˆì—ì„œ ì‚´í´ë³¸ org.apache.ibatis.type.DateTypeHandlerì—ì„œ ps.setTimestampë¥¼ íƒ€ê³  ë“¤ì–´ê°€ë‹¤ë³´ë©´ ì•„ë˜ ì½”ë“œê°€ ë‚˜ì˜´ com.mysql.jdbc.PreparedStatement.setTimestampInternal ì—ì„œ Timestampì˜ nanosë¶€ë¶„ì´ 0ì¸ì§€ ì•„ë‹Œì§€ì— ë”°ë¼ ì†Œìˆ˜ì  ì´ˆê°€ ë¶™ì„ì§€ ì•ˆë¶™ì„ì§€ ê²°ì •ëœë‹¤. 5.6.4ë²„ì „ë¶€í„° fractional second ê¸°ëŠ¥ì´ ì§€ì›ë˜ëŠ” ê²ƒì„ ì½”ë“œ ë ˆë²¨ì—ì„œ í™•ì¸í•  ìˆ˜ë„ ìˆë‹¤.ì •ë¦¬ ì»´í“¨í„°ì—ì„œ ì‹œê°„ì„ ë‹¤ë£¨ê¸° ìœ„í•´ Epoch Timeì´ë€ ê°œë…ì„ ì‚¬ìš©í•œë‹¤. Epoch Timeê³¼ ë”ë¶ˆì–´ ì‹œê°„ì„ íŠ¹ì • ì •ë°€ë„ ë‹¨ìœ„ê¹Œì§€ í‘œí˜„í•  ìˆ˜ ìˆë‹¤. LocalDateTimeì™€ Timestampì˜ ì •ë°€ë„ëŠ” ë‚˜ë…¸ì´ˆ, DateëŠ” ë°€ë¦¬ì´ˆì´ë‹¤. Timestampì˜ nanosê°€ 0ë³´ë‹¤ í¬ë©´ MySQL 5.6.4ë²„ì „ ì´ìƒë¶€í„°ëŠ” ì†Œìˆ˜ì  ì´ˆê°€ ë¶™ì–´ì„œ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì— ì„¸íŒ…ëœë‹¤. LocalDateTimeì˜ nanoì´ˆ ë¶€ë¶„ì´ 0ì´ë©´ ê²°ê³¼ì ìœ¼ë¡œ Timestampì˜ nanoì´ˆ ë¶€ë¶„ë„ 0ì´ë˜ì—ˆë‹¤. DATETIMEê³¼ ê°™ì€ ë‚ ì§œ/ì‹œê°„ ìë£Œí˜•ì— ì •ì˜ëœ ì†Œìˆ˜ì  ìë¦¿ìˆ˜ë¥¼ ì´ˆê³¼í•˜ëŠ” ë¶€ë¶„ì€ ë°˜ì˜¬ë¦¼ëœë‹¤. ì´ì „ í¬ìŠ¤íŒ… MySQLì—ì„œ ì‹œê°„,ë‚ ì§œ ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ ë°˜ì˜¬ë¦¼ë˜ëŠ” í˜„ìƒ (1)" }, { "title": "MySQLì—ì„œ ì‹œê°„,ë‚ ì§œ ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ ë°˜ì˜¬ë¦¼ë˜ëŠ” í˜„ìƒ (1)", "url": "/posts/mysql-round-up-part1/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "MySQL", "date": "2023-03-28 22:25:00 +0900", "snippet": "ìƒí™© íšŒì‚¬ì—ì„œ íŒë§¤í•˜ëŠ” ìƒí’ˆê¶Œì˜ ë“±ë¡ë§Œë£Œì¼ì‹œ ë³€ê²½ ìš”ì²­ì„ ë°›ì•„ ì‘ì—…í•œ ë’¤ í…ŒìŠ¤íŠ¸í•˜ë˜ ì¤‘ 24ë…„ 12ì›” 31ì¼ 23ì‹œ 59ë¶„ 59ì´ˆë¡œ ë§Œë£Œì¼ì‹œë¥¼ ì„¸íŒ…í•˜ë ¤ëŠ”ë° ì‹¤ì œ DBì—ëŠ” 25ë…„ 1ì›” 1ì¼ 0ì‹œ 0ë¶„ 0ì´ˆë¡œ ì €ì¥ë˜ëŠ” í˜„ìƒ ë°œê²¬ê¸°ì¡´ ì½”ë“œimport org.apache.commons.lang.time.DateUtils;public void ìƒí’ˆê¶Œìƒì„±() ...", "content": "ìƒí™© íšŒì‚¬ì—ì„œ íŒë§¤í•˜ëŠ” ìƒí’ˆê¶Œì˜ ë“±ë¡ë§Œë£Œì¼ì‹œ ë³€ê²½ ìš”ì²­ì„ ë°›ì•„ ì‘ì—…í•œ ë’¤ í…ŒìŠ¤íŠ¸í•˜ë˜ ì¤‘ 24ë…„ 12ì›” 31ì¼ 23ì‹œ 59ë¶„ 59ì´ˆë¡œ ë§Œë£Œì¼ì‹œë¥¼ ì„¸íŒ…í•˜ë ¤ëŠ”ë° ì‹¤ì œ DBì—ëŠ” 25ë…„ 1ì›” 1ì¼ 0ì‹œ 0ë¶„ 0ì´ˆë¡œ ì €ì¥ë˜ëŠ” í˜„ìƒ ë°œê²¬ê¸°ì¡´ ì½”ë“œimport org.apache.commons.lang.time.DateUtils;public void ìƒí’ˆê¶Œìƒì„±() { Date ë“±ë¡ë§Œë£Œì¼ì‹œ = DateUtils.setMilliseconds(DateUtils.setSeconds(DateUtils.setMinutes(DateUtils.setHours(DateUtils.addYears(new Date(), 5), 23), 59), 59), 0); ìƒí’ˆê¶Œìƒì„±ì •ë³´ info = new ìƒí’ˆê¶Œìƒì„±ì •ë³´(); info.setRegisterExpireYmdt(ë“±ë¡ë§Œë£Œì¼ì‹œ); ì¤‘ëµ ... giftRepository.save(info);}ë³€ê²½ ì½”ë“œ ê°€ë…ì„± ê³ ë ¤ ë° java.util.Date í´ë˜ìŠ¤ì˜ ì‚¬ìš©ì€ ê¶Œì¥ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— LocalDateTime ì‚¬ìš© ìë°”ì—ì„œ ë‹¤ë£¨ëŠ” ë‚ ì§œ í´ë˜ìŠ¤ ê´€ë ¨ ì°¸ê³ ê¸€ ê°ì²´ ì™¸ë¶€ì—ì„œ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ì˜ ê°’ì„ í• ë‹¹í•˜ëŠ” ê²ƒì„ ì§€ì–‘í•˜ê³ ì, setter ë©”ì„œë“œ ëŒ€ì‹  ìƒì„±ì ë‚´ì—ì„œ ê°’ í• ë‹¹public void ìƒí’ˆê¶Œìƒì„±() { ìƒí’ˆê¶Œìƒì„±ì •ë³´ info = new ìƒí’ˆê¶Œìƒì„±ì •ë³´(param1, param2, ...); ì¤‘ëµ ... giftRepository.save(info);}public ìƒí’ˆê¶Œìƒì„±ì •ë³´(param1, param2, ...) {\t\t... this.registerExpireYmdt = getExpirationDate();}private Date getExpirationDate() { LocalDateTime ë“±ë¡ë§Œë£Œì¼ì‹œ = LocalDateTime.now() .plusYears(1) .withMonth(12) .withDayOfMonth(31) .withHour(23) .withMinute(59) .withSecond(59); // LocalDateTime -&gt; Dateí˜•ìœ¼ë¡œ ë³€í™˜ Instant instant = ë“±ë¡ë§Œë£Œì¼ì‹œ.atZone(ZoneId.systemDefault()).toInstant(); return Date.from(instant);} ìƒí’ˆê¶Œìƒì„±ì •ë³´ì˜ registerExpireYmdt(ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜) ìë£Œí˜• ìì²´ë¥¼ LocalDateTimeìœ¼ë¡œ ë³€ê²½í•˜ê³  ì‹¶ì—ˆìœ¼ë‚˜, ì‚¬ìš©ë˜ê³ ìˆëŠ” ê³³ì´ ë§ì•„ ì´ ë¶€ë¶„ê¹Œì§€ ìˆ˜ì •í•˜ì§€ëŠ” ëª»í•¨ì›ì¸ íŒŒì•…í•´ë³´ê¸°1. í…Œì´ë¸” ìŠ¤í‚¤ë§ˆ í™•ì¸ DB : MySQL 5.7.35 ë“±ë¡ë§Œë£Œì¼ì‹œ ì»¬ëŸ¼ ìë£Œí˜• : DATETIME2. ì¿¼ë¦¬ ë¡œê·¸ í™•ì¸ ìƒí’ˆê¶Œìƒì„±ì •ë³´ì— ëŒ€í•œ INSERT ì¿¼ë¦¬ì— ì„¸íŒ…ë˜ëŠ” ë“±ë¡ë§Œë£Œì¼ì‹œ: 2024-12-31 23:59:59.5823. MySQL DATETIME ê´€ë ¨ ê³µì‹ ë¬¸ì„œ í™•ì¸ TIME, DATETIME, TIMESTAMP ìë£Œí˜•ì— ëŒ€í•´ì„œ â€˜fractional secondsâ€™(ë¶„ìˆ˜ ì´ˆ = ì†Œìˆ˜ì  ì´ˆ?)ë¥¼ ì§€ì›í•œë‹¤. ìµœëŒ€ ë§ˆì´í¬ë¡œì´ˆ(ì†Œìˆ˜ì  6ìë¦¬)ê¹Œì§€ ì§€ì› ì»¬ëŸ¼ ìë£Œí˜•ì— ì •ì˜ëœ ì†Œìˆ˜ì  ìë¦¿ìˆ˜ë³´ë‹¤ ì‹¤ì œ ì €ì¥í•˜ë ¤ëŠ” ì‹œê°„ì˜ ì†Œìˆ˜ì  ìë¦¿ìˆ˜ê°€ ë” í¬ë©´, ì´ˆê³¼ë˜ëŠ” ë¶€ë¶„ì—ì„œ ë°˜ì˜¬ë¦¼ëœë‹¤. ì˜ˆì‹œ : 2018-09-08 17:51:04.777 ì €ì¥ DATETIME(2) : 2018-09-08 17:51:04.78 -&gt; ì†Œìˆ˜ì  ì„¸ë²ˆì§¸ ìë¦¬ì—ì„œ ë°˜ì˜¬ë¦¼ë¨ DATETIME : 2018-09-08 17:51:05 -&gt; ì†Œìˆ˜ì  ì²«ë²ˆì¨° ìë¦¬ì—ì„œ ë°˜ì˜¬ë¦¼ë¨ ì´ìŠˆ ì›ì¸ ë“±ë¡ë§Œë£Œì¼ì‹œë¥¼ ì €ì¥í•˜ëŠ” ì»¬ëŸ¼ì˜ ê²½ìš° ì†Œìˆ˜ì  ì´ˆë¥¼ ì •ì˜í•˜ì§€ ì•Šì€ DATETIMEì´ë‹¤. ë”°ë¼ì„œ, ì €ì¥í•˜ë ¤ëŠ” ì‹œê°„ì— ì†Œìˆ˜ì ì´ ë¶™ìœ¼ë©´ ì†Œìˆ˜ì  ì²«ë²ˆì§¸ ìë¦¬ì—ì„œ ë°˜ì˜¬ë¦¼ëœë‹¤. LocalDateTime.now()ì˜ ê²½ìš° í˜„ì¬ ì‹œê°ì„ ì†Œìˆ˜ì  3ìë¦¬ê¹Œì§€ í‘œí˜„í•œë‹¤. (ex : 2024-12-31 23:59:59.582) DBì— 2024-12-31 23:59:59ë¡œ ì €ì¥ëœ ê²½ìš° : LocalDateTime.now()ê°€ í˜¸ì¶œëœ ì‹œì ì— ì†Œìˆ˜ì  ì´ˆê°€ 0.5ë³´ë‹¤ ì‘ì•˜ë‹¤. DBì— 2025-01-01 00:00:00ë¡œ ì €ì¥ëœ ê²½ìš° : LocalDateTime.now()ê°€ í˜¸ì¶œëœ ì‹œì ì— ì†Œìˆ˜ì  ì´ˆê°€ 0.5 ì´ìƒì´ì—ˆë‹¤. LocalDateTimeì€ ì†Œìˆ˜ì  9ìë¦¬ê¹Œì§€ í‘œí˜„ ê°€ëŠ¥ â€» ì°¸ê³  ì´ìŠˆì˜ ì›ì¸ì´ì—ˆë˜ â€˜fractional secondsâ€™ëŠ” MySQL 5.6.4ë²„ì „ë¶€í„° ì§€ì›ë˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. 5.7ë²„ì „ ê³µì‹ë¬¸ì„œ 8 ë²„ì „ ê³µì‹ë¬¸ì„œìƒê°í•´ë³¸ í•´ê²° ë°©ì•ˆ ì¿¼ë¦¬ì— ì„¸íŒ…ë˜ëŠ” ë“±ë¡ë§Œë£Œì¼ì‹œì˜ ì†Œìˆ˜ì  ì´ˆ ë¶€ë¶„ì„ 0ìœ¼ë¡œ ë§Œë“¤ê¸°(ì†Œìˆ˜ì  ë¶€ë¶„ ì œê±°í•˜ê¸°) ì´ˆ ë‹¨ìœ„ê¹Œì§€ ë°˜ì˜¬ë¦¼ ë˜ì§€ ì•Šë„ë¡ datetime ìë£Œí˜•ì„ datetime(n)ìœ¼ë¡œ ì¬ì •ì˜í•˜ê¸° datetime(3)ì´ì–´ë„ ì €ì¥ë˜ëŠ” ì‹œê°„ì´ 23:59:59.9995 ì´ëŸ°ê²½ìš° ê²°êµ­ ì´ˆë‹¨ìœ„ê¹Œì§€ ë°˜ì˜¬ë¦¼ëœë‹¤. ì¿¼ë¦¬ì— ì„¸íŒ…ë˜ëŠ” ë“±ë¡ë§Œë£Œì¼ì‹œì˜ ì†Œìˆ˜ì  ë¶€ë¶„ 0ìœ¼ë¡œ ë§Œë“¤ê¸° ver1LocalDateTime ë“±ë¡ë§Œë£Œì¼ì‹œ = LocalDateTime.now() .plusYears(1) .withMonth(12) .withDayOfMonth(31) .withHour(23) .withMinute(59) .withSecond(59) .withNano(0); // ì¶”ê°€ ver2int nextYear = LocalDateTime.now().getYear() + 1;LocalDateTime ë“±ë¡ë§Œë£Œì¼ì‹œ = LocalDateTime.of(nextYear, 12, 31, 23, 59, 59); // of ë©”ì„œë“œë¥¼ íƒ€ê³  ë“¤ì–´ê°€ë‹¤ë³´ë©´ ê²°êµ­ nanoSecondë¥¼ 0ìœ¼ë¡œ ì„¸íŒ…í•˜ëŠ” ë¶€ë¶„ì´ ìˆìŒ INSERT ì¿¼ë¦¬ ë¡œê·¸ í™•ì¸ ë³€ê²½ ì „ : 2024-12-31 23:59:59.582 ë³€ê²½ í›„ :2024-12-31 23:59:59 nanoì´ˆë¥¼ ì¼ë¶€ëŸ¬ 0ìœ¼ë¡œ ì„¸íŒ…í–ˆë‹¤ëŠ” ê²ƒì´ ëª…ì‹œì ìœ¼ë¡œ ì¢€ ë” ì˜ ë“œëŸ¬ë‚˜ëŠ” ê²ƒ ê°™ì•„ ver1 ì„ íƒ ì´ë¡œì¨ ìƒê°ë³´ë‹¤ ê°„ë‹¨íˆ ì´ìŠˆë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤.í•˜ì§€ë§Œ, í•œ ê°€ì§€ ì˜ë¬¸ì´ ë“¤ì—ˆë˜ ê²ƒì€ INSERT ì¿¼ë¦¬ì— ì„¸íŒ…ë˜ê¸° ì „ ë“±ë¡ë§Œë£Œì¼ì‹œëŠ” (jdbcì—ì„œ ë‹¤ë£¨ëŠ”) java.sql.Timestamp íƒ€ì…ì´ë í…ë°LocalDateTimeì˜ nanoì´ˆë¥¼ 0ìœ¼ë¡œ ì„¸íŒ…í•œ ê²ƒì´ ê²°ê³¼ì ìœ¼ë¡œ ì–´ë–»ê²Œ Timestampë¥¼ ê±°ì³ ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì˜ ì†Œìˆ˜ì  ì´ˆ ë¶€ë¶„ì„ ì—†ì•¨ ìˆ˜ ìˆëŠ”ì§€ì˜€ë‹¤.ê·¸ë˜ì„œ MyBatisì™€ JDBC ë“œë¼ì´ë²„(mysql-connector-java)ê°€ ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–¤ì‹ìœ¼ë¡œ ê°’ì„ ë³€í™˜í•˜ê³  ìˆëŠ”ì§€ ë””ë²„ê±°ë¥¼ í†µí•´ ë”°ë¼ê°€ë³´ì•˜ë‹¤.í•´ë‹¹ ê¸€ì€ ë‹¤ìŒ í¬ìŠ¤íŒ…ì„ í†µí•´ ì‚´í´ë³´ì.ë‹¤ìŒ í¬ìŠ¤íŒ… MySQLì—ì„œ ì‹œê°„,ë‚ ì§œ ë°ì´í„°ë¥¼ ì €ì¥í•  ë•Œ ë°˜ì˜¬ë¦¼ë˜ëŠ” í˜„ìƒ (2)" }, { "title": "POST ìš”ì²­ ì‚¬ì´ì¦ˆ ì œí•œìœ¼ë¡œ ì¸í•´ ê²ªì—ˆë˜ ì´ìŠˆ(http-max-post-size, max-http-form-post-size)", "url": "/posts/http-post-request-body-size-limit/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "Tomcat, HTTP", "date": "2023-01-10 10:25:00 +0900", "snippet": "ìƒí™© í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ìƒí’ˆ ìˆ˜ì‹ ì ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë°›ì•„ ì²˜ë¦¬í•˜ëŠ”ë°, ìˆ˜ì‹ ìê°€ ì¼ì • ìˆ˜ë¥¼ ë„˜ì–´ê°€ë©´ ì œëŒ€ë¡œ ì²˜ë¦¬ë˜ì§€ ì•Šê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì˜ˆì™¸ ë°œìƒí•¨ë¡œê·¸ ì¶”ì 1. ì•„íŒŒì¹˜ ë¡œê·¸Connection reset by peer : ... AH01084: pass request body failed to ...2. ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ ì»¨íŠ¸ë¡¤ëŸ¬ì— íŒŒë¼ë¯¸í„°ê°€ null...", "content": "ìƒí™© í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ìƒí’ˆ ìˆ˜ì‹ ì ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë°›ì•„ ì²˜ë¦¬í•˜ëŠ”ë°, ìˆ˜ì‹ ìê°€ ì¼ì • ìˆ˜ë¥¼ ë„˜ì–´ê°€ë©´ ì œëŒ€ë¡œ ì²˜ë¦¬ë˜ì§€ ì•Šê³  ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì˜ˆì™¸ ë°œìƒí•¨ë¡œê·¸ ì¶”ì 1. ì•„íŒŒì¹˜ ë¡œê·¸Connection reset by peer : ... AH01084: pass request body failed to ...2. ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸ ì»¨íŠ¸ë¡¤ëŸ¬ì— íŒŒë¼ë¯¸í„°ê°€ nullë¡œ ë„˜ì–´ì˜´. ì´ë¡œ ì¸í•´ ìœ íš¨ì„± ê²€ì‚¬ì—ì„œ ì˜ˆì™¸ ì²˜ë¦¬ë¨ì–»ì€ íŒíŠ¸ Connection reset by peer (Remote Sever, ì¦‰ í†°ìº£ ì„œë²„ì—ì„œ RST íŒ¨í‚· ë³´ë‚´ì„œ ì»¤ë„¥ì…˜ ëŠê¹€) pass request body failed request bodyê°€ ì œëŒ€ë¡œ ì „ë‹¬ë˜ì§€ ëª»í–ˆë‹¤. (ì´ë¡œ ì¸í•´ íŒŒë¼ë¯¸í„°ê°€ nullë¡œ ë„˜ì–´ì˜¨ ê²ƒ ê°™ë‹¤.) ì¶”ì¸¡ : í†°ìº£ìª½ì—ì„œ ë­”ê°€ ë¬¸ì œê°€ ë°œìƒí•˜ëŠ” ê²ƒ ê°™ë‹¤.ì›ì¸ íŒŒì•… (Spring Boot ë‚´ì¥) í†°ìº£ ê´€ë ¨ ì„¤ì •ì„ ì‚´í´ë³´ìserver: port: í¬íŠ¸ë²ˆí˜¸ tomcat: uri-encoding: UTF-8 connection-timeout: ... min-spare-threads: ... max-threads: ... max-http-post-size: 3145728 max-connections: ... ì™ ì§€ max-http-post-sizeê°€ ì—°ê´€ìˆëŠ” ì„¤ì •ì¼ ê²ƒ ê°™ë‹¤. ê·¸ëŸ°ë°, post sizeë¼ëŠ”ê²Œ ì •í™•íˆ ì–´ë–¤ ê²ƒì˜ í¬ê¸°ë¥¼ ì˜ë¯¸í•˜ëŠ”ê±¸ê¹Œ ? (request headerë¥¼ í¬í•¨í•œ ì „ì²´ ì‚¬ì´ì¦ˆ?) í†°ìº£ ê³µì‹ë¬¸ì„œì—ì„œëŠ” maxPostSize ì†ì„±ì„ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜ The maximum size in bytes of the POST which will be handled by the container FORM URL parameter parsing.The limit can be disabled by setting this attribute to a value less than zero.If not specified, this attribute is set to 2097152 (2 megabytes).Note that the FailedRequestFilter can be used to reject requests that exceed this limit. ì†ŒìŠ¤ë¥¼ ì°¾ì•„ë³´ë©´ Content-Length(Request Bodyì˜ í¬ê¸°)ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë‚´ì¥ í†°ìº£ ë¼ì´ë¸ŒëŸ¬ë¦¬(tomcat-embed-core-8.5.29.jar)ì˜ org.apache.catalina.connector.Request#parseParameters ë˜í•œ, Content-Typeì´ multipart/form-dataì´ê±°ë‚˜ application/x-www-form-urlencodedì¸ ê²½ìš°ì—ë§Œ ì‚¬ì´ì¦ˆë¥¼ ì œí•œí•˜ëŠ” ë¡œì§ì„ íƒ€ê²Œëœë‹¤. í™•ì¸ ê²°ê³¼, ìˆ˜ì‹ ì ì •ë³´ ì„¸íŒ… ìš”ì²­ì˜ Content-Typeì€ application/x-www-form-urlencodedì´ì—ˆìŒ (ì´ë¦„ì—ì„œ ìœ ì¶”í•  ìˆ˜ ìˆë“¯ì´) POST ìš”ì²­ì¸ ê²½ìš°ì—ë§Œ ì œí•œëœë‹¤. org.springframework.web.filter.HiddenHttpMethodFilter#doFilterInternal cf) ë‚´ì¥ í†°ìº£ ì•„ë‹Œ ê²½ìš° (server.xmlì— maxPostSizeì§€ì •)&lt;Connector port=\"8080\" protocol=\"HTTP/1.1\" redirectPort=\"8443\" maxPostSize=\"-1\"/&gt;ë¬¸ì œ í•´ê²°1. ìˆ˜ì‹ ì ì •ë³´ ë°ì´í„° ì†¡ì‹  êµ¬ì¡° ë³€ê²½ ë¶ˆí•„ìš”í•˜ê²Œ ì¤‘ë³µë˜ëŠ” ë°ì´í„° ì œê±°í•˜ì—¬ RequestBody í¬ê¸° ì‘ê²Œ ë§Œë“¤ê¸° (ì•„ë˜ì—ì„œëŠ” ì„¤ëª…ì„ ìœ„í•´ jsonìœ¼ë¡œ í‘œì‹œ. ì‹¤ì œë¡œëŠ” x-www-form-urlencoded, ì¦‰ key-value í˜•íƒœë¡œ ë„˜ì–´ê°) before : ë™ì¼í•œ ë°œì‹ ë©”ì„¸ì§€ ì¤‘ë³µ (ìƒí’ˆ ë°œì†¡ì‹œ ë°œì‹ ë©”ì„¸ì§€ëŠ” ëª¨ë‘ ë™ì¼) { \"ìƒí’ˆì½”ë“œ\" : ... , \"ì†¡ì‹ ìì´ë¦„\" : ... , \"ìˆ˜ì‹ ìëª©ë¡\" : [ \t {\"ì˜ˆì•½ì¼ì‹œ\" : ... , \"íœ´ëŒ€í°ë²ˆí˜¸\" : ... , \"ë°œì‹ ë©”ì„¸ì§€\" : ...}, {\"ì˜ˆì•½ì¼ì‹œ\" : ... , \"íœ´ëŒ€í°ë²ˆí˜¸\" : ... , \"ë°œì‹ ë©”ì„¸ì§€\" : ...}, ]} after : ë°œì‹ ë©”ì„¸ì§€ í•­ëª© ë”°ë¡œ ë¶„ë¦¬ { \"ìƒí’ˆì½”ë“œ\" : ... , \"ì†¡ì‹ ìì´ë¦„\" : ... , \"ë°œì‹ ë©”ì„¸ì§€\" : ... , \"ìˆ˜ì‹ ìëª©ë¡\" : [ \t\t{\"ì˜ˆì•½ì¼ì‹œ\" : ... , \"íœ´ëŒ€í°ë²ˆí˜¸\" : ... }, {\"ì˜ˆì•½ì¼ì‹œ\" : ... , \"íœ´ëŒ€í°ë²ˆí˜¸\" : ... }, ]} 2. max-http-post-size ë³€ê²½ ê°œì„ ëœ ì†¡ì‹  êµ¬ì¡° ê¸°ì¤€ìœ¼ë¡œ 10000ê±´ ì†¡ì‹ ì‹œ ì•½ 3.8MBì¸ ê²ƒì„ ê°ì•ˆí•˜ì—¬ 4194304(bytes, 4MB)ë¡œ ë³€ê²½ì•Œê²Œëœ ê²ƒ form íƒœê·¸ì— enctype ë”°ë¡œ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´, form submitì‹œ default content-typeì€ x-www-form-urlencoded enctype ëª©ë¡ application/x-www-form-urlencoded multipart/form-data text/plain POST ìš”ì²­ì´ë©´ì„œ Content-Typeì´ x-www-form-urlencoded ë˜ëŠ” multipart/form-dataì¸ ê²½ìš°ì—ë§Œ http-max-post-size ì˜µì…˜ì´ ì ìš©ë¨ (jsonì€ í•´ë‹¹ë˜ì§€ ì•ŠìŒ) spring-bootì˜ max-http-post-size ì†ì„±ì€ 2.1.x ë²„ì „ì—ì„œë¶€í„° Deprecated ë˜ì—ˆìŒ (max-http-form-post-sizeë¡œ ë³€ê²½) ì œê¸°ëë˜ ì´ìŠˆ html form ìš”ì²­ê³¼ ê´€ë ¨í•´ì„œ ì ìš©ë˜ëŠ”ê±´ë° http-max-post-sizeëŠ” ì˜ë¯¸ê°€ ëª…í™•í•˜ì§€ ì•Šë‹¤. 2.0.x ë²„ì „ Document 2.1.x ë²„ì „ Document cf) ìš´ì˜í•˜ëŠ” ì„œë¹„ìŠ¤ëŠ” spring-boot v2.0.3 ì‚¬ìš©ì¤‘ì´ì—ˆìŒ" }, { "title": "Java - JDBC ì•Œì•„ë³´ê¸°", "url": "/posts/what-is-jdbc/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2022-04-19 00:29:00 +0900", "snippet": "JDBCë€? ê³µì‹ ë¬¸ì„œì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì„¤ëª…í•œë‹¤. JDBC(Java Database Connectivity) APIëŠ” Javaì—ì„œ ë²”ìš© ë°ì´í„° ì•¡ì„¸ìŠ¤ë¥¼ ì œê³µí•œë‹¤.ì¦‰, JDBC APIë¥¼ ì‚¬ìš©í•˜ë©´ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤, ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë° í”Œë« íŒŒì¼ì— ì´ë¥´ê¸°ê¹Œì§€ ê±°ì˜ ëª¨ë“  ë°ì´í„° ì†ŒìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤. í•œ ë§ˆë””ë¡œ, JDBCëŠ” ë°ì´í„°ì†ŒìŠ¤(íŠ¹íˆ ë°ì´í„°ë² ì´...", "content": "JDBCë€? ê³µì‹ ë¬¸ì„œì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì„¤ëª…í•œë‹¤. JDBC(Java Database Connectivity) APIëŠ” Javaì—ì„œ ë²”ìš© ë°ì´í„° ì•¡ì„¸ìŠ¤ë¥¼ ì œê³µí•œë‹¤.ì¦‰, JDBC APIë¥¼ ì‚¬ìš©í•˜ë©´ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤, ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë° í”Œë« íŒŒì¼ì— ì´ë¥´ê¸°ê¹Œì§€ ê±°ì˜ ëª¨ë“  ë°ì´í„° ì†ŒìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤. í•œ ë§ˆë””ë¡œ, JDBCëŠ” ë°ì´í„°ì†ŒìŠ¤(íŠ¹íˆ ë°ì´í„°ë² ì´ìŠ¤)ì— ì—°ê²°í•˜ì—¬ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•œ APIì´ë‹¤. JDBC APIëŠ” ë‘ ê°œì˜ íŒ¨í‚¤ì§€ë¡œ êµ¬ì„±ëœë‹¤. java.sql javax.sql JDBCê°€ ë‚˜ì˜¤ê²Œ ëœ ë°°ê²½ ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ì—ëŠ” í•´ë‹¹ ë°ì´í„°ë² ì´ìŠ¤ì™€ ìƒí˜¸ ì‘ìš©í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ìì²´ APIê°€ ìˆë‹¤. ë”°ë¼ì„œ ë‘˜ ì´ìƒì˜ ê³µê¸‰ì—…ì²´ì—ì„œ ì œê³µí•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì™€ ìƒí˜¸ ì‘ìš©í•  ìˆ˜ ìˆëŠ” ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ” ê²ƒì€ ì–´ë ¤ìš´ ê³¼ì œë‹¤. ë§ˆì´í¬ë¡œì†Œí”„íŠ¸ì˜ ODBC APIì™€ ê°™ì€ ë°ì´í„°ë² ì´ìŠ¤ ê°„ APIëŠ” ì¡´ì¬í–ˆì§€ë§Œ, ì´ë“¤ì€ íŠ¹ì • í”Œë«í¼ì— êµ­í•œë˜ëŠ” ê²½í–¥ì´ ìˆì—ˆë‹¤.JDBC ì‚¬ìš©ì‹œ ì´ì  JDBCëŠ” ë°ì´í„°ë² ì´ìŠ¤ì™€ Java ì‚¬ì´ì— í”Œë«í¼ ì¤‘ë¦½ì ì¸ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“¤ê¸° ìœ„í•¨ì´ë‹¤. ì¦‰, JDBC APIëŠ” ì¿¼ë¦¬ ì‹¤í–‰, ê²°ê³¼ ì²˜ë¦¬ ë° êµ¬ì„± ì •ë³´ ê²°ì •ì„ í¬í•¨í•˜ì—¬ ì£¼ìš” ë°ì´í„°ë² ì´ìŠ¤ ê¸°ëŠ¥ì„ ìº¡ìŠí™”í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ ì„¸íŠ¸ë¥¼ ì •ì˜í•œë‹¤. ë”°ë¼ì„œ, JDBCë¥¼ ì‚¬ìš©í•˜ë©´ í‘œì¤€ ë°ì´í„°ë² ì´ìŠ¤ ì•¡ì„¸ìŠ¤ ê¸°ëŠ¥ê³¼ SQLì˜ íŠ¹ì • í•˜ìœ„ ì§‘í•©ì¸ SQL-92ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ë°ì´í„°ë² ì´ìŠ¤ ê³µê¸‰ì—…ì²´ ë˜ëŠ” íƒ€ì‚¬ ê°œë°œìê°€ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ ì‹œìŠ¤í…œì— ëŒ€í•´ ì´ëŸ¬í•œ ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤ ì§‘í•©ì¸ JDBC ë“œë¼ì´ë²„ë¥¼ ì‘ì„±í•œë‹¤. ê²°ê³¼ì ìœ¼ë¡œ, ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì—¬ëŸ¬ JDBC ë“œë¼ì´ë²„ë¥¼ ë°”ê¿”ê°€ë©´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì¶œì²˜ : https://flylib.com/books/en/2.177.1.75/1/ì½”ë“œ ë ˆë²¨ì—ì„œ ì‚´í´ë³´ê¸° ìœ„ ê·¸ë¦¼ì„ ì¢€ ë” ê°„ëµí•˜ê²Œ ë§Œë“¤ë©´ ì•„ë˜ì™€ ê°™ì„ ê²ƒì´ë‹¤. ì¶œì²˜ : https://javapapers.com/jdbc/jdbc-introduction/ ì˜ˆë¥¼ ë“¤ì–´, ìë°” í”„ë¡œê·¸ë¨ì„ MySQL DBì™€ ì—°ë™í•˜ê¸° ìœ„í•´ì„œëŠ” MySQLì„ ìœ„í•œ JDBC ë“œë¼ì´ë²„ê°€ í•„ìš”í•  ê²ƒì´ë©°, ì•„ë˜ì™€ ê°™ì´ (gradle)í”„ë¡œì íŠ¸ì— í•´ë‹¹ ë“œë¼ì´ë²„ ì˜ì¡´ì„±ì„ ì¶”ê°€í•´ ì¤„ ìˆ˜ ìˆë‹¤. implementation 'mysql:mysql-connector-java:8.0.28' DBì™€ ì—°ê²°í•˜ëŠ” ë‹¤ìŒ ì½”ë“œë¥¼ ì‚´í´ë³´ì.Connection con = DriverManager.getConnection(\"jdbc:mysql://localhost:3306/dbname\", \"user\", \"pw\")` DriverManagerë¥¼ í†µí•´ ì–»ì–´ì˜¤ëŠ” Connectionì˜ ì‹¤ì œ êµ¬í˜„ì²´ëŠ” com.mysql.cj.jdbc íŒ¨í‚¤ì§€(mysql-connector-java ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ìˆëŠ”)ì˜ ConnectionImplê°ì²´ì´ë‹¤. ì‹¤ì œë¡œ í•´ë‹¹ í´ë˜ìŠ¤ì˜ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨ì„ ì‚´í´ë³´ë©´, ìƒìœ„ì— JDBC ì¸í„°í˜ì´ìŠ¤(java.sql.Connection)ë¥¼ êµ¬í˜„í•˜ê³  ìˆìŒì„ ë³¼ ìˆ˜ ìˆë‹¤. JDBC ë²„ì „ ì¶œì‹œë…„ë„ JDBC ë²„ì „ JSR ìŠ¤í™ JDK 2017 JDBC 4.3 JSR 221 Java SE 9 2014 JDBC 4.2 JSR 221 Java SE 8 2011 JDBC 4.1 JSR 221 Java SE 7 2006 JDBC 4.0 JSR 221 Java SE 6 2001 JDBC 3.0 JSR 54 JDK 1.4 1999 JDBC 2.1 Â  JDK 1.2 1997 JDBC 1.2 Â  JDK 1.1 JDBC ë“œë¼ì´ë²„ ìœ„ì—ì„œ ê·¸ë¦¼ìœ¼ë¡œ ì‚´í´ë´¤ë“¯ì´, JDBC ë“œë¼ì´ë²„ëŠ” íŠ¹ì • ìœ í˜•ì˜ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” JDBC API êµ¬í˜„ì´ë‹¤. íŠ¹ì • DBMSì—ì„œ JDBC APIë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ JDBC ê¸°ìˆ ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ì´ë¥¼ ì¤‘ì¬í•  JDBC ë“œë¼ì´ë²„ê°€ í•„ìš”í•˜ë‹¤. ë‹¤ì–‘í•œ ìš”ì¸ì— ë”°ë¼ ë“œë¼ì´ë²„ëŠ” Javaë¡œë§Œ ì‘ì„±ë˜ê±°ë‚˜, Javaì™€ JNI(Java Native Interface) ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œë¥¼ í˜¼í•©í•˜ì—¬ ì‘ì„±ë  ìˆ˜ ìˆë‹¤.ë„¤ ê°€ì§€ íƒ€ì…ì˜ JDBC ë“œë¼ì´ë²„Type 1 : JDBC-ODBC bridge driver JDBC-ODBC ë¸Œë¦¬ì§€ ë“œë¼ì´ë²„ëŠ” ODBC ë“œë¼ì´ë²„ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì— ì—°ê²°í•œë‹¤. JDBC-ODBC ë¸Œë¦¬ì§€ ë“œë¼ì´ë²„ëŠ” JDBC ë©”ì„œë“œ í˜¸ì¶œì„ ODBC í•¨ìˆ˜ í˜¸ì¶œë¡œ ë³€í™˜í•œë‹¤. Thin ë“œë¼ì´ë²„(Type4)ì˜ ì¶œí˜„ìœ¼ë¡œ ì´ì œëŠ” ê¶Œì¥ë˜ì§€ ì•ŠëŠ” ë°©ë²•ì´ë‹¤. Oracleì€ Java 8ë¶€í„° JDBC-ODBC Bridgeë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. Oracleì€ JDBC-ODBC Bridge ëŒ€ì‹  ë°ì´í„°ë² ì´ìŠ¤ ë²¤ë”ì—ì„œ ì œê³µí•˜ëŠ” JDBC ë“œë¼ì´ë²„ë¥¼ ì‚¬ìš©í•  ê²ƒì„ ê¶Œì¥í•œë‹¤. ì¶œì²˜ : https://www.javatpoint.com/jdbc-driverType 2 : Native-API driver (ë¶€ë¶„ì ìœ¼ë¡œ ìë°”ë¡œ ì‘ì„±ë¨) Native API ë“œë¼ì´ë²„ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Oracle ë°ì´í„°ë² ì´ìŠ¤ì˜ ê²½ìš° ì›ë˜ C/C++ í”„ë¡œê·¸ë˜ë¨¸ìš©ìœ¼ë¡œ ì„¤ê³„ëœ Oracle Call Interface(OCI) ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í†µí•´ ì•¡ì„¸ìŠ¤ê°€ ì´ë£¨ì–´ì§ˆ ìˆ˜ ìˆë‹¤. Native API ë“œë¼ì´ë²„ëŠ” JDBC ë©”ì†Œë“œ í˜¸ì¶œì„ API ë°ì´í„°ë² ì´ìŠ¤ì˜ ê¸°ë³¸ í˜¸ì¶œë¡œ ë³€í™˜í•œë‹¤. ì¶œì²˜ : https://www.javatpoint.com/jdbc-driverType 3 : Network Protocol driver (ìë°”ë¡œë§Œ ì‘ì„±ë¨) ë„¤íŠ¸ì›Œí¬ í”„ë¡œí† ì½œ ë“œë¼ì´ë²„ëŠ” JDBC í˜¸ì¶œì„ ë²¤ë”ë³„ ë°ì´í„°ë² ì´ìŠ¤ í”„ë¡œí† ì½œë¡œ ì§/ê°„ì ‘ì ìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´(ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë²„)ë¥¼ ì‚¬ìš©í•œë‹¤. ì¶œì²˜ : https://www.javatpoint.com/jdbc-driverType 4 : Thin driver (ìë°”ë¡œë§Œ ì‘ì„±ë¨) Thin ë“œë¼ì´ë²„ëŠ” JDBC í˜¸ì¶œì„ ë²¤ë”ë³„ ë°ì´í„°ë² ì´ìŠ¤ í”„ë¡œí† ì½œë¡œ ì§ì ‘ ë³€í™˜í•œë‹¤. ë”°ë¼ì„œ, ì–‡ì€(thin) ë“œë¼ì´ë²„ë¡œ ì•Œë ¤ì ¸ ìˆë‹¤. ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” íƒ€ì…ìœ¼ë¡œ, í”Œë«í¼ì— ë…ë¦½ì ì´ë¼ëŠ” ì¥ì ì´ ìˆë‹¤. ë˜í•œ, ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ì— ì§ì ‘ ì ‘ì†í•˜ê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ íƒ€ì…ì— ë¹„í•´ ë” ë‚˜ì€ ì„±ëŠ¥ì„ ì œê³µí•œë‹¤. ë°ì´í„°ë² ì´ìŠ¤ë³„ ë„¤íŠ¸ì›Œí‚¹ í”„ë¡œí† ì½œì„ ì´í•´í•˜ê³  ì¶”ê°€ ì†Œí”„íŠ¸ì›¨ì–´ ì—†ì´ ë°ì´í„°ë² ì´ìŠ¤ì— ì§ì ‘ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤. ì¶œì²˜ : https://www.javatpoint.com/jdbc-driverJDBC URL JDBC ë“œë¼ì´ë²„ëŠ” JDBC URLì„ ì‚¬ìš©í•˜ì—¬ íŠ¹ì • ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‹ë³„í•˜ê³  ì—°ê²°í•œë‹¤. ì´ëŸ¬í•œ URLì€ ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ í˜•ì‹ì´ë‹¤. jdbc:driver:databasename ì˜ˆ : jdbc:mysql://localhost:3306/dbname ì°¸ê³  ìë£Œ https://www.baeldung.com/java-jdbc https://en.wikipedia.org/wiki/Java_Database_Connectivity https://docs.oracle.com/javase/8/docs/technotes/guides/jdbc/ http://www.herongyang.com/JDBC/Overview-JDBC-Version.html https://flylib.com/books/en/2.177.1.75/1/ https://www.javatpoint.com/jdbc-driver" }, { "title": "Infra - í†°ìº£ êµ¬ì¡° ì‚´í´ë³´ê¸°", "url": "/posts/tomcat-server-xml-file/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Infra", "date": "2022-04-07 22:00:00 +0900", "snippet": "í†°ìº£ êµ¬ì¡° ì¶œì²˜ : https://howtodoinjava.com/tomcat/tomcats-architecture-and-server-xml-configuration-tutorial/ ì´ëŸ¬í•œ êµ¬ì¡°ëŠ” ì¼ë°˜ì ìœ¼ë¡œ Tomcat ì„¤ì¹˜ í´ë”ì˜ /conf í•˜ìœ„ ë””ë ‰í† ë¦¬ì— ìˆëŠ” server.xml íŒŒì¼ì— ì •ì˜ëœë‹¤.server.xml ì˜ˆì‹œ&lt;?xml...", "content": "í†°ìº£ êµ¬ì¡° ì¶œì²˜ : https://howtodoinjava.com/tomcat/tomcats-architecture-and-server-xml-configuration-tutorial/ ì´ëŸ¬í•œ êµ¬ì¡°ëŠ” ì¼ë°˜ì ìœ¼ë¡œ Tomcat ì„¤ì¹˜ í´ë”ì˜ /conf í•˜ìœ„ ë””ë ‰í† ë¦¬ì— ìˆëŠ” server.xml íŒŒì¼ì— ì •ì˜ëœë‹¤.server.xml ì˜ˆì‹œ&lt;?xml version='1.0' encoding='utf-8'?&gt;&lt;Server port=\"8005\" shutdown=\"SHUTDOWN\"&gt; &lt;Listener className=\"org.apache.catalina.core.AprLifecycleListener\" SSLEngine=\"on\" /&gt; &lt;Listener className=\"org.apache.catalina.core.JasperListener\" /&gt; &lt;Listener className=\"org.apache.catalina.core.JreMemoryLeakPreventionListener\" /&gt; &lt;Listener className=\"org.apache.catalina.mbeans.GlobalResourcesLifecycleListener\" /&gt; &lt;Listener className=\"org.apache.catalina.core.ThreadLocalLeakPreventionListener\" /&gt; &lt;GlobalNamingResources&gt; &lt;Resource name=\"UserDatabase\" auth=\"Container\" type=\"org.apache.catalina.UserDatabase\" description=\"User database that can be updated and saved\" factory=\"org.apache.catalina.users.MemoryUserDatabaseFactory\" pathname=\"conf/tomcat-users.xml\" /&gt; &lt;/GlobalNamingResources&gt; &lt;Service name=\"Catalina\"&gt; &lt;Connector port=\"8080\" protocol=\"HTTP/1.1\" connectionTimeout=\"20000\" redirectPort=\"8443\" /&gt; &lt;Connector port=\"8009\" protocol=\"AJP/1.3\" redirectPort=\"8443\" /&gt; &lt;Engine name=\"Catalina\" defaultHost=\"localhost\"&gt; &lt;Realm className=\"org.apache.catalina.realm.LockOutRealm\"&gt; &lt;Realm className=\"org.apache.catalina.realm.UserDatabaseRealm\" resourceName=\"UserDatabase\"/&gt; &lt;/Realm&gt; &lt;Host name=\"localhost\" appBase=\"webapps\" unpackWARs=\"true\" autoDeploy=\"true\"&gt; &lt;Valve className=\"org.apache.catalina.valves.AccessLogValve\" directory=\"logs\" prefix=\"localhost_access_log.\" suffix=\".txt\" pattern=\"%h %l %u %t &amp;quot;%r&amp;quot; %s %b\" /&gt; &lt;/Host&gt; &lt;/Engine&gt; &lt;/Service&gt;&lt;/Server&gt;ê° êµ¬ì„±ìš”ì†Œ ì‚´í´ë³´ê¸°Context ContextëŠ” íŠ¹ì • ê°€ìƒ í˜¸ìŠ¤íŠ¸ ë‚´ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë‚˜íƒ€ë‚¸ë‹¤. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ WAR(Web Application Archive) íŒŒì¼ ë˜ëŠ” unpackëœ ì½˜í…ì¸ ë¥¼ í¬í•¨í•˜ëŠ” ë””ë ‰í„°ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤. (ë²„ì „ 2.2 ì´ìƒ ì„œë¸”ë¦¿ ìŠ¤í™ì— ì •ì˜ë˜ì–´ ìˆìŒ) ê° HTTP ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì •ì˜ëœ ê° ì»¨í…ìŠ¤íŠ¸ì˜ ì»¨í…ìŠ¤íŠ¸ ê²½ë¡œ(context path)ì— ëŒ€í•œ ìš”ì²­ URIì˜ ê°€ëŠ¥í•œ ê°€ì¥ ê¸´ ì ‘ë‘ì‚¬ë¥¼ ì¼ì¹˜ì‹œí‚¤ëŠ” ê²ƒì„ ê¸°ë°˜ìœ¼ë¡œ Catalinaì— ì˜í•´ ì„ íƒëœë‹¤. ì¼ë‹¨ ì„ íƒë˜ë©´ í•´ë‹¹ ì»¨í…ìŠ¤íŠ¸ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬ì— ì˜í•´ ì •ì˜ëœ ì„œë¸”ë¦¿ ë§¤í•‘ì— ë”°ë¼ ë“¤ì–´ì˜¤ëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•  ì ì ˆí•œ ì„œë¸”ë¦¿ì„ ì„ íƒí•œë‹¤. ì›í•˜ëŠ” ë§Œí¼ Context ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì •ì˜í•  ìˆ˜ ìˆë‹¤. ê°ê°ì˜ ì»¨í…ìŠ¤íŠ¸ëŠ” ë°˜ë“œì‹œ ê°€ìƒ í˜¸ìŠ¤íŠ¸ ë‚´ì—ì„œ ê³ ìœ í•œ ì»¨í…ìŠ¤íŠ¸ ì´ë¦„ì„ ê°€ì ¸ì•¼ í•œë‹¤. ContextëŠ” ê¸¸ì´ê°€ 0ì¸ ë¬¸ìì—´(â€œâ€œ)ë¡œ ëœ ì»¨í…ìŠ¤íŠ¸ ê²½ë¡œê°€ ìˆì–´ì•¼ í•œë‹¤. ì´ ì»¨í…ìŠ¤íŠ¸ëŠ” ì´ ê°€ìƒ í˜¸ìŠ¤íŠ¸ì˜ ê¸°ë³¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë˜ë©°, ë‹¤ë¥¸ ì»¨í…ìŠ¤íŠ¸ì˜ context pathì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ëª¨ë“  ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤. ì»¨í…ìŠ¤íŠ¸ ì •ì˜í•˜ê¸° &lt;Context&gt; ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ server.xml íŒŒì¼ì— ì§ì ‘ ë°°ì¹˜í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ë‹¤. Tomcatì„ ì¬ì‹œì‘í•´ì•¼ì§€ë§Œ conf/server.xml íŒŒì¼ì„ ë‹¤ì‹œ ë¡œë“œí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, Context ì„¤ì •ì„ ìˆ˜ì •í•˜ê¸°ê°€ ì–´ë ¤ì›Œì§„ë‹¤. ê°œë³„ ì»¨í…ìŠ¤íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ëª…ì‹œì ìœ¼ë¡œ ì •ì˜ë  ìˆ˜ ìˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ íŒŒì¼ ë‚´ë¶€ì˜ /META-INF/context.xmlì— ìˆëŠ” ê°œë³„ íŒŒì¼ì—ì„œ. ì„ íƒì ìœ¼ë¡œ(í˜¸ìŠ¤íŠ¸ì˜ copyXML ì†ì„±ì— ë”°ë¼) ì´ê²ƒì€ $CATALINA_BASE/conf/[enginename]/[hostname]/ì— ë³µì‚¬ë  ìˆ˜ ìˆìœ¼ë©° ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê¸°ë³¸ íŒŒì¼ ì´ë¦„ê³¼ .xml í™•ì¥ìë¡œ ì´ë¦„ì„ ë°”ê¿€ ìˆ˜ ìˆë‹¤. $CATALINA_BASE/conf/[enginename]/[hostname]/ ë””ë ‰í† ë¦¬ì˜ ê°œë³„ íŒŒì¼(.xml í™•ì¥ì í¬í•¨). ì»¨í…ìŠ¤íŠ¸ ê²½ë¡œ ë° ë²„ì „ì€ íŒŒì¼ì˜ ê¸°ë³¸ ì´ë¦„(íŒŒì¼ ì´ë¦„ì—ì„œ .xml í™•ì¥ìë¥¼ ëº€ ê°’)ì—ì„œ íŒŒìƒëœë‹¤. ì´ íŒŒì¼ì€ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ META-INF ë””ë ‰í† ë¦¬ì— íŒ¨í‚¤ì§•ëœ ëª¨ë“  context.xml íŒŒì¼ë³´ë‹¤ í•­ìƒ ìš°ì„ ëœë‹¤. ë©”ì¸ conf/server.xmlì˜ Host ì—˜ë¦¬ë¨¼íŠ¸ ë‚´ë¶€ì— Context ì—˜ë¦¬ë¨¼íŠ¸ë¡œ ì •ì˜. Context ì†ì„± ì‚´í´ë³´ê¸° docBase ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ Document Base(Context Root) ë””ë ‰í† ë¦¬ ë˜ëŠ” war íŒŒì¼ì˜ ê²½ë¡œ ì´ë¦„(ì• í”Œë¦¬ì¼€ì´ì…˜ì´ WAR íŒŒì¼ì—ì„œ ì§ì ‘ ì‹¤í–‰ë˜ëŠ” ê²½ìš°). ì´ ë””ë ‰í† ë¦¬ ë˜ëŠ” WAR íŒŒì¼ì— ëŒ€í•œ ì ˆëŒ€ ê²½ë¡œ ì´ë¦„ì„ ì§€ì •í•˜ê±°ë‚˜ ì†Œìœ  í˜¸ìŠ¤íŠ¸ì˜ appBase ë””ë ‰í† ë¦¬ì— ìƒëŒ€ì ì¸ ê²½ë¡œ ì´ë¦„ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤. Context ì—˜ë¦¬ë¨¼íŠ¸ê°€ server.xmlì— ì •ì˜ë˜ì–´ ìˆê±°ë‚˜ docBaseê°€ í˜¸ìŠ¤íŠ¸ì˜ appBase ì•„ë˜ì— ìˆì§€ ì•Šì€ ê²½ìš° ì´ í•„ë“œì˜ ê°’ì„ ì„¤ì •í•´ì„œëŠ” ì•ˆëœë‹¤. docBaseì— ì‹¬ë³¼ë¦­ ë§í¬ê°€ ì‚¬ìš©ë˜ëŠ” ê²½ìš° ì‹¬ë³¼ë¦­ ë§í¬ì— ëŒ€í•œ ë³€ê²½ ì‚¬í•­ì€ Tomcatì„ ë‹¤ì‹œ ì‹œì‘í•œ í›„ ë˜ëŠ” ì»¨í…ìŠ¤íŠ¸ë¥¼ ë°°í¬ ì·¨ì†Œí•˜ê³  ì¬ë°°í¬í•˜ëŠ” ê²½ìš°ì—ë§Œ ì ìš©ëœë‹¤. path ì²˜ë¦¬í•  ì ì ˆí•œ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„ íƒí•˜ê¸° ìœ„í•´, ê° ìš”ì²­ URIì˜ ì‹œì‘ ë¶€ë¶„ê³¼ ì¼ì¹˜í•˜ëŠ” ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì»¨í…ìŠ¤íŠ¸ ê²½ë¡œ íŠ¹ì • í˜¸ìŠ¤íŠ¸ ë‚´ì˜ ëª¨ë“  ì»¨í…ìŠ¤íŠ¸ ê²½ë¡œëŠ” ê³ ìœ í•´ì•¼ í•œë‹¤. ë¹ˆ ë¬¸ìì—´(â€œâ€œ)ì˜ ì»¨í…ìŠ¤íŠ¸ ê²½ë¡œë¥¼ ì§€ì •í•˜ë©´ ë‹¤ë¥¸ ì»¨í…ìŠ¤íŠ¸ì— í• ë‹¹ë˜ì§€ ì•Šì€ ëª¨ë“  ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì´ í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ ê¸°ë³¸ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì •ì˜í•˜ëŠ” ê²ƒì´ë‹¤. path ì†ì„±ì€ server.xmlì—ì„œ Contextë¥¼ ì •ì ìœ¼ë¡œ(statically) ì •ì˜í•  ë•Œë§Œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ë‹¤ë¥¸ ëª¨ë“  ìƒí™©ì—ì„œ ê²½ë¡œëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë³„ .xml íŒŒì¼ ë˜ëŠ” docBaseì— ì‚¬ìš©ëœ íŒŒì¼ ì´ë¦„ì—ì„œ ìœ ì¶”ëœë‹¤. Contextë¥¼ server.xmlì— ì •ì ìœ¼ë¡œ ì •ì˜í•˜ëŠ” ê²½ìš°ì—ë„ docBaseê°€ í˜¸ìŠ¤íŠ¸ì˜ appBase ì•„ë˜ì— ìˆì§€ ì•Šê±°ë‚˜ deployOnStartup ë° autoDeployê°€ ëª¨ë‘ falseì¸ ê²½ìš°ê°€ ì•„ë‹ˆë©´ ì´ ì†ì„±ì„ ì„¤ì •í•´ì„œëŠ” ì•ˆëœë‹¤. ì´ ê·œì¹™ì„ ë”°ë¥´ì§€ ì•Šì„ ê²½ìš° ì´ì¤‘ ë°°í¬ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. Connector ConnectorëŠ” í´ë¼ì´ì–¸íŠ¸ì™€ì˜ í†µì‹ ì„ ì²˜ë¦¬í•œë‹¤. Tomcatì—ëŠ” ì—¬ëŸ¬ ì»¤ë„¥í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. HTTP connector : ëŒ€ë¶€ë¶„ì˜ HTTP íŠ¸ë˜í”½ ì²˜ë¦¬ AJP connector : Tomcatì„ Apache HTTPD ì„œë²„ì™€ ê°™ì€ ì›¹ ì„œë²„ì— ì—°ê²°í•  ë•Œ ì‚¬ìš©(AJP í”„ë¡œí† ì½œ êµ¬í˜„) AJP ì»¤ë„¥í„°ë¥¼ ì‚¬ìš©í•˜ë©´ Tomcatì´ ë™ì  ì›¹ í˜ì´ì§€ë§Œ ì²˜ë¦¬í•˜ê³ , ìˆœìˆ˜ HTML ì„œë²„(ì˜ˆ: Apache ì›¹ ì„œë²„)ê°€ ì •ì  í˜ì´ì§€ì— ëŒ€í•œ ìš”ì²­ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. ì›¹ ì„œë²„ë¥¼ Tomcatê³¼ í•¨ê»˜ ì‚¬ìš©í•  ê³„íšì´ ì—†ë‹¤ë©´ ì´ ì»¤ë„¥í„°ë¥¼ ì£¼ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. AJP ì»¤ë„¥í„°ë¥¼ ì‚¬ìš©í•˜ë©´ Tomcatì´ ë™ì  ì›¹ í˜ì´ì§€ë§Œ ì²˜ë¦¬í•˜ê³  ìˆœìˆ˜ HTML ì„œë²„(ì˜ˆ: Apache ì›¹ ì„œë²„)ê°€ ì •ì  í˜ì´ì§€ì— ëŒ€í•œ ìš”ì²­ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. Tomcat ìì²´ê°€ ì˜¤ëŠ˜ë‚  ë§¤ìš° ë¹ ë¥´ê±°ë‚˜ ë‹¨ìˆœíˆ ì›¹ ì„œë²„ë¥¼ Tomcatê³¼ í•¨ê»˜ ì‚¬ìš©í•  ê³„íšì´ ì—†ë‹¤ë©´ ì´ ì»¤ë„¥í„°ë¥¼ ì£¼ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ ìš”ì²­ì€ ì»¤ë„¥í„°ì˜ ë‹¨ì¼ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í†µê³¼í•œë‹¤. ìš”ì²­ì„ ë°›ì•˜ì„ ë•Œ, ì»¤ë„¥í„° ë‚´ì— alive ìƒíƒœë¡œ ë‚¨ì•„ìˆëŠ” ìƒˆ ìŠ¤ë ˆë“œê°€ ì¸ìŠ¤í„´ìŠ¤í™”ëœë‹¤(ìš”ì²­ì´ ì²˜ë¦¬ë˜ëŠ” ë™ì•ˆ). ì»¤ë„¥í„°ëŠ” â€œCoyoteâ€ë¡œ ë¶ˆë¦¬ê¸°ë„ í•œë‹¤.Connector ì†ì„± ì‚´í´ë³´ê¸° port ì´ ì»¤ë„¥í„°ê°€ ì„œë²„ ì†Œì¼“ì„ ë§Œë“¤ê³  ë“¤ì–´ì˜¤ëŠ” ì—°ê²°ì„ ê¸°ë‹¤ë¦¬ëŠ” TCP í¬íŠ¸ ë²ˆí˜¸ ìš´ì˜ ì²´ì œëŠ” í•˜ë‚˜ì˜ ì„œë²„ ì• í”Œë¦¬ì¼€ì´ì…˜ë§Œ íŠ¹ì • IP ì£¼ì†Œì˜ íŠ¹ì • í¬íŠ¸ ë²ˆí˜¸ë¥¼ ìˆ˜ì‹ í•˜ë„ë¡ í—ˆìš©í•œë‹¤. 0ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° Tomcatì€ ì´ ì»¤ë„¥í„°ì— ì‚¬ìš©í•  ì—¬ìœ  í¬íŠ¸ë¥¼ ì„ì˜ë¡œ ì„ íƒí•œë‹¤. connectionTimeout ì •ì˜ëœ ì‹œê°„ë™ì•ˆ í™œë™ì´ ì—†ìœ¼ë©´ ì„¸ì…˜ì´ ì¢…ë£Œë¨ì„ ì˜ë¯¸í•œë‹¤. (ë‹¨ìœ„ : ì´ˆ) redirectPort SSL(Secure Socket Layer) ì „ì†¡ì´ í•„ìš”í•œ ìš”ì²­ì€ ì •ì˜ëœ í¬íŠ¸ë¡œ ë¦¬ë””ë ‰ì…˜ ëœë‹¤. address IP ì£¼ì†Œê°€ ë‘ ê°œ ì´ìƒì¸ ì„œë²„ì˜ ê²½ìš°, ì§€ì •ëœ í¬íŠ¸ì—ì„œ ìˆ˜ì‹  ëŒ€ê¸°í•˜ëŠ” ë° ì‚¬ìš©í•  ì£¼ì†Œë¥¼ ì§€ì •í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ì´ í¬íŠ¸ëŠ” ì„œë²„ì™€ ì—°ê²°ëœ ëª¨ë“  IP ì£¼ì†Œì—ì„œ ì‚¬ìš©ëœë‹¤. 127.0.0.1 ê°’ì€ ì»¤ë„¥í„°ê°€ ë£¨í”„ë°± ì¸í„°í˜ì´ìŠ¤ì—ì„œë§Œ ìˆ˜ì‹  ëŒ€ê¸°í•¨ì„ ë‚˜íƒ€ë‚¸ë‹¤. secret(tomcat 9 ì´ìƒ) secret í‚¤ì›Œë“œê°€ ìˆëŠ” workerì˜ ìš”ì²­ë§Œ ìˆ˜ë½í•œë‹¤. ê¸°ë³¸ê°’ì€ nullì´ë©°, secretRequiredê°€ ëª…ì‹œì ìœ¼ë¡œ falseë¡œ êµ¬ì„±ë˜ì§€ ì•ŠëŠ” í•œ ì´ ì†ì„±ì€ nullì´ ì•„ë‹ˆê³  ê¸¸ì´ê°€ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ ì§€ì •ë˜ì–´ì•¼ í•œë‹¤. ì´ ì†ì„±ì´ null, ê¸¸ì´ê°€ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ êµ¬ì„±ëœ ê²½ìš°, ì‘ì—…ìëŠ” workerëŠ” ì¼ì¹˜í•˜ëŠ” ê°’ì„ ì œê³µí•´ì•¼ í•œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ secretRequired ì„¤ì •ì— ê´€ê³„ì—†ì´ ìš”ì²­ì´ ê±°ë¶€ëœë‹¤. secretRequired(tomcat 9 ì´ìƒ) ì´ ì†ì„±ì´ trueì´ë©´ secret ì†ì„±ì´ nullê³¼ ê¸¸ì´ê°€ 0ì´ ì•„ë‹Œ ê°’ìœ¼ë¡œ êµ¬ì„±ëœ ê²½ìš°ì—ë§Œ AJP ì»¤ë„¥í„°ê°€ ì‹œì‘ëœë‹¤. ì´ ì†ì„±ì€ ì»¤ë„¥í„°ê°€ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë„¤íŠ¸ì›Œí¬ì—ì„œ ì‚¬ìš©ë  ë•Œë§Œ falseë¡œ ì„¤ì •ë˜ì–´ì•¼ í•œë‹¤. Host HostëŠ” ì„œë²„ì˜ ë„¤íŠ¸ì›Œí¬ ì´ë¦„(ì˜ˆ: www.example.com)ì„ Tomcatì´ ì‹¤í–‰ë˜ê³  ìˆëŠ” íŠ¹ì • ì„œë²„ì™€ ì—°ê²°í•˜ëŠ” ê°€ìƒ í˜¸ìŠ¤íŠ¸ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. í´ë¼ì´ì–¸íŠ¸ê°€ ë„¤íŠ¸ì›Œí¬ ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ Tomcat ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ìˆìœ¼ë ¤ë©´, ì´ ì´ë¦„ì„ ì‚¬ìš©ìê°€ ì†í•œ ì¸í„°ë„· ë„ë©”ì¸ì„ ê´€ë¦¬í•˜ëŠ” DNS(Domain Name Service) ì„œë²„ì— ë“±ë¡í•´ì•¼ í•œë‹¤. ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì‹œìŠ¤í…œ ê´€ë¦¬ìëŠ” ë‘˜ ì´ìƒì˜ ë„¤íŠ¸ì›Œí¬ ì´ë¦„(ì˜ˆ: www.mycompany.com ë° company.com)ì„ ë™ì¼í•œ ê°€ìƒ í˜¸ìŠ¤íŠ¸ ë° ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì—°ê²°í•˜ë ¤ê³  í•©ë‹ˆë‹¤. ì´ ì‘ì—…ì€ í˜¸ìŠ¤íŠ¸ ì´ë¦„ ë³„ì¹­ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì—¬ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. í•˜ë‚˜ ì´ìƒì˜ Host ì—˜ë¦¬ë¨¼íŠ¸ê°€ Engine ì—˜ë¦¬ë¨¼íŠ¸ ë‚´ë¶€ì— ì •ì˜ë  ìˆ˜ ìˆë‹¤. Host ì—˜ë¦¬ë¨¼íŠ¸ ë‚´ì— ê°€ìƒ í˜¸ìŠ¤íŠ¸ì™€ ì—°ê²°ëœ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ Context ì—˜ë¦¬ë¨¼íŠ¸ê°€ í•˜ë‚˜ ì´ìƒ ì •ì˜ë  ìˆ˜ ìˆë‹¤. ê° ì—”ì§„ê³¼ ê´€ë ¨ëœ í˜¸ìŠ¤íŠ¸ ì¤‘ ì •í™•íˆ í•˜ë‚˜ëŠ” ë°˜ë“œì‹œ í•´ë‹¹ ì—”ì§„ì˜ defaultHost ì†ì„±ê³¼ ì¼ì¹˜í•˜ëŠ” ì´ë¦„ì„ ê°€ì ¸ì•¼ í•œë‹¤. í´ë¼ì´ì–¸íŠ¸ëŠ” ì¼ë°˜ì ìœ¼ë¡œ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ì‚¬ìš©í•˜ì—¬ ì—°ê²°í•˜ë ¤ëŠ” ì„œë²„ë¥¼ ì‹ë³„í•œë‹¤. ì´ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì€ HTTP ìš”ì²­ í—¤ë”ì—ë„ í¬í•¨ëœë‹¤. Tomcatì€ HTTP í—¤ë”ì—ì„œ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ì¶”ì¶œí•˜ê³  ì´ë¦„ì´ ì¼ì¹˜í•˜ëŠ” í˜¸ìŠ¤íŠ¸ë¥¼ ì°¾ëŠ”ë‹¤. ì¼ì¹˜í•˜ëŠ” í•­ëª©ì´ ì—†ìœ¼ë©´ ìš”ì²­ì´ ê¸°ë³¸ í˜¸ìŠ¤íŠ¸ë¡œ ë¼ìš°íŒ…ëœë‹¤. DNS ì´ë¦„ì´ Host ì—˜ë¦¬ë¨¼íŠ¸ì˜ ì´ë¦„ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ëª¨ë“  ìš”ì²­ì€ ê¸°ë³¸ í˜¸ìŠ¤íŠ¸ë¡œ ë¼ìš°íŒ…ë˜ê¸° ë•Œë¬¸ì—, ê¸°ë³¸ í˜¸ìŠ¤íŠ¸ì˜ ì´ë¦„ì€ DNS ì´ë¦„ê³¼ ì¼ì¹˜í•  í•„ìš”ê°€ ì—†ë‹¤(ê°€ëŠ¥í•˜ë”ë¼ë„). CATALINA_BASE ë””ë ‰í† ë¦¬ë¥¼ ì„¤ì •í•˜ì—¬ ì—¬ëŸ¬ ì¸ìŠ¤í„´ìŠ¤ì— ëŒ€í•´ Tomcatì„ êµ¬ì„±í•˜ì§€ ì•Šì€ ê²½ìš° $CATALINA_BASEëŠ” Tomcatì„ ì„¤ì¹˜í•œ ë””ë ‰í† ë¦¬ì¸ $ CATALINA_HOMEì˜ ê°’ìœ¼ë¡œ ì„¤ì •ëœë‹¤.Host ì†ì„± ì‚´í´ë³´ê¸° appBase Tomcat ì„¤ì¹˜ í´ë” ë‚´ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë””ë ‰í„°ë¦¬ë¥¼ ì •ì˜í•œë‹¤. ê° ì• í”Œë¦¬ì¼€ì´ì…˜ì€ í•´ë‹¹ ë””ë ‰í„°ë¦¬ ë‚´ì˜ ê²½ë¡œë¡œ ì‹ë³„ëœë‹¤. ìœ ì¼í•œ ì˜ˆì™¸ëŠ” ë¹ˆ ë¬¸ìì—´ì— ë§¤í•‘ë˜ëŠ” ROOT ê²½ë¡œì…ì´ë‹¤. localhostì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ê¸°ë³¸ ë””ë ‰í† ë¦¬ëŠ” webappsë‹¤. ì¦‰, í†°ìº£ ì„¤ì¹˜ ê²½ë¡œ\\webapps\\ROOT\\ ë””ë ‰í† ë¦¬ì— ìˆëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë¹ˆ ë¬¸ìì—´ë¡œ ì‹ë³„ëœë‹¤. ex : \"http://localhost:8080/ í†°ìº£ ì„¤ì¹˜ ê²½ë¡œ\\webapps\\myapp\\ì™€ ê°™ì´ ROOT ì´ì™¸ì˜ ë””ë ‰í„°ë¦¬ì— ìˆëŠ” ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê²½ìš° URLì€ http://localhost:8080/myapp/ë¡œ ì‹ë³„ëœë‹¤. The Application Base directory for this virtual host. This is the pathname of a directory that may contain web applications to be deployed on this virtual host. You may specify an absolute pathname, or a pathname that is relative to the $CATALINA_BASE directory. See Automatic Application Deployment for more information on automatic recognition and deployment of web applications. If not specified, the default of webapps will be used. unpackWARs trueë¡œ ì„¤ì •í•˜ê³  war íŒŒì¼ì„ appBase ë””ë ‰í† ë¦¬ì— ë†“ìœ¼ë©´, Tomcatì´ ìë™ìœ¼ë¡œ ì••ì¶•ì„ í•´ì œí•˜ì—¬ ì¼ë°˜ í´ë”ë¡œ í™•ì¥í•œë‹¤. falseë¡œ ì„¤ì •í•˜ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ war íŒŒì¼ì—ì„œ ì§ì ‘ ì‹¤í–‰ëœë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ì‹œ ì••ì¶•ì„ í’€ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì—, trueì¼ ë•Œ ë³´ë‹¤ ì‹¤í–‰ ì†ë„ëŠ” ëŠë ¤ì§€ê²Œ ëœë‹¤. autoDeploy trueë¡œ ì„¤ì •ë˜ë©´ Tomcatì´ ì‹¤í–‰ë˜ëŠ” ë™ì•ˆ appBase ë””ë ‰í† ë¦¬ì— ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë†“ìœ¼ë©´ ìë™ìœ¼ë¡œ ë°°í¬ëœë‹¤. Engine Engineì€ íŠ¹ì • ì„œë¹„ìŠ¤ì— ëŒ€í•œ ìš”ì²­ ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸ì„ ë‚˜íƒ€ë‚¸ë‹¤. ì—”ì§„ì€ ì„œë¹„ìŠ¤ì— ì •ì˜ëœ ëª¨ë“  ì»¤ë„¥í„°ì˜ ìš”ì²­ì„ ìˆ˜ì‹  ë° ì²˜ë¦¬í•˜ê³ , ì‘ë‹µì„ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ì†¡í•˜ê¸° ìœ„í•´ ì ì ˆí•œ ì»¤ë„¥í„°ì— ë‹¤ì‹œ ì „ë‹¬í•œë‹¤. ì—”ì§„ì€ í•˜ë‚˜ ì´ìƒì˜ í˜¸ìŠ¤íŠ¸ë¥¼ í¬í•¨í•´ì•¼ í•˜ë©° ê·¸ ì¤‘ í•˜ë‚˜ëŠ” ê¸°ë³¸ í˜¸ìŠ¤íŠ¸ë¡œ ì§€ì •ëœë‹¤. ê¸°ë³¸ Tomcat êµ¬ì„±ì—ëŠ” í˜¸ìŠ¤íŠ¸ localhostë¥¼ í¬í•¨í•˜ëŠ” ì—”ì§„ Catalinaê°€ í¬í•¨ëœë‹¤.(ê¸°ë³¸ í˜¸ìŠ¤íŠ¸ê°€ ìœ ì¼í•œ í˜¸ìŠ¤íŠ¸ì´ê¸° ë•Œë¬¸ì— ê¸°ë³¸ í˜¸ìŠ¤íŠ¸ë¡œ ì§€ì •ë¨) Catalina ì—”ì§„ì€ HTTP ì»¤ë„¥í„°ë¥¼ í†µí•´ ìˆ˜ì‹ ëœ ëª¨ë“  ìˆ˜ì‹  ìš”ì²­ì„ ì²˜ë¦¬í•˜ê³  í•´ë‹¹ ì‘ë‹µì„ ë‹¤ì‹œ ë³´ë‚¸ë‹¤. ìš”ì²­ í—¤ë”ì— í¬í•¨ëœ ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê° ìš”ì²­ì„ ì˜¬ë°”ë¥¸ í˜¸ìŠ¤íŠ¸ ë° ì»¨í…ìŠ¤íŠ¸ë¡œ ì „ë‹¬í•œë‹¤.Service ServiceëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì—”ì§„ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ê³µìœ í•˜ëŠ” í•˜ë‚˜ ì´ìƒì˜ ì»¤ë„¥í„° ì—˜ë¦¬ë¨¼íŠ¸ì˜ ì¡°í•©ì„ ë‚˜íƒ€ë‚¸ë‹¤. Tomcatì˜ ê¸°ë³¸ êµ¬ì„±ì—ëŠ” HTTP ë° AJP ì»¤ë„¥í„°ë¥¼ Catalina ì—”ì§„ì— ì—°ê²°í•˜ëŠ” Catalina ì„œë¹„ìŠ¤ê°€ í¬í•¨ëœë‹¤. ê¸°ë³¸ êµ¬í˜„ì´ ê°„ë‹¨í•˜ê³  ì¶©ë¶„í•˜ê¸° ë•Œë¬¸ì— ì„œë¹„ìŠ¤ëŠ” ì‚¬ìš©ìì— ì˜í•´ ê±°ì˜ ì»¤ìŠ¤í„°ë§ˆì´ì§• ë˜ì§€ ì•ŠëŠ”ë‹¤.Server ServerëŠ” Catalina ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ê³ ìœ í•œ ì—”ì§„ê³¼ ì»¤ë„¥í„°ê°€ ìˆëŠ” í•˜ë‚˜ ì´ìƒì˜ ì„œë¹„ìŠ¤ë¥¼ í¬í•¨í•  ìˆ˜ ìˆë‹¤. conf/server.xml êµ¬ì„± íŒŒì¼ì—ì„œ ê°€ì¥ ë°”ê¹¥ìª½ì˜ ë‹¨ì¼ ìš”ì†Œì—¬ì•¼ í•œë‹¤. ì´ ì†ì„±ì€ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆ ì „ì²´ì˜ íŠ¹ì„±ì„ ë‚˜íƒ€ë‚¸ë‹¤.Server ì†ì„± ì‚´í´ë³´ê¸° port ì„œë²„ê°€ ì¢…ë£Œ(shutdown) ëª…ë ¹ì„ ê¸°ë‹¤ë¦¬ëŠ” TCP/IP í¬íŠ¸ ë²ˆí˜¸ shutdown í¬íŠ¸ë¥¼ ë¹„í™œì„±í™”í•˜ë ¤ë©´ -1ë¡œ ì„¤ì •í•œë‹¤. ì¢…ë£Œ í¬íŠ¸ ë¹„í™œì„±í™”ëŠ” Apache Commons Daemonì„ ì‚¬ìš©í•˜ì—¬ Tomcatì„ ì‹œì‘í•  ë•Œ ì˜ ì‘ë™í•©ë‹ˆë‹¤(Windowsì—ì„œ ì„œë¹„ìŠ¤ë¡œ ì‹¤í–‰ë˜ê±°ë‚˜ un * xesì—ì„œ jsvcë¡œ ì‹¤í–‰). í‘œì¤€ ì…¸ ìŠ¤í¬ë¦½íŠ¸ë¡œ Tomcatì„ ì‹¤í–‰í•  ë•ŒëŠ” ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. ì´ëŠ” shutdown bat|.sh ë° catalina.bat|.shê°€ ì •ìƒì ìœ¼ë¡œ ì¤‘ì§€í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ë•Œë¬¸ì´ë‹¤. shutdown Tomcatì„ ì¢…ë£Œí•˜ê¸° ìœ„í•´, ì§€ì •ëœ í¬íŠ¸ ë²ˆí˜¸ì— TCP/IP ì—°ê²°ì„ í†µí•´ ìˆ˜ì‹ í•´ì•¼ í•˜ëŠ” ëª…ë ¹ ë¬¸ìì—´ ì°¸ê³  ìë£Œ https://howtodoinjava.com/tomcat/tomcats-architecture-and-server-xml-configuration-tutorial/ https://tomcat.apache.org/tomcat-8.0-doc/config/context.html https://tomcat.apache.org/tomcat-8.0-doc/config/host.html https://tomcat.apache.org/tomcat-8.0-doc/config/server.html https://tomcat.apache.org/tomcat-8.0-doc/config/service.html https://tomcat.apache.org/tomcat-8.0-doc/config/ajp.html" }, { "title": "IntelliJ - í”„ë¡œì íŠ¸, ëª¨ë“ˆì´ë€ ?", "url": "/posts/project-and-module/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ê¸°íƒ€", "tags": "IDE", "date": "2022-04-02 20:25:00 +0900", "snippet": "Project í”„ë¡œì íŠ¸ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì„±í•˜ëŠ” ëª¨ë“  ê²ƒ(ëª¨ë“ˆ, ì¢…ì†ì„±, ê³µí†µ ì„¤ì • ë“±)ì„ ë³´ê´€í•˜ëŠ” ë””ë ‰í† ë¦¬ì´ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ í”„ë¡œì íŠ¸ì—ëŠ” ê´€ë ¨ ëª¨ë“ˆ, ì• í”Œë¦¬ì¼€ì´ì…˜, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±ì´ í¬í•¨ë˜ë©°, ì´ë¥¼ í†µí•´ ìƒí˜¸ ì˜ì¡´ì ìœ¼ë¡œ í˜‘ë ¥í•˜ì—¬ ê°œë°œì´ ê°€ëŠ¥í•´ì§„ë‹¤. ì¶œì²˜ : https://www.jetbrains.com/help/idea/working-with...", "content": "Project í”„ë¡œì íŠ¸ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ êµ¬ì„±í•˜ëŠ” ëª¨ë“  ê²ƒ(ëª¨ë“ˆ, ì¢…ì†ì„±, ê³µí†µ ì„¤ì • ë“±)ì„ ë³´ê´€í•˜ëŠ” ë””ë ‰í† ë¦¬ì´ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ í”„ë¡œì íŠ¸ì—ëŠ” ê´€ë ¨ ëª¨ë“ˆ, ì• í”Œë¦¬ì¼€ì´ì…˜, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±ì´ í¬í•¨ë˜ë©°, ì´ë¥¼ í†µí•´ ìƒí˜¸ ì˜ì¡´ì ìœ¼ë¡œ í˜‘ë ¥í•˜ì—¬ ê°œë°œì´ ê°€ëŠ¥í•´ì§„ë‹¤. ì¶œì²˜ : https://www.jetbrains.com/help/idea/working-with-projects.html#settings-types Project ì„¤ì • í”„ë¡œì íŠ¸ ì„¤ì •ì€ .xml í˜•ì‹ìœ¼ë¡œ .idea ë””ë ‰í† ë¦¬ì— ë‹¤ë¥¸ í”„ë¡œì íŠ¸ íŒŒì¼ê³¼ í•¨ê»˜ ì €ì¥ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´, VCS ì„¤ì •, SDK, ì½”ë“œ ìŠ¤íƒ€ì¼ ë° ë§ì¶¤ë²• ê²€ì‚¬ê¸° ì„¤ì •, ì»´íŒŒì¼ëŸ¬ ì¶œë ¥, í”„ë¡œì íŠ¸ ë‚´ì˜ ëª¨ë“  ëª¨ë“ˆì— ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ë“±ì„ ì„¸íŒ…í•œë‹¤.Project SDK SDKëŠ” íŠ¹ì • ì†Œí”„íŠ¸ì›¨ì–´ í”„ë ˆì„ì›Œí¬ìš© ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ëŠ” ë° í•„ìš”í•œ ë„êµ¬ ëª¨ìŒì´ë‹¤. í•„ìš”í•œ SDKê°€ ì»´í“¨í„°ì— ì„¤ì¹˜ë˜ì–´ ìˆì§€ë§Œ IDEì— ì •ì˜ë˜ì–´ ìˆì§€ ì•Šì€ ê²½ìš°, Add SDK | 'SDK name'ì„ ì§€ì •í•˜ê³  SDK í™ˆ ë””ë ‰í„°ë¦¬ì˜ ê²½ë¡œë¥¼ ì§€ì •í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, Java ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•˜ë ¤ë©´ JDK(Java Development Kit)ê°€ í•„ìš”í•˜ë‹¤.Project language level Language levelì€ í¸ì§‘ê¸°ê°€ ì œê³µí•˜ëŠ” ì½”ë”© ì§€ì› ê¸°ëŠ¥ì„ ì •ì˜í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ JDK 9ë¥¼ ì‚¬ìš©í•˜ê³  ì–¸ì–´ ë ˆë²¨ì„ 8ë¡œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë°”ì´íŠ¸ì½”ë“œê°€ Java 8ê³¼ í˜¸í™˜ë˜ëŠ” ë°˜ë©´, ê²€ì‚¬(inspection)ì—ì„œëŠ” Java 9ì˜ êµ¬ì„±ì„ ì‚¬ìš©í•˜ì§€ ì•Šë„ë¡í•œë‹¤. Language levelì€ ì»´íŒŒì¼ì—ë„ ì˜í–¥ì„ ì¤€ë‹¤. ì»´íŒŒì¼ëŸ¬((Settings/Preferences | Build, Execution, Deployment | Compiler | Java Compiler))ì˜ íƒ€ê²Ÿ ë°”ì´íŠ¸ì½”ë“œ ë²„ì „ì„ ë”°ë¡œ ì„¸íŒ…í•˜ì§€ ì•Šìœ¼ë©´, íƒ€ê²Ÿ ë°”ì´íŠ¸ì½”ë“œ ë²„ì „ì€ Language levelë¡œ ê°„ì£¼ëœë‹¤. Project compiler output ì»´íŒŒì¼ëŸ¬ ì¶œë ¥ ê²½ë¡œëŠ” IntelliJ IDEAê°€ ì»´íŒŒì¼ ê²°ê³¼ë¥¼ ì €ì¥í•˜ëŠ” ë””ë ‰í† ë¦¬ ê²½ë¡œì´ë‹¤. ì´ ë””ë ‰í„°ë¦¬ì—ì„œ IDEëŠ” ë‘ ê°œì˜ í•˜ìœ„ ë””ë ‰í„°ë¦¬ë¥¼ ë§Œë“ ë‹¤. production : í”„ë¡œë•ì…˜ ì½”ë“œ test : í…ŒìŠ¤íŠ¸ ì½”ë“œ í•˜ìœ„ ë””ë ‰í† ë¦¬ì—ì„œ ê° ëª¨ë“ˆì— ëŒ€í•œ ê°œë³„ ì¶œë ¥ ë””ë ‰í† ë¦¬ê°€ ìƒì„±ëœë‹¤.Module IntelliJ IDEAì—ì„œ ëª¨ë“ˆì€ ëª¨ë“  í”„ë¡œì íŠ¸ì˜ í•„ìˆ˜ì ì¸ ë¶€ë¶„ìœ¼ë¡œì¨, í”„ë¡œì íŠ¸ì™€ í•¨ê»˜ ìë™ìœ¼ë¡œ ìƒì„±ëœë‹¤. í”„ë¡œì íŠ¸ëŠ” ì—¬ëŸ¬ ëª¨ë“ˆì„ í¬í•¨í•  ìˆ˜ ìˆë‹¤(ë©€í‹° ëª¨ë“ˆ í”„ë¡œì íŠ¸). ë˜í•œ, ìƒˆ ëª¨ë“ˆì„ ì¶”ê°€í•˜ê³  ê·¸ë£¹í™”í•˜ê³  í˜„ì¬ í•„ìš”í•˜ì§€ ì•Šì€ ëª¨ë“ˆì„ ì–¸ë¡œë“œí•  ìˆ˜ ìˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ëª¨ë“ˆì€ ë‚´ë¶€ ì„¤ì •ì„ ìœ ì§€í•˜ëŠ” .iml íŒŒì¼ê³¼ ì†ŒìŠ¤ ì½”ë“œ, ë¦¬ì†ŒìŠ¤, í…ŒìŠ¤íŠ¸ ë“±ì„ ì €ì¥í•˜ëŠ” content rootë¡œ êµ¬ì„±ëœë‹¤. content root ì—†ì´ ëª¨ë“ˆì´ ì¡´ì¬í•  ìˆ˜ë„ ìˆë‹¤. ê° ëª¨ë“ˆì€ ìì²´ í”„ë ˆì„ì›Œí¬ë¥¼ ë‹´ë‹¹í•  ìˆ˜ ìˆë‹¤. ê° ëª¨ë“ˆì€ ë³„ë„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬, webapp ë“±ì´ ë  ìˆ˜ ìˆë‹¤. ê° ëª¨ë“ˆì€ íŒ¨í‚¤ì§€ëœ ì½”ë“œì˜ ë‹¨ì¼ ìœ í˜•(jar íŒŒì¼, war íŒŒì¼ ë“±)ìš©ì´ë‹¤. ì¶œì²˜ : https://www.jetbrains.com/help/idea/working-with-projects.html#settings-types ì°¸ê³  ìë£Œ https://www.jetbrains.com/help/idea/working-with-projects.html#settings-types https://www.jetbrains.com/help/idea/working-with-projects.html https://www.jetbrains.com/help/idea/project-settings-and-structure.html https://www.jetbrains.com/help/idea/creating-and-managing-modules.html https://intellij-support.jetbrains.com/hc/en-us/community/posts/206887325-Difference-between-project-and-module" }, { "title": "group by, order by, ë“œë¼ì´ë¹™ í…Œì´ë¸” ìˆ˜ì •ì„ í†µí•œ ì¿¼ë¦¬ ì„±ëŠ¥ ê°œì„ í•˜ê¸°", "url": "/posts/query-tuning-1/", "categories": "ê²½í—˜í•˜ê¸°, ì‘ì—… ë…¸íŠ¸", "tags": "MySQL", "date": "2022-03-20 23:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „íšŒì‚¬ì—ì„œ ê°œë°œí•˜ë©´ì„œ ì²˜ìŒìœ¼ë¡œ ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ ê°œì„ í•´ë³´ì•˜ë‹¤. ì œëŒ€ë¡œ í•œê±´ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ ë‚˜ë¦„ëŒ€ë¡œ ê³µë¶€í•´ì„œ 7ì´ˆì—ì„œ 0.4ì´ˆê¹Œì§€ ê°œì„ ë˜ì—ˆë‹¤.ê·¸ ê³¼ì •ì„ ê°„ëµí•˜ê²Œ ì ì–´ë³´ê³  ì•ìœ¼ë¡œ ë˜ ë‹¤ë¥¸ ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ ë§Œë‚˜ê²Œë˜ë©´ ê¸°ë¡í•  ì˜ˆì •ì´ë‹¤.ì¿¼ë¦¬ íŠœë‹ ê³¼ì • ìµœì´ˆ ì¿¼ë¦¬ ìˆ˜í–‰ ì‹œê°„ : ì•½ 7ì´ˆ ìµœì´ˆ ì¿¼ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. (ë¬¸ì œê°€ ëë˜ ë¶€ë¶„ ê¸°ë¡, í…Œì´ë¸”ëª…, ì»¬ëŸ¼...", "content": "ë“¤ì–´ê°€ê¸° ì „íšŒì‚¬ì—ì„œ ê°œë°œí•˜ë©´ì„œ ì²˜ìŒìœ¼ë¡œ ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ ê°œì„ í•´ë³´ì•˜ë‹¤. ì œëŒ€ë¡œ í•œê±´ì§€ëŠ” ëª¨ë¥´ê² ì§€ë§Œ ë‚˜ë¦„ëŒ€ë¡œ ê³µë¶€í•´ì„œ 7ì´ˆì—ì„œ 0.4ì´ˆê¹Œì§€ ê°œì„ ë˜ì—ˆë‹¤.ê·¸ ê³¼ì •ì„ ê°„ëµí•˜ê²Œ ì ì–´ë³´ê³  ì•ìœ¼ë¡œ ë˜ ë‹¤ë¥¸ ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ ë§Œë‚˜ê²Œë˜ë©´ ê¸°ë¡í•  ì˜ˆì •ì´ë‹¤.ì¿¼ë¦¬ íŠœë‹ ê³¼ì • ìµœì´ˆ ì¿¼ë¦¬ ìˆ˜í–‰ ì‹œê°„ : ì•½ 7ì´ˆ ìµœì´ˆ ì¿¼ë¦¬ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. (ë¬¸ì œê°€ ëë˜ ë¶€ë¶„ ê¸°ë¡, í…Œì´ë¸”ëª…, ì»¬ëŸ¼ëª…ì€ ë³´ì•ˆìƒ ë³€ê²½) SELECT (SELECT GROUP_CONCAT(tmp.cnt) FROM (SELECT og.ì»¬ëŸ¼1, count(gu.ì»¬ëŸ¼2) cnt FROM tbl5 og LEFT OUTER JOIN (SELECT ì»¬ëŸ¼1, ì»¬ëŸ¼2 FROM tbl6 WHERE ì»¬ëŸ¼3 IS NOT NULL) gu ON og.ì»¬ëŸ¼1 = gu.ì»¬ëŸ¼1 and og.ì»¬ëŸ¼2 = gu.ì»¬ëŸ¼2 GROUP BY og.ì»¬ëŸ¼2, og.ì»¬ëŸ¼1 ORDER BY og.ì»¬ëŸ¼2) tmp WHERE tmp.ì»¬ëŸ¼1 = tbl1.ì»¬ëŸ¼1) as regi_qty, ... FROM tbl1 LEFT OUTER JOIN tbl2 ON tbl1.ì»¬ëŸ¼1 = tbl2.ì»¬ëŸ¼1 LEFT OUTER JOIN tbl3 ON tbl1.ì»¬ëŸ¼1 = tbl3.ì»¬ëŸ¼1 LEFT OUTER JOIN tbl4 ON tbl1.ì»¬ëŸ¼4 = tbl4.ì»¬ëŸ¼4 WHERE 1=1 AND tbl1.ë“±ë¡ì¼ &gt;= '2021-09-20' AND tbl1.ë“±ë¡ì¼ &lt; ADDDATE('2022-03-20',1) AND tbl1.ì£¼ë¬¸íƒ€ì… IN ( 'ê°’1' , 'ê°’2' );ì‹¤í–‰ê³„íš ë¬¸ì œê°€ ë ë§Œí•œ ë¶€ë¶„ì´ë¼ê³  ìƒê°í–ˆë˜ ë¶€ë¶„ì— í‘œì‹œë¥¼ í–ˆë‹¤. og í…Œì´ë¸” ì¸ë±ìŠ¤ í’€ìŠ¤ìº” ê·¸ë¡œ ì¸í•´ ì„ì‹œ í…Œì´ë¸”ì¸ derived7 í…Œì´ë¸”ì„ ë§Œë“¤ê¸° ìœ„í•´ ì¡°ì¸ì‹œ ë§ì€ ë ˆì½”ë“œì— ì ‘ê·¼ ì„ì‹œ í…Œì´ë¸” ìƒì„± ë° ì •ë ¬ (Using temporary, Using filesort) íŠœë‹1 ì„ì‹œ í…Œì´ë¸” ìƒì„± ë° ì •ë ¬í•˜ëŠ” ë¶€ë¶„ì„ ì œê±°í–ˆë‹¤. (ìˆ˜í–‰ ì‹œê°„ : ì•½ 3.5ì´ˆ) MySQLì€ GROUP BY, ORDER BY ì²˜ë¦¬ë¥¼ ìœ„í•´ ì„ì‹œ í…Œì´ë¸”ì„ ë§Œë“¤ê¸° ë•Œë¬¸ì—, Using temporary, Using filesortê°€ ë‚˜ì˜¤ê²Œ ëœë‹¤. ì¸ë±ìŠ¤ëŠ” ì´ë¯¸ ì •ë ¬ë˜ì–´ ìˆê¸° ë•Œë¬¸ì—, GROUP BY, ORDER BYë¥¼ ì¸ë±ìŠ¤ ê¸°ì¤€ìœ¼ë¡œ í•˜ë©´ ìœ„í•´ ì„ì‹œ í…Œì´ë¸”ì„ ë§Œë“¤ í•„ìš”ê°€ ì—†ë‹¤. og í…Œì´ë¸”ì˜ ì¸ë±ìŠ¤ëŠ” (ì»¬ëŸ¼1,ì»¬ëŸ¼2)ë¡œ êµ¬ì„±ë˜ì—ˆê¸° ë•Œë¬¸ì—, GROUP BY, ORDER BYì— ëª…ì‹œëœ ì»¬ëŸ¼ ìˆœì„œë¥¼ ì¸ë±ìŠ¤ê°€ êµ¬ì„±ëœ ìˆœì„œë¡œ ë³€ê²½í–ˆë‹¤. ë³€ê²½ëœ ì¿¼ë¦¬ SELECT (SELECT GROUP_CONCAT(tmp.cnt) FROM (SELECT og.ì»¬ëŸ¼1, count(gu.ì»¬ëŸ¼2) cnt FROM tbl5 og LEFT OUTER JOIN (SELECT ì»¬ëŸ¼1, ì»¬ëŸ¼2 FROM tbl6 WHERE ì»¬ëŸ¼3 IS NOT NULL) gu ON og.ì»¬ëŸ¼1 = gu.ì»¬ëŸ¼1 and og.ì»¬ëŸ¼2 = gu.ì»¬ëŸ¼2 GROUP BY og.ì»¬ëŸ¼1, og.ì»¬ëŸ¼2 ORDER BY og.ì»¬ëŸ¼1, og.ì»¬ëŸ¼2) tmp WHERE tmp.ì»¬ëŸ¼1 = tbl1.ì»¬ëŸ¼1) as regi_qty, ... FROM tbl1 LEFT OUTER JOIN tbl2 ON tbl1.ì»¬ëŸ¼1 = tbl2.ì»¬ëŸ¼1 LEFT OUTER JOIN tbl3 ON tbl1.ì»¬ëŸ¼1 = tbl3.ì»¬ëŸ¼1 LEFT OUTER JOIN tbl4 ON tbl1.ì»¬ëŸ¼4 = tbl4.ì»¬ëŸ¼4 WHERE 1=1 AND tbl1.ë“±ë¡ì¼ &gt;= '2021-09-20' AND tbl1.ë“±ë¡ì¼ &lt; ADDDATE('2022-03-20',1) AND tbl1.ì£¼ë¬¸íƒ€ì… IN ( 'ê°’1' , 'ê°’2' ); Using temporary, Using filesortê°€ ì—†ì–´ì§„ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.íŠœë‹2 ë“œë¼ì´ë¹™ í…Œì´ë¸”(og)ì—ì„œ ì¸ë±ìŠ¤ í’€ìŠ¤ìº”ì„ í•˜ì§€ ì•Šë„ë¡ ë³€ê²½í–ˆë‹¤. (ìˆ˜í–‰ ì‹œê°„ : ì•½ 0.4ì´ˆ) ë“œë¼ì´ë¹™ í…Œì´ë¸”, ë“œë¦¬ë¸ í…Œì´ë¸” ì¤‘ í•˜ë‚˜ë¼ë„ ì¸ë±ìŠ¤ í’€ìŠ¤ìº”ì„ í•˜ê²Œë˜ë©´ ê²°ê³¼ì ìœ¼ë¡œ ì¡°ì¸ íšŸìˆ˜ê°€ ë§ì•„ì§€ê¸° ë•Œë¬¸ì—, í’€ìŠ¤ìº” í•˜ì§€ ì•ŠëŠ” ë°©ë²•ì„ ì°¾ì•„ë³´ì•˜ë‹¤. og, gu í…Œì´ë¸”ë¡œ ì¸í•´ ìƒì„±ë˜ëŠ” ì„ì‹œ í…Œì´ë¸” tmpì€ í•„í„° ì¡°ê±´(ë“±ë¡ì¼, ì£¼ë¬¸íƒ€ì…)ìœ¼ë¡œ ë§ì€ ë ˆì½”ë“œê°€ ê±¸ëŸ¬ì§„ tbl1ì˜ ì»¬ëŸ¼1ì´ í•„í„°ì¡°ê±´ì´ ëœë‹¤. ì¦‰, tmp í…Œì´ë¸”ì€ tbl1ì„ ì»¬ëŸ¼1ì„ ê¸°ì¤€ìœ¼ë¡œ ë§ì€ ë¶€ë¶„ì´ ê±¸ëŸ¬ì§€ê²Œëœë‹¤. ë”°ë¼ì„œ, og í…Œì´ë¸”ì—ì„œ ì• ì´ˆì— ëª¨ë“  ë ˆì½”ë“œë¥¼ ê°€ì ¸ì˜¬ í•„ìš” ì—†ì´ tbl1ì˜ í•„í„° ì¡°ê±´ì„ í™œìš©í•  ìˆ˜ ì—†ì„ì§€ ìƒê°í•´ë³´ì•˜ë‹¤. og í…Œì´ë¸” ì¸ë±ìŠ¤ëŠ” (ì»¬ëŸ¼1,ì»¬ëŸ¼2)ì¸ë° ì»¬ëŸ¼1ì˜ ê²½ìš°, ë…„ì›”ì¼+aì˜ ê·œì¹™ì„ ê°–ê³  ìƒì„±ë˜ê¸° ë•Œë¬¸ì—, ë“±ë¡ì¼ ë¶€ë¶„ì„ í™œìš©í•˜ë©´ ë  ê²ƒìœ¼ë¡œ ìƒê°í–ˆë‹¤. ë³€ê²½ëœ ì¿¼ë¦¬ SELECT (SELECT GROUP_CONCAT(tmp.cnt) FROM (SELECT og.ì»¬ëŸ¼1, count(gu.ì»¬ëŸ¼2) cnt FROM (SELECT ì»¬ëŸ¼1, ì»¬ëŸ¼2 FROM tbl5 WHERE ì»¬ëŸ¼1 BETWEEN '20210920' AND '20220321') og LEFT OUTER JOIN (SELECT ì»¬ëŸ¼1, ì»¬ëŸ¼2 FROM tbl6 WHERE ì»¬ëŸ¼3 IS NOT NULL) gu ON og.ì»¬ëŸ¼1 = gu.ì»¬ëŸ¼1 and og.ì»¬ëŸ¼2 = gu.ì»¬ëŸ¼2 GROUP BY og.ì»¬ëŸ¼1, og.ì»¬ëŸ¼2 ORDER BY og.ì»¬ëŸ¼1, og.ì»¬ëŸ¼2) tmp WHERE tmp.ì»¬ëŸ¼1 = tbl1.ì»¬ëŸ¼1) as regi_qty, ... FROM tbl1 LEFT OUTER JOIN tbl2 ON tbl1.ì»¬ëŸ¼1 = tbl2.ì»¬ëŸ¼1 LEFT OUTER JOIN tbl3 ON tbl1.ì»¬ëŸ¼1 = tbl3.ì»¬ëŸ¼1 LEFT OUTER JOIN tbl4 ON tbl1.ì»¬ëŸ¼4 = tbl4.ì»¬ëŸ¼4 WHERE 1=1 AND tbl1.ë“±ë¡ì¼ &gt;= '2021-09-20' AND tbl1.ë“±ë¡ì¼ &lt; ADDDATE('2022-03-20',1) AND tbl1.ì£¼ë¬¸íƒ€ì… IN ( 'ê°’1' , 'ê°’2' ); ì¸ë±ìŠ¤ ë ˆì¸ì§€ ìŠ¤ìº”ìœ¼ë¡œ ë³€ê²½ë¨ê³¼ ë™ì‹œì—, (ì •í™•í•œ ìˆ˜ì¹˜ëŠ” ì•„ë‹ˆì§€ë§Œ) ì ‘ê·¼í•˜ëŠ” ë ˆì½”ë“œê°€ í™•ì—°íˆ ì¤„ì–´ë“  ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤." }, { "title": "Apache Http Server 2.2.x -> 2.4.x ë²„ì „ ì—…ê·¸ë ˆì´ë“œ í•˜ë©´ì„œ ê²ªì—ˆë˜ ì´ìŠˆ", "url": "/posts/apache-2.2-to-2.4-issue/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "Apache", "date": "2022-02-18 00:25:00 +0900", "snippet": "ìƒí™©ìµœê·¼ ê°œë°œ ì„œë²„ ì´ê´€ ì‘ì—…ì„ ì§„í–‰í•˜ë©´ì„œ ìƒˆë¡œìš´ ì„œë²„ì—ëŠ” ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ ì•„íŒŒì¹˜ 2.2.27 ëŒ€ì‹  2.4.33 ë²„ì „ì„ ì„¤ì¹˜í•´ì„œ ì‘ì—…ì„ ì§„í–‰í–ˆë‹¤.ê·¸ë¦¬ê³  ê¸°ì¡´ ì„œë²„ì˜ httpd.conf íŒŒì¼ê³¼ ê°€ìƒ í˜¸ìŠ¤íŠ¸ íŒŒì¼ë“¤(í•œ ëŒ€ì˜ ì„œë²„ì—ì„œ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ ì œê³µ)ì„ ì˜®ê²¨ì™€ì„œ ì„¸íŒ…í•œ ë’¤, ìƒˆë¡œìš´ ì„œë²„ì˜ ì•„íŒŒì¹˜ë¥¼ ì‹¤í–‰(apachectl start)í•˜ë ¤ê³  í•˜ëŠ”ë°, ì—ëŸ¬ê°€ ...", "content": "ìƒí™©ìµœê·¼ ê°œë°œ ì„œë²„ ì´ê´€ ì‘ì—…ì„ ì§„í–‰í•˜ë©´ì„œ ìƒˆë¡œìš´ ì„œë²„ì—ëŠ” ê¸°ì¡´ì— ì‚¬ìš©í•˜ë˜ ì•„íŒŒì¹˜ 2.2.27 ëŒ€ì‹  2.4.33 ë²„ì „ì„ ì„¤ì¹˜í•´ì„œ ì‘ì—…ì„ ì§„í–‰í–ˆë‹¤.ê·¸ë¦¬ê³  ê¸°ì¡´ ì„œë²„ì˜ httpd.conf íŒŒì¼ê³¼ ê°€ìƒ í˜¸ìŠ¤íŠ¸ íŒŒì¼ë“¤(í•œ ëŒ€ì˜ ì„œë²„ì—ì„œ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ ì œê³µ)ì„ ì˜®ê²¨ì™€ì„œ ì„¸íŒ…í•œ ë’¤, ìƒˆë¡œìš´ ì„œë²„ì˜ ì•„íŒŒì¹˜ë¥¼ ì‹¤í–‰(apachectl start)í•˜ë ¤ê³  í•˜ëŠ”ë°, ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤.ê·¸ë¦¬ê³  ê·¸ ì—ëŸ¬ë¥¼ ê³ ì¹˜ë©´ ë˜ ë‹¤ë¥¸ ì—ëŸ¬ë“¤ì„ ë§Œë‚¬ë‹¤.ì›ì¸ê³¼ í•´ê²°ë°©ë²• ì•„íŒŒì¹˜ 2.2 -&gt; 2.4 ë²„ì „ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ ì‹œ ìœ ì˜í•´ì•¼í•˜ëŠ” ë¶€ë¶„ë“¤ì´ ìˆì—ˆëŠ”ë° ê·¸ ë¶€ë¶„ì„ ì•Œì§€ ëª»í–ˆë‹¤. ì•„ë˜ ì—ëŸ¬ë“¤ ì¤‘ì—” ì‹¤í–‰í•˜ê¸° ì „ì—(apachectl configtestë¡œ ë¬¸ë²• ê²€ì‚¬) ë˜ëŠ” ì‹¤í–‰í•˜ë©´ì„œ ì•Œ ìˆ˜ ìˆëŠ” ê²ƒë“¤ë„ ìˆê³ , ${APACHE_HOME}/logs/error.logë¥¼ ì‚´í´ë´ì•¼í•˜ëŠ” ê²ƒë“¤ë„ ìˆë‹¤.ë˜í•œ, 2.4 ë²„ì „ì„ ì„¤ì¹˜í•  ë•Œ ì„¸íŒ…ë˜ëŠ” httpd.conf íŒŒì¼ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë©´ ê²ªì§€ ì•Šì„ ì—ëŸ¬ë“¤ë„ ìˆë‹¤.Cannot load modules/mod_authz_default.so ì›ì¸ 2.4 ë²„ì „ì—ì„œ í•´ë‹¹ ëª¨ë“ˆì€ ì‚­ì œëë‹¤. 2.4 ë²„ì „ì—ì„œ ì œê±°ëœ ëª¨ë“ˆ : mod_authn_default, mod_authz_default, mod_mem_cache ì¡°ì¹˜ LoadModule authz_default_module modules/mod_authz_default.so ë¶€ë¶„ ì œê±° ë˜ëŠ” LoadModule authz_core_module modules/mod_authz_core.soë¡œ ëŒ€ì²´ SSLSessionCache: â€˜dbmâ€™ session cache not supported ì›ì¸ dbm íƒ€ì…ì„ ì‚¬ìš©í•˜ë ¤ë©´ mod_socache_dbm ëª¨ë“ˆì´ ë¡œë“œë˜ì–´ì•¼ í•œë‹¤. ì¡°ì¹˜ #LoadModule socache_dbm_module modules/mod_socache_dbm.so ë¶€ë¶„ ì£¼ì„ í•´ì œ Either all Options must start with + or -, or no Option may. ì›ì¸ Options ì†ì„±ì— +, -ë¥¼ ì•„ì˜ˆ ì‚¬ìš©í•˜ì§€ ì•Šê±°ë‚˜ ëª¨ë‘ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì˜ëª»ëœ ì˜ˆì‹œ : Options -Indexes FollowSymLinks MultiViews (Indexesì—ë§Œ -ê°€ ë¶™ìŒ) ì¡°ì¹˜ &lt;Directory&gt;ì„¹ì…˜ ë‚´ì— ìˆëŠ”Options -Indexes FollowSymLinks MultiViews -&gt; Options FollowSymLinks MultiViews ì£¼ì˜í•´ì•¼ í•  ê²ƒì€ -, +ì„ ë¶™ì´ë©´ ì´ì „ì— ì§€ì •ë˜ì–´ìˆëŠ” Optionsì´ ì˜í–¥ì„ ì¤€ë‹¤ëŠ” ê²ƒì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì•„ë˜ì™€ ê°™ì€ ê²½ìš° /web/docs/spec ë””ë ‰í† ë¦¬ì—ëŠ” ìœ„ì—ì„œ ì„¸íŒ…ëœ FollowSymLinksì— Includes ì†ì„±ê¹Œì§€ ì¶”ê°€ê°€ ëœë‹¤.IndexesëŠ” -ê°€ ë¶™ì–´ìˆìœ¼ë¯€ë¡œ ë¹ ì§€ê²Œëœë‹¤. &lt;Directory \"/web/docs\"&gt; Options Indexes FollowSymLinks&lt;/Directory&gt;&lt;Directory \"/web/docs/spec\"&gt; Options +Includes -Indexes&lt;/Directory&gt; Invalid command â€˜SSLMutexâ€™, perhaps misspelled or defined by a module not included in the server configuration ì›ì¸ AcceptMutex, LockFile, RewriteLock, SSLMutex, SSLStaplingMutex, WatchdogMutexPath ì§€ì‹œì–´ê°€ Mutexë¡œ ëŒ€ì²´ë˜ì—ˆë‹¤. ì¡°ì¹˜ SSLMutex -&gt; Mutexë¡œ ë³€ê²½ AH02432: Cannot find LB Method: byrequests ì›ì¸ 2.3 ì´í•˜ ë²„ì „ì—ì„œëŠ” mod_proxy_balancer ëª¨ë“ˆì´ë©´ ì¶©ë¶„í–ˆì§€ë§Œ, 2.4 ë²„ì „ë¶€í„°ëŠ” mod_proxy_balancerì—ì„œ mod_lbmethod_byrequestsê°€ ë”°ë¡œ ë¶„ë¦¬ë˜ì—ˆë‹¤. ì¡°ì¹˜ #LoadModule lbmethod_byrequests_module modules/mod_lbmethod_byrequests.so ë¶€ë¶„ ì£¼ì„ í•´ì œ ê¸°íƒ€ 2.4 ë²„ì „ ì—…ê·¸ë ˆì´ë“œ ê´€ë ¨ ê³µì‹ ë¬¸ì„œì— ë³´ë©´ ë” ë§ì€ ì‚¬í•­ë“¤ì´ ìì„¸íˆ ë‚˜ì™€ìˆìœ¼ë‹ˆ ì°¸ê³ í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.ì°¸ê³  ìë£Œ https://publib.boulder.ibm.com/httpserv/manual24/upgrading.html https://httpd.apache.org/docs/2.4/upgrading.html https://httpd.apache.org/docs/2.4/en/mod/mod_ssl.html#sslsessioncache https://httpd.apache.org/docs/2.4/mod/mod_lbmethod_byrequests.html)" }, { "title": "Infra - Tomcat & Apache HTTP Server ì—°ë™", "url": "/posts/tomcat-and-apache-connection-part1/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "ì¸í”„ë¼", "date": "2022-02-10 13:25:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „Tomcatê³¼ Apache HTTP Server ì—°ë™ê³¼ ê´€ë ¨ëœ ê¸°ì´ˆ ì§€ì‹ì„ ì‚´í´ë³´ê³ , ë‹¤ìŒ íŒŒíŠ¸ì—ì„œëŠ” ì‹¤ì œë¡œ ì—°ë™í•˜ëŠ” ì‘ì—…ì„ ì§„í–‰í•´ë³´ë ¤ê³  í•œë‹¤.Apache Tomcat Connectors Apache Tomcat Connectors í”„ë¡œì íŠ¸ëŠ” Tomcat í”„ë¡œì íŠ¸ì˜ ì¼ë¶€ì´ë©°, ì›¹ ì„œë²„ë¥¼ Tomcat ë° ê¸°íƒ€ ë°±ì—”ë“œì™€ ì—°ê²°í•˜ê¸° ìœ„í•œ ì›¹ ì„œë²„...", "content": "ë“¤ì–´ê°€ê¸° ì „Tomcatê³¼ Apache HTTP Server ì—°ë™ê³¼ ê´€ë ¨ëœ ê¸°ì´ˆ ì§€ì‹ì„ ì‚´í´ë³´ê³ , ë‹¤ìŒ íŒŒíŠ¸ì—ì„œëŠ” ì‹¤ì œë¡œ ì—°ë™í•˜ëŠ” ì‘ì—…ì„ ì§„í–‰í•´ë³´ë ¤ê³  í•œë‹¤.Apache Tomcat Connectors Apache Tomcat Connectors í”„ë¡œì íŠ¸ëŠ” Tomcat í”„ë¡œì íŠ¸ì˜ ì¼ë¶€ì´ë©°, ì›¹ ì„œë²„ë¥¼ Tomcat ë° ê¸°íƒ€ ë°±ì—”ë“œì™€ ì—°ê²°í•˜ê¸° ìœ„í•œ ì›¹ ì„œë²„ í”ŒëŸ¬ê·¸ì¸ì„ ì œê³µí•œë‹¤. ì§€ì›ë˜ëŠ” ì›¹ ì„œë²„ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ì›¹ ì„œë²„ í”ŒëŸ¬ê·¸ì¸ Apache HTTP Server mod_jk Microsoft IIS ISAPI redirector iPlanet Web Server NSAPI redirector í”ŒëŸ¬ê·¸ì¸ ëŒ€ë¶€ë¶„ì˜ ê¸°ëŠ¥ì€ ëª¨ë“  ì›¹ ì„œë²„ì—ì„œ ë™ì¼í•˜ë©°, ì„¸ë¶€ ì‚¬í•­ì€ ì›¹ ì„œë²„ë³„ë¡œ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤. ëª¨ë“  ê²½ìš°ì— í”ŒëŸ¬ê·¸ì¸ì€ Apache JServ Protocol(AJP) ë¼ëŠ” íŠ¹ìˆ˜ í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ë°±ì—”ë“œì— ì—°ê²°í•œë‹¤. AJPë¥¼ ì§€ì›í•˜ëŠ” ê²ƒìœ¼ë¡œ ì•Œë ¤ì§„ ë°±ì—”ë“œëŠ” Apache Tomcat, Jetty, JBoss ë“±ì´ ìˆë‹¤. í”„ë¡œí† ì½œì—ëŠ” ajp12, ajp13, ajp14ì˜ 3ê°€ì§€ ë²„ì „ì´ ìˆì§€ë§Œ, ì•„ì§ê¹Œì§€ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ajp13ë§Œ ì‚¬ìš©í•œë‹¤. AJP 1.3 ë˜ëŠ” AJPv13ì´ë¼ê³  ë¶€ë¥´ì§€ë§Œ ì£¼ë¡œ ajp13ë¼ëŠ” ì´ë¦„ì„ ì‚¬ìš©í•œë‹¤. í†°ìº£ì€ 3.2 ë²„ì „ ì´í›„ë¡œ ajp13ì„ ì§€ì›í•œë‹¤. Apache HTTP Server - Tomcat ì—°ë™ ìœ„ì—ì„œ ì‚´í´ë´¤ë“¯ì´ mod_jkë¥¼ ì‚¬ìš©í•˜ì—¬ ì—°ë™í•œë‹¤. (ìµœì†Œ ë²„ì „ : Apache 1.3, Tomcat 3.2) ì¶œì²˜ : https://www.akadia.com/download/soug/tomcat/html/tomcat_apache.html ì›¹ ì„œë²„(Apache HTTP Server)ëŠ” í´ë¼ì´ì–¸íŠ¸ HTTP ìš”ì²­ì„ ê¸°ë‹¤ë¦¬ê³  ìˆëŠ”ë‹¤. ìš”ì²­ì´ ë„ì°©í•˜ë©´ ì„œë²„ëŠ” í•„ìš”í•œ ì½˜í…ì¸ ë¥¼ ì œê³µí•˜ì—¬ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ë° í•„ìš”í•œ ëª¨ë“  ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤. ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆ(ìœ„ì˜ ê²½ìš° Tomcat)ë¥¼ ì¶”ê°€í•˜ë©´ ì›¹ ì„œë²„ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•œë‹¤. ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ì „ì—, ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆ ì–´ëŒ‘í„° ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¡œë“œí•˜ê³  ì´ˆê¸°í™”í•œë‹¤. ìš”ì²­ì´ ì˜¤ë©´, íŠ¹ì • ìš”ì²­ì´ ì„œë¸”ë¦¿ì— ì†í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•˜ë©°, ì„œë¸”ë¦¿ì— ì†í•˜ëŠ” ê²½ìš° ì–´ëŒ‘í„°ê°€ ìš”ì²­ì„ ë°›ì•„ ì²˜ë¦¬í•˜ë„ë¡ í•œë‹¤. ì–´ëŒ‘í„°ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ìš”ì²­ URLì˜ ì¼ë¶€ íŒ¨í„´ê³¼ ìš”ì²­ì„ ë³´ë‚¼ ìœ„ì¹˜ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì–´ë–¤ ìš”ì²­ì„ ì²˜ë¦¬í• ì§€ ì•Œì•„ì•¼í•œë‹¤. mod_jk ê´€ë ¨ ì‚¬í•­ mod_jkëŠ” ë‘ ê°œì˜ ì—”í‹°í‹°ê°€ í•„ìš”í•˜ë‹¤. mod_jk.xxx Apache HTTP Server ëª¨ë“ˆ ìš´ì˜ ì²´ì œì— ë”°ë¼ mod_jk.so, mod_jk.nlm ë˜ëŠ” MOD_JK.SRVPGM ë¨¼ì € Apache HTTP Serverì˜ ëª¨ë“ˆ ë””ë ‰í† ë¦¬(ì˜ˆ:/usr/lib/apache)ì— ì„¤ì¹˜ë˜ì–´ì•¼ í•˜ë©° httpd.conf íŒŒì¼ì—ì„œ ë¡œë“œë˜ì–´ì•¼ í•œë‹¤. ex : LoadModule jk_module modules/mod_jk.so workers.properties Tomcat í”„ë¡œì„¸ìŠ¤ê°€ ì‚¬ìš©í•˜ëŠ” í˜¸ìŠ¤íŠ¸, í¬íŠ¸ ë“±ì„ ì •ì˜í•˜ëŠ” íŒŒì¼ì´ë‹¤. (ì•„ë˜ Worker íŒŒíŠ¸ ì°¸ì¡°) workers.propertiesíŒŒì¼ì€ ${APACHE_HOME}/conf ë””ë ‰í† ë¦¬ì— ìˆë‹¤. httpd.confì—ì„œ í•´ë‹¹ íŒŒì¼ì˜ ê²½ë¡œë¥¼ ì •ì˜í•´ì•¼ í•œë‹¤. ex : JkWorkersFile /etc/httpd/conf/workers.properties ì•„íŒŒì¹˜ httpd.conf mod_jk ê´€ë ¨ ë¶€ë¶„ ì˜ˆì‹œ# Load mod_jk moduleLoadModule jk_module modules/mod_jk.so# Where to find workers.propertiesJkWorkersFile /etc/httpd/conf/workers.properties# Where to put jk shared memoryJkShmFile /var/log/httpd/mod_jk.shm# Where to put jk logsJkLogFile /var/log/httpd/mod_jk.log# Set the jk log level [debug/error/info]JkLogLevel info# Send requests for context /examples to worker named worker1JkMount /examples/* worker1ì—°ë™ì‹œ ì£¼ì˜ì‚¬í•­ Apacheì™€ Tomcatì´ ë™ì¼í•œ íŒŒì¼ ì‹œìŠ¤í…œ ìœ„ì¹˜ì—ì„œ ì½˜í…ì¸ ë¥¼ ì œê³µí•˜ë„ë¡ êµ¬ì„±ëœ ê²½ìš°, Apacheê°€ WEB-INF ë””ë ‰í† ë¦¬ ë˜ëŠ” JSP ì†ŒìŠ¤ ì½”ë“œì™€ ê°™ì€ ì½˜í…ì¸ (ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆê°€ ì²˜ë¦¬í•´ì•¼í•˜ëŠ” ì½˜í…ì¸ )ë¥¼ ì œê³µí•˜ì§€ ì•Šë„ë¡ í•´ì•¼í•œë‹¤. Apache DocumentRootê°€ Tomcat Hostì˜ appBase ë˜ëŠ” Contextì˜ docBaseì™€ ê²¹ì¹˜ë©´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. Apache Alias ì§€ì‹œë¬¸ì„ Tomcat Hostì˜ appBase ë˜ëŠ” Contextì˜ docBaseì™€ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. WorkerTomcat Worker Tomcat WorkerëŠ” ì¼ë¶€ ì›¹ ì„œë²„ë¥¼ ëŒ€ì‹ í•˜ì—¬ ì„œë¸”ë¦¿ ë˜ëŠ” ê¸°íƒ€ ì½˜í…ì¸ ë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ëŒ€ê¸° ì¤‘ì¸ Tomcat ì¸ìŠ¤í„´ìŠ¤ì´ë‹¤. â€» ì°¸ê³  : ê³µì‹ ë¬¸ì„œë¥¼ ë³´ë©´ Tomcat Workerë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•œë‹¤. â€œA Tomcat worker is a Tomcat instance that is waiting to execute servlets on behalf of some web server. For example, we can have a web server such as the Apache HTTP Server forwarding servlet requests to a Tomcat process (the worker) running behind it.â€ ëŒ€í‘œì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°, ì—¬ëŸ¬ ê°œì˜ workerë¥¼ êµ¬ì„±í•  ìˆ˜ë„ ìˆë‹¤. ëª¨ë“  ê°œë°œìê°€ ë™ì¼í•œ ì›¹ ì„œë²„ë¥¼ ê³µìœ í•˜ì§€ë§Œ, ìì‹ ì˜ workerë¥¼ ì†Œìœ í•˜ëŠ” ê°œë°œ í™˜ê²½ì´ í•„ìš”í•œ ê²½ìš°. í•˜ë‚˜ì˜ ì›¹ ì„œë²„ì—ì„œ ì—¬ëŸ¬ ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´, í†°ìº£ í”„ë¡œì„¸ìŠ¤ë³„ ê°€ìƒ í˜¸ìŠ¤íŠ¸ê°€ í•„ìš”í•œ ê²½ìš°. ë¡œë“œ ë°¸ëŸ°ì‹±ì„ ì œê³µí•˜ê³ ì í•˜ëŠ” ê²½ìš°. ì¦‰, ìì²´ ë¨¸ì‹ ì—ì„œ ì—¬ëŸ¬ workerë¥¼ ì‹¤í–‰í•˜ê³  ìš”ì²­ì„ ë¶„ë°°í•´ì•¼ í•œë‹¤. Worker ì •ì˜í•˜ê¸° workers.propertiesë¼ëŠ” ì†ì„± íŒŒì¼ì— ì •ì˜ëœë‹¤. (ê²½ë¡œ : ${APACHE_HOME}/conf) worker.listë¡œ workerë¥¼ ì •ì˜í•œë‹¤. # worker ë¦¬ìŠ¤íŠ¸worker.list= worker1, worker2 ì›¹ ì„œë²„ë¥¼ ì‹œì‘í•  ë•Œ, ì›¹ ì„œë²„ í”ŒëŸ¬ê·¸ì¸(ì˜ˆ : mod_jk)ì€ worker.list ì†ì„±ì— ë‚˜ì—´ëœ workerë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•œë‹¤. ì¸ìŠ¤í„´ìŠ¤í™”ëœ workerëŠ” ìì‹ ì—ê²Œ ë§µí•‘ëœ íŠ¹ì • ìš”ì²­ì„ ì „ë‹¬ë°›ì„ ìˆ˜ ìˆë‹¤. worker.listëŠ” ì—¬ëŸ¬ ë²ˆ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.Worker Type í˜„ì¬ ì¡´ì¬í•˜ëŠ” Worker Type ë‹¤ìŒê³¼ ê°™ë‹¤. (JK 1.2.5): Type ì •ì˜ ajp13 ì´ íƒ€ì…ì˜ workerëŠ” ajp13 í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ Tomcat workerì—ê²Œ ìš”ì²­ì„ ì „ë‹¬í•œë‹¤. lb ë¡œë“œ ë°¸ëŸ°ì‹± workerë¡œì¨, íŠ¹ì • ìˆ˜ì¤€ì˜ ë‚´ê²°í•¨ì„±ê³¼ í•¨ê»˜ ìœ ì—°í•œ ë¡œë“œ ë°¸ëŸ°ì‹±ì„ ì œê³µí•œë‹¤. status ë¡œë“œë°¸ëŸ°ì„œë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ status workerì´ë‹¤. ajp12 ì´ íƒ€ì…ì˜ workerëŠ” ajp12 í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ Tomcat workerì—ê²Œ ìš”ì²­ì„ ì „ë‹¬í•œë‹¤. ajp14 ì´ íƒ€ì…ì˜ workerëŠ” ajp14 í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ Tomcat workerì—ê²Œ ìš”ì²­ì„ ì „ë‹¬í•œë‹¤. Worker Typeë³„ ì†ì„± ì‚´í´ë³´ê¸° workers.propertiesíŒŒì¼ì— ì„¸íŒ…ë˜ëŠ” ì†ì„±ê³¼ ê´€ë ¨í•´ì„œ ìì„¸í•œ ë‚´ìš©ì€ ê³µì‹ ë¬¸ì„œ ì°¸ì¡°ajp13 Worker ì‚´í´ë³´ê¸° TCP/IP ì†Œì¼“ì„ í†µí•´ ajp13 í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ Tomcat Workerì—ê²Œ ìš”ì²­ì„ ì „ë‹¬í•œë‹¤.# \"worker2\"ëŠ” 3lb íŒ©í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ www2.x.comê°€ ì˜¬ë¼ê°„ ì„œë²„ì˜ í¬íŠ¸ 8009ì—ì„œ ìˆ˜ì‹  ëŒ€ê¸° ì¤‘ì¸ Tomcatê³¼ í†µì‹ í•œë‹¤.worker.worker2.type=ajp13worker.worker2.host=www2.x.comworker.worker2.port=8009worker.worker2.lbfactor=3lb Worker ì‚´í´ë³´ê¸° ë¡œë“œ ë°¸ëŸ°ì‹± workerëŠ” ì‹¤ì œë¡œ Tomcat workerì™€ í†µì‹ í•˜ì§€ ì•Šê³ , ì›¹ ì„œë²„ í”ŒëŸ¬ê·¸ì¸ worker ê´€ë¦¬ë¥¼ ë‹´ë‹¹í•œë‹¤. ê´€ë¦¬í•˜ëŠ” ë¶€ë¶„ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. ì›¹ ì„œë²„ í”ŒëŸ¬ê·¸ì¸ workerë¥¼ ì¸ìŠ¤í„´ìŠ¤í™” ê´€ë¦¬ë˜ëŠ” workerì˜ ë¡œë“œ ë°¸ëŸ°ì‹± factor(lbfactor)ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°€ì¤‘ì¹˜ ë¼ìš´ë“œ ë¡œë¹ˆ(weighted round-robin) ë¡œë“œ ë°¸ëŸ°ì‹±ì„ ìˆ˜í–‰ ê°€ì¤‘ì¹˜ ë¼ìš´ë“œ ë¡œë¹ˆì—ì„œëŠ” lbfactorê°€ ë†’ì„ìˆ˜ë¡ ë” ê°•ë ¥í•œ ì‹œìŠ¤í…œ(ë” ë§ì€ ìš”ì²­ì„ ì²˜ë¦¬í•¨)ì„ ì˜ë¯¸ ë™ì¼í•œ Tomcat workerì—ì„œ ì‹¤í–‰ë˜ëŠ” ë™ì¼í•œ ì„¸ì…˜ì— ì†í•˜ëŠ” ìš”ì²­ ìœ ì§€(ì„¸ì…˜ ê³ ì •) ì‹¤íŒ¨í•œ Tomcat workerë¥¼ ì‹ë³„í•˜ì—¬ ìš”ì²­ì„ ì¼ì‹œ ì¤‘ì§€í•˜ê³ , lb workerê°€ ê´€ë¦¬í•˜ëŠ” ë‹¤ë¥¸ workerë¡œ fail-over ê²°ê³¼ì ìœ¼ë¡œ, lb workerê°€ ê´€ë¦¬í•˜ëŠ” workerë“¤ì€ ë¡œë“œ ë°¸ëŸ°ì‹±ë˜ê³ (lbfactor ë° í˜„ì¬ ì‚¬ìš©ì ì„¸ì…˜ì„ ê¸°ë°˜ìœ¼ë¡œ) ì¥ì•  ì¡°ì¹˜ê°€ ì´ë£¨ì–´ì§€ë¯€ë¡œ ë‹¨ì¼ Tomcat í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œë¡œ ì¸í•´ ì „ì²´ ì‚¬ì´íŠ¸ê°€ ë§ˆë¹„ë˜ì§€ ì•ŠëŠ”ë‹¤. ë‹¤ìŒì€ lb workerê°€ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ì†ì„±ì´ë‹¤. balance_workers ë¡œë“œ ë°¸ëŸ°ì„œê°€ ê´€ë¦¬í•´ì•¼ í•˜ëŠ” worker ëª©ë¡ì´ë‹¤. # The worker balance1 while use \"real\" workers worker1 and worker2worker.balance1.balance_workers=worker1, worker2 sticky_session SESSION IDê°€ ìˆëŠ” ìš”ì²­ì„ ë™ì¼í•œ Tomcat workerë¡œ ë‹¤ì‹œ ë¼ìš°íŒ…í•´ì•¼ í•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ì§€ì •í•œë‹¤. Tomcatì´ ì—¬ëŸ¬ Tomcat ì¸ìŠ¤í„´ìŠ¤ì—ì„œ ì„¸ì…˜ ë°ì´í„°ë¥¼ ìœ ì§€í•  ìˆ˜ ìˆëŠ” ì„¸ì…˜ ê´€ë¦¬ìë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš° sticky_sessionì„ falseë¡œ ì„¤ì •í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ trueë¡œ ì„¤ì •ëœë‹¤. ì •ë¦¬ ì•„íŒŒì¹˜ì™€ í†°ìº£ì´ ì—°ë™ë˜ë ¤ë©´ mod_jk ëª¨ë“ˆì´ í•„ìš”í•˜ë‹¤. (ìš´ì˜ì²´ì œ ë³„ë¡œ ì´ë¦„ì€ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤.) í•´ë‹¹ ëª¨ë“ˆì€ Apache JServ Protocol(AJP) í”„ë¡œí† ì½œì„ ì‚¬ìš©í•˜ì—¬ ì•„íŒŒì¹˜ì™€ í†°ìº£ê°„ í†µì‹ í•œë‹¤. mod_jk ëª¨ë“ˆì„ ì‚¬ìš©í•˜ë ¤ë©´ ? ë¨¼ì € ì•„íŒŒì¹˜ ëª¨ë“ˆ ë””ë ‰í† ë¦¬(ì˜ˆ:/usr/lib/apache)ì— ì„¤ì¹˜ë˜ì–´ì•¼ ìˆì–´ì•¼í•œë‹¤. ì•„íŒŒì¹˜ httpd.confì— ëª¨ë“ˆì´ ë¡œë“œë˜ì–´ì•¼í•˜ê³ , JKMount ë“± ê´€ë ¨ ì˜µì…˜ë“¤ì´ ì •ì˜ë˜ì–´ì•¼ í•œë‹¤. workers.properties íŒŒì¼ì´ ì‘ì„±ë˜ì–´ì•¼í•œë‹¤. workers.propertiesëŠ” ì„œë¸”ë¦¿ ì»¨í…ì¸  ìš”ì²­ ì „ë‹¬, ë¡œë“œ ë°¸ëŸ°ì‹± ë“±ì„ ìœ„í•œ Tomcat workerì™€ ìš”ì²­ì„ ì „ë‹¬ë°›ì„ í†°ìº£ í”„ë¡œì„¸ìŠ¤ì˜ í˜¸ìŠ¤íŠ¸ ë° í¬íŠ¸ ë“±ì„ ì •ì˜í•œ íŒŒì¼ì´ë‹¤. ì°¸ê³  ìë£Œ https://tomcat.apache.org/connectors-doc/ https://tomcat.apache.org/connectors-doc/webserver_howto/apache.html https://tomcat.apache.org/connectors-doc/common_howto/workers.html" }, { "title": "Infra - Apache httpd.conf íŒŒì¼ ì†ì„± ê³µë¶€í•˜ê¸°(1)", "url": "/posts/apache-httpd-conf-part1/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "ì¸í”„ë¼", "date": "2022-01-15 13:25:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „íšŒì‚¬ì—ì„œ ì„œë²„ ì´ê´€ì„ ì¤€ë¹„í•˜ê³  ìˆë‹¤. ê¸°ì¡´ì— ê°ê°ì˜ ì„œë²„ì— í©ì–´ì ¸ ìˆë˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í•œ ì„œë²„ë¡œ ëª¨ìœ¼ëŠ” ë“±ì˜ ì‘ì—…ì„ í•´ì•¼í•˜ëŠ”ë°, ê·¸ëŸ´ë ¤ë©´ ê¸°ì¡´ì— ì„¸íŒ…ëœ ì•„íŒŒì¹˜ ì„¤ì • íŒŒì¼ì„ ì œëŒ€ë¡œ ì´í•´í•˜ê³  ë” ë‚˜ì•„ê°€ ìˆ˜ì •í•˜ëŠ” ë“±ì˜ ì‘ì—…ì´ í•„ìš”í•  ê²ƒ ê°™ë‹¤.ë”°ë¼ì„œ, httpd.conf íŒŒì¼ì— ìˆëŠ” ì†ì„±ë“¤ì´ ì–´ë–¤ ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ì§€, ì™œ í•„ìš”í•œì§€ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.h...", "content": "ë“¤ì–´ê°€ê¸° ì „íšŒì‚¬ì—ì„œ ì„œë²„ ì´ê´€ì„ ì¤€ë¹„í•˜ê³  ìˆë‹¤. ê¸°ì¡´ì— ê°ê°ì˜ ì„œë²„ì— í©ì–´ì ¸ ìˆë˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í•œ ì„œë²„ë¡œ ëª¨ìœ¼ëŠ” ë“±ì˜ ì‘ì—…ì„ í•´ì•¼í•˜ëŠ”ë°, ê·¸ëŸ´ë ¤ë©´ ê¸°ì¡´ì— ì„¸íŒ…ëœ ì•„íŒŒì¹˜ ì„¤ì • íŒŒì¼ì„ ì œëŒ€ë¡œ ì´í•´í•˜ê³  ë” ë‚˜ì•„ê°€ ìˆ˜ì •í•˜ëŠ” ë“±ì˜ ì‘ì—…ì´ í•„ìš”í•  ê²ƒ ê°™ë‹¤.ë”°ë¼ì„œ, httpd.conf íŒŒì¼ì— ìˆëŠ” ì†ì„±ë“¤ì´ ì–´ë–¤ ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ì§€, ì™œ í•„ìš”í•œì§€ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.httpdë€ ? â€œHypertext Transfer Protocol daemonâ€ ë°ëª¬ì€ ì‚¬ìš©ìê°€ ì§ì ‘ì ìœ¼ë¡œ ì œì–´í•˜ì§€ ì•Šê³ , ë°±ê·¸ë¼ìš´ë“œì—ì„œ ëŒë©´ì„œ ì—¬ëŸ¬ ì‘ì—…ì„ í•˜ëŠ” í”„ë¡œê·¸ë¨ì„ ë§í•œë‹¤. (ìœ„í‚¤ë°±ê³¼) httpdëŠ” ì›¹ì—ì„œ ë“¤ì–´ì˜¨ ìš”ì²­ì„ ì²˜ë¦¬í•˜ê±°ë‚˜, í•„ìš”ì— ë”°ë¼ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ë¡œ ì „ë‹¬í•œë‹¤. ì¦‰, ì›¹ ì„œë²„ì—ì„œ http ìš”ì²­ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë™ì‘í•˜ëŠ” í”„ë¡œê·¸ë¨ì´ httpdë¼ê³  ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤. ê°€ì¥ ëŒ€í‘œì ì¸ httpd ì¤‘ í•˜ë‚˜ëŠ” Apache HTTP Serverì´ë‹¤. (ì°¸ê³ )httpd.conf íŒŒì¼ ì†ì„±, íƒœê·¸ ì‚´í´ë³´ê¸° ë‚´ê°€ ë‹´ë‹¹í•˜ëŠ” ì„œë²„ì˜ httpd.confì— ìˆëŠ” íƒœê·¸, ì†ì„± ìœ„ì£¼ë¡œ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.ServerName ì„œë²„ê°€ ìì‹ ì„ ì‹ë³„í•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” í˜¸ìŠ¤íŠ¸ ì´ë¦„ ë° í¬íŠ¸ ë¬¸ë²• : ServerName [scheme://]domain-name|ip-address[:port] ServerNameì€ ì´ë¦„ ê¸°ë°˜ ê°€ìƒ í˜¸ìŠ¤íŠ¸(name-based virtual host)ë¥¼ ì‚¬ìš©í•  ë•Œ, ê°€ìƒ í˜¸ìŠ¤íŠ¸ë¥¼ ê³ ìœ í•˜ê²Œ ì‹ë³„í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤. ServerNameì€ ì„œë²„ ì •ì˜ ë‚´ ì–´ë””ì—ë‚˜ ë‚˜íƒ€ë‚  ìˆ˜ ìˆë‹¤. ë§Œì•½ ì—¬ëŸ¬ê°œê°€ ìˆë‹¤ë©´, ë§¨ ë§ˆì§€ë§‰ì— ìˆëŠ”ê²Œ ServerNameì´ ëœë‹¤. ServerNameì´ ì§€ì •ë˜ì§€ ì•Šì€ ê²½ìš°, ì„œë²„ëŠ” ë¨¼ì € ìš´ì˜ ì²´ì œì— ì‹œìŠ¤í…œ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ìš”ì²­í•˜ì—¬ í´ë¼ì´ì–¸íŠ¸ì˜ ë³´ì´ëŠ” í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ì¶”ë¡ í•˜ë ¤ê³  í•˜ê³ , ì‹¤íŒ¨í•˜ë©´ ì‹œìŠ¤í…œì— ìˆëŠ” IP ì£¼ì†Œë¥¼ ì—­ë°©í–¥ìœ¼ë¡œ ì¡°íšŒí•œë‹¤. ì´ë¦„ ê¸°ë°˜ ê°€ìƒ í˜¸ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, &lt;VirtualHost&gt; ì„¹ì…˜ ì•ˆì˜ ServerNameì€ ì´ ê°€ìƒ í˜¸ìŠ¤íŠ¸ì™€ ì¼ì¹˜í•˜ë„ë¡, ìš”ì²­ì˜ Host: í—¤ë”ì— í‘œì‹œí•  í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ì§€ì •í•œë‹¤.ì°¸ê³  : Host vs Server í˜¸ìŠ¤íŠ¸ : ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°ë˜ëŠ” ì»´í“¨í„° ë˜ëŠ” ë‹¤ë¥¸ ì¥ì¹˜ ì„œë²„ : ë„¤íŠ¸ì›Œí¬ ë‚´ì˜ ë‹¤ë¥¸ í”„ë¡œê·¸ë¨ì´ë‚˜ ì¥ì¹˜ì— ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ë˜ëŠ” í•˜ë“œì›¨ì–´ ê²°êµ­ì—” ì„œë²„ë„ í•˜ë‚˜ì˜ í˜¸ìŠ¤íŠ¸ë¼ê³  ìƒê°í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.&lt;VirtualHost&gt; íŠ¹ì • í˜¸ìŠ¤íŠ¸ ì´ë¦„ ë˜ëŠ” IP ì£¼ì†Œì—ë§Œ ì ìš©ë˜ëŠ” ì§€ì‹œë¬¸ì„ í¬í•¨ ë¬¸ë²• : &lt;VirtualHost addr[:port] [addr[:port]] ...&gt; ... &lt;/VirtualHost&gt; ì„œë²„ê°€ íŠ¹ì • ê°€ìƒ í˜¸ìŠ¤íŠ¸ì— ëŒ€í•œ ë¬¸ì„œ ìš”ì²­ì„ ë°›ìœ¼ë©´, &lt;VirtualHost&gt; ì„¹ì…˜ì— í¬í•¨ëœ êµ¬ì„± ì§€ì‹œì(configuration directives)ë¥¼ ì‚¬ìš©í•œë‹¤. addrì€ ë‹¤ìŒ ì¤‘ í•˜ë‚˜ê°€ ë  ìˆ˜ ìˆìœ¼ë©°, ì„ íƒì ìœ¼ë¡œ ë’¤ì— ì½œë¡ ê³¼ í¬íŠ¸ ë²ˆí˜¸(ë˜ëŠ” *)ê°€ ì˜¬ ìˆ˜ ìˆë‹¤. ê°€ìƒ í˜¸ìŠ¤íŠ¸ì˜ IP ì£¼ì†Œ ê°€ìƒ í˜¸ìŠ¤íŠ¸ì˜ IP ì£¼ì†Œì— ëŒ€í•œ ì •ê·œí™”ëœ ë„ë©”ì¸ ì´ë¦„(ê¶Œì¥í•˜ì§€ ì•ŠìŒ) ì™€ì¼ë“œì¹´ë“œ ì—­í• ì„ í•˜ê³  ëª¨ë“  IP ì£¼ì†Œì™€ ì¼ì¹˜í•˜ëŠ” * ë¬¸ì *ì˜ ë³„ì¹­ì¸ ë¬¸ìì—´ _default_ ê° &lt;VirtualHost&gt; ë¸”ë¡ ì•ˆì— ServerNameì„ ì§€ì •í•´ì•¼ í•œë‹¤. ì—†ëŠ” ê²½ìš° ë©”ì¸ ì„œë²„ êµ¬ì„±ì˜ ServerNameì´ ìƒì†ëœë‹¤. ìš”ì²­ì´ ìˆ˜ì‹ ë˜ë©´ ì„œë²„ëŠ” ë¨¼ì € ë¡œì»¬ IP ì£¼ì†Œì™€ í¬íŠ¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¼ì¹˜í•˜ëŠ” &lt;VirtualHost&gt;ë¥¼ ì°¾ëŠ”ë‹¤. ì™€ì¼ë“œì¹´ë“œê°€ ì•„ë‹Œ ê²ƒì´ ë” ë†’ì€ ìš°ì„ ìˆœìœ„ë¥¼ ê°€ì§„ë‹¤. ì¼ì¹˜í•˜ëŠ” í˜¸ìŠ¤íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìœ¼ë©´ ì•Šìœ¼ë©´ ë©”ì¸ ì„œë²„ êµ¬ì„±ì´ ì‚¬ìš©ëœë‹¤. IP ì£¼ì†Œ ë° í¬íŠ¸ì— ì—¬ëŸ¬ í˜¸ìŠ¤íŠ¸ê°€ ì¼ì¹˜í•˜ëŠ” ê²½ìš°, ì„œë²„ëŠ” ìš”ì²­ëœ í˜¸ìŠ¤íŠ¸ ì´ë¦„ì„ ê¸°ë°˜ìœ¼ë¡œ ì¼ì¹˜í•˜ëŠ” í˜¸ìŠ¤íŠ¸ë¥¼ ì„ íƒí•œë‹¤. ì¼ì¹˜í•˜ëŠ” ê°€ìƒ í˜¸ìŠ¤íŠ¸ê°€ ì—†ìœ¼ë©´ IP ì£¼ì†Œì™€ ì¼ì¹˜í•˜ëŠ” ì²« ë²ˆì§¸ ë‚˜ì—´ëœ ê°€ìƒ í˜¸ìŠ¤íŠ¸ê°€ ì‚¬ìš©ëœë‹¤. ì¦‰, IP ì£¼ì†Œ ë° í¬íŠ¸ ì¡°í•©ì— ëŒ€í•´ ë‚˜ì—´ëœ ì²« ë²ˆì§¸ ê°€ìƒ í˜¸ìŠ¤íŠ¸ê°€ í•´ë‹¹ IP ë° í¬íŠ¸ ì¡°í•©ì— ëŒ€í•œ ê¸°ë³¸ ê°€ìƒ í˜¸ìŠ¤íŠ¸ì´ë‹¤. DocumentRoot ì›¹ì—ì„œ ë³¼ ìˆ˜ ìˆëŠ” main document tree ë¥¼ êµ¬ì„±í•˜ëŠ” ë””ë ‰í† ë¦¬ ë¬¸ë²• : DocumentRoot directory-path Default : DocumentRoot \"/usr/local/apache/htdocs\" ì´ ì§€ì‹œë¬¸ì€ httpdê°€ íŒŒì¼ì„ ì œê³µí•  ë””ë ‰í† ë¦¬ë¥¼ ì„¤ì •í•œë‹¤. Aliasì™€ ê°™ì€ ì§€ì‹œë¬¸ê³¼ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” í•œ, ìš”ì²­ëœ URLì—ì„œ ë¬¸ì„œ ë£¨íŠ¸ê¹Œì§€ì˜ ê²½ë¡œë¥¼ ì¶”ê°€í•˜ì—¬ ë¬¸ì„œì˜ ê²½ë¡œë¥¼ ë§Œë“ ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, DocumentRoot \"/usr/web\"ë¡œ ì„¸íŒ…ë˜ì–´ ìˆë‹¤ë©´ http://my.example.com/index.html ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ëŠ” /usr/web/index.htmlì„ ì°¸ì¡°í•œë‹¤. ë””ë ‰í† ë¦¬ ê²½ë¡œê°€ ì ˆëŒ€ ê²½ë¡œê°€ ì•„ë‹ˆë©´, ServerRootì— ìƒëŒ€ì ì¸ ê²ƒìœ¼ë¡œ ê°„ì£¼ëœë‹¤. DocumentRootëŠ” í›„í–‰ ìŠ¬ë˜ì‹œ ì—†ì´ ì§€ì •í•´ì•¼ í•œë‹¤.&lt;Directory&gt; ëª…ëª…ëœ íŒŒì¼ ì‹œìŠ¤í…œ ë””ë ‰í„°ë¦¬, í•˜ìœ„ ë””ë ‰í„°ë¦¬ ë° í•´ë‹¹ ë‚´ìš©ì—ë§Œ ì ìš©ë˜ëŠ” ì§€ì‹œë¬¸ ê·¸ë£¹ì„ ë¬¶ëŠ”ë‹¤. ë¬¸ë²• : &lt;Directory directory-path&gt; ... &lt;/Directory&gt;&lt;Directory \"/usr/local/httpd/htdocs\"&gt; Options Indexes FollowSymLinks&gt;&lt;/Directory&gt; Directory-pathëŠ” ë””ë ‰í† ë¦¬ì˜ ì „ì²´ ê²½ë¡œì´ê±°ë‚˜ Unix ì…¸ ìŠ¤íƒ€ì¼ ë§¤ì¹­ì„ ì‚¬ìš©í•˜ëŠ” ì™€ì¼ë“œì¹´ë“œ ë¬¸ìì—´ì´ë‹¤. ì™€ì¼ë“œì¹´ë“œ ë¬¸ìì—´ì—ì„œ ?ëŠ” ë‹¨ì¼ ë¬¸ìì™€ ì¼ì¹˜í•˜ê³  *ëŠ” ëª¨ë“  ë¬¸ì ì‹œí€€ìŠ¤ì™€ ë§¤ì¹­ëœë‹¤. [] ë¬¸ì ë²”ìœ„ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆë‹¤. ì™€ì¼ë“œì¹´ë“œëŠ” / ë¬¸ìì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ”ë‹¤. ì¦‰, &lt;Directory \"/*/public_html\"&gt;ì€ /home/user/public_htmlê³¼ ì¼ì¹˜í•˜ì§€ ì•Šì§€ë§Œ &lt;Directory \"/home/*/public_html\"&gt;ê³¼ëŠ” ì¼ì¹˜í•œë‹¤. directory-pathëŠ” ë”°ì˜´í‘œë¡œ ë¬¶ì§€ ì•Šì•„ë„ ë˜ì§€ë§Œ, ê²½ë¡œì— ê³µë°±ì´ í¬í•¨ëœ ê²½ìš°ëŠ” ë°˜ë“œì‹œ ë”°ì˜´í‘œë¡œ ë¬¶ì–´ì•¼ í•œë‹¤. ê³µë°±ì€ ëì„ ì˜ë¯¸í•˜ê¸° ë•Œë¬¸ì´ë‹¤. directory-pathëŠ” Apache httpdê°€ íŒŒì¼ì— ì•¡ì„¸ìŠ¤í•˜ëŠ”ë° ì‚¬ìš©í•˜ëŠ” íŒŒì¼ ì‹œìŠ¤í…œ ê²½ë¡œì™€ ë¬¸ì ê·¸ëŒ€ë¡œ ì¼ì¹˜í•´ì•¼ í•œë‹¤. ì¦‰, ë™ì¼í•œ ë””ë ‰í† ë¦¬ì—ì„œ ë‹¤ë¥¸ ì‹¬ë³¼ë¦­ ë§í¬ë¥¼ í†µí•´ ì•¡ì„¸ìŠ¤í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ë‹¤ë¥¸ ê²½ë¡œë¥¼ í†µí•´ ì•¡ì„¸ìŠ¤í•˜ëŠ” íŒŒì¼ì—ëŠ” ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤. &lt;Location&gt; í¬í•¨ëœ ì§€ì‹œë¬¸ì„ ì¼ì¹˜í•˜ëŠ” URLì—ë§Œ ì ìš© ë¬¸ë²• : &lt;Location URL-path|URL&gt; ... &lt;/Location&gt; &lt;Location&gt; ì§€ì‹œë¬¸ì€ í¬í•¨ëœ ì§€ì‹œë¬¸ì˜ ë²”ìœ„ë¥¼ URLë¡œ ì œí•œí•œë‹¤. (&lt;Directory&gt; ì§€ì‹œë¬¸ê³¼ ìœ ì‚¬) &lt;Location&gt; ì„¹ì…˜ì€ ì„¤ì • íŒŒì¼ì— ë‚˜íƒ€ë‚˜ëŠ” ìˆœì„œëŒ€ë¡œ, &lt;Directory&gt; ì„¹ì…˜ê³¼ .htaccess íŒŒì¼ì„ ì½ì€ í›„, &lt;Files&gt; ì„¹ì…˜ ì´í›„ì— ì²˜ë¦¬ëœë‹¤. &lt;Location&gt; ì§€ì‹œë¬¸ì´ íŒŒì¼ ì‹œìŠ¤í…œ ìœ„ì¹˜ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ì œì–´í•˜ëŠ” ë° ì‚¬ìš©ë˜ì–´ì„œëŠ” ì•ˆëœë‹¤. ì—¬ëŸ¬ ë‹¤ë¥¸ URLì´ ë™ì¼í•œ íŒŒì¼ ì‹œìŠ¤í…œ ìœ„ì¹˜ì— ë§¤í•‘ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì´ëŸ¬í•œ ì•¡ì„¸ìŠ¤ ì œì–´ê°€ ìš°íšŒë  ìˆ˜ ìˆë‹¤. í›„í–‰ ìŠ¬ë˜ì‹œê°€ ì‚¬ìš©ë˜ì§€ ì•Šì€ ì•„ë˜ ì˜ˆì—ì„œ /private1, /private1/ ë° /private1/file.txtì— ëŒ€í•œ ìš”ì²­ì—ëŠ” í¬í•¨ëœ ì§€ì‹œë¬¸ì´ ì ìš©ë˜ì§€ë§Œ /private1otherì—ëŠ” ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.&lt;Location \"/private1\"&gt; # ...&lt;/Location&gt; í›„í–‰ ìŠ¬ë˜ì‹œê°€ ì‚¬ìš©ë˜ëŠ” ì•„ë˜ ì˜ˆì—ì„œ /private2/ ë° /private2/file.txtì— ëŒ€í•œ ìš”ì²­ì—ëŠ” í¬í•¨ëœ ì§€ì‹œë¬¸ì´ ì ìš©ë˜ì§€ë§Œ /private2 ë° /private2otherì—ëŠ” ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.&lt;Location \"/private2/\"&gt; # ...&lt;/Location&gt; ì–¸ì œ &lt;Location&gt;ì„ ì‚¬ìš©í•˜ëŠ”ê²Œ ì¢‹ì„ê¹Œ ? &lt;Location&gt;ì„ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ì‹œìŠ¤í…œ ì™¸ë¶€ì— ìˆëŠ” ì½˜í…ì¸ ì— ì§€ì‹œë¬¸ì„ ì ìš©í•œë‹¤. íŒŒì¼ ì‹œìŠ¤í…œì— ìˆëŠ” ì½˜í…ì¸ ì˜ ê²½ìš° &lt;Directory&gt; ë° &lt;Files&gt;ë¥¼ ì‚¬ìš©í•œë‹¤. ì˜ˆì™¸ì ìœ¼ë¡œ, &lt;Location \"/\"&gt;ì€ êµ¬ì„±ì„ ì „ì²´ ì„œë²„ì— ì‰½ê²Œ ì ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ë‹¤. ëª¨ë“  ì›ë³¸(í”„ë¡ì‹œê°€ ì•„ë‹Œ) ìš”ì²­ì— ëŒ€í•´ ì¼ì¹˜í•  URLì€ /path/ í˜•ì‹ì˜ URL ê²½ë¡œì´ë‹¤. ì¦‰, ìŠ¤í‚¤ë§ˆ, í˜¸ìŠ¤íŠ¸ ì´ë¦„, í¬íŠ¸ ë˜ëŠ” ì¿¼ë¦¬ ë¬¸ìì—´ì´ í¬í•¨ë  ìˆ˜ ì—†ë‹¤. í”„ë¡ì‹œ ìš”ì²­ì˜ ê²½ìš° ì¼ì¹˜í•˜ëŠ” URLì€ scheme://servername/path í˜•ì‹ì´ë©°, ë°˜ë“œì‹œ ì ‘ë‘ì‚¬ë¥¼ í¬í•¨í•´ì•¼ í•œë‹¤. URLì€ ì™€ì¼ë“œì¹´ë“œë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì™€ì¼ë“œì¹´ë“œ ë¬¸ìì—´ì—ì„œ ?ëŠ” ë‹¨ì¼ ë¬¸ìì™€ ì¼ì¹˜í•˜ê³  *ëŠ” ëª¨ë“  ë¬¸ì ì‹œí€€ìŠ¤ì™€ ì¼ì¹˜í•œë‹¤. ì™€ì¼ë“œì¹´ë“œ ë¬¸ìëŠ” URL ê²½ë¡œì˜ /ì™€ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ”ë‹¤. ~ ë¬¸ìë¥¼ ì¶”ê°€í•˜ì—¬ ì •ê·œì‹ë„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ ì˜ˆëŠ” í•˜ìœ„ ë¬¸ìì—´ /extra/data ë˜ëŠ” /special/dataê°€ í¬í•¨ëœ URLê³¼ ì¼ì¹˜í•œë‹¤. &lt;Location ~ \"/(extra|special)/data\"&gt; #...&lt;/Location&gt; &lt;Location&gt; ê¸°ëŠ¥ì€ SetHandler ì§€ì‹œë¬¸ê³¼ ê²°í•©í•  ë•Œ íŠ¹íˆ ìœ ìš©í•˜ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìƒíƒœ ìš”ì²­ì„ í™œì„±í™”í•˜ë˜ example.comì˜ ë¸Œë¼ìš°ì €ì—ì„œë§Œ í—ˆìš©í•˜ë ¤ë©´ ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. &lt;Location \"/status\"&gt; SetHandler server-status Require host example.com&lt;/Location&gt;&lt;LocationMatch&gt; í¬í•¨ëœ ì§€ì‹œë¬¸ì„ ì •ê·œì‹ ì¼ì¹˜ URLì—ë§Œ ì ìš© ë¬¸ë²• : &lt;LocationMatch regex&gt; ... &lt;/LocationMatch&gt;&lt;LocationMatch \"/(extra|special)/data\"&gt; # ...&lt;/LocationMatch&gt; ì§€ì‹œë¬¸ &lt;LocationMatch&gt;ëŠ” &lt;Location&gt;ì˜ ì •ê·œì‹ ë²„ì „ê³¼ ë™ì¼í•˜ê²Œ ì‘ë™í•˜ë©° ë§ì€ ê¸€ê¼´ì—ì„œ ~ê°€ -ì™€ êµ¬ë³„í•˜ê¸° ì–´ë µë‹¤ëŠ” ë‹¨ìˆœí•œ ì´ìœ ë¡œ ì„ í˜¸ëœë‹¤.SetHandler ì¼ì¹˜í•˜ëŠ” ëª¨ë“  íŒŒì¼ì„ ê°•ì œë¡œ í•¸ë“¤ëŸ¬ì—ì„œ ì²˜ë¦¬ ë¬¸ë²• : SetHandler handler-name|none|expression SetHandlerê°€ .htaccess íŒŒì¼ì´ë‚˜ &lt;Directory&gt; ë˜ëŠ” &lt;Location&gt; ì„¹ì…˜ì— ë°°ì¹˜ë  ë•Œ, ëª¨ë“  ì¼ì¹˜í•˜ëŠ” íŒŒì¼ì´ handler-nameì— ì •ì˜ëœ í•¸ë“¤ëŸ¬ë¥¼ í†µí•´ êµ¬ë¬¸ ë¶„ì„ë˜ë„ë¡ í•œë‹¤. http://servername/status ì˜ URLì´ í˜¸ì¶œë  ë•Œë§ˆë‹¤ ì„œë²„ê°€ ìƒíƒœ ë³´ê³ ì„œë¥¼ í‘œì‹œí•˜ë„ë¡ í•˜ë ¤ë©´ ë‹¤ìŒì„ httpd.confì— ì¶”ê°€í•œë‹¤.&lt;Location \"/status\"&gt; SetHandler server-status&lt;/Location&gt; íŠ¹ì • íŒŒì¼ í™•ì¥ìë¥¼ ê°€ì§„ íŒŒì¼ì— ëŒ€í•œ íŠ¹ì • í•¸ë“¤ëŸ¬ë¥¼ êµ¬ì„±í•  ìˆ˜ë„ ìˆë‹¤.&lt;FilesMatch \"\\.php$\"&gt; SetHandler application/x-httpd-php&lt;/FilesMatch&gt; None ê°’ì„ ì‚¬ìš©í•˜ì—¬ ì´ì „ì— ì •ì˜ëœ SetHandler ì§€ì‹œë¬¸ì„ ì¬ì •ì˜í•  ìˆ˜ ìˆë‹¤.ì°¸ê³  : í•¸ë“¤ëŸ¬ë€ ? í•¸ë“¤ëŸ¬ëŠ” íŒŒì¼ì´ í˜¸ì¶œë  ë•Œ ìˆ˜í–‰ë  ì‘ì—…ì— ëŒ€í•œ Apacheì˜ ë‚´ë¶€ì ì¸ í‘œí˜„ì´ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ íŒŒì¼ì—ëŠ” íŒŒì¼ ìœ í˜•ì— ë”°ë¼ ì•”ì‹œì  í•¸ë“¤ëŸ¬ê°€ ìˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ëª¨ë“  íŒŒì¼ì€ ë‹¨ìˆœíˆ ì„œë²„ì—ì„œ ì œê³µë˜ì§€ë§Œ íŠ¹ì • íŒŒì¼ í˜•ì‹ì€ ë³„ë„ë¡œ ì²˜ë¦¬ëœë‹¤. í•¸ë“¤ëŸ¬ëŠ” íŒŒì¼ ìœ í˜•ê³¼ ê´€ê³„ì—†ì´ íŒŒì¼ ì´ë¦„ í™•ì¥ì ë˜ëŠ” ìœ„ì¹˜ì— ë”°ë¼ ëª…ì‹œì ìœ¼ë¡œ êµ¬ì„±í•  ìˆ˜ë„ ìˆë‹¤. í•¸ë“¤ëŸ¬ëŠ” ì„œë²„ì— êµ¬ì¶•í•˜ê±°ë‚˜ ëª¨ë“ˆì— í¬í•¨í•˜ê±°ë‚˜ Action ì§€ì‹œë¬¸ìœ¼ë¡œ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. í‘œì¤€ ë°°í¬íŒì— ë‚´ì¥ëœ í•¸ë“¤ëŸ¬ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. default-handler (core) ì •ì  ì½˜í…ì¸ ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” í•¸ë“¤ëŸ¬ì¸ default_handler()ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ì„ ë³´ë‚¸ë‹¤. send-as-is (mod_asis) HTTP í—¤ë”ê°€ íŒŒì¼ì„ ìˆëŠ” ê·¸ëŒ€ë¡œ ë³´ë‚¸ë‹¤. cgi-script (mod_cgi) íŒŒì¼ì„ CGI ìŠ¤í¬ë¦½íŠ¸ë¡œ ì·¨ê¸‰í•œë‹¤. imap-file (mod_imagemap) ì´ë¯¸ì§€ë§µ ê·œì¹™ íŒŒì¼(imagemap rule file)ë¡œ íŒŒì‹±í•œë‹¤. server-info (mod_info) ì„œë²„ì˜ êµ¬ì„± ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤. server-status (mod_status) ì„œë²„ì˜ ìƒíƒœ ë³´ê³ ì„œë¥¼ ê°€ì ¸ì˜¨ë‹¤. type-map (mod_negotiation) content negotiationì„ ìœ„í•´ type map íŒŒì¼ë¡œ íŒŒì‹±í•œë‹¤. ì°¸ê³  ìë£Œ https://whatis.techtarget.com/definition/Hypertext-Transfer-Protocol-daemon-HTTPD https://httpd.apache.org/docs/2.4/en/mod/directives.html https://pediaa.com/difference-between-host-and-server/ https://httpd.apache.org/docs/2.4/en/handler.html" }, { "title": "Permissions 0644 for ~ are too open ê·¸ë¦¬ê³  Permission denied (publickey) í˜„ìƒ í•´ê²°í•˜ê¸°", "url": "/posts/aws-ssh-pem-key-permission/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "AWS, SSH", "date": "2022-01-15 00:25:00 +0900", "snippet": "ìƒí™©íšŒì‚¬ì—ì„œ ë¦¬ëˆ…ìŠ¤ ì„œë²„ë¥¼ ë‹¤ë¤„ì•¼í•  ì¼ì´ ë§ì•„ì„œ ìµìˆ™í•´ì§ˆê²¸ ì—°ìŠµìš©ìœ¼ë¡œ ë§‰ ë‹¤ë¤„ë³¼ ìˆ˜ ìˆëŠ” AWS ì„œë²„ í•˜ë‚˜ë¥¼ êµ¬í•´ë´ì•¼ì§€ ìƒê°í–ˆë‹¤. ì˜ˆì „ì— ë§Œë“¤ì–´ë†“ì€ AWS EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ ìˆì–´ì„œì˜¤ëœë§Œì— ì ‘ì†í•´ë³´ë ¤ê³  í–ˆëŠ”ë° Permissions 0644 for keyname.pem are too open., Permission denied (publickey) ë‘ ê°€...", "content": "ìƒí™©íšŒì‚¬ì—ì„œ ë¦¬ëˆ…ìŠ¤ ì„œë²„ë¥¼ ë‹¤ë¤„ì•¼í•  ì¼ì´ ë§ì•„ì„œ ìµìˆ™í•´ì§ˆê²¸ ì—°ìŠµìš©ìœ¼ë¡œ ë§‰ ë‹¤ë¤„ë³¼ ìˆ˜ ìˆëŠ” AWS ì„œë²„ í•˜ë‚˜ë¥¼ êµ¬í•´ë´ì•¼ì§€ ìƒê°í–ˆë‹¤. ì˜ˆì „ì— ë§Œë“¤ì–´ë†“ì€ AWS EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ ìˆì–´ì„œì˜¤ëœë§Œì— ì ‘ì†í•´ë³´ë ¤ê³  í–ˆëŠ”ë° Permissions 0644 for keyname.pem are too open., Permission denied (publickey) ë‘ ê°€ì§€ ì—ëŸ¬ë¥¼ ë§ë‹¥ë“¤ì˜€ë‹¤.ì›ì¸ê³¼ í•´ê²°ë°©ë²•1. Permissions 0644 for keyname.pem are too open. ë¬¸ì¥ ê·¸ëŒ€ë¡œ íŒŒì¼ ê¶Œí•œì´ ë„ˆë¬´ ê³µê°œë˜ì–´ ìˆë‹¤ëŠ” ì˜ë¯¸.@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ WARNING: UNPROTECTED PRIVATE KEY FILE! @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@Permissions 0644 for keyname.pem are too open.It is required that your private key files are NOT accessible by others.This private key will be ignored.Permissions 0644 ? Chmod 644 (chmod a+rwx,u-x,g-wx,o-wx) (U)ser : íŒŒì¼ ì†Œìœ ìëŠ” ì½ê¸°/ì“°ê¸°ë§Œ ê°€ëŠ¥ (G)roup : ê·¸ë£¹ì€ ì½ê¸°ë§Œ ê°€ëŠ¥ (O)thers : ì™¸ë¶€ì—ì„œë„ ì½ê¸°ë§Œ ê°€ëŠ¥ ì¶œì²˜ : https://chmodcommand.com/ í•´ê²° ë°©ë²• íŒŒì¼ ì†Œìœ ìë§Œ í•´ë‹¹ íŒŒì¼ì„ ì½ì„ ìˆ˜ ìˆë„ë¡ ê¶Œí•œì„ ë³€ê²½í•œë‹¤. chmod 400 keyname.pem 2. Permission denied (publickey). ìœ„ ë¬¸ì œ í•´ê²° í›„, ssh -i [key] [username@host]ë¡œ ì ‘ì† ì‹œë„í•˜ë‹ˆê¹Œ ì´ëŸ¬í•œ í˜„ìƒì´ ë‚˜íƒ€ë‚¬ë‹¤. ëŒ€í‘œì ìœ¼ë¡œ ì„¸ ê°€ì§€ ì´ìœ ê°€ ìˆë‹¤ê³  í•œë‹¤. ì˜ëª»ëœ key ì‚¬ìš© ì˜ëª»ëœ username ì‚¬ìš© ì˜ëª»ëœ hostë¡œ ì ‘ì† ì‹œë„ í•´ê²° ë°©ë²• í•´ê²°ì´ë¼ê³  í•˜ê¸°ë„ ë¯¼ë§í•˜ê²Œ ë‚˜ì˜ ê²½ìš°ëŠ” ë‹¤ë¥¸ keyë¥¼ ì‚¬ìš©í•˜ê³  ìˆì—ˆë‹¤â€¦ ì•Œë§ì€ í‚¤ë¥¼ ì‚¬ìš©í•˜ë‹ˆ ì˜ ì ‘ì†ëë‹¤.â€» ì°¸ê³  : ì¸ìŠ¤í„´ìŠ¤ë³„ username AWS ê³µì‹ ë¬¸ì„œì— ë³´ë©´ ì¸ìŠ¤í„´ìŠ¤ë³„ usernameì´ ë‚˜ì™€ìˆë‹¤. Amazon Linux 2 or the Amazon Linux AMI : ec2-user CentOS AMI : centos or ec2-user Debian AMI : admin Fedora AMI : fedora or ec2-user RHEL AMI : ec2-user or root SUSE AMI : ec2-user or root Ubuntu AMI : ubuntu Oracle AMI : ec2-user Bitnami AMI: bitnamiì°¸ê³  ìë£Œ https://99robots.com/how-to-fix-permission-error-ssh-amazon-ec2-instance/ https://bobbyhadz.com/blog/aws-ssh-permission-denied-publickey https://stackoverflow.com/questions/18551556/permission-denied-publickey-when-ssh-access-to-amazon-ec2-instance https://bobbyhadz.com/blog/aws-ssh-permission-denied-publickey" }, { "title": "SIì—ì„œ IT ì„œë¹„ìŠ¤ ê¸°ì—…ìœ¼ë¡œ ê°€ê¸°ê¹Œì§€ (feat.íšŒê³ ë¡)", "url": "/posts/restrospect2021/", "categories": "ë„ì ë„ì ", "tags": "", "date": "2022-01-01 01:00:00 +0900", "snippet": "ì§€ë‚œ 3ë…„ ë˜ëŒì•„ë³´ê¸°2022ë…„ì´ë‹¤. 21ë…„ì—” ëª©í‘œí•˜ë˜ IT ì„œë¹„ìŠ¤ íšŒì‚¬ë¡œ ì´ì§ì„ í•˜ê²Œë˜ì—ˆë‹¤. ì´ì§ì— ì„±ê³µí•˜ë©´ íšŒê³ ë¡ì„ ì ì–´ë³´ê³  ì‹¶ë‹¤ëŠ” ë¡œë§(?)ì´ ìˆì—ˆëŠ”ë°, ë¯¸ë£¨ë‹¤ê°€ ìƒˆí•´ë¥¼ ë§ì´í•˜ë©´ì„œ ì¨ë³´ë ¤ê³ í•œë‹¤.ìŠ¤ìŠ¤ë¡œë¥¼ ë˜ëŒì•„ë³´ë©´ì„œ ìƒê°ì„ ì •ë¦¬í•˜ê³ , ìƒˆë¡œìš´ í•œ í•´ ë˜í•œ ì¦ê²ê³  ì—´ì‹¬íˆ ì‚´ ìˆ˜ ìˆê¸¸ ë°”ë¼ë³¸ë‹¤.ê°œë°œìë¡œì„œ ì‚¬íšŒì˜ ì²«ë°œì„ ë‚´ë”›ë‹¤.18ë…„ 10ì›” ëŒ€ê¸°ì—…(ì—°ë´‰ì€ ...", "content": "ì§€ë‚œ 3ë…„ ë˜ëŒì•„ë³´ê¸°2022ë…„ì´ë‹¤. 21ë…„ì—” ëª©í‘œí•˜ë˜ IT ì„œë¹„ìŠ¤ íšŒì‚¬ë¡œ ì´ì§ì„ í•˜ê²Œë˜ì—ˆë‹¤. ì´ì§ì— ì„±ê³µí•˜ë©´ íšŒê³ ë¡ì„ ì ì–´ë³´ê³  ì‹¶ë‹¤ëŠ” ë¡œë§(?)ì´ ìˆì—ˆëŠ”ë°, ë¯¸ë£¨ë‹¤ê°€ ìƒˆí•´ë¥¼ ë§ì´í•˜ë©´ì„œ ì¨ë³´ë ¤ê³ í•œë‹¤.ìŠ¤ìŠ¤ë¡œë¥¼ ë˜ëŒì•„ë³´ë©´ì„œ ìƒê°ì„ ì •ë¦¬í•˜ê³ , ìƒˆë¡œìš´ í•œ í•´ ë˜í•œ ì¦ê²ê³  ì—´ì‹¬íˆ ì‚´ ìˆ˜ ìˆê¸¸ ë°”ë¼ë³¸ë‹¤.ê°œë°œìë¡œì„œ ì‚¬íšŒì˜ ì²«ë°œì„ ë‚´ë”›ë‹¤.18ë…„ 10ì›” ëŒ€ê¸°ì—…(ì—°ë´‰ì€ ì¤‘ê²¬ê¸°ì—…) IT ê³„ì—´ì‚¬ì— ì…ì‚¬í•˜ê²Œ ë˜ì—ˆë‹¤.ë‚˜ëŠ” ì „ê³µìì´ì§€ë§Œ í•™ë¶€ìƒ ë•Œ ì½”ë”©ì„ ì—„ì²­ ì—´ì‹¬íˆ í•œ ê²ƒë„ ì•„ë‹ˆê³ , â€˜ê°œë°œìë¡œì„œ ì„±ì¥í•˜ê¸° ì¢‹ì€ íšŒì‚¬â€™ì— ëŒ€í•´ ìƒê°í•´ë³¸ ì ì€ ë”ë”ìš± ì—†ì—ˆê¸° ë•Œë¬¸ì— ê·¸ëƒ¥ ì „ê³µì„ ì‚´ë ¤ì„œ ì·¨ì—…ì„ í–ˆë‹¤ëŠ” ì‚¬ì‹¤ê³¼ì•½ 8ê°œì›” ê°„ì˜ ì·¨ì¤€ì„ ë§ˆì³¤ë‹¤ëŠ” ì‚¬ì‹¤ì´ ë„ˆë¬´ ê¸°ë»¤ë‹¤.ì•ì„œ ë§í–ˆë“¯ ì½”ë”© ë•í›„ëŠ” ì•„ë‹ˆì—ˆì§€ë§Œ, ê·¸ë˜ë„ ê°œë°œì„ í•  ë•Œë©´ ì¬ë°Œê³  ì ì„±ì— ë§ëŠ” ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì€ í•˜ê³  ìˆì—ˆëŠ”ë°, ì¼ì„ í•˜ë‹¤ë³´ë‹ˆ â€˜ë‚˜ì—ê²Œ ì •ë§ ì˜ ë§ëŠ” ì§ì—…ì´êµ¬ë‚˜â€™ë¼ê³  ëŠë¼ê²Œ ë˜ì—ˆë‹¤.ìµìˆ™í•¨ê³¼ ì‹¤ë ¥ì„ ì°©ê°í•˜ë‹¤.ë‚´ê°€ ì†í•œ í”„ë¡œì íŠ¸ëŠ” ì•½ 2ë…„ ë™ì•ˆ ì§„í–‰ëœ ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸ì˜€ë‹¤. ë‚´ê°€ ì²˜ìŒì— ë§¡ì€ ë¶€ë¶„ì€ ë ˆê±°ì‹œ ì‹œìŠ¤í…œì˜ í™”ë©´ ë¶€ë¶„ì„ React ê¸°ë°˜ìœ¼ë¡œ ë°”ê¾¸ëŠ” ê²ƒì´ì—ˆë‹¤.ReactëŠ” ê³ ì‚¬í•˜ê³  javascriptì— ëŒ€í•œ ê°œë…ê³¼ ê¸°ì´ˆê°€ ë¶€ì¡±í–ˆê¸° ë•Œë¬¸ì— ì½”ë¿”ì†Œ ì±…ì„ ì‚¬ì„œ ë‚˜ë¦„ëŒ€ë¡œ ê³µë¶€ë¥¼ í–ˆë‹¤.ë˜í•œ ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ reduxì— ëŒ€í•´ ì–´ëŠì •ë„ ì´í•´ê°€ ë˜ê³ ë‚˜ë‹ˆ ë‚´ê°€ ë§¡ì€ ë¶€ë¶„ì— ìˆì–´ì„œëŠ” í° ì–´ë ¤ì›€ ì—†ì´ êµ¬í˜„ì„ í•  ìˆ˜ ìˆì—ˆë‹¤.ì ì  ìµìˆ™í•´ì§€ë‹¤ë³´ë‹ˆ ê¹Šê²Œ ê³µë¶€í•˜ê¸°ë³´ë‹¤ëŠ” ê·¸ëƒ¥ ì•„ëŠ” ì§€ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ëŠ” ê²ƒì— ë§Œì¡±í•˜ë©´ì„œ ì§€ëƒˆë˜ ê²ƒ ê°™ë‹¤. ì§€ê¸ˆ ëŒì´ì¼œ ìƒê°í•´ë³´ë©´ ì‹œê°„ ë‚´ì— êµ¬í˜„í•˜ëŠ” ê²ƒ = ì‹¤ë ¥ì´ë¼ê³  ì°©ê°í–ˆë˜ ê²ƒ ê°™ë‹¤.ë¬¼ë¡  ì •í•´ì§„ ê¸°ê°„ ë‚´ì— ë§¡ì€ ì¼ì„ ë§ˆë¬´ë¦¬í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì¤‘ìš”í•˜ì§€ë§Œ, ê·¸ê²ƒì€ ê°œë°œìì˜ ê¸°ë³¸ ì†Œì–‘ì¸ ê²ƒ ê°™ë‹¤. ì§„ì§œ ì‹¤ë ¥ì€ ìƒì‚°ì„±ê³¼ ë”ë¶ˆì–´ ì–¼ë§ˆë‚˜ ì¢‹ì€ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ”ì§€ì— ë‹¬ë¦° ê²ƒ ê°™ë‹¤.ë‚´ê°€ ìƒê°í•˜ëŠ” â€˜ì¢‹ì€ ì½”ë“œâ€™ì˜ íŠ¹ì§•ì€ í¬ê²Œ ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì¢‹ë‹¤, íŠ¸ë ˆì´ë“œ ì˜¤í”„ê°€ ì ì ˆí•˜ê²Œ ê³ ë ¤ë˜ì—ˆë‹¤ ì¸ ê²ƒ ê°™ë‹¤.í•˜ë‚˜ì˜ í”„ë¡œì íŠ¸ë¥¼ ë§ˆì¹˜ê³  ìš´ì˜ê¹Œì§€ í•´ë³´ë‹ˆ í”„ë¡œê·¸ë¨ì„ ìœ ì§€ë³´ìˆ˜í•˜ëŠ”ë° ë“œëŠ” ë¹„ìš©ì„ ì¤„ì´ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”í•œ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤.íŠ¹íˆ, ìš”êµ¬ì‚¬í•­ì´ ë³€ê²½ë˜ê±°ë‚˜ ì¶”ê°€ë  ë•Œ â€˜ì½”ë“œë¥¼ ì–¼ë§ˆë‚˜ ì ê²Œ ê³ ì¹˜ë©´ì„œ ë°˜ì˜ í•  ìˆ˜ ìˆëŠ”ì§€â€™, â€˜ê¸°ì¡´ì˜ ì‘ì„±ëœ ì½”ë“œê°€ ì´í•´í•˜ê¸° ì–¼ë§ˆë‚˜ ìˆ˜ì›”í•œì§€â€™ ë“± ì‹¤ì œë¡œ ì§€ì¶œë˜ëŠ” ëˆì€ ì•„ë‹ˆì§€ë§Œê°œë°œìê°€ ì¸ì§€í•˜ê³  ì‘ì—…í•˜ëŠ”ë° ê±¸ë¦¬ëŠ” ì‹œê°„ì„ ë¹„ìš©ìœ¼ë¡œ ìƒê°í•˜ê³  ì´ê²ƒì„ ê³ ë ¤í•˜ë©´ì„œ ì½”ë“œë¥¼ ì‘ì„±í•˜ëŠ”ê²Œ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•œë‹¤.\"ì€ íƒ„í™˜ì€ ì—†ë‹¤\"ë¼ëŠ” ë§ì²˜ëŸ¼, ëª¨ë“  ë¬¸ì œì— í†µìš©ë˜ëŠ” í•´ê²°ë°©ë²•ì€ ì—†ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ â€˜ë©€í‹° ìŠ¤ë ˆë”©ì„ í™œìš©í•œ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í†µí•´ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¨ë‹¤â€™ë¼ëŠ” í•´ê²°ë²•ì´ ìˆì„ ë•Œ,ë‹¨ìˆœíˆ ì„±ëŠ¥ í–¥ìƒì—ë§Œ ì´ˆì ì„ ë§ì¶”ê²Œ ë˜ë©´ ì„±ëŠ¥ì´ ì•ˆë‚˜ì˜¤ëŠ” ê²½ìš°ì— ìš°ì„ ì ìœ¼ë¡œ ë©€í‹° ìŠ¤ë ˆë”©ì„ ì ìš©ì‹œí‚¤ë ¤ê³  í•  ê²ƒì´ë‹¤.í•˜ì§€ë§Œ, ë©€í‹° ìŠ¤ë ˆë”©ì„ ì‚¬ìš©í–ˆì„ ë•Œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ê²½í•©, ì»¨í…ìŠ¤íŠ¸ ìŠ¤ìœ„ì¹­ ë¹„ìš© ë“±ì— ëŒ€í•´ì„œë„ ê³ ë ¤í•œë‹¤ë©´ ì˜¤íˆë ¤ ë©€í‹° ìŠ¤ë ˆë”©ì´ ì—­íš¨ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ìƒí™©ë„ ë¶„ëª… ìˆì„ ê²ƒì´ë‹¤.ì´ë ‡ë“¯, ë‚´ê°€ ìƒê°í•˜ëŠ” ì‹¤ë ¥ìˆëŠ” ê°œë°œìê°€ ë˜ê¸° ìœ„í•´ì„œëŠ” ëŠì„ì—†ëŠ” ê³ ë¯¼ê³¼ í•™ìŠµì´ í•„ìš”í•˜ë‹¤ê³  ìƒê°í•œë‹¤.ì§€ê¸ˆ í¸í• ìˆ˜ë¡ ë‚˜ì¤‘ì— ê°œë°œìë¡œì„œ ì„¤ ìë¦¬ëŠ” ì ì  ì¤„ì–´ë“ ë‹¤ëŠ” ìƒê°ìœ¼ë¡œ ë˜í•œ IT ì„œë¹„ìŠ¤ë¡œ ì„¸ìƒì— ì¢‹ì€ ì˜í–¥ì„ ë¼ì¹˜ê¸° ìœ„í•´, ê¾¸ì¤€íˆ ê·¸ë¦¬ê³  ì¦ê²ê²Œ ê³µë¶€í•˜ì.ë”ì°í•œ í‰ìƒê³µë¶€ ?ì…ì‚¬ í›„ ì•½ 1ë…„ ì •ë„ ì§€ë‚¬ì„ ë•Œë¶€í„°ì˜€ë‚˜, ì–¸ì œê°€ ë ì§€ëŠ” ëª¨ë¥´ì§€ë§Œ ê°œë°œìì—ê²Œ ì¢‹ì€ íšŒì‚¬ë¡œ ì´ì§í•˜ë ¤ë©´ í‡´ê·¼ í›„ ê³µë¶€ë¥¼ í•´ì•¼ê² ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆë˜ ê²ƒ ê°™ë‹¤.ì–´ë–¤ ê³µë¶€ë¥¼ í•´ì•¼í• ê¹Œ ê³ ë¯¼í•˜ë˜ ì¤‘ ì·¨ì¤€í•  ë•Œ ë§ì€ ë„ì›€ì„ ë°›ì€ ì‡ë‹¤ë¥¼ ì°¾ê²Œë˜ì—ˆê³ , ì—¬ëŸ¬ ë©˜í† ë‹˜ë“¤ê»˜ ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ë¥¼ ì‹œì‘í•´ë³´ë¼ëŠ” ì¡°ì–¸ì„ ë“£ê²Œ ë˜ì—ˆë‹¤.ë”¥ëŸ¬ë‹ì„ í™œìš©í•´ì„œ ìš´ë™í™” ì»¤ìŠ¤í„°ë§ˆì´ì§•ì„ í•´ë³´ë©´ ì¬ë°Œê² ë‹¤ëŠ” ìƒê°ì— GANì— ëŒ€í•´ ê³µë¶€í•´ë³´ì•˜ë‹¤. í•˜ì§€ë§Œ, ì–¼ë§ˆ ì§€ë‚˜ì§€ ì•Šì•„ ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ë¥¼ ë©ˆì·„ë‹¤. ì•¼ê·¼ë„ ë§ê¸´í–ˆì§€ë§Œ ì˜ì§€ë„ ì•½í–ˆë˜ ê²ƒ ê°™ê³ , ì§€ê¸ˆ ìƒê°í•´ë³´ë©´ ê°€ì¥ í° ë¬¸ì œëŠ”ì™€ë‹¿ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì´ì—ˆë˜ ê²ƒ ê°™ë‹¤. ì‰½ê²Œ ë§í•´, ê³µë¶€í•œ ë‚´ìš©ì„ ë‚´ê°€ í˜„ì¬ í•˜ê³ ìˆëŠ” ì‹¤ë¬´ì— ì ìš©í•  ìˆ˜ ìˆëŠ” ê²ƒë„ ì•„ë‹ˆê³  ë¶€ìˆ˜ì…ê³¼ ê°™ì€ ì–´ë–¤ ë¶€ê°€ì ì¸ ê°€ì¹˜ë¥¼ ì°½ì¶œí•´ë‚´ëŠ” ê²ƒì´ ì•„ë‹Œ ì†Œìœ„ ë§í•´ â€˜ê³µë¶€ë¥¼ ìœ„í•œ ê³µë¶€â€™ë¥¼ í•˜ê³  ìˆì—ˆë˜ ê²ƒì´ë‹¤.ì‚¬ì´ë“œ í”„ë¡œì íŠ¸ê°€ íì§€ë¶€ì§€ë˜ê³ ëŠ” ì°°ìŠ¤ í«ì¡¸ë“œì˜ CODEì™€ ê°™ì€ ê°œë°œì í•„ë…ì„œë¼ ë¶ˆë¦¬ëŠ” ì±…ë“¤ì„ ê°„ê°„íˆ ì½ì—ˆë˜ ê²ƒ ê°™ë‹¤.í•˜ì§€ë§Œ ì§€ê¸ˆ ìƒê°í•´ë³´ë©´ ì´ ë˜í•œ ê·¸ëƒ¥ â€˜ê³µë¶€ë¥¼ ì•ˆí•˜ê¸°ëŠ” ì¢€ ë­í•˜ë‹ˆê¹Œâ€™ë¼ëŠ” ìƒê°ì— ë³´ëƒˆë˜ ì‹œê°„ê°™ë‹¤.ì´ëŸ¬í•œ ì‹œê°„ë“¤ì„ í†µí•´ ë‚˜ëŠ” ê³µë¶€ë¥¼ ìœ„í•œ ê³µë¶€ëŠ” í•˜ê¸° í˜ë“¤ì–´í•˜ëŠ” ì„±í–¥ì´ê³  ì´ë ‡ê²Œ í•™ìŠµí•œ ê²ƒì€ ë¨¸ë¦¿ì†ì—ë„ ë§ì´ ë‚¨ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤.ë”°ë¼ì„œ ì§€ê¸ˆì€ ì‹¤ë¬´ì— í•„ìš”í•œ ê³µë¶€, ë‚´ê°€ ë¶€ì¡±í•œ ë¶€ë¶„ì— ëŒ€í•œ ê³µë¶€ ë“± ë‚˜ì—ê²Œ ì™€ë‹¿ëŠ” ê³µë¶€ë¥¼ í•˜ë©´ì„œ ìŠ¤ìŠ¤ë¡œë¥¼ ì¢€ ë” ë™ê¸°ë¶€ì—¬ í•  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.â€˜ê°œë°œìëŠ” í‰ìƒ ê³µë¶€í•´ì•¼í•˜ëŠ” ì§ì—…ì´ë‹¤â€™ë¼ëŠ” ë§ì„ ë§ì´ ë“¤ì—ˆê³  ê³µê°í•˜ëŠ” ë¶€ë¶„ì´ë‹¤.ê·¸ë ‡ê¸° ë•Œë¬¸ì— í‰ìƒì„ ê´´ë¡œì›Œí•˜ë©´ì„œ ê³µë¶€í•˜ê³  ì‹¶ì€ê²Œ ì•„ë‹ˆë¼ë©´ ìì‹ ì—ê²Œ ë§ëŠ” í•™ìŠµ ë°©í–¥ê³¼ ë°©ë²•ì„ ì°¾ëŠ” ê²ƒì€ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•œë‹¤.ì·¨ì¤€ë³´ë‹¤ ê°„ì ˆí–ˆë˜ ì´ì§21ë…„ í•œ í•´ ë‚˜ì—ê²Œ ê°€ì¥ ì¤‘ìš”í–ˆë˜ í‚¤ì›Œë“œ ì¤‘ í•˜ë‚˜ëŠ” ì´ì§ì´ë‹¤. ì´ì§ ì‚¬ìœ ëŠ” ì´ì „ íšŒì‚¬ê°€ ë§ˆìŒì— ë“¤ì§€ ì•Šì•„ì„œê°€ ì•„ë‹ˆì—ˆë‹¤.ê°œë°œ í”„ë¡œì íŠ¸ë¥¼ ë§ˆì¹˜ê³  í•´ë‹¹ ì‹œìŠ¤í…œì„ ìš´ì˜í•˜ë‹¤ë³´ë‹ˆ ê°œë°œí•  ì¼ì€ ê±°ì˜ ì—†ê³ , ê·¸ë ‡ë‹¤ê³  ê¸°ì¡´ì˜ ì½”ë“œë¥¼ ë¦¬íŒ©í† ë§í•˜ë©´ì„œ ì¢‹ì€ ì½”ë“œ í’ˆì§ˆì„ ìœ„í•´ ë…¸ë ¥í•˜ëŠ” ë¶„ìœ„ê¸°ë„ ì•„ë‹ˆì—ˆê¸° ë•Œë¬¸ì—,ê°œë°œìë¡œì„œ ì„±ì¥í•˜ê¸°ì— í•œê³„ê°€ ìˆì„ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ë“¤ì—ˆë‹¤.ë˜í•œ ì‹¤ë ¥ì´ ì—†ìœ¼ë©´ ë¶€ë‹¹í•œ ìƒí™©ì—ì„œë„ ë³¸ì¸ì˜ ì„ íƒê¶Œ ì—†ì´ íšŒì‚¬ê°€ í•˜ë¼ëŠ”ëŒ€ë¡œ í•  ìˆ˜ ë°–ì— ì—†ëŠ” ë§ì€ ìƒí™©ë“¤ì„ ì§€ì¼œë³´ë©° ì‹¤ë ¥ì„ í‚¤ì›Œì•¼ê² ë‹¤ëŠ” ìƒê°ì´ ë”ìš± ì ˆì‹¤í•˜ê²Œ ë“¤ì—ˆë‹¤.ê·¸ë¦¬ê³  í•­ìƒ ë§ˆìŒ í•œì¼ ì—ëŠ” ì¼ë°˜ ì‚¬ìš©ìë¥¼ ëŒ€ìƒìœ¼ë¡œ í•˜ëŠ” ì„œë¹„ìŠ¤(ë‚˜ë„ ì‚¬ìš©í•˜ëŠ”) íšŒì‚¬ì— ê°€ì„œ í”„ë¡œë•íŠ¸ì— ì¢€ ë” ì• ì •ì„ ê°–ê³  ì¼í•˜ê³  ì‹¶ë‹¤ëŠ” ìƒê°ì´ ìˆì—ˆë‹¤. ë”°ë¼ì„œ, ë„¤ì¹´ë¼ì¿ ë°°ê°€ ì•„ë‹ˆë”ë¼ë„ ë°˜ë“œì‹œ IT ì„œë¹„ìŠ¤ íšŒì‚¬ë¥¼ ê°€ì•¼ê² ë‹¤ê³  ìƒê°í–ˆë‹¤.ì‘ë…„ ì´ˆ ê²°í˜¼ì„ í•˜ê³ ë‚˜ì„œë¶€í„° ì´ë ¥ì„œë¥¼ ì‘ì„±í•˜ê³  ì½”ë”©í…ŒìŠ¤íŠ¸ë¥¼ ì¤€ë¹„í•˜ëŠ” ë“± ë³¸ê²©ì ìœ¼ë¡œ ì´ì§ ì¤€ë¹„ë¥¼ ì‹œì‘í–ˆë‹¤. ê·¸ë¦¬ê³  3ì›”ì— ë„¤ì´ë²„ ê³„ì—´ì‚¬ ì¤‘ í•œ ê³³ì˜ ë©´ì ‘ì„ ë³¼ ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.ë‹¨ìˆœíˆ ë¶ˆí•©ê²©ì„ ë„˜ì–´ ê²°ê³¼ëŠ” ì°¸ë‹´í–ˆê³  ê·¸ ë©´ì ‘ì„ í†µí•´ í˜„ì¬ ë‚´ê°€ ì–´ë–¤ ìˆ˜ì¤€ì´ê³  ì–¼ë§ˆë‚˜ ë¶€ì¡±í•œì§€ë¥¼ ìê°í•  ìˆ˜ ìˆì—ˆë‹¤. ê°€ì¥ ë¬¸ì œë¼ê³  ìƒê°ëœ ë¶€ë¶„ì€ ë©´ì ‘ì‹œ ë‚´ê°€ í•œ ë¶€ë¶„ì— ëŒ€í•´ ìì‹ ìˆê²Œ ì–˜ê¸°í• ê²Œ ì—†ì—ˆë‹¤ëŠ” ê²ƒì´ì—ˆë‹¤.ê¸°ìˆ ì— ëŒ€í•œ ê¹Šì€ ì´í•´, ì¢€ ë” ì¢‹ì€ ì½”ë“œ, ë‹¤ì–‘í•œ ë¬¸ì œ í•´ê²° ë°©ë²•ì„ ìƒê°í•˜ë©° ì¼í•˜ì§€ ì•Šê³  ë‹¨ìˆœíˆ êµ¬í˜„í•˜ê¸°ì— ë°”ë¹´ë˜ ë‚˜ì—ê²Œ ì–´ë–»ê²Œ ë³´ë©´ ë‹¹ì—°í•œ ê²°ê³¼ì˜€ë˜ ê²ƒ ê°™ë‹¤.ì „ëµì ìœ¼ë¡œ ì¤€ë¹„í•  í•„ìš”ê°€ ìˆë‹¤ê³  ìƒê°ì´ë“¤ì–´ ì¼ë‹¨ íšŒì‚¬ì— ì§€ì›ì„ í•˜ëŠ” ëŒ€ì‹  ì´ë ¥ì„œì— ì±„ìš¸ ë‚´ìš©ì„ ì°¾ì•„ì•¼ê² ë‹¤ê³  ìƒê°í–ˆë‹¤.ê·¸ë¦¬ê³  ê°€ì¥ ì¢‹ì€ ì»¨í…ì¸ ëŠ” ë‚´ê°€ í˜„ì¬ ìœ ì§€ë³´ìˆ˜ í•˜ê³ ìˆëŠ” ì‹œìŠ¤í…œì˜ ë¬¸ì œì ë“¤ì„ ê°œì„ ì‹œí‚¤ê±°ë‚˜, ìˆì—ˆë˜ ë¬¸ì œë“¤ì„ ì–´ë–»ê²Œ í•´ê²°í–ˆëŠ”ì§€ ë“±ì— ëŒ€í•´ ì •ë¦¬í•˜ê³  ë‹¤ì–‘í•œ í•´ê²° ë°©ë²•ì— ëŒ€í•´ ìƒê°í•´ë³´ëŠ” ê²ƒì´ì—ˆë‹¤.ì„±ëŠ¥ ê°œì„ , í…ŒìŠ¤íŠ¸ ì½”ë“œ ì ìš©, í™•ì¥ì„± ì¢‹ì€ ì½”ë“œ ë“±ì— ëŒ€í•´ í•™ìŠµí•˜ë©° ì‹¤ë¬´ì— ì ìš©í•  ìˆ˜ ìˆì—ˆê³ , ë¶€ì¡±í•¨ì„ ì±„ìš°ê¸° ìœ„í•´ í‡´ê·¼ í›„ ë§¤ì¼ ìƒˆë²½ê¹Œì§€ ê³µë¶€ë¥¼ í–ˆë‹¤.í•˜ì§€ë§Œ, ê³µë¶€ë¥¼ í• ìˆ˜ë¡ â€˜ë‚´ê°€ ëª¨ë¥´ëŠ”ê²Œ ì •ë§ ë§ì•˜êµ¬ë‚˜â€™ë¼ëŠ” ìƒê°ì´ ë“¤ì—ˆê³  ë¶„ëª… ì¡°ê¸ˆì”© ë‚˜ì•„ì§€ê³  ìˆì§€ë§Œ â€˜ë‚´ê°€ ì •ë§ ì„œë¹„ìŠ¤ íšŒì‚¬ì— ê°ˆ ìˆ˜ ìˆì„ê¹Œ?â€™ë¼ëŠ” ë‘ë ¤ì›€ì´ ì—„ìŠµí•´ì˜¤ê¸°ë„ í–ˆë‹¤.ì´ë²ˆì—ë„ ì‡ë‹¤ì—ì„œ ë©˜í† ë‹˜ê»˜ ì¡°ì–¸ì„ êµ¬í–ˆê³ , í•œ ë©˜í† ë‹˜ê»˜ì„œ ëª¨ë“  ë¶€ë¶„ì„ ë‹¤ ì•Œ ìˆ˜ëŠ” ì—†ìœ¼ë‹ˆ ë³¸ì¸ì´ í•œ ë¶€ë¶„ì— ëŒ€í•´ ìì‹ ê°ì„ ê°–ê³  ë„ì „í•´ë³´ëŠ”ê²Œ ì¢‹ì„ ê²ƒ ê°™ë‹¤ê³  í•˜ì…¨ë‹¤.ë‘ë µì§€ë§Œ ë‹¤ì‹œ í•œ ë²ˆ ì´ë ¥ì„œë¥¼ ì¬ì •ë¹„í•˜ê³  ì—¬ëŸ¬ íšŒì‚¬ì— ì§€ì›ì„ í–ˆë‹¤. ì•½ 6ê°œì˜ íšŒì‚¬ì— ì§€ì›í–ˆê³  ê·¸ ì¤‘ 4ê°œ íšŒì‚¬ì— ìµœì¢…ë©´ì ‘ê¹Œì§€ ê°ˆ ìˆ˜ ìˆì—ˆë‹¤.ê²°ê³¼ì ìœ¼ë¡œ 3ê°œì˜ íšŒì‚¬ì— ë¶™ì—ˆê³ , ë‚´ê°€ ì‹¤ì œë¡œ ë§ì´ ì‚¬ìš©í•˜ëŠ” ì„œë¹„ìŠ¤ë¥¼ í•˜ëŠ” íšŒì‚¬ë¡œ ìµœì¢… ì„ íƒì„ í–ˆë‹¤. ë§¤ì¼ ë°¤ì— í˜¼ì ë°©ì—ì„œ ê³µë¶€í•˜ë˜ ì‹œê°„ë“¤ì´ í—›ë˜ì§€ ì•Šì•˜ë˜ ê²ƒ ê°™ì•„ ì •ë§ ê¸°ë»¤ë‹¤.ë¬¼ë¡  ìˆ˜ìŠµ ê¸°ê°„ 3ê°œì›”ì´ ìˆê¸° ë•Œë¬¸ì— ì•„ì§ ì™„ì „íˆ ì •ì°©í•œ ê²ƒì€ ì•„ë‹ˆì§€ë§Œ ëê¹Œì§€ ì¢‹ì€ ê²°ê³¼ê°€ ìˆê¸¸ ë°”ë€ë‹¤.TMIë¡œ íƒˆë½ì˜ ê³ ë°°ë¥¼ ë§ˆì…¨ë˜ ë‚˜ë‚ ë“¤ì„ ì¶”ì–µí•´ë³¸ë‹¤â€¦ ë§ˆë¬´ë¦¬í•˜ë©°í˜„ì¬ ì§ì¥ì— 11ì›” 22ì¼ì— ì…ì‚¬í–ˆìœ¼ë‹ˆ ì˜¨ì§€ ë²Œì¨ í•œ ë‹¬ì´ ë„˜ì—ˆë‹¤. íŒ€ì›ë¶„ë“¤ ëª¨ë‘ ë„ˆë¬´ ì¹œì ˆí•˜ì‹œê³  ì˜í•´ì£¼ì‹ ë‹¤. ì—¬ê¸°ì„œëŠ” ê¹Šê²ŒëŠ” ì•„ë‹ˆë”ë¼ë„ ê¸°ë³¸ì ìœ¼ë¡œ ì¸í”„ë¼ ë¶€ë¶„ê¹Œì§€ ì„œë²„ ê°œë°œìê°€ ë‹´ë‹¹í•˜ê¸° ë•Œë¬¸ì— ë‚¯ì„  ì‘ì—…ë“¤ì´ ë§ë‹¤.ê·¸ë¦¬ê³  ìŠ¤í”„ë§ ê¸°ë³¸ì— ëŒ€í•œ ë¶€ì¡±í•¨ ë˜í•œ ë§ì´ ëŠë¼ê³  ìˆë‹¤. ì ì‘í•˜ëŠ”ê²Œ ì‰½ì§€ëŠ” ì•Šì§€ë§Œ ëª©í‘œí•˜ë˜ ê³³ì— ì˜¨ë§Œí¼, ì—´ì‹¬íˆí•´ì„œ 1ì¸ë¶„ ì´ìƒì˜ ëª«ì„ í•˜ê³  ë” ë‚˜ì•„ê°€ ì„œë¹„ìŠ¤ë¥¼ ë°œì „ì‹œì¼œ ì‚¬ëŒë“¤ì˜ ìƒí™œì— í¸ë¦¬í•¨ì„ ì¤„ ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ë‹¤.ëìœ¼ë¡œ ì•„ë˜ ë¬¸êµ¬ë¥¼ ë§ˆìŒì— ìƒˆê¸°ë©´ì„œ ì´ì „ì²˜ëŸ¼ ì—…ë¬´ê°€ ìµìˆ™í•´ì§„ë‹¤ê³  ì•ˆì£¼í•˜ì§€ ë§ê³ , ë”ìš± ì„±ì¥í•˜ê³  ì˜í•˜ëŠ” ê°œë°œìê°€ ë˜ê¸° ìœ„í•´ ê¾¸ì¤€íˆ ê³µë¶€í•˜ê³  ë…¸ë ¥í•˜ì !If you do nothing, nothing happens." }, { "title": "IE11ì—ì„œ window.open()ì‹œ ë¹ˆíŒì—…ê³¼ ìƒˆë¡œìš´ íƒ­ ìƒê¸°ëŠ” ì´ìŠˆ", "url": "/posts/ie-popup-issue/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "IE11", "date": "2021-12-14 23:00:00 +0900", "snippet": "ìƒí™©ì‚¬ë‚´ì—ì„œ ì‚¬ìš©í•˜ëŠ” í™”ë©´ ì¤‘, ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ window.open(url, target, options)ìœ¼ë¡œ íŒì—…ì„ ë„ìš°ëŠ” ì½”ë“œê°€ ìˆì—ˆë‹¤. í•˜ì§€ë§Œ, ìš”êµ¬ì‚¬í•­ìœ¼ë¡œ ì¸í•´ ê¸°ì¡´ ë¡œì§ì„ POST ìš”ì²­ìœ¼ë¡œ ë³€ê²½í•´ì•¼í–ˆê³  ì´ë¥¼ ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì½”ë“œë¥¼ ë³€ê²½í–ˆë‹¤.const form = document.createElement(\"form\");form.tar...", "content": "ìƒí™©ì‚¬ë‚´ì—ì„œ ì‚¬ìš©í•˜ëŠ” í™”ë©´ ì¤‘, ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ window.open(url, target, options)ìœ¼ë¡œ íŒì—…ì„ ë„ìš°ëŠ” ì½”ë“œê°€ ìˆì—ˆë‹¤. í•˜ì§€ë§Œ, ìš”êµ¬ì‚¬í•­ìœ¼ë¡œ ì¸í•´ ê¸°ì¡´ ë¡œì§ì„ POST ìš”ì²­ìœ¼ë¡œ ë³€ê²½í•´ì•¼í–ˆê³  ì´ë¥¼ ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì½”ë“œë¥¼ ë³€ê²½í–ˆë‹¤.const form = document.createElement(\"form\");form.target=\"child1\";form.method=\"POST\";form.action=\"url\";form.param1=\"param1\";form.param2=\"param2\";window.open(\"\", \"child1\", \"some options\");form.submit();ê°œë°œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ì˜ ë§ˆì¹˜ê³  ìš´ì˜ í™˜ê²½ ì „ë‹¨ê³„ì— ë°°í¬í•´ì„œ í™•ì¸í•´ë³´ëŠ”ë°, ê¸°ì¡´ì— íŒì—…ìœ¼ë¡œ ëœ¨ë˜ í™”ë©´ì´ ìƒˆë¡œìš´ íƒ­ì—ì„œ ì—´ë¦¬ê³  íŒì—…ì°½ì€ ë¹ˆ ìƒíƒœë¡œ ë– ìˆëŠ” í˜„ìƒì´ ë°œìƒí–ˆë‹¤. â€» í…ŒìŠ¤íŠ¸ ë¸Œë¼ìš°ì €ëŠ” IE11ì´ê³  ê°œë°œ PCì™€ ì´ìƒ í˜„ìƒì„ ë°œê²¬í•œ PCëŠ” ë‹¤ë¥¸ PCì´ë‹¤.ì›ì¸ IE11ì˜ íŠ¹ì • ë²„ì „ë“¤ì—ì„œ ì´ëŸ¬í•œ í˜„ìƒì´ ë°œìƒí•˜ëŠ” ê²ƒ ê°™ë‹¤. ì²˜ìŒì—” ë¸Œë¼ìš°ì € ì„¤ì •ë„ ë°”ê¿”ë³´ê³  ë¸Œëœì¹˜ì— ë¨¸ì§€ëœ ë‹¤ë¥¸ ìì›ë“¤ì˜ ì˜í–¥ì¸ì§€ë„ ì‚´í´ë³´ê³  window.open() ìì²´ì— ëŒ€í•´ì„œë„ ì¢€ ë” ì°¾ì•„ë´¤ì§€ë§Œ, ë‹µì´ ë‚˜ì˜¤ì§ˆ ì•Šì•˜ë‹¤. ê·¸ëŸ¬ë‹¤ ë‹¤ìŒ ë‘ ê°œì˜ ê¸€ì„ í†µí•´ IE ë¬¸ì œì¸ ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. ê°™ì€ í˜„ìƒ1 ê°™ì€ í˜„ìƒ2 í…ŒìŠ¤íŠ¸ì‹œ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•œ IE11 ë²„ì „ê³¼ ì•„ë‹Œ ë²„ì „ ëª‡ ê°€ì§€ë¥¼ íŒŒì•…í•´ë´¤ë‹¤. ì •ìƒ ì‘ë™ 20H2(OS ë¹Œë“œ 19042.1348) ë²„ì „ 1909(OS ë¹Œë“œ 18363.1916) ì˜¤ì‘ë™ 20H2(OS ë¹Œë“œ 19042.1288) ì‹œë„í•´ë³¸ ê²ƒë“¤ ë‹¤ë¥¸ ë¸Œë¼ìš°ì €ë¡œ ë°”ê¿€ ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ì§€ë§Œ, í•´ë‹¹ ì‹œìŠ¤í…œì˜ ìš´ì˜ í™˜ê²½ì€ IEì— ìµœì í™” ë˜ì–´ìˆë‹¤..1. IE íƒ­ ì„¤ì • ë°”ê¾¸ê¸° ì¸í„°ë„· ì˜µì…˜ &gt; ì¼ë°˜ &gt; íƒ­ &gt; íŒì—… í‘œì‹œ ë°©ë²• : í•­ìƒ ìƒˆ ì°½ì—ì„œ íŒì—… ì—´ê¸° ì´ë ‡ê²Œ í•˜ë©´ ìƒˆë¡œìš´ íƒ­ì—ì„œ íŒì—…ì°½ì´ ì—´ë¦¬ì§€ëŠ” ì•Šì§€ë§Œ, window.open() 3ë²ˆì§¸ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê²¨ì¤€ width, heightì— ì„¸íŒ…ëœ í¬ê¸°ì™€ëŠ” ë‹¤ë¥¸ íŒì—…ì°½ì´ ìƒê¸°ê³ , ë¹ˆíŒì—…ì°½ ë˜í•œ ê·¸ëŒ€ë¡œ ë‚¨ì•„ìˆë‹¤.2. UAC (ì‚¬ìš©ì ê³„ì • ì»¨íŠ¸ë¡¤) ì„¤ì • ìœ„ì—ì„œ ì–¸ê¸‰í•œ ê¸€ì—ì„œ ì œì‹œí•˜ëŠ” ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ, â€œEnable UACâ€ê°€ ìˆëŠ”ë° ë‚˜ì˜ ê²½ìš°ëŠ” ì´ ë°©ë²•ìœ¼ë¡  í•´ê²°ë˜ì§€ ì•Šì•˜ë‹¤. ë‚´ê°€ ì˜ëª»í•œ ê²ƒì¼ ìˆ˜ë„ ìˆìœ¼ë‹ˆ ì¢€ ë” ì‹œë„í•´ë´ì•¼ë  ê²ƒ ê°™ë‹¤.3. window.open() 3ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì— popup ì¶”ê°€ ì‹œë„ ì˜ˆì •ì°¸ê³  ìë£Œ https://answers.microsoft.com/en-us/ie/forum/all/open-new-popup-window-getting-a-blank-page-and-it/bab61949-2327-474d-b001-8f9f33562988 https://support.citrix.com/article/CTX206419" }, { "title": "maven-default-http-blocker ... Blocked mirror for repositories ì—ëŸ¬", "url": "/posts/maven-http-block-issue/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "Maven, HTTP Block", "date": "2021-12-08 23:00:00 +0900", "snippet": "ìƒí™©íšŒì‚¬ì—ì„œ ì§€ê¸‰ë°›ì€ ì„ì‹œ PCë¥¼ 2ì£¼ ì •ë„ ì‚¬ìš©í•˜ê³ , ì•ìœ¼ë¡œ ê³„ì† ì‚¬ìš©í•˜ê²Œë  ìƒˆë¡œìš´ PCë¥¼ ì§€ê¸‰ë°›ì•„ ê°œë°œ í™˜ê²½ì„ ë‹¤ì‹œ ì„¸íŒ…í•˜ê³  ìˆì—ˆë‹¤.í•˜ì§€ë§Œ, ì„¸íŒ…í•˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œ ì˜ì¡´ì„±ì„ ì œëŒ€ë¡œ ë‹¤ìš´ë¡œë“œ ë°›ì§€ ëª»í•˜ê³  ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í–ˆë‹¤. Could not transfer artifact ... from/to maven-default-http-blo...", "content": "ìƒí™©íšŒì‚¬ì—ì„œ ì§€ê¸‰ë°›ì€ ì„ì‹œ PCë¥¼ 2ì£¼ ì •ë„ ì‚¬ìš©í•˜ê³ , ì•ìœ¼ë¡œ ê³„ì† ì‚¬ìš©í•˜ê²Œë  ìƒˆë¡œìš´ PCë¥¼ ì§€ê¸‰ë°›ì•„ ê°œë°œ í™˜ê²½ì„ ë‹¤ì‹œ ì„¸íŒ…í•˜ê³  ìˆì—ˆë‹¤.í•˜ì§€ë§Œ, ì„¸íŒ…í•˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œ ì˜ì¡´ì„±ì„ ì œëŒ€ë¡œ ë‹¤ìš´ë¡œë“œ ë°›ì§€ ëª»í•˜ê³  ë‹¤ìŒê³¼ ê°™ì€ ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í–ˆë‹¤. Could not transfer artifact ... from/to maven-default-http-blocker (http://0.0.0.0/): Blocked mirror for repositoriesì›ì¸ Maven 3.8.1 ë²„ì „ë¶€í„° repositoryì— ëŒ€í•œ HTTP ìš”ì²­ì´ ì°¨ë‹¨ë˜ê³  HTTPSë§Œ í—ˆìš©ëœë‹¤. (3.8.1 ë²„ì „ ë¦´ë¦¬ì¦ˆ ë…¸íŠ¸ ì°¸ê³ )í•˜ì§€ë§Œ, ë‚˜ëŠ” ë©”ì´ë¸ 3.8.1 ë²„ì „ì„ ë”°ë¡œ ì„¤ì¹˜í•œ ì ì´ ì—†ëŠ”ë° â€¦ ? IntelliJë¥¼ ì„¤ì¹˜í•  ë•Œ ë©”ì´ë¸ì€ í”ŒëŸ¬ê·¸ì¸ìœ¼ë¡œ í•¨ê»˜ ì„¤ì¹˜ëœë‹¤. IntelliJ ë‹¤ìš´ë¡œë“œ í˜ì´ì§€ì— ê°€ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ê¸°ë³¸ì ìœ¼ë¡œ ì„¤ì¹˜ë˜ëŠ” í”ŒëŸ¬ê·¸ì¸ë“¤ì„ ì‚´í´ë³¼ ìˆ˜ ìˆë‹¤. ì´ì „ PCì™€ ìƒˆë¡œìš´ PC ëª¨ë‘ IntelliJ IDEA 2021.3 ë²„ì „ì¸ë°, ì´ì „ PCì˜ ê²½ìš° í•¨ê»˜ ì„¤ì¹˜ëœ ë©”ì´ë¸ ë²„ì „ì€ 3.6.3ì´ì—ˆë‹¤.3.6.3 ë²„ì „ê³¼ 3.8.1 ë²„ì „ì˜ settings.xml ë¹„êµí•´ë³´ê¸° IntelliJ ì„¤ì¹˜ì‹œ í•¨ê»˜ ì„¸íŒ…ë˜ëŠ” ë©”ì´ë¸ì˜ settings.xml íŒŒì¼ ê²½ë¡œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. MacOS : /Applications/IntelliJ IDEA.app/Contents/plugins/maven/lib/maven3/conf/settings.xml Windows : IntelliJ ì„¤ì¹˜ ê²½ë¡œ\\plugins\\maven\\lib\\maven3\\conf\\settings.xml 3.6.3 ë²„ì „ 3.8.1 ë²„ì „ (&lt;mirror&gt; ì†ì„±ì´ ì¶”ê°€ëœê±¸ ë³¼ ìˆ˜ ìˆë‹¤) &lt;mirror&gt;ë€ ? ë²”ìš©ì ìœ¼ë¡œ ì“°ì´ëŠ” â€˜ë¯¸ëŸ¬â€™ì— ëŒ€í•œ ìœ„í‚¤ ì„¤ëª…ì„ ë³´ë©´ ë¯¸ëŸ¬ ì‚¬ì´íŠ¸ëŠ” ë‹¤ë¥¸ ì¸í„°ë„· ì‚¬ì´íŠ¸ì˜ ë³µì‚¬ë³¸ì´ë‹¤. ë¼ê³  ë‚˜ì™€ìˆë‹¤.settings.xmlì— ìˆëŠ” &lt;mirror&gt;ë„ ì´ëŸ¬í•œ ê°œë…ìœ¼ë¡œ ì´í•´í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.ì¦‰, pom.xmlì— ì •ì˜ëœ ì˜ì¡´ì„±ë“¤ì„ ë‚´ë ¤ë°›ê¸° ìœ„í•´ íŠ¹ì • repositoryë¡œ ìš”ì²­ì‹œ, í•´ë‹¹ repository ëŒ€ì‹  ìš”ì²­ë°›ì„ mirror repositoryë¥¼ ì •ì˜í•˜ëŠ” ê²ƒì´ë‹¤. &lt;mirrorOf&gt;ì— ì •ì˜ëœ repository(central)ë¡œ ìš”ì²­í•˜ë©´ &lt;url&gt;ì— ì •ì˜ëœ repositoryë¡œ ìš”ì²­ì´ ê°€ê²Œëœë‹¤. centralì´ ì–´ë””ì— ì •ì˜ë˜ì–´ ìˆëŠ”ì§€ëŠ” í•´ë‹¹ ë¬¸ì„œì˜ Super POM ì°¸ì¡°. &lt;settings&gt; ... &lt;mirrors&gt; &lt;mirror&gt; &lt;id&gt;other-mirror&lt;/id&gt; &lt;name&gt;Other Mirror Repository&lt;/name&gt; &lt;url&gt;https://other-mirror.repo.other-company.com/maven2&lt;/url&gt; &lt;mirrorOf&gt;central&lt;/mirrorOf&gt; &lt;/mirror&gt; &lt;/mirrors&gt; ...&lt;/settings&gt; ê³µì‹ ë¬¸ì„œì—ì„œëŠ” mirrorë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì— ëŒ€í•´ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ëª…í•œë‹¤. ì§€ë¦¬ì ìœ¼ë¡œ ë” ê°€ê¹ê³  ë” ë¹ ë¥¸ ë™ê¸°í™”ëœ ë¯¸ëŸ¬ê°€ ì¸í„°ë„·ì— ìˆì„ ë•Œ íŠ¹ì • ë¦¬í¬ì§€í† ë¦¬ë¥¼ ìì²´ ë‚´ë¶€ ë¦¬í¬ì§€í† ë¦¬ë¡œ ë°”ê¾¸ë ¤ê³  í•  ë•Œ ë¦¬í¬ì§€í† ë¦¬ ê´€ë¦¬ìë¥¼ ì‹¤í–‰í•˜ì—¬ ë¯¸ëŸ¬ì— ë¡œì»¬ ìºì‹œë¥¼ ì œê³µí•˜ê³  ë¯¸ëŸ¬ì˜ URLì„ ëŒ€ì‹  ì‚¬ìš©í•  ë•Œ &lt;mirrorOf&gt;ì— ë‹¤ìŒê³¼ ê°™ì´ ì„¸íŒ…í•  ìˆ˜ ìˆë‹¤. * = ëª¨ë“  ë ˆíŒŒì§€í† ë¦¬ external:* = localhostë‚˜ íŒŒì¼ ê¸°ë°˜ ì´ì™¸ì˜ ë ˆíŒŒì§€í† ë¦¬ ìœ„ì—ì„œ ë³¸ settings.xmlì—ì„œ ì•Œ ìˆ˜ ìˆë“¯, 3.8.1ë¶€í„° external:http:*ê°€ ì ìš©ëë‹¤. ì¦‰, external:http:*ëŠ” localhostë¥¼ ì‚¬ìš©í•˜ëŠ” ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì œì™¸í•œ HTTPë¥¼ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ë¦¬í¬ì§€í† ë¦¬ë¥¼ ì˜ë¯¸í•œë‹¤. ì—¬ê¸°ì— &lt;blocked&gt;true&lt;/blocked&gt;ì™€ ê°™ì€ ì†ì„±ì´ ë”í•´ì ¸ HTTP ìš”ì²­ì„ ì°¨ë‹¨í•œë‹¤. ë§¨ ì²˜ìŒì— ì–¸ê¸‰í–ˆë˜, Maven 3.8.1 ë²„ì „ë¶€í„° HTTP ìš”ì²­ì´ ì°¨ë‹¨ë˜ëŠ” ì´ìœ ì´ë‹¤. repo,repo1 = repo, repo1 (ì—¬ëŸ¬ ë ˆíŒŒì§€í† ë¦¬ ì •ì˜ì‹œ) *,!repo1 = repo1ì„ ì œì™¸í•œ ëª¨ë“  ë ˆíŒŒì§€í† ë¦¬ í•´ê²° ë°©ë²• ê³µì‹ ë¬¸ì„œì— ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ í•´ê²°ì±…ì„ ì œì‹œí•œë‹¤. upgrade the dependency version to a newer version that replaced the obsolete HTTP repository URL with a HTTPS one keep the dependency version but define a mirror in your settings. ë‘ ë°©ë²•ì— ëŒ€í•´ ì•Œì•„ë³´ê³  ì •í™•íˆ ì´í•´í•˜ê¸°ì—ëŠ” ì‹œê°„ì´ ê±¸ë¦´ ê²ƒ ê°™ì•„ ì¼ë‹¨ 3.6.3 ë²„ì „ì„ ì„¤ì¹˜í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” ë°©ì‹ì„ ì„ íƒí–ˆë‹¤.Maven 3.6.3 ë²„ì „ ì ìš© ê¹”ë”í•˜ê²Œ ëª¨ë“  ì˜ì¡´ì„±ì´ ë‹¤ìš´ë¡œë“œ ë˜ì—ˆë‹¤.ì°¸ê³  ìë£Œ https://stackoverflow.com/questions/36757902/what-is-mirror-in-maven-settings-xml-file https://maven.apache.org/guides/mini/guide-multiple-repositories.html https://maven.apache.org/guides/mini/guide-mirror-settings.html" }, { "title": "IEì—ì„œ ì‘ë™í•˜ì§€ ì•ŠëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì½”ë“œ", "url": "/posts/ie-doesnt-support-issue/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "Internet Explorer, ES6", "date": "2021-12-06 23:00:00 +0900", "snippet": "ìƒí™©íšŒì‚¬ì—ì„œ ë§¡ì€ ì‘ì—…ì„ ë¡œì»¬ í™˜ê²½ì—ì„œ ê°œë°œ/í…ŒìŠ¤íŠ¸í•˜ê³  ê°œë°œ í™˜ê²½ì— ë°°í¬í•˜ì—¬ ì˜ ë™ì‘í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•´ë´¤ë‹¤. ë¡œì»¬ì—ì„œ ì—¬ëŸ¬ ë²ˆì˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë³„ì´ìƒ ì—†ì—ˆê¸° ë•Œë¬¸ì— ë‹¹ì—°íˆ ë˜ê² ì§€í•˜ê³  â€˜ì¡°íšŒâ€™ ë²„íŠ¼ì„ ëˆ„ë¥´ëŠ”ë° ì•„ë¬´ëŸ° ë°˜ì‘ì´ ì—†ì—ˆë‹¤â€¦ IE ê°œë°œì ë„êµ¬ë¥¼ í†µí•´ ì½˜ì†”ì„ í™•ì¸í•´ë³´ë‹ˆ, ì„œë²„ì—ì„œ ì‘ë‹µë°›ì€ js íŒŒì¼ ì¤‘ í•˜ë‚˜ì—ì„œ SCRIPT1004: ';'ê°€ í•„ìš”í•©ë‹ˆë‹¤....", "content": "ìƒí™©íšŒì‚¬ì—ì„œ ë§¡ì€ ì‘ì—…ì„ ë¡œì»¬ í™˜ê²½ì—ì„œ ê°œë°œ/í…ŒìŠ¤íŠ¸í•˜ê³  ê°œë°œ í™˜ê²½ì— ë°°í¬í•˜ì—¬ ì˜ ë™ì‘í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸í•´ë´¤ë‹¤. ë¡œì»¬ì—ì„œ ì—¬ëŸ¬ ë²ˆì˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë³„ì´ìƒ ì—†ì—ˆê¸° ë•Œë¬¸ì— ë‹¹ì—°íˆ ë˜ê² ì§€í•˜ê³  â€˜ì¡°íšŒâ€™ ë²„íŠ¼ì„ ëˆ„ë¥´ëŠ”ë° ì•„ë¬´ëŸ° ë°˜ì‘ì´ ì—†ì—ˆë‹¤â€¦ IE ê°œë°œì ë„êµ¬ë¥¼ í†µí•´ ì½˜ì†”ì„ í™•ì¸í•´ë³´ë‹ˆ, ì„œë²„ì—ì„œ ì‘ë‹µë°›ì€ js íŒŒì¼ ì¤‘ í•˜ë‚˜ì—ì„œ SCRIPT1004: ';'ê°€ í•„ìš”í•©ë‹ˆë‹¤.ë¼ëŠ” ì—ëŸ¬ ë©”ì‹œì§€ë¥¼ ìœ ë°œí–ˆë‹¤. ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ë‚˜ë‹ˆ ì½˜ì†” ì°½ì—ì„œ ë˜ ë‹¤ë¥¸ ì—ëŸ¬ ë©”ì„¸ì§€ì¸ ê°œì²´ê°€ 'replaceAll' ì†ì„±ì´ë‚˜ ë©”ì„œë“œë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.ë¥¼ ë§ë‹¥ë“¤ì˜€ë‹¤.ì›ì¸ ë‘ ì—ëŸ¬ ë©”ì‹œì§€ ëª¨ë‘ IEì—ì„œ ì§€ì›í•˜ì§€ ì•ŠëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ê¸°ëŠ¥ì„ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— ë°œìƒí–ˆë‹¤. (ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” í¬ë¡¬ìœ¼ë¡œë§Œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ì„œ ì´ìƒì´ ì—†ì—ˆë˜ ê²ƒì´ì—ˆë‹¤â€¦) ë‹¤ìŒì€ for ... ofì— ëŒ€í•œ ë¸Œë¼ìš°ì € í˜¸í™˜ì„±ì„ ë‚˜íƒ€ë‚¸ í‘œì´ë‹¤. ì¶œì²˜ : https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of#browser_compatibility ë‹¤ìŒì€ replaceAllì— ëŒ€í•œ ë¸Œë¼ìš°ì € í˜¸í™˜ì„±ì„ ë‚˜íƒ€ë‚¸ í‘œì´ë‹¤. ì¶œì²˜ : https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replaceAll í•´ë‹¹ ì‚¬ì´íŠ¸ì— ê°€ë³´ë©´ ES6ë¶€í„°ëŠ” IE11ì—ì„œë§Œ ë¶€ë¶„ ì§€ì›ì´ë¼ê³  í•˜ëŠ”ë° ì´ë§ˆì €ë„ const, let ë“±ì˜ í‚¤ì›Œë“œ Map, Set ì •ë„ì¸ ê²ƒ ê°™ë‹¤. w3cschoolì—ëŠ” Internet Explorer does not support ECMAScript 2015.ë¼ê³  ë˜ì–´ìˆë‹¤.í•´ê²° ë°©ë²• Babelê³¼ ê°™ì€ íŠ¸ëœìŠ¤ì»´íŒŒì¼ëŸ¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ë„ ìˆê² ì§€ë§Œ, í•™ìŠµì´ ë¶€ì¡±í•˜ë¯€ë¡œ ì¼ë‹¨ ë¬¸ë²•ì ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì— ëŒ€í•´ ì‚´í´ë³´ì. (ê·¸ëƒ¥ IEë¥¼ ë²„ë¦¬ì. )for â€¦ of ëŒ€ì‹  for â€¦ in ì‚¬ìš© Before for(const order of orders) { ...} After for(const idx in orders) { const order = orders[idx]; ...} replaceAll ëŒ€ì‹  replace í•¨ìˆ˜ì™€ ì •ê·œ í‘œí˜„ì‹ ì‚¬ìš© Before const price = value.replaceAll(',', ''); // \"10,000,000\" -&gt; 10000000 After const price = value.replace(/,/gi, ''); // \"10,000,000\" -&gt; 10000000 â€» í•´ë‹¹ ì‚¬ì´íŠ¸ì—ì„œ ì•„ë˜ì™€ ê°™ì´ íŠ¹ì • ê¸°ëŠ¥ì— ëŒ€í•œ ë¸Œë¼ìš°ì € í˜¸í™˜ì„±ì— ëŒ€í•´ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤. ì¶œì²˜ : https://caniuse.com/ ì°¸ê³  ìë£Œ https://caniuse.com/ https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replaceAll https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/forâ€¦of#browser_compatibility" }, { "title": "ìŠ¤í”„ë§ ë°°ì¹˜ í•µì‹¬ ê°œë… ì‚´í´ë³´ê¸°", "url": "/posts/spring-batch-domain-language/", "categories": "", "tags": "", "date": "2021-11-23 22:25:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „í•´ë‹¹ ê¸€ì€ ìŠ¤í”„ë§ ë°°ì¹˜ ê³µì‹ ë¬¸ì„œì˜ ë‚´ìš©ì„ ê³µë¶€í•˜ë©´ì„œ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤.ì¼ë°˜ì ì¸ ë°°ì¹˜ êµ¬ì¡° ì•„ë˜ ë‹¤ì´ì–´ê·¸ë¨ì€ ìˆ˜ì‹­ ë…„ ë™ì•ˆ ì‚¬ìš©ëœ ë°°ì¹˜ ì°¸ì¡° ì•„í‚¤í…ì²˜ë¥¼ ë‹¨ìˆœí•˜ê²Œ í‘œí˜„í•œ ê²ƒìœ¼ë¡œ, ë°°ì¹˜ ì²˜ë¦¬ì— í•„ìš”í•œ êµ¬ì„± ìš”ì†Œì˜ ê°œìš”ë¥¼ ë³´ì—¬ì¤€ë‹¤. Jobì—ëŠ” í•˜ë‚˜ì˜ ë‹¨ê³„ë¶€í„° ì—¬ëŸ¬ ë‹¨ê³„ê°€ ìˆìœ¼ë©°, ê° ë‹¨ê³„ì—ëŠ” í•˜ë‚˜ì˜ ItemReader, ItemProcessor...", "content": "ë“¤ì–´ê°€ê¸° ì „í•´ë‹¹ ê¸€ì€ ìŠ¤í”„ë§ ë°°ì¹˜ ê³µì‹ ë¬¸ì„œì˜ ë‚´ìš©ì„ ê³µë¶€í•˜ë©´ì„œ ì •ë¦¬í•œ ê¸€ì…ë‹ˆë‹¤.ì¼ë°˜ì ì¸ ë°°ì¹˜ êµ¬ì¡° ì•„ë˜ ë‹¤ì´ì–´ê·¸ë¨ì€ ìˆ˜ì‹­ ë…„ ë™ì•ˆ ì‚¬ìš©ëœ ë°°ì¹˜ ì°¸ì¡° ì•„í‚¤í…ì²˜ë¥¼ ë‹¨ìˆœí•˜ê²Œ í‘œí˜„í•œ ê²ƒìœ¼ë¡œ, ë°°ì¹˜ ì²˜ë¦¬ì— í•„ìš”í•œ êµ¬ì„± ìš”ì†Œì˜ ê°œìš”ë¥¼ ë³´ì—¬ì¤€ë‹¤. Jobì—ëŠ” í•˜ë‚˜ì˜ ë‹¨ê³„ë¶€í„° ì—¬ëŸ¬ ë‹¨ê³„ê°€ ìˆìœ¼ë©°, ê° ë‹¨ê³„ì—ëŠ” í•˜ë‚˜ì˜ ItemReader, ItemProcessor, ItemWriterê°€ ìˆë‹¤. JobLauncherë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì—…ì„ ì‹œì‘í•˜ê³ , í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ë©”íƒ€ë°ì´í„°ë¥¼ JobRepositoryì— ì €ì¥í•´ì•¼ í•œë‹¤.Job Jobì€ ì „ì²´ ë°°ì¹˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ìº¡ìŠí™”í•˜ëŠ” ì—”í‹°í‹°ì´ë‹¤. ë‹¤ë¥¸ Spring í”„ë¡œì íŠ¸ì™€ ë§ˆì°¬ê°€ì§€ë¡œ Jobì€ XML êµ¬ì„± íŒŒì¼ ë˜ëŠ” Java ê¸°ë°˜ êµ¬ì„±ê³¼ í•¨ê»˜ ì—°ê²°ëœë‹¤. Jobì€ ë‹¤ìŒ ë‹¤ì´ì–´ê·¸ë¨ê³¼ ê°™ì´ ì „ì²´ ê³„ì¸µì˜ ë§¨ ìœ„ì— ìˆë‹¤. Jobì€ Step ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìœ„í•œ ì»¨í…Œì´ë„ˆ ì—­í• ì„ í•œë‹¤. ì¦‰, ë…¼ë¦¬ì ìœ¼ë¡œ í•¨ê»˜ ì†í•˜ëŠ” ì—¬ëŸ¬ Stepì„ ê²°í•©í•˜ê³  â€˜ì¬ì‹œì‘ ê°€ëŠ¥ì„±â€™ê³¼ ê°™ì€ ëª¨ë“  ë‹¨ê³„ì— ëŒ€í•œ ì†ì„±ì„ ì „ì²´ì ìœ¼ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. Jobì— ëŒ€í•œ ì†ì„±ì—ëŠ” ë‹¤ìŒì´ í¬í•¨ëœë‹¤. Jobì˜ ê°„ë‹¨í•œ ì´ë¦„ Step ì¸ìŠ¤í„´ìŠ¤ì˜ ì •ì˜ ë° ìˆœì„œ Jobì„ ì¬ì‹œì‘í•  ìˆ˜ ìˆëŠ”ì§€ ì—¬ë¶€ Java êµ¬ì„±ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, Spring BatchëŠ” Job ì¸í„°í˜ì´ìŠ¤ ìœ„ì— ì¼ë¶€ í‘œì¤€ ê¸°ëŠ¥ì„ ë”í•œ SimpleJob í´ë˜ìŠ¤ í˜•íƒœë¡œ ì œê³µí•œë‹¤.package org.springframework.batch.core;import org.springframework.lang.Nullable;public interface Job { String getName(); boolean isRestartable(); void execute(JobExecution var1); @Nullable JobParametersIncrementer getJobParametersIncrementer(); JobParametersValidator getJobParametersValidator();}package org.springframework.batch.core.job;public class SimpleJob extends AbstractJob { private List&lt;Step&gt; steps; public SimpleJob() { this((String)null); } public SimpleJob(String name) { super(name); this.steps = new ArrayList(); } public void setSteps(List&lt;Step&gt; steps) { this.steps.clear(); this.steps.addAll(steps); } public Collection&lt;String&gt; getStepNames() { List&lt;String&gt; names = new ArrayList(); Iterator var2 = this.steps.iterator(); while(var2.hasNext()) { Step step = (Step)var2.next(); names.add(step.getName()); if (step instanceof StepLocator) { names.addAll(((StepLocator)step).getStepNames()); } } return names; } public void addStep(Step step) { this.steps.add(step); } public Step getStep(String stepName) { Iterator var2 = this.steps.iterator(); while(var2.hasNext()) { Step step = (Step)var2.next(); if (step.getName().equals(stepName)) { return step; } if (step instanceof StepLocator) { Step result = ((StepLocator)step).getStep(stepName); if (result != null) { return result; } } } return null; } protected void doExecute(JobExecution execution) throws JobInterruptedException, JobRestartException, StartLimitExceededException { StepExecution stepExecution = null; Iterator var3 = this.steps.iterator(); while(var3.hasNext()) { Step step = (Step)var3.next(); stepExecution = this.handleStep(step, execution); if (stepExecution.getStatus() != BatchStatus.COMPLETED) { break; } } if (stepExecution != null) { if (logger.isDebugEnabled()) { logger.debug(\"Upgrading JobExecution status: \" + stepExecution); } execution.upgradeStatus(stepExecution.getStatus()); execution.setExitStatus(stepExecution.getExitStatus()); } }} ìë°” ê¸°ë°˜ êµ¬ì„±ì„ ì‚¬ìš©í•  ë•Œ, ì•„ë˜ì˜ ì˜ˆì™€ ê°™ì´ Jobì˜ ì¸ìŠ¤í„´ìŠ¤í™”ì— ë¹Œë” ì»¬ë ‰ì…˜ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.@Beanpublic Job footballJob() { return this.jobBuilderFactory.get(\"footballJob\") .start(playerLoad()) .next(gameLoad()) .next(playerSummarization()) .build();}@Beanpublic Job importUserJob(JobCompletionNotificationListener listener, Step step1) { return jobBuilderFactory.get(\"importUserJob\") .incrementer(new RunIdIncrementer()) .listener(listener) .flow(step1) .end() .build();}JobInstance JobInstanceëŠ” ë…¼ë¦¬ì  ì‘ì—… ì‹¤í–‰ ë‹¨ìœ„ì´ë‹¤. ìœ„ì—ì„œ ì‚´í´ë³¸ ë‹¤ì´ì–´ê·¸ë¨ì˜ â€˜EndOfDayâ€™ ì‘ì—…ê³¼ ê°™ì´ í•˜ë£¨ê°€ ëë‚  ë•Œ í•œ ë²ˆ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” ë°°ì¹˜ ì‘ì—…ì„ ìƒê°í•´ë³´ì. â€˜EndOfDayâ€™ ì‘ì—…ì´ í•˜ë‚˜ ìˆì§€ë§Œ ê° ì‘ì—… ì‹¤í–‰ì€ ê°œë³„ì ìœ¼ë¡œ ì¶”ì í•´ì•¼ í•œë‹¤. ì´ëŸ¬í•œ ê²½ìš°, í•˜ë£¨ì— í•˜ë‚˜ì˜ ë…¼ë¦¬ì  JobInstanceê°€ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ 1ì›” 1ì¼ ì‹¤í–‰, 1ì›” 2ì¼ ì‹¤í–‰ ë“±ì´ ìˆë‹¤. 1ì›” 1ì¼ ì‹¤í–‰ì´ ì²˜ìŒì— ì‹¤íŒ¨í•˜ê³  ë‹¤ìŒë‚  ë‹¤ì‹œ ì‹¤í–‰ë˜ë”ë¼ë„ ì—¬ì „íˆ 1ì›” 1ì¼ ì‹¤í–‰ì´ë‹¤.(ë³´í†µ 1ì›” 1ì¼ ì‹¤í–‰ì´ 1ì›” 1ì¼ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•œë‹¤ëŠ” ì˜ë¯¸). ë”°ë¼ì„œ ê° JobInstanceëŠ” ì—¬ëŸ¬ ë²ˆì˜ ì‹¤í–‰ì„ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©°, íŠ¹ì • JobParametersë¥¼ ì‹ë³„í•˜ëŠ” JobInstance í•˜ë‚˜ë§Œ í•œ ë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. JobInstanceëŠ” ë¡œë“œí•  ë°ì´í„°ì™€ ì „í˜€ ê´€ë ¨ì´ ì—†ë‹¤. ë°ì´í„°ê°€ ë¡œë“œë˜ëŠ” ë°©ë²•ì„ ê²°ì •í•˜ëŠ” ê²ƒì€ ì „ì ìœ¼ë¡œ ItemReader êµ¬í˜„ì— ë‹¬ë ¤ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ EndOfDay ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” ë°ì´í„°ì— ë°ì´í„°ê°€ ì†í•œ â€˜ìœ íš¨ ë‚ ì§œâ€™ ë˜ëŠ” â€˜ì˜ˆì•½ ë‚ ì§œâ€™ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì»¬ëŸ¼ì´ ìˆì„ ìˆ˜ ìˆë‹¤. ìœ„ ì¼€ì´ìŠ¤ì˜ ê²½ìš°, 1ì›” 1ì¼ ëŸ°ì€ 1ì›” 1ì¼ ë°ì´í„°ë§Œ ë¡œë“œí•˜ê³  1ì›” 2ì¼ ëŸ°ì€ 2ì¼ ë°ì´í„°ë§Œ ë¡œë“œí•œë‹¤. ì´ëŸ¬í•œ ê²°ì •ì€ ë¹„ì¦ˆë‹ˆìŠ¤ ê´€ì ì—ì„œì˜ ê²°ì •ì¼ ê°€ëŠ¥ì„±ì´ ë†’ê¸° ë•Œë¬¸ì—, ItemReaderì˜ êµ¬í˜„ì— ë‹¬ë ¤ ìˆë‹¤. ë™ì¼í•œ JobInstanceë¥¼ ì‚¬ìš©í•˜ë©´ ì´ì „ ì‹¤í–‰ì˜ â€˜ìƒíƒœâ€™(ExecutionContext)ê°€ ì‚¬ìš©ë˜ëŠ”ì§€ ì—¬ë¶€ê°€ ê²°ì •ëœë‹¤. ìƒˆë¡œìš´ JobInstanceë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ â€˜ì²˜ìŒë¶€í„° ì‹œì‘â€™ì„ ì˜ë¯¸í•˜ë©°, ê¸°ì¡´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì€ ì¼ë°˜ì ìœ¼ë¡œ â€˜ë©ˆì¶˜ ê³³ë¶€í„° ì‹œì‘â€™ì„ ì˜ë¯¸í•œë‹¤.JobParameters" }, { "title": "ë„ë©”ì¸ ëª¨ë¸ê³¼ ìœ ìŠ¤ì¼€ì´ìŠ¤", "url": "/posts/use-case-and-domain-model/", "categories": "", "tags": "", "date": "2021-10-31 23:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ì§€ê¸ˆê¹Œì§€ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ ë•Œ, ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ í•´ë†“ì€ ì„¤ê³„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ê±°ë‚˜ ê·¸ëƒ¥ ì£¼ë¨¹êµ¬êµ¬ì‹ìœ¼ë¡œ í•„ìš”í•  ê²ƒ ê°™ì€ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê³  ê·¸ ì•ˆì— ì†ì„±, ê¸°ëŠ¥ì´ ë¬´ì—‡ì¼ì§€ ìƒê°í–ˆë˜ ê²ƒ ê°™ë‹¤.ã€ê°ì²´ì§€í–¥ì˜ ì‚¬ì‹¤ê³¼ ì˜¤í•´ã€ë¥¼ ì½ë‹¤ë³´ë‹ˆ ë„ë©”ì¸ ëª¨ë¸ê³¼ ìœ ìŠ¤ì¼€ì´ìŠ¤ë¼ëŠ” ê°œë…ì´ ë‚˜ì˜¤ëŠ”ë°, ì• í”Œë¦¬ì¼€ì´ì…˜ ì œëŒ€ë¡œ ì„¤ê³„í•˜ë ¤ë©´ ê¼­ ì•Œê³ ìˆì–´ì•¼í•˜ëŠ” ê°œë…ì¸ ê²ƒ ê°™ì•„ ì •ë¦¬í•´ë³´ë ¤...", "content": "ë“¤ì–´ê°€ê¸° ì „ì§€ê¸ˆê¹Œì§€ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë§Œë“¤ ë•Œ, ë‹¤ë¥¸ ì‚¬ëŒë“¤ì´ í•´ë†“ì€ ì„¤ê³„ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ê±°ë‚˜ ê·¸ëƒ¥ ì£¼ë¨¹êµ¬êµ¬ì‹ìœ¼ë¡œ í•„ìš”í•  ê²ƒ ê°™ì€ í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ê³  ê·¸ ì•ˆì— ì†ì„±, ê¸°ëŠ¥ì´ ë¬´ì—‡ì¼ì§€ ìƒê°í–ˆë˜ ê²ƒ ê°™ë‹¤.ã€ê°ì²´ì§€í–¥ì˜ ì‚¬ì‹¤ê³¼ ì˜¤í•´ã€ë¥¼ ì½ë‹¤ë³´ë‹ˆ ë„ë©”ì¸ ëª¨ë¸ê³¼ ìœ ìŠ¤ì¼€ì´ìŠ¤ë¼ëŠ” ê°œë…ì´ ë‚˜ì˜¤ëŠ”ë°, ì• í”Œë¦¬ì¼€ì´ì…˜ ì œëŒ€ë¡œ ì„¤ê³„í•˜ë ¤ë©´ ê¼­ ì•Œê³ ìˆì–´ì•¼í•˜ëŠ” ê°œë…ì¸ ê²ƒ ê°™ì•„ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.ë„ë©”ì¸ ëª¨ë¸ ì‹œìŠ¤í…œì„ â€˜ê¸°ëŠ¥â€™ê³¼ â€˜êµ¬ì¡°â€™ì˜ ê´€ì ì—ì„œ ìƒê°í–ˆì„ ë•Œ, ë„ë©”ì¸ ëª¨ë¸ì€ ì‹œìŠ¤í…œì˜ êµ¬ì¡°ë¥¼ í‘œí˜„í•˜ê¸° ìœ„í•œ ìˆ˜ë‹¨ì´ë‹¤.ë„ë©”ì¸ì´ë€ â€˜ì‚¬ìš©ìê°€ í”„ë¡œê·¸ë¨ì„ ì‚¬ìš©í•˜ëŠ” ëŒ€ìƒ ë¶„ì•¼â€™ë¥¼ ì˜ë¯¸í•œë‹¤. ë„ë©”ì¸ì˜ ì‰¬ìš´ ì˜ˆë¡œ ê¸ˆìœµ, ê²Œì„, ì‡¼í•‘ ë“±ì´ ìˆì„ ê²ƒì´ë‹¤.ë„ë©”ì¸ ëª¨ë¸ = ë„ë©”ì¸ + ëª¨ë¸ ëª¨ë¸ì€ ì–´ë–¤ ëŒ€ìƒì„ ì¶”ìƒí™”í•˜ê³  ë‹¨ìˆœí™”í•œ ê²ƒì´ë‹¤. ë”°ë¼ì„œ ë„ë©”ì¸ ëª¨ë¸ì€ ë„ë©”ì¸ê³¼ ê´€ë ¨ëœ ë¶€ë¶„ì„ ì¶”ìƒí™”í•œ ê²ƒì´ë‹¤. ë„ë©”ì¸ê³¼ ê´€ë ¨ë˜ì§€ ì•Šì€ ì‚¬í•­ë“¤ì— ëŒ€í•´ì„œëŠ” ë¬´ì‹œí•¨ìœ¼ë¡œì¨, í˜„ì‹¤ ì„¸ê³„ì˜ ë³µì¡ì„±ì„ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. ë„ë©”ì¸ ëª¨ë¸ì—ëŠ” ë„ë©”ì¸ê³¼ ê´€ë ¨ëœ ì´í•´ê´€ê³„ìë“¤ì´ ë„ë©”ì¸ì— ëŒ€í•´ ìƒê°í•˜ëŠ” ê´€ì ì´ ë°˜ì˜ë˜ì–´ì•¼ í•œë‹¤. ì¦‰, ë„ë©”ì¸ ëª¨ë¸ì€ ì´í•´ê´€ê³„ìë“¤ì´ í•´ë‹¹ ë„ë©”ì¸ì„ ë°”ë¼ë³´ëŠ” ë©˜íƒˆ ëª¨ë¸(Mental Model)ì´ë‹¤. ë©˜íƒˆ ëª¨ë¸ì´ë€ ì‚¬ëŒë“¤ì´ ìê¸° ìì‹ , ë‹¤ë¥¸ ì‚¬ëŒ, í™˜ê²½, ìì‹ ì´ ìƒí˜¸ì‘ìš©í•˜ëŠ” ì‚¬ë¬¼ë“¤ì— ëŒ€í•´ ê°–ëŠ” ëª¨í˜•ì´ë‹¤. ì‚¬ìš©ìë“¤ì€ ìì‹ ì´ ì´ìš©í•˜ëŠ” ì‹œìŠ¤í…œì´ ìì‹ ì˜ ë©˜íƒˆ ëª¨ë¸ê³¼ ìœ ì‚¬í•œ ë°©ì‹ìœ¼ë¡œ ì‘ë™í•  ê²ƒìœ¼ë¡œ ê¸°ëŒ€í•œë‹¤. ë”°ë¼ì„œ ì¢‹ì€ ì‹œìŠ¤í…œ ë””ìì¸ì´ë€ ì‚¬ìš©ìê°€ ì˜ˆìƒí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë°˜ì‘í•˜ëŠ” ì œí’ˆì„ ë§Œë“œëŠ” ê²ƒì´ë‹¤. ë„ë©”ì¸ ëª¨ë¸ê³¼ ê°ì²´ì§€í–¥ ìœ„ì—ì„œ ì‚´í´ë³¸ ê²ƒ ì²˜ëŸ¼ ìš°ë¦¬ê°€ ë§Œë“¤ ì‹œìŠ¤í…œ(ìµœì¢… ì œí’ˆ)ì—ëŠ” ë„ë©”ì¸ì— ëŒ€í•œ ì‚¬ìš©ì ê´€ì ì´ ë°˜ì˜ë˜ì–´ì•¼ í•œë‹¤.ì´ë¥¼ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ê´€ì ì—ì„œ ìƒê°í•´ë³´ë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ë„ë©”ì¸ ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ ì„¤ê³„ë˜ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ê°ì²´ì§€í–¥ íŒ¨ëŸ¬ë‹¤ì„ì€ ì‚¬ìš©ìê°€ ë„ë©”ì¸ì„ ë°”ë¼ë³´ëŠ” ê´€ì  / ì„¤ê³„ìê°€ ì‹œìŠ¤í…œ êµ¬ì¡°ë¥¼ ë°”ë¼ë³´ëŠ” ê´€ì  / êµ¬í˜„ëœ ì½”ë“œì˜ ëª¨ìŠµì„ ëª¨ë‘ ëª¨ë¸ë§ í•  ìˆ˜ ìˆëŠ” ê°•ë ¥í•œ ëª¨ë¸ë§ íŒ¨ëŸ¬ë‹¤ì„ì´ë‹¤. ì¦‰ ê°ì²´ì§€í–¥ íŒ¨ëŸ¬ë‹¤ì„ì€ ì‚¬ìš©ì ê´€ì , ì„¤ê³„ì ê´€ì , ì½”ë“œì˜ ëª¨ìŠµì„ ëª¨ë‘ ìœ ì‚¬í•œ í˜•íƒœë¡œ ìœ ì§€í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ì‚¬ê³ ë„êµ¬ì™€ í”„ë¡œê·¸ë˜ë° ê¸°ë²•ì„ ì œê³µí•œë‹¤. í‘œí˜„ì  ì°¨ì´ ì†Œí”„íŠ¸ì›¨ì–´ ê°ì²´ëŠ” í˜„ì‹¤ ê°ì²´ì— ëŒ€í•œ ì¶”ìƒí™”ê°€ ì•„ë‹ˆë‹¤. ì¦‰, ì†Œí”„íŠ¸ì›¨ì–´ ê°ì²´ëŠ” í˜„ì‹¤ ê°ì²´ë¥¼ ëª¨ë°©í•œ ê²ƒì´ ì•„ë‹ˆë¼ ì€ìœ ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¬ì°½ì¡°í•œ ê²ƒì´ë‹¤.ë”°ë¼ì„œ, ì†Œí”„íŠ¸ì›¨ì–´ ê°ì²´ëŠ” í˜„ì‹¤ ê°ì²´ê°€ ê°–ì§€ ëª»í•œ íŠ¹ì„±ì„ ê°€ì§ˆ ìˆ˜ë„ ìˆê³ , í˜„ì‹¤ ê°ì²´ê°€ í•˜ì§€ ëª»í•˜ëŠ” í–‰ë™ì„ í•  ìˆ˜ë„ ìˆë‹¤. ì€ìœ (metaphor) : ê²½í—˜, ìƒê°, ê°ì •, í–‰ë™ ë˜ëŠ” ëŒ€ìƒ ê°„ì˜ ìœ ì‚¬ì„±ì„ ì•”ì‹œí•˜ëŠ” ìƒì§•ì ì¸ ì ‘ê·¼ ë°©ì‹ í‘œí˜„ì  ì°¨ì´(ì˜ë¯¸ì  ì°¨ì´) ì†Œí”„íŠ¸ì›¨ì–´ ê°ì²´ì™€ í˜„ì‹¤ ê°ì²´ ì‚¬ì´ì˜ ì˜ë¯¸ì  ê±°ë¦¬ì´ë‹¤. ë„ë©”ì¸ ëª¨ë¸ì´ ì¤‘ìš”í•œ ì´ìœ ëŠ” ì€ìœ ë¥¼ í†µí•´ í‘œí˜„ì  ì°¨ì´ë¥¼ ì¤„ì¼ ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰, ì‚¬ìš©ìì˜ ë©˜íƒˆ ëª¨ë¸ì´ ì½”ë“œì— ë” ì˜ ë…¹ì•„ë“¤ ìˆ˜ ìˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ í‘œí˜„ì  ì°¨ì´ê°€ ì¤„ì–´ë“¤ìˆ˜ë¡ ì½”ë“œì˜ êµ¬ì¡°ê°€ ë„ë©”ì¸ì˜ êµ¬ì¡°ë¥¼ ì˜ ë°˜ì˜í•˜ê²Œëœë‹¤. ì´ë¥¼ í†µí•´ ì´í•´í•˜ê³  ìˆ˜ì •í•˜ê¸° ì‰¬ìš´ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ì•ˆì •ì ì¸ ë„ë©”ì¸ ëª¨ë¸ ë„ë©”ì¸ ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ìƒëŒ€ì ìœ¼ë¡œ ì•ˆì •ì ì¸ êµ¬ì¡°ë¥¼ ë§Œë“¤ ìˆ˜ ìˆë‹¤. ë„ë©”ì¸ ëª¨ë¸ì— ë„ë©”ì¸ì— ëŒ€í•œ ì‚¬ìš©ìì˜ ê´€ì ì„ ë°˜ì˜í•´ì•¼ í•˜ëŠ” ì´ìœ ëŠ” ì‚¬ìš©ìë“¤ì´ ë„ë©”ì¸ì˜ ë³¸ì§ˆì— ëŒ€í•´ ê°€ì¥ ì˜ ì´í•´í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ë³¸ì§ˆì€ ë³€ê²½ì´ ì ê³  ë¹„êµì  ê·¸ íŠ¹ì„±ì´ ì˜¤ëœ ì‹œê°„ ìœ ì§€ëœë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ê°œë°œí•˜ê³  ìœ ì§€ë³´ìˆ˜í•¨ì— ìˆì–´ì„œ ë³€ê²½ì€ í”¼í•  ìˆ˜ ì—†ëŠ” ìˆ™ëª…ê°™ì€ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ, ë„ë©”ì¸ ëª¨ë¸ì— í¬í•¨ëœ ê°œë…ê³¼ ê·œì¹™ì€ ë„ë©”ì¸ì˜ â€˜ë³¸ì§ˆâ€™ì„ ë‹¤ë£¨ê¸° ë•Œë¬¸ì— ë³€ê²½ë  í™•ë¥ ì´ ì ë‹¤. ë³€ê²½ëœë‹¤ í•˜ë”ë¼ë„ ë³€ê²½ì— ì‰½ê²Œ ëŒ€ì²˜í•  ìˆ˜ ìˆì„ ê°€ëŠ¥ì„±ì´ ì»¤ì§„ë‹¤. ë„ë©”ì¸ ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ ì†Œí”„íŠ¸ì›¨ì–´ êµ¬ì¡°ë¥¼ ì„¤ê³„í•˜ë©´, ì•ˆì •ì ì¸ êµ¬ì¡° ìœ„ì— (ë¹„êµì ) ìì£¼ ë³€ê²½ë˜ëŠ” ê¸°ëŠ¥ì„ ë°°ì¹˜í•  ìˆ˜ ìˆë‹¤. ì´ì™€ ê°™ì€ ì„¤ê³„ëŠ” ë³€ê²½ì— ìœ ì—°í•œ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë§Œë“¤ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. ìœ ìŠ¤ì¼€ì´ìŠ¤ ì†Œí”„íŠ¸ì›¨ì–´ì˜ ì¡´ì¬ ì´ìœ ëŠ” ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ê¸° ìœ„í•¨ì´ë‹¤. ìœ ìŠ¤ì¼€ì´ìŠ¤ëŠ” ì‚¬ìš©ìì™€ ì‹œìŠ¤í…œ ê°„ì˜ ìƒí˜¸ì‘ìš© íë¦„ì„ í…ìŠ¤íŠ¸ë¡œ ì •ë¦¬í•œ ê²ƒì´ë‹¤. ìœ ìŠ¤ì¼€ì´ìŠ¤ì˜ ê°€ì¹˜ëŠ” ì‚¬ìš©ì ëª©í‘œë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì‹œìŠ¤í…œì˜ ê¸°ëŠ¥ì ì¸ ìš”êµ¬ì‚¬í•­ë“¤ì„ ì´ì•¼ê¸° í˜•ì‹ìœ¼ë¡œ ë¬¶ì„ ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤. ì¦‰, ì‚¬ìš©ì ëª©í‘œë¥¼ í†µí•´ ê°ê°ì˜ ê¸°ëŠ¥ì„ ìœ ê¸°ì ì¸ ê´€ê³„ë¥¼ ì§€ë‹Œ ì²´ê³„ë¡œ ë°œì „ì‹œí‚¨ë‹¤. ìœ ìŠ¤ì¼€ì´ìŠ¤ì˜ íŠ¹ì„±1. ìœ ìŠ¤ì¼€ì´ìŠ¤ëŠ” ì‚¬ìš©ìì™€ ì‹œìŠ¤í…œê°„ì˜ ìƒí˜¸ì‘ìš©ì„ ë‚˜íƒ€ë‚´ëŠ” â€˜í…ìŠ¤íŠ¸â€™ì´ë‹¤. ìœ ìŠ¤ì¼€ì´ìŠ¤ì˜ í•µì‹¬ì€ ë‹¤ì´ì–´ê·¸ë¨ì´ ì•„ë‹Œ ì‚¬ìš©ìì™€ ì‹œìŠ¤í…œ ê°„ì˜ ìƒí˜¸ì‘ìš©ì„ ì´ì•¼ê¸° íë¦„ìœ¼ë¡œ í‘œí˜„í•˜ëŠ” ê²ƒì´ë‹¤.2. ìœ ìŠ¤ì¼€ì´ìŠ¤ëŠ” ì—¬ëŸ¬ ì‹œë‚˜ë¦¬ì˜¤ë“¤ì˜ ì§‘í•©ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, â€˜ì´ì ê³„ì‚°â€™ì´ë¼ëŠ” ìœ ìŠ¤ì¼€ì´ìŠ¤ëŠ” ë‹¤ìŒ ë‘ ê°œì˜ ì‹œë‚˜ë¦¬ì˜¤ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. ì˜ˆê¸ˆì£¼ê°€ ê³„ì¢Œë¥¼ ì„ íƒí•˜ê³  ë‹¹ì¼ê¹Œì§€ì˜ ì´ìì•¡ì„ ê³„ì‚° ì˜ˆê¸ˆì£¼ê°€ ê³„ì¢Œë¥¼ ì„ íƒí•˜ê³  íŠ¹ì • ì¼ìê¹Œì§€ì˜ ì´ìì•¡ì„ ê³„ì‚° ì¦‰, ìœ ìŠ¤ì¼€ì´ìŠ¤ëŠ” íŠ¹ì •í•œ ì‚¬ìš©ìì˜ ëª©í‘œ(ìœ„ ì˜ˆì‹œì—ì„  ì´ì ê³„ì‚°)ì™€ ê´€ë ¨ëœ ëª¨ë“  ì‹œë‚˜ë¦¬ì˜¤ì˜ ì§‘í•©ì´ë‹¤.3. ìœ ìŠ¤ì¼€ì´ìŠ¤ëŠ” ë‹¨ìˆœí•œ ê¸°ëŠ¥ ëª©ë¡ì´ ì•„ë‹ˆë‹¤. ê¸°ëŠ¥ë§Œ ë‚˜ì—´í•˜ëŠ” ê²ƒì€ ê°ê°ì˜ ê¸°ëŠ¥ì„ ì„œë¡œ ì—°ê´€ì´ ì—†ëŠ” ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ ë§Œë“ ë‹¤. ì‹œìŠ¤í…œì€ ì •ê¸°ì˜ˆê¸ˆ ì •ë³´ë¥¼ ë³´ì—¬ì¤€ë‹¤, ì‹œìŠ¤í…œì€ ë‹¹ì¼ì´ë‚˜ í˜„ì¬ ì¼ìì˜ ì´ìë¥¼ ê³„ì‚°í•œë‹¤ ë¼ëŠ” ë‘ ê¸°ëŠ¥ì„ ì¤‘ë„ í•´ì§€ ì´ìì•¡ì„ ê³„ì‚°í•œë‹¤ë¼ëŠ” ìœ ìŠ¤ì¼€ì´ìŠ¤ë¡œ ë¬¶ì„ ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´, ì‹œìŠ¤í…œì˜ ê¸°ëŠ¥ì— ëŒ€í•´ ì˜ì‚¬ì†Œí†µí•  ìˆ˜ ìˆëŠ” ë¬¸ë§¥ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. 4. ìœ ìŠ¤ì¼€ì´ìŠ¤ëŠ” ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ì™€ ê´€ë ¨ëœ ì„¸ë¶€ ì •ë³´ë¥¼ í¬í•¨í•˜ì§€ ë§ì•„ì•¼ í•œë‹¤. ìì£¼ ë³€ê²½ë˜ëŠ” ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤ ìš”ì†ŒëŠ” ë°°ì œí•˜ê³ , ì‚¬ìš©ì ê´€ì ì—ì„œ ì‹œìŠ¤í…œì˜ í–‰ìœ„ì— ì´ˆì²¨ì„ ë§ì¶˜ë‹¤.5. ìœ ìŠ¤ì¼€ì´ìŠ¤ëŠ” ë‚´ë¶€ ì„¤ê³„ì™€ ê´€ë ¨ëœ ì •ë³´ë¥¼ í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤. ìœ ìŠ¤ì¼€ì´ìŠ¤ì˜ ëª©ì ì€ ë‚´ë¶€ ì„¤ê³„ë¥¼ ì„¤ëª…í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤. ê³¼ê±°ì—ëŠ” ìœ ìŠ¤ì¼€ì´ìŠ¤ì— ë‚˜íƒ€ë‚˜ëŠ” ëª…ì‚¬ë¥¼ í´ë˜ìŠ¤ë¡œ, ë™ì‚¬ë¥¼ ë©”ì„œë“œë¡œ ëŒ€ì‘ì‹œí‚¤ëŠ” ë°©ì‹ìœ¼ë¡œ ê°ì²´ì§€í–¥ ì„¤ê³„ë¥¼ ì„¤ëª…í•˜ê¸°ë„ í–ˆì§€ë§Œ ê°ì²´ì§€í–¥ ì„¤ê³„ëŠ” ì´ë ‡ê²Œ ë‹¨ìˆœí•˜ì§€ ì•Šë‹¤. ìœ ìŠ¤ì¼€ì´ìŠ¤ì—ì„œ ê°ì²´ ì„¤ê³„ë¡œì˜ ì „í™˜ì€ ê²½í—˜, ìƒì‹, ì˜ì‚¬ì†Œí†µì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ì°½ì¡° ì‘ì—…ì´ë‹¤. ë¬¼ë¡  ìœ ìŠ¤ì¼€ì´ìŠ¤ ì•ˆì—ì„œ ë„ë©”ì¸ ëª¨ë¸ì— ì‚¬ìš©í•  ìš©ì–´ì— ëŒ€í•œ íŒíŠ¸ë¥¼ ì–»ì„ ìˆ˜ë„ ìˆë‹¤. í•˜ì§€ë§Œ ìœ ìŠ¤ì¼€ì´ìŠ¤ ì•ˆì— ë„ë©”ì¸ ëª¨ë¸ì„ êµ¬ì¶•í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì •ë³´ê°€ í¬í•¨ë˜ì–´ ìˆì§„ ì•Šë‹¤. ê¸°ëŠ¥ê³¼ êµ¬ì¡°ì˜ í†µí•© ë³€ê²½ì— ìœ ì—°í•œ ì†Œí”„íŠ¸ì›¨ì–´ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” ìœ ìŠ¤ì¼€ì´ìŠ¤ì— ì •ë¦¬ëœ ì‹œìŠ¤í…œì˜ ê¸°ëŠ¥ì„ ë„ë©”ì¸ ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ í•œ ê°ì²´ë“¤ì˜ ì±…ì„ìœ¼ë¡œ ë¶„ë°°í•´ì•¼ í•œë‹¤.ì±…ì„ ì£¼ë„ ì„¤ê³„ ì±…ì„ ì£¼ë„ ì„¤ê³„ ë°©ë²•ì€ ì‹œìŠ¤í…œì˜ ê¸°ëŠ¥ì„ ì—­í• ê³¼ ì±…ì„ì„ ìˆ˜í–‰í•˜ëŠ” ê°ì²´ë“¤ì˜ í˜‘ë ¥ ê´€ê³„ë¡œ ë°”ë¼ë³¼ ìˆ˜ ìˆê²Œ í•œë‹¤.ì´ë¥¼ í†µí•´ ìœ ìŠ¤ì¼€ì´ìŠ¤ì™€ ë„ë©”ì¸ ëª¨ë¸ì„ í†µí•©í•œë‹¤. ì‚¬ìš©ìì˜ ê´€ì ì—ì„œ ì‹œìŠ¤í…œì€ ìì‹ ì´ ì „ì†¡í•œ ë©”ì‹œì§€ì— ì‘ë‹µí•˜ëŠ” ë° í•„ìš”í•œ ì±…ì„ì„ ìˆ˜í–‰í•˜ëŠ” ì¼ì¢…ì˜ ê°ì²´ë‹¤. ì‹œìŠ¤í…œì´ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ” ì»¤ë‹¤ë€ ê·œëª¨ì˜ ì±…ì„ì€ ë” ì‘ì€ í¬ê¸°ì˜ ê°ì²´ë“¤ì˜ í˜‘ë ¥ì„ í†µí•´ êµ¬í˜„ë  ìˆ˜ ìˆë‹¤. ê°ì²´ë“¤ì„ ì‹ë³„í•¨ì— ìˆì–´ ë„ë©”ì¸ ëª¨ë¸ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ìœ ìŠ¤ì¼€ì´ìŠ¤ë¥¼ í†µí•´ í˜‘ë ¥ì„ ì™„ì„±í•˜ëŠ” ë° í•„ìš”í•œ ë©”ì‹œì§€ë¥¼ ì‹ë³„í•˜ë©´ì„œ ê°ì²´ë“¤ì—ê²Œ ì±…ì„ì„ í• ë‹¹í•œë‹¤. ê²°ê³¼ì ìœ¼ë¡œ, ì½”ë“œëŠ” ë¶ˆì•ˆì •í•œ ê¸°ëŠ¥ì„ ìˆ˜ìš©í•  ìˆ˜ ìˆëŠ” ì•ˆì •ì ì¸ êµ¬ì¡°ê°€ ëœë‹¤. " }, { "title": "ìˆ«ì ì•¼êµ¬ ê²Œì„ êµ¬í˜„í•˜ê¸° (2)", "url": "/posts/number-baseball-part2/", "categories": "ê²½í—˜í•˜ê¸°, ì‘ì—… ë…¸íŠ¸", "tags": "", "date": "2021-10-26 22:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ë‚´ ë§ˆìŒëŒ€ë¡œ êµ¬í˜„í•´ë´¤ë˜ ìˆ«ì ì•¼êµ¬ ê²Œì„ êµ¬í˜„í•˜ê¸° 1í¸ì— ì´ì–´, ë°•ì¬ì„±ë‹˜ì˜ í”¼ë“œë°± ê°•ì˜ë¥¼ ë“£ê³  ëŠë‚€ì ê³¼ TDD ë°©ì‹ìœ¼ë¡œ ê°œë°œí•˜ë©´ì„œ ëŠë‚€ì ì„ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.â€» TDD ì—°ìŠµí•´ë³¸ ì½”ë“œí”¼ë“œë°± ê°•ì˜ë¥¼ í†µí•´ ë°°ìš´ ê²ƒTDD ê´€ë ¨ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì€ ì˜ ì •ë¦¬ëœ ìš”êµ¬ì‚¬í•­ì„ ê¸°ë°˜ìœ¼ë¡œ í•  ë•Œ ìˆ˜ì›”í•˜ë‹¤. DB, UI, ëœë¤ê°’ ë“±ê³¼ ê°™ì´ í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë ¤ìš´ ë¶€...", "content": "ë“¤ì–´ê°€ê¸° ì „ë‚´ ë§ˆìŒëŒ€ë¡œ êµ¬í˜„í•´ë´¤ë˜ ìˆ«ì ì•¼êµ¬ ê²Œì„ êµ¬í˜„í•˜ê¸° 1í¸ì— ì´ì–´, ë°•ì¬ì„±ë‹˜ì˜ í”¼ë“œë°± ê°•ì˜ë¥¼ ë“£ê³  ëŠë‚€ì ê³¼ TDD ë°©ì‹ìœ¼ë¡œ ê°œë°œí•˜ë©´ì„œ ëŠë‚€ì ì„ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.â€» TDD ì—°ìŠµí•´ë³¸ ì½”ë“œí”¼ë“œë°± ê°•ì˜ë¥¼ í†µí•´ ë°°ìš´ ê²ƒTDD ê´€ë ¨ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì€ ì˜ ì •ë¦¬ëœ ìš”êµ¬ì‚¬í•­ì„ ê¸°ë°˜ìœ¼ë¡œ í•  ë•Œ ìˆ˜ì›”í•˜ë‹¤. DB, UI, ëœë¤ê°’ ë“±ê³¼ ê°™ì´ í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë ¤ìš´ ë¶€ë¶„ë³´ë‹¤ëŠ” utilì„± ë©”ì„œë“œ, input/output ëª…í™•í•œ ê²ƒ ë“± í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰¬ìš´ ì˜ì—­ë¶€í„° í•´ë‚˜ê°€ëŠ” ê²ƒì´ ì¢‹ë‹¤. í° ë‹¨ìœ„ë¡œ TDDë¥¼ í•˜ë ¤ê³ í•˜ê¸° ë•Œë¬¸ì— í˜ë“  ê²ƒì´ë‹¤. ìµœëŒ€í•œ ì‘ì€ ë‹¨ìœ„ë¡œ ìª¼ê°œë³´ì. í…ŒìŠ¤íŠ¸í•˜ê¸° ì–´ë ¤ìš´ ì˜ì—­ê³¼ í…ŒìŠ¤íŠ¸í•˜ê¸° ì‰¬ìš´ ì˜ì—­ì„ ë¶„ë¦¬(ê²©ë¦¬)í•  ìˆ˜ ìˆì–´ì•¼í•œë‹¤.ë„ë©”ì¸ ëª¨ë¸ ê´€ë ¨ ë‚˜ëŠ” ê²Œì„ì— ì°¸ì—¬í•˜ëŠ” ì£¼ì²´ì¸ Player, Opponent ë“±ì— ì´ˆì ì„ ë§ì·„ì—ˆë‹¤. ê°•ì˜ì—ì„œëŠ” ê²Œì„ì˜ ì°¸ì—¬í•˜ëŠ” ì£¼ì²´ê°€ ì•„ë‹Œ, ì•¼êµ¬ ê²Œì„ì—ì„œ í™œìš©ë˜ëŠ” ìˆ«ìì— ì´ˆì ì„ ë§ì·„ë‹¤. ì¦‰, í•˜ë‚˜ì˜ ìˆ«ìë¥¼ Ball ê°ì²´ë¡œ, ì—¬ëŸ¬ ê°œì˜ ìˆ«ìë¥¼ Balls ê°ì²´ë¡œ ë°”ë¼ë³´ì•˜ë‹¤. ê°™ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì–´ë–¤ ê´€ì ì—ì„œ ë³´ëŠ”ì§€ì— ë”°ë¼ ì™„ì „íˆ ë‹¤ë¥¸ ì„¤ê³„ê°€ ê°€ëŠ¥í•˜ë‹¤ëŠ”ê²Œ í¥ë¯¸ë¡œìš´ ê²ƒ ê°™ë‹¤.ê¸°íƒ€ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ ë¬´ì–¸ê°€ í•˜ë ¤ê³ í•˜ì§€ ë§ê³ , í•´ë‹¹ ë°ì´í„°ë¥¼ ê°–ê³ ìˆëŠ” ê°ì²´ì—ê²Œ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í•˜ì. ìš”êµ¬ì‚¬í•­ ë¶„ì„ì„ í†µí•´ ëŒ€ëµì ì¸ ì„¤ê³„ : ê°ì²´ ì¶”ì¶œ UI, DB ë“±ê³¼ ì˜ì¡´ê´€ê³„ë¥¼ ê°€ì§€ì§€ ì•ŠëŠ” í•µì‹¬ ë„ë©”ì¸ ì˜ì—­ ì§‘ì¤‘ ì„¤ê³„TDDë¡œ êµ¬í˜„í•´ë³´ê¸° 1~4ë²ˆì„ ë°˜ë³µí•˜ë©´ì„œ ê°œë°œí•œë‹¤. ìš”êµ¬ì‚¬í•­ì„ ê¸°ë°˜ìœ¼ë¡œí•œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„± ì»´íŒŒì¼ ì—ëŸ¬ í•´ê²° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì–´ë–»ê²Œë“  í†µê³¼í•˜ë„ë¡ ë¡œì§ ì‘ì„± ë¦¬íŒ©í† ë§ìš”êµ¬ ì‚¬í•­ ì •ë¦¬ê¸°ë³¸ì ìœ¼ë¡œ 1ë¶€í„° 9ê¹Œì§€ ì„œë¡œ ë‹¤ë¥¸ ìˆ˜ë¡œ ì´ë£¨ì–´ì§„ 3ìë¦¬ì˜ ìˆ˜ë¥¼ ë§ì¶”ëŠ” ê²Œì„ì´ë‹¤. ê°™ì€ ìˆ˜ê°€ ê°™ì€ ìë¦¬ì— ìˆìœ¼ë©´ ìŠ¤íŠ¸ë¼ì´í¬, ë‹¤ë¥¸ ìë¦¬ì— ìˆìœ¼ë©´ ë³¼, ê°™ì€ ìˆ˜ê°€ ì „í˜€ ì—†ìœ¼ë©´ í¬ë³¼ ë˜ëŠ” ë‚«ì‹±ì´ë€ íŒíŠ¸ë¥¼ ì–»ê³ , ê·¸ íŒíŠ¸ë¥¼ ì´ìš©í•´ì„œ ë¨¼ì € ìƒëŒ€ë°©(ì»´í“¨í„°)ì˜ ìˆ˜ë¥¼ ë§ì¶”ë©´ ìŠ¹ë¦¬í•œë‹¤. e.g. ìƒëŒ€ë°©(ì»´í“¨í„°)ì˜ ìˆ˜ê°€ 425ì¼ ë•Œ, 123ì„ ì œì‹œí•œ ê²½ìš° : 1ìŠ¤íŠ¸ë¼ì´í¬, 456ì„ ì œì‹œí•œ ê²½ìš° : 1ë³¼ 1ìŠ¤íŠ¸ë¼ì´í¬, 789ë¥¼ ì œì‹œí•œ ê²½ìš° : ë‚«ì‹± ìœ„ ìˆ«ì ì•¼êµ¬ ê²Œì„ì—ì„œ ìƒëŒ€ë°©ì˜ ì—­í• ì„ ì»´í“¨í„°ê°€ í•œë‹¤. ì»´í“¨í„°ëŠ” 1ì—ì„œ 9ê¹Œì§€ ì„œë¡œ ë‹¤ë¥¸ ì„ì˜ì˜ ìˆ˜ 3ê°œë¥¼ ì„ íƒí•œë‹¤. ê²Œì„ í”Œë ˆì´ì–´ëŠ” ì»´í“¨í„°ê°€ ìƒê°í•˜ê³  ìˆëŠ” 3ê°œì˜ ìˆ«ìë¥¼ ì…ë ¥í•˜ê³ , ì»´í“¨í„°ëŠ” ì…ë ¥í•œ ìˆ«ìì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì¶œë ¥í•œë‹¤. ì´ ê°™ì€ ê³¼ì •ì„ ë°˜ë³µí•´ ì»´í“¨í„°ê°€ ì„ íƒí•œ 3ê°œì˜ ìˆ«ìë¥¼ ëª¨ë‘ ë§íˆë©´ ê²Œì„ì´ ì¢…ë£Œëœë‹¤. ê²Œì„ì„ ì¢…ë£Œí•œ í›„ ê²Œì„ì„ ë‹¤ì‹œ ì‹œì‘í•˜ê±°ë‚˜ ì™„ì „íˆ ì¢…ë£Œí•  ìˆ˜ ìˆë‹¤.ëŠë‚€ì  ìš”êµ¬ì‚¬í•­ì´ ìˆì–´ë„ ì–´ë–¤ ê²ƒ ë¶€í„° í…ŒìŠ¤íŠ¸ì½”ë“œë¡œ ì‘ì„±í•´ì•¼ í• ì§€ ì˜ ëª¨ë¥´ê² ë‹¤. ì¼ë‹¨ ì‘ì€ ë‹¨ìœ„ë¶€í„° í…ŒìŠ¤íŠ¸ í•˜ì. ì˜ˆë¥¼ ë“¤ì–´ ì•„ë˜ì™€ ê°™ì€ ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì•¼ í•œë‹¤ë©´, ìˆ«ì í•˜ë‚˜ì”© ìˆëŠ” ê²ƒ ë¶€í„° ë„ì „í•´ë³´ì. com = Balls(Arrays.asList(1,2,3));user = Balls(Arrays.asList(1,3,2));com.play(user); // 1 strike, 2 ball ê°•ì˜ë¡œ ë³¼ ë• ìˆ˜ì›”í•´ë³´ì˜€ëŠ”ë° ë§‰ìƒ í˜¼ì í•˜ë ¤ë‹ˆ ë§‰ë§‰í•˜ë‹¤. ìŠ¤ìŠ¤ë¡œ ê³ ë¯¼ë„ ë§ì´ í•´ë³´ê³  ê¾¸ì¤€í•œ ì—°ìŠµì´ í•„ìš”í•  ê²ƒ ê°™ë‹¤. ì»¤ë°‹ ë‹¨ìœ„ë¥¼ ì˜ ì¡°ì ˆí•˜ì. í•˜ë‹¤ë³´ë‹ˆ ì»¤ë°‹í•˜ì§€ ì•Šê³  ë„ˆë¬´ ë§ì€ ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤." }, { "title": "ìˆ«ì ì•¼êµ¬ ê²Œì„ êµ¬í˜„í•˜ê¸° (1)", "url": "/posts/number-baseball-part1/", "categories": "ê²½í—˜í•˜ê¸°, ì‘ì—… ë…¸íŠ¸", "tags": "", "date": "2021-10-16 23:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ë°•ì¬ì„±ë‹˜ì´ ìš´ì˜í•˜ì‹œëŠ” NextStepì˜ ìë°” í”Œë ˆì´ê·¸ë¼ìš´ë“œ with TDD, í´ë¦°ì½”ë“œë¥¼ ëª‡ ë‹¬ ì „ì— ëŠì–´ë†¨ì§€ë§Œ ì´ì§ ì¤€ë¹„í•˜ëŠë¼ ì´ì œì„œì•¼ ì‹¤ìŠµí•´ë³¸ë‹¤.ì²« ë²ˆì§¸ ë‹¨ê³„ì¸ ìˆ«ì ì•¼êµ¬ ê²Œì„ì„ ë¨¼ì € ìš”êµ¬ì‚¬í•­ë§Œ ë³´ê³  TDD ì—†ì´ êµ¬í˜„í•´ë³´ë ¤ê³  í•œë‹¤. ê·¸ë¦¬ê³  ì¡°ì˜í˜¸ë‹˜ê»˜ì„œ ì“´ ã€ê°ì²´ì§€í–¥ì˜ ì‚¬ì‹¤ê³¼ ì˜¤í•´ã€ì—ì„œ ì½ì€ ìœ ìŠ¤ì¼€ì´ìŠ¤ì™€ ë„ë©”ì¸ ëª¨ë¸ ê°œë…ì„ í™œìš©í•´ì„œ ì• í”Œë¦¬ì¼€...", "content": "ë“¤ì–´ê°€ê¸° ì „ë°•ì¬ì„±ë‹˜ì´ ìš´ì˜í•˜ì‹œëŠ” NextStepì˜ ìë°” í”Œë ˆì´ê·¸ë¼ìš´ë“œ with TDD, í´ë¦°ì½”ë“œë¥¼ ëª‡ ë‹¬ ì „ì— ëŠì–´ë†¨ì§€ë§Œ ì´ì§ ì¤€ë¹„í•˜ëŠë¼ ì´ì œì„œì•¼ ì‹¤ìŠµí•´ë³¸ë‹¤.ì²« ë²ˆì§¸ ë‹¨ê³„ì¸ ìˆ«ì ì•¼êµ¬ ê²Œì„ì„ ë¨¼ì € ìš”êµ¬ì‚¬í•­ë§Œ ë³´ê³  TDD ì—†ì´ êµ¬í˜„í•´ë³´ë ¤ê³  í•œë‹¤. ê·¸ë¦¬ê³  ì¡°ì˜í˜¸ë‹˜ê»˜ì„œ ì“´ ã€ê°ì²´ì§€í–¥ì˜ ì‚¬ì‹¤ê³¼ ì˜¤í•´ã€ì—ì„œ ì½ì€ ìœ ìŠ¤ì¼€ì´ìŠ¤ì™€ ë„ë©”ì¸ ëª¨ë¸ ê°œë…ì„ í™œìš©í•´ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„¤ê³„í•´ë³´ê³ ì í•œë‹¤.ì´ ë‹¨ê³„ë¥¼ ë§ˆì¹˜ë©´ ë°•ì¬ì„±ë‹˜ì˜ í”¼ë“œë°± ê°•ì˜ë¥¼ ë“£ê³  TDD ë°©ì‹ìœ¼ë¡œ ë‹¤ì‹œ ê°œë°œí•´ë³´ë ¤ê³  í•œë‹¤.ê¸°ëŠ¥ ìš”êµ¬ ì‚¬í•­ê¸°ë³¸ì ìœ¼ë¡œ 1ë¶€í„° 9ê¹Œì§€ ì„œë¡œ ë‹¤ë¥¸ ìˆ˜ë¡œ ì´ë£¨ì–´ì§„ 3ìë¦¬ì˜ ìˆ˜ë¥¼ ë§ì¶”ëŠ” ê²Œì„ì´ë‹¤. ê°™ì€ ìˆ˜ê°€ ê°™ì€ ìë¦¬ì— ìˆìœ¼ë©´ ìŠ¤íŠ¸ë¼ì´í¬, ë‹¤ë¥¸ ìë¦¬ì— ìˆìœ¼ë©´ ë³¼, ê°™ì€ ìˆ˜ê°€ ì „í˜€ ì—†ìœ¼ë©´ í¬ë³¼ ë˜ëŠ” ë‚«ì‹±ì´ë€ íŒíŠ¸ë¥¼ ì–»ê³ , ê·¸ íŒíŠ¸ë¥¼ ì´ìš©í•´ì„œ ë¨¼ì € ìƒëŒ€ë°©(ì»´í“¨í„°)ì˜ ìˆ˜ë¥¼ ë§ì¶”ë©´ ìŠ¹ë¦¬í•œë‹¤. e.g. ìƒëŒ€ë°©(ì»´í“¨í„°)ì˜ ìˆ˜ê°€ 425ì¼ ë•Œ, 123ì„ ì œì‹œí•œ ê²½ìš° : 1ìŠ¤íŠ¸ë¼ì´í¬, 456ì„ ì œì‹œí•œ ê²½ìš° : 1ë³¼ 1ìŠ¤íŠ¸ë¼ì´í¬, 789ë¥¼ ì œì‹œí•œ ê²½ìš° : ë‚«ì‹± ìœ„ ìˆ«ì ì•¼êµ¬ ê²Œì„ì—ì„œ ìƒëŒ€ë°©ì˜ ì—­í• ì„ ì»´í“¨í„°ê°€ í•œë‹¤. ì»´í“¨í„°ëŠ” 1ì—ì„œ 9ê¹Œì§€ ì„œë¡œ ë‹¤ë¥¸ ì„ì˜ì˜ ìˆ˜ 3ê°œë¥¼ ì„ íƒí•œë‹¤. ê²Œ ì„ í”Œë ˆì´ì–´ëŠ” ì»´í“¨í„°ê°€ ìƒê°í•˜ê³  ìˆëŠ” 3ê°œì˜ ìˆ«ìë¥¼ ì…ë ¥í•˜ê³ , ì»´í“¨í„°ëŠ” ì…ë ¥í•œ ìˆ«ìì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì¶œë ¥í•œë‹¤. ì´ ê°™ì€ ê³¼ì •ì„ ë°˜ë³µí•´ ì»´í“¨í„°ê°€ ì„ íƒí•œ 3ê°œì˜ ìˆ«ìë¥¼ ëª¨ë‘ ë§íˆë©´ ê²Œì„ì´ ì¢…ë£Œëœë‹¤. ê²Œì„ì„ ì¢…ë£Œí•œ í›„ ê²Œì„ì„ ë‹¤ì‹œ ì‹œì‘í•˜ê±°ë‚˜ ì™„ì „íˆ ì¢…ë£Œí•  ìˆ˜ ìˆë‹¤.ìœ ìŠ¤ì¼€ì´ìŠ¤ ìˆ«ìì•¼êµ¬ ê²Œì„ì„ ì‹œì‘í•œë‹¤. í”Œë ˆì´ì–´ê°€ ìˆ«ìë¥¼ ì œì‹œí–ˆì„ ë•Œ, ìƒëŒ€ë°©ì€ í•´ë‹¹ ìˆ«ìì— ëŒ€í•œ ê²°ê³¼ë¥¼ ë¦¬í„´í•´ì¤€ë‹¤. ì œì‹œí•  ìˆ˜ ìˆëŠ” ìˆ«ìëŠ” 1~9ë¡œë§Œ êµ¬ì„±ëœ ì„¸ ìë¦¬ ìˆ˜ì´ë‹¤. ë„ë©”ì¸ ëª¨ë¸ì˜ì‹ì˜ íë¦„ 1 Player / Messenger / Opponent / GameManager Playerê°€ ì…ë ¥í•œ ìˆ«ìë¥¼ Opponentê°€ ë°›ê¸° ìœ„í•´ì„œëŠ” ì¤‘ê°„ì— ë§¤ê°œí•˜ëŠ” ì—­í• ì´ ìˆë‹¤ê³  ìƒê°. ë§Œì•½ ì§ì ‘ ì „ë‹¬í•˜ëŠ”ê±°ë¼ê³  í•˜ë©´ Playerì™€ Opponentì—ì„œ ìˆ˜í–‰í•˜ëŠ” ë¡œì§ì— System.out.printì™€ ê°™ì€ ë©”ì„œë“œê°€ ë“¤ì–´ê°€ê²Œ ë  ê²ƒì´ë‹¤. ì´ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ íë¦„ì„ ë°©í•´í•  ë¿ë”ëŸ¬, Playerì™€ Opponentê°€ ìˆ˜í–‰í•´ì•¼í•  ì±…ì„ë„ ì•„ë‹ˆë¼ê³  ìƒê°í–ˆë‹¤. ë˜í•œ ì…,ì¶œë ¥ ë°©ì‹ì´ ë°”ë€ŒëŠ” ê²½ìš° Playerì™€ Opponent ê³³ê³³ì— ì‚°ì¬ë˜ì–´ ìˆëŠ” ê´€ë ¨ ì½”ë“œë“¤ì„ ì¼ì¼ì´ ìˆ˜ì •í•´ì•¼ í•  ê²ƒ ì´ë‹¤. ë”°ë¼ì„œ, Messengerë¼ëŠ” ë§¤ê°œì²´ë¥¼ í†µí•´ Playerì™€ OpponentëŠ” ì†Œí†µí•˜ëŠ” ê²ƒì´ ì¢€ ë” ìì—°ìŠ¤ëŸ½ê³  ìœ ì§€ë³´ìˆ˜í•˜ê¸°ì—ë„ ì¢‹ë‹¤ê³  ìƒê°í–ˆë‹¤. ì„œë¡œì˜ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•˜ëŠ” ìˆ˜ë‹¨ì´ í˜„ì¬ëŠ” console view ì´ì§€ë§Œ, ì¶”í›„ì— ìˆ˜ë‹¨ì´ ë°”ë€Œë”ë¼ë„ Playerì™€ Opponentì˜ ì½”ë“œëŠ” ë³€ê²½ë  í•„ìš”ê°€ ì—†ë‹¤. Playerì™€ Opponentì—ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ê³¼ ê´€ë ¨ëœ ì½”ë“œë§Œ ìˆê²Œëœë‹¤. ì´ë ‡ê²Œ í•˜ê³  ë‚˜ë‹ˆ, ê²Œì„ì„ ì‹œì‘í•˜ê³  ì¢…ë£Œí•˜ëŠ” ê²ƒì— ëŒ€í•œ ì±…ì„ì€ ì–´ë–¤ ê°ì²´ê°€ ê°€ì ¸ì•¼í• ì§€ì— ëŒ€í•œ ê²ƒì´ ë‚¨ê²Œë˜ì—ˆë‹¤. ê²Œì„ì„ ì¤‘ì¬í•˜ëŠ” ì—­í• ì„ ìœ„í•œ ê°ì²´ë¥¼ ë³„ë„ë¡œ ë§Œë“¤ì–´ì•¼í•˜ë‚˜? ë¼ê³  ìƒê°í–ˆì§€ë§Œ Messengerì˜ ì—­í• ì„ ì¢€ ë” ë„“ì€ ë²”ìœ„ë¡œ ì¶”ìƒí™”í•´ì„œ GameManagerë¼ëŠ” ê°ì²´ë¥¼ ë§Œë“œëŠ”ê²Œ ì–´ë–¨ê°€ ìƒê°í•´ë´¤ë‹¤. ì˜ì‹ì˜ íë¦„ 2 í˜„ì‹¤ ì„¸ê³„ì—ì„œëŠ” ê²Œì„ì„ ì¡°ì‘í•˜ë ¤ë©´ ì‚¬ìš©ìì™€ ê°™ì€ ëˆ„êµ°ê°€ê°€ â€˜ì‹¤í–‰â€™í•˜ê³  â€˜ì¢…ë£Œâ€™í•˜ëŠ” í–‰ìœ„ë¥¼ í•˜ê¸° ë•Œë¬¸ì— ìœ„ì—ì„œ GameManagerë¥¼ ìƒê°í•˜ë ¤ í–ˆë˜ ê²ƒ ê°™ë‹¤. í•˜ì§€ë§Œ, â€˜ê°ì²´ì§€í–¥ì˜ ì‚¬ì‹¤ê³¼ ì˜¤í•´â€™ì—ì„œ ë´¤ë“¯ì´ í˜„ì‹¤ ì„¸ê³„ì™€ ê°ì²´ëŠ” ì™„ì „íˆ ì¼ì¹˜í•˜ê¸°ê°€ ì–´ë µê³  ê·¸ëŸ´ í•„ìš”ë„ ì—†ë‹¤ê³  í–ˆë‹¤. (í‘œí˜„ì  ì°¨ì´) ë”°ë¼ì„œ, GameManager ëŒ€ì‹  ê·¸ëƒ¥ BaseBallGameì´ë¼ëŠ” ê²Œì„ ê°ì²´ê°€ ê²Œì„ì„ ì‹¤í–‰í•˜ê³ , ì¢…ë£Œí•˜ëŠ” ì—­í• ì„ í•˜ê²Œ í•˜ë©´ ë  ê²ƒ ê°™ë‹¤. ì±…ì„ ë¶„ë°° Player ê²Œì„ì„ ì‹œì‘, ì¢…ë£Œ ì˜ì‚¬ë¥¼ ë°íŒë‹¤. ìˆ«ìë¥¼ Messengerì—ê²Œ ì „ë‹¬í•œë‹¤. ìœ íš¨í•œ ìˆ«ìì¸ì§€ ê²€ì¦í•œë‹¤. BaseBallGame ê²Œì„ ì‹œì‘, ë˜ëŠ” ì¢…ë£Œ Playerì—ê²Œ ì‹œì‘/ì¢…ë£Œ ì˜ì‚¬ë¥¼ ë¬»ëŠ”ë‹¤. Player -&gt; Opponentë¡œ ìˆ«ì ì „ë‹¬ Opponent -&gt; Viewë¡œ ê²°ê³¼ ì „ë‹¬ Opponent ì „ë‹¬ë°›ëŠ” ìˆ«ìì— ëŒ€í•œ ì•¼êµ¬ ê²°ê³¼ë¥¼ ë¦¬í„´í•œë‹¤. í”„ë¡œê·¸ë˜ë° ìš”êµ¬ì‚¬í•­ ìë°” ì½”ë“œ ì»¨ë²¤ì…˜ì„ ì§€í‚¤ë©´ì„œ í”„ë¡œê·¸ë˜ë°í•œë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ Google Java Style Guideì„ ì›ì¹™ìœ¼ë¡œ í•œë‹¤. ë‹¨, ë“¤ì—¬ì“°ê¸°ëŠ” â€˜2 spacesâ€™ê°€ ì•„ë‹Œ â€˜4 spacesâ€™ë¡œ í•œë‹¤. indent(ì¸ë´íŠ¸, ë“¤ì—¬ì“°ê¸°) depthë¥¼ 2ê°€ ë„˜ì§€ ì•Šë„ë¡ êµ¬í˜„í•œë‹¤. 1ê¹Œì§€ë§Œ í—ˆìš©í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ whileë¬¸ ì•ˆì— ifë¬¸ì´ ìˆìœ¼ë©´ ë“¤ì—¬ì“°ê¸°ëŠ” 2ì´ë‹¤. íŒíŠ¸: indent(ì¸ë´íŠ¸, ë“¤ì—¬ì“°ê¸°) depthë¥¼ ì¤„ì´ëŠ” ì¢‹ì€ ë°©ë²•ì€ í•¨ìˆ˜(ë˜ëŠ” ë©”ì†Œë“œ)ë¥¼ ë¶„ë¦¬í•˜ë©´ ëœë‹¤. else ì˜ˆì•½ì–´ë¥¼ ì“°ì§€ ì•ŠëŠ”ë‹¤. íŒíŠ¸: if ì¡°ê±´ì ˆì—ì„œ ê°’ì„ returní•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ë©´ elseë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ëœë‹¤. elseë¥¼ ì“°ì§€ ë§ë¼ê³  í•˜ë‹ˆ switch/caseë¡œ êµ¬í˜„í•˜ëŠ” ê²½ìš°ê°€ ìˆëŠ”ë° switch/caseë„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ëª¨ë“  ë¡œì§ì— ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ êµ¬í˜„í•œë‹¤. ë‹¨, UI(System.out, System.in) ë¡œì§ì€ ì œì™¸ í•µì‹¬ ë¡œì§ì„ êµ¬í˜„í•˜ëŠ” ì½”ë“œì™€ UIë¥¼ ë‹´ë‹¹í•˜ëŠ” ë¡œì§ì„ êµ¬ë¶„í•œë‹¤. UI ë¡œì§ì„ InputView, ResultViewì™€ ê°™ì€ í´ë˜ìŠ¤ë¥¼ ì¶”ê°€í•´ ë¶„ë¦¬í•œë‹¤. 3í•­ ì—°ì‚°ìë¥¼ ì“°ì§€ ì•ŠëŠ”ë‹¤. í•¨ìˆ˜(ë˜ëŠ” ë©”ì†Œë“œ)ê°€ í•œ ê°€ì§€ ì¼ë§Œ í•˜ë„ë¡ ìµœëŒ€í•œ ì‘ê²Œ ë§Œë“¤ì–´ë¼. êµ¬í˜„ì‹œ ì–´ë ¤ì› ë˜ ë¶€ë¶„ ìˆ«ìì— ëŒ€í•´ 1ìŠ¤íŠ¸ë¼ì´í¬, 2ë³¼ ë“±ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ë©”ì„œë“œë¥¼ êµ¬í˜„í•  ë•Œ indent(ì¸ë´íŠ¸, ë“¤ì—¬ì“°ê¸°) depthë¥¼ 2ê°€ ë„˜ì§€ ì•Šë„ë¡ êµ¬í˜„í•œë‹¤. 1ê¹Œì§€ë§Œ í—ˆìš©í•œë‹¤ ì´ ê·œì¹™ì„ ì§€í‚¤ê¸°ê°€ ì–´ë µë‹¤. (3í•­ ì—°ì‚°ìë¥¼ ì“°ì§€ ì•ŠëŠ”ë‹¤. ë¼ëŠ” ê·œì¹™ë„ ìˆê¸° ë–„ë¬¸ì—..) play() ë‚´ë¶€ì— UI ê´€ë ¨ ë¡œì§ì´ ë“¤ì–´ê°€ë²„ë ¸ë‹¤ â€¦ ë¶„ë¦¬í• ìˆ˜ëŠ” ì—†ì„ê¹Œ êµ¬í˜„í•´ë†“ê³  ë³´ë‹ˆ í…ŒìŠ¤íŠ¸ í•˜ê¸°ê°€ ì–´ë µë‹¤ ì˜ˆë¥¼ ë“¤ì–´ ì•„ë˜ì™€ ê°™ì€ ë©”ì„œë“œì— ëŒ€í•´ì„œëŠ” ì–´ë–»ê²Œ í…ŒìŠ¤íŠ¸í•´ì•¼í• ê¹Œ ?? ê·¸ë¦¬ê³  ì™œ í˜„ì¬ëŠ” í…ŒìŠ¤íŠ¸í•˜ê¸°ê°€ ì–´ë ¤ìš´ ì½”ë“œì¸ê±¸ê¹Œ ?? â€˜í…ŒìŠ¤íŠ¸â€™ë¼ëŠ” ê²ƒì€ ê²°êµ­ íŠ¹ì • input ì¼ ë•Œ íŠ¹ì • outputì´ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ë¼ê³  ìƒê°í•˜ëŠ”ë° keepContinue() ë©”ì„œë“œì˜ ê²½ìš°, inputì„ ì™¸ë¶€ì—ì„œ ì…ë ¥í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì–´ë–¤ inputì— ëŒ€í•œ outputì´ ë¬´ì—‡ì´ë‹¤ ë¼ê³  ì‘ì„±í•  ìˆ˜ê°€ ì—†ë‹¤. public class Player { private final Scanner sc = new Scanner(System.in); public boolean keepContinue() { int continueFlag = sc.nextInt(); if(continueFlag==1) { return true; } return false; } public int getPredictNumber() { return sc.nextInt(); }} ê·¼ë° í…ŒìŠ¤íŠ¸ë¥¼ íŠ¹ì • input ì¼ ë•Œ íŠ¹ì • outputì´ ë‚˜ì˜¤ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒë¼ê³  ì •ì˜í•˜ë©´ ë¦¬í„´ê°’ voidì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ëŠ” ì–´ë–»ê²Œí•´ì•¼í•˜ì§€ ?? (setNumberì´ëŸ°ê±°) " }, { "title": "MySQL - MySQL ì‹¤í–‰ ê³„íš (3)", "url": "/posts/execution-plan-part3/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "MySQL", "date": "2021-10-09 23:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ì‹¤í–‰ ê³„íšì„ ë‚˜íƒ€ë‚´ëŠ” í…Œì´ë¸”ì˜ ë‹¤ì–‘í•œ ì»¬ëŸ¼ë“¤ ì¤‘ possible_keys, key, key_len, ref, rows, Extra ì»¬ëŸ¼ì— ëŒ€í•´ ì‚´í´ë³¼ ê²ƒì´ë‹¤. ë˜í•œ EXPLAIN ëª…ë ¹ ì´ì™¸ì— EXPLAIN EXTENDED, EXPLAIN PARTITIONS ëŒ€í•´ì„œë„ ì•Œì•„ë³´ì.â€» ì‹¤í–‰ ê³„íš 1í¸, ì‹¤í–‰ ê³„íš 2í¸ì„ ë¨¼ì € ì½ìœ¼ì‹¤ ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤...", "content": "ë“¤ì–´ê°€ê¸° ì „ì‹¤í–‰ ê³„íšì„ ë‚˜íƒ€ë‚´ëŠ” í…Œì´ë¸”ì˜ ë‹¤ì–‘í•œ ì»¬ëŸ¼ë“¤ ì¤‘ possible_keys, key, key_len, ref, rows, Extra ì»¬ëŸ¼ì— ëŒ€í•´ ì‚´í´ë³¼ ê²ƒì´ë‹¤. ë˜í•œ EXPLAIN ëª…ë ¹ ì´ì™¸ì— EXPLAIN EXTENDED, EXPLAIN PARTITIONS ëŒ€í•´ì„œë„ ì•Œì•„ë³´ì.â€» ì‹¤í–‰ ê³„íš 1í¸, ì‹¤í–‰ ê³„íš 2í¸ì„ ë¨¼ì € ì½ìœ¼ì‹¤ ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.possible_keys ì»¬ëŸ¼ ì˜µí‹°ë§ˆì´ì €ê°€ ìµœì ì˜ ì‹¤í–‰ ê³„íšì„ ë§Œë“¤ê¸° ìœ„í•´ í›„ë³´ë¡œ ì„ ì •í–ˆë˜ ì ‘ê·¼ ë°©ì‹ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì¸ë±ìŠ¤ì˜ ëª©ë¡ì´ë‹¤. ì¦‰, ì‚¬ìš©ë  ë²•í–ˆë˜ ì¸ë±ìŠ¤ì˜ ëª©ë¡ì´ë‹¤. í•´ë‹¹ í…Œì´ë¸”ì˜ ëª¨ë“  ì¸ë±ìŠ¤ê°€ í¬í•¨ë˜ì–´ ë‚˜ì˜¤ëŠ” ê²½ìš°ê°€ ë§ê¸° ë•Œë¬¸ì— ì¿¼ë¦¬ë¥¼ íŠœë‹í•˜ëŠ” ë° ë„ì›€ì´ ë˜ì§€ ì•ŠëŠ”ë‹¤.key ì»¬ëŸ¼ ìµœì¢… ì„ íƒëœ ì‹¤í–‰ ê³„íšì—ì„œ ì‚¬ìš©í•˜ëŠ” ì¸ë±ìŠ¤ì´ë‹¤. ì¿¼ë¦¬ë¥¼ íŠœë‹í•  ë•ŒëŠ” key ì»¬ëŸ¼ì— ì˜ë„í–ˆë˜ ì¸ë±ìŠ¤ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤. ê°’ì´ â€˜PRIMARYâ€™ì¸ ê²½ìš°ì—ëŠ” í”„ë¼ì´ë¨¸ë¦¬ í‚¤ë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤. ê·¸ ì™¸ì—ëŠ” ëª¨ë‘ í…Œì´ë¸”ì´ë‚˜ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•  ë•Œ ë¶€ì—¬í–ˆë˜ ê³ ìœ  ì´ë¦„ì´ë‹¤. í…Œì´ë¸” í’€ ìŠ¤ìº” ë°©ì‹ ì²˜ëŸ¼ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°ì—ëŠ” â€˜NULLâ€™ë¡œ í‘œì‹œëœë‹¤. type ì»¬ëŸ¼ì˜ ê°’ì´ â€˜index_mergeâ€™ì¸ ê²½ìš°ì—ëŠ” 2ê°œ ì´ìƒì˜ ê°’ì´ í‘œì‹œëœë‹¤. key_len ì»¬ëŸ¼ ë‹¨ì¼, ë‹¤ì¤‘ ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ì„±ëœ ì¸ë±ìŠ¤ì—ì„œ ëª‡ ê°œì˜ ì»¬ëŸ¼ê¹Œì§€ ì‚¬ìš©í–ˆëŠ”ì§€ ì•Œë ¤ì¤€ë‹¤. ì¦‰, ê° ë ˆì½”ë“œì—ì„œ ëª‡ ë°”ì´íŠ¸ê¹Œì§€ ì‚¬ìš©í–ˆëŠ”ì§€ë¥¼ ì•Œë ¤ì£¼ëŠ” ê°’ì´ë‹¤. dept_emp í…Œì´ë¸”ì˜ í”„ë¼ì´ë¨¸ë¦¬ í‚¤ëŠ” dept_no, emp_no ë‘ ê°œì˜ ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ìˆë‹¤. dept_no ì»¬ëŸ¼ì˜ íƒ€ì…ì€ CHAR(4)ì´ë©° UTF8 ë¬¸ìì§‘í•©ì„ ì‚¬ìš©í•œë‹¤. ì•„ë˜ ì¿¼ë¦¬ëŠ” ì¡°íšŒì‹œ dept_noë§Œ ì‚¬ìš©í•˜ê³  ìˆìœ¼ë¯€ë¡œ ê²°ê³¼ì ìœ¼ë¡œ key_lenì˜ ê°’ì€ 12ë¡œ í‘œì‹œëœë‹¤. ì¦‰, UTF8 ë¬¸ìë¥¼ ìœ„í•œ ë©”ëª¨ë¦¬ ê³µê°„ì€ 3ë°”ì´íŠ¸ì´ê¸° ë•Œë¬¸ì— 3*4=12(byte) ë¼ëŠ” ê°’ì´ ë„ì¶œëœë‹¤. EXPLAINSELECT * FROM dept_emp WHERE dept_no='d005'; id select_type table type key key_len ref rows Extra 1 SIMPLE dept_emp ref PRIMARY 12 const 53288 Using where í”„ë¼ì´ë¨¸ë¦¬ í‚¤ë¥¼ êµ¬ì„±í•˜ëŠ” ë‘ ê°œì˜ ì»¬ëŸ¼ì„ ë‹¤ ì‚¬ìš©í•œ ê²½ìš°ì´ë‹¤. emp_no ì»¬ëŸ¼ íƒ€ì…ì€ INTEGERì´ë©° 4ë°”ì´íŠ¸ë¥¼ ì°¨ì§€í•œë‹¤. EXPLAINSELECT * FROM dept_emp WHERE dept_no='d005' AND emp_no=10001; id select_type table type key key_len ref rows Extra 1 SIMPLE dept_emp ref PRIMARY 16 const,const 1 Â  MySQL 5.0 vs MySQL 5.1 ì•„ë˜ì™€ ê°™ì€ ì¿¼ë¦¬ê°€ ìˆì„ ë•Œ MySQL 5.0 ë²„ì „ê³¼ 5.1 ë²„ì „ì—ì„œì˜ ê²°ê³¼ê°€ ì–´ë–¤ ì°¨ì´ê°€ ìˆëŠ”ì§€ ì‚´í´ë³´ì.dept_emp í…Œì´ë¸”ì˜ í”„ë¼ì´ë¨¸ë¦¬ í‚¤ëŠ” dept_no, emp_noìœ¼ë¡œ êµ¬ì„±ëœë‹¤.EXPLAINSELECT * FROM dept_emp WHERE dept_no='d005' AND emp_no &lt;&gt; 10001; MySQL 5.0 ì´í•˜ í”„ë¼ì´ë¨¸ë¦¬ í‚¤ì¸ dept_no, emp_noì„ ëª¨ë‘ ì‚¬ìš©í–ˆì§€ë§Œ key_lenì€ 16ì´ ì•„ë‹Œ 12ë¡œ í‘œì‹œëœë‹¤. ê·¸ ì´ìœ ëŠ” key_lenì— í‘œì‹œë˜ëŠ” ê°’ì€ ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•´ ë²”ìœ„ë¥¼ ì œí•œí•˜ëŠ” ì¡°ê±´ì˜ ì»¬ëŸ¼ê¹Œì§€ë§Œ í¬í•¨ë˜ê¸° ë•Œë¬¸ì´ë‹¤. ì¦‰, ì²´í¬ ì¡°ê±´(emp_no &lt;&gt; 10001)ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” emp_noì˜ ê²½ìš°ëŠ” key_lenì— í¬í•¨ë˜ì§€ ì•ŠëŠ”ë‹¤. ê²°ê³¼ì ìœ¼ë¡œ 5.0 ì´í•˜ ë²„ì „ì—ì„œëŠ” key_len ì»¬ëŸ¼ì˜ ê°’ìœ¼ë¡œ ì¸ë±ìŠ¤ì˜ ëª‡ ë°”ì´íŠ¸ê¹Œì§€ê°€ ë²”ìœ„ ì œí•œ ì¡°ê±´ìœ¼ë¡œ ì‚¬ìš©ëëŠ”ì§€ íŒë‹¨í•  ìˆ˜ ìˆë‹¤. id select_type table type key key_len ref rows Extra 1 SIMPLE dept_emp ref PRIMARY 12 const 53298 Using where MySQL 5.1 ì´ìƒ ì²´í¬ ì¡°ê±´ì— í¬í•¨ë˜ëŠ” ì»¬ëŸ¼ê¹Œì§€ ê³„ì‚°ëœ ê°’ì´ key_lenì— í‘œì‹œëœë‹¤. ê²°ê³¼ì ìœ¼ë¡œ ì¸ë±ìŠ¤ì˜ ëª‡ ë°”ì´íŠ¸ê¹Œì§€ê°€ ë²”ìœ„ ì œí•œ ì¡°ê±´ìœ¼ë¡œ ì‚¬ìš©ëëŠ”ì§€ ì•Œ ìˆ˜ ì—†ë‹¤. id select_type table type key key_len ref rows Extra 1 SIMPLE dept_emp range PRIMARY 16 Â  53298 Using where ì»¨ë””ì…˜ í‘¸ì‹œ ë‹¤ìš´(Condition push down) ìœ„ì—ì„œ ì‚´í´ë³¸ ì°¨ì´ëŠ” ë²„ì „ì´ ì˜¬ë¼ê°€ë©´ì„œ MySQL ì—”ì§„ê³¼ InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì˜ ì—­í•  ë¶„ë‹´ì— ë³€í™”ê°€ ìƒê²¼ê¸° ë•Œë¬¸ì´ë‹¤. 5.0 ë²„ì „ê¹Œì§€ëŠ” ë²”ìœ„ ì œí•œ ì¡°ê±´ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼ë§Œ ìŠ¤í† ë¦¬ì§€ ì—”ì§„ìœ¼ë¡œ ì „ë‹¬í–ˆë‹¤. 5.1 ë²„ì „ë¶€í„°ëŠ” ë²”ìœ„ ì œí•œ ì¡°ê±´ì´ë“  ì²´í¬ ì¡°ê±´ì´ë“  ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ë§Œ ìˆë‹¤ë©´ ëª¨ë‘ ìŠ¤í† ë¦¬ì§€ ì—”ì§„ìœ¼ë¡œ ì „ë‹¬í•œë‹¤. ì´ë¥¼ ì»¨ë””ì…˜ í‘¸ì‹œ ë‹¤ìš´ì´ë¼ê³  í•œë‹¤. ref ì»¬ëŸ¼ type ì»¬ëŸ¼ì˜ ê°’(ì ‘ê·¼ ë°©ì‹)ì´ â€˜refâ€™ì´ë©´ ref ì»¬ëŸ¼ì—ì„œëŠ” ì–´ë–¤ ê°’ì´ ì œê³µëëŠ”ì§€ í‘œì‹œëœë‹¤. ìƒìˆ˜ ê°’ì„ ì§€ì •í–ˆë‹¤ë©´ ref ì»¬ëŸ¼ì˜ ê°’ì€ constë¡œ í‘œì‹œëœë‹¤. ë‹¤ë¥¸ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ì´ë¼ë©´ ê·¸ í…Œì´ë¸” ëª…ê³¼ ì»¬ëŸ¼ ëª…ì´ í‘œì‹œëœë‹¤.EXPLAINSELECT * FROM employees e, dept_emp deWHERE e.emp_no=de.emp_no; id select_type table type key key_len ref rows Extra 1 SIMPLE de ALL Â  Â  Â  334868 Â  1 SIMPLE e eq_ref PRIMARY 4 de.emp_no 1 Â  ë§Œì•½ ref ì»¬ëŸ¼ì˜ ê°’ì´ â€˜funcâ€™ë¼ë©´ ì´ëŠ” ì°¸ì¡°ìš©ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê°’ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œ ê²ƒì´ ì•„ë‹ˆë¼, ì½œë ˆì´ì…˜ ë³€í™˜ì´ë‚˜ ê°’ ìì²´ì˜ ì—°ì‚°ì„ ê±°ì³ì„œ ì°¸ì¡°ëë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ ê°’ì„ ë³€í™˜í•  ë•Œë¿ë§Œ ì•„ë‹ˆë¼ MySQL ì„œë²„ê°€ ë‚´ë¶€ì ìœ¼ë¡œ ê°’ì„ ë³€í™˜í•´ì•¼ í•  ë•Œë„ â€˜funcâ€™ê°€ ì¶œë ¥ëœë‹¤. ëŒ€í‘œì ì¸ ê²½ìš°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ë¬¸ìì§‘í•©ì´ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ë‘ ë¬¸ìì—´ ì»¬ëŸ¼ì„ ì¡°ì¸í•˜ëŠ” ê²½ìš° ìˆ«ì íƒ€ì…ì˜ ì»¬ëŸ¼ê³¼ ë¬¸ìì—´ íƒ€ì…ì˜ ì»¬ëŸ¼ìœ¼ë¡œ ì¡°ì¸í•˜ëŠ” ê²½ìš° ê°€ëŠ¥í•œ MySQLì´ ì´ëŸ° ë³€í™˜ì„ í•˜ì§€ ì•Šì•„ë„ ë˜ë„ë¡ ì¡°ì¸ ì»¬ëŸ¼ì˜ íƒ€ì…ì€ ì¼ì¹˜ì‹œí‚¤ëŠ” ê²ƒì´ ì¢‹ë‹¤.EXPLAINSELECT * FROM employees e, dept_emp deWHERE e.emp_no=(de.emp_no-1); id select_type table type key key_len ref rows Extra 1 SIMPLE de ALL Â  Â  Â  334868 Â  1 SIMPLE e eq_ref PRIMARY 4 func 1 Â  rows ì»¬ëŸ¼ ì‹¤í–‰ ê³„íšì˜ íš¨ìœ¨ì„± íŒë‹¨ì„ ìœ„í•´ ì˜ˆì¸¡í–ˆë˜ ë ˆì½”ë“œ ê±´ìˆ˜ë¥¼ ë³´ì—¬ì¤€ë‹¤. ê° ìŠ¤í† ë¦¬ì§€ ì—”ì§„ë³„ë¡œ ê°–ê³  ìˆëŠ” í†µê³„ ì •ë³´ë¥¼ ì°¸ì¡°í•´ ì˜µí‹°ë§ˆì´ì €ê°€ ì‚°ì¶œí•œ ì˜ˆìƒ ê°’ì´ë¼ ì •í™•í•˜ì§€ëŠ” ì•Šë‹¤. ê° ì‹¤í–‰ ê³„íšì˜ ë¹„ìš©ì„ ì‚°ì •í•˜ëŠ” ë°©ë²•ì€ ê° ì²˜ë¦¬ ë°©ì‹ì´ ì–¼ë§ˆë‚˜ ë§ì€ ë ˆì½”ë“œë¥¼ ì½ê³  ë¹„êµí•´ì•¼ í•˜ëŠ”ì§€ ì˜ˆì¸¡í•´ ë³´ëŠ” ê²ƒì´ë‹¤. ì¦‰, ëŒ€ìƒ í…Œì´ë¸”ì— ì–¼ë§ˆë‚˜ ë§ì€ ë ˆì½”ë“œê°€ í¬í•¨ë˜ëŠ”ì§€, ì¸ë±ìŠ¤ ê°’ì˜ ë¶„í¬ë„ê°€ ì–´ë–¤ì§€ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¡°ì‚¬í•´ì„œ ì˜ˆì¸¡í•œë‹¤. rows ì»¬ëŸ¼ì— í‘œì‹œë˜ëŠ” ê°’ì€ ë°˜í™˜í•˜ëŠ” ë ˆì½”ë“œì˜ ì˜ˆì¸¡ì¹˜ê°€ ì•„ë‹ˆë¼, ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì–¼ë§ˆë‚˜ ë§ì€ ë ˆì½”ë“œë¥¼ ë””ìŠ¤í¬ë¡œë¶€í„° ì½ê³  ì²´í¬í•´ì•¼ í•˜ëŠ”ì§€ë¥¼ ì˜ë¯¸í•œë‹¤. ì•„ë˜ ì¿¼ë¦¬ì˜ ê²½ìš° ix_fromdate ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆì—ˆì§€ë§Œ, ê²°ê³¼ì ìœ¼ë¡œëŠ” í…Œì´ë¸” í’€ ìŠ¤ìº”(ALL) ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤. dept_emp í…Œì´ë¸”ì˜ ì „ì²´ ë ˆì½”ë“œëŠ” 331,603 ê±´ì´ë¼ê³  í•œë‹¤. rows ì»¬ëŸ¼ì„ ë³´ë©´ ì˜µí‹°ë§ˆì´ì €ëŠ” ì´ ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ëŒ€ëµ 334,868ê±´ì˜ ë ˆì½”ë“œë¥¼ ì½ì–´ì•¼ í•  ê²ƒì´ë¼ê³  ì˜ˆì¸¡í–ˆë‹¤. ì¦‰, ì˜µí‹°ë§ˆì´ì €ëŠ” ì „ì²´ ë ˆì½”ë“œì˜ ëŒ€ë¶€ë¶„ì„ ë¹„êµí•´ë´ì•¼ í•œë‹¤ê³  íŒë‹¨í–ˆê¸° ë•Œë¬¸ì— ì¸ë±ìŠ¤ ë ˆì¸ì§€ ìŠ¤ìº”ì´ ì•„ë‹Œ â€˜ALLâ€™ì„ ì„ íƒí–ˆë‹¤. EXPLAINSELECT * FROM dept_emp WHERE from_date&gt;='1985-01-01'; id select_type table type possible_keys key key_len ref rows Extra 1 SIMPLE dept_emp ALL ix_fromdate Â  Â  Â  334868 Usingwhere ìœ„ì˜ ì¿¼ë¦¬ì—ì„œ ë²”ìœ„ë¥¼ ì¢í˜€ë³´ì. ì˜µí‹°ë§ˆì´ì €ëŠ” 292 ê±´ì˜ ë ˆì½”ë“œ(ì „ì²´ ë ˆì½”ë“œì˜ 8.8%)ë¥¼ ì½ìœ¼ë©´ ì•„ë˜ ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆì„ ê²ƒìœ¼ë¡œ ì˜ˆì¸¡í–ˆë‹¤. ë”°ë¼ì„œ, ì¸ë±ìŠ¤ ë ˆì¸ì§€ ìŠ¤ìº” ë°©ì‹ì„ ì„ íƒí–ˆë‹¤. EXPLAINSELECT * FROM dept_emp WHERE from_date&gt;='2002-07-01'; id select_type table type possible_keys key key_len ref rows Extra 1 SIMPLE dept_emp range ix_fromdate ix_fromdate 3 Â  292 Usingwhere Extra ì»¬ëŸ¼ì»¬ëŸ¼ì˜ ì´ë¦„ê³¼ ë‹¬ë¦¬, ì„±ëŠ¥ì— ê´€ë ¨ëœ ì¤‘ìš”í•œ ë‚´ìš©ì´ ìì£¼ í‘œì‹œëœë‹¤. ë‹¤ ì•Œì•„ë³´ê¸°ì—” ë„ˆë¬´ ë§ê¸° ë•Œë¬¸ì— ì¹´í…Œê³ ë¦¬ ë³„ë¡œ ë‚˜ëˆ ì„œ ëª‡ ê°€ì§€ë§Œ ì‚´í´ë³´ì. 1. ì¿¼ë¦¬ê°€ ìš”ê±´ì„ ì œëŒ€ë¡œ ë°˜ì˜í•˜ê³  ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•˜ëŠ” ê²½ìš° ì•„ë˜ì™€ ê°™ì€ ì½”ë©˜íŠ¸ê°€ í‘œì‹œëœë‹¤ë©´ ì¿¼ë¦¬ê°€ ìš”ê±´ì„ ì œëŒ€ë¡œ ë°˜ì˜í•´ì„œ ì‘ì„±ëëŠ”ì§€, ë²„ê·¸ê°€ ìƒê¸¸ ê°€ëŠ¥ì„±ì€ ì—†ëŠ”ì§€ í™•ì¸í•´ì•¼ í•œë‹¤.ì¦‰, ì•„ë˜ í•­ëª©ë“¤ì€ â€œì´ëŸ° ë ˆì½”ë“œê°€ ì—†ìŒâ€ì´ë¼ëŠ” ì˜ë¯¸ê°€ ê°•í•˜ê¸° ë•Œë¬¸ì—, ì´ë¡œ ì¸í•œ ë²„ê·¸ì˜ ê°€ëŠ¥ì„±ì— ëŒ€í•´ ê²€í† í•´ì•¼ í•œë‹¤.í•œ ê°€ì§€ ì£¼ì˜í•  ì ì€ â€˜Impossible WHERE â€¦â€™, â€˜No matching â€¦â€™ ë“±ì˜ ë©”ì‹œì§€ëŠ” ì¿¼ë¦¬ì˜ ì‹¤í–‰ ê³„íšì„ ì‚°ì¶œí•˜ê¸° ìœ„í•œ ê¸°ì´ˆ ìë£Œê°€ ì—†ìŒì„ í‘œí˜„í•˜ëŠ” ê²ƒì´ë¯€ë¡œì‹¤ì œ ì¿¼ë¦¬ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ê³  ìƒê°í•´ì„œëŠ” ì•ˆëœë‹¤.Full scan on NULL key col1 IN (SELECT ... FROM ...)ê³¼ ê°™ì€ ì¡°ê±´ì—ì„œ col1ì´ NULLì¸ ê²½ìš° ì˜ˆë¹„ì±…ìœ¼ë¡œ í’€ í…Œì´ë¸” ìŠ¤ìº”ì„ ì‚¬ìš©í•  ê²ƒì´ë¼ëŠ” ì‚¬ì‹¤ì„ ì•Œë ¤ì£¼ëŠ” í‚¤ì›Œë“œì´ë‹¤. col1 IN (SELECT ... FROM ...)ê³¼ ê°™ì€ ì¡°ê±´ì´ í¬í•¨ëœ ì¿¼ë¦¬ì—ì„œ col1ì´ NULLì´ë¼ë©´? ì—°ì‚°ì„ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ìœ„ ì¡°ê±´ì€ ë‹¤ìŒê³¼ ê°™ì´ ë¹„êµë¼ì•¼ í•œë‹¤. ì„œë¸Œ ì¿¼ë¦¬ê°€ 1ê±´ì´ë¼ë„ ê²°ê³¼ ë ˆì½”ë“œë¥¼ ê°€ì§„ë‹¤ë©´ ìµœì¢… ë¹„êµ ê²°ê³¼ëŠ” NULL ì„œë¸Œ ì¿¼ë¦¬ê°€ 1ê±´ë„ ê²°ê³¼ ë ˆì½”ë“œë¥¼ ê°€ì§€ì§€ ì•ŠëŠ”ë‹¤ë©´ ìµœì¢… ë¹„êµ ê²°ê³¼ëŠ” FALSE ìœ„ì™€ ê°™ì€ ë¹„êµ ê³¼ì •ì€ col1ì´ NULLì´ê¸° ë•Œë¬¸ì—, í’€ í…Œì´ë¸” ìŠ¤ìº”ì„ í•´ì•¼ë§Œ ê²°ê³¼ë¥¼ ì•Œì•„ë‚¼ ìˆ˜ ìˆë‹¤. EXPLAINSELECT d.dept_no, NULL IN (SELECT id.dpet_name FROM departments id)FROM departments d; id select_type table type key key_len ref rows Extra 1 PRIMARY d index ux_deptname 123 NULL 9 Using index 1 DEPENDENTSUBQUERY id index_subquery ux_deptname 123 const 2 Using index;Full scan on NULL key ë§Œì•½ ì»¬ëŸ¼ì´ NOT NULLë¡œ ì •ì˜ë˜ì§€ëŠ” ì•Šì•˜ì§€ë§Œ ì´ëŸ¬í•œ NULL ë¹„êµ ê·œì¹™ì„ ë¬´ì‹œí•´ë„ ëœë‹¤ë©´, col1ì´ ì ˆëŒ€ NULLì´ ë  ìˆ˜ ì—†ë‹¤ëŠ” ê²ƒì„ ì˜µí‹°ë§ˆì´ì €ì—ê²Œ ì•Œë ¤ì£¼ë©´ ëœë‹¤. ëŒ€í‘œì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ë°©ë²•ì´ ìˆë‹¤. col1ì´ NULLì´ë©´ col1 IS NOT NULL ì¡°ê±´ì´ FALSEê°€ ë˜ê¸° ë•Œë¬¸ì— ê·¸ ì•„ë˜ ì¡°ê±´ì€ ì‹¤í–‰í•˜ì§€ ì•ŠëŠ”ë‹¤. EXPLAINSELECT * FROM tb_test1WHERE col1 IS NOT NULL AND col1 IN (SELECT col2 FROM tb_test2);Impossible HAVING (5.1 ë²„ì „ë¶€í„°) ì¿¼ë¦¬ì— ì‚¬ìš©ëœ HAVINGì ˆì˜ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ë ˆì½”ë“œê°€ ì—†ëŠ” ê²½ìš°ì´ë‹¤. ì´ëŸ° ê²½ìš°, ì¿¼ë¦¬ê°€ ì œëŒ€ë¡œ ì‘ì„±ë˜ì§€ ëª»í•œ ê²½ìš°ê°€ ëŒ€ë¶€ë¶„ì´ë¯€ë¡œ ë‹¤ì‹œ ê²€í† í•´ë³´ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì•„ë˜ ì¿¼ë¦¬ì—ì„œ emp_no ì»¬ëŸ¼ì€ í”„ë¼ì´ë¨¸ë¦¬ í‚¤ì´ë©´ì„œ NOT NULL íƒ€ì…ì˜ ì»¬ëŸ¼ì´ë‹¤. ë”°ë¼ì„œ, ì ˆëŒ€ e.emp_no IS NULL ì¡°ê±´ì„ ë§Œì¡±í•  ê°€ëŠ¥ì„±ì´ ì—†ë‹¤.EXPLAINSELECT e.emp_no, COUNT(*) AS cntFROM employees eWHERE e.emp_no=10001GROUP BY e.emp_noHAVING e.emp_no IS NULL; id select_type table type key key_len ref rows Extra 1 SIMPLE Â  Â  Â  Â  Â  Â  Impossible HAVING Impossible WHERE (5.1 ë²„ì „ë¶€í„°) WHERE ì¡°ê±´ì´ í•­ìƒ FALSEê°€ ë  ìˆ˜ ë°–ì— ì—†ëŠ” ê²½ìš°ì´ë‹¤.EXPLAINSELECT * FROM employees WHERE emp_no IS NULL; id select_type table type key key_len ref rows Extra 1 SIMPLE Â  Â  Â  Â  Â  Â  Impossible WHERE Impossible WHERE noticed after reading const tables ì¿¼ë¦¬ì—ì„œ const ì ‘ê·¼ ë°©ì‹ì´ í•„ìš”í•œ ë¶€ë¶„ì€ ì‹¤í–‰ ê³„íš ìˆ˜ë¦½ ë‹¨ê³„ì—ì„œ ì˜µí‹°ë§ˆì´ì €ê°€ ì§ì ‘ ì¿¼ë¦¬ì˜ ì¼ë¶€ë¥¼ ì‹¤í–‰í•˜ê³ , ì‹¤í–‰ëœ ê²°ê³¼ ê°’ì„ ì›ë³¸ ì¿¼ë¦¬ì˜ ìƒìˆ˜ë¡œ ëŒ€ì²´í•œë‹¤.ì´ ê³¼ì •ì„ ë§ˆì¹œ ë’¤, ë¶ˆê°€ëŠ¥í•œ ì¡°ê±´ìœ¼ë¡œ íŒë‹¨ë˜ëŠ” ê²½ìš°ì´ë‹¤. ì•„ë˜ì˜ ê²½ìš°, ì‹¤í–‰ ê³„íšë§Œ í™•ì¸í–ˆì„ ë¿ì¸ë°, ì˜µí‹°ë§ˆì´ì €ëŠ” ì‚¬ë²ˆì´ 0ë²ˆì¸ ì‚¬ì›ì´ ì—†ë‹¤ëŠ” ê²ƒê¹Œì§€ í™•ì¸í•œë‹¤.EXPLAINSELECT * FROM employees WHERE emp_no=0; id select_type table type key key_len ref rows Extra 1 SIMPLE Â  Â  Â  Â  Â  Â  Impossible WHERE noticedafter reading const tables No matching min/max row (5.1 ë²„ì „ë¶€í„°) MIN(), MAX()ì™€ ê°™ì€ ì§‘í•© í•¨ìˆ˜ê°€ ìˆëŠ” ì¿¼ë¦¬ì˜ ì¡°ê±´ì ˆì— ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œê°€ í•œ ê±´ë„ ì—†ëŠ” ê²½ìš°ì´ë‹¤, ì§‘í•© í•¨ìˆ˜ì˜ ê²°ê³¼ë¡œëŠ” NULLì´ ë°˜í™˜ëœë‹¤.EXPLAINSELECT MIN(dept_no), MAX(dept_no)FROM dept_emp WHERE dept_no=''; id select_type table type key key_len ref rows Extra 1 SIMPLE Â  Â  Â  Â  Â  Â  No matching min/max row No matching row in const table (5.1 ë²„ì „ë¶€í„°) ì¡°ì¸ì— ì‚¬ìš©ëœ í…Œì´ë¸”ì—ì„œ const ë°©ì‹ìœ¼ë¡œ ì ‘ê·¼í•  ë•Œ, ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œê°€ ì—†ëŠ” ê²½ìš°ì´ë‹¤.EXPLAINSELECT *FROM dept_emp de,(SELECT emp_no FROM employees WHERE emp_no=0) tb1WHERE tb1.emp_no=de.emp_no AND de.dept_no='d005'; id select_type table type key key_len ref rows Extra 1 PRIMARY Â  Â  Â  Â  Â  Â  Impossible WHERE noticedafter reading const tables 2 DERIVED Â  Â  Â  Â  Â  Â  no matching row in const table Unique row not found (5.1 ë²„ì „ë¶€í„°) ë‘ ê°œì˜ í…Œì´ë¸”ì´ ê°ê° ìœ ë‹ˆí¬(í”„ë¼ì´ë¨¸ë¦¬ í‚¤ í¬í•¨) ì»¬ëŸ¼ìœ¼ë¡œ ì•„ìš°í„° ì¡°ì¸ì„ ìˆ˜í–‰í•˜ëŠ” ì¿¼ë¦¬ì—ì„œ, ì•„ìš°í„° í…Œì´ë¸”ì— ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œê°€ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì´ë‹¤. t2 í…Œì´ë¸”ì— í”„ë¼ì´ë¨¸ë¦¬ í‚¤ì¸ fdpkì˜ ê°’ì´ 1ì¸ ë ˆì½”ë“œë§Œ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì.EXPLAINSELECT t1.fdpkFROM tb_test1 t1 LEFT JOIN tb_test2 t2 ON t2.fdpk=t1.fdpkWHERE t1.fdpk=2; id select_type table type key key_len ref rows Extra 1 SIMPLE t1 const PRIMARY 4 const 1 Using index 2 SIMPLE t2 const PRIMARY 4 const 0 unique row not found 2. ì¿¼ë¦¬ì˜ ì‹¤í–‰ ê³„íšì´ ì¢‹ì§€ ì•Šì€ ê²½ìš° ì•„ë˜ì™€ ê°™ì€ ì½”ë©˜íŠ¸ê°€ í‘œì‹œëœë‹¤ë©´ ì¿¼ë¦¬ë¥¼ ë” ìµœì í™”í•  ìˆ˜ ìˆëŠ”ì§€ ê²€í† í•´ë³´ëŠ” ê²ƒì´ ì¢‹ë‹¤. íŠ¹íˆ, â€˜Using whereâ€™ì˜ ê²½ìš° ëŒ€ë¶€ë¶„ì˜ ì¿¼ë¦¬ì—ì„œ í‘œì‹œë˜ê¸° ë•Œë¬¸ì— ê·¸ëƒ¥ ì§€ë‚˜ì¹˜ê¸° ì‰¬ìš´ë°,ë§Œì•½ ì‹¤í–‰ ê³„íšì˜ rows ì»¬ëŸ¼ ê°’ì´ ì‹¤ì œ SELECTë˜ëŠ” ë ˆì½”ë“œ ê±´ìˆ˜ë³´ë‹¤ í›¨ì”¬ ë” ë†’ì€ ê²½ìš°ì—ëŠ” ë‘˜ì˜ ì°¨ì´ë¥¼ ì¤„ì´ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.Range checked for each record (index map:N) ë§¤ ë ˆì½”ë“œë§ˆë‹¤ ì¸ë±ìŠ¤ ë ˆì¸ì§€ ìŠ¤ìº”ì„ í• ì§€, í’€ í…Œì´ë¸” ìŠ¤ìº”ì„ í• ì§€ ê²°ì •í•œë‹¤. ì•„ë˜ ì¿¼ë¦¬ ì²˜ëŸ¼ ì¡°ì¸ ì¡°ê±´ì— ìƒìˆ˜ê°€ ì—†ê³  ë‘˜ ë‹¤ ë³€ìˆ˜ì¸ ê²½ìš°, e1 í…Œì´ë¸”ì˜ ë ˆì½”ë“œë¥¼ í•˜ë‚˜ì”© ì½ì„ ë•Œ ë§ˆë‹¤ e1.emp_no ê°’ì´ ê³„ì† ë°”ë€Œë¯€ë¡œ ì¿¼ë¦¬ì˜ ë¹„ìš© ê³„ì‚°ì„ ìœ„í•œ ê¸°ì¤€ê°’ì´ ê³„ì† ë³€í•œë‹¤. ë”°ë¼ì„œ, ì–´ë–¤ ì ‘ê·¼ ë°©ë²•ìœ¼ë¡œ e2 í…Œì´ë¸”ì„ ì½ëŠ” ê²ƒì´ ì¢‹ì„ì§€ íŒë‹¨í•  ìˆ˜ ì—†ëŠ” ê²ƒì´ë‹¤. â€˜(index map: 0x1)â€™ì€ ì‚¬ìš©í• ì§€ ë§ì§€ë¥¼ íŒë‹¨í•˜ëŠ” í›„ë³´ ì¸ë±ìŠ¤ì˜ ìˆœë²ˆì„ ë‚˜íƒ€ë‚¸ë‹¤. ì–´ë–¤ ì¸ë±ìŠ¤ì¸ì§€ í™•ì¸í•˜ë ¤ë©´ 16ì§„ìˆ˜ë¥¼ 2ì§„ìˆ˜ë¡œ ë°”ê¿”ì•¼í•œë‹¤. 0x1ì€ ì´ì§„ìˆ˜ 1ì´ê¸° ë•Œë¬¸ì— ì´ëŠ” ì²« ë²ˆì§¸ ì¸ë±ìŠ¤ë¥¼ ì˜ë¯¸íŒë‹¤. SHOW CREATE TABLE employees ëª…ë ¹ì–´ë¥¼ í†µí•´ ì¸ë±ìŠ¤ ìˆœì„œë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. typeì— â€˜ALLâ€™ë¡œ í‘œì‹œë˜ì—ˆì§€ë§Œ ë¬´ì¡°ê±´ í’€ í…Œì´ë¸” ìŠ¤ìº”ì„ í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. ì¦‰, â€˜Range checked for each recordâ€™ì¸ ê²½ìš°ì—ëŠ” í›„ë³´ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í• ì§€ë¥¼ ê²€í† í•´ì„œ, ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš° â€˜ALLâ€™ ì ‘ê·¼ ë°©ë²•ì„ ì‚¬ìš©í•œë‹¤. EXPLAINSELECT *FROM employees e1, employees e2WHERE e2.emp_no &gt;= e1.emp_no; id select_type table type key key_len ref rows Extra 1 SIMPLE e1 ALL Â  3 Â  300584 Using index 2 SIMPLE e2 ALL Â  3 Â  300584 Range checked foreach record(index map: 0x1) Using filesort ORDER BY ì²˜ë¦¬ê°€ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°ì´ë‹¤. ì¡°íšŒëœ ë ˆì½”ë“œë¥¼ ì •ë ¬í•˜ê¸° ìœ„í•´, ì •ë ¬ìš© ë©”ëª¨ë¦¬ ë²„í¼(sort buffer)ì— ë³µì‚¬í•´ì„œ í€µ ì†ŒíŠ¸ ì•Œê³ ë¦¬ì¦˜ì„ ìˆ˜í–‰í•œë‹¤. ì´ëŸ¬í•œ ê²½ìš°ëŠ” ë§ì€ ë¶€í•˜ë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆìœ¼ë¯€ë¡œ, ì¿¼ë¦¬ë¥¼ íŠœë‹í•˜ê±°ë‚˜ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.Using join buffer (5.1 ë²„ì „ë¶€í„°) ì¡°ì¸ ë²„í¼ê°€ ì‚¬ìš©ë˜ëŠ” ì‹¤í–‰ ê³„íšì´ë‹¤. ì¡°ì¸ ë²„í¼ëŠ” ì½ì€ ë ˆì½”ë“œë¥¼ ì„ì‹œë¡œ ë³´ê´€í•´ë‘ëŠ” ë©”ëª¨ë¦¬ ê³µê°„ì´ë‹¤. ì‹¤ì œë¡œ ì¡°ì¸ì— í•„ìš”í•œ ì¸ë±ìŠ¤ëŠ” ì¡°ì¸ì—ì„œ ë’¤ì— ì½ëŠ” í…Œì´ë¸”(ë“œë¦¬ë¸ í…Œì´ë¸”)ì˜ ì»¬ëŸ¼ì—ë§Œ í•„ìš”í•˜ë‹¤. ë“œë¦¬ë¸ í…Œì´ë¸”ì€ ê²€ìƒ‰ ìœ„ì£¼ë¡œ ì‚¬ìš©ë˜ê¸° ë•Œë¬¸ì—, ì¸ë±ìŠ¤ê°€ ì—†ìœ¼ë©´ ì„±ëŠ¥ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì´ ë§¤ìš° í¬ë‹¤. ë“œë¦¬ë¸ í…Œì´ë¸”ì— ì ì ˆí•œ ì¸ë±ìŠ¤ê°€ ì—†ë‹¤ë©´, ë“œë¼ì´ë¹™ í…Œì´ë¸”ë¡œë¶€í„° ì½ì€ ë ˆì½”ë“œì˜ ê±´ìˆ˜ë§Œí¼ ë§¤ë²ˆ ë“œë¦¬ë¸ í…Œì´ë¸”ì„ í’€ í…Œì´ë¸” ìŠ¤ìº”ì´ë‚˜ ì¸ë±ìŠ¤ í’€ ìŠ¤ìº”í•´ì•¼ í•  ê²ƒì´ë‹¤. ì´ëŸ¬í•œ ë¹„íš¨ìœ¨ì„±ì„ ë³´ì™„í•˜ê¸° ìœ„í•´, MySQL ì„œë²„ëŠ” ë“œë¼ì´ë¹™ í…Œì´ë¸”ì—ì„œ ì½ì€ ë ˆì½”ë“œë¥¼ ì„ì‹œ ê³µê°„ì— ë³´ê´€í•´ë‘ê³  í•„ìš”í•  ë•Œ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤. join_buffer_size ì‹œìŠ¤í…œ ì„¤ì • ë³€ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ ë²„í¼ í¬ê¸°ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì˜µí‹°ë§ˆì´ì €ëŠ” ì¡°ì¸ë˜ëŠ” ë‘ í…Œì´ë¸”ì— ìˆëŠ” ì¸ë±ìŠ¤ë¥¼ ì¡°ì‚¬í•˜ê³ , ì¸ë±ìŠ¤ê°€ ì—†ëŠ” í…Œì´ë¸”ì´ ìˆìœ¼ë©´ ê·¸ í…Œì´ë¸”ì„ ë¨¼ì € ì½ì–´ì„œ ì¡°ì¸ì„ ì‹¤í–‰í•œë‹¤. ë‹¤ìŒê³¼ ê°™ì€ ì¹´í…Œì‹œì•ˆ ì¡°ì¸ì„ ìˆ˜í–‰í•˜ëŠ” ì¿¼ë¦¬ëŠ” í•­ìƒ ì¡°ì¸ ë²„í¼ë¥¼ ì‚¬ìš©í•œë‹¤.EXPLAINSELECT *FROM dept_emp de, employees eWHERE de.from_date&gt;'2005-01-01' AND e.emp_no&lt;10904; id select_type table type key key_len ref rows Extra 1 SIMPLE de range ix_fromdate 3 Â  1 Using where 2 SIMPLE e range PRIMARY 4 Â  1520 Using where;Using join buffer Using temporary ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì„ì‹œ í…Œì´ë¸”ì„ ì‚¬ìš©í•œ ê²ƒì´ë‹¤. MySQLì€ ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë™ì•ˆ ì¤‘ê°„ ê²°ê³¼ë¥¼ ë‹´ì•„ ë‘ê¸° ìœ„í•´ ì„ì‹œ í…Œì´ë¸”ì„ ì‚¬ìš©í•œë‹¤. ì„ì‹œ í…Œì´ë¸”ì´ ë©”ëª¨ë¦¬ì— ìƒì„±ëëŠ”ì§€, ë””ìŠ¤í¬ì— ìƒì„±ëëŠ”ì§€ ì—¬ë¶€ëŠ” ì‹¤í–‰ ê³„íšë§Œìœ¼ë¡œëŠ” íŒë‹¨í•  ìˆ˜ ì—†ë‹¤. ì•„ë˜ ì¿¼ë¦¬ëŠ” GROUP BY ì»¬ëŸ¼ê³¼ ORDER BY ì»¬ëŸ¼ì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ì„ì‹œ í…Œì´ë¸”ì´ í•„ìš”í•œ ì‘ì—…ì´ë‹¤. id select_type table type key key_len ref rows Extra 1 SIMPLE employees ALL Â  Â  Â  300584 Using temporary;Using filesort Extra ì»¬ëŸ¼ì— â€˜Using temporaryâ€™ê°€ í‘œì‹œë˜ì§€ëŠ” ì•Šì§€ë§Œ, ë‚´ë¶€ì ìœ¼ë¡œ ì„ì‹œ í…Œì´ë¸”ì„ ì‚¬ìš©í•  ë•Œë„ ë§ë‹¤. FROM ì ˆì— ì‚¬ìš©ëœ ì„œë¸Œì¿¼ë¦¬ëŠ” ë¬´ì¡°ê±´ ì„ì‹œ í…Œì´ë¸”(íŒŒìƒ í…Œì´ë¸”)ì„ ìƒì„±í•œë‹¤. COUNT(DISTINCT col1)ì„ í¬í•¨í•˜ëŠ” ì¿¼ë¦¬ëŠ” ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ê²½ìš° ì„ì‹œ í…Œì´ë¸”ì„ ìƒì„±í•œë‹¤. UNION, UNION ALLì´ ì‚¬ìš©ëœ ì¿¼ë¦¬ë„ ì„ì‹œ í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ ë³‘í•©í•œë‹¤. ì •ë ¬ì— ë²„í¼ê°€ ì‚¬ìš©ë˜ëŠ” ê²½ìš°, ë²„í¼ì˜ ì‹¤ì²´ë„ ê²°êµ­ì€ ì„ì‹œ í…Œì´ë¸”ì´ë‹¤. Using where MySQL ì—”ì§„ ë ˆì´ì–´ì—ì„œ ë³„ë„ì˜ ê°€ê³µì„ í•´ì„œ í•„í„°ë§ ì‘ì—…ì„ ì²˜ë¦¬í•œ ê²½ìš°ì´ë‹¤. ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì€ ë””ìŠ¤í¬ë‚˜ ë©”ëª¨ë¦¬ìƒì—ì„œ í•„ìš”í•œ ë ˆì½”ë“œë¥¼ ì½ê±°ë‚˜ ì €ì¥í•œë‹¤. MySQL ì—”ì§„ì€ ìŠ¤í† ë¦¬ì§€ ì—”ì§„ìœ¼ë¡œë¶€í„° ë°›ì€ ë ˆì½”ë“œë¥¼ ê°€ê³µ ë˜ëŠ” ì—°ì‚°í•œë‹¤. ì‘ì—… ë²”ìœ„ ì œí•œ ì¡°ê±´ì€ ìŠ¤í† ë¦¬ì§€ ì—”ì§„ ë ˆë²¨ì—ì„œ, ì²´í¬ ì¡°ê±´ì€ MySQL ì—”ì§„ ë ˆë²¨ì—ì„œ ì²˜ë¦¬ëœë‹¤. ì•„ë˜ ì¿¼ë¦¬ì˜ ê²½ìš°, ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì—ì„œ 100ê°œì˜ ë ˆì½”ë“œë¥¼ MySQL ì—”ì§„ìœ¼ë¡œ ë„˜ê²¨ì¤€ë‹¤. MySQL ì—”ì§„ì€ ì²´í¬ ì¡°ê±´(gender='F')ì„ í†µí•´ ë ˆì½”ë“œë¥¼ í•„í„°ë§í•œë‹¤. â€˜Using whereâ€™ëŠ” í•„í„°ë§ë¼ì„œ ë ˆì½”ë“œë¥¼ ë²„ë¦¬ëŠ” ì²˜ë¦¬ë¥¼ ì˜ë¯¸í•œë‹¤. EXPLAINSELECT * FROM employeesWHERE emp_no BETWEEN 10001 AND 10100 AND gender='F'; id select_type table type key key_len ref rows Extra 1 SIMPLE employees range PRIMARY 4 NULL 100 Using where â€˜Using whereâ€™ê°€ ì„±ëŠ¥ìƒì˜ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ì§€ ì•„ë‹ì§€ëŠ” 5.1 ë²„ì „ë¶€í„° ì¶”ê°€ëœ â€˜Filteredâ€™ ì»¬ëŸ¼ì„ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.3. ì¿¼ë¦¬ì˜ ì‹¤í–‰ ê³„íšì´ ì¢‹ì€ ê²½ìš°Distinct ì•„ë˜ ì¿¼ë¦¬ëŠ” departments í…Œì´ë¸”ê³¼ dept_emp í…Œì´ë¸”ì— ëª¨ë‘ ì¡´ì¬í•˜ëŠ” dept_noë§Œ ìœ ë‹ˆí¬í•˜ê²Œ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ ì¿¼ë¦¬ì´ë‹¤. DISTINCTë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•´ ì¡°ì¸í•˜ì§€ ì•Šì•„ë„ ë˜ëŠ” í•­ëª©ì€ ëª¨ë‘ ë¬´ì‹œí•˜ê³  í•„ìš”í•œ ê²ƒë§Œ ì¡°ì¸í•œë‹¤(í•„ìš”í•œ ë ˆì½”ë“œë§Œ ì½ëŠ”ë‹¤).EXPLAINSELECT DISTINCT d.dept_noFROM departments d, dept_emp de WHERE de.dept_no=d.dept_no; id select_type table type key key_len ref rows Extra 1 SIMPLE d index ux_deptname 123 NULL 9 Using index;Using temporary 1 SIMPLE de ref PRIMARY 12 d.dept_no 18603 Using index;Distinct Using index(ì»¤ë²„ë§ ì¸ë±ìŠ¤) ì¸ë±ìŠ¤ë§Œ ì½ì–´ì„œ ì¿¼ë¦¬ë¥¼ ëª¨ë‘ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ê²½ìš°ì´ë‹¤. ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•´ ì²˜ë¦¬í•˜ëŠ” ì¿¼ë¦¬ì—ì„œ ê°€ì¥ í° ë¶€í•˜ë¥¼ ì°¨ì§€í•˜ëŠ” ë¶€ë¶„ì€ ì¸ë±ìŠ¤ë¥¼ ê²€ìƒ‰í•´ ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œì˜ ë‚˜ë¨¸ì§€ ì»¬ëŸ¼ ê°’ì„ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ë°ì´í„° íŒŒì¼ì„ ì°¾ì•„ì„œ ê°€ì ¸ì˜¤ëŠ” ì‘ì—…ì´ë‹¤. ìµœì•…ì˜ ê²½ìš°ì—ëŠ” ì¸ë±ìŠ¤ë¥¼ í†µí•´ ê²€ìƒ‰ëœ ê²°ê³¼ ë ˆì½”ë“œ í•œ ê±´ í•œ ê±´ë§ˆë‹¤ ë””ìŠ¤í¬ë¥¼ í•œ ë²ˆì”© ì½ì–´ì•¼ í•  ìˆ˜ë„ ìˆë‹¤. InnoDBì˜ ëª¨ë“  í…Œì´ë¸”ì€ í´ëŸ¬ìŠ¤í„°ë§ ì¸ë±ìŠ¤ë¡œ êµ¬ì„±ë¼ ìˆë‹¤. ì¦‰, InnoDB í…Œì´ë¸”ì˜ ëª¨ë“  ë³´ì¡° ì¸ë±ìŠ¤ëŠ” ë°ì´í„° ë ˆì½”ë“œì˜ ì£¼ì†Œ ê°’ìœ¼ë¡œ í”„ë¼ì´ë¨¸ë¦¬ í‚¤ ê°’ì„ ê°€ì§„ë‹¤. ì´ëŸ¬í•œ íŠ¹ì„± ë•Œë¬¸ì— ì¿¼ë¦¬ê°€ ì»¤ë²„ë§ ì¸ë±ìŠ¤ë¡œ ì²˜ë¦¬ë  ê°€ëŠ¥ì„±ì´ ìƒë‹¹íˆ ë†’ë‹¤. í•˜ì§€ë§Œ ë¬´ì¡°ê±´ ì»¤ë²„ë§ ì¸ë±ìŠ¤ë¡œ ì²˜ë¦¬í•˜ë ¤ê³  ì¸ë±ìŠ¤ì— ë§ì€ ì»¬ëŸ¼ì„ ì¶”ê°€í•˜ê²Œ ë˜ë©´, ê³¼ë„í•˜ê²Œ ì¸ë±ìŠ¤ì˜ ì»¬ëŸ¼ì´ ë§ì•„ì ¸ ë©”ëª¨ë¦¬ ë‚­ë¹„ê°€ ì‹¬í•´ì§ˆ ìˆ˜ ìˆë‹¤. ë˜í•œ, ë ˆì½”ë“œë¥¼ ì €ì¥í•˜ê±°ë‚˜ ë³€ê²½í•˜ëŠ” ì‘ì—…ì´ ë§¤ìš° ëŠë ¤ì§ˆ ìˆ˜ ìˆë‹¤. Using index for group-by GROUP BY ì²˜ë¦¬ê°€ ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•˜ëŠ” ê²½ìš°ì´ë‹¤. ì´ëŸ¬í•œ ë°©ë²•ì„ â€˜ë£¨ìŠ¤ ì¸ë±ìŠ¤ ìŠ¤ìº”â€™ì´ë¼ê³  í•œë‹¤. ë£¨ìŠ¤ ì¸ë±ìŠ¤ ìŠ¤ìº”ì€ ì¸ë±ìŠ¤ì—ì„œ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì½ëŠ”ë‹¤. salaries í…Œì´ë¸”ì˜ ì¸ë±ìŠ¤ëŠ” emp_no, from_dateë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. ì•„ë˜ì˜ ì¿¼ë¦¬ì˜ ê²½ìš° emp_no ê·¸ë£¹ë³„ë¡œ ì²« ë²ˆì§¸ from_date ê°’(ìµœì†Ÿê°’)ê³¼ ë§ˆì§€ë§‰ from_date ê°’(ìµœëŒ“ê°’)ì„ ì¸ë±ìŠ¤ë¡œë¶€í„° ì½ìœ¼ë©´ ëœë‹¤. ë”°ë¼ì„œ, â€˜ë£¨ìŠ¤ ì¸ë±ìŠ¤ ìŠ¤ìº”â€™ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤. EXPLAINSELECT emp_no, MIN(from_date) AS first_changed_date, MAX(from_date) AS last_changed_dateFROM salariesGROUP BY emp_no; id select_type table type key key_len ref rows Extra 1 SIMPLE salaries range PRIMARY 4 Â  711129 Using index forgroup-by EXPLAIN EXTENDED MySQL 5.1.12 ë¯¸ë§Œì˜ ë²„ì „ì—ì„œëŠ” MySQL ì—”ì§„ì— ì˜í•´ í•„í„°ë§ ê³¼ì •ì„ ê±°ì¹˜ë©´ì„œ ì–¼ë§ˆë‚˜ ë§ì€ ë ˆì½”ë“œê°€ ë²„ë ¤ì¡ŒëŠ”ì§€ ì•Œ ìˆ˜ ì—†ì—ˆë‹¤.5.1.12 ë²„ì „ë¶€í„°ëŠ” í•„í„°ë§ì´ ì–¼ë§ˆë‚˜ íš¨ìœ¨ì ìœ¼ë¡œ ì‹¤í–‰ëëŠ”ì§€ ì•Œë ¤ì£¼ê¸° ìœ„í•´ â€˜Filteredâ€™ ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ì—ˆë‹¤.ì´ë¥¼ í™•ì¸í•˜ë ¤ë©´ EXPLAIN EXTENDED ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•œë‹¤. í•„í„°ë§ëœ ë ˆì½”ë“œëŠ” ì œì™¸í•˜ê³  ìµœì¢…ì ìœ¼ë¡œ ë ˆì½”ë“œê°€ ì–¼ë§ˆë‚˜ ë‚¨ì•˜ëŠ”ì§€ ë¹„ìœ¨ì´ í‘œì‹œëœë‹¤. ì¦‰, ì „ì²´ ë ˆì½”ë“œ 100ê±´ ì¤‘ 20% (20ê±´)ë§Œì´ ë‚¨ì•˜ë‹¤ëŠ” ì˜ë¯¸ë‹¤. ì´ ê°’ì€ ì‹¤ì œ ê°’ì´ ì•„ë‹Œ í†µê³„ ì •ë³´ë¡œë¶€í„° ì˜ˆì¸¡ëœ ê°’ì´ë‹¤.EXPLAIN EXTENDEDSELECT * FROM employeesWHERE emp_no BETWEEN 10001 AND 10100 AND gender='F'; id select_type table type key key_len ref rows filtered Extra 1 SIMPLE employees range PRIMARY 4 NULL 100 20 Using where EXPLAIN PARTITIONS EXPLAIN PARTITIONS ëª…ë ¹ì„ í†µí•´ íŒŒí‹°ì…˜ í…Œì´ë¸”ì˜ ì‹¤í–‰ ê³„íš ì •ë³´ë¥¼ ì¢€ ë” ìì„¸íˆ í™•ì¸í•  ìˆ˜ ìˆë‹¤. íŒŒí‹°ì…˜ì´ ì—¬ëŸ¬ ê°œì¸ í…Œì´ë¸”ì—ì„œ ë¶ˆí•„ìš”í•œ íŒŒí‹°ì…˜ì„ ë¹¼ê³  ì¿¼ë¦¬ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•´ ì ‘ê·¼í•´ì•¼ í•  ê²ƒìœ¼ë¡œ íŒë‹¨ë˜ëŠ” í…Œì´ë¸”ë§Œ ê³¨ë¼ë‚´ëŠ” ê³¼ì •ì„ â€˜íŒŒí‹°ì…˜ í”„ë£¨ë‹(Partition pruning)â€™ì´ë¼ê³  í•œë‹¤. ì´ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ ì˜µí‹°ë§ˆì´ì €ê°€ ì‹¤ì œë¡œ ì ‘ê·¼í•˜ëŠ” íŒŒí‹°ì…˜ í…Œì´ë¸”ì„ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤. id select_type table partitions type key key_len ref rows Extra 1 SIMPLE tb_partition p3 ALL Â  Â  Â  2 Using where ê´€ë ¨ ê¸€ MySQL ì‹¤í–‰ ê³„íš (1) MySQL ì‹¤í–‰ ê³„íš (2)ì°¸ê³  ìë£Œ ì´ì„±ìš±, ã€ê°œë°œìì™€ DBAë¥¼ ìœ„í•œ Real MySQLã€, ìœ„í‚¤ë¶ìŠ¤(2012), 6ì¥" }, { "title": "MySQL - MySQL ì‹¤í–‰ ê³„íš (2)", "url": "/posts/execution-plan-part2/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "MySQL", "date": "2021-10-07 23:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ì‹¤í–‰ ê³„íšì„ ë‚˜íƒ€ë‚´ëŠ” í…Œì´ë¸”ì˜ ë‹¤ì–‘í•œ ì»¬ëŸ¼ë“¤ ì¤‘ ë¨¼ì € id, select_type, table, type ì»¬ëŸ¼ì— ëŒ€í•´ ì‚´í´ë³¼ ê²ƒì´ë‹¤. â€» ì´ì „ ê¸€ì„ ì½ì§€ ì•Šìœ¼ì‹  ë¶„ë“¤ì€ ë¨¼ì € ì½ìœ¼ì‹¤ ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.id ì»¬ëŸ¼ ë‹¨ìœ„ SELECT ì¿¼ë¦¬ë³„ë¡œ ë¶€ì—¬ë˜ëŠ” ì‹ë³„ì ê°’ì„ ë‚˜íƒ€ë‚´ëŠ” ì»¬ëŸ¼ì´ë‹¤.SELECT...FROM (SELECT ... FROM tb_tes...", "content": "ë“¤ì–´ê°€ê¸° ì „ì‹¤í–‰ ê³„íšì„ ë‚˜íƒ€ë‚´ëŠ” í…Œì´ë¸”ì˜ ë‹¤ì–‘í•œ ì»¬ëŸ¼ë“¤ ì¤‘ ë¨¼ì € id, select_type, table, type ì»¬ëŸ¼ì— ëŒ€í•´ ì‚´í´ë³¼ ê²ƒì´ë‹¤. â€» ì´ì „ ê¸€ì„ ì½ì§€ ì•Šìœ¼ì‹  ë¶„ë“¤ì€ ë¨¼ì € ì½ìœ¼ì‹¤ ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.id ì»¬ëŸ¼ ë‹¨ìœ„ SELECT ì¿¼ë¦¬ë³„ë¡œ ë¶€ì—¬ë˜ëŠ” ì‹ë³„ì ê°’ì„ ë‚˜íƒ€ë‚´ëŠ” ì»¬ëŸ¼ì´ë‹¤.SELECT...FROM (SELECT ... FROM tb_test1) tb1, tb_test2 tb2WHERE tb1.id=tb2.id; ìœ„ ì¿¼ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ì´ SELECT ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•´ì„œ ìƒê°í•´ë³¼ ìˆ˜ ìˆë‹¤.SELECT ... FROM tb_test1;SELECT ... FROM tb1, tb_test2 tb2 WHERE tb1.id=tb2.id; í•˜ë‚˜ì˜ SELECT ë¬¸ì¥ ì•ˆì—ì„œ ì—¬ëŸ¬ ê°œì˜ í…Œì´ë¸”ì„ ì¡°ì¸í•˜ë©´ ê° ë ˆì½”ë“œë³„ë¡œ ê°™ì€ idê°€ ë¶€ì—¬ëœë‹¤.EXPLAINSELECT e.emp_no, e.first_name, s.from_date, s.salaryFROM employees e, salaries sWHERE e.emp_no=s.emp_noLIMIT 10; id select_type table type key key_len ref rows Extra 1 SIMPLE e index ix_firstname 44 Â  300584 Using index 1 SIMPLE s ref PRIMARY 4 employees, e.emp_no 4 Â  ë‹¤ìŒê³¼ ê°™ì´ 3ê°œì˜ ë‹¨ìœ„ SELECT ì¿¼ë¦¬ë¡œ êµ¬ì„±ëœ ê²½ìš°ëŠ” ì•„ë˜ì™€ ê°™ì€ ì‹¤í–‰ ê³„íšì„ ë‚˜íƒ€ë‚¼ ê²ƒì´ë‹¤.EXPLAINSELECT( (SELECT COUNT(*) FROM employees) +(SELECT COUNT(*) FROM departments) ) AS total_count; id select_type table type key key_len ref rows Extra 1 PRIMARY Â  Â  Â  Â  Â  Â  No tables used 2 SUBQUERY employees index ix_hiredate 3 Â  300584 Using index 3 SUBQUERY departments index ux_deptname 123 Â  9 Using index select_type ì»¬ëŸ¼ ê° ë‹¨ìœ„ SELECT ì¿¼ë¦¬ê°€ ì–´ë–¤ íƒ€ì…ì˜ ì¿¼ë¦¬ì¸ì§€ í‘œì‹œë˜ëŠ” ì»¬ëŸ¼ì´ë‹¤.SIMPLE UNIONì´ë‚˜ ì„œë¸Œ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë‹¨ìˆœí•œ SELECT ì¿¼ë¦¬ì¸ ê²½ìš°ì´ë‹¤. ì‹¤í–‰ ê³„íšì—ì„œ select_typeì´ â€˜SIMPLEâ€™ì¸ ë‹¨ìœ„ ì¿¼ë¦¬ëŠ” ë°˜ë“œì‹œ í•˜ë‚˜ë§Œ ì¡´ì¬í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì œì¼ ë°”ê¹¥ SELECT ì¿¼ë¦¬ì˜ select_typeì´ â€˜SIMPLEâ€™ë¡œ í‘œì‹œëœë‹¤.PRIMARY UNIONì´ë‚˜ ì„œë¸Œ ì¿¼ë¦¬ê°€ í¬í•¨ëœ SELECT ì¿¼ë¦¬ì˜ ì‹¤í–‰ ê³„íšì—ì„œ ê°€ì¥ ë°”ê¹¥ìª½(Outer)ì— ìˆëŠ” ë‹¨ìœ„ ì¿¼ë¦¬ì¸ ê²½ìš°ì´ë‹¤. ì‹¤í–‰ ê³„íšì—ì„œ select_typeì´ â€˜PRIMARYâ€™ì¸ ë‹¨ìœ„ ì¿¼ë¦¬ëŠ” ë°˜ë“œì‹œ í•˜ë‚˜ë§Œ ì¡´ì¬í•œë‹¤.UNION UNIONìœ¼ë¡œ ê²°í•©í•˜ëŠ” ë‹¨ìœ„ SELECT ì¿¼ë¦¬ ê°€ìš´ë° ì²« ë²ˆì§¸ë¥¼ ì œì™¸í•œ ë‘ ë²ˆì§¸ ì´í›„ ë‹¨ìœ„ SELECT ì¿¼ë¦¬ëŠ” UNIONìœ¼ë¡œ í‘œì‹œëœë‹¤. UNIONì˜ ì²« ë²ˆì§¸ ë‹¨ìœ„ SELECTëŠ” UNION ì¿¼ë¦¬ë¡œ ê²°í•©ëœ ì „ì²´ ì§‘í•©ì˜ select_typeì´ í‘œì‹œëœë‹¤.EXPLAINSELECT * FROM ( (SELECT emp_no FROM employees e1 LIMIT 10) UNION ALL (SELECT emp_no FROM employees e2 LIMIT 10) UNION ALL (SELECT emp_no FROM employees e3 LIMIT 10)) tb; id select_type table type key key_len ref rows Extra 1 PRIMARY &lt; derived2 &gt; ALL Â  Â  Â  30 Â  2 DERIVED e1 index ix_hiredate 3 Â  300584 Using index 3 UNION e2 index ix_hiredate 3 Â  300584 Using index 4 UNION e3 index ix_hiredate 3 Â  300584 Using index Â  UNION RESULT &lt;union2,3,4&gt; ALL Â  Â  Â  Â  Â  DEPENDENT UNION UNIONì´ë‚˜ UNION ALLë¡œ ì§‘í•©ì„ ê²°í•©í•˜ëŠ” ì¿¼ë¦¬ì—ì„œ í‘œì‹œëœë‹¤. â€˜DEPENDENTâ€™ëŠ” UNIONì´ë‚˜ UNION ALLë¡œ ê²°í•©ëœ ë‹¨ìœ„ ì¿¼ë¦¬ê°€ ì™¸ë¶€ì˜ ì˜í–¥ì„ ë°›ì€ ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì™¸ë¶€ì˜ ì˜í–¥ì´ë€, ë‚´ë¶€ ì¿¼ë¦¬ê°€ ì™¸ë¶€ì˜ ê°’ì„ ì°¸ì¡°í•´ì„œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì™¸ë¶€ ì¿¼ë¦¬ë³´ë‹¤ ì„œë¸Œ ì¿¼ë¦¬ê°€ ë¨¼ì € ì‹¤í–‰ë˜ë©°, ëŒ€ë¶€ë¶„ ì´ëŸ¬í•œ ë°©ì‹ì´ ë°˜ëŒ€ì˜ ê²½ìš°ë³´ë‹¤ ë” ë¹ ë¥´ë‹¤. í•˜ì§€ë§Œ â€˜DEPENDENTâ€™ í‚¤ì›Œë“œê°€ í¬í•¨ë˜ëŠ” ê²½ìš°, ì„œë¸Œ ì¿¼ë¦¬ëŠ” ì™¸ë¶€ ì¿¼ë¦¬ì— ì˜ì¡´ì ì´ë¯€ë¡œ ì ˆëŒ€ ì™¸ë¶€ ì¿¼ë¦¬ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰ë  ìˆ˜ê°€ ì—†ë‹¤. ë”°ë¼ì„œ ì´ëŸ¬í•œ ì¿¼ë¦¬ëŠ” ë¹„íš¨ìœ¨ì ì¸ ê²½ìš°ê°€ ë§ë‹¤. ì•„ë˜ ì¿¼ë¦¬ì—ì„œëŠ” ë‚´ë¶€ ì¿¼ë¦¬ì—ì„œ ì™¸ë¶€ì— ìˆëŠ” employees í…Œì´ë¸”ì˜ emp_no ì»¬ëŸ¼ì´ ì‚¬ìš©ëœë‹¤.EXPLAINSELECT e.first_name, ( SELECT ... FROM salaries s WHERE s.emp_no = e.emp_no UNION SELECT ... FROM dept_emp de WHERE de.emp_no = e.emp_no ) AS msgFROM employees eWHERE e.emp_no=10001; id select_type table type key key_len ref rows Extra 1 PRIMARY e const PRIMARY 4 const 1 Â  2 DEPENDENTSUBQUERY s ref PRIMARY 4 const 17 Using index 3 DEPENDENTUNION de ref ix_empno_fromdate 4 Â  1 Using where;Using index Â  UNION RESULT &lt;union2,3&gt; ALL Â  Â  Â  Â  Â  UNION RESULT MySQLì—ì„œ UNIONì´ë‚˜ UNION ALL ì¿¼ë¦¬ëŠ” ëª¨ë‘ ë³‘í•© ê²°ê³¼ë¥¼ ì„ì‹œ í…Œì´ë¸”ë¡œ ìƒì„±í•œë‹¤. â€˜UNION RESULTâ€™ëŠ” ì´ëŸ¬í•œ ì„ì‹œ í…Œì´ë¸”ì„ ì˜ë¯¸í•œë‹¤. ë‹¨ìœ„ ì¿¼ë¦¬ê°€ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ë³„ë„ id ê°’ì€ ë¶€ì—¬ë˜ì§€ ì•ŠëŠ”ë‹¤. table ì»¬ëŸ¼ì˜ &lt;union n,m&gt;ì˜ ì˜ë¯¸ëŠ” idê°€ në²ˆ, më²ˆì¸ ë‹¨ìœ„ ì¿¼ë¦¬ì˜ ê²°ê³¼ë¥¼ UNION í–ˆë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.SUBQUERY ì—¬ê¸°ì„œ â€˜SUBQUERYâ€™ë¼ê³  í•˜ëŠ” ê²ƒì€ FROM ì ˆ ì´ì™¸ì—ì„œ ì‚¬ìš©ë˜ëŠ” ì„œë¸Œ ì¿¼ë¦¬ë§Œì„ ì˜ë¯¸í•œë‹¤. FROM ì ˆì— ì‚¬ìš©ëœ ì„œë¸Œ ì¿¼ë¦¬ëŠ” â€˜DERIVEDâ€™ë¼ê³  í‘œì‹œëœë‹¤.EXPLAINSELECT e.first_name, ( SELECT ... FROM dept_emp de, dept_manager dm WHERE ...) AS cntFROM employees eWHERE e.emp_no = 10001; id select_type table type key key_len ref rows Extra 1 PRIMARY e const PRIMARY 4 const 1 Â  2 SUBQUERY dm index PRIMARY 16 Â  24 Using index 2 SUBQUERY de ref PRIMARY 12 dm.dept_no 18603 Using index DEPENDENT SUBQUERY ì„œë¸Œ ì¿¼ë¦¬ê°€ ë°”ê¹¥ìª½(Outer) SELECT ì¿¼ë¦¬ì—ì„œ ì •ì˜ëœ ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì´ë‹¤. â€˜DEPENDENT UNIONâ€™ì²˜ëŸ¼ â€˜DEPENDENT SUBQUERYâ€™ ë˜í•œ ì™¸ë¶€ ì¿¼ë¦¬ê°€ ë¨¼ì € ìˆ˜í–‰ëœ í›„ ë‚´ë¶€ ì¿¼ë¦¬(ì„œë¸Œ ì¿¼ë¦¬)ê°€ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ë¯€ë¡œ ì¼ë°˜ ì„œë¸Œ ì¿¼ë¦¬ë³´ë‹¤ëŠ” ì²˜ë¦¬ ì†ë„ê°€ ëŠë¦´ ë•Œê°€ ë§ë‹¤.EXPLAINSELECT e.first_name, ( SELECT ... FROM dept_emp de, dept_manager dm WHERE ... AND de.emp_no=e.emp_no) AS cntFROM employees eWHERE e.emp_no = 10001; id select_type table type key key_len ref rows Extra 1 PRIMARY e const PRIMARY 4 const 1 Â  2 DEPENDENTSUBQUERY de ref ix_empno_fromdate 4 Â  1 Usingindex 2 DEPENDENTSUBQUERY dm ref PRIMARY 12 dm.dept_no 1 Usingindex DERIVED ì„œë¸Œ ì¿¼ë¦¬ê°€ FROM ì ˆì— ì‚¬ìš©ëœ ê²½ìš°ì´ë‹¤. â€˜DERIVEDâ€™ì¸ ê²½ìš°, ì¿¼ë¦¬ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ë©”ëª¨ë¦¬ë‚˜ ë””ìŠ¤í¬ì— ì„ì‹œ í…Œì´ë¸”ë¡œ ìƒì„±í•œë‹¤. ì´ëŸ¬í•œ ì„ì‹œ í…Œì´ë¸”ì„ â€˜íŒŒìƒ í…Œì´ë¸”â€™ì´ë¼ê³ ë„ í•œë‹¤. íŒŒìƒ í…Œì´ë¸”ì—ëŠ” ì¸ë±ìŠ¤ê°€ ì—†ìœ¼ë¯€ë¡œ ë‹¤ë¥¸ í…Œì´ë¸”ê³¼ ì¡°ì¸í•  ë•Œ ì„±ëŠ¥ìƒ ë¶ˆë¦¬í•  ë•Œê°€ ë§ë‹¤. MySQLì€ ì´ëŸ¬í•œ ì„œë¸Œ ì¿¼ë¦¬ë¥¼ ìµœì í™”í•˜ì§€ ëª»í•  ë•Œê°€ ëŒ€ë¶€ë¶„ì´ë‹¤. (MySQL 5 ê¸°ì¤€) ì¿¼ë¦¬ë¥¼ íŠœë‹í•˜ê¸° ìœ„í•´ ê°€ì¥ ë¨¼ì €í•˜ëŠ” ê²ƒ ì¤‘ í•˜ë‚˜ê°€ select_type ê°’ì´ â€˜DERIVEDâ€™ì¸ ê²ƒì´ ìˆëŠ”ì§€ ì°¾ëŠ” ê²ƒì´ë‹¤. ì´ ê²½ìš°, ì¡°ì¸ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆëŠ” ê²½ìš°ë¼ë©´ ì„œë¸Œ ì¿¼ë¦¬ë³´ë‹¤ëŠ” ì¡°ì¸ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê¶Œì¥ëœë‹¤. EXPLAINSELECT *FROM (SELECT de.emp_no FROM dept_emp de) tb, employees eWHERE e.emp_no=tb.emp_no; id select_type table type key key_len ref rows Extra 1 PRIMARY &lt; derived2 &gt; ALL Â  Â  Â  331603 Â  1 PRIMARY e eq_ref PRIMARY 4 tb.emp_no 1 Usingindex 2 DERIVED de index ix_fromdate 3 Â  334868 Usingindex UNCACHEABLE SUBQUERY ì¼ë°˜ì ìœ¼ë¡œ ì¡°ê±´ì´ ë˜‘ê°™ì€ ì„œë¸Œ ì¿¼ë¦¬ê°€ ì‹¤í–‰ë  ë•Œ, ì´ì „ì˜ ì‹¤í–‰ ê²°ê³¼ë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•œë‹¤. ì¬ì‚¬ìš©ì„ ìœ„í•´ ì„œë¸Œ ì¿¼ë¦¬ì˜ ê²°ê³¼ë¥¼ ë‚´ë¶€ì ì¸ ìºì‹œ ê³µê°„ì— ë‹´ì•„ë‘”ë‹¤. ì¿¼ë¦¬ ìºì‹œë‚˜ íŒŒìƒ í…Œì´ë¸”ê³¼ëŠ” ë¬´ê´€í•˜ë‹¤. í•˜ì§€ë§Œ â€˜UNCACHEABLE SUBQUERYâ€™ë¡œ í‘œì‹œë  ë•ŒëŠ” ìºì‹±ëœ ê²°ê³¼ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ì´ë‹¤. ì‚¬ìš©ì ë³€ìˆ˜ê°€ ì„œë¸Œ ì¿¼ë¦¬ì— ì‚¬ìš©ëœ ê²½ìš° NOT-DETERMINISTIC ì†ì„±ì˜ ìŠ¤í† ì–´ë“œ ë£¨í‹´ì´ ì„œë¸Œ ì¿¼ë¦¬ì— ë‚´ì— ì‚¬ìš©ëœ ê²½ìš° UUID()ë‚˜ RAND()ì™€ ê°™ì´ ê²°ê³¼ê°’ì´ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ë‹¬ë¼ì§€ëŠ” í•¨ìˆ˜ê°€ ì„œë¸Œ ì¿¼ë¦¬ì— ì‚¬ìš©ëœ ê²½ìš° UNCACHEBLE UNION UNIONì„ ì‚¬ìš©í•œ ì¿¼ë¦¬ ì¤‘ ìœ„ì—ì„œ ì–¸ê¸‰í•œ ìºì‹±í•  ìˆ˜ ì—†ëŠ” ì¡°ê±´ì— í•´ë‹¹í•˜ëŠ” ê²½ìš°ì´ë‹¤. MySQL 5.1ë¶€í„° ì¶”ê°€ëœ select_typeì´ë‹¤.table ì»¬ëŸ¼ MySQLì˜ ì‹¤í–‰ ê³„íšì€ í…Œì´ë¸” ê¸°ì¤€ìœ¼ë¡œ í‘œì‹œëœë‹¤. ë³„ë„ì˜ í…Œì´ë¸”ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì—ëŠ” NULLì´ í‘œì‹œëœë‹¤. table ì»¬ëŸ¼ì— â€œ&lt;&gt;â€ë¡œ ë‘˜ëŸ¬ì‹¸ì¸ ì´ë¦„ì´ í‘œì‹œë˜ëŠ” ê²½ìš°ëŠ” ì„ì‹œ í…Œì´ë¸”ì„ ì˜ë¯¸í•œë‹¤. ì§€ê¸ˆê¹Œì§€ ê³µë¶€í•œ ë‚´ìš©ì„ í† ëŒ€ë¡œ ë‹¤ìŒ ì‹¤í–‰ ê³„íšì„ ë¶„ì„í•´ë³´ì. id select_type table type key key_len ref rows Extra 1 PRIMARY &lt;derived2&gt; ALL Â  Â  Â  10420 Â  1 PRIMARY e eq_ref PRIMARY 4 de1.emp_no 1 Â  2 DERIVED dept_emp range ix_fromdate 3 Â  20550 Â  ì²« ë²ˆì§¸ ë¼ì¸ì˜ í…Œì´ë¸”ì´ &lt;derived2&gt;ì´ë¯€ë¡œ idê°€ 2ë²ˆì¸ ë¼ì¸ì´ ë¨¼ì € ì‹¤í–‰ë˜ê³  ê·¸ ê²°ê³¼ë¡œ íŒŒìƒ í…Œì´ë¸”ì´ ë§Œë“¤ì–´ì§„ë‹¤. id 2ë²ˆì— tableì´ dept_empì¸ ê²ƒìœ¼ë¡œ ë³´ì•„, dept_emp í…Œì´ë¸”ì„ ì½ì–´ íŒŒìƒ í…Œì´ë¸”ì„ ìƒì„±í•œë‹¤. idê°€ 1ë²ˆìœ¼ë¡œ ê°™ì€ ë‘ ê°œì˜ í…Œì´ë¸” &lt;derived2&gt;, eëŠ” ì¡°ì¸ëë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. &lt;derived2&gt;ê°€ eë³´ë‹¤ ë¨¼ì € í‘œì‹œëê¸° ë•Œë¬¸ì—, &lt;derived2&gt;ê°€ ë“œë¼ì´ë¹™ í…Œì´ë¸”, eê°€ ë“œë¦¬ë¸ í…Œì´ë¸”ì´ ëœë‹¤. ì¦‰, &lt;derived2&gt; í…Œì´ë¸”ì„ ë¨¼ì € ì½ê³  ì´ ê²°ê³¼ë¥¼ ê¸°ì¤€ìœ¼ë¡œ eì™€ ì¡°ì¸ì„ í•œë‹¤. type ì»¬ëŸ¼ type ì»¬ëŸ¼ê³¼ ê·¸ ì´í›„ì˜ ì»¬ëŸ¼ë“¤ì€ MySQL ì„œë²„ê°€ ê° í…Œì´ë¸”ì˜ ë ˆì½”ë“œë¥¼ ì–´ë–¤ ë°©ì‹ìœ¼ë¡œ ì½ì—ˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì¦‰, ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•´ ì½ì—ˆëŠ”ì§€, í’€ í…Œì´ë¸” ìŠ¤ìº”ìœ¼ë¡œ ì½ì—ˆëŠ”ì§€ ë“±ì„ ì˜ë¯¸í•œë‹¤.ì¼ë°˜ì ìœ¼ë¡œ ì¿¼ë¦¬ë¥¼ íŠœë‹í•  ë•Œ ì¸ë±ìŠ¤ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ê¸° ë•Œë¬¸ì—, type ì»¬ëŸ¼ì€ ë°˜ë“œì‹œ ì²´í¬í•´ì•¼ í•  ì¤‘ìš”í•œ ì •ë³´ì´ë‹¤.ì´ì œ type ì»¬ëŸ¼ì—ì„œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” ê°’ë“¤ì— ëŒ€í•´ ì‚´í´ë³´ì.system ë ˆì½”ë“œê°€ 1ê±´ ì´í•˜ì¸ í…Œì´ë¸”ì„ ì°¸ì¡°í•˜ëŠ” í˜•íƒœì˜ ì ‘ê·¼ ë°©ë²•ì´ë‹¤. MyISAMì´ë‚˜ MEMORY í…Œì´ë¸”ì—ì„œë§Œ ì‚¬ìš©ë˜ëŠ” ì ‘ê·¼ ë°©ë²•ì´ë‹¤.EXPLAINSELECT * FROM tb_dual; id select_type table type key key_len ref rows Extra 1 SIMPLE tb_dual system Â  Â  Â  1 Â  const ì¿¼ë¦¬ê°€ í”„ë¼ì´ë¨¸ë¦¬ í‚¤ë‚˜ ìœ ë‹ˆí¬ í‚¤ ì»¬ëŸ¼ì„ ì´ìš©í•˜ëŠ” WHERE ì¡°ê±´ì ˆì„ ê°€ì§€ê³  ìˆìœ¼ë©°, ë°˜ë“œì‹œ 1ê±´ì„ ë°˜í™˜í•˜ëŠ” ì¿¼ë¦¬ì˜ ì²˜ë¦¬ ë°©ì‹ì´ë‹¤. ì¿¼ë¦¬ì˜ í•´ë‹¹ ê°’ì€ ì˜µí‹°ë§ˆì´ì €ì— ì˜í•´ ìƒìˆ˜(const)í™”ëœ ë‹¤ìŒ ì¿¼ë¦¬ ì‹¤í–‰ê¸°ë¡œ ì „ë‹¬ëœë‹¤. ë‹¤ë¥¸ DBMSì—ì„œëŠ” â€˜UNIQUE INDEX SCANâ€™ì´ë¼ê³ ë„ í‘œí˜„í•œë‹¤.EXPLAINSELECT * FROM employees WHERE emp_no=10001; id select_type table type key key_len ref rows Extra 1 SIMPLE employees const PRIMARY 4 const 1 Â  ë‹¤ì¤‘ ì»¬ëŸ¼ìœ¼ë¡œ êµ¬ì„±ëœ í”„ë¼ì´ë¨¸ë¦¬ í‚¤, ìœ ë‹ˆí¬ í‚¤ ì¤‘ì—ì„œ ì¸ë±ìŠ¤ì˜ ì¼ë¶€ ì»¬ëŸ¼ë§Œ ì¡°ê±´ìœ¼ë¡œ ì‚¬ìš©í•  ë•ŒëŠ” const íƒ€ì…ì˜ ì ‘ê·¼ ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.eq_ref ì¡°ì¸ì—ì„œ ì²˜ìŒ ì½ì€ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ ê°’ì„ ê·¸ë‹¤ìŒ ì½ì–´ì•¼ í•  í…Œì´ë¸”ì˜ í”„ë¼ì´ë¨¸ë¦¬ í‚¤ë‚˜ ìœ ë‹ˆí¬ í‚¤ ì»¬ëŸ¼ì˜ ê²€ìƒ‰ ì¡°ê±´ì— ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì´ë‹¤. ë‹¤ì¤‘ ì»¬ëŸ¼ìœ¼ë¡œ ë§Œë“¤ì–´ì§„ í”„ë¼ì´ë¨¸ë¦¬ í‚¤ë‚˜ ìœ ë‹ˆí¬ ì¸ë±ìŠ¤ë¼ë©´ ì¸ë±ìŠ¤ì˜ ëª¨ë“  ì»¬ëŸ¼ì´ ë¹„êµ ì¡°ê±´ì— ì‚¬ìš©ë¼ì•¼ë§Œ eq_ref ì ‘ê·¼ ë°©ë²•ì´ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤. ì¦‰, ì¡°ì¸ì—ì„œ ë‘ ë²ˆì§¸ ì´í›„ì— ì½ëŠ” í…Œì´ë¸”ì—ì„œ ë°˜ë“œì‹œ 1ê±´ë§Œ ì¡´ì¬í•œë‹¤ëŠ” ë³´ì¥ì´ ìˆì–´ì•¼í•œë‹¤. EXPLAINSELECT * FROM dept_emp de, employees eWHERE e.emp_no=de.emp_no AND de.dept_no='d005'; id select_type table type key key_len ref rows Extra 1 SIMPLE de ref PRIMARY 12 const 53288 Usingwhere 1 SIMPLE e eq_ref PRIMARY 4 employees.de.emp_no 1 Â  ref ì¸ë±ìŠ¤ì˜ ì¢…ë¥˜ì™€ ê´€ê³„ì—†ì´ ë™ë“± ì¡°ê±´ìœ¼ë¡œ ê²€ìƒ‰í•  ë•Œ ref ì ‘ê·¼ ë°©ë²•ì´ ì‚¬ìš©ëœë‹¤. eq_refì™€ëŠ” ë‹¬ë¦¬ ì¡°ì¸ì˜ ìˆœì„œì™€ ê´€ê³„ì—†ì´ ì‚¬ìš©ëœë‹¤. í”„ë¼ì´ë¨¸ë¦¬ í‚¤ë‚˜ ìœ ë‹ˆí¬ í‚¤ ë“±ì˜ ì œì•½ ì¡°ê±´ë„ ì—†ë‹¤. ë°˜í™˜ë˜ëŠ” ë ˆì½”ë“œê°€ ë°˜ë“œì‹œ 1ê±´ì´ë¼ëŠ” ë³´ì¥ì´ ì—†ìœ¼ë¯€ë¡œ constë‚˜ eq_refë³´ë‹¤ëŠ” ë¹ ë¥´ì§€ ì•Šë‹¤. const, eq_ref, ref ëª¨ë‘ ì¸ë±ìŠ¤ì˜ ë¶„í¬ë„ê°€ ë‚˜ì˜ì§€ ì•Šë‹¤ë©´ ì„±ëŠ¥ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¤ì§€ ì•ŠëŠ” ì¢‹ì€ ì ‘ê·¼ ë°©ë²•ì´ë‹¤.EXPLAINSELECT * FROM dept_emp WHERE dept_no='d005'; id select_type table type key key_len ref rows Extra 1 SIMPLE dept_emp ref PRIMARY 12 const 53288 Usingwhere fulltext MySQLì˜ ì „ë¬¸ ê²€ìƒ‰(Fulltext) ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•´ ë ˆì½”ë“œë¥¼ ì½ëŠ” ì ‘ê·¼ ë°©ë²•ì„ ì˜ë¯¸í•œë‹¤. ì „ë¬¸ ê²€ìƒ‰ ì¸ë±ìŠ¤ëŠ” í†µê³„ ì •ë³´ê°€ ê´€ë¦¬ë˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ, ì˜µí‹°ë§ˆì´ì €ëŠ” ì „ë¬¸ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ì¿¼ë¦¬ì—ì„œëŠ” ë¹„ìš©ê³¼ëŠ” ê´€ê³„ ì—†ì´ ê±°ì˜ fulltext ì ‘ê·¼ ë°©ë²•ì„ ì‚¬ìš©í•œë‹¤. ë¬¼ë¡ , ì„±ëŠ¥ìƒ ë” ë¹ ë¥¸ const, eq_ref, ref ì ‘ê·¼ ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê²½ìš°ì—ëŠ” êµ³ì´ fulltextë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ì „ë¬¸ ê²€ìƒ‰ì€ MATCH .. AGAINST ... êµ¬ë¬¸ì„ ì‚¬ìš©í•´ì„œ ì‹¤í–‰í•˜ë©°, ë°˜ë“œì‹œ í•´ë‹¹ í…Œì´ë¸”ì— ì „ë¬¸ ê²€ìƒ‰ìš© ì¸ë±ìŠ¤ê°€ ì¤€ë¹„ë¼ ìˆì–´ì•¼ í•œë‹¤.EXPLAINSELECT *FROM employee_name WHERE emp_no=10001 AND emp_no BETWEEN 10001 AND 10005 AND MATCH(first_name, last_name) AGAINST('Facello' IN BOOLEAN MODE);ref_or_null ref ì ‘ê·¼ ë°©ì‹ê³¼ ê°™ì€ë°, NULL ë¹„êµê°€ ì¶”ê°€ëœ í˜•íƒœë‹¤.EXPLAINSELECT * FROM titlesWHERE to_date='1985-03-01' OR to_date IS NULL; id select_type table type key key_len ref rows Extra 1 SIMPLE titles ref_or_null ix_todate 4 const 2 Using where;Using index unique_subquery WHERE ì¡°ê±´ì ˆì—ì„œ ì‚¬ìš©ë  ìˆ˜ ìˆëŠ” IN (subquery) í˜•íƒœì˜ ì¿¼ë¦¬ë¥¼ ìœ„í•œ ì ‘ê·¼ ë°©ì‹ì´ë‹¤. ì„œë¸Œ ì¿¼ë¦¬ì—ì„œ ì¤‘ë³µë˜ì§€ ì•Šì€ ìœ ë‹ˆí¬í•œ ê°’ë§Œ ë°˜í™˜í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì•„ë˜ ì¿¼ë¦¬ì˜ ê²½ìš°, dept_emp í…Œì´ë¸”ì˜ í”„ë¼ì´ë¨¸ë¦¬ í‚¤ê°€ (dept_no, emp_no)ì´ë¯€ë¡œ emp_no=10001ì¸ ë ˆì½”ë“œ ì¤‘ì—ì„œ dept_noëŠ” ì¤‘ë³µì´ ì—†ë‹¤.EXPLAINSELECT * FROM departments WHERE dept_no IN ( SELECT dept_no FROM dept_emp WHERE emp_no=10001); id select_type table type key key_len ref rows Extra 1 PRIMARY departments index PRIMARY 123 Â  9 Using index;Using where 2 DEPENDENTSUBQUERY dept_emp unique_subquery PRIMARY 16 func,const 1 Using index;Using where index_subquery IN (subquery)ì—ì„œ ì„œë¸Œ ì¿¼ë¦¬ê°€ ì¤‘ë³µëœ ê°’ì„ ë°˜í™˜í•  ìˆ˜ëŠ” ìˆì§€ë§Œ ì¤‘ë³µëœ ê°’ì„ ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•´ ì œê±°í•  ìˆ˜ ìˆì„ ë•Œ ì´ ì ‘ê·¼ ë°©ë²•ì´ ì‚¬ìš©ëœë‹¤.EXPLAINSELECT * FROM departments WHERE dept_no IN ( SELECT dept_no FROM dept_emp WHERE dept_no BETWEEN 'd001' AND 'd003'); id select_type table type key key_len ref rows Extra 1 PRIMARY departments index ux_deptname 122 Â  9 Using where;Using index 2 DEPENDENTSUBQUERY dept_emp index_subquery PRIMARY 12 func 18626 Using index;Using where range ì¸ë±ìŠ¤ ë ˆì¸ì§€ ìŠ¤ìº” í˜•íƒœì˜ ì ‘ê·¼ ë°©ë²•ì´ë‹¤. ì¸ë±ìŠ¤ë¥¼ í•˜ë‚˜ì˜ ê°’ì´ ì•„ë‹Œ ë²”ìœ„ë¡œ ê²€ìƒ‰í•˜ëŠ” ê²½ìš°ì´ë‹¤. &lt;, &gt;, IS NULL, BETWEEN, IN, LIKE ë“±ì˜ ì—°ì‚°ìë¥¼ ì´ìš©í•´ ê²€ìƒ‰í•˜ëŠ” ê²½ìš° ì¼ë°˜ì ìœ¼ë¡œ, const, ref, range ì„¸ ê°€ì§€ ì ‘ê·¼ ë°©ë²•ì„ ëª¨ë‘ â€˜ì¸ë±ìŠ¤ ë ˆì¸ì§€ ìŠ¤ìº”â€™ ë°©ì‹ì´ë¼ê³  í•œë‹¤.EXPLAINSELECT dept_no FROM dept_emp WHERE dept_no BETWEEN 'd001' AND 'd003'; id select_type table type key key_len ref rows Extra 1 SIMPLE dept_emp range PRIMARY 12 Â  121890 Using where;Using index index_merge ìœ ì¼í•˜ê²Œ 2ê°œ ì´ìƒì˜ ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•˜ëŠ” ì ‘ê·¼ ë°©ì‹ì´ë‹¤. ê°ê°ì˜ ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•´ ê²€ìƒ‰ ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ë‚¸ í›„ ê·¸ ê²°ê³¼ë¥¼ ë³‘í•©í•œë‹¤. â€˜index_mergeâ€™ ì ‘ê·¼ ë°©ì‹ì—ëŠ” ë‹¤ìŒê³¼ ê°™ì€ íŠ¹ì§•ì´ ìˆë‹¤. ì—¬ëŸ¬ ì¸ë±ìŠ¤ë¥¼ ì½ì–´ì•¼ í•˜ë¯€ë¡œ ì¼ë°˜ì ìœ¼ë¡œ range ì ‘ê·¼ ë°©ì‹ë³´ë‹¤ëŠ” íš¨ìœ¨ì„±ì´ ë–¨ì–´ì§„ë‹¤. AND, OR ì—°ì‚°ì´ ë³µì¡í•˜ê²Œ ì—°ê²°ëœ ì¿¼ë¦¬ì—ì„œëŠ” ìµœì í™”ë˜ì§€ ëª»í•  ë•Œê°€ ë§ë‹¤. ì „ë¬¸ ê²€ìƒ‰ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ì¿¼ë¦¬ì—ì„œëŠ” ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤. ë³‘í•©ëœ ì²˜ë¦¬ ê²°ê³¼ëŠ” í•­ìƒ 2ê°œ ì´ìƒì˜ ì§‘í•©ì´ ë˜ê¸° ë•Œë¬¸ì— êµì§‘í•©, í•©ì§‘í•© ë˜ëŠ” ì¤‘ë³µ ì œê±°ì™€ ê°™ì€ ë¶€ê°€ì ì¸ ì‘ì—…ì´ ë” í•„ìš”í•˜ë‹¤. EXPLAINSELECT * FROM employeesWHERE emp_no BETWEEN 10001 AND 11000 OR first_name='Smith'; id select_type table type key key_len ref rows Extra 1 SIMPLE employees index_merge PRIMARY, ix_firstname 4,44 Â  1521 Using union(PRIMARY ,ix_firstname); Using where index ì¸ë±ìŠ¤ë¥¼ ì²˜ìŒë¶€í„° ëê¹Œì§€ ì½ëŠ” â€˜ì¸ë±ìŠ¤ í’€ ìŠ¤ìº”â€™ ë°©ì‹ì„ ì˜ë¯¸í•œë‹¤. ë§ì€ ì‚¬ëŒë“¤ì´ â€˜indexâ€™ë¼ëŠ” ì´ë¦„ ë•Œë¬¸ì— íš¨ìœ¨ì ì´ë¼ê³  ì˜¤í•´í•˜ì§€ë§Œ, range ì ‘ê·¼ ë°©ì‹ê³¼ ê°™ì´ ì¸ë±ìŠ¤ì˜ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì½ëŠ” ê²ƒì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— ë¹„íš¨ìœ¨ì ì¼ ìˆ˜ ìˆë‹¤. í…Œì´ë¸”ì„ ì²˜ìŒë¶€í„° ëê¹Œì§€ ì½ëŠ” â€˜í’€ í…Œì´ë¸” ìŠ¤ìº”â€™ ë°©ì‹ê³¼ ë¹„êµí•˜ëŠ” ë°ì´í„° ê±´ìˆ˜ëŠ” ê°™ë‹¤. í•˜ì§€ë§Œ, ì¸ë±ìŠ¤ëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë°ì´í„° íŒŒì¼ ì „ì²´ í¬ê¸°ë³´ë‹¤ëŠ” ì‘ì•„ì„œ í’€ í…Œì´ë¸” ìŠ¤ìº” ë³´ë‹¤ëŠ” ë¹ ë¥´ë‹¤. ë‹¤ìŒ ì¡°ê±´ ì¤‘, (1,2) ë˜ëŠ” (1,3)ì¸ ê²½ìš° index ì ‘ê·¼ ë°©ë²•ì´ ì‚¬ìš©ëœë‹¤. rangeë‚˜ const ë˜ëŠ” refì™€ ê°™ì€ ì ‘ê·¼ ë°©ì‹ìœ¼ë¡œ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš° ì¸ë±ìŠ¤ì— í¬í•¨ëœ ì»¬ëŸ¼ë§Œìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì¿¼ë¦¬ì¸ ê²½ìš°(ë°ì´í„° íŒŒì¼ ì½ì§€ ì•Šì•„ë„ ë˜ëŠ” ê²½ìš°) ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•´ ì •ë ¬ì´ë‚˜ ê·¸ë£¹í•‘ ì‘ì—…ì´ ê°€ëŠ¥í•œ ê²½ìš°(ë³„ë„ì˜ ì •ë ¬ ì‘ì—… í•„ìš” ì—†ëŠ” ê²½ìš°) EXPLAINSELECT * FROM departmentsORDER BY dept_name DESC LIMIT 10; id select_type table type key key_len ref rows Extra 1 SIMPLE departments index ux_firstname 123 Â  9 Using index ALL í…Œì´ë¸”ì„ ì²˜ìŒë¶€í„° ëê¹Œì§€ ì½ëŠ” â€˜í’€ í…Œì´ë¸” ìŠ¤ìº”â€™ ë°©ì‹ì´ë‹¤. ìœ„ì—ì„œ ì‚´í´ë³¸ ëª¨ë“  ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ê²½ìš° ë§ˆì§€ë§‰ìœ¼ë¡œ ì„ íƒë˜ëŠ” ê°€ì¥ ë¹„íš¨ìœ¨ì ì¸ ë°©ë²•ì´ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ DBMSì—ëŠ” ì´ëŸ¬í•œ í’€ ìŠ¤ìº” ë°©ì‹ìœ¼ë¡œ ì¸í•œ ëŒ€ëŸ‰ì˜ ë””ìŠ¤í¬ I/Oë¥¼ ìœ ë°œí•˜ëŠ” ì‘ì—…ì„ ìœ„í•´ Read Ahaedë¼ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. Read Ahead : í•œ ë²ˆì— ì—¬ëŸ¬ í˜ì´ì§€ë¥¼ ì½ì–´ì„œ ì²˜ë¦¬í•˜ëŠ” ê¸°ëŠ¥ ì¿¼ë¦¬ë¥¼ íŠœë‹í•œë‹¤ëŠ” ê²ƒì´ ë¬´ì¡°ê±´ ì¸ë±ìŠ¤ í’€ ìŠ¤ìº”ì´ë‚˜, í…Œì´ë¸” í’€ ìŠ¤ìº”ì„ ì‚¬ìš©í•˜ì§€ ëª»í•˜ê²Œ í•˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤.ë‹¤ìŒ íŒŒíŠ¸ì—ì„œëŠ” ì‹¤í–‰ ê³„íšì˜ ë‚˜ë¨¸ì§€ ì»¬ëŸ¼ë“¤ì— ëŒ€í•´ ì‚´í´ë³¼ ê²ƒì´ë‹¤.ê´€ë ¨ ê¸€ MySQL ì‹¤í–‰ ê³„íš (1) MySQL ì‹¤í–‰ ê³„íš (3)ì°¸ê³  ìë£Œ ì´ì„±ìš±, ã€ê°œë°œìì™€ DBAë¥¼ ìœ„í•œ Real MySQLã€, ìœ„í‚¤ë¶ìŠ¤(2012), 6ì¥" }, { "title": "MySQL - MySQL ì‹¤í–‰ ê³„íš (1)", "url": "/posts/execution-plan-part1/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "MySQL", "date": "2021-10-07 23:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ ê³ ì³ë³´ê³  ì‹¶ì€ë° ì–´ë–¤ ë¶€ë¶„ì—ì„œ ë¹„íš¨ìœ¨ì´ ë°œìƒí•˜ëŠ”ì§€ëŠ” â€œì‹¤í–‰ ê³„íšâ€ì„ ë³´ë©´ ì•Œ ìˆ˜ ìˆë‹¤ê³  ë“¤ì—ˆë‹¤. ì‹¤í–‰ ê³„íšì´ ë¬´ì—‡ì´ê³  ì–´ë–»ê²Œ í™œìš©í•´ì•¼ í•˜ëŠ” ê²ƒì¸ì§€ ê³µë¶€í•´ë³´ì.ì‹¤í–‰ ê³„íš DBMSì˜ ì¿¼ë¦¬ ì‹¤í–‰ì€ ê°™ì€ ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ ë‚´ëŠ” ë‹¤ì–‘í•œ ë°©ë²•ì´ ìˆë‹¤. ê·¸ ì¤‘ ì–´ë–¤ ë°©ë²•ì´ ìµœì ì´ê³  ìµœì†Œì˜ ë¹„ìš©ì´ ì†Œëª¨ë ì§€ ê²°ì •í•´ì•¼ í•œë‹¤.ì´ëŸ¬í•œ ìµœì ì˜ ì‹¤í–‰ ê³„...", "content": "ë“¤ì–´ê°€ê¸° ì „ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ ê³ ì³ë³´ê³  ì‹¶ì€ë° ì–´ë–¤ ë¶€ë¶„ì—ì„œ ë¹„íš¨ìœ¨ì´ ë°œìƒí•˜ëŠ”ì§€ëŠ” â€œì‹¤í–‰ ê³„íšâ€ì„ ë³´ë©´ ì•Œ ìˆ˜ ìˆë‹¤ê³  ë“¤ì—ˆë‹¤. ì‹¤í–‰ ê³„íšì´ ë¬´ì—‡ì´ê³  ì–´ë–»ê²Œ í™œìš©í•´ì•¼ í•˜ëŠ” ê²ƒì¸ì§€ ê³µë¶€í•´ë³´ì.ì‹¤í–‰ ê³„íš DBMSì˜ ì¿¼ë¦¬ ì‹¤í–‰ì€ ê°™ì€ ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ ë‚´ëŠ” ë‹¤ì–‘í•œ ë°©ë²•ì´ ìˆë‹¤. ê·¸ ì¤‘ ì–´ë–¤ ë°©ë²•ì´ ìµœì ì´ê³  ìµœì†Œì˜ ë¹„ìš©ì´ ì†Œëª¨ë ì§€ ê²°ì •í•´ì•¼ í•œë‹¤.ì´ëŸ¬í•œ ìµœì ì˜ ì‹¤í–‰ ê³„íšì„ ìˆ˜ë¦½í•˜ëŠ” ì—­í• ì€ ì˜µí‹°ë§ˆì´ì €ê°€ ë‹´ë‹¹í•œë‹¤. ì‹¤í–‰ ê³„íšì„ ì´í•´í•  ìˆ˜ ìˆì–´ì•¼ ë¶ˆí•©ë¦¬í•œ ë¶€ë¶„ì„ ì°¾ì•„ë‚´ê³ , ìµœì í™”ëœ ë°©ë²•ìœ¼ë¡œ ì‹¤í–‰ ê³„íšì„ ìˆ˜ë¦½í•˜ë„ë¡ ìœ ë„í•  ìˆ˜ ìˆë‹¤. MySQL ì„œë²„ì—ì„œ ì¿¼ë¦¬ê°€ ì‹¤í–‰ë˜ëŠ” ê³¼ì •ì€ í¬ê²Œ ë‹¤ìŒê³¼ ê°™ì´ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤. íŒŒì‹±(SQL íŒŒì„œ) ì¿¼ë¦¬ ë¬¸ì¥ì„ MySQL ì„œë²„ê°€ ì´í•´í•  ìˆ˜ ìˆëŠ” ìˆ˜ì¤€ìœ¼ë¡œ ë¶„ë¦¬(íŒŒìŠ¤ íŠ¸ë¦¬ ìƒì„±) ìµœì í™” ë° ì‹¤í–‰ ê³„íš ìˆ˜ë¦½(ì˜µí‹°ë§ˆì´ì €) íŒŒìŠ¤ íŠ¸ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì–´ë–¤ í…Œì´ë¸”ë¶€í„° ì½ê³  ì–´ë–¤ ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•´ì„œ í…Œì´ë¸”ì„ ì½ì„ì§€ ì„ íƒ 2ë²ˆ ë‹¨ê³„ê°€ ì™„ë£Œë˜ë©´ ì‹¤í–‰ ê³„íšì´ ë§Œë“¤ì–´ì§„ë‹¤. ìˆ˜ë¦½ëœ ì‹¤í–‰ ê³„íšëŒ€ë¡œ ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì— ë ˆì½”ë“œë¥¼ ì½ì–´ì˜¤ë„ë¡ ìš”ì²­. MySQL ì—”ì§„ì—ì„œëŠ” ìŠ¤í† ë¦¬ì§€ ì—”ì§„ìœ¼ë¡œë¶€í„° ë°›ì€ ë ˆì½”ë“œë¥¼ ì¡°ì¸í•˜ê±°ë‚˜ ì •ë ¬í•˜ëŠ” ì‘ì—… ìˆ˜í–‰ì˜µí‹°ë§ˆì´ì €ì˜ ìµœì í™” ë°©ë²• í˜„ì¬ ë§ì€ DBMSê°€ ì„ íƒí•˜ê³  ìˆëŠ” ë¹„ìš© ê¸°ë°˜ ìµœì í™”(Cost-based optimizer, CBO) ë°©ë²•ê³¼ ì˜ˆì „ ì˜¤ë¼í´ì—ì„œ ë§ì´ ì‚¬ìš©í–ˆë˜ ê·œì¹™ ê¸°ë°˜ ìµœì í™”(Rule-based optimizer, RBO)ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤. ê·œì¹™ ê¸°ë°˜ ìµœì í™” ì˜¤ì§ ì˜µí‹°ë§ˆì´ì €ì— ë‚´ì¥ëœ ìš°ì„ ìˆœìœ„ì— ë”°ë¼ ì‹¤í–‰ ê³„íšì„ ìˆ˜ë¦½í•˜ëŠ” ë°©ì‹ì´ë‹¤. ì´ ë°©ì‹ì—ì„œëŠ” í†µê³„ ì •ë³´(ëŒ€ìƒ í…Œì´ë¸”ì˜ ë ˆì½”ë“œ ê±´ìˆ˜, ì»¬ëŸ¼ ê°’ì˜ ë¶„í¬ë„ ë“±)ë¥¼ ê³ ë ¤í•˜ì§€ ì•Šê³  ì‹¤í–‰ ê³„íšì´ ìˆ˜ë¦½ëœë‹¤. ê° í…Œì´ë¸”ì´ë‚˜ ì¸ë±ìŠ¤ì˜ í†µê³„ ì •ë³´ê°€ ê±°ì˜ ì—†ê³ , ìƒëŒ€ì ìœ¼ë¡œ ëŠë¦° CPU ì—°ì‚° íƒ“ì— ë¹„ìš© ê³„ì‚° ê³¼ì •ì´ ë¶€ë‹´ìŠ¤ëŸ¬ì› ê¸° ë•Œë¬¸ì— ì‚¬ìš©í•˜ë˜ ë°©ì‹ì´ë‹¤. ì´ë¯¸ ì˜¤ë˜ ì „ë¶€í„° ë§ì€ DBMSì—ì„œ ë” ì´ìƒ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. ë¹„ìš© ê¸°ë°˜ ìµœì í™” ì‚°ì¶œëœ ê° ì‹¤í–‰ ê³„íšë³„ ìµœì†Œ ë¹„ìš©ì´ ì†Œìš”ë˜ëŠ” ì²˜ë¦¬ ë°©ì‹ì„ ì„ íƒí•œë‹¤. ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ ë°©ë²•ì„ ìˆ˜ë¦½í•œë‹¤. ê° ë‹¨ìœ„ ì‘ì—…ì˜ ë¹„ìš©(ë¶€í•˜) ì •ë³´ì™€ ëŒ€ìƒ í…Œì´ë¸”ì˜ ì˜ˆì¸¡ëœ í†µê³„ ì •ë³´ë¥¼ ì´ìš©í•´ ê° ì‹¤í–‰ ê³„íšë³„ ë¹„ìš©ì„ ì‚°ì¶œí•œë‹¤. í†µê³„ ì •ë³´ ë¹„ìš© ê¸°ë°˜ ìµœì í™” ë°©ì‹ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€ â€˜í†µê³„ ì •ë³´â€™ì´ë‹¤. í†µê³„ ì •ë³´ê°€ ì •í™•í•˜ì§€ ì•Šìœ¼ë©´ ì¿¼ë¦¬ê°€ ë§¤ìš° ë¹„íš¨ìœ¨ì ìœ¼ë¡œ ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ MySQLì—ì„œ ê´€ë¦¬ë˜ëŠ” í†µê³„ ì •ë³´ëŠ” ëŒ€ëµì˜ ë ˆì½”ë“œ ê±´ìˆ˜ì™€ ì¸ë±ìŠ¤ì˜ ìœ ë‹ˆí¬í•œ ê°’ì˜ ê°œìˆ˜ì •ë„ì´ë‹¤. ë ˆì½”ë“œ ê±´ìˆ˜ê°€ ë§ì§€ ì•Šìœ¼ë©´ ì •ë³´ê°€ ë¶€ì •í™•í•œ ê²½ìš°ê°€ ë§ìœ¼ë¯€ë¡œ ANALYZE ëª…ë ¹ì„ ì´ìš©í•´ ê°•ì œì ìœ¼ë¡œ í†µê³„ ì •ë³´ë¥¼ ê°±ì‹ í•´ì•¼ í•  ë•Œë„ ìˆë‹¤. ì˜¤ë¼í´ê³¼ ê°™ì€ DBMSì—ì„œëŠ” í†µê³„ ì •ë³´ê°€ ìƒë‹¹íˆ ì •ì ì´ê³  ìˆ˜ì§‘ì— ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ê¸° ë•Œë¬¸ì— í†µê³„ ì •ë³´ë§Œ ë”°ë¡œ ë°±ì—…í•˜ê¸°ë„ í•œë‹¤.ì‹¤í–‰ ê³„íš ë¶„ì„ MySQLì—ì„œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ EXPLAIN ëª…ë ¹ì„ ì‚¬ìš©í•´ì„œ ì‹¤í–‰ ê³„íšì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë˜í•œ, EXPLAIN EXTENDED, EXPLAIN PARTITIONS ëª…ë ¹ì„ ì´ìš©í•´ ë” ìƒì„¸í•œ ì‹¤í–‰ ê³„íšì„ í™•ì¸í•  ìˆ˜ë„ ìˆë‹¤. EXPLAINì„ ì‹¤í–‰í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ í‘œ í˜•íƒœë¡œëœ ê²°ê³¼ê°€ í‘œì‹œëœë‹¤. í‘œì˜ ê° ë¼ì¸ì€ ì¿¼ë¦¬ ë¬¸ì¥ì—ì„œ ì‚¬ìš©ëœ í…Œì´ë¸”(ì„œë¸Œ ì¿¼ë¦¬ë¥¼ í†µí•´ ìƒì„±ëœ ì„ì‹œ í…Œì´ë¸”ë„ í¬í•¨)ì˜ ê°œìˆ˜ë§Œí¼ ì¶œë ¥ëœë‹¤. í‘œì˜ ìœ„ìª½ì— ìˆì„ìˆ˜ë¡ ë¨¼ì € ì ‘ê·¼í•œ í…Œì´ë¸”ì´ë‹¤. ë‹¤ë¥¸ DBMSì™€ëŠ” ë‹¬ë¦¬ MySQLì—ì„œëŠ” í•„ìš”ì— ë”°ë¼ ì‹¤í–‰ ê³„íšì„ ì‚°ì¶œí•˜ê¸° ìœ„í•´ ì¿¼ë¦¬ì˜ ì¼ë¶€ë¶„ì„ ì§ì ‘ ì‹¤í–‰í•  ë•Œë„ ìˆë‹¤. ë”°ë¼ì„œ ì¿¼ë¦¬ ìì²´ê°€ ìƒë‹¹íˆ ë³µì¡í•˜ê³  ë¬´ê±°ìš´ ê²½ìš°ì—ëŠ” ì‹¤í–‰ ê³„íšì˜ ì¡°íšŒ ë˜í•œ ëŠë ¤ì§ˆ ê°€ëŠ¥ì„±ì´ ìˆë‹¤. SELECT ì´ì™¸ì˜ DML(UPDATE, INSERT, DELETE)ì— ëŒ€í•´ì„œëŠ” ì‹¤í–‰ê³„íšì„ í™•ì¸í•  ë°©ë²•ì´ ì—†ë‹¤. ì´ë¥¼ ìœ„í•´ì„œëŠ” WHERE ì¡°ê±´ì ˆë§Œ ê°™ì€ SELECT ì¿¼ë¦¬ë¥¼ ë§Œë“¤ì–´ì„œ ëŒ€ëµì ìœ¼ë¡œ ê³„íšì„ í™•ì¸í•´ ë³¼ ìˆ˜ ìˆë‹¤. ë‹¤ìŒ íŒŒíŠ¸ì—ì„œë¶€í„° ì‹¤í–‰ ê³„íšì˜ ê° ì»¬ëŸ¼ì´ ì–´ë–¤ ê²ƒì„ ì˜ë¯¸í•˜ëŠ”ì§€, ì–´ë–¤ ê°’ì´ ë‚˜ì˜¬ ìˆ˜ ìˆëŠ”ì§€ ë“±ì— ëŒ€í•´ ì‚´í´ë³¼ ê²ƒì´ë‹¤.ê´€ë ¨ ê¸€ MySQL ì‹¤í–‰ ê³„íš (2) MySQL ì‹¤í–‰ ê³„íš (3)ì°¸ê³  ìë£Œ ì´ì„±ìš±, ã€ê°œë°œìì™€ DBAë¥¼ ìœ„í•œ Real MySQLã€, ìœ„í‚¤ë¶ìŠ¤(2012), 6ì¥" }, { "title": "MySQL - MySQL ë‚´ë¶€ êµ¬ì¡° ê°„ë‹¨íˆ ì‚´í´ë³´ê¸°", "url": "/posts/mysql-architecture/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "MySQL", "date": "2021-10-06 23:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ ê³ ì³ë³´ê³  ì‹¶ì€ë° ê³ ì¹˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ì§€ì— ëŒ€í•œ ì§€ì‹ì´ ì „í˜€ì—†ë‹¤. ê·¼ë° ìŠ¬ë¡œìš° ì¿¼ë¦¬ëŠ” ì°¨ì¹˜í•˜ê³ , ì¿¼ë¦¬ê°€ ì–´ë–»ê²Œ ë™ì‘í•˜ê³  DB ë‚´ë¶€ëŠ” ì–´ë–»ê²Œ ìƒê¸´ì§€ì— ëŒ€í•´ì„œë„ ê³µë¶€í•´ë³´ì§€ ì•Šì•˜ë‹¤.ê·¸ë˜ì„œ ë¨¼ì € MySQLì„ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¶€ êµ¬ì¡°ê°€ ì–´ë–¤ì§€ ì„¸ë¶€ì ì¸ ë‚´ìš©ì„ ì œì™¸í•˜ê³  ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.MySQLì˜ ì „ì²´ì ì¸ êµ¬ì¡° MySQL ê³ ìœ ì˜ ...", "content": "ë“¤ì–´ê°€ê¸° ì „ìŠ¬ë¡œìš° ì¿¼ë¦¬ë¥¼ ê³ ì³ë³´ê³  ì‹¶ì€ë° ê³ ì¹˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ì§€ì— ëŒ€í•œ ì§€ì‹ì´ ì „í˜€ì—†ë‹¤. ê·¼ë° ìŠ¬ë¡œìš° ì¿¼ë¦¬ëŠ” ì°¨ì¹˜í•˜ê³ , ì¿¼ë¦¬ê°€ ì–´ë–»ê²Œ ë™ì‘í•˜ê³  DB ë‚´ë¶€ëŠ” ì–´ë–»ê²Œ ìƒê¸´ì§€ì— ëŒ€í•´ì„œë„ ê³µë¶€í•´ë³´ì§€ ì•Šì•˜ë‹¤.ê·¸ë˜ì„œ ë¨¼ì € MySQLì„ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¶€ êµ¬ì¡°ê°€ ì–´ë–¤ì§€ ì„¸ë¶€ì ì¸ ë‚´ìš©ì„ ì œì™¸í•˜ê³  ê°„ë‹¨í•˜ê²Œ ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.MySQLì˜ ì „ì²´ì ì¸ êµ¬ì¡° MySQL ê³ ìœ ì˜ C APIë¶€í„° JDBC, ODBC, .NETì˜ í‘œì¤€ ë“œë¼ì´ë²„ ë“±ì„ ì œê³µí•œë‹¤. ì´ëŸ¬í•œ ë“œë¼ì´ë²„ëŠ” ë‹¤ì–‘í•œ ì–¸ì–´(C/C++, ìë°” ë“±)ê°€ MySQL ì„œë²„ì—ì„œ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ì§€ì›í•œë‹¤.MySQL ì„œë²„ëŠ” í¬ê²Œ MySQL ì—”ì§„ê³¼ ìŠ¤í† ë¦¬ì§€ ì—”ì§„ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤. ì¶œì²˜ : https://dev.mysql.com/doc/refman/8.0/en/pluggable-storage-overview.html MySQL ì—”ì§„ ìš”ì²­ëœ SQL ë¬¸ì¥ì„ ë¶„ì„, ìµœì í™”í•˜ëŠ” ë“± DBMSì˜ ë‘ë‡Œ ì—­í• ì„ ìˆ˜í–‰í•œë‹¤. ì»¤ë„¥ì…˜ í•¸ë“¤ëŸ¬ í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„°ì˜ ì ‘ì† ë° ì¿¼ë¦¬ ìš”ì²­ì„ ì²˜ë¦¬ SQL íŒŒì„œ ì¿¼ë¦¬ë¥¼ í† í°(MySQLì´ ì¸ì‹í•  ìˆ˜ ìˆëŠ” ìµœì†Œ ë‹¨ìœ„ì˜ ì–´íœ˜, ê¸°í˜¸)ìœ¼ë¡œ ë¶„ë¦¬í•´ íŠ¸ë¦¬ í˜•íƒœì˜ êµ¬ì¡°(íŒŒì„œ íŠ¸ë¦¬)ë¡œ ë§Œë“ ë‹¤. ì¿¼ë¦¬ì˜ ë¬¸ë²• ì˜¤ë¥˜ë¥¼ ì´ ê³¼ì •ì—ì„œ ë°œê²¬ëœë‹¤. ì „ì²˜ë¦¬ê¸° íŒŒì„œ íŠ¸ë¦¬ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¿¼ë¦¬ ë¬¸ì¥ì— êµ¬ì¡°ì ì¸ ë¬¸ì œê°€ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤. í† í°ì„ í…Œì´ë¸” ì´ë¦„, ì¹¼ëŸ¼ ë“±ì— ë§¤í•‘í•´ í•´ë‹¹ ê°ì²´ì˜ ì¡´ì¬ ì—¬ë¶€ì™€ ì ‘ê·¼ ê¶Œí•œ ë“±ì„ í™•ì¸í•œë‹¤. ì˜µí‹°ë§ˆì´ì € ì¿¼ë¦¬ ë¬¸ì¥ì„ ì €ë ´í•œ ë¹„ìš©ìœ¼ë¡œ ê°€ì¥ ë¹ ë¥´ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ê²°ì •í•œë‹¤. ìºì‹œ, ë²„í¼ ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•´ MyISAMì˜ í‚¤ ìºì‹œë‚˜ InnoDBì˜ ë²„í¼ í’€ê³¼ ê°™ì€ ë³´ì¡° ì €ì¥ì†Œ ê¸°ëŠ¥ì´ í¬í•¨ëœë‹¤. ì‹¤í–‰ ì—”ì§„ ì¿¼ë¦¬ì— ê¸°ë°˜í•˜ì—¬ ë§Œë“¤ì–´ì§„ ì‹¤í–‰ ê³„íšëŒ€ë¡œ ê° í•¸ë“¤ëŸ¬(ìŠ¤í† ë¦¬ì§€ ì—”ì§„)ì—ê²Œ ìš”ì²­í•´ì„œ ë°›ì€ ê²°ê³¼ë¥¼ ë˜ ë‹¤ë¥¸ í•¸ë“¤ëŸ¬ ìš”ì²­ì˜ ì…ë ¥ìœ¼ë¡œ ì—°ê²°í•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, GROUP BYë¥¼ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì„ ì‚´í´ë³´ì. ì‹¤í–‰ ì—”ì§„ì€ í•¸ë“¤ëŸ¬ì—ê²Œ ì„ì‹œ í…Œì´ë¸”ì„ ë§Œë“¤ë¼ê³  ìš”ì²­ ì‹¤í–‰ ì—”ì§„ì€ WHERE ì ˆì— ì¼ì¹˜í•˜ëŠ” ë ˆì½”ë“œë¥¼ ì½ì–´ì˜¤ë¼ê³  í•¸ë“¤ëŸ¬ì—ê²Œ ìš”ì²­ ì½ì–´ì˜¨ ë ˆì½”ë“œë¥¼ 1ë²ˆì—ì„œ ì¤€ë¹„í•œ ì„ì‹œ í…Œì´ë¸”ë¡œ ì €ì¥í•˜ë¼ê³  í•¸ë“¤ëŸ¬ì—ê²Œ ìš”ì²­ ë°ì´í„°ê°€ ì¤€ë¹„ëœ ì„ì‹œ í…Œì´ë¸”ì—ì„œ í•„ìš”í•œ ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì½ì–´ ì˜¤ë¼ê³  í•¸ë“¤ëŸ¬ì—ê²Œ ìš”ì²­ ì‹¤í–‰ ê²°ê³¼ë¥¼ ì‚¬ìš©ìë‚˜ ë‹¤ë¥¸ ëª¨ë“ˆë¡œ ë„˜ê¹€ ìŠ¤í† ë¦¬ì§€ ì—”ì§„ ì‹¤ì œ ë°ì´í„°ë¥¼ ë””ìŠ¤í¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•˜ê±°ë‚˜, ë””ìŠ¤í¬ ìŠ¤í† ë¦¬ì§€ë¡œë¶€í„° ë°ì´í„°ë¥¼ ì½ì–´ì˜¨ë‹¤. InnoDB, MyISAM ë“± MySQL ì—”ì§„ì€ í•˜ë‚˜ì´ì§€ë§Œ ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì€ ì—¬ëŸ¬ ê°œë¥¼ ë™ì‹œì— ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ì™€ ê°™ì´ TEST í…Œì´ë¸”ì„ ìƒì„±í•œë‹¤ë©´, í•´ë‹¹ í…Œì´ë¸”ì— CRUD ì‘ì—… ìˆ˜í–‰ì‹œ InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì´ ì²˜ë¦¬í•˜ê²Œ ëœë‹¤.CREATE TABLE TEST ~~ ENGINE = INNODBí•¸ë“¤ëŸ¬ API í•¸ë“¤ëŸ¬ ìš”ì²­ MySQL ì—”ì§„ì˜ ì¿¼ë¦¬ ì‹¤í–‰ê¸°ì—ì„œ ë°ì´í„°ë¥¼ ì“°ê±°ë‚˜ ì½ì–´ì•¼ í•  ë•Œ, ê° ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì—ê²Œ ì“°ê¸° ë˜ëŠ” ì½ê¸°ë¥¼ ìš”ì²­í•˜ëŠ” ê²ƒ. í•¸ë“¤ëŸ¬ ìš”ì²­ì‹œ ì‚¬ìš©ë˜ëŠ” APIë¥¼ í•¸ë“¤ëŸ¬ APIë¼ê³  í•œë‹¤. InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ ë˜í•œ í•¸ë“¤ëŸ¬ APIë¥¼ ì´ìš©í•´ MySQL ì—”ì§„ê³¼ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ”ë‹¤. SHOW GLOBAL STATUS LIKE 'Handler%' í•¸ë“¤ëŸ¬ APIë¥¼ í†µí•´ ì–¼ë§ˆë‚˜ ë§ì€ ë°ì´í„°(ë ˆì½”ë“œ) ì‘ì—…ì´ ìˆì—ˆëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ìŠ¤ë ˆë”© êµ¬ì¡° MySQL ì„œë²„ëŠ” ìŠ¤ë ˆë“œ ê¸°ë°˜ìœ¼ë¡œ ì‘ë™í•˜ë©°, í¬ê²Œ Foreground ìŠ¤ë ˆë“œì™€ Background ìŠ¤ë ˆë“œë¡œ êµ¬ë¶„ëœë‹¤.Foreground ìŠ¤ë ˆë“œ(í´ë¼ì´ì–¸íŠ¸ ìŠ¤ë ˆë“œ) í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•˜ëŠ” ì¿¼ë¦¬ ë¬¸ì¥ì„ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì£¼ ì—­í• ì´ë‹¤. ìµœì†Œí•œ MySQL ì„œë²„ì— ì ‘ì†ëœ í´ë¼ì´ì–¸íŠ¸ì˜ ìˆ˜ë§Œí¼ ì¡´ì¬í•œë‹¤. í´ë¼ì´ì–¸íŠ¸ê°€ ì‘ì—…ì„ ë§ˆì¹˜ê³  ì»¤ë„¥ì…˜ì„ ì¢…ë£Œí•˜ë©´, í•´ë‹¹ ì»¤ë„¥ì…˜ì„ ë‹´ë‹¹í•˜ë˜ ìŠ¤ë ˆë“œëŠ” ë‹¤ì‹œ ìŠ¤ë ˆë“œ ìºì‹œë¡œ ë˜ëŒì•„ê°„ë‹¤. ì¼ì • ê°œìˆ˜ì˜ ìŠ¤ë ˆë“œë¥¼ ìŠ¤ë ˆë“œ ìºì‹œì— ìœ ì§€í•˜ë ¤ë©´ thread_cache_size íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•œë‹¤. ë°ì´í„°ë¥¼ MySQLì˜ ë°ì´í„° ë²„í¼ë‚˜ ìºì‹œë¡œë¶€í„° ê°€ì ¸ì˜¨ë‹¤. ë²„í¼ë‚˜ ìºì‹œì— ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš°, ë””ìŠ¤í¬ë‚˜ ì¸ë±ìŠ¤ íŒŒì¼ë¡œë¶€í„° ë°ì´í„°ë¥¼ ì½ì–´ì˜¨ë‹¤. MyISAM í…Œì´ë¸”ì€ ë””ìŠ¤í¬ ì“°ê¸° ì‘ì—…ê¹Œì§€ í¬ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œê°€ ì²˜ë¦¬í•œë‹¤. InnoDB í…Œì´ë¸”ì€ ë°ì´í„° ë²„í¼ë‚˜ ìºì‹œê¹Œì§€ë§Œ í¬ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œê°€ ì²˜ë¦¬í•˜ê³ , ë””ìŠ¤í¬ê¹Œì§€ ì“°ëŠ” ì‘ì—…ì€ ë°±ê·¸ë¼ìš´ë“œ ìŠ¤ë ˆë“œê°€ ì²˜ë¦¬í•œë‹¤. Background ìŠ¤ë ˆë“œ íŠ¹íˆ InnoDBëŠ” ì¸ì„œíŠ¸ ë²„í¼ë¥¼ ë³‘í•©í•˜ëŠ” ìŠ¤ë ˆë“œ, ë¡œê·¸ë¥¼ ë””ìŠ¤í¬ë¡œ ê¸°ë¡í•˜ëŠ” ìŠ¤ë ˆë“œ, ë²„í¼ í’€ì˜ ë°ì´í„°ë¥¼ ë””ìŠ¤í¬ì— ê¸°ë¡í•˜ëŠ” ìŠ¤ë ˆë“œ ë“±ì„ í†µí•´ ì—¬ëŸ¬ ê°€ì§€ ì‘ì—…ì´ ë°±ê·¸ë¼ìš´ë“œë¡œ ì²˜ë¦¬ëœë‹¤. ì“°ê¸° ìŠ¤ë ˆë“œ MySQL 5.0(ìœˆë„ìš° ê¸°ì¤€, ìœ ë‹‰ìŠ¤ëŠ” 5.1)ë¶€í„° innodb_write_io_threads íŒŒë¼ë¯¸í„°ë¥¼ ì‚¬ìš©í•˜ì—¬ ì“°ê¸° ìŠ¤ë ˆë“œ ê°œìˆ˜ë¥¼ 1ê°œ ì´ìƒ ì§€ì •í•  ìˆ˜ ìˆë‹¤. ì¼ë°˜ì ì¸ ë‚´ì¥ ë””ìŠ¤í¬ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” 2~4ê°œ, DASë‚˜ SANê³¼ ê°™ì€ ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” 4ê°œ ì´ìƒìœ¼ë¡œ ì¶©ë¶„íˆ ì„¤ì •í•´ í•´ë‹¹ ìŠ¤í† ë¦¬ì§€ ì¥ë¹„ê°€ ì¶©ë¶„íˆ í™œìš©ë  ìˆ˜ ìˆê²Œ í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ë©”ëª¨ë¦¬ í• ë‹¹ ë° ì‚¬ìš© êµ¬ì¡° í¬ê²Œ ê¸€ë¡œë²Œ ë©”ëª¨ë¦¬ ì˜ì—­ê³¼ ë¡œì»¬ ë©”ëª¨ë¦¬ ì˜ì—­ìœ¼ë¡œ êµ¬ë¶„ëœë‹¤. ê° ì˜ì—­ì€ ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ê³µìœ í•´ì„œ ì‚¬ìš©í•˜ëŠ”ì§€ ì•„ë‹Œì§€ì— ë”°ë¼ êµ¬ë¶„ëœë‹¤.ê¸€ë¡œë²Œ ë©”ëª¨ë¦¬ ì˜ì—­ ê¸€ë¡œë²Œ ì˜ì—­ì˜ ëª¨ë“  ë©”ëª¨ë¦¬ ê³µê°„ì€ MySQL ì„œë²„ê°€ ì‹œì‘ë˜ë©´ì„œ ìš´ì˜ì²´ì œë¡œë¶€í„° í• ë‹¹ëœë‹¤. ì¼ë°˜ì ìœ¼ë¡œ í•˜ë‚˜ì˜ ë©”ëª¨ë¦¬ ê³µê°„ë§Œ í• ë‹¹ë˜ì§€ë§Œ, í•„ìš”ì— ë”°ë¼ 2ê°œ ì´ìƒì˜ ë©”ëª¨ë¦¬ ê³µê°„ì„ í• ë‹¹ë°›ì„ ìˆ˜ë„ ìˆë‹¤.í´ë¼ì´ì–¸íŠ¸ ìŠ¤ë ˆë“œ ìˆ˜ì™€ëŠ” ë¬´ê´€í•˜ë©°, ìƒì„±ëœ ê¸€ë¡œë²Œ ì˜ì—­ì´ Nê°œë¼ í•˜ë”ë¼ë„ ëª¨ë“  ìŠ¤ë ˆë“œì— ì˜í•´ ê³µìœ ëœë‹¤. êµ¬ì„± ìš”ì†Œ í‚¤ ìºì‹œ(MyISAM) / ë²„í¼ í’€(InnoDB) / ì¿¼ë¦¬ ìºì‹œ / ë°”ì´ë„ˆë¦¬ ë¡œê·¸ ë²„í¼ / ë¡œê·¸ ë²„í¼ / í…Œì´ë¸” ìºì‹œ ìš´ì˜ì²´ì œì˜ ë©”ëª¨ë¦¬ í• ë‹¹ ë°©ì‹ì€ ë§¤ìš° ë³µì¡í•˜ê¸° ë•Œë¬¸ì— MySQL ì„œë²„ê°€ ì‚¬ìš©í•˜ëŠ” ì •í™•í•œ ë©”ëª¨ë¦¬ ì–‘ì„ ì¸¡ì •í•˜ëŠ” ê²ƒì€ ì‰½ì§€ ì•Šë‹¤. ì¼ë‹¨ì€ MySQL íŒŒë¼ë¯¸í„°ë¡œ ì„¤ì •í•´ ë‘” ë§Œí¼ ìš´ì˜ì²´ì œë¡œë¶€í„° ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹ë°›ëŠ”ë‹¤ê³  ìƒê°í•˜ì.ë¡œì»¬(ì„¸ì…˜) ë©”ëª¨ë¦¬ ì˜ì—­ í´ë¼ì´ì–¸íŠ¸ ìŠ¤ë ˆë“œê°€ ì¿¼ë¦¬ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš©í•˜ëŠ” ë©”ëª¨ë¦¬ ì˜ì—­ì´ë‹¤. ê° í´ë¼ì´ì–¸íŠ¸ ìŠ¤ë ˆë“œë³„ë¡œ ë…ë¦½ì ìœ¼ë¡œ í• ë‹¹ë˜ê¸° ë•Œë¬¸ì— ì ˆëŒ€ ê³µìœ ë˜ì§€ ì•ŠëŠ”ë‹¤. êµ¬ì„± ìš”ì†Œ ì»¤ë„¥ì…˜ ë²„í¼ / Result ë²„í¼ / Read ë²„í¼ / ì¡°ì¸ ë²„í¼ / ëœë¤ Read ë²„í¼ / Sort ë²„í¼ ë¡œì»¬ ë©”ëª¨ë¦¬ ì˜ì—­ì˜ ê²½ìš°, ê° ì¿¼ë¦¬ì˜ ìš©ë„ë³„ë¡œ í•„ìš”í•  ë•Œë§Œ ê³µê°„ì´ í• ë‹¹ë˜ê³  í•„ìš”í•˜ì§€ ì•Šì€ ê²½ìš°ì—ëŠ” MySQLì´ ë©”ëª¨ë¦¬ ê³µê°„ì„ í• ë‹¹ì¡°ì°¨ í•˜ì§€ ì•Šì„ ìˆ˜ë„ ìˆë‹¤. ì»¤ë„¥ì…˜ ë²„í¼, Result ë²„í¼ëŠ” ì»¤ë„¥ì…˜ì´ ì—´ë ¤ ìˆëŠ” ë™ì•ˆ ê³„ì† í• ë‹¹ëœ ìƒíƒœë¡œ ë‚¨ëŠ”ë‹¤. Sort ë²„í¼, ì¡°ì¸ ë²„í¼ëŠ” ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ëŠ” ìˆœê°„ì—ë§Œ í• ë‹¹í–ˆë‹¤ê°€ í•´ì œí•œë‹¤.ì°¸ê³  ìë£Œ ì´ì„±ìš±, ã€ê°œë°œìì™€ DBAë¥¼ ìœ„í•œ Real MySQLã€, ìœ„í‚¤ë¶ìŠ¤(2012), 3ì¥" }, { "title": "Java - ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ëŠ” ê³¼ì • ì‚´í´ë³´ê¸°", "url": "/posts/java-how-java-works/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-09-27 00:29:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ëŠ” ê³¼ì •ì„ ê°„ë‹¨íˆ ë„ì‹í™” í•˜ë©´ ì•„ë˜ì²˜ëŸ¼ í‘œí˜„í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ì´ë¥¼ ì»´íŒŒì¼ê³¼ ì‹¤í–‰ì´ë¼ëŠ” ë‘ ë‹¨ê³„ë¡œ ë‚˜ëˆ ì„œ, ê° ë‹¨ê³„ë³„ë¡œ ì–´ë–¤ ê³¼ì •ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ì‚´í´ë³´ì.â€» ì»´íŒŒì¼ íŒŒíŠ¸ëŠ” HomoEfficio ë‹˜ì˜ ë¸”ë¡œê·¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì •ë¦¬í•˜ì˜€ìŒì„ ë¯¸ë¦¬ ë°í™ë‹ˆë‹¤.1. ì»´íŒŒì¼ javac ì»´íŒŒì¼ëŸ¬ì— ì˜í•´ ìë°” ì†ŒìŠ¤ ì½”ë“œ íŒŒì¼(.java)...", "content": "ë“¤ì–´ê°€ê¸° ì „ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‹¤í–‰ë˜ëŠ” ê³¼ì •ì„ ê°„ë‹¨íˆ ë„ì‹í™” í•˜ë©´ ì•„ë˜ì²˜ëŸ¼ í‘œí˜„í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. ì´ë¥¼ ì»´íŒŒì¼ê³¼ ì‹¤í–‰ì´ë¼ëŠ” ë‘ ë‹¨ê³„ë¡œ ë‚˜ëˆ ì„œ, ê° ë‹¨ê³„ë³„ë¡œ ì–´ë–¤ ê³¼ì •ì´ ì¼ì–´ë‚˜ëŠ”ì§€ ì‚´í´ë³´ì.â€» ì»´íŒŒì¼ íŒŒíŠ¸ëŠ” HomoEfficio ë‹˜ì˜ ë¸”ë¡œê·¸ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì •ë¦¬í•˜ì˜€ìŒì„ ë¯¸ë¦¬ ë°í™ë‹ˆë‹¤.1. ì»´íŒŒì¼ javac ì»´íŒŒì¼ëŸ¬ì— ì˜í•´ ìë°” ì†ŒìŠ¤ ì½”ë“œ íŒŒì¼(.java) â†’ JVM ë°”ì´íŠ¸ì½”ë“œ(.class)ë¡œ ë³€í™˜ë˜ëŠ” ê³¼ì • Cì™€ ê°™ì€ ëŒ€ë¶€ë¶„ì˜ ë‹¤ë¥¸ ì–¸ì–´ëŠ” Intel ë˜ëŠ” HP í”„ë¡œì„¸ì„œ ê´€ë ¨ ëª…ë ¹ì–´ì™€ ê°™ì€ ì»´í“¨í„° ê´€ë ¨ ëª…ë ¹ì–´ë¡œ ì»´íŒŒì¼ëœë‹¤. í•˜ì§€ë§Œ, Java ì½”ë“œëŠ” ì»´íŒŒì¼ë˜ë©´ í”Œë«í¼ì— ë…ë¦½ì ì¸ í‘œì¤€ ë°”ì´íŠ¸ì½”ë“œ ì„¸íŠ¸ë¡œ ë³€í™˜ë˜ë©°, ì´ ë°”ì´íŠ¸ì½”ë“œëŠ” JVM(Java Virtual Machine)ì— ì˜í•´ ì‹¤í–‰ëœë‹¤. Javaì—ì„œëŠ” ê° ëª…ë ¹ì–´ê°€ 1ë°”ì´íŠ¸ì˜ ê· ì¼í•œ í¬ê¸°ë¥¼ ê°€ì§€ë¯€ë¡œ ì´ëŸ¬í•œ ëª…ë ¹ì–´ë¥¼ ë°”ì´íŠ¸ì½”ë“œë¼ê³  í•œë‹¤. JVM ìŠ¤í™ì˜ .class íŒŒì¼ êµ¬ì¡°ì— ë§ëŠ” ë°”ì´íŠ¸ì½”ë“œë¥¼ ë§Œë“¤ì–´ ë‚¼ ìˆ˜ ìˆë‹¤ë©´ ì–´ë–¤ ì–¸ì–´ë“  JVMì—ì„œ ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤. í´ë¡œì €(Clojure)ë‚˜ ìŠ¤ì¹¼ë¼, ì½”í‹€ë¦° ë“±ì´ JVMì—ì„œ ì‹¤í–‰ë  ìˆ˜ ìˆëŠ” ì´ìœ ê°€ ë°”ë¡œ ì—¬ê¸°ì— ìˆë‹¤. ì»´íŒŒì¼ ê³¼ì • ì»´íŒŒì¼ì„ í¬ê²Œ ë‘ íŒŒíŠ¸ë¡œ ë‚˜ëˆ„ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤. ìë°” ì–¸ì–´ ìŠ¤í™ì— ë”°ë¼ ìë°” ì½”ë“œ ë¶„ì„/ê²€ì¦ JVM ìŠ¤í™ì˜ class íŒŒì¼ êµ¬ì¡°ì— ë§ëŠ” ë°”ì´íŠ¸ì½”ë“œë¥¼ ìƒì„± 1. ìë°” ì–¸ì–´ ìŠ¤í™ì— ë”°ë¼ ë¶„ì„/ê²€ì¦ ì–´íœ˜ ë¶„ì„ (Lexical Analysis) Lexical Analyzer(Lexer ë˜ëŠ” Tokenizerë¼ê³ ë„ í•œë‹¤)ê°€ ì†ŒìŠ¤ ì½”ë“œì—ì„œ ë¬¸ì ë‹¨ìœ„ë¡œ ì½ì–´ì„œ ì–´íœ˜ì†Œ(lexeme)ë¥¼ ì‹ë³„í•˜ê³  ì–´íœ˜ì†Œë¥¼ ì„¤ëª…í•˜ëŠ” í† í° ìŠ¤íŠ¸ë¦¼(Token Stream)ì„ ìƒì„±í•œë‹¤. êµ¬ë¬¸ ë¶„ì„ (Syntax Analysis) Syntax Analyzer(êµ¬ë¬¸ ë¶„ì„ê¸°, Parser ë¼ê³ ë„ í•œë‹¤)ê°€ ì–´íœ˜ ë¶„ì„ ê²°ê³¼ë¡œ ë‚˜ì˜¨ í† í° ìŠ¤íŠ¸ë¦¼ì´ ì–¸ì–´ì˜ ìŠ¤í™ìœ¼ë¡œ ì •í•´ì§„ ë¬¸ë²• í˜•ì‹ì— ë§ëŠ”ì§€ ê²€ì‚¬í•´ì„œ, ë§ì§€ ì•Šìœ¼ë©´ ì»´íŒŒì¼ ì—ëŸ¬ë¥¼ ë‚´ê³ , ë§ìœ¼ë©´ Parse Treeë¥¼ ìƒì„±í•œë‹¤. ì˜ë¯¸ ë¶„ì„ (Symantic Analysis) íƒ€ì… ê²€ì‚¬, ìë™ íƒ€ì… ë³€í™˜ ë“±ì´ ìˆ˜í–‰ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œ(int a = \"Hello\";)ëŠ” êµ¬ë¬¸ ë¶„ì„ ë‹¨ê³„ì—ì„œëŠ” ì—ëŸ¬ê°€ ë‚˜ì§€ ì•Šì§€ë§Œ, ì˜ë¯¸ ë¶„ì„ ë‹¨ê³„ì—ì„œëŠ” íƒ€ì… ê²€ì‚¬ê°€ ìˆ˜í–‰ë˜ë©´ì„œ ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. ì˜ë¯¸ ë¶„ì„ ë‹¨ê³„ë¥¼ ê±°ì¹˜ë©´ì„œ Parse Treeì— íƒ€ì… ê´€ë ¨ ì •ë³´ ë“±ì´ ì¶”ê°€ëœë‹¤. 2. JVM ìŠ¤í™ì˜ class íŒŒì¼ êµ¬ì¡°ì— ë§ëŠ” ë°”ì´íŠ¸ì½”ë“œë¥¼ ìƒì„± ì¤‘ê°„ ì½”ë“œ ìƒì„± (Intermediate Code Generation) ì˜ë¯¸ ë¶„ì„ ë‹¨ê³„ë¥¼ í†µê³¼í•œ íŒŒìŠ¤ íŠ¸ë¦¬ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê¸°ê³„ì–´ë¡œ ë³€í™˜í•˜ê¸° ì¢‹ì€ í˜•íƒœì˜ ì¤‘ê°„ ì–¸ì–´ë¡œ ëœ ì¤‘ê°„ ì½”ë“œë¥¼ ìƒì„±í•œë‹¤. ì¤‘ê°„ ë‹¨ê³„ë¥¼ í•˜ë‚˜ ë‘¬ì„œ ê°„ì ‘í™”ë¥¼ í†µí•´ ê²½ìš°ì˜ ìˆ˜ë¥¼ ë‚®ì¶”ê³  íš¨ìœ¨ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤. ìë°”ì˜ ë°”ì´íŠ¸ì½”ë“œê°€ ì¤‘ê°„ ì½”ë“œì— í•´ë‹¹í•œë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤. ë‹¤ìŒ ê·¸ë¦¼ì—ì„œ 4ê°œì˜ ì–¸ì–´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë„¤ëª¨ë¥¼ ê°ê° ìë°”, í´ë¡œì €(Clojure), ìŠ¤ì¹¼ë¼, ì½”í‹€ë¦°ì´ë¼ë©´, ë…¹ìƒ‰ ë„¤ëª¨ëŠ” ë°”ì´íŠ¸ì½”ë“œë¼ê³  í•  ìˆ˜ ìˆë‹¤. ì¶œì²˜ : https://www.slideshare.net/RamchandraRegmi/intermediate-code-generationramchandra-regmi/ ì¤‘ê°„ ì½”ë“œ ìµœì í™” (Code Optimization) ì¤‘ê°„ ì½”ë“œê°€ ë” íš¨ìœ¨ì ì¸ ê¸°ê³„ì–´ë¡œ ë³€í™˜ë˜ë„ë¡ ìµœì í™”í•˜ëŠ” ê³¼ì •ì´ë‹¤. ë‹¤ìŒê³¼ ê°™ì´ ë§¤ìš° ë‹¤ì–‘í•œ ìµœì í™” ê¸°ë²•ì´ ì‚¬ìš©ëœë‹¤. í•í™€(Peephole) ìµœì í™” ì§€ì—­ ìµœì í™” ë£¨í”„ ìµœì í™” ì „ì—­ ìµœì í™” 2. ì‹¤í–‰ java [options] mainclass [args...] ë¡œ ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. java ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ê²Œ ë˜ë©´ JRE(Java Runtime Environment)ë¥¼ ì‹œì‘ (ë°”ì´íŠ¸ì½”ë“œ ì‹¤í–‰) ì§€ì •ëœ í´ë˜ìŠ¤ë¥¼ ë¡œë“œ í•´ë‹¹ í´ë˜ìŠ¤ì˜ main() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰ ìœ„ì—ì„œ ì‚´í´ë³¸ ê³¼ì •ì€ JVMì´ ë‹´ë‹¹í•˜ê²Œ ëœë‹¤. JVMì´ ë¬´ì—‡ì´ê³  ì–´ë–»ê²Œ í•´ë‹¹ ê³¼ì •ì„ ìˆ˜í–‰í•˜ëŠ”ì§€ ì‚´í´ë³´ì. JVM(Java Virtual Machine)ì´ë€ ? ê³µì‹ ë¬¸ì„œì—ì„œëŠ” JVMì„ ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„í•œë‹¤. A JVM is a separate program that is optimized for the specific platform on which you run your Java code. â†’ â€œJVMì€ Java ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” íŠ¹ì • í”Œë«í¼ì— ìµœì í™”ëœ ë³„ë„ì˜ í”„ë¡œê·¸ë¨ì´ë‹¤.â€ ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•  ë•Œ ìë°” ì–¸ì–´ë¡œ ì‘ì„±ëœ ì‚¬ì „ ì •ì˜ëœ core class libraryë¥¼ ì‚¬ìš©í•œë‹¤. core class libraryëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” íŒ¨í‚¤ì§€ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ê¸°ë³¸ ì–¸ì–´ ì§€ì›ì€ java.lang, I/O ì§€ì›ì€ java.io, ë„¤íŠ¸ì›Œí¬ ì ‘ê·¼ì€ java.net íŒ¨í‚¤ì§€ë¥¼ í†µí•´ ì œê³µëœë‹¤. JVMê³¼ core class libraryëŠ” ìë°”ë¥¼ ì§€ì›í•˜ëŠ” ëª¨ë“  ìš´ì˜ ì²´ì œì—ì„œ ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ê°œë°œí•  ìˆ˜ ìˆëŠ” í”Œë«í¼ì„ ì œê³µí•œë‹¤. ì´ë¥¼ í†µí•´ ìë°”ì˜ í•µì‹¬ ì‚¬ìƒì¸ â€œwrite once, run anywhereâ€(WORA)ê°€ ê°€ëŠ¥í•´ì§„ë‹¤. ìë°”ë¥¼ ë‹¤ìš´ë°›ì„ ë•Œ, ìš´ì˜ì²´ì œ ë³„ë¡œ ë‚˜ë‰˜ì–´ì ¸ ìˆëŠ” ê²ƒì„ ìƒê°í•´ë³´ë©´ ì‰½ê²Œ ì™€ë‹¿ì„ ê²ƒ ê°™ë‹¤.JVMì´ ë°”ì´íŠ¸ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê¸°ê¹Œì§€ JVMì˜ êµ¬ì„±ìš”ì†Œë¥¼ ì‚´í´ë³´ë©´ì„œ ì–´ë–»ê²Œ ì‹¤í–‰ë˜ëŠ”ì§€ ì•Œì•„ë³´ì. ì¶œì²˜ : https://www.geeksforgeeks.org/jvm-works-jvm-architecture/1. Class Loader : Loading, Linking, Initializing JVMì€ í´ë˜ìŠ¤ì™€ ì¸í„°í˜ì´ìŠ¤ë¥¼ ë™ì ìœ¼ë¡œ ë¡œë“œ, ì—°ê²° ë° ì´ˆê¸°í™”í•œë‹¤.Loading íŠ¹ì • ì´ë¦„ì„ ê°€ì§„ í´ë˜ìŠ¤, ì¸í„°í˜ì´ìŠ¤ íƒ€ì…ì˜ ì´ì§„ í‘œí˜„ì„ ë°”íƒ•ìœ¼ë¡œ í´ë˜ìŠ¤, ì¸í„°í˜ì´ìŠ¤ë¥¼ ë§Œë“œëŠ” ê³¼ì •ì´ë‹¤. í´ë˜ìŠ¤ ë¡œë”ëŠ” .class íŒŒì¼ì„ ì½ê³  í•´ë‹¹ íŒŒì¼ì— ëŒ€í•œ ì´ì§„ ë°ì´í„°ë¥¼ Method Areaì— ì €ì¥í•œë‹¤. JVMì€ ê° .class íŒŒì¼ì— ëŒ€í•´ ë‹¤ìŒ ì •ë³´ë¥¼ Method Areaì— ì €ì¥í•œë‹¤. ë¡œë“œëœ í´ë˜ìŠ¤ ë° í•´ë‹¹ ì§ê³„ ë¶€ëª¨ í´ë˜ìŠ¤ì˜ ì •ê·œí™”ëœ(fully qualified) ì´ë¦„ public class Demo { public static void main(String[] argv) throws Exception { Class c = java.util.ArrayList.class; String className = c.getName(); System.out.println(\"The fully-qualified name of the class is: \" + className); // The fully-qualified name of the class is: java.util.ArrayList }} .class íŒŒì¼ì´ Class, Interface ë˜ëŠ” Enumê³¼ ê´€ë ¨ì´ ìˆëŠ”ì§€ ì—¬ë¶€ ìˆ˜ì •ì(public, final, static, â€¦), ë³€ìˆ˜, ë©”ì„œë“œ ì •ë³´ ë“± .class íŒŒì¼ì„ ë¡œë“œí•œ í›„ JVMì€ ì´ íŒŒì¼ì„ í™ ë©”ëª¨ë¦¬ì— ë‚˜íƒ€ë‚´ê¸° ìœ„í•´ Class íƒ€ì…ì˜ ê°ì²´ë¥¼ ìƒì„±í•œë‹¤. ì´ ê°ì²´ëŠ” java.lang íŒ¨í‚¤ì§€ì— ë¯¸ë¦¬ ì •ì˜ëœ java.lang.Class&lt;T&gt;ì´ë‹¤. Class ê°ì²´ëŠ” í´ë˜ìŠ¤ ì´ë¦„, ë¶€ëª¨ ì´ë¦„, ë©”ì„œë“œ ë° ë³€ìˆ˜ ì •ë³´ ë“±ê³¼ ê°™ì€ í´ë˜ìŠ¤ ë ˆë²¨ì˜ ì •ë³´ë¥¼ ì–»ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì´ ê°ì²´ ì°¸ì¡°ë¥¼ ì–»ìœ¼ë ¤ë©´ Object.getClass() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤. ë¡œë“œëœ ëª¨ë“  .class íŒŒì¼ì— ëŒ€í•´ í•˜ë‚˜ì˜ í´ë˜ìŠ¤ ê°ì²´ë§Œ ìƒì„±ëœë‹¤.Linking í´ë˜ìŠ¤, ì¸í„°í˜ì´ìŠ¤ë¥¼ ê²°í•©í•˜ì—¬ JVMì´ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ìƒíƒœë¡œ ë§Œë“œëŠ” ê³¼ì •ì´ë‹¤. verification, preparation, (ì„ íƒì ìœ¼ë¡œ) resolutionì„ ìˆ˜í–‰í•œë‹¤. Verification .class íŒŒì¼ì˜ ì •í™•ì„±ì„ ë³´ì¥í•œë‹¤. ì¦‰, ì˜¬ë°”ë¥¸ í˜•ì‹ìœ¼ë¡œ ì˜¬ë°”ë¥¸ ì»´íŒŒì¼ëŸ¬ì— ì˜í•´ ìƒì„±ë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•œë‹¤. ê²€ì¦ì— ì‹¤íŒ¨í•˜ë©´ ëŸ°íƒ€ì„ ì˜ˆì™¸ java.lang.VerifyErrorê°€ ë°œìƒí•œë‹¤. ì´ ê³¼ì •ì€ â€˜ByteCodeVerifierâ€™ ì»´í¬ë„ŒíŠ¸ì— ì˜í•´ ìˆ˜í–‰ëœë‹¤. ê²€ì¦ì´ ì™„ë£Œë˜ë©´ class.íŒŒì¼ì„ (ê¸°ê³„ì–´ë¡œ) ì»´íŒŒì¼í•  ì¤€ë¹„ê°€ ëœ ê²ƒì´ë‹¤. Preparation JVMì€ í´ë˜ìŠ¤ ë³€ìˆ˜ì— ëŒ€í•œ ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•˜ê³  ë©”ëª¨ë¦¬ë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”í•œë‹¤. Resolution íƒ€ì…ì˜ ì‹¬ë³¼ë¦­ ë ˆí¼ëŸ°ìŠ¤ë¥¼ direct ë ˆí¼ëŸ°ìŠ¤ë¡œ ë°”ê¾¸ëŠ” ê³¼ì •ì´ë‹¤. ì°¸ì¡°ëœ ì—”í„°í‹°ë¥¼ ì°¾ê¸° ìœ„í•´ ë©”ì„œë“œ ì˜ì—­ì„ íƒìƒ‰í•œë‹¤. Initialization í´ë˜ìŠ¤ ë˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì˜ ì´ˆê¸°í™” ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ë‹¤. ì´ ë‹¨ê³„ì—ì„œ ëª¨ë“  static ë³€ìˆ˜ëŠ” ì½”ë“œ ë° static block(ìˆëŠ” ê²½ìš°)ì— ì •ì˜ëœ ê°’ìœ¼ë¡œ í• ë‹¹ëœë‹¤. í´ë˜ìŠ¤ì—ì„œëŠ” ìœ„ì—ì„œ ì•„ë˜ë¡œ, í´ë˜ìŠ¤ ê³„ì¸µì—ì„œëŠ” ë¶€ëª¨ì—ì„œ ìì‹ ìˆœì„œë¡œ ì‹¤í–‰ëœë‹¤.ì°¸ê³ . í´ë˜ìŠ¤ ë¡œë” êµ¬ì„± ì¼ë°˜ì ìœ¼ë¡œ, ì„¸ ê°€ì§€ í´ë˜ìŠ¤ ë¡œë”ë¡œ êµ¬ì„±ëœë‹¤. Bootstrap class loader JAVA_HOME/jre/lib ë””ë ‰í† ë¦¬ì— ìˆëŠ” í•µì‹¬ Java API í´ë˜ìŠ¤ë¥¼ ë¡œë“œí•œë‹¤. ì´ ê²½ë¡œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ë¶€íŠ¸ìŠ¤íŠ¸ë© ê²½ë¡œë¡œ ì•Œë ¤ì ¸ìˆë‹¤. C, C++ ë“±ì˜ native ì–¸ì–´ë¡œ êµ¬í˜„ë˜ì–´ ìˆë‹¤. ëª¨ë“  JVM êµ¬í˜„ì—ëŠ” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” í´ë˜ìŠ¤ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆëŠ” ë¶€íŠ¸ìŠ¤íŠ¸ë© í´ë˜ìŠ¤ ë¡œë”ê°€ ìˆì–´ì•¼í•œë‹¤. Extension class loader ë¶€íŠ¸ìŠ¤íŠ¸ë© í´ë˜ìŠ¤ ë¡œë”ì˜ ìì‹ì´ë‹¤. JAVA_HOME/jre/lib/ext(í™•ì¥ ê²½ë¡œ) ë˜ëŠ” java.ext.dirs ì‹œìŠ¤í…œ ì†ì„±ì— ì˜í•´ ì§€ì •ëœ ë‹¤ë¥¸ ë””ë ‰í† ë¦¬ì— ìˆëŠ” í´ë˜ìŠ¤ë¥¼ ë¡œë“œí•œë‹¤. ìë°”ì—ì„œëŠ” sun.misc.Launcher$ExtClassLoader í´ë˜ìŠ¤ì— ì˜í•´ êµ¬í˜„ëœë‹¤. System/Application class loader í™•ì¥ í´ë˜ìŠ¤ ë¡œë”ì˜ ìì‹ì…ë‹ˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ classpathì—ì„œ í´ë˜ìŠ¤ë¥¼ ë¡œë“œí•˜ëŠ” ì—­í• ì„ ìˆ˜í–‰í•œë‹¤. ë‚´ë¶€ì ìœ¼ë¡œ java.class.pathì— ë§¤í•‘ëœ í™˜ê²½ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•œë‹¤. ìë°”ì—ì„œëŠ” sun.misc.Launcher$AppClassLoader í´ë˜ìŠ¤ì— ì˜í•´ êµ¬í˜„ëœë‹¤. public class Test { public static void main(String[] args) { // String class is loaded by bootstrap loader, and // bootstrap loader is not Java object, hence null System.out.println(String.class.getClassLoader()); // null // Test class is loaded by Application loader System.out.println(Test.class.getClassLoader()); // jdk.internal.loader.ClassLoaders$AppClassLoader@8bcc55f }} JVMì€ Delegation-Hierarchy ì›ì¹™ì— ë”°ë¼ í´ë˜ìŠ¤ë¥¼ ë¡œë“œí•œë‹¤. ì‹œìŠ¤í…œ í´ë˜ìŠ¤ ë¡œë”ëŠ” í™•ì¥ í´ë˜ìŠ¤ ë¡œë”ì— ë¡œë“œ ìš”ì²­ì„ ìœ„ì„í•˜ê³ , í™•ì¥ í´ë˜ìŠ¤ ë¡œë”ëŠ” ë¶€íŠ¸ìŠ¤íŠ¸ë© í´ë˜ìŠ¤ ë¡œë”ì— ìš”ì²­ì„ ìœ„ì„í•œë‹¤. ë¶€íŠ¸ìŠ¤íŠ¸ë© ê²½ë¡œì— í´ë˜ìŠ¤ê°€ ìˆëŠ” ê²½ìš° í•´ë‹¹ í´ë˜ìŠ¤ê°€ ë¡œë“œë˜ì§€ ì•Šìœ¼ë©´ ë‹¤ì‹œ ìš”ì²­ì„ í™•ì¥ í´ë˜ìŠ¤ ë¡œë”ë¡œ ì „ì†¡í•œ ë‹¤ìŒ ì‹œìŠ¤í…œ í´ë˜ìŠ¤ ë¡œë”ë¡œ ì „ì†¡í•œë‹¤. ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹œìŠ¤í…œ í´ë˜ìŠ¤ ë¡œë”ê°€ í´ë˜ìŠ¤ ë¡œë“œì— ì‹¤íŒ¨í•˜ë©´ ëŸ°íƒ€ì„ ì˜ˆì™¸ java.lang.ClassNotFoundExceptionì´ ë°œìƒí•œë‹¤. ì¶œì²˜ : https://www.geeksforgeeks.org/jvm-works-jvm-architecture/2. Runtime Data Arae(JVM Memory)í•´ë‹¹ ë‚´ìš©ê³¼ ê´€ë ¨í•˜ì—¬ ì •ë¦¬í–ˆë˜ í¬ìŠ¤íŒ…ì„ ì°¸ì¡°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.3. Execution Engine ë°”ì´íŠ¸ ì½”ë“œë¥¼ í•œ ì¤„ì”© ì½ì–´ë“¤ì—¬ ë‹¤ì–‘í•œ ë©”ëª¨ë¦¬ ì˜ì—­ì— ìˆëŠ” ë°ì´í„°ì™€ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ëª…ë ¹ì„ ì‹¤í–‰í•œë‹¤. í¬ê²Œ Interpreter, JIT Compiler, Garbage Collector ì„¸ ë¶€ë¶„ìœ¼ë¡œ êµ¬ì„±ëœë‹¤.Interpreter ë°”ì´íŠ¸ì½”ë“œë¥¼ í•œ ì¤„ì”© í•´ì„í•˜ì—¬ ì‹¤í–‰í•œë‹¤. ê°™ì€ ë©”ì„œë“œë¥¼ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, ë§¤ë²ˆ í•´ì„ì´ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— ë¹„íš¨ìœ¨ì ì´ë‹¤.JIT Compiler ì¸í„°í”„ë¦¬í„°ì˜ íš¨ìœ¨ì„±ì„ ë†’ì´ê¸° ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤. ì „ì²´ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ì»´íŒŒì¼í•˜ì—¬ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ë³€ê²½í•œë‹¤. ì¸í„°í”„ë¦¬í„°ê°€ ë°˜ë³µë˜ëŠ” ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ë•Œë§ˆë‹¤ í•´ë‹¹ ë¶€ë¶„ì— ëŒ€í•´ JITê°€ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¥¼ ì œê³µí•œë‹¤. ê²°ê³¼ì ìœ¼ë¡œ, ì¬í•´ì„ì´ í•„ìš”í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ íš¨ìœ¨ì„±ì´ í–¥ìƒëœë‹¤. Garbage Collector ë” ì´ìƒ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ë¥¼ ì œê±°í•œë‹¤.4. Java Native Interface (JNI) Native Method Librariesì™€ ì—°ë™í•˜ì—¬ ì‹¤í–‰ì— í•„ìš”í•œ Native Library(C, C++)ë¥¼ ì œê³µí•˜ëŠ” ì¸í„°í˜ì´ìŠ¤ì´ë‹¤. JVMì´ C/C++ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆê³ , í•˜ë“œì›¨ì–´ ì „ìš© C/C++ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ì˜í•´ í˜¸ì¶œë  ìˆ˜ë„ ìˆë‹¤.5. Native Method Libraries Execution Engineì—ì„œ í•„ìš”ë¡œ í•˜ëŠ” Native Libraries(C, C++)ì˜ ëª¨ìŒì´ë‹¤.ë” ê³µë¶€í•  ë¶€ë¶„ JIT Compiler Garbage Collector ë°”ì´íŠ¸ì½”ë“œì°¸ê³  ìë£Œ https://docs.oracle.com/cd/E11882_01/java.112/e10588/chone.htm#JJDEV13018 https://homoefficio.github.io/2019/01/31/Back-to-the-Essence-Java-%EC%BB%B4%ED%8C%8C%EC%9D%BC%EC%97%90%EC%84%9C-%EC%8B%A4%ED%96%89%EA%B9%8C%EC%A7%80-1/ https://homoefficio.github.io/2019/01/31/Back-to-the-Essence-Java-%EC%BB%B4%ED%8C%8C%EC%9D%BC%EC%97%90%EC%84%9C-%EC%8B%A4%ED%96%89%EA%B9%8C%EC%A7%80-2/ https://docs.oracle.com/en/java/javase/11/tools/java.html#GUID-3B1CE181-CD30-4178-9602-230B800D4FAE https://docs.oracle.com/javase/specs/jvms/se11/html/jvms-5.html#jvms-5.2 https://www.geeksforgeeks.org/jvm-works-jvm-architecture/" }, { "title": "Java - ìë°” ë²„ì „ë³„ íŠ¹ì§• ì‚´í´ë³´ê¸°(JAVA 7~17)", "url": "/posts/java-spec-per-version/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-09-25 22:25:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ê¸€ì„ ì‘ì„±í•˜ëŠ” í˜„ì¬(21.09.25) ìë°” ìµœì‹ ë²„ì „ì€ JDK17ì´ë‹¤. ê° ë²„ì „ë³„ íŠ¹ì§•ì„ ì‚´í´ë³´ë©´ì„œ ì´ëŸ°ê²Œ ìˆêµ¬ë‚˜ ì •ë„ë¥¼ ì¸ì§€í•˜ê³ , ì¶”í›„ì— ê³µë¶€ê°€ í•„ìš”í•œ ë¶€ë¶„ì€ ì¢€ ë” ìƒì„¸íˆ ê³µë¶€í•´ë³´ì.History 9 ë²„ì „ë¶€í„°ëŠ” 6ê°œì›” ë‹¨ìœ„ë¡œ ìƒˆë¡œìš´ ë²„ì „ì´ ì¶œì‹œë˜ê³  ìˆë‹¤. ë²„ì „ ì¶œì‹œì¼ JDK 1....", "content": "ë“¤ì–´ê°€ê¸° ì „ê¸€ì„ ì‘ì„±í•˜ëŠ” í˜„ì¬(21.09.25) ìë°” ìµœì‹ ë²„ì „ì€ JDK17ì´ë‹¤. ê° ë²„ì „ë³„ íŠ¹ì§•ì„ ì‚´í´ë³´ë©´ì„œ ì´ëŸ°ê²Œ ìˆêµ¬ë‚˜ ì •ë„ë¥¼ ì¸ì§€í•˜ê³ , ì¶”í›„ì— ê³µë¶€ê°€ í•„ìš”í•œ ë¶€ë¶„ì€ ì¢€ ë” ìƒì„¸íˆ ê³µë¶€í•´ë³´ì.History 9 ë²„ì „ë¶€í„°ëŠ” 6ê°œì›” ë‹¨ìœ„ë¡œ ìƒˆë¡œìš´ ë²„ì „ì´ ì¶œì‹œë˜ê³  ìˆë‹¤. ë²„ì „ ì¶œì‹œì¼ JDK 1.0 1996ë…„ 1ì›” JDK 1.1 1997ë…„ 2ì›” J2SE 1.2 1998ë…„ 12ì›” J2SE 1.3 2000ë…„ 5ì›” J2SE 1.4 2002ë…„ 2ì›” J2SE 5.0 2004ë…„ 9ì›” Java SE 6 2006ë…„ 12ì›” Java SE 7 (LTS) 2011ë…„ 7ì›” Java SE 8 (LTS) 2014ë…„ 3ì›” Java SE 9 2017ë…„ 9ì›” Java SE 10 2018ë…„ 3ì›” Java SE 11 (LTS) 2018ë…„ 9ì›” Java SE 12 2019ë…„ 3ì›” Java SE 13 2019ë…„ 9ì›” Java SE 14 2020ë…„ 3ì›” Java SE 15 2020ë…„ 9ì›” Java SE 16 2021ë…„ 3ì›” Java SE 17 (LTS) 2021ë…„ 9ì›” Java SE 18 (ì˜ˆì •) 2022ë…„ 3ì›” Java SE 19 (ì˜ˆì •) 2022ë…„ 9ì›” Java SE 20 (ì˜ˆì •) 2023ë…„ 3ì›” Java SE 21 (ì˜ˆì •, LTS) 2023ë…„ 9ì›” LTS (Long Term Support) Oracleì€ Oracle Lifetime ì§€ì› ì •ì±…ì— ì„¤ëª…ëœ ëŒ€ë¡œ Oracle Java SE ì œí’ˆì— ëŒ€í•œ Oracle Premier Supportë¥¼ ê³ ê°ì—ê²Œ ì œê³µí•œë‹¤. Java SE 8 ì´í›„ì˜ ì œí’ˆ ë¦´ë¦¬ìŠ¤ì˜ ê²½ìš° Oracleì€ íŠ¹ì • ë¦´ë¦¬ìŠ¤ë§Œ LTS(Long-Term-Support) ë¦´ë¦¬ìŠ¤ë¡œ ì§€ì •í•œë‹¤. Java SE 7, 8, 11 ë° 17ì€ LTS ë¦´ë¦¬ìŠ¤ì´ë‹¤. ì˜¤ë¼í´ì€ í–¥í›„ 2ë…„ë§ˆë‹¤ LTSë¥¼ ì¶œì‹œí•  ê³„íšì´ë©°, ì´ëŠ” ë‹¤ìŒ LTS ì¶œì‹œê°€ 2023ë…„ 9ì›”ì— Java 21ì´ë¼ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. Oracle Premier Supportë¥¼ ìœ„í•´, non-LTS ë¦´ë¦¬ìŠ¤ëŠ” ìµœì‹  LTS ë¦´ë¦¬ìŠ¤ì˜ êµ¬í˜„ ê°œì„  ì‚¬í•­ì˜ ëˆ„ì  ì§‘í•©ìœ¼ë¡œ ê°„ì£¼ëœë‹¤. ìƒˆë¡œìš´ ê¸°ëŠ¥ ë¦´ë¦¬ìŠ¤ê°€ ì œê³µë˜ë©´, ì´ì „ì˜ non-LTS ë¦´ë¦¬ìŠ¤ëŠ” ëŒ€ì²´ëœ ê²ƒìœ¼ë¡œ ê°„ì£¼ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´ Java SE 9ëŠ” non-LTS ë¦´ë¦¬ìŠ¤ì˜€ìœ¼ë©° ì¦‰ì‹œ Java SE 10(non-LTS)ìœ¼ë¡œ ëŒ€ì²´ë˜ì—ˆë‹¤. Java SE 10ì€ ì¦‰ì‹œ Java SE 11ë¡œ ëŒ€ì²´ë˜ì—ˆë‹¤. Java SE 11ì€ LTS ë¦´ë¦¬ìŠ¤ì´ë¯€ë¡œ Oracle ê³ ê°ì€ Java SE 12ê°€ ë¦´ë¦¬ìŠ¤ë˜ì—ˆë”ë¼ë„ Oracle Premier Support ë° ì •ê¸° ì—…ë°ì´íŠ¸ë¥¼ ë°›ê²Œ ëœë‹¤. ì¶œì²˜ : https://www.oracle.com/java/technologies/java-se-support-roadmap.html ì´ì œ ìë°”ì˜ ë²„ì „ë³„ íŠ¹ì§•ì„ ê°„ëµí•˜ê²Œ ì‚´í´ë³´ì. ì•„ì§ ê³µì‹ì ìœ¼ë¡œ ì§€ì›í•˜ëŠ” ë²„ì „ì¸ 7ë¶€í„° ì •ë¦¬í•´ë³´ì•˜ë‹¤.Java 7String in switch statement before java 7 public void testStringInSwitch(String param){ final String JAVA5 = \"Java 5\"; final String JAVA6 = \"Java 6\"; final String JAVA7 = \"Java 7\"; if (param.equals(JAVA5)){ System.out.println(JAVA5); } else if (param.equals(JAVA6)){ System.out.println(JAVA6); } else if (param.equals(JAVA7)){ System.out.println(JAVA7); } } from java 7 public void testStringInSwitch(String param){ final String JAVA5 = \"Java 5\"; final String JAVA6 = \"Java 6\"; final String JAVA7 = \"Java 7\"; switch (param) { case JAVA5: System.out.println(JAVA5); break; case JAVA6: System.out.println(JAVA6); break; case JAVA7: System.out.println(JAVA7); break; } } Binary Literals before java 7 public void testBinaryIntegralLiterals(){ int binary = 8; if (binary == 8){ System.out.println(true); } else{ System.out.println(false); }} from java 7 public void testBinaryIntegralLiterals(){ int binary = 0b1000; //2^3 = 8 if (binary == 8){ System.out.println(true); } else{ System.out.println(false); }} The try-with-resources before java 7 public void testTryWithResourcesStatement() throws FileNotFoundException, IOException{ FileInputStream in = null; try { in = new FileInputStream(\"java7.txt\"); System.out.println(in.read()); } finally { if (in != null) { in.close(); } }} from java 7 public void testTryWithResourcesStatement() throws FileNotFoundException, IOException{ try (FileInputStream in = new FileInputStream(\"java7.txt\")) { System.out.println(in.read()); }} Multi-Catch Similar Exceptions before java 7 public void testMultiCatch(){ try { throw new FileNotFoundException(\"FileNotFoundException\"); } catch (FileNotFoundException fnfo) { fnfo.printStackTrace(); } catch (IOException ioe) { ioe.printStackTrace();} from java 7 public void testMultiCatch(){ try { throw new FileNotFoundException(\"FileNotFoundException\"); } catch (FileNotFoundException | IOException fnfo) { fnfo.printStackTrace(); }} Underscores in Numeric Literalspublic void testUnderscoresNumericLiterals() { int oneMillion_ = 1_000_000; //new int oneMillion = 1000000; if (oneMillion_ == oneMillion){ System.out.println(true); } else{ System.out.println(false); }}Java 8Interface Default and Static Methods Java 8 ì´ì „ì—ëŠ” ì¸í„°í˜ì´ìŠ¤ì— public ì¶”ìƒ ë©”ì„œë“œë§Œ ì„ ì–¸í•  ìˆ˜ ìˆì—ˆë‹¤. Java 8 ë¶€í„°ëŠ” static, default ë©”ì„œë“œë¥¼ ì„ ì–¸í•  ìˆ˜ ìˆë‹¤. static method ì •ì  ë©”ì„œë“œëŠ” ì¸í„°í˜ì´ìŠ¤ ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°,. êµ¬í˜„ í´ë˜ìŠ¤ì—ì„œ ì¬ì •ì˜í•  ìˆ˜ ì—†ë‹¤. public interface Vehicle { static String producer() { return \"N&amp;F Vehicles\"; }}String producer = Vehicle.producer(); default method default ë©”ì†Œë“œëŠ” default í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì„ ì–¸ëœë‹¤. í•´ë‹¹ ë©”ì„œë“œëŠ” êµ¬í˜„ í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í†µí•´ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë‹¤. public interface Vehicle { default String getOverview() { return \"ATV made by \" + producer(); }}public class VehicleImpl implements Vehicle { ...}Vehicle vehicle = new VehicleImpl();String overview = vehicle.getOverview();Optional Java 8 ì´ì „ì—ëŠ” NPE(NullPointerException)ê°€ ë°œìƒí•  ê°€ëŠ¥ì„± ë•Œë¬¸ì— ê°œë°œìê°€ ì°¸ì¡°í•œ ê°’ì˜ ìœ íš¨ì„±ì„ ì£¼ì˜ ê¹Šê²Œ í™•ì¸í•´ì•¼ í–ˆë‹¤.ìœ íš¨ì„± ê²€ì‚¬ë¥¼ ìœ„í•´ ì„±ê°€ì‹œê³  ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê¸° ì‰¬ìš´ boilerplate codeê°€ í•„ìš”í–ˆë‹¤.Optional&lt;T&gt; í´ë˜ìŠ¤ëŠ” T íƒ€ì…ì˜ ê°ì²´ì— ëŒ€í•œ ì»¨í…Œì´ë„ˆë¡œ ì‘ë™í•œë‹¤. ì´ ê°’ì´ nullì´ ì•„ë‹Œ ê²½ìš° ì´ ê°ì²´ì˜ ê°’ì„ ë°˜í™˜í•  ìˆ˜ ìˆë‹¤.ì´ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì˜ ê°’ì´ nullì´ë©´ NPEë¥¼ ë˜ì§€ëŠ” ëŒ€ì‹  ë¯¸ë¦¬ ì •ì˜ëœ ì¼ë¶€ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. Without OptionalList&lt;String&gt; list = getList();List&lt;String&gt; listOpt = list != null ? list : new ArrayList&lt;&gt;();User user = getUser();if (user != null) { Address address = user.getAddress(); if (address != null) { String street = address.getStreet(); if (street != null) { return street; } }}return \"not specified\"; With OptionalList&lt;String&gt; listOpt = getList().orElseGet(() -&gt; new ArrayList&lt;&gt;());Optional&lt;User&gt; user = Optional.ofNullable(getUser());String result = user .map(User::getAddress) .map(Address::getStreet) .orElse(\"not specified\");Optional&lt;OptionalUser&gt; optionalUser = Optional.ofNullable(getOptionalUser());String result = optionalUser .flatMap(OptionalUser::getAddress) .flatMap(OptionalAddress::getStreet) .orElse(\"not specified\");Lambda í‘œí˜„ì‹// ìµëª… ë‚´ë¶€ í´ë˜ìŠ¤ ì‚¬ìš©Runnable runnable = new Runnable(){ @Override public void run(){ System.out.println(\"Hello world !\"); } };// ëŒë‹¤ ì‚¬ìš©Runnable runnable = () -&gt; System.out.println(\"Hello world two!\");Collections &amp; Streams Stream API í™œìš©í•˜ì—¬ í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë° ìŠ¤íƒ€ì¼ë¡œ ì½”ë”© ê°€ëŠ¥List&lt;String&gt; list = Arrays.asList(\"franz\", \"ferdinand\", \"fiel\", \"vom\", \"pferd\");list.stream() .filter(name -&gt; name.startsWith(\"f\")) .map(String::toUpperCase) .sorted() .forEach(System.out::println);Java 9Collections List, Set, Mapì„ ì‰½ê²Œ ìƒì„±í•  ìˆ˜ ìˆëŠ” í—¬í¼ ë©”ì„œë“œê°€ ìƒê²¼ë‹¤.List&lt;String&gt; list = List.of(\"one\", \"two\", \"three\");Set&lt;String&gt; set = Set.of(\"one\", \"two\", \"three\");Map&lt;String, String&gt; map = Map.of(\"foo\", \"one\", \"bar\", \"two\");Streams takeWhile, dropWhile, iterate ë©”ì„œë“œê°€ ì¶”ê°€ë˜ì—ˆë‹¤.Stream&lt;String&gt; stream = Stream.iterate(\"\", s -&gt; s + \"s\") .takeWhile(s -&gt; s.length() &lt; 10);Optionals ifPresentOrElse ë©”ì„œë“œê°€ ì¶”ê°€ë˜ì—ˆë‹¤.user.ifPresentOrElse(this::displayAccount, this::displayLogin);Interfaces ì¸í„°í˜ì´ìŠ¤ ë‚´ì—ì„œ private ë©”ì„œë“œë¥¼ ì„ ì–¸í•  ìˆ˜ ìˆë‹¤.public interface MyInterface { private static void myPrivateMethod(){ System.out.println(\"Yay, I am private!\"); }}HttpClient (Preview) Java 9ëŠ” ìì²´ì ì¸ ìµœì‹  Http í´ë¼ì´ì–¸íŠ¸ì¸ HttpClient Preview ë²„ì „ì„ ë„ì…í–ˆë‹¤. ì´ ì „ê¹Œì§€ì˜ Javaì˜ ë‚´ì¥ Http ì§€ì›ì€ ë‹¤ì†Œ ë‚®ì€ ìˆ˜ì¤€ì´ì—ˆê³  Apache HttpClient ë˜ëŠ” OkHttpì™€ ê°™ì€ íƒ€ì‚¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì•¼ í–ˆë‹¤.Java 10var í‚¤ì›Œë“œ ì§€ì—­ ë³€ìˆ˜(ë©”ì„œë“œ ë‚´ ë³€ìˆ˜)ì— ëŒ€í•´ íƒ€ì… ì¶”ë¡ ì´ ê°€ëŠ¥í•˜ë‹¤.public void foo() { var name = \"Lee\";}Java 11 Java 10ì€ ë¼ì´ì„ ìŠ¤ ì—†ì´ ìƒì—…ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë§ˆì§€ë§‰ ë¬´ë£Œ Oracle JDK ë¦´ë¦¬ìŠ¤ì˜€ë‹¤.ì¦‰, Java 11ë¶€í„°ëŠ” LTSë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ë¹„ìš©ì„ ì§€ë¶ˆí•´ì•¼ í•œë‹¤.Strings &amp; Files String, Files í´ë˜ìŠ¤ì— ìƒˆë¡œìš´ ë©”ì„œë“œê°€ ì¶”ê°€ëë‹¤.\"Marco\".isBlank();\"Mar\\nco\".lines();\"Marco \".strip();Path path = Files.writeString(Files.createTempFile(\"helloworld\", \".txt\"), \"Hi, my name is!\");String s = Files.readString(path);Running Java Files ìë°” íŒŒì¼ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ javacë¡œ ì»´íŒŒì¼ í•˜ì§€ ì•Šì•„ë„ ëœë‹¤. before java 11 $ javac HelloWorld.java$ java HelloWorldHello Java 8! from java 11 $ java HelloWorld.javaHello Java 11! ëŒë‹¤ì‹ì— var í‚¤ì›Œë“œ ì‚¬ìš©(var firstName, var lastName) -&gt; firstName + lastNameNot Predicate Method Predicate ì¸í„°í˜ì´ìŠ¤ì— ì •ì  not() ë©”ì†Œë“œê°€ ì¶”ê°€ë˜ì—ˆë‹¤.List&lt;String&gt; sampleList = Arrays.asList(\"Java\", \"\\n \\n\", \"Kotlin\", \" \");List withoutBlanks = sampleList.stream() .filter(Predicate.not(String::isBlank)) .collect(Collectors.toList());assertThat(withoutBlanks).containsExactly(\"Java\", \"Kotlin\");HttpClient (Standard) ìƒˆë¡œìš´ HTTP APIëŠ” ì „ë°˜ì ì¸ ì„±ëŠ¥ì„ í–¥ìƒì‹œí‚¤ê³  HTTP/1.1 ë° HTTP/2ë¥¼ ëª¨ë‘ ì§€ì›í•œë‹¤.HttpClient httpClient = HttpClient.newBuilder() .version(HttpClient.Version.HTTP_2) .connectTimeout(Duration.ofSeconds(20)) .build();HttpRequest httpRequest = HttpRequest.newBuilder() .GET() .uri(URI.create(\"http://localhost:\" + port)) .build();HttpResponse httpResponse = httpClient.send(httpRequest, HttpResponse.BodyHandlers.ofString());assertThat(httpResponse.body()).isEqualTo(\"Hello from the server!\");Collections java.util.Collection ì¸í„°í˜ì´ìŠ¤ì—ëŠ” IntFunction ì¸ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ìƒˆë¡œìš´ ê¸°ë³¸ toArray() ë©”ì†Œë“œê°€ í¬í•¨ëœë‹¤.ì´ë ‡ê²Œ í•˜ë©´ ì»¬ë ‰ì…˜ì—ì„œ ë°°ì—´ì„ ë” ì‰½ê²Œ ìƒì„±í•  ìˆ˜ ìˆë‹¤.List sampleList = Arrays.asList(\"Java\", \"Kotlin\");String[] sampleArray = sampleList.toArray(String[]::new);assertThat(sampleArray).containsExactly(\"Java\", \"Kotlin\");Java 12Switch Expression(Preview)boolean result = switch (status) { case SUBSCRIBER -&gt; true; case FREE_TRIAL -&gt; false; default -&gt; throw new IllegalArgumentException(\"something is murky!\");};Java 13Multiline Strings (Preview)String htmlWithJava13 = \"\"\" &lt;html&gt; &lt;body&gt; &lt;p&gt;Hello, world&lt;/p&gt; &lt;/body&gt; &lt;/html&gt; \"\"\";Java 14Switch Expression (Standard)int numLetters = switch (day) { case MONDAY, FRIDAY, SUNDAY -&gt; 6; case TUESDAY -&gt; 7; default -&gt; { String s = day.toString(); int result = s.length(); yield result; }};Records (Preview) boilerplate codeë¥¼ ì‘ì„±í•˜ëŠ” ê³ í†µì„ ì™„í™”í•˜ëŠ” ë° ë„ì›€ì´ ë˜ëŠ” Record í´ë˜ìŠ¤ê°€ ì¶”ê°€ë˜ì—ˆë‹¤.í•´ë‹¹ í´ë˜ìŠ¤ëŠ” ë°ì´í„°,(ì ì¬ì ìœ¼ë¡œ) getter/setter, equals/hashcode, toStringë§Œ í¬í•¨ëœë‹¤. before final class Point { public final int x; public final int y; public Point(int x, int y) { this.x = x; this.y = y; }} // state-based implementations of equals, hashCode, toString // nothing else record ì‚¬ìš©public record Point(int x, int y) { }var point = new Point(1, 2);point.x(); // returns 1point.y(); // returns 2Helpful NullPointerException ë§ˆì¹¨ë‚´ NullPointerExceptionì€ ì •í™•íˆ ì–´ë–¤ ë³€ìˆ˜ê°€ nullì¸ì§€ ì„¤ëª…í•œë‹¤.author.age = 35;---Exception in thread \"main\" java.lang.NullPointerException: Cannot assign field \"age\" because \"author\" is nullPattern Matching For InstanceOf (Preview) instanceofë¡œ íƒ€ì… ê²€ì‚¬ í›„ í˜•ë³€í™˜ì„ í•  í•„ìš”ê°€ ì—†ì–´ì¡Œë‹¤.if (obj instanceof String s) { System.out.println(s.contains(\"hello\"));}Packaging Tool (Incubator) í•„ìš”í•œ ëª¨ë“  ì¢…ì†ì„±ì„ í¬í•¨í•˜ì—¬ Java ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í”Œë«í¼ë³„ íŒ¨í‚¤ì§€ë¡œ íŒ¨í‚¤ì§•í•  ìˆ˜ ìˆëŠ” ì¸íë² ì´íŒ… íŒ¨í‚¤ì§€ ë„êµ¬ê°€ ë„ì…ëë‹¤. Linux: deb and rpm macOS: pkg and dmg Windows: msi and exeGarbage Collectors Concurrent Mark Sweep(CMS) Garbage Collectorê°€ ì œê±°ë˜ê³  ì‹¤í—˜ìš© Z Garbage Collectorê°€ ì¶”ê°€ë˜ì—ˆë‹¤.Java 15Text-Blocks / Multiline Strings Java 13ì˜ ì‹¤í—˜ ê¸°ëŠ¥ìœ¼ë¡œ ë„ì…ëœ Multiline Stringsì€ ì´ì œ production-ready ë‹¨ê³„ê°€ ë˜ì—ˆë‹¤.String text = \"\"\" Lorem ipsum dolor sit amet, consectetur adipiscing \\ elit, sed do eiusmod tempor incididunt ut labore \\ et dolore magna aliqua.\\ \"\"\";Sealed Classes (Preview) ì´ê²ƒì€ í´ë˜ìŠ¤ê°€ publicì¸ ë™ì•ˆ Shapeì„ ì„œë¸Œí´ë˜ìŠ¤ë¡œ í—ˆìš©í•˜ëŠ” ìœ ì¼í•œ í´ë˜ìŠ¤ëŠ” Circle, Rectangle ë° Squareì„ì„ ì˜ë¯¸í•œë‹¤.public abstract sealed class Shape permits Circle, Rectangle, Square {...}ZGC: Production Ready Z Garbage CollectorëŠ” ë” ì´ìƒ ì‹¤í—˜ìš©ì´ ì•„ë‹Œ production-ready ë‹¨ê³„ê°€ ë˜ì—ˆë‹¤.Java 16Unix-Domain Socket Channels ì´ì œ Unix ë„ë©”ì¸ ì†Œì¼“ì— ì—°ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤(macOS ë° Windows(10+)ì—ì„œë„ ì§€ì›ë¨). socket.connect(UnixDomainSocketAddress.of( \"/var/run/postgresql/.s.PGSQL.5432\"));Foreign Linker API (Preview) JNI(Java Native Interface)ì— ëŒ€í•œ ê³„íšëœ êµì²´ë¡œ, ê¸°ë³¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ë°”ì¸ë”©í•  ìˆ˜ ìˆë‹¤.Records &amp; Pattern Matching Records í´ë˜ìŠ¤ ë° Pattern Matching ëª¨ë‘ production-ready ë‹¨ê³„ê°€ ë˜ì—ˆë‹¤.Java 17Sealed Class (Standard)public abstract sealed class Shape permits Circle, Rectangle {...}public class Circle extends Shape {...} // OKpublic class Rectangle extends Shape {...} // OKpublic class Triangle extends Shape {...} // Compile error// No need for default case if all permitted types are covereddouble area = switch (shape) { case Circle c -&gt; Math.pow(c.radius(), 2) * Math.PI case Rectangle r -&gt; r.a() * r.b()};Pattern Matching For switch (Preview)String formatted = switch (o) { case Integer i &amp;&amp; i &gt; 10 -&gt; String.format(\"a large Integer %d\", i); case Integer i -&gt; String.format(\"a small Integer %d\", i); case Long l -&gt; String.format(\"a Long %d\", l); default -&gt; o.toString();};ì°¸ê³  ìë£Œ https://en.wikipedia.org/wiki/Java_version_history https://www.marcobehler.com/guides/a-guide-to-java-versions-and-features https://advancedweb.hu/a-categorized-list-of-all-java-and-jvm-features-since-jdk-8-to-17/ https://www.baeldung.com/java-11-new-features https://blog.ippon.tech/comparing-java-lts-releases/ https://www.oracle.com/java/technologies/java-se-support-roadmap.html https://dzone.com/articles/new-java-7-language-features https://www.baeldung.com/java-8-new-features" }, { "title": "Java - ì™œ equals()ì™€ hashCode()ëŠ” í•¨ê»˜ ì˜¤ë²„ë¼ì´ë”© í•´ì•¼í• ê¹Œ ?", "url": "/posts/equals-and-hashcode/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-09-24 22:25:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ì‹¤ë¬´ì—ì„œëŠ” equals(), hashCode() ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œ í•  ì¼ì´ ë³„ë¡œ ì—†ì—ˆë˜ ê²ƒ ê°™ë‹¤. í•˜ì§€ë§Œ ëª‡ ë‹¬ ì „ ê°„ë‹¨í•œ ì›¹ ì„œë²„ë¥¼ ë§Œë“¤ì–´ë³´ëŠ” í† ì´ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë˜ ì¤‘, í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë°›ì€ ìš”ì²­ì„ ìœ í‹¸ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ HttpRequest ê°ì²´ë¥¼ ë§Œë“œëŠ” ë¶€ë¶„ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í–ˆëŠ”ë° ì›í•˜ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•Šì•˜ë‹¤.ê°...", "content": "ë“¤ì–´ê°€ê¸° ì „ì‹¤ë¬´ì—ì„œëŠ” equals(), hashCode() ë©”ì„œë“œë¥¼ ì˜¤ë²„ë¼ì´ë“œ í•  ì¼ì´ ë³„ë¡œ ì—†ì—ˆë˜ ê²ƒ ê°™ë‹¤. í•˜ì§€ë§Œ ëª‡ ë‹¬ ì „ ê°„ë‹¨í•œ ì›¹ ì„œë²„ë¥¼ ë§Œë“¤ì–´ë³´ëŠ” í† ì´ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ë˜ ì¤‘, í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë°›ì€ ìš”ì²­ì„ ìœ í‹¸ í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì„œ HttpRequest ê°ì²´ë¥¼ ë§Œë“œëŠ” ë¶€ë¶„ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í–ˆëŠ”ë° ì›í•˜ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•Šì•˜ë‹¤.ê°ì²´ê°„ì˜ ë¹„êµë¥¼ ìˆ˜í–‰í–ˆëŠ”ë° equals()ê°€ ì˜¤ë²„ë¼ì´ë“œ ë˜ì§€ ì•Šì•„ ë°œìƒí–ˆë˜ ë¬¸ì œì˜€ë‹¤. ê·¸ëŸ°ë° equals()ë¥¼ ì˜¤ë²„ë¼ì´ë“œí•˜ë©´ hashCode()ë„ ë°˜ë“œì‹œ í•¨ê»˜ ì˜¤ë²„ë¼ì´ë“œ í•´ì•¼í•œë‹¤ê³  í•œë‹¤. ì™œ ê·¸ë˜ì•¼í•˜ëŠ” ê²ƒì¸ì§€ ì‚´í´ë³´ì.â€» ì‘ì„±í–ˆë˜ í…ŒìŠ¤íŠ¸ ì½”ë“œ@Testpublic void getHttpRequest() throws Exception { Map&lt;String, HttpRequest&gt; requests = new HashMap&lt;&gt;(); String request1 = \"GET /index.html HTTP/1.1\"; String request2 = \"POST /user/create HTTP/1.1\"; requests.put(request1, new HttpRequest(GET, \"/index.html\")); requests.put(request2, new HttpRequest(POST, \"/user/create\")); for (String req : requests.keySet()) { HttpRequest answer = requests.get(req); HttpRequest getObj = HttpRequestUtils.getHttpRequest(new ByteArrayInputStream(req.getBytes())); assertThat(getObj, is(answer)); // equals ì˜¤ë²„ë¼ì´ë“œ ì „ ì›í•˜ëŠ” ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•Šì•˜ìŒ }}equals() Object í´ë˜ìŠ¤ì—ì„œì˜ equals() ë©”ì„œë“œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ â€˜==â€™ ì—°ì‚°ìë¥¼ í†µí•´ ë©”ëª¨ë¦¬ ì£¼ì†Œ ë¹„êµ(ë™ì¼ì„± ë¹„êµ)ë¥¼ í•œë‹¤.public boolean equals(Object obj) { return (this == obj);} equals ë©”ì†Œë“œëŠ” nullì´ ì•„ë‹Œ ê°ì²´ì— ëŒ€í•´ ì•„ë˜ì˜ ë“±ê°€ ê´€ê³„ê°€ ì„±ë¦½ë˜ì–´ì•¼ í•œë‹¤. reflexive : x.equals(x)ëŠ” í•­ìƒ ì„±ë¦½í•œë‹¤. symmetric : x.equals(y)ì™€ y.equals(x)ëŠ” ë™ì¼í•œ ê²°ê³¼ë¥¼ ë°˜í™˜í•œë‹¤. transitive : x.equals(y)ê°€ ì„±ë¦½í•˜ë©´ y.equals(z)ë„ ì„±ë¦½í•œë‹¤. consistent : equals()ì˜ ê°’ì€ equals()ì— í¬í•¨ëœ ì†ì„±ì´ ë³€ê²½ë˜ëŠ” ê²½ìš°ì—ë§Œ ë³€ê²½ë˜ì–´ì•¼ í•œë‹¤. ìœ„ ê·œì¹™ì„ ìœ„ë°˜í•˜ëŠ” ì˜ˆì‹œ(x.equals(y)!=y.equals(x) ì¸ ê²½ìš°)class Money { int amount; String currencyCode; @Override public boolean equals(Object o) { if (o == this) return true; if (!(o instanceof Money)) return false; Money other = (Money)o; boolean currencyCodeEquals = (this.currencyCode == null &amp;&amp; other.currencyCode == null) || (this.currencyCode != null &amp;&amp; this.currencyCode.equals(other.currencyCode)); return this.amount == other.amount &amp;&amp; currencyCodeEquals; }}class WrongVoucher extends Money { private String store; @Override public boolean equals(Object o) { if (o == this) return true; if (!(o instanceof WrongVoucher)) return false; WrongVoucher other = (WrongVoucher)o; boolean currencyCodeEquals = (this.currencyCode == null &amp;&amp; other.currencyCode == null) || (this.currencyCode != null &amp;&amp; this.currencyCode.equals(other.currencyCode)); boolean storeEquals = (this.store == null &amp;&amp; other.store == null) || (this.store != null &amp;&amp; this.store.equals(other.store)); return this.amount == other.amount &amp;&amp; currencyCodeEquals &amp;&amp; storeEquals; }}Money cash = new Money(42, \"USD\");WrongVoucher voucher = new WrongVoucher(42, \"USD\", \"Amazon\");voucher.equals(cash) =&gt; false // As expected.cash.equals(voucher) =&gt; true // That's wrong.ë™ë“±ì„±(equality)ê³¼ ë™ì¼ì„±(identity) ì‹¤ìƒí™œì˜ ì˜ˆë¥¼ ìƒê°í•´ë³¸ë‹¤ë©´, ê°™ì€ ë‚  ì…ëŒ€í•œ ë‘ êµ°ì¸ì˜ ê²½ìš° â€˜ë™ë“±í•œâ€™ í›ˆë ¨ë³‘ì˜ ì…ì¥ì´ë¼ê³  ìƒê°í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ, ë‘ í›ˆë ¨ë³‘ì€ ê°ê° ë‹¤ë¥¸ ì‚¬ëŒì´ê¸°ì— â€˜ë™ì¼â€™í•˜ì§„ ì•Šë‹¤. ë™ë“±ì„±(equality) ë‘ ê°ì²´ê°€ ë™ì¼í•œ ìƒíƒœ(ì†ì„±)ë¥¼ í¬í•¨í•˜ëŠ”ì§€ ì—¬ë¶€ ë™ì¼ì„±(identity) ë‘ ê°ì²´ê°€ ë™ì¼í•œ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ê³µìœ í•˜ëŠ”ì§€ ì—¬ë¶€ ë‘ ê°ì²´ê°€ ë™ì¼í•˜ë©´ ë™ë“±í•˜ì§€ë§Œ, ë™ë“±í•˜ë‹¤ê³  í•´ì„œ ë™ì¼í•˜ì§€ëŠ” ì•Šë‹¤.hashCode() ê°ì²´ì— ëŒ€í•œ í•´ì‹œ ì½”ë“œ ê°’ì„ ë°˜í™˜í•œë‹¤. ì´ ê°’ì€ í•´ì‹œ í…Œì´ë¸”ì„ ì‚¬ìš©í•  ë•Œ ì£¼ì–´ì§„ í‚¤ì— ëŒ€í•œ í•´ì‹œ ê°’ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤.ì´ë¥¼ í™œìš©í•´ ë°ì´í„°ì— íš¨ìœ¨ì ìœ¼ë¡œ ì ‘ê·¼í•˜ê¸° ìœ„í•´, í•´ë‹¹ ê°’ì„ ì‚¬ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤. hashCode() ë©”ì„œë“œëŠ” ê°€ìƒ ë¨¸ì‹ ì— ì˜í•´ native operationìœ¼ë¡œ êµ¬í˜„ëœë‹¤. hashCode() ê°’ì€ (32ë¹„íŠ¸ ì•„í‚¤í…ì²˜ì—ì„œ) ë©”ëª¨ë¦¬ ì°¸ì¡° ë˜ëŠ” (64ë¹„íŠ¸ ì•„í‚¤í…ì²˜ì—ì„œ) ë©”ëª¨ë¦¬ ì°¸ì¡°ì— ëŒ€í•œ modulo 32 í‘œí˜„ì„ ë°˜í™˜í•˜ëŠ” ê²ƒìœ¼ë¡œ êµ¬í˜„ë˜ëŠ” ê²½ìš°ê°€ ë§ë‹¤.public native int hashCode(); hashCode()ê°€ ì¤€ìˆ˜í•´ì•¼ í•  ì‚¬í•­ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. internal consistency : hashCode()ì˜ ê°’ì€ equals()ì—ì„œ ë¹„êµí•˜ëŠ” ì†ì„±ì´ ë³€ê²½ë˜ëŠ” ê²½ìš°ì—ë§Œ ë³€ê²½ë  ìˆ˜ ìˆë‹¤. equals consistency : x.equals(y)ì´ë©´ x,yì˜ hashCode()ëŠ” ë™ì¼í•œ ê°’ì„ ë°˜í™˜í•´ì•¼ í•œë‹¤. collisions : x.equals(y)ê°€ ì„±ë¦½í•˜ì§€ ì•Šë”ë¼ë„ x,yì˜ hashCode()ëŠ” ë™ì¼í•œ ê°’ì„ ë°˜í™˜í•  ìˆ˜ë„ ìˆë‹¤. equals()ì™€ hashCode()ë¥¼ í•¨ê»˜ ì˜¤ë²„ë¼ì´ë“œ í•´ì•¼í•˜ëŠ” ì´ìœ  hashCode()ê°€ ì¤€ìˆ˜í•´ì•¼ í•  ì‚¬í•­ì˜ ë‘ ë²ˆì§¸ í•­ëª©ì„ ì£¼ëª©í•´ë³´ì. ë§Œì•½, ì–´ë–¤ í´ë˜ìŠ¤ì—ì„œ equals() ë©”ì„œë“œë§Œ ì˜¤ë²„ë¼ì´ë“œ ë˜ì—ˆë‹¤ë©´ x.equals(y)ê°€ ì„±ë¦½í•˜ë”ë¼ë„ x,yì˜ hashCode() ê°’ì€ ë‹¤ë¥¼ ê²ƒì´ë‹¤.ì´ëŸ° ìƒí™©ìœ¼ë¡œ ì¸í•´ ë°œìƒë˜ëŠ” ë¬¸ì œëŠ” ? â†’ í•´ì‹œë§µì„ ì‚¬ìš©í•  ë•Œ ì˜ë„ì¹˜ ì•Šì€ ê²°ê³¼ë¥¼ ì–»ê²Œëœë‹¤.class Team { String city; String department; public Team(String city, String department) { this.city = city; this.department = department; } @Override public final boolean equals(Object o) { if (o == this) return true; if (!(o instanceof Team)) return false; Team other = (Team) o; boolean isSameCity = (this.city == null &amp;&amp; other.city == null) || (this.city != null &amp;&amp; this.city.equals(other.city)); boolean isSameDept = (this.department == null &amp;&amp; other.department == null) || (this.department != null &amp;&amp; this.department.equals(other.department)); return isSameCity &amp;&amp; isSameDept; }}Map&lt;Team,String&gt; leaders = new HashMap&lt;&gt;();leaders.put(new Team(\"New York\", \"development\"), \"Anne\");leaders.put(new Team(\"Boston\", \"development\"), \"Brian\");leaders.put(new Team(\"Boston\", \"marketing\"), \"Charlie\");Team myTeam = new Team(\"New York\", \"development\");String myTeamLeader = leaders.get(myTeam); // \"Anne\"ë¥¼ ê¸°ëŒ€í•˜ì§€ë§Œ ê²°ê³¼ëŠ” nullì´ ë‚˜ì˜¨ë‹¤.equals(), hashCode() ì‘ì„±í•˜ê¸° ì¼ë°˜ì ìœ¼ë¡œ ì§ì ‘ ì¼ì¼ì´ ì‘ì„±í•˜ì§„ ì•Šê³ , IDEì˜ ìë™ì™„ì„±ì´ë‚˜ Lombok ë˜ëŠ” Java7 ë¶€í„° ë„ì…ëœ java.util íŒ¨í‚¤ì§€ì˜ Objects í´ë˜ìŠ¤ì˜ ë©”ì„œë“œë¥¼ í™œìš©í•œë‹¤.IntelliJ Defaultclass Team { String city; String department; public Team(String city, String department) { this.city = city; this.department = department; } @Override public boolean equals(Object o) { if (this == o) return true; if (o == null || getClass() != o.getClass()) return false; Team team = (Team) o; if (city != null ? !city.equals(team.city) : team.city != null) return false; return department != null ? department.equals(team.department) : team.department == null; } @Override public int hashCode() { int result = city != null ? city.hashCode() : 0; result = 31 * result + (department != null ? department.hashCode() : 0); return result; }}Objects ìœ í‹¸ í™œìš©import java.util.Objects;class Team { String city; String department; public Team(String city, String department) { this.city = city; this.department = department; } @Override public boolean equals(Object o) { if (this == o) return true; if (o == null || getClass() != o.getClass()) return false; Team team = (Team) o; return Objects.equals(city, team.city) &amp;&amp; Objects.equals(department, team.department); } @Override public int hashCode() { return Objects.hash(city, department); }}Lombok í™œìš©import lombok.EqualsAndHashCode;@EqualsAndHashCodeclass Team { String city; String department; public Team(String city, String department) { this.city = city; this.department = department; }}ì°¸ê³  ìë£Œ https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html#hashCode() https://stackoverflow.com/questions/1692863/what-is-the-difference-between-identity-and-equality-in-oop https://www.baeldung.com/java-equals-hashcode-contracts https://www.javacodegeeks.com/2016/03/equality-vs-identity.html https://www.baeldung.com/java-hashcode" }, { "title": "OS - OS ìºì‹œ", "url": "/posts/os-caching/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "OS", "date": "2021-09-16 22:25:00 +0900", "snippet": "OS ìºì‹œ OSì—ëŠ” ë””ìŠ¤í¬ ë‚´ì˜ ë°ì´í„°ì— ë¹ ë¥´ê²Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” êµ¬ì¡°ê°€ ê°–ì¶°ì ¸ ìˆë‹¤. OSëŠ” ë©”ëª¨ë¦¬ë¥¼ ì´ìš©í•´ì„œ ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤ë¥¼ ì¤„ì¸ë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì´ë¥¼ í™œìš©í•œë‹¤ë©´ OSì— ìƒë‹¹ë¶€ë¶„ì„ ë§¡ê¸¸ ìˆ˜ ìˆë‹¤. ì´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê²ƒì´ OSìºì‹œì´ë‹¤. ë¦¬ëˆ…ìŠ¤ì˜ ê²½ìš°ì—ëŠ” í˜ì´ì§€ ìºì‹œ(page cache), ë²„í¼ ìºì‹œ(...", "content": "OS ìºì‹œ OSì—ëŠ” ë””ìŠ¤í¬ ë‚´ì˜ ë°ì´í„°ì— ë¹ ë¥´ê²Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” êµ¬ì¡°ê°€ ê°–ì¶°ì ¸ ìˆë‹¤. OSëŠ” ë©”ëª¨ë¦¬ë¥¼ ì´ìš©í•´ì„œ ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤ë¥¼ ì¤„ì¸ë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì´ë¥¼ í™œìš©í•œë‹¤ë©´ OSì— ìƒë‹¹ë¶€ë¶„ì„ ë§¡ê¸¸ ìˆ˜ ìˆë‹¤. ì´ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•˜ëŠ” ê²ƒì´ OSìºì‹œì´ë‹¤. ë¦¬ëˆ…ìŠ¤ì˜ ê²½ìš°ì—ëŠ” í˜ì´ì§€ ìºì‹œ(page cache), ë²„í¼ ìºì‹œ(buffer cache)ë¼ê³  í•˜ëŠ” ìºì‹œ êµ¬ì¡°ë¥¼ ê°–ì¶”ê³  ìˆë‹¤. ê°€ìƒ ë©”ëª¨ë¦¬ í”„ë¡œê·¸ë¨ì´ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•  ë•Œ ë¬¼ë¦¬ì ì¸ ë©”ëª¨ë¦¬ë¥¼ ì§ì ‘ ë‹¤ë£¨ì§€ ì•Šê³ , ì¶”ìƒí™”í•œ ì†Œí”„ì›¨ì–´ì ì¸ ë©”ëª¨ë¦¬ë¥¼ ë‹¤ë£¨ëŠ” êµ¬ì¡°ì´ë‹¤. í•˜ë“œì›¨ì–´ì—ì„œ ì œê³µí•˜ëŠ” í˜ì´ì§•(paging)ì´ë¼ê³  í•˜ëŠ” ê°€ìƒ ë©”ëª¨ë¦¬ êµ¬ì¡°ë¥¼ ì‚¬ìš©í•´ ì‹¤í˜„í•œë‹¤. ì¦‰, ê°€ìƒ ë©”ëª¨ë¦¬ë€ OSê°€ ì»¤ë„ ë‚´ì—ì„œ ë¬¼ë¦¬ ë©”ëª¨ë¦¬ë¥¼ ì¶”ìƒí™” í•œ ê²ƒì´ë‹¤. í”„ë¡œì„¸ìŠ¤ì—ì„œ ë©”ëª¨ë¦¬ë¥¼ ë‹¤ë£¨ê¸° ì‰½ê²Œ í•˜ëŠ” ì´ì ì„ ì œê³µí•œë‹¤. ê°€ìƒ ë©”ëª¨ë¦¬ì˜ ê´€ë¦¬ëŠ” OSê°€ ë‹´ë‹¹í•œë‹¤.â€» ì°¸ê³ . ìŠ¤ì™‘(Swap) ìŠ¤ì™‘ì€ ê°€ìƒ ë©”ëª¨ë¦¬ë¥¼ ì‘ìš©í•œ ê¸°ìˆ  ì¤‘ í•˜ë‚˜ì´ë‹¤. ë¬¼ë¦¬ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•  ë•Œ 2ì°¨ ê¸°ì–µì°½ì¹˜(ì£¼ë¡œ ë””ìŠ¤í¬)ë¥¼ ë©”ëª¨ë¦¬ë¡œ ê°„ì£¼í•´ì„œ ì™¸í˜•ìƒì˜ ë©”ëª¨ë¦¬ ë¶€ì¡±ì„ í•´ì†Œí•œë‹¤. ë¬¼ë¦¬ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•œ ê²½ìš° ì¥ì‹œê°„ ì‚¬ìš©ë˜ì§€ ì•Šì€ ì˜ì—­ì˜ ê°€ìƒ ë©”ëª¨ë¦¬ì™€ ë¬¼ë¦¬ ë©”ëª¨ë¦¬ ì˜ì—­ ë§¤í•‘ì„ í•´ì œí•œë‹¤. í•´ì œëœ ë°ì´í„°ëŠ” ë””ìŠ¤í¬ ë“±ì— ì €ì¥í•´ë‘ê³  ë‹¤ì‹œ í•„ìš”í•´ì§€ë©´ ì›ë˜ë¡œ ë˜ëŒë¦°ë‹¤. í”„ë¡œì„¸ìŠ¤ì—ì„œ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•˜ë ¤ë©´ ? í”„ë¡œì„¸ìŠ¤ì—ì„œ OSë¡œ ë©”ëª¨ë¦¬ë¥¼ ìš”ì²­í•œë‹¤. OSê°€ ë©”ëª¨ë¦¬ì—ì„œ ë¹„ì–´ìˆëŠ” (ë¬¼ë¦¬)ë©”ëª¨ë¦¬ ì£¼ì†Œ ì°¾ëŠ”ë‹¤. OSëŠ” í”„ë¡œì„¸ìŠ¤ë¡œ (ê°€ìƒ)ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ë°˜í™˜í•œë‹¤. OSëŠ” ë©”ëª¨ë¦¬ 4KB ì •ë„ë¥¼ ë¸”ë¡ìœ¼ë¡œ í™•ë³´í•´ì„œ ê´€ë¦¬í•œë‹¤. í•˜ë‚˜ì˜ ë¸”ë¡ ë‹¨ìœ„ë¥¼ â€˜í˜ì´ì§€â€™ë¼ê³  í•œë‹¤. ì¦‰, í˜ì´ì§€ë€ OSê°€ ë¬¼ë¦¬ ë©”ëª¨ë¦¬ë¥¼ í™•ë³´/ê´€ë¦¬í•˜ëŠ” ë‹¨ìœ„ì´ë‹¤. OSëŠ” í”„ë¡œì„¸ìŠ¤ì—ì„œ ë©”ëª¨ë¦¬ ìš”ì²­ì„ ë°›ìœ¼ë©´ í•„ìš”í•œ ë§Œí¼ì˜ í˜ì´ì§€ë¥¼ í™•ë³´í•´ì„œ í”„ë¡œì„¸ìŠ¤ì— ë°˜í™˜í•œë‹¤. í”„ë¡œì„¸ìŠ¤ëŠ” ê°€ìƒ ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•œë‹¤. (ë¬¼ë¦¬ ë©”ëª¨ë¦¬ë¡œ ì§ì ‘ ì ‘ê·¼í•  ìˆ˜ ì—†ìŒ) ì»¤ë„ì´ í”„ë¡œì„¸ìŠ¤ì— ë°˜í™˜í•˜ëŠ” ê°€ìƒ ë©”ëª¨ë¦¬ ì˜ì—­ì€ ì•„ì§ ì‹¤ì œë¡œ ë¬¼ë¦¬ ë©”ëª¨ë¦¬ì™€ ì—°ê²°ë˜ì–´ ìˆì§€ ì•Šë‹¤. ì¦‰, ì‹¤ì²´ê°€ ì—†ëŠ” ë©”ëª¨ë¦¬ ì˜ì—­ì´ë‹¤. í”„ë¡œì„¸ìŠ¤ê°€ ê°€ìƒ ì˜ì—­ì— ëŒ€í•´ ì“°ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ì‹œì ì— ë¬¼ë¦¬ ë©”ëª¨ë¦¬ ì˜ì—­ê³¼ ì—°ê²°ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤. ê°€ìƒ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ  ê°€ìƒ ë©”ëª¨ë¦¬ë¥¼ í†µí•´ ì–»ì„ ìˆ˜ ìˆëŠ” ì´ì ì€ ë§¤ìš° í¬ë©°, ì´ëŠ” ë©€í‹° íƒœìŠ¤í‚¹ OSë¥¼ ì§€íƒ±í•˜ëŠ” ì¤‘ìš”í•œ ì—­í• ì„ ë‹´ë‹¹í•œë‹¤. ë¬¼ë¦¬ ë©”ëª¨ë¦¬ë¡œ íƒ‘ì¬ë˜ì–´ ìˆëŠ” ìš©ëŸ‰ ì´ìƒì˜ ë©”ëª¨ë¦¬ë¥¼ ë‹¤ë£° ìˆ˜ ìˆì„ ê²ƒì²˜ëŸ¼ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ë³´ì¼ ìˆ˜ ìˆë‹¤. ë¬¼ë¦¬ ë©”ëª¨ë¦¬ìƒì—ì„œëŠ” í©ì–´ì ¸ ìˆëŠ” ì˜ì—­ì„ ì—°ì†ëœ í•˜ë‚˜ì˜ ë©”ëª¨ë¦¬ ì˜ì—­ìœ¼ë¡œ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ë³´ì¼ ìˆ˜ ìˆë‹¤. Swapì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ ë‘ ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ì°¸ì¡°í•˜ëŠ” ê°€ìƒ ë©”ëª¨ë¦¬ ì˜ì—­ì„ ë™ì¼í•œ ë¬¼ë¦¬ ë©”ëª¨ë¦¬ ì˜ì—­ì— ëŒ€ì‘ ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ ë‘ ê°œì˜ í”„ë¡œì„¸ìŠ¤ê°€ ë©”ëª¨ë¦¬ ë‚´ìš©ì„ ê³µìœ í•  ìˆ˜ ìˆë‹¤. IPC(Inter Process Communication) ê³µìœ  ë©”ëª¨ë¦¬ ë“±ì€ ì´ ë°©ë²•ìœ¼ë¡œ êµ¬í˜„ëœë‹¤. ë¦¬ëˆ…ìŠ¤ì˜ í˜ì´ì§€ ìºì‹œ ì›ë¦¬ OSëŠ” í™•ë³´í•œ í˜ì´ì§€ë¥¼ ë©”ëª¨ë¦¬ìƒì— ê³„ì† í™•ë³´í•´ë‘ëŠ” ê¸°ëŠ¥ì„ ê°–ê³  ìˆë‹¤. ì´ë¥¼ â€˜í˜ì´ì§€ ìºì‹œâ€™ë¼ê³  í•œë‹¤. ì¦‰, ì»¤ë„ì´ í•œ ë²ˆ í• ë‹¹í•œ ë©”ëª¨ë¦¬ë¥¼ í•´ì œí•˜ì§€ ì•Šê³  ê³„ì† ë‚¨ê²¨ë‘ëŠ” ê²ƒì´ í˜ì´ì§€ ìºì‹œì˜ ê¸°ë³¸ì´ë‹¤.í˜ì´ì§€ ìºì‹± ê³¼ì • OSëŠ” í”„ë¡œì„¸ìŠ¤ì—ê²Œ ìš”ì²­ë°›ì€ ë°ì´í„°ë¥¼ ë””ìŠ¤í¬ë¡œë¶€í„° ë¸”ë¡ì˜ í¬ê¸°(ex : 4KB)ë§Œí¼ ì½ëŠ”ë‹¤. ì½ì€ ë°ì´í„°ë¥¼ (ë¬¼ë¦¬)ë©”ëª¨ë¦¬ìƒì— ìœ„ì¹˜ì‹œí‚¨ë‹¤. ë¬¼ë¦¬ ë©”ëª¨ë¦¬ ì£¼ì†Œë¥¼ ê°€ìƒ ë©”ëª¨ë¦¬ ì£¼ì†Œë¡œ ë³€í™˜í•˜ì—¬ í”„ë¡œì„¸ìŠ¤ì—ê²Œ ì•Œë ¤ì¤€ë‹¤. í”„ë¡œì„¸ìŠ¤ëŠ” (ê°€ìƒ)ë©”ëª¨ë¦¬ì— ì ‘ê·¼í•´ì„œ ë°ì´í„°ë¥¼ ì½ëŠ”ë‹¤. í”„ë¡œì„¸ìŠ¤ê°€ ë°ì´í„°ë¥¼ ì½ê³  ë‚˜ì„œë„ OSì—ì„œëŠ” í•´ë‹¹ ë°ì´í„°ë¥¼ ë©”ëª¨ë¦¬ì—ì„œ í•´ì œí•˜ì§€ ì•Šê³  ë‚¨ê²¨ë‘”ë‹¤. ì´ë¥¼ í†µí•´ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì—ì„œ ë™ì¼í•œ ë°ì´í„°ê°€ í•„ìš”í•œ ê²½ìš° OSê°€ ë‹¤ì‹œ ë””ìŠ¤í¬ì— ì ‘ê·¼í•˜ì§€ ì•Šì•„ë„ ëœë‹¤. â€» ìºì‹œ ì´ì™¸ì˜ ë©”ëª¨ë¦¬ê°€ í•„ìš”í•˜ê²Œ ë˜ë©´ ì˜¤ë˜ëœ ìºì‹œê°€ íŒŒê¸°ëœë‹¤. ì¦‰, ë©”ëª¨ë¦¬ê°€ 1GB ì¸ë° ê·¸ ì¤‘ 900MBê°€ ìºì‹œë¡œ ì‚¬ìš©ë˜ê³  ìˆë‹¤ê³  í•´ì„œ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•˜ë‹¤ê³  ìƒê°í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.4GBì˜ íŒŒì¼ì„ 1.5GBì˜ ì—¬ìœ ê°€ ìˆëŠ” ë©”ëª¨ë¦¬ì— ìºì‹±í•  ìˆ˜ ìˆì„ê¹Œ? ì •ë‹µì€ â€˜ê°€ëŠ¥í•˜ë‹¤â€™ì´ë‹¤. ì–´ë–»ê²Œ ê°€ëŠ¥í•œ ê²ƒì¸ì§€ ì›ë¦¬ë¥¼ ì‚´í´ë³´ì. ìºì‹±í•˜ê³ ì í•˜ëŠ” íŒŒì¼ì— ëŒ€í•´ ië…¸ë“œ ë²ˆí˜¸ì™€ ì˜¤í”„ì…‹ ë‘ ê°€ì§€ ê°’ì„ í‚¤ë¡œ ìºì‹±í•œë‹¤. ië…¸ë“œ ë²ˆí˜¸ - ë¦¬ëˆ…ìŠ¤ê°€ íŒŒì¼ì„ ì‹ë³„í•˜ëŠ” ë²ˆí˜¸ ì˜¤í”„ì…‹ - íŒŒì¼ì˜ ì–´ëŠ ìœ„ì¹˜ë¶€í„° ì‹œì‘í• ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’ ë”°ë¼ì„œ, íŒŒì¼ ì „ì²´ê°€ ì•„ë‹Œ ì¼ë¶€ë¥¼ ìºì‹±í•  ìˆ˜ ìˆë‹¤. â€˜íŒŒì¼ì˜ í¬ê¸° &gt; ë©”ëª¨ë¦¬ ê³µê°„â€™ ì´ê¸° ë•Œë¬¸ì—, íŒŒì¼ì˜ ì¼ë¶€ë¥¼ ìºì‹±í•˜ë”ë¼ë„ ê²°êµ­ ë©”ëª¨ë¦¬ ê³µê°„ì´ ê½‰ ì°¨ê²Œ ëœë‹¤. LRU(Least Recently Used) - ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ìºì‹±í•˜ê¸° ìœ„í•œ ë©”ëª¨ë¦¬ ê³µê°„ì„ í™•ë³´í•˜ê¸° ìœ„í•´ ê°€ì¥ ì˜¤ë˜ëœ ë°ì´í„°ë¥¼ íŒŒê¸° íŒŒì¼ì´ ì•„ë¬´ë¦¬ í¬ë”ë¼ë„ ìºì‹±ëœ í‚¤ë¡œë¶€í„° í•´ë‹¹ í˜ì´ì§€ë¥¼ ì°¾ì„ ë•Œì˜ ë°ì´í„° êµ¬ì¡°ëŠ” ìµœì í™” ë˜ì–´ìˆë‹¤. OS(ì»¤ë„) ë‚´ë¶€ì—ì„œ ì‚¬ìš©ë˜ê³  ìˆëŠ” ìë£Œ êµ¬ì¡°ëŠ” Radix Treeì´ë‹¤. ìºì‹±ëœ íŒŒì¼ì´ ì»¤ì§€ë”ë¼ë„ ìºì‹œ íƒìƒ‰ì†ë„ê°€ ë–¨ì–´ì§€ì§€ ì•Šë„ë¡ ê°œë°œëœ ìë£Œ êµ¬ì¡°ì´ë‹¤. ì°¸ê³  ìë£Œ ì´í†  ë‚˜ì˜¤ì•¼ ì™¸ 1ëª…, ã€ì›¹ ê°œë°œìë¥¼ ìœ„í•œ ëŒ€ê·œëª¨ ì„œë¹„ìŠ¤ë¥¼ ì§€íƒ±í•˜ëŠ” ê¸°ìˆ ã€, ì œì´í(2011), 8ì¥ ì´í†  ë‚˜ì˜¤ì•¼ ì™¸ 5ëª…, ã€24ì‹œê°„ 365ì¼ ì„œë²„/ì¸í”„ë¼ë¥¼ ì§€íƒ±í•˜ëŠ” ê¸°ìˆ ã€, ì œì´í(2009), 4ì¥" }, { "title": "ì¶”ìƒí™”ë¥¼ í†µí•´ ì—‘ì…€ ìƒì„± ë¡œì§ ë¦¬íŒ©í† ë§í•˜ê¸°", "url": "/posts/applying-absraction-for-excel-logic-refactoring/", "categories": "ê²½í—˜í•˜ê¸°, ì‘ì—… ë…¸íŠ¸", "tags": "", "date": "2021-09-13 22:25:00 +0900", "snippet": "ìƒí™©í˜„ì¬ ìš´ì˜í•˜ê³  ìˆëŠ” ì‹œìŠ¤í…œì—ëŠ”, ì‚¬ìš©ìê°€ ì¡°íšŒí•œ ê²°ê³¼ì— ëŒ€í•´ ì—‘ì…€ íŒŒì¼ë¡œ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ëª‡ëª‡ í™”ë©´ì—ì„œ ì œê³µí•œë‹¤.ì—‘ì…€ì„ ë§Œë“œëŠ” ë¶€ë¶„ì€ ìŠ¤í”„ë§ë¶€íŠ¸ ê¸°ë°˜ì˜ ë°±ì—”ë“œ ì„œë²„ì—ì„œ ë‹´ë‹¹í•œë‹¤. ë¬¸ì œëŠ” í•´ë‹¹ ë¡œì§ì—ì„œ ëª¨ë“  ì…€ì— ëŒ€í•œ ì˜ì—­ ì§€ì •ì„ í•˜ë“œì½”ë”©ìœ¼ë¡œ í•´ì£¼ê³  ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì•„ë˜ì™€ ê°™ì€ ê²½ìš° Title1ì˜ ë³‘í•© ì˜ì—­ì„ â€˜2ë²ˆ í–‰ + B,...", "content": "ìƒí™©í˜„ì¬ ìš´ì˜í•˜ê³  ìˆëŠ” ì‹œìŠ¤í…œì—ëŠ”, ì‚¬ìš©ìê°€ ì¡°íšŒí•œ ê²°ê³¼ì— ëŒ€í•´ ì—‘ì…€ íŒŒì¼ë¡œ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì„ ëª‡ëª‡ í™”ë©´ì—ì„œ ì œê³µí•œë‹¤.ì—‘ì…€ì„ ë§Œë“œëŠ” ë¶€ë¶„ì€ ìŠ¤í”„ë§ë¶€íŠ¸ ê¸°ë°˜ì˜ ë°±ì—”ë“œ ì„œë²„ì—ì„œ ë‹´ë‹¹í•œë‹¤. ë¬¸ì œëŠ” í•´ë‹¹ ë¡œì§ì—ì„œ ëª¨ë“  ì…€ì— ëŒ€í•œ ì˜ì—­ ì§€ì •ì„ í•˜ë“œì½”ë”©ìœ¼ë¡œ í•´ì£¼ê³  ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì•„ë˜ì™€ ê°™ì€ ê²½ìš° Title1ì˜ ë³‘í•© ì˜ì—­ì„ â€˜2ë²ˆ í–‰ + B,C ì—´â€™ ì´ëŸ°ì‹ìœ¼ë¡œ ëª…ì‹œí•´ì£¼ê³  ìˆë‹¤.ê²°ê³¼ì ìœ¼ë¡œ ì¤‘ê°„ì— ìƒˆë¡œìš´ Titleì„ ì¶”ê°€í•˜ê²Œë˜ë©´ (ì‚­ì œê°€ ë˜ëŠ” ê²½ìš°ë„ ë§ˆì°¬ê°€ì§€ë¡œ) ê·¸ ì´í›„ì˜ ì˜ì—­ì— ëŒ€í•œ í•˜ë“œì½”ë”©ì´ ë‹¤ ë³€ê²½ë˜ì–´ì•¼ í•œë‹¤ëŠ” ê²ƒì´ë‹¤. ì•„ë˜ì˜ ì˜ˆì‹œëŠ” ì˜ì—­ì´ ëª‡ ê°œ ì—†ì§€ë§Œ, ì‹¤ì œ ì½”ë“œì—ëŠ” ë§¤ìš° ë§ì€ ì˜ì—­ì´ ì¡´ì¬í•œë‹¤. ë”°ë¼ì„œ, ì‚¬ìš©ìë¡œë¶€í„° ì¤‘ê°„ì— ìƒˆë¡œìš´ ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ì–´ì•¼ í•œë‹¤ëŠ” ìš”êµ¬ì‚¬í•­ì´ ë“¤ì–´ì˜¨ë‹¤ë©´ë§¤ìš° ë¹„íš¨ìœ¨ì ì¸ ë…¸ê°€ë‹¤ ì‘ì—…ì„ í•´ì•¼í•œë‹¤.í•´ê²° ê³¼ì • ì ˆì°¨ì§€í–¥ìŠ¤ëŸ½ê²Œ ì‚°ì¬ë˜ì–´ ìˆëŠ” ì½”ë“œ ëŒ€ì‹ , ì—­í• ì— ë”°ë¼ ê°ê°ì˜ í´ë˜ìŠ¤ë¡œ ì¶”ìƒí™”í•´ë³´ì.1. ì…€ ì¶”ìƒí™” í•˜ë‚˜ì˜ ì…€ ë¿ë§Œ ì•„ë‹ˆë¼, ë³‘í•©ëœ ì…€, í•˜ìœ„ ì…€(ìœ„ ì˜ˆì‹œì— subtitle ë¶€ë¶„)ì„ í¬í•¨í•˜ëŠ” ì…€ ë“±ì„ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆëŠ” í´ë˜ìŠ¤ê°€ í•„ìš”í•˜ë‹¤ê³  ìƒê°í–ˆë‹¤.ë˜í•œ ê¸°ì¡´ì²˜ëŸ¼ í–‰ê³¼ ì—´ì˜ íŠ¹ì • ìœ„ì¹˜ê°€ ì•„ë‹Œ â€˜ëª‡ ê°œì˜ í–‰ì„ ë³‘í•©í•  ê²ƒì¸ì§€â€™, â€˜ëª‡ ê°œì˜ ì—´ì„ ë³‘í•©í•  ê²ƒì¸ì§€â€™ì— ëŒ€í•œ ì •ë³´ê°€ í•„ìš”í•˜ë‹¤ê³  ìƒê°í–ˆë‹¤.public class CustomCell { private final String cellValue; // ì…€ì— ì„¸íŒ…ë  ê°’ private final int rowSpan; // í–‰ ë³‘í•© ìˆ˜ private final int colSpan; // ì—´ ë³‘í•© ìˆ˜ private String dataKey; // Mapì— ë‹´ê¸´ ì¡°íšŒê²°ê³¼ì—ì„œ, í•´ë‹¹ ì»¬ëŸ¼ì— ì„¸íŒ…ë˜ì–´ì•¼í•  ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ keyê°’ private List&lt;CustomCell&gt; childs; // í•˜ìœ„ ì…€ ...}2. í…Œì´ë¸” ì¶”ìƒí™” í…Œì´ë¸”ì€ ë°ì´í„°ê°€ ë¬´ì—‡ì¸ì§€ ë‚˜íƒ€ë‚´ëŠ” í—¤ë”ì™€ ë°ì´í„° ì˜ì—­ì¸ bodyë¥¼ í¬í•¨í•´ì•¼í•œë‹¤.ë˜í•œ, ìœ„ ì˜ˆì‹œì—ëŠ” ì—†ì§€ë§Œ í…Œì´ë¸”ì˜ ì¢Œì¸¡ì— ë¶™ì–´ìˆëŠ” ìˆ˜ì§ í—¤ë”ê°€ í¬í•¨ë˜ëŠ” ê²½ìš°ë„ ìˆë‹¤.public class CustomTable { private int horizontalHeaderStartRow; // ìˆ˜í‰ í—¤ë” ì‹œì‘ í–‰ private String horizontalHeaderStartCol; // ìˆ˜í‰ í—¤ë” ì‹œì‘ ì—´ private int verticalHeaderStartRow; // ìˆ˜ì§ í—¤ë” ì‹œì‘ í–‰ private String verticalHeaderStartCol; // ìˆ˜ì§ í—¤ë” ì‹œì‘ ì—´ private List&lt;CustomCell&gt; horizontalHeaders; // ìˆ˜í‰ í—¤ë” private List&lt;CustomCell&gt; verticalHeaders; // ìˆ˜ì§ í—¤ë” private List&lt;Map&lt;String,Object&gt;&gt; body; // ì„¸íŒ…í•  ë°ì´í„°}3. ì—‘ì…€ ë§Œë“œëŠ” ë¶€ë¶„ ì¶”ìƒí™” ì„¸íŒ…ëœ CustomTableì„ í™œìš©í•˜ì—¬ ì—‘ì…€ íŒŒì¼ì„ ë§Œë“ ë‹¤. ì´ ê³¼ì •ì—ì„œ ì…€ì— ìŠ¤íƒ€ì¼ ë“±ì„ ì ìš©í•  ìˆ˜ ìˆë‹¤.public class CustomExcelCreator { private List&lt;CustomTable&gt; tables; ... public void createExcel() { ... } public void createCell(...) { ... } public void createTable(...) { ... }}ê²°ê³¼ ìƒˆë¡œìš´ í—¤ë”ê°€ ì¶”ê°€ë˜ì–´ì•¼ í•˜ë©´ í•´ë‹¹ ì˜ì—­ì„ CustomCellë¡œ ë§Œë“  ë’¤, í—¤ë” ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•œë‹¤. ê¸°ì¡´ì—ëŠ” ì¶”ê°€ëœ ì»¬ëŸ¼ ì´í›„ì˜ ëª¨ë“  ë¶€ë¶„ì— ëŒ€í•´ ì½”ë“œë¥¼ ì¬ì‘ì„±í•´ì•¼ í–ˆë‹¤ë©´, ì•ìœ¼ë¡œëŠ” í—¤ë” ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€í•˜ëŠ” ë¶€ë¶„ë§Œ ê³ ì¹˜ë©´ ëœë‹¤.ëŠë‚€ì  ì“¸ë°ì—†ëŠ” ê³³ì— ì‹œê°„ë‚­ë¹„ í•˜ì§€ ì•Šë„ë¡ í•­ìƒ í™•ì¥ì„±ì„ ìƒê°í•´ì„œ ì½”ë“œë¥¼ ì‘ì„±í•˜ì. í™•ì¥ì„±ì´ ì¢‹ë‹¤ëŠ” ê²ƒì€ ê¸°ëŠ¥, ìš”êµ¬ì‚¬í•­ ë“±ì´ ì¶”ê°€/ë³€ê²½ë˜ëŠ” ê²½ìš° ìµœì†Œí•œì˜ ì½”ë“œ ìˆ˜ì •ë§Œ í•˜ê²Œ ë§Œë“œëŠ” ê²ƒì´ë¼ê³  ìƒê°í•œë‹¤. ê°ì²´ì§€í–¥ì˜ ê¸°ë³¸ì´ ë˜ëŠ” ìº¡ìŠí™”, ì¶”ìƒí™”, ë‹¤í˜•ì„± ë“±ì˜ ê°œë…ì„ ì˜ ì´í•´í•˜ê³  ì ìš©í•˜ëŠ”ê²Œ ì¤‘ìš”í•œ ê²ƒ ê°™ë‹¤." }, { "title": "WEB - CDN(Content Delivery Network)", "url": "/posts/content-delivery-network/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "WEB", "date": "2021-09-11 00:25:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ì–¼ë§ˆì „ ë©´ì ‘ì—ì„œ â€˜í™”ë©´ì˜ ì´ˆê¸° ë¡œë”© ì†ë„ê°€ ëŠë¦¬ë‹¤ë©´ ì–´ë–»ê²Œ í•´ê²°í•  ìˆ˜ ìˆì„ê¹Œìš”?â€™ ë¼ëŠ” ì§ˆë¬¸ì— ì œëŒ€ë¡œ ëŒ€ë‹µí•˜ì§€ ëª»í–ˆë˜ ê¸°ì–µì´ ìˆë‹¤.ë’¤ëŠ¦ê²Œ ìƒê°ë‚¬ëŠ”ë° CDNì„ í™œìš©í•˜ë©´ ì–´ëŠì •ë„ ê°œì„ ë˜ì§€ ì•Šì„ê¹Œ í•˜ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤. í•˜ì§€ë§Œ, CDNì— ëŒ€í•´ ì–´ë ´í’‹ì´ ì•Œê³ ìˆì–´ ì–˜ê¸°ë¥¼ êº¼ë‚´ì§€ ëª»í–ˆë‹¤.ì´ë²ˆ ê¸°íšŒì— CDNì— ëŒ€í•´ ì˜ ì •ë¦¬í•´ë³´ì.CDNì´ë€ ? Conte...", "content": "ë“¤ì–´ê°€ê¸° ì „ì–¼ë§ˆì „ ë©´ì ‘ì—ì„œ â€˜í™”ë©´ì˜ ì´ˆê¸° ë¡œë”© ì†ë„ê°€ ëŠë¦¬ë‹¤ë©´ ì–´ë–»ê²Œ í•´ê²°í•  ìˆ˜ ìˆì„ê¹Œìš”?â€™ ë¼ëŠ” ì§ˆë¬¸ì— ì œëŒ€ë¡œ ëŒ€ë‹µí•˜ì§€ ëª»í–ˆë˜ ê¸°ì–µì´ ìˆë‹¤.ë’¤ëŠ¦ê²Œ ìƒê°ë‚¬ëŠ”ë° CDNì„ í™œìš©í•˜ë©´ ì–´ëŠì •ë„ ê°œì„ ë˜ì§€ ì•Šì„ê¹Œ í•˜ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤. í•˜ì§€ë§Œ, CDNì— ëŒ€í•´ ì–´ë ´í’‹ì´ ì•Œê³ ìˆì–´ ì–˜ê¸°ë¥¼ êº¼ë‚´ì§€ ëª»í–ˆë‹¤.ì´ë²ˆ ê¸°íšŒì— CDNì— ëŒ€í•´ ì˜ ì •ë¦¬í•´ë³´ì.CDNì´ë€ ? Content Delivery Network : ì»¨í…ì¸  ì „ì†¡ ë„¤íŠ¸ì›Œí¬ ì •ì  ì»¨í…ì¸ ë¥¼ ì „ì†¡í•˜ëŠ”ë° ì“°ì´ëŠ”, ì§€ë¦¬ì ìœ¼ë¡œ ë¶„ì‚°ëœ ì„œë²„ì˜ ë„¤íŠ¸ì›Œí¬ì´ë‹¤. html, ì´ë¯¸ì§€, js, ë¹„ë””ì˜¤ ë“±ê³¼ ê°™ì€ ì •ì  ì»¨í…ì¸ ë¥¼ ìºì‹±í•œë‹¤. ì–´ë–¤ ì‚¬ìš©ìê°€ ì›¹ì‚¬ì´íŠ¸ë¥¼ ë°©ë¬¸í•˜ë©´, ê·¸ ì‚¬ìš©ìì—ê²Œ ê°€ì¥ ê°€ê¹Œìš´ CDN ì„œë²„ê°€ ì •ì  ì»¨í…ì¸ ë¥¼ ì „ë‹¬í•œë‹¤. ë‹¤ìŒì€ CDNì„ í™œìš©í•˜ëŠ” ì˜ˆë¥¼ ë³´ì—¬ì¤€ë‹¤. ì‚¬ìš©ì Aê°€ ì´ë¯¸ì§€ URLì„ ì´ìš©í•´ image.pngì— ì ‘ê·¼í•œë‹¤. URLì˜ ë„ë©”ì¸ì€ CDN ì„œë¹„ìŠ¤ ì‚¬ì—…ìê°€ ì œê³µí•œ ê²ƒì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒ ë‘ URLì€ Cloudfrontì™€ Akamai CDNì´ ì œê³µí•˜ëŠ” URLì˜ ì˜ˆì´ë‹¤. https://mysite.cloudfront.net/logo.png https://mysite.akamai.com/image-manager/img/logo.png CDN ì„œë²„ì˜ ìºì‹œì— í•´ë‹¹ ì´ë¯¸ì§€ê°€ ì—†ëŠ” ê²½ìš°, ì„œë²„ëŠ” ì›ë³¸(origin) ì„œë²„ì— ìš”ì²­í•˜ì—¬ íŒŒì¼ì„ ê°€ì ¸ì˜¨ë‹¤. ì›ë³¸ ì„œë²„ëŠ” ì›¹ ì„œë²„ì¼ ìˆ˜ë„ ìˆê³  Amazon S3ì™€ ê°™ì€ ì˜¨ë¼ì¸ ì €ì¥ì†Œì¼ ìˆ˜ë„ ìˆë‹¤. ì›ë³¸ ì„œë²„ê°€ íŒŒì¼ì„ CDN ì„œë²„ì— ë°˜í™˜í•œë‹¤. ì‘ë‹µì˜ HTTP í—¤ë”ì—ëŠ” í•´ë‹¹ íŒŒì¼ì´ ì–¼ë§ˆë‚˜ ì˜¤ë˜ ìºì‹œë  ìˆ˜ ìˆëŠ”ì§€ë¥¼ ì„¤ëª…í•˜ëŠ” TTL(Time-To-Live)ê°’ì´ ë“¤ì–´ìˆë‹¤. CDN ì„œë²„ëŠ” íŒŒì¼ì„ ìºì‹œí•˜ê³  ì‚¬ìš©ì Aì—ê²Œ ë°˜í™˜í•œë‹¤. ì´ë¯¸ì§€ëŠ” TTLì— ëª…ì‹œëœ ì‹œê°„ì´ ëë‚  ë•Œê¹Œì§€ ìºì‹œëœë‹¤. ì‚¬ìš©ìê°€ Bê°€ ê°™ì€ ì´ë¯¸ì§€ì— ëŒ€í•œ ìš”ì²­ì„ CDN ì„œë²„ì— ì „ì†¡í•œë‹¤. ë§Œë£Œë˜ì§€ ì•Šì€ ì´ë¯¸ì§€ì— ëŒ€í•œ ìš”ì²­ì€ ìºì‹œë¥¼ í†µí•´ ì²˜ë¦¬í•œë‹¤. ì¶œì²˜ : https://mygumi.tistory.com/67 CDN ì‚¬ìš© ì‹œ ê³ ë ¤í•´ì•¼ í•  ì‚¬í•­1. ë¹„ìš©CDNì€ ë³´í†µ ì œ 3 ì‚¬ì—…ì(thrid-party providers)ì— ì˜í•´ ìš´ì˜ë˜ë©°, CDNìœ¼ë¡œ ë“¤ì–´ê°€ê³  ë‚˜ê°€ëŠ” ë°ì´í„° ì „ì†¡ ì–‘ì— ë”°ë¼ ìš”ê¸ˆì„ ë‚´ê²Œ ëœë‹¤.ë”°ë¼ì„œ, ìì£¼ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ” ì»¨í…ì¸ ë¥¼ ìºì‹±í•˜ëŠ” ê²ƒì€ ë“ì´ ë  ê²ƒì´ ì—†ìœ¼ë¯€ë¡œ CDNì—ì„œ ë¹¼ëŠ” ê²ƒì„ ê³ ë ¤í•œë‹¤.2. ì ì ˆí•œ ë§Œë£Œ ì‹œí•œ ì„¤ì •ì‹œì˜ì„±ì´ ì¤‘ìš”í•œ(time-sensitive) ì»¨í…ì¸ ì˜ ê²½ìš°, ë§Œë£Œ ì‹œì ì„ ì˜ ì •í•´ì•¼ í•œë‹¤.ë„ˆë¬´ ê¸¸ì§€ë„ ì•Šê³  ì§§ì§€ë„ ì•Šì•„ì•¼ í•˜ëŠ”ë°, ë„ˆë¬´ ê¸¸ë©´ ì»¨í…ì¸ ì˜ ì‹ ì„ ë„ëŠ” ë–¨ì–´ì§ˆ ê²ƒì´ê³ , ë„ˆë¬´ ì§§ìœ¼ë©´ ì›ë³¸ ì„œë²„ì— ë¹ˆë²ˆíˆ ì ‘ì†í•˜ê²Œ ë˜ì–´ ì¢‹ì§€ ì•Šë‹¤.3. CDN ì¥ì• ì— ëŒ€í•œ ëŒ€ì²˜ ë°©ì•ˆCDN ìì²´ê°€ ì£½ì—ˆì„ ê²½ìš° ì›¹ì‚¬ì´íŠ¸/ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì–´ë–»ê²Œ ë™ì‘í•´ì•¼ í•˜ëŠ”ì§€ ê³ ë ¤í•´ì•¼ í•œë‹¤.ì¼ì‹œì ìœ¼ë¡œ CDNì´ ì‘ë‹µí•˜ì§€ ì•Šì„ ê²½ìš°, í•´ë‹¹ ë¬¸ì œë¥¼ ê°ì§€í•˜ì—¬ ì›ë³¸ ì„œë²„ë¡œë¶€í„° ì§ì ‘ ì»¨í…ì¸ ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ í´ë¼ì´ì–¸íŠ¸ë¥¼ êµ¬ì„±í•˜ëŠ” ê²ƒì´ í•„ìš”í•  ìˆ˜ë„ ìˆë‹¤.4. ì»¨í…ì¸  ë¬´íš¨í™”(invalidation) ë°©ë²•ì•„ì§ ë§Œë£Œë˜ì§€ ì•Šì€ ì»¨í…ì¸ ë¼ í•˜ë”ë¼ë„ ì•„ë˜ ë°©ë²• ê°€ìš´ë° í•˜ë‚˜ë¥¼ ì“°ë©´ CDNì—ì„œ ì œê±°í•  ìˆ˜ ìˆë‹¤. CDN ì„œë¹„ìŠ¤ ì‚¬ì—…ìê°€ ì œê³µí•˜ëŠ” APIë¥¼ ì´ìš©í•˜ì—¬ ì»¨í…ì¸  ë¬´íš¨í™” ì»¨í…ì¸ ì˜ ë‹¤ë¥¸ ë²„ì „ì„ ì„œë¹„ìŠ¤í•˜ë„ë¡ ì˜¤ë¸Œì íŠ¸ ë²„ì €ë‹(object versioning)ì„ ì´ìš© ì»¨í…ì¸ ì˜ ìƒˆë¡œìš´ ë²„ì „ì„ ì§€ì •í•˜ê¸° ìœ„í•´ì„œëŠ” URL ë§ˆì§€ë§‰ì— ë²„ì „ ë²ˆí˜¸ë¥¼ ì¸ìë¡œ ì£¼ë©´ ëœë‹¤. ì˜ˆë¥¼ ë“¤ì–´, image.png?v=2ì™€ ê°™ì€ ì‹ì´ë‹¤. CDNì˜ í•„ìš”ê¸°ìˆ â–¶ 1. Load Balancing ì‚¬ìš©ìì—ê²Œ ì½˜í…ì¸  ì „ì†¡ ìš”ì²­(Delivery Request)ì„ ë°›ì•˜ì„ ë•Œ, ìµœì ì˜ ë„¤íŠ¸ì›Œí¬ í™˜ê²½ì„ ì°¾ì•„ ì—°ê²°í•˜ëŠ” ê¸°ìˆ , GSLB(Global Server Load Balancing)ì´ë¼ê³ ë„ í•œë‹¤. ë¬¼ë¦¬ì ìœ¼ë¡œ ê°€ì¥ ê°€ê¹ê±°ë‚˜ ì—¬ìœ  íŠ¸ë˜í”½ì´ ë‚¨ì•„ ìˆëŠ” ê³³ìœ¼ë¡œ ì ‘ì†ì„ ìœ ë„í•˜ëŠ” ê¸°ìˆ ì´ë‹¤.â€» GSLB(Global server Load Balancing)DNS(ë„ë©”ì¸ ì´ë¦„ì„ IPì£¼ì†Œë¡œ ë³€í™˜í•˜ëŠ” ì„œë¹„ìŠ¤) ì„œë¹„ìŠ¤ì˜ ë°œì „ëœ í˜•íƒœë¼ê³  í•  ìˆ˜ ìˆë‹¤.â€» DNSì™€ GSLB ì°¨ì´ì  health checkDNS : ì„œë²„ì˜ ìƒíƒœë¥¼ ì•Œ ìˆ˜ ì—†ì–´ì„œ ì„œë¹„ìŠ¤ë¥¼ ì‹¤íŒ¨í•˜ëŠ” ìœ ì €ë„ ìƒê¸¸ ìˆ˜ ìˆë‹¤.GSLB : ì„œë²„ì˜ ìƒíƒœë¥¼ ëª¨ë‹ˆí„°ë§(ì£¼ê¸°ì ìœ¼ë¡œ health checkë¥¼ ìˆ˜í–‰) í•˜ê³  ì‹¤íŒ¨í•œ ì„œë²„ì˜ IPëŠ” ì‘ë‹µì—ì„œ ì œì™¸ í•˜ë¯€ë¡œ, DNSë³´ë‹¤ í›¨ì”¬ ê°•ë ¥í•œ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ë¡œë“œë°¸ëŸ°ì‹±DNS : Round Robin ë°©ì‹ì„ ì‚¬ìš©, ì •êµí•œ ë¡œë“œ ë°¸ëŸ°ì‹±ì´ í˜ë“¤ë‹¤.GSLB : ì„œë²„ì˜ ë¡œë“œë¥¼ ëª¨ë‹ˆí„°ë§ í•˜ê¸° ë•Œë¬¸ì— ë¡œë“œê°€ ì ì€ ì„œë²„ì˜ IPë¥¼ ë°˜í™˜í•˜ëŠ” ì‹ìœ¼ë¡œ ì •êµí•œ ë¡œë“œë°¸ëŸ°ì‹±ì„ í•  ìˆ˜ ìˆë‹¤. ë ˆì´í„´ì‹œ ê¸°ë°˜ ì„œë¹„ìŠ¤DNS : Round Robin ë°©ì‹ì„ ì‚¬ìš©í•˜ì—¬ ìœ ì €ëŠ” ë„¤íŠ¸ì›Œí¬ìƒì—ì„œ ë©€ë¦¬ ë–¨ì–´ì§„ ìœ„ì¹˜ì˜ ì„œë²„ë¡œ ì—°ê²° í•  ìˆ˜ë„ ìˆë‹¤.GSLB : ê° ì§€ì—­ë³„ë¡œ ì„œë²„ì— ëŒ€í•œ ë ˆì´í„´ì‹œ(latency) ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆê¸° ë•Œë¬¸ì— ìœ ì €ê°€ ì ‘ê·¼ì„ í•˜ë©´, ìœ ì €ì˜ ì§€ì—­ìœ¼ë¡œ ë¶€í„° ê°€ê¹Œìš´(ë” ì‘ì€ ë ˆì´í„´ì‹œë¥¼ ê°€ì§€ëŠ”) ì„œë²„ë¡œ ì—°ê²°ì„ í•œë‹¤. ìœ„ì¹˜ê¸°ë°˜ ì„œë¹„ìŠ¤DNS : ìœ ì €ëŠ” Round Robiní•˜ê²Œ ì„œë²„ë¡œ ì—°ê²°ëœë‹¤.GSLB : ìœ ì €ì˜ ì§€ì—­ì •ë³´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ, í•´ë‹¹ ì§€ì—­ì„ ì„œë¹„ìŠ¤í•˜ëŠ” ì„œë²„ë¡œ ì—°ê²° í•  ìˆ˜ ìˆë‹¤. â–¶ 2. ì»¨í…ì¸ ë¥¼ ë°°í¬í•˜ëŠ” ê¸°ìˆ  ì»¨í…ì¸ ì˜ ì‚­ì œë‚˜ ìˆ˜ì •ì´ ì¼ì–´ë‚¬ì„ ë•Œ ì´ë¥¼ ê´€ë¦¬í•  ìˆ˜ ìˆëŠ” ê¸°ìˆ ì´ í•„ìš”í•˜ë‹¤.â–¶ 3. CDNì˜ íŠ¸ë˜í”½ì„ ê°ì§€í•˜ëŠ” ê¸°ìˆ  í†µê³„ìë£Œë¥¼ ê³ ê°ì—ê²Œ ì œê³µí•˜ê¸° ìœ„í•´ í•„ìš”í•˜ë‹¤. íŠ¸ë˜í”½ì„ ë¶„ì‚°í•˜ê¸° ìœ„í•´ì„œ í•„ìš”í•˜ë‹¤CDNì˜ ìºì‹± ë°©ì‹ Static Cachingâ€“ Origin Serverì— ìˆëŠ” Contentë¥¼ ìš´ì˜ìê°€ ë¯¸ë¦¬ Cache Serverì— ë³µì‚¬ ë¯¸ë¦¬ ë³µì‚¬í•´ ë‘ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìê°€ Cache Serverì— Contentë¥¼ ìš”ì²­ì‹œ ë¬´ì¡°ê±´ Cache Serverì— ìˆë‹¤.â€“ ëŒ€ë¶€ë¶„ì˜ êµ­ë‚´ CDNì—ì„œ ì´ ë°©ì‹ì„ ì‚¬ìš©( ex. NCSOFT ê²Œì„íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë“±) Dynamic Cachingâ€“ Origin Serverì— ìˆëŠ” Contentë¥¼ ìš´ì˜ìê°€ ë¯¸ë¦¬ Cache Serverì— ë³µì‚¬í•˜ì§€ ì•ŠìŒâ€“ ì‚¬ìš©ìê°€ Contentë¥¼ ìš”ì²­ì‹œ í•´ë‹¹ Contentê°€ ì—†ëŠ” ê²½ìš° Origin Serverë¡œ ë¶€í„° ë‹¤ìš´ë¡œë“œ ë°›ì•„ ì „ë‹¬í•œë‹¤. (Contentê°€ ìˆëŠ” ê²½ìš°ëŠ” ìºì‹±ëœ Content ì‚¬ìš©ìì—ê²Œ ì „ë‹¬.)â€“ ê°ê°ì˜ ContentëŠ” ì¼ì • ì‹œê°„ì´í›„ Cache Serverì—ì„œ ì‚­ì œë  ìˆ˜ë„ ìˆë‹¤. (ê³„ì† ê°€ì§€ê³  ìˆì„ ìˆ˜ë„ ìˆìŒ) CDN ì„œë¹„ìŠ¤ ì´ìš©ë°©ë²• CDNì´ìš©ì‹œ ì†ŒìŠ¤ì½”ë“œìƒì—ì„œ ì´ë¯¸ì§€ ë§í¬ë‚˜ ë¦¬ë‹¤ì´ë ‰íŠ¸ë“± CDNì„ ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ë„ë©”ì¸ì„ í˜¸ì¶œ í•˜ëŠ” ê²½ìš° ë„ë©”ì¸ì˜ ì£¼ì†Œë¥¼ CDN ì—…ì²´ì¥ë¹„ì˜ ì£¼ì†Œë¡œ ì´ë¯¸ì§€ë¥¼ í˜¸ì¶œí•˜ëŠ” ê²½ë¡œë¡œ ë³€ê²½ í•œë‹¤.ex) ê¸°ì¡´ì˜ =&gt; ì„œë¹„ìŠ¤ ì‹ ì²­ ëŒ€ìƒ ë„ë©”ì¸ì´ ì„œë²„(Origin Server)ë¥¼ ë°”ë¼ë³´ê²Œë” CDNì¥ë¹„ì£¼ì†Œë¡œ ì—°ê²° í•´ì£¼ëŠ” ì‘ì—…ì„ í•´ì•¼í•œë‹¤.(CDN ì„œë¹„ìŠ¤ ì‹ ì²­ì‹œ CDN ì„œë¹„ìŠ¤ë¥¼ ì´ìš©í•  ë„ë©”ì¸ì˜ ë„¤ì„ì„œë²„ë ˆì½”ë“œë¥¼ CDNì„œë¹„ìŠ¤ ì—…ì²´ì—ì„œ ì œê³µí•˜ëŠ” ë„ë©”ì¸ì£¼ì†Œ ë˜ëŠ” IPì£¼ì†Œë¡œ ì—°ê²°ì„ í•´ì•¼ í•œë‹¤.) ex) http://www.goddaehee.com ì´ CDN ì„œë¹„ìŠ¤ë¥¼ ì‹ ì²­í•˜ê³  ì‹¶ì€ ë„ë©”ì¸ì´ë¼ë©´ ë„¤ì„ì„œë²„ Aë ˆì½”ë“œë¥¼ CDNì—…ì²´ë„ë©”ì¸.co.kr ìœ¼ë¡œ ë³€ê²½ì‘ì—…ì„ í•œë‹¤.ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì— http://www.goddaehee.comë¥¼ ì…ë ¥í–ˆì„ë•Œ ë°œìƒë˜ëŠ” ìš”ì²­ì„ CDNì—…ì²´ ì„œë²„ë¡œ ê°€ê²Œ í•´ì£¼ëŠ” ì‘ì—…ì´ë‹¤.ê¸°ì¡´ http://www.goddaehee.com ì— ì—°ê²°ëœ Aë ˆì½”ë“œ IPê°’ê³¼ ë„ë©”ì¸ ì •ë³´ë¥¼ ë³´ë‚´ì£¼ë©´ CDNì—…ì²´ì¸¡ì—ì„œ ë³€ê²½ì— í•„ìš”í•œ CNAMEì„ ì¤€ë‹¤.ì´ì— ë”°ë¼ DNSìƒì—ì„œ CNAMEì„ ê°ê°ì˜ ë„ë©”ì¸ì— ì ìš©í•˜ì—¬ ìˆ˜ì •í•´ì¤˜ì•¼ í•œë‹¤. https://goddaehee.tistory.com/173 [ê°“ëŒ€í¬ì˜ ì‘ì€ê³µê°„]CDN vs Squid-cachehttp í”„ë¡œí† ì½œì— ëŒ€í•´ ë¬¸ì„œ ì €ì¥í•˜ëŠ”ë° ìœ ìš©í•œ squid-cache ë¼ëŠ” ê²ƒë„ ìˆëŠ”ë°, ìš©ë„ëŠ” ë¹„ìŠ·í•œê²ƒ ê°™ë‹¤.ë‘˜ì„ ë¹„êµí•´ë³´ìhttps://www.g2.com/compare/cloudflare-inc-cloudflare-cdn-vs-squid-cachehttps://blog.matthewskelton.net/2011/12/02/improving-page-speed-cdn-vs-squid-varnish-nginx/ì°¸ê³  ìë£Œ ì•Œë ‰ìŠ¤ ì‰¬, ã€ê°€ìƒ ë©´ì ‘ ì‚¬ë¡€ë¡œ ë°°ìš°ëŠ” ëŒ€ê·œëª¨ ì‹œìŠ¤í…œ ì„¤ê³„ ê¸°ì´ˆã€, ì¸ì‚¬ì´íŠ¸(2021), 1ì¥" }, { "title": "Java - ìë°”ì—ì„œ íŒŒì¼ ì½ì–´ì˜¤ê¸°", "url": "/posts/java-reading-file/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-09-08 00:29:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ì‚¬ì‹¤ ì‹¤ë¬´ì—ì„œ ìë°” ì½”ë“œë¡œ íŒŒì¼ì„ ì½ì–´ì™€ì„œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê±°ë‚˜ í•  ì¼ì´ ì—†ì–´ì„œ, íŒŒì¼ì„ ë‹¤ë£¨ëŠ” ë¶€ë¶„ì— ëŒ€í•œ ì½”ë“œë¥¼ ì‘ì„±í•  ì¼ì´ ìƒê¸°ë©´,ê·¸ ë•Œ ë§ˆë‹¤ êµ¬ê¸€ë§í•´ì„œ ì‚¬ìš©í–ˆë˜ ê²ƒ ê°™ë‹¤. ìµœê·¼ì— .json íŒŒì¼ì— ìˆëŠ” ë°ì´í„°ë¥¼ ì½ì–´ì™€ì„œ ì²˜ë¦¬í•´ì•¼í•  ì¼ì´ ìˆì—ˆëŠ”ë°,ë§¤ë²ˆ êµ¬ê¸€ë§ í•˜ëŠ” ê²ƒ ë³´ë‹¤ ë¨¸ë¦¿ì†ì— í•œ ë²ˆ í™•ì‹¤íˆ ì •ë¦¬í•´ì•¼ í•  ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¤ì–´ ì •ë¦¬í•´...", "content": "ë“¤ì–´ê°€ê¸° ì „ì‚¬ì‹¤ ì‹¤ë¬´ì—ì„œ ìë°” ì½”ë“œë¡œ íŒŒì¼ì„ ì½ì–´ì™€ì„œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê±°ë‚˜ í•  ì¼ì´ ì—†ì–´ì„œ, íŒŒì¼ì„ ë‹¤ë£¨ëŠ” ë¶€ë¶„ì— ëŒ€í•œ ì½”ë“œë¥¼ ì‘ì„±í•  ì¼ì´ ìƒê¸°ë©´,ê·¸ ë•Œ ë§ˆë‹¤ êµ¬ê¸€ë§í•´ì„œ ì‚¬ìš©í–ˆë˜ ê²ƒ ê°™ë‹¤. ìµœê·¼ì— .json íŒŒì¼ì— ìˆëŠ” ë°ì´í„°ë¥¼ ì½ì–´ì™€ì„œ ì²˜ë¦¬í•´ì•¼í•  ì¼ì´ ìˆì—ˆëŠ”ë°,ë§¤ë²ˆ êµ¬ê¸€ë§ í•˜ëŠ” ê²ƒ ë³´ë‹¤ ë¨¸ë¦¿ì†ì— í•œ ë²ˆ í™•ì‹¤íˆ ì •ë¦¬í•´ì•¼ í•  ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¤ì–´ ì •ë¦¬í•´ë³´ê¸°ë¡œ í–ˆë‹¤.â€» íŒŒì¼ ì´ì™¸ì—ë„ ë„¤íŠ¸ì›Œí¬ ë“± ìë°”ì—ì„œì˜ ì „ë°˜ì ì¸ I/O(Input/Output)ì— ëŒ€í•´ ì•Œê³ ì‹¶ìœ¼ë©´ ì´ ê¸€ ì„ ë¨¼ì € ì½ê³  ì˜¤ì‹œëŠ” ê²ƒì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.íŒŒì¼ê³¼ ê²½ë¡œ íŒŒì¼ì„ ë‹¤ë£¨ëŠ” ê²ƒê³¼ ê´€ë ¨í•˜ì—¬ ë—¼ ìˆ˜ ì—†ëŠ” ê²ƒì´ ë°”ë¡œ â€˜ê²½ë¡œâ€™ë¼ê³  ìƒê°í•œë‹¤. ë”°ë¼ì„œ, ìë°”ì—ì„œëŠ” ê²½ë¡œë¥¼ ì–´ë–»ê²Œ ë‹¤ë£¨ëŠ”ì§€ ë¨¼ì € ì‚´í´ë³´ì.getPath() ê°„ë‹¨íˆ ë§í•´ì„œ, getPath()ëŠ” íŒŒì¼ì˜ ì¶”ìƒ ê²½ë¡œ ì´ë¦„(abstract pathname)ì˜ ë¬¸ìì—´ í‘œí˜„ì„ ë°˜í™˜í•œë‹¤. ì´ê²ƒì€ ë³¸ì§ˆì ìœ¼ë¡œ íŒŒì¼ ìƒì„±ìì— ì „ë‹¬ë˜ëŠ” ê²½ë¡œ ì´ë¦„ì´ë‹¤. ë”°ë¼ì„œ ìƒëŒ€ ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ì—¬ File ê°ì²´ë¥¼ ìƒì„±í•œ ê²½ìš° getPath() ë©”ì„œë“œì—ì„œ ë°˜í™˜ëœ ê°’ë„ ìƒëŒ€ ê²½ë¡œê°€ ëœë‹¤. {user.home} / baeldung ë””ë ‰í† ë¦¬ì—ì„œ ë‹¤ìŒ ì½”ë“œë¥¼ í˜¸ì¶œí•œë‹¤ê³  ê°€ì •í•˜ë©´ ê²°ê³¼ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë  ê²ƒì´ë‹¤.File file = new File(\"foo/foo-one.txt\");String path = file.getPath();foo/foo-one.txt // on Unix systemsfoo\\foo-one.txt // on Windows systemsâ€» ì¶”ìƒ ê²½ë¡œ ì´ë¦„(abstract pathname) abstract pathnameì€ java.io.File ê°ì²´ì´ê³  ê²½ë¡œëª… ë¬¸ìì—´ì€ java.lang.String ê°ì²´ì´ë‹¤. ë‘˜ ë‹¤ ë””ìŠ¤í¬ì˜ ë™ì¼í•œ íŒŒì¼ì„ ì°¸ì¡°í•œë‹¤. Javadoc ì—ì„œëŠ” java.io.Fileì— ëŒ€í•´ ë‹¤ìŒê³¼ ê°™ì´ ì„¤ëª…í•œë‹¤. íŒŒì¼ ë° ë””ë ‰í† ë¦¬ ê²½ë¡œ ì´ë¦„ì˜ ì¶”ìƒ í‘œí˜„. UI ë° ìš´ì˜ ì²´ì œëŠ” ì‹œìŠ¤í…œ ì¢…ì† ê²½ë¡œ ì´ë¦„ ë¬¸ìì—´ì„ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ë° ë””ë ‰í† ë¦¬ì˜ ì´ë¦„ì„ ì§€ì •í•œë‹¤. ë”°ë¼ì„œ, File í´ë˜ìŠ¤ëŠ” ê³„ì¸µì  ê²½ë¡œ ì´ë¦„ì— ëŒ€í•œ ì¶”ìƒì ì´ê³  ì‹œìŠ¤í…œ ë…ë¦½ì ì¸ ë·°ë¥¼ ì œê³µí•œë‹¤. absolute path getAbsolutePath() ë©”ì„œë“œëŠ” í˜„ì¬ ì‚¬ìš©ì ë””ë ‰í„°ë¦¬ì˜ ê²½ë¡œë¥¼ í™•ì¸í•œ í›„ íŒŒì¼ì˜ ê²½ë¡œ ì´ë¦„ì„ ë°˜í™˜í•œë‹¤. ì´ë¥¼ â€˜ì ˆëŒ€ ê²½ë¡œëª…â€™ì´ë¼ê³  í•œë‹¤.File file = new File(\"foo/foo-one.txt\");String path = file.getAbsolutePath();/home/username/baeldung/foo/foo-one.txt // on Unix systemsC:\\Users\\username\\baeldung\\foo\\foo-one.txt // on Windows systems ìƒëŒ€ ê²½ë¡œì— ëŒ€í•œ í˜„ì¬ ë””ë ‰í„°ë¦¬ë§Œ í™•ì¸í•œë‹¤. ì•½ì‹ í‘œí˜„(ì˜ˆ: â€œ.â€ ë° â€œ..â€)ì€ ë” ì´ìƒ í•´ê²°ë˜ì§€ ì•ŠëŠ”ë‹¤.File file = new File(\"bar/baz/../bar-one.txt\");String path = file.getAbsolutePath();/home/username/baeldung/bar/baz/../bar-one.txt // on Unix systemsC:\\Users\\username\\baeldung\\bar\\baz\\..\\bar-one.txt // on Windows systemscanonical path Canonical : ì ˆëŒ€ì ì¸, ìœ ì¼í•œ getCanonicalPath() ë©”ì„œë“œëŠ” í•œ ë‹¨ê³„ ë” ë‚˜ì•„ê°€ ì ˆëŒ€ ê²½ë¡œ ì´ë¦„ë¿ë§Œ ì•„ë‹ˆë¼ â€œâ€, â€œâ€¦â€œì™€ ê°™ì€ ì•½ì–´ ë˜ëŠ” ì¤‘ë³µ ì´ë¦„ì„ í™•ì¸í•œë‹¤. ë˜í•œ Unix ì‹œìŠ¤í…œì—ì„œ ì‹¬ë³¼ë¦­ ë§í¬ë¥¼ í™•ì¸í•˜ê³ , Windows ì‹œìŠ¤í…œì—ì„œëŠ” ë“œë¼ì´ë¸Œ ë¬¸ìë¥¼ í‘œì¤€ ì¼€ì´ìŠ¤ë¡œ ë³€í™˜í•œë‹¤.File file = new File(\"bar/baz/../bar-one.txt\");String path = file.getCanonicalPath();/home/username/baeldung/bar/bar-one.txt // on Unix systemsC:\\Users\\username\\baeldung\\bar\\bar-one.txt // on Windows systems ë§Œì•½ í˜„ì¬ ë””ë ‰í† ë¦¬ê°€ ${user.home}/baeldungì´ê³  new File(\"bar/baz/.baz-one.txt\")ì´ ìƒì„±ëœë‹¤ë©´ getCanonicalPath()ì˜ ì¶œë ¥ì€ ë‹¤ìŒê³¼ ê°™ë‹¤./home/username/baeldung/bar/baz/baz-one.txt // on Unix systemsC:\\Users\\username\\baeldung\\bar\\baz\\baz-one.txt // on Windows Systems ì•½ì–´ í‘œí˜„ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì€ ë¬´ê¶ë¬´ì§„í•˜ê¸° ë•Œë¬¸ì— íŒŒì¼ ì‹œìŠ¤í…œì˜ ë‹¨ì¼ íŒŒì¼ì€ ë¬´í•œíˆ ë§ì€ ì ˆëŒ€ ê²½ë¡œë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬ë‚˜ canonical pathëŠ” í•­ìƒ ê³ ìœ í•˜ë‹¤. getCanonicalPath()ëŠ” íŒŒì¼ ì‹œìŠ¤í…œ ì¿¼ë¦¬ê°€ í•„ìš”í•˜ê¸° ë•Œë¬¸ì— IOExceptionì„ throwí•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ Windows ì‹œìŠ¤í…œì—ì„œ ì˜ëª»ëœ ë¬¸ì ì¤‘ í•˜ë‚˜ë¥¼ ì‚¬ìš©í•˜ì—¬ File ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ê²½ìš° í‘œì¤€ ê²½ë¡œë¥¼ í™•ì¸í•˜ë©´ IOExceptionì´ ë°œìƒí•œë‹¤. ì‚¬ìš© ì˜ˆì‹œ File ê°ì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ fully qualified nameì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ëŠ” ë©”ì†Œë“œë¥¼ ì‘ì„±í•œë‹¤ê³  ê°€ì •í•´ë³´ì. ê²½ë¡œê°€ ìƒëŒ€ì ì¸ì§€ ë˜ëŠ” ì•½ì–´ê°€ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ ì•Œ ìˆ˜ ì—†ëŠ” ê²½ìš°, getCanonicalPath()ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ, getCanonicalPath()ëŠ” íŒŒì¼ ì‹œìŠ¤í…œì„ ì½ê¸° ë•Œë¬¸ì— ì„±ëŠ¥ì´ ì €í•˜ëœë‹¤. ë”°ë¼ì„œ, ë§Œì•½ ì¤‘ë³µëœ ì´ë¦„ì´ë‚˜ ì‹¬ë³¼ë¦­ ë§í¬ê°€ ì—†ê³  ë“œë¼ì´ë¸Œ ë¬¸ì ëŒ€ì†Œë¬¸ìê°€ í‘œì¤€í™”ëœ ê²½ìš°(Windows OSë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°) getAbsoultePath()ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.java.io.File File ê°ì²´ê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. File ê°ì²´ê°€ ê°€ë¦¬í‚¤ëŠ” ê²ƒì´ íŒŒì¼ì¸ ê²½ìš° íŒŒì¼ì´ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸ íŒŒì¼ì¸ì§€ ê²½ë¡œì¸ì§€ í™•ì¸ ì½ê±°ë‚˜ ì“°ê±°ë‚˜ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ”ì§€ í™•ì¸ ì–¸ì œ ìˆ˜ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸ íŒŒì¼ ìƒì„±, ì‚­ì œ, ì´ë¦„ ë³€ê²½ ì „ì²´ ê²½ë¡œ í™•ì¸ File ê°ì²´ê°€ ê°€ë¦¬í‚¤ëŠ” ê²ƒì´ ê²½ë¡œì¸ ê²½ìš° íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸° ê²½ë¡œ ìƒì„±, ì‚­ì œ File í´ë˜ìŠ¤ì˜ ë‹¤ì–‘í•œ ìƒì„±ì child, pathnameìœ¼ë¡œ ë˜ì–´ ìˆëŠ” ê°’ì€ ê²½ë¡œê°€ ë  ìˆ˜ë„, íŒŒì¼ì´ ë  ìˆ˜ë„ ìˆë‹¤. ìƒì„±ì ì„¤ëª… File(File parent, String child) ì´ë¯¸ ìƒì„±ë˜ì–´ ìˆëŠ” File ê°ì²´(parent)ì™€ ê·¸ ê²½ë¡œì˜ í•˜ìœ„ ê²½ë¡œ ì´ë¦„ìœ¼ë¡œ ìƒˆë¡œìš´ File ê°ì²´ ìƒì„± File(String pathname) ì§€ì •í•œ ê²½ë¡œ ì´ë¦„ìœ¼ë¡œ File ê°ì²´ë¥¼ ìƒì„± File(String parent, String child) ìƒìœ„ ê²½ë¡œ(parent)ì™€ í•˜ìœ„ ê²½ë¡œ(child)ë¡œ File ê°ì²´ë¥¼ ìƒì„± File(URI uri) URIì— ë”°ë¥¸ File ê°ì²´ë¥¼ ìƒì„± File.separator ìœˆë„ìš°ì—ì„œëŠ” ê²½ë¡œë¥¼ êµ¬í•  ë•Œ ì—­ìŠ¬ë˜ì‹œ(ë˜ëŠ” â‚© ê¸°í˜¸ë¥¼ ì‚¬ìš©í•œë‹¤), ìœ ë‹‰ìŠ¤ ê³„ì—´ì—ì„œëŠ” ìŠ¬ë˜ì‹œ(/)ë¥¼ ì‚¬ìš©í•œë‹¤. ë”°ë¼ì„œ OSì— ë…ë¦½ì ì¸ ì½”ë“œë¥¼ ì§œê¸°ìœ„í•´ì„œëŠ” í•´ë‹¹ OSì˜ ê²½ë¡œ êµ¬ë¶„ ë¬¸ìë¥¼ ê°€ì ¸ì˜¤ëŠ” File.speratorë¥¼ ì‚¬ìš©í•´ì•¼í•œë‹¤. java.nio.file(Path, Paths, Files) java.nio.file íŒ¨í‚¤ì§€ëŠ” JVMì´ íŒŒì¼, íŒŒì¼ ì†ì„± ë° íŒŒì¼ ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ê¸° ìœ„í•œ ì¸í„°í˜ì´ìŠ¤ ë° í´ë˜ìŠ¤ë¥¼ ì •ì˜í•œë‹¤. ì´ APIëŠ” java.io.File íŒ¨í‚¤ì§€ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤. í•µì‹¬ì€ Pathì´ê³  Paths, Filesì—ì„œëŠ” ë‹¤ì–‘í•œ ë©”ì„œë“œë¥¼ ì œê³µí•˜ëŠ” ê²ƒ ê°™ë‹¤. Path íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ íŒŒì¼ì„ ì°¾ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê°œì²´ì…ë‹ˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì‹œìŠ¤í…œ ì¢…ì† íŒŒì¼ ê²½ë¡œë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. ê²½ë¡œëŠ” ê³„ì¸µì  ê²½ë¡œë¥¼ ë‚˜íƒ€ë‚´ë©° íŠ¹ìˆ˜ êµ¬ë¶„ ê¸°í˜¸ ë˜ëŠ” êµ¬ë¶„ ê¸°í˜¸ë¡œ êµ¬ë¶„ëœ ì¼ë ¨ì˜ ë””ë ‰í† ë¦¬ ë° íŒŒì¼ ì´ë¦„ ìš”ì†Œë¡œ êµ¬ì„±ë©ë‹ˆë‹¤. íŒŒì¼ ì‘ì—…ì— ëŒ€í•œ ë³´ë‹¤ íš¨ìœ¨ì ì´ê³  ê´‘ë²”ìœ„í•œ ì ‘ê·¼ì„ ìœ„í•´ Files í´ë˜ìŠ¤ì™€ í•¨ê»˜ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. public interface Path extends Comparable&lt;Path&gt;, Iterable&lt;Path&gt;, Watchable Paths ì´ í´ë˜ìŠ¤ëŠ” ê²½ë¡œ ë¬¸ìì—´ ë˜ëŠ” URIë¥¼ ë³€í™˜í•˜ì—¬ Pathë¥¼ ë°˜í™˜í•˜ëŠ” ì •ì  ë©”ì„œë“œë¡œë§Œ êµ¬ì„±ëœë‹¤. public final class Paths { private Paths() { } ...} Files ì´ í´ë˜ìŠ¤ëŠ” íŒŒì¼, ë””ë ‰í† ë¦¬ ë˜ëŠ” ê¸°íƒ€ ìœ í˜•ì˜ íŒŒì¼ì—ì„œ ì‘ë™í•˜ëŠ” ì •ì  ë©”ì†Œë“œë¡œë§Œ êµ¬ì„±ëœë‹¤. ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì—¬ê¸°ì— ì •ì˜ëœ ë©”ì„œë“œëŠ” FileSystemProviderì—ê²Œ íŒŒì¼ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë„ë¡ ìœ„ì„í•œë‹¤. public final class Files { private Files() { } ...} java.nio.file.Path ìë°”7 ë¶€í„° ì œê³µë˜ëŠ” NIO2ì˜ ì¼ë¶€ì´ë‹¤. I/O ì‘ì—…ì„ ìœ„í•œ ì™„ì „íˆ ìƒˆë¡œìš´ APIë¥¼ ì œê³µí•œë‹¤. java.io.File í´ë˜ìŠ¤ì™€ ë§ˆì°¬ê°€ì§€ë¡œ PathëŠ” íŒŒì¼ ì‹œìŠ¤í…œì—ì„œ íŒŒì¼ì„ ì°¾ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê°ì²´ë„ ìƒì„±í•œë‹¤. ë§ˆì°¬ê°€ì§€ë¡œ íŒŒì¼ í´ë˜ìŠ¤ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Path path = Paths.get(\"baeldung/tutorial.txt\"); ê¸°ì¡´ì˜ File í´ë˜ìŠ¤ì²˜ëŸ¼ ìƒì„±ìë¥¼ ì‚¬ìš©í•˜ëŠ” ëŒ€ì‹  ì •ì  java.nio.file.Paths.get()ì„ ì‚¬ìš©í•˜ì—¬ Path ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“ ë‹¤. â€˜ê·¸ëŸ¼ ê·¸ëƒ¥ ê¸°ì¡´ì˜ Fileì„ ì‚¬ìš©í•˜ë©´ ë˜ëŠ”ê²ƒ ì•„ë‹Œê°€?â€™ ë¼ëŠ” ì˜ë¬¸ì´ ë“¤ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ ê¸°ì¡´ File í´ë˜ìŠ¤ëŠ” ëª‡ ê°€ì§€ ë‹¨ì ì´ ìˆë‹¤.java.io.Fileì˜ ë‹¨ì 1. ì—ëŸ¬ ì²˜ë¦¬ File í´ë˜ìŠ¤ì˜ ë§ì€ ë©”ì„œë“œëŠ” ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ì§€ ëª»í•˜ë”ë¼ë„ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ, ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì–»ê¸°ê°€ ì–´ë ¤ì› ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, íŒŒì¼ì„ ì‚­ì œí•˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œê°€ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì. ì´ ì½”ë“œëŠ” ì˜¤ë¥˜ ì—†ì´ ì„±ê³µì ìœ¼ë¡œ ì»´íŒŒì¼ ë° ì‹¤í–‰ëœë‹¤. ë¬¼ë¡  false ê°’ì„ í¬í•¨í•˜ëŠ” ê²°ê³¼ í”Œë˜ê·¸ê°€ ìˆì§€ë§Œ ì‹¤íŒ¨ì˜ ê·¼ë³¸ ì›ì¸ì„ ì•Œ ìˆ˜ëŠ” ì—†ë‹¤. File file = new File(\"baeldung/tutorial.txt\");boolean result = file.delete(); ìƒˆë¡œìš´ NIO2 APIë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì¼í•œ ê¸°ëŠ¥ì„ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. ì´ì œ ì»´íŒŒì¼ëŸ¬ëŠ” IOExceptionì„ ì²˜ë¦¬í•˜ë„ë¡ ìš”êµ¬í•œë‹¤. ë˜í•œ, ì˜ˆì™¸ëŠ” ì‹¤íŒ¨ì— ëŒ€í•œ ì„¸ë¶€ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‹¤. Path path = Paths.get(\"baeldung/tutorial.txt\");Files.delete(path);2. ë©”íƒ€ë°ì´í„° ì§€ì› java.io.File í´ë˜ìŠ¤ëŠ” íŒŒì¼ì— ëŒ€í•œ ë©”íƒ€ ì •ë³´ê°€ í•„ìš”í•œ I/O ì‘ì—…ì— ëŒ€í•´ ì—¬ëŸ¬ í”Œë«í¼ì—ì„œ ì¼ê´€ë˜ê²Œ ì‘ë™í•˜ì§€ ì•Šì„ ìˆ˜ ìˆë‹¤. ë©”íƒ€ë°ì´í„°ì—ëŠ” ê¶Œí•œ, íŒŒì¼ ì†Œìœ ì ë° ë³´ì•ˆ ì†ì„± ë“±ì´ í¬í•¨ë  ìˆ˜ ìˆë‹¤. ì´ë¡œ ì¸í•´ File í´ë˜ìŠ¤ëŠ” ì‹¬ë³¼ë¦­ ë§í¬ë¥¼ ì „í˜€ ì§€ì›í•˜ì§€ ì•Šìœ¼ë©°, rename() ë©”ì„œë“œëŠ” ì—¬ëŸ¬ í”Œë«í¼ì—ì„œ ì¼ê´€ë˜ê²Œ ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤. â€» ì‹¬ë³¼ë¦­ ë§í¬ : ì ˆëŒ€ ê²½ë¡œ ë˜ëŠ” ìƒëŒ€ ê²½ë¡œì˜ í˜•íƒœë¡œ ëœ ë‹¤ë¥¸ íŒŒì¼ì´ë‚˜ ê²½ë¡œì— ëŒ€í•œ ì°¸ì¡°ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” íŠ¹ë³„í•œ ì¢…ë¥˜ì˜ íŒŒì¼3. ë©”ì„œë“œ í™•ì¥ê³¼ ì„±ëŠ¥ Method Scaling and Performance íŒŒì¼ í´ë˜ìŠ¤ì˜ ë©”ì†Œë“œëŠ” í™•ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ, ëŒ€ê·œëª¨ ë””ë ‰í† ë¦¬ ëª©ë¡ ìš”ì²­ìœ¼ë¡œ ì¸í•´ ì„œë²„ê°€ ì¤‘ë‹¨ë  ìˆ˜ ìˆë‹¤. ë˜í•œ DoS(Denial of Service)ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆëŠ” ë©”ëª¨ë¦¬ ë¦¬ì†ŒìŠ¤ ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ë„ ìˆë‹¤. File í´ë˜ìŠ¤ëŠ” Path í´ë˜ìŠ¤ë³´ë‹¤ ê°ì²´ ì§€í–¥ì ì´ë‹¤. ë”°ë¼ì„œ, Path API ê¸°ë°˜ I/O ìŠ¤íŠ¸ë¦¼ì€ GC ê´€ì ì—ì„œ File í´ë˜ìŠ¤ë³´ë‹¤ ì €ë ´í•˜ë‹¤. Mapping FunctionalityNIO2 íŒ¨í‚¤ì§€ëŠ” ìœ„ì—ì„œ ì‚´í´ë³¸ File í´ë˜ìŠ¤ì˜ ë‹¨ì ì— ëŒ€í•œ ê°œì„  ì‚¬í•­ì„ í¬í•¨í•˜ì—¬ ëª¨ë“  ë ˆê±°ì‹œ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ì£¼ë¡œ java.nio.file.Files í´ë˜ìŠ¤ì˜ ì •ì  ë©”ì†Œë“œë¥¼ í™œìš©í•œë‹¤.1. íŒŒì¼ê³¼ ê²½ë¡œ ì¸ìŠ¤í„´ìŠ¤ ìƒì„±// java.io.FileFile file = new File(\"baeldung\", \"tutorial.txt\");// java.nio.filePath path = Paths.get(\"baeldung\", \"tutorial.txt\");Path path2 = Paths.get(\"baeldung\").resolve(\"tutorial.txt\");Path pathFromFile = file.toPath();File fileFromPath = path.toFile();2. íŒŒì¼, ê²½ë¡œ ë§µí•‘ íŒŒì¼ì„ ìƒì„±í•˜ë ¤ë©´ createNewFile() ë° Files.createFile() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤. boolean result = file.createNewFile();Path newPath = Files.createFile(path); ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±í•˜ë ¤ë©´ mkdir() ë˜ëŠ” Files.createDirectory()ë¥¼ ì‚¬ìš©í•œë‹¤. boolean result = file.mkdir();File newPath = Files.createDirectory(path); mkdirs() ë° Files.createDirectories() ë©”ì„œë“œë¥¼ í†µí•´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ëª¨ë“  í•˜ìœ„ ë””ë ‰í„°ë¦¬ë¥¼ í¬í•¨í•  ìˆ˜ ìˆë‹¤. boolean result = file.mkdirs();File newPath = Files.createDirectories(path); íŒŒì¼ì˜ ì´ë¦„ì„ ë°”ê¾¸ê±°ë‚˜ ì´ë™í•˜ë ¤ë©´ ë‹¤ë¥¸ ì¸ìŠ¤í„´ìŠ¤ ê°œì²´ë¥¼ ë§Œë“¤ê³  renameTo() ë˜ëŠ” Files.move()ë¥¼ ì‚¬ìš©í•œë‹¤. boolean result = file.renameTo(new File(\"baeldung/tutorial2.txt\"));Path newPath = Files.move(path, Paths.get(\"baeldung/tutorial2.txt\")); ì‚­ì œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë ¤ë©´ delete() ë˜ëŠ” Files.delete()ë¥¼ ì‚¬ìš©í•œë‹¤. boolean result = file.delete();Files.delete(Paths.get(path)); 3. ë©”íƒ€ë°ì´í„° ì½ê¸° (Reading Metadata) ê¶Œí•œì´ë‚˜ ìœ í˜•ê³¼ ê°™ì€ íŒŒì¼ì— ëŒ€í•œ ê¸°ë³¸ ì •ë³´ë„ ì–»ì„ ìˆ˜ ìˆë‹¤.// java.io APIboolean fileExists = file.exists();boolean fileIsFile = file.isFile();boolean fileIsDir = file.isDirectory();boolean fileReadable = file.canRead();boolean fileWritable = file.canWrite();boolean fileExecutable = file.canExecute();boolean fileHidden = file.isHidden();// java.nio APIboolean pathExists = Files.exists(path);boolean pathIsFile = Files.isRegularFile(path);boolean pathIsDir = Files.isDirectory(path);boolean pathReadable = Files.isReadable(path);boolean pathWritable = Files.isWritable(path);boolean pathExecutable = Files.isExecutable(path);boolean pathHidden = Files.isHidden(path);4. ê²½ë¡œ ê´€ë ¨ ë©”ì„œë“œ (Pathname Methods)// java.io APIString absolutePathStr = file.getAbsolutePath();String canonicalPathStr = file.getCanonicalPath();// java.nio APIPath absolutePath = path.toAbsolutePath();Path canonicalPath = path.toRealPath().normalize();URI fileUri = file.toURI();URI pathUri = path.toUri();// java.io APIString[] list = file.list();File[] files = file.listFiles();// java.nio APIDirectoryStream&lt;Path&gt; paths = Files.newDirectoryStream(path);ì°¸ê³  ìë£Œ ì´ìƒë¯¼, ã€ìë°”ì˜ ì‹  2ã€, ë¡œë“œë¶(2017), 26ì¥ https://www.javatpoint.com/java-path-vs-file https://www.baeldung.com/java-path-vs-file https://docs.oracle.com/javase/7/docs/api/java/nio/file/Path.html https://stackoverflow.com/questions/24611148/what-does-abstract-path-means-in-java-io" }, { "title": "Java - ìë°” IO, NIO", "url": "/posts/java-io-nio/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-09-07 00:29:00 +0900", "snippet": "Java I/O Input, Outputì„ ë‚˜íƒ€ë‚¸ë‹¤. In, Outì˜ ê¸°ì¤€ì€ JVMì´ë‹¤. ì¦‰, JVMìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ê²½ìš°ì—” Input ë°ì´í„°ë¥¼ ë‚´ë³´ë‚´ëŠ” ê²½ìš°ì—” Outputì´ë‹¤. Stream ê¸°ë°˜ì´ë‹¤. í•œ ë²ˆì— 1byte ë˜ëŠ” ê·¸ ì´ìƒì˜ byteë¥¼ ì½ëŠ”ë‹¤. ë°ì´í„°ê°€ ìºì‹œë˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ë°ì´í„°ì˜ ì•ë’¤ë¡œ ì´ë™...", "content": "Java I/O Input, Outputì„ ë‚˜íƒ€ë‚¸ë‹¤. In, Outì˜ ê¸°ì¤€ì€ JVMì´ë‹¤. ì¦‰, JVMìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ” ë°ì´í„°ë¥¼ ë‹¤ë£¨ëŠ” ê²½ìš°ì—” Input ë°ì´í„°ë¥¼ ë‚´ë³´ë‚´ëŠ” ê²½ìš°ì—” Outputì´ë‹¤. Stream ê¸°ë°˜ì´ë‹¤. í•œ ë²ˆì— 1byte ë˜ëŠ” ê·¸ ì´ìƒì˜ byteë¥¼ ì½ëŠ”ë‹¤. ë°ì´í„°ê°€ ìºì‹œë˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ ë°ì´í„°ì˜ ì•ë’¤ë¡œ ì´ë™í•  ìˆ˜ ì—†ë‹¤. ë§Œì•½, ë°ì´í„°ì—ì„œ ì•ë’¤ë¡œ ì´ë™í•´ì•¼ í•˜ëŠ” ê²½ìš° ë¨¼ì € ë²„í¼ì— ìºì‹œí•´ì•¼ í•œë‹¤. blocking ë°©ì‹ì´ë‹¤. ì¦‰, ìŠ¤ë ˆë“œê°€ read() ë˜ëŠ” write()ë¥¼ í˜¸ì¶œí•˜ë©´ ì½ì„ ë°ì´í„°ê°€ ìˆê±°ë‚˜ ë°ì´í„°ê°€ ì™„ì „íˆ ì“°ì—¬ì§ˆ ë•Œê¹Œì§€ í•´ë‹¹ ìŠ¤ë ˆë“œëŠ” ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ë‹¤. í¬ê²Œ InputStream/OutputStream, Reader/Writerë¡œ êµ¬ë¶„ëœë‹¤.java.io.InputStream ë°”ì´íŠ¸ ê¸°ë°˜ ì…ë ¥ ìŠ¤íŠ¸ë¦¼ì˜ ìµœìƒìœ„ í´ë˜ìŠ¤ì´ë©° ì¶”ìƒí´ë˜ìŠ¤ì´ë‹¤. ì¶”ìƒ í´ë˜ìŠ¤ì´ë‹¤. Closeable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤. ì¦‰, java.io íŒ¨í‚¤ì§€ì— ìˆëŠ” í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•  ë•Œì—ëŠ” í•˜ë˜ ì‘ì—…ì´ ì¢…ë£Œë˜ë©´ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ë¥¼ close() ë©”ì„œë“œë¡œ í•­ìƒ ë‹«ì•„ì£¼ì–´ì•¼ í•œë‹¤. ì—¬ê¸°ì„œ ë¦¬ì†ŒìŠ¤ëŠ” íŒŒì¼, ë„¤íŠ¸ì›Œí¬ ì—°ê²° ë“±ì´ ë  ìˆ˜ ìˆë‹¤. ì£¼ìš” í•˜ìœ„ í´ë˜ìŠ¤ë¡œëŠ” FileInputStream, DataInputStream, ObjectInputStream, BufferedInputStream ë“±ì´ ìˆë‹¤.java.io.OutputStream ë°”ì´íŠ¸ ê¸°ë°˜ ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ì˜ ìµœìƒìœ„ í´ë˜ìŠ¤ì´ë©° ì¶”ìƒí´ë˜ìŠ¤ì´ë‹¤. Closeable, Flushable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤. Flushableì—ëŠ” flush() ë©”ì„œë“œë§Œ ì •ì˜ë˜ì–´ ìˆë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì–´ë–¤ ë¦¬ì†ŒìŠ¤ì— ë°ì´í„°ë¥¼ ì“¸ ë•Œ, ì“°ê¸° ì‘ì—…ì„ ìš”ì²­í•  ë•Œë§ˆë‹¤ ì €ì¥í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ í•˜ê²Œë˜ë©´ íš¨ìœ¨ì´ ë–¨ì–´ì§„ë‹¤. ë”°ë¼ì„œ, ë²„í¼(buffer)ë¥¼ ê°–ê³  ë°ì´í„°ë¥¼ ìŒ“ì•„ë‘ì—ˆë‹¤ê°€ ì–´ëŠì •ë„ ì°¨ê²Œ ë˜ë©´ í•œë²ˆì— ì“°ëŠ” ê²ƒì´ ì¢‹ë‹¤. flush() ë©”ì„œë“œëŠ” ë²„í¼ì— ìˆëŠ” ë°ì´í„°ë¥¼ ê¸°ë‹¤ë¦¬ì§€ ë§ê³  ë¬´ì¡°ê±´ ì €ì¥í•˜ê²Œ ë§Œë“œëŠ” ê¸°ëŠ¥ì„ ìˆ˜í–‰í•œë‹¤. ì£¼ìš” í•˜ìœ„ í´ë˜ìŠ¤ë¡œëŠ” FileOutputStream, DataOutputStream, ObjectOutputStream, BufferedOutputStream ë“±ì´ ìˆë‹¤.java.io.Reader ë¬¸ì ê¸°ë°˜ ì…ë ¥ ìŠ¤íŠ¸ë¦¼ì˜ ìµœìƒìœ„ í´ë˜ìŠ¤ì´ë©° ì¶”ìƒí´ë˜ìŠ¤ì´ë‹¤. public abstract class Reader implements Readable, Closeable ì£¼ìš” í•˜ìœ„ í´ë˜ìŠ¤ë¡œëŠ” FileReader, InputStreamReader, BufferedReader ë“±ì´ ìˆë‹¤.java.io.Writer ë¬¸ì ê¸°ë°˜ ì¶œë ¥ ìŠ¤íŠ¸ë¦¼ì˜ ìµœìƒìœ„ í´ë˜ìŠ¤ì´ë©° ì¶”ìƒí´ë˜ìŠ¤ì´ë‹¤. public abstract class Writer implements Appendable, Closeable, Flushable ì£¼ìš” í•˜ìœ„ í´ë˜ìŠ¤ë¡œëŠ” FileWriter, OutputStreamWriter, PrinterWriter, BufferedWriter ë“±ì´ ìˆë‹¤.Blocking ë°©ì‹ ì‚´í´ë³´ê¸°Name: AnnaAge: 25Email: anna@mailserver.comPhone: 1234567890 ìœ„ í…ìŠ¤íŠ¸ íŒŒì¼ì„ ì½ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ë³´ì.InputStream input = ... ; // get the InputStream from the client socketBufferedReader reader = new BufferedReader(new InputStreamReader(input));String nameLine = reader.readLine();String ageLine = reader.readLine();String emailLine = reader.readLine();String phoneLine = reader.readLine(); ì¶œì²˜ : http://tutorials.jenkov.com/java-nio/nio-vs-io.html#main-differences-between-java-nio-and-io New IO java.nio íŒ¨í‚¤ì§€ëŠ” Java 1.4ì—ì„œ ì²˜ìŒ ë„ì…ë˜ì—ˆìœ¼ë©° í–¥ìƒëœ íŒŒì¼ ì‘ì—… ë° ASynchronousSocketChannelëŠ” Java 1.7(NIO.2)ì—ì„œ ì—…ë°ì´íŠ¸ë˜ì—ˆë‹¤. ìŠ¤íŠ¸ë¦¼ ê¸°ë°˜ â†’ ë²„í¼(Buffer)ì™€ ì±„ë„(Channel) ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„° ì²˜ë¦¬ NIOì—ì„œ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ì„ ë•ŒëŠ” ë²„í¼ë¥¼ í†µí•´ì„œ ì²˜ë¦¬í•œë‹¤. ë²„í¼ ê¸°ë°˜ ë°ì´í„° ì²˜ë¦¬ ë°ì´í„°ëŠ” ë²„í¼ë¡œ ì½í˜€ì§€ê³  ë‚˜ì¤‘ì— ì²˜ë¦¬ëœë‹¤. í•„ìš”ì— ë”°ë¼ ë²„í¼ì—ì„œ ì•ë’¤ë¡œ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ì²˜ë¦¬ ì¤‘ì— ìœ ì—°ì„±ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤. ë²„í¼ë¥¼ ì™„ì „íˆ ì²˜ë¦¬í•˜ë ¤ë©´ í•„ìš”í•œ ëª¨ë“  ë°ì´í„°ê°€ ë²„í¼ì— í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•œë‹¤. ë˜í•œ ë²„í¼ë¡œ ë” ë§ì€ ë°ì´í„°ë¥¼ ì½ì„ ë•Œ ì•„ì§ ì²˜ë¦¬í•˜ì§€ ì•Šì€ ë²„í¼ì˜ ë°ì´í„°ë¥¼ ë®ì–´ì“°ì§€ ì•Šë„ë¡ í•´ì•¼í•œë‹¤. Non-Blocking ìŠ¤ë ˆë“œëŠ” ì±„ë„ì— ë°ì´í„° ì½ê¸°ë¥¼ ìš”ì²­í•  ìˆ˜ ìˆìœ¼ë©° í˜„ì¬ ì‚¬ìš© ê°€ëŠ¥í•œ ë°ì´í„°ë§Œ ê°€ì ¸ì˜¤ê±°ë‚˜ í˜„ì¬ ì‚¬ìš© ê°€ëŠ¥í•œ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš° ì•„ë¬´ ê²ƒë„ ê°€ì ¸ì˜¤ì§€ ì•ŠëŠ”ë‹¤. ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìˆì„ ë•Œê¹Œì§€ blocking ìƒíƒœë¥¼ ìœ ì§€í•˜ëŠ” ëŒ€ì‹  ìŠ¤ë ˆë“œëŠ” ë‹¤ë¥¸ ì‘ì—…ì„ ê³„ì†í•  ìˆ˜ ìˆë‹¤. ìŠ¤ë ˆë“œëŠ” ì¼ë¶€ ë°ì´í„°ê°€ ì±„ë„ì— ê¸°ë¡ë˜ë„ë¡ ìš”ì²­í•  ìˆ˜ ìˆì§€ë§Œ, ë°ì´í„°ê°€ ì™„ì „íˆ ê¸°ë¡ë˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ì§€ëŠ” ì•ŠëŠ”ë‹¤. ê·¸ëŸ° ë‹¤ìŒ ìŠ¤ë ˆë“œëŠ” ê³„ì†í•´ì„œ ì¤‘ê°„ì— ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. IO í˜¸ì¶œì—ì„œ ì°¨ë‹¨ë˜ì§€ ì•Šì„ ë•Œ ìŠ¤ë ˆë“œê°€ ìœ íœ´ ì‹œê°„ì„ ë³´ë‚´ëŠ” ê²ƒì€ ì¼ë°˜ì ìœ¼ë¡œ ê·¸ ë™ì•ˆ ë‹¤ë¥¸ ì±„ë„ì—ì„œ IOë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ë‹¤. ì¦‰, ë‹¨ì¼ ìŠ¤ë ˆë“œê°€ ì—¬ëŸ¬ ì…ë ¥ ë° ì¶œë ¥ ì±„ë„ì„ ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤. bufferFull() ë©”ì„œë“œëŠ” ë²„í¼ì— ì½ì–´ë“¤ì¸ ë°ì´í„°ì˜ ì–‘ì„ ì¶”ì í•˜ê³  ë²„í¼ê°€ ê°€ë“ ì°¼ëŠ”ì§€ ì—¬ë¶€ì— ë”°ë¼ true ë˜ëŠ” falseë¥¼ ë°˜í™˜í•´ì•¼í•œë‹¤. ì¦‰, ë²„í¼ê°€ ì²˜ë¦¬í•  ì¤€ë¹„ê°€ ë˜ë©´ ê°€ë“ ì°¬ ê²ƒìœ¼ë¡œ ê°„ì£¼ëœë‹¤. bufferFull() ë©”ì„œë“œëŠ” ë²„í¼ë¥¼ ìŠ¤ìº”í•˜ì§€ë§Œ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ê¸° ì „ê³¼ ë™ì¼í•œ ìƒíƒœë¡œ ë²„í¼ë¥¼ ìœ ì§€í•´ì•¼ í•œë‹¤. ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë²„í¼ë¡œ ì½ì€ ë‹¤ìŒ ë°ì´í„°ê°€ ì˜¬ë°”ë¥¸ ìœ„ì¹˜ì—ì„œ ì½íˆì§€ ì•Šì„ ìˆ˜ ìˆë‹¤.ByteBuffer buffer = ByteBuffer.allocate(48);int bytesRead = inChannel.read(buffer);while(! bufferFull(bytesRead) ) { bytesRead = inChannel.read(buffer);} ìœ„ ì½”ë“œë¥¼ ë‹¤ìŒê³¼ ê°™ì€ ë‹¤ì´ì–´ê·¸ë¨ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤. ì¶œì²˜ : http://tutorials.jenkov.com/java-nio/nio-vs-io.html#main-differences-between-java-nio-and-io Java NIO ì£¼ìš” ì»´í¬ë„ŒíŠ¸ Java NIOëŠ” Buffer, Channel, Selectorë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒˆë¡œìš´ I/O ëª¨ë¸ì„ ì œê³µí•œë‹¤.1. Buffer NIOì—ì„œ ì œê³µí•˜ëŠ” BufferëŠ” java.nio.Buffer í´ë˜ìŠ¤ë¥¼ í™•ì¥í•˜ì—¬ ì‚¬ìš©í•œë‹¤. ê¸°ë³¸ ë°ì´í„° ìœ í˜•ì— ëŒ€í•´ ë²„í¼ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Java NIOëŠ” ë²„í¼ ì§€í–¥ íŒ¨í‚¤ì§€ì´ë‹¤. ì¦‰, ì±„ë„ì„ ì‚¬ìš©í•˜ì—¬ ì¶”ê°€ ì²˜ë¦¬ëœ ë²„í¼ì— ë°ì´í„°ë¥¼ ì“°ê±°ë‚˜ ì½ì„ ìˆ˜ ìˆë‹¤. ByteBuffer, CharBuffer, DoubleBuffer ë“± ë‹¤ì–‘í•œ íƒ€ì…ì˜ ë²„í¼ê°€ ì¡´ì¬í•œë‹¤. ë²„í¼ëŠ” ê¸°ë³¸ ë°ì´í„° ìœ í˜•ì„ ë³´ìœ í•˜ê³  ë‹¤ë¥¸ NIO íŒ¨í‚¤ì§€ì— ëŒ€í•œ ê°œìš”ë¥¼ ì œê³µí•˜ë¯€ë¡œ ë°ì´í„°ì˜ ì»¨í…Œì´ë„ˆ ì—­í• ì„ í•œë‹¤. ë²„í¼ëŠ” ì±„ìš°ê¸°, ë¹„ìš°ê¸°, ë’¤ì§‘ê¸°, ë˜ê°ê¸° ë“±ì„ í•  ìˆ˜ ìˆë‹¤. ìœ„ì¹˜ì™€ ê´€ë ¨ëœ ë©”ì„œë“œ position() : í˜„ì¬ì˜ ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ëƒ„ limit() : ì½ê±°ë‚˜ ì“¸ ìˆ˜ ì—†ëŠ” ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ëƒ„ capacity() : ë²„í¼ì˜ í¬ê¸°ë¥¼ ë‚˜íƒ€ëƒ„ 0 &lt;= position &lt;= limit &lt;= capacity ì˜ˆì œ ì½”ë“œimport java.io.FileInputStream;import java.io.FileOutputStream;import java.io.IOException;import java.nio.ByteBuffer;import java.nio.channels.FileChannel;public class NioSample { public static void main(String[] args) { NioSample sample = new NioSample(); sample.basicWriteAndRead(); } public void basicWriteAndRead() { String fileName = \"nio.txt\"; try { writeFile(fileName, \"My first NIO sample\"); readFile(fileName); } catch (IOException e) { e.printStackTrace(); } } private void writeFile(String fileName, String data) throws IOException { FileChannel channel = new FileOutputStream(fileName).getChannel(); // íŒŒì¼ì„ ì“°ê¸° ìœ„í•œ ì±„ë„ ì–»ì–´ì˜¤ê¸° byte[] byteData = data.getBytes(); ByteBuffer buffer = ByteBuffer.wrap(byteData); // ByteBuffer ê°ì²´ ìƒì„± channel.write(buffer); // ë²„í¼ë¥¼ ì´ìš©í•´ì„œ íŒŒì¼ ìƒì„± channel.close(); } private void readFile(String fileName) throws IOException { FileChannel channel = new FileInputStream(fileName).getChannel(); // íŒŒì¼ì„ ì½ê¸° ìœ„í•œ ì±„ë„ ì–»ì–´ì˜¤ê¸° ByteBuffer buffer = ByteBuffer.allocate(1024); channel.read(buffer); // ë²„í¼ë¥¼ ë„˜ê²¨ì¤Œìœ¼ë¡œì¨ ë°ì´í„°ë¥¼ í•´ë‹¹ ë²„í¼ì— ë‹´ê²Œëœë‹¤. buffer.flip(); // ë²„í¼ì— ë‹´ê²¨ìˆëŠ” ë°ì´í„°ì˜ ê°€ì¥ ì•ìœ¼ë¡œ ì´ë™ while (buffer.hasRemaining()) { System.out.print((char) buffer.get()); } channel.close(); }}2. Channel ì±„ë„ì€ ì™¸ë¶€ ì„¸ê³„ì™€ í†µì‹ í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” ìŠ¤íŠ¸ë¦¼ê³¼ ê°™ë‹¤. ì±„ë„ì—ì„œ ë²„í¼ë¡œ ë°ì´í„°ë¥¼ ì½ê±°ë‚˜ ë²„í¼ì—ì„œ ì±„ë„ë¡œ ë°ì´í„°ë¥¼ ì“¸ ìˆ˜ ìˆë‹¤. Java NIOëŠ” non-blocking I/O ì‘ì—…ì„ ìˆ˜í–‰í•˜ë©° ì´ëŸ¬í•œ I/O ì‘ì—…ì— ì±„ë„ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì„œë¡œ ë‹¤ë¥¸ ì—”í‹°í‹°ì— ëŒ€í•œ ì—°ê²°ì€ ë…¼ë¸”ë¡œí‚¹ I/O ë™ì‘ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ì±„ë„ë¡œ í‘œí˜„ëœë‹¤. ì±„ë„ì€ ì¤‘ê°„ ë§¤ì²´ ë˜ëŠ” ê²Œì´íŠ¸ì›¨ì´ë¡œ ì‘ë™í•œë‹¤. ì¶œì²˜ : https://www.geeksforgeeks.org/introduction-to-java-nio-with-examples/ 3. Selector Selectorë¥¼ í†µí•´ non-blocking I/Oê°€ ê°€ëŠ¥í•˜ë‹¤. SelectorëŠ” ì´ë²¤íŠ¸ì— ëŒ€í•´ ì—¬ëŸ¬ ì±„ë„ì„ ëª¨ë‹ˆí„°ë§í•œë‹¤. í•˜ë‚˜ì˜ Selectorë¥¼ ì‚¬ìš©í•´ì„œ ë‹¤ìˆ˜ì˜ channelsë¥¼ ë“±ë¡í•  ìˆ˜ ìˆë‹¤. í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•´ì„œ inputì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” channel, writingì„ ìœ„í•´ ì¤€ë¹„ëœ channelì„ ì„ íƒí•  ìˆ˜ ìˆë‹¤. ì¦‰, SelectorëŠ” I/O ì‘ì—…ì„ ìœ„í•´ ì¤€ë¹„ëœ ì±„ë„ì„ ì„ íƒí•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤. ê²°ê³¼ì ìœ¼ë¡œ, í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œ ì—¬ëŸ¬ ê°œì˜ channelì„ ì‰½ê²Œ ê´€ë¦¬í•  ìˆ˜ ìˆê²Œëœë‹¤. ë‹¤ìˆ˜ì˜ ìŠ¤ë ˆë“œë¡œ IOë¥¼ ê´€ë¦¬í•˜ëŠ” ë°©ì‹ì— ë¹„í•´ ìŠ¤ë ˆë“œ ê°„ì˜ context switchingì„ ì¤„ì—¬ì¤€ë‹¤. ì¶œì²˜ : https://www.geeksforgeeks.org/introduction-to-java-nio-with-examples/ Java I/OëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ë™ì‘í• ê¹Œ ?Buffer Handling and Kernel vs User Space ì¶œì²˜ : https://howtodoinjava.com/java/io/how-java-io-works-internally/ ìœ„ì˜ ì´ë¯¸ì§€ëŠ” ë¸”ë¡ ë°ì´í„°ê°€ í•˜ë“œ ë””ìŠ¤í¬ì™€ ê°™ì€ ì™¸ë¶€ ì†ŒìŠ¤ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ë‚´ë¶€ì˜ ë©”ëª¨ë¦¬ ì˜ì—­(ì˜ˆ: RAM)ìœ¼ë¡œ ì´ë™í•˜ëŠ” ë°©ì‹ì— ëŒ€í•œ ë‹¨ìˆœí™”ëœ â€˜ë…¼ë¦¬ì â€™ ë‹¤ì´ì–´ê·¸ë¨ì„ ë‚˜íƒ€ë‚¸ë‹¤. í”„ë¡œì„¸ìŠ¤ëŠ” read() ì‹œìŠ¤í…œ í˜¸ì¶œì„ í†µí•´ ë²„í¼ë¥¼ ì±„ìš°ë„ë¡ ìš”ì²­í•œë‹¤. ì‚¬ìš©ì í”„ë¡œì„¸ìŠ¤ëŠ” User Spaceì—ì„œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì— í•˜ë“œì›¨ì–´ì— ì§ì ‘ì ìœ¼ë¡œ ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤. ë”°ë¼ì„œ, OSì—ì„œ ì œê³µí•˜ëŠ” ì‹œìŠ¤í…œì½œì„ í†µí•´ I/Oë¥¼ ìˆ˜í–‰í•´ì•¼ í•œë‹¤. read() ì‹œìŠ¤í…œì½œì„ í†µí•´ ì»¤ë„ì—ê²Œ I/O ìˆ˜í–‰ì„ ìš”ì²­í•œë‹¤. ì´ ê³¼ì •ì—ì„œ ìœ ì € ëª¨ë“œ(User mode)ì—ì„œ ì»¤ë„ ëª¨ë“œ(Kernal mode)ë¡œ ìŠ¤ìœ„ì¹­ì´ ë°œìƒí•œë‹¤. ì œì–´ê¶Œì„ ë„˜ê²¨ë°›ì€ ì»¤ë„ì€ ìš°ì„  í”„ë¡œì„¸ìŠ¤ê°€ ìš”ì²­í•œ ë°ì´í„°ê°€ ì´ë¯¸ ì»¤ë„ ì˜ì—­ ìºì‹œ ë©”ëª¨ë¦¬ì— ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤. ë§Œì¼ ë°ì´í„°ê°€ ìºì‹œì— ì¡´ì¬í•œë‹¤ë©´ í•´ë‹¹ ë°ì´í„°ë¥¼ read() í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ì „ë‹¬ë°›ì€ ë©”ëª¨ë¦¬ ì˜ì—­ì— ë³µì‚¬í•œ ë’¤ ì œì–´ê¶Œì„ ë‹¤ì‹œ ì‚¬ìš©ì í”„ë¡œì„¸ìŠ¤ì—ê²Œ ë„˜ê¸´ë‹¤.(ì»¤ë„ ëª¨ë“œ -&gt; ìœ ì € ëª¨ë“œë¡œ ìŠ¤ìœ„ì¹­) ë°ì´í„°ê°€ ìºì‹œì— ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ë””ìŠ¤í¬ë¡œë¶€í„° ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê³¼ì •ì„ ìˆ˜í–‰í•œë‹¤. ì½ê¸° í˜¸ì¶œì€ ì»¤ë„ì´ ë””ìŠ¤í¬ ì»¨íŠ¸ë¡¤ëŸ¬ í•˜ë“œì›¨ì–´ì— ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ ë””ìŠ¤í¬ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë„ë¡ í•œë‹¤. ì´ëŠ” CPUê°€ ë””ìŠ¤í¬ë³´ë‹¤ ìˆ˜ë°±ë°°ëŠ” ë¹ ë¥´ê¸° ë•Œë¬¸ì—, ë””ìŠ¤í¬ì˜ ì²˜ë¦¬ ì‹œê°„ì„ ê¸°ë‹¤ë¦¬ëŠ” ê²ƒì´ ë‚­ë¹„ì´ê¸° ë•Œë¬¸ì´ë‹¤. ë””ìŠ¤í¬ ì»¨íŠ¸ë¡¤ëŸ¬ëŠ” CPUì˜ ì¶”ê°€ ì§€ì› ì—†ì´ DMAë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì»¤ë„ ë©”ëª¨ë¦¬ ë²„í¼ì— ì§ì ‘ ì“´ë‹¤. ë””ìŠ¤í¬ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë²„í¼ ì±„ìš°ê¸°ë¥¼ ë§ˆì¹˜ë©´ ì»¤ë„ì€ ì»¤ë„ ê³µê°„ì˜ ì„ì‹œ ë²„í¼ì—ì„œ í”„ë¡œì„¸ìŠ¤ê°€ ì§€ì •í•œ ë²„í¼ë¡œ ë°ì´í„°ë¥¼ ë³µì‚¬í•œë‹¤. read() ê³¼ì •ì´ ì¢…ë£Œë˜ë©´ì„œ, ì‚¬ìš©ì í”„ë¡œì„¸ìŠ¤ëŠ” Block ë˜ì–´ ìˆë˜ ë©”ì„œë“œê°€ ì™„ë£Œë˜ë©° ìš”ì²­í•œ ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆê²Œ ëœë‹¤.Arguments ìœ„ì—ì„œ ì‚´í´ë´¤ë“¯ì´, Java I/Oì˜ ê²½ìš° ì»¤ë„ ë©”ëª¨ë¦¬ë¥¼ ì§ì ‘ ì ‘ê·¼í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ JVMì— ë°ì´í„°ë¥¼ copyí•˜ëŠ” ì‘ì—… ë¡œì§ì´ í¬í•¨ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ë¹„íš¨ìœ¨ì ì´ë‹¤ëŠ” ì˜ê²¬ì´ ìˆë‹¤. CPUê°€ ê°œì…í•˜ì—¬ ì»¤ë„ ì˜ì—­ ë©”ëª¨ë¦¬ì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©ì ì˜ì—­ìœ¼ë¡œ ì˜®ê¸°ë©° ì˜¤ë²„í—¤ë“œê°€ ë°œìƒí•œë‹¤. ì´ ê³¼ì •ì—ì„œ ìƒì„±ëœ Javaì˜ ê°ì²´ë“¤ì€ GC ëŒ€ìƒì´ ëœë‹¤. ì¼ë°˜ì ìœ¼ë¡œ DMAë¥¼ í•˜ê²Œë˜ë©´ CPU ìì›ì‚¬ìš© ì—†ì´ ì§ì ‘ì ì¸ ë©”ëª¨ë¦¬ ì ‘ê·¼ì„ í•˜ê¸° ë•Œë¬¸ì— CPU ì˜¤ë²„í—¤ë“œê°€ ì—†ìœ¼ë©° CPU ìì› ì ìœ ê°€ ì—†ëŠ” non-blocking ìˆ˜í–‰ì´ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì´ì ì´ ìˆë‹¤. java.nio ì—ì„œëŠ” ì‚¬ìš©ì ì˜ì—­ìƒì— Bufferë¥¼ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ ì•„ë‹Œ ì»¤ë„ì˜ì—­ì— Bufferë¥¼ ë§Œë“¤ì–´ ì§ì ‘ DMAë¥¼ í•  ìˆ˜ ìˆë„ë¡ ì œê³µí•˜ê³  ìˆë‹¤. ë”°ë¼ì„œ, java.nioë¥¼ ì‚¬ìš©í•˜ëŠ”ê²ƒì´ java.ioë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒ ë³´ë‹¤ ì¼ë°˜ì ìœ¼ë¡œ ì„±ëŠ¥ì ìœ¼ë¡œ ë›°ì–´ë‚˜ë‹¤ê³  ì•Œë ¤ì ¸ìˆë‹¤. í•˜ì§€ë§Œ, í•­ìƒ ê·¸ëŸ° ê²ƒë§Œì€ ì•„ë‹ˆë‹¤. ê´€ë ¨ ê¸€ cf) DMA(Direct memory access) DMAëŠ” íŠ¹ì • í•˜ë“œì›¨ì–´ í•˜ìœ„ ì‹œìŠ¤í…œì´ CPUì™€ ë…ë¦½ì ìœ¼ë¡œ RAMì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ê¸°ëŠ¥ì´ë‹¤. DMAê°€ ì—†ìœ¼ë©´ CPUê°€ í”„ë¡œê·¸ë˜ë°ëœ ì…ì¶œë ¥ì„ ì‚¬ìš©í•  ë•Œ, ì¼ë°˜ì ìœ¼ë¡œ ì½ê¸° ë˜ëŠ” ì“°ê¸° ì‘ì—…ì˜ ì „ì²´ ì‹œê°„ ë™ì•ˆ ì™„ì „íˆ ì‚¬ìš©ë˜ë¯€ë¡œ ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ë‹¤. ë”°ë¼ì„œ, CPUëŠ” ë¨¼ì € DMA ì „ì†¡ì„ ì‹œì‘í•˜ê³ , ì „ì†¡ì´ ì§„í–‰ë˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤. ì‘ì—…ì´ ì™„ë£Œë˜ë©´ DMA ì»¨íŠ¸ë¡¤ëŸ¬ë¡œë¶€í„° ì¸í„°ëŸ½íŠ¸ë¥¼ ìˆ˜ì‹ í•œë‹¤. ì´ ê¸°ëŠ¥ì€ CPUê°€ ë°ì´í„° ì „ì†¡ ì†ë„ë¥¼ ë”°ë¼ê°€ì§€ ëª»í•˜ê±°ë‚˜ CPUê°€ ìƒëŒ€ì ìœ¼ë¡œ ëŠë¦° I/O ë°ì´í„° ì „ì†¡ì„ ê¸°ë‹¤ë¦¬ëŠ” ë™ì•ˆ ì‘ì—…ì„ ìˆ˜í–‰í•´ì•¼ í•  ë•Œ ìœ ìš©í•˜ë‹¤.ì°¸ê³  ìë£Œ ì´ìƒë¯¼, ã€ìë°”ì˜ ì‹  2ã€, ë¡œë“œë¶(2017), 26,27ì¥ https://www.baeldung.com/java-io-vs-nio http://tutorials.jenkov.com/java-nio/nio-vs-io.html#main-differences-between-java-nio-and-io https://www.geeksforgeeks.org/introduction-to-java-nio-with-examples/ https://howtodoinjava.com/java/io/how-java-io-works-internally/ https://taes-k.github.io/2021/01/06/java-nio/ https://leeyh0216.github.io/posts/java_nio_why_java_io_slow/ https://en.wikipedia.org/wiki/Direct_memory_access" }, { "title": "try-with-resource ì‚¬ìš©ì‹œ Socket closed ì˜ˆì™¸ ë°œìƒ", "url": "/posts/try-with-resource-caution/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "Java, Socket", "date": "2021-09-05 14:00:00 +0900", "snippet": "ìƒí™©ìë°”ë¡œ ë§Œë“  ê°„ë‹¨í•œ ì›¹ ì„œë²„ì—ì„œ 404, 500ê³¼ ê°™ì€ ì—ëŸ¬ í˜ì´ì§€ ì²˜ë¦¬ë¥¼ ìœ„í•´ catch ì ˆ ë‚´ë¶€ì— ì—ëŸ¬ í˜ì´ì§€ë¥¼ ì‘ë‹µí•˜ëŠ” ë¡œì§ì„ ì‘ì„±í–ˆë‹¤.í•˜ì§€ë§Œ ì—ëŸ¬ ë°œìƒì‹œ ì—ëŸ¬ í˜ì´ì§€ê°€ ì‘ë‹µë˜ì§€ ì•Šê³  java.net.SocketException: Socket closedê°€ ë°œìƒí–ˆë‹¤.public class HttpServer { ... public ...", "content": "ìƒí™©ìë°”ë¡œ ë§Œë“  ê°„ë‹¨í•œ ì›¹ ì„œë²„ì—ì„œ 404, 500ê³¼ ê°™ì€ ì—ëŸ¬ í˜ì´ì§€ ì²˜ë¦¬ë¥¼ ìœ„í•´ catch ì ˆ ë‚´ë¶€ì— ì—ëŸ¬ í˜ì´ì§€ë¥¼ ì‘ë‹µí•˜ëŠ” ë¡œì§ì„ ì‘ì„±í–ˆë‹¤.í•˜ì§€ë§Œ ì—ëŸ¬ ë°œìƒì‹œ ì—ëŸ¬ í˜ì´ì§€ê°€ ì‘ë‹µë˜ì§€ ì•Šê³  java.net.SocketException: Socket closedê°€ ë°œìƒí–ˆë‹¤.public class HttpServer { ... public void start() throws IOException { ExecutorService pool = Executors.newFixedThreadPool(NUM_THREADS); try (ServerSocket server = new ServerSocket(port)) { Socket connection; while ((connection = server.accept()) != null) { Runnable r = new HttpPageProcessor(connection); pool.submit(r); } } }}public class HttpPageProcessor implements Runnable { @Override public void run() { try (InputStream inputStream = connection.getInputStream(); OutputStream outputStream = connection.getOutputStream()){ httpReq = HttpUtils.getHttpRequest(inputStream); httpResp = HttpUtils.getHttpResponse(outputStream); ... ìš”ì²­ì— ë”°ë¼ ì•Œë§ì€ html í˜ì´ì§€ ì‘ë‹µ } catch (Exception e) { ... ì—ëŸ¬ í˜ì´ì§€ ì‘ë‹µ } } ...}ì›ì¸ ì›ì¸ì€ try-with-resource ì‚¬ìš©ìœ¼ë¡œ ì¸í•´ Socketì´ ìë™ìœ¼ë¡œ ë‹«íˆê¸° ë–„ë¬¸ì´ë‹¤. ì¦‰, catchì ˆ ë‚´ì—ì„œ ì—ëŸ¬ í˜ì´ì§€ ì‘ë‹µ ë¡œì§ì„ ìˆ˜í–‰í•˜ëŠ”ë° í•„ìš”í•œ ì†Œì¼“ ì»¤ë„¥ì…˜ì´ ì´ë¯¸ ë‹«íŒ ìƒíƒœì´ë‹¤. ê·¼ë° ì—¬ê¸°ì„œ í•œê°€ì§€ ì˜ë¬¸ì´ ë“¤ì—ˆë‹¤. try() ë‚´ë¶€ì—ì„œ í• ë‹¹í•œ ê²ƒì€ InputStreamê³¼ OutputStreamì¸ë° ì™œ ì†Œì¼“ë„ ë‹«íˆëŠ”ê±°ì§€ ? í•´ë‹µì€ ê°ê°ì˜ êµ¬í˜„ì²´ì¸ java.net.SocketInputStream, java.net.SocketOutputStreamì— ìˆëŠ” close() ë©”ì„œë“œë¥¼ ë³´ë©´ ì•Œ ìˆ˜ ìˆë‹¤. close() ë©”ì„œë“œ ë‚´ë¶€ì—ì„œ ì†Œì¼“ì´ ë‹«í˜”ëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê³  socket.close()ë¥¼ í˜¸ì¶œí•˜ëŠ” ë¡œì§ì´ ìˆë‹¤. try ë‚´ë¶€ì—ì„œ OutputStreamì´ ë” ëŠ¦ê²Œ í• ë‹¹ë˜ë¯€ë¡œ SocketOutputStream.close() ë©”ì„œë“œê°€ ë¨¼ì € í˜¸ì¶œëœë‹¤. private boolean closing = false; public void close() throws IOException { // Prevent recursion. See BugId 4484411 if (closing) return; closing = true; if (socket != null) { if (!socket.isClosed()) socket.close(); } else impl.close(); closing = false; } í•´ê²° ê³¼ì • try-catch-finally ì‚¬ìš© ì´ë ‡ê²Œ í•´ê²°í•˜ëŠ”ê²Œ ë§ëŠ”ì§€ëŠ” ëª¨ë¥´ê² ìœ¼ë‚˜, ì¼ë‹¨ ìƒê°ë‚˜ëŠ”ê²Œ ì´ê²ƒë°–ì— ì—†ì–´ì„œ ì´ë ‡ê²Œ í•´ê²°í•´ë³´ì•˜ë‹¤. ì¶”í›„ì— ë” ë‚˜ì€ ë°©ë²•ì„ ì•Œê²Œë˜ë©´ ì—…ë°ì´íŠ¸ í•´ì•¼ê² ë‹¤.public class HttpPageProcessor implements Runnable { ... private void init() throws IOException { InputStream inputStream = connection.getInputStream(); OutputStream outputStream = connection.getOutputStream()); ... ê°ì²´ ì´ˆê¸°í™” } @Override public void run() { try { init(); ... ìš”ì²­ì— ë”°ë¼ ì•Œë§ì€ html í˜ì´ì§€ ì‘ë‹µ } catch (Exception e) { ... ì—ëŸ¬ í˜ì´ì§€ ì‘ë‹µ } finally { try { connection.close(); } catch (IOException e) { logger.error(e.getMessage(), e); } } } ...}ì°¸ê³  ìë£Œ https://stackoverflow.com/questions/1388602/do-i-need-to-close-both-filereader-and-bufferedreader" }, { "title": "OOP - ê°ì²´ ì§€í–¥ ì–¸ì–´ì˜ íŠ¹ì§•(ê¸°ëŠ¥ê³¼ ì±…ì„ ë¶„ë¦¬)", "url": "/posts/function-and-responsibility/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "OOP", "date": "2021-09-04 00:29:00 +0900", "snippet": "í•´ë‹¹ ê¸€ì€ ìµœë²”ê·  ë‹˜ì˜ ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì…ë¬¸ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ê¸°ëŠ¥ ê¸°ëŠ¥ì€ í•˜ìœ„ ê¸°ëŠ¥ìœ¼ë¡œ ë¶„í•´ ê°€ëŠ¥í•˜ë‹¤ ê°ê°ì˜ ê¸°ëŠ¥ì„ ëˆ„ê°€ ì œê³µí•  ê²ƒì¸ì§€ ê²°ì •í•˜ëŠ” ê²ƒì´ ê°ì²´ ì§€í–¥ ì„¤ê³„ì˜ ê¸°ë³¸ì´ë‹¤. ê¸°ëŠ¥ì€ ê³§ ì±…ì„ì´ë‹¤. ë”°ë¼ì„œ, ë¶„ë¦¬í•œ ê¸°ëŠ¥ì„ ì•Œë§ê²Œ ë¶„ë°°í•´ì•¼í•œë‹¤.(ì±…ì„ ë¶„ë¦¬) ë¶„ë¦¬í•œ í•˜ìœ„ ê¸°ëŠ¥...", "content": "í•´ë‹¹ ê¸€ì€ ìµœë²”ê·  ë‹˜ì˜ ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì…ë¬¸ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ê¸°ëŠ¥ ê¸°ëŠ¥ì€ í•˜ìœ„ ê¸°ëŠ¥ìœ¼ë¡œ ë¶„í•´ ê°€ëŠ¥í•˜ë‹¤ ê°ê°ì˜ ê¸°ëŠ¥ì„ ëˆ„ê°€ ì œê³µí•  ê²ƒì¸ì§€ ê²°ì •í•˜ëŠ” ê²ƒì´ ê°ì²´ ì§€í–¥ ì„¤ê³„ì˜ ê¸°ë³¸ì´ë‹¤. ê¸°ëŠ¥ì€ ê³§ ì±…ì„ì´ë‹¤. ë”°ë¼ì„œ, ë¶„ë¦¬í•œ ê¸°ëŠ¥ì„ ì•Œë§ê²Œ ë¶„ë°°í•´ì•¼í•œë‹¤.(ì±…ì„ ë¶„ë¦¬) ë¶„ë¦¬í•œ í•˜ìœ„ ê¸°ëŠ¥ì„ í™œìš©í•´ì„œ ì „ì²´ ê¸°ëŠ¥ì„ ì™„ì„±í•œë‹¤. public class ChangePasswordService { public Result changePassword(...) { Member findMem = memberRepository.findById(id); if(findMem==null) ... }} ê¸°ëŠ¥ì„ ë¶„ë¦¬í•˜ì§€ ì•Šìœ¼ë©´ ? í´ë˜ìŠ¤ë‚˜ ë©”ì„œë“œê°€ ì»¤ì§€ë©´ ì ˆì°¨ ì§€í–¥ì˜ ë¬¸ì œê°€ ë°œìƒí•œë‹¤. í° í´ë˜ìŠ¤ì˜ ê²½ìš° ë§ì€ í•„ë“œë¥¼ ë§ì€ ë©”ì„œë“œê°€ ê³µìœ í•˜ê²Œ ëœë‹¤. í° ë©”ì„œë“œì˜ ê²½ìš° ë§ì€ ë³€ìˆ˜ë¥¼ ë§ì€ ì½”ë“œê°€ ê³µìœ í•˜ê²Œ ëœë‹¤. ì´ëŸ° ê²½ìš°, ì—¬ëŸ¬ ê¸°ëŠ¥ì´ í•œ í´ë˜ìŠ¤/ë©”ì„œë“œì— ì„ì—¬ ìˆì„ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. ë”°ë¼ì„œ, ì±…ì„ì— ë”°ë¼ ì½”ë“œë¥¼ ì ì ˆí•˜ê²Œ ë¶„ë¦¬í•´ì•¼ í•œë‹¤.ì±…ì„ ë¶„ë°°/ë¶„ë¦¬ ë°©ë²• ì‚´í´ë³´ê¸° í¬ê²Œ â€˜íŒ¨í„´ ì ìš©â€™, â€˜ê³„ì‚° ê¸°ëŠ¥ ë¶„ë¦¬â€™, â€˜ì™¸ë¶€ ì—°ë™ ë¶„ë¦¬â€™, â€˜ì¡°ê±´ë³„ ë¶„ê¸° ì¶”ìƒí™”â€™ ê´€ì ì—ì„œ ë¶„ë¦¬í•´ ë³¼ ìˆ˜ ìˆë‹¤.1. íŒ¨í„´ ì ìš©(ì „í˜•ì ì¸ ì—­í•  ë¶„ë¦¬) ê°„ë‹¨í•œ ì›¹ - ì»¨íŠ¸ë¡¤ëŸ¬, ì„œë¹„ìŠ¤, DAO ë³µì¡í•œ ë„ë©”ì¸ - ì—”í‹°í‹°, VO, ë¦¬íŒŒì§€í† ë¦¬, ë„ë©”ì¸ ì„œë¹„ìŠ¤ AOP - Aspect(ê³µí†µ ê¸°ëŠ¥) ë””ìì¸ íŒ¨í„´ - íŒ©í† ë¦¬, ë¹Œë”, ì „ëµ, í…œí”Œë¦¿ ë©”ì„œë“œ ë“±2. ê³„ì‚° ê¸°ëŠ¥ ë¶„ë¦¬BeforeMember mem = memberRepository.findOne(id);Product prod = productRepository.findOne(prodId);int payAmount = prod.getPrice() * orderReq.getAmount();double pointRate = 0.01;if(mem.getMembership() == GOLD) { ê³„ì‚° ...} else if(mem.getMembership() == SILVER) { ê³„ì‚° ...}...After í¬ì¸íŠ¸ ê³„ì‚°ì— ëŒ€í•œ ì±…ì„ì€ PointCalculatorì—ê²Œ ë§¡ê¸´ë‹¤. ì´ë¥¼ í†µí•´, í¬ì¸íŠ¸ ê³„ì‚°ì— ëŒ€í•œ ë¶€ë¶„ë§Œ ë”°ë¡œ í…ŒìŠ¤íŠ¸ í•  ìˆ˜ ìˆê²Œëœë‹¤.ì¦‰, ì—­í•  ë¶„ë¦¬ê°€ ì˜ ë˜ë©´ í…ŒìŠ¤íŠ¸ê°€ ìš©ì´í•´ì§€ëŠ” ì¥ì ë„ ì–»ì„ ìˆ˜ ìˆë‹¤.Member mem = memberRepository.findOne(id);Product prod = productRepository.findOne(prodId);int payAmount = prod.getPrice() * orderReq.getAmount();PointCalculator cal = new PointCalculator(...);int point = cal.calculate();...public class PointCalculator { ... public int calculate() { if(membership == GOLD) { ... } ... }}3. ì™¸ë¶€ ì—°ë™ ë¶„ë¦¬ ë„¤íŠ¸ì›Œí¬, ë©”ì‹œì§•, íŒŒì¼ ë“±ì— ëŒ€í•œ ì—°ë™ ì½”ë“œë¥¼ ë¶„ë¦¬í•œë‹¤.BeforeProduct prod = findOne(id);RestTemplate rest = new RestTemplate();List&lt;RecommendItem&gt; recoItems = rest.get(\"http:// ~~?prodId=\"+ prod.getId());After ì˜ë„ê°€ ì˜ ë“œëŸ¬ë‚˜ëŠ” ì´ë¦„ì„ ì‚¬ìš©í•˜ë„ë¡ ì‹ ê²½ì“°ì. ìœ„ì™€ ê°™ì€ ìƒí™©ì—ì„œëŠ” HttpDataService ë³´ë‹¤ RecommendServiceê°€ ë” ì§ê´€ì ì¼ ê²ƒì´ë‹¤.Product prod = findOne(id);RecommendService recoService = new RecommendService();List&lt;RecommendItem&gt; recoItems = recoService.getRecommendItems(prod);4. ì¡°ê±´ë³„ ë¶„ê¸° ì¶”ìƒí™” ì¡°ê±´ë³„ ë¶„ê¸°ê°€ ì‚°ì¬í•´ ìˆëŠ” ê²½ìš°, ì¶”ìƒí™” í•  ìˆ˜ ìˆëŠ”(ê³µí†µì ìœ¼ë¡œ ë¬¶ì„ ìˆ˜ ìˆëŠ”) ë¶€ë¶„ì´ ìˆëŠ”ì§€ ì‚´í´ë³¸ë‹¤.BeforeString fileUrl = \"\";if(fildId.startWith(...)) { fileUrl = ...;} else if(fileId.startWith(...)) { fileUrl = ...;} else if(...) { fileUrl = ...;}After ê³µí†µì ìœ¼ë¡œ ê³„ì† ë‚˜íƒ€ë‚˜ëŠ” urlì„ ì œê³µí•˜ëŠ” ë¶€ë¶„ì„ ë¬¶ëŠ”ë‹¤.String fileUrl = FileInfo.getUrl(fileId);public class FileInfo { public static String getUrl(fileId) { if(fileId.startWith(...)) { ... } ... }}" }, { "title": "OOP - ê°ì²´ ì§€í–¥ ì–¸ì–´ì˜ íŠ¹ì§•(ë‹¤í˜•ì„±ê³¼ ì¶”ìƒí™”)", "url": "/posts/abstraction/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "OOP", "date": "2021-09-01 00:29:00 +0900", "snippet": "í•´ë‹¹ ê¸€ì€ ìµœë²”ê·  ë‹˜ì˜ ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì…ë¬¸ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ë‹¤í˜•ì„±ê³¼ ì¶”ìƒí™”ë‹¤í˜•ì„± (polymorphism) ì—¬ëŸ¬(poly) ëª¨ìŠµ(morph)ì„ ê°–ëŠ” ê²ƒ. ì¦‰, í•œ ê°ì²´ê°€ ì—¬ëŸ¬ íƒ€ì…ì„ ê°–ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì¦‰, í•œ ê°ì²´ê°€ ì—¬ëŸ¬ íƒ€ì…ì˜ ê¸°ëŠ¥ì„ ì œê³µ íƒ€ì… ìƒì†ìœ¼ë¡œ ë‹¤í˜•ì„± êµ¬í˜„ í•˜ìœ„ íƒ€ì…ì€ ìƒìœ„ íƒ€ì…ë„ ë¨ ...", "content": "í•´ë‹¹ ê¸€ì€ ìµœë²”ê·  ë‹˜ì˜ ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì…ë¬¸ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ë‹¤í˜•ì„±ê³¼ ì¶”ìƒí™”ë‹¤í˜•ì„± (polymorphism) ì—¬ëŸ¬(poly) ëª¨ìŠµ(morph)ì„ ê°–ëŠ” ê²ƒ. ì¦‰, í•œ ê°ì²´ê°€ ì—¬ëŸ¬ íƒ€ì…ì„ ê°–ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ì¦‰, í•œ ê°ì²´ê°€ ì—¬ëŸ¬ íƒ€ì…ì˜ ê¸°ëŠ¥ì„ ì œê³µ íƒ€ì… ìƒì†ìœ¼ë¡œ ë‹¤í˜•ì„± êµ¬í˜„ í•˜ìœ„ íƒ€ì…ì€ ìƒìœ„ íƒ€ì…ë„ ë¨ ì•„ë˜ì™€ ê°™ì€ ê´€ê³„ê°€ ìˆë‹¤ê³  ê°€ì •í–ˆì„ ë•Œ, IotTimerëŠ” Timer, Rechargeable íƒ€ì… ëª¨ë‘ë¡œ ì„ ì–¸ë  ìˆ˜ ìˆë‹¤. ì¦‰, ë‹¤ì–‘í•œ íƒ€ì…ì„ ê°–ëŠ”ë‹¤. public class IotTimer extends Timer implements Rechargeable { ...}// ë‹¤í˜•ì„±IotTimer it = new IotTimer();Timer t = it;Rechargeable r = it;ì¶”ìƒí™”(Abstraction) ë°ì´í„°ë‚˜ í”„ë¡œì„¸ìŠ¤ ë“±ì„ ì˜ë¯¸ê°€ ë¹„ìŠ·í•œ ê°œë…ì´ë‚˜ ì˜ë¯¸ ìˆëŠ” í‘œí˜„ìœ¼ë¡œ ì •ì˜í•˜ëŠ” ê³¼ì • ë‘ ê°€ì§€ ë°©ì‹ì˜ ì¶”ìƒí™” íŠ¹ì •í•œ ì„±ì§ˆ ê³µí†µ ì„±ì§ˆ(ì¼ë°˜í™”) ì¶”ìƒí™”ì˜ ê°„ë‹¨í•œ ì˜ˆ ì•„ì´ë””, ì´ë¦„, ë©”ì¼ â†’ DBì˜ USER í…Œì´ë¸” í†µí™”, ê¸ˆì•¡ â†’ Money HP MXX, ì‚¼ì„± SL-M2XX â†’ í”„ë¦°í„° ì§€í¬ìŠ¤ GX - XX, ë¼ë°ì˜¨ RD- XX â†’ GPU SCPë¡œ íŒŒì¼ ì—…ë¡œë“œ, HTTPë¡œ ë°ì´í„° ì „ì†¡, DB í…Œì´ë¸”ì— ì‚½ì… â†’ í‘¸ì‹œ ë°œì†¡ ìš”ì²­ ê³µí†µ ì„±ì§ˆì„ ë½‘ì•„ë‚´ëŠ” ì¶”ìƒí™”ë¥¼ í†µí•´ ë‹¤í˜•ì„±ì´ ì‹¤í˜„ëœë‹¤.íƒ€ì… ì¶”ìƒí™” ì—¬ëŸ¬ êµ¬í˜„ í´ë˜ìŠ¤ë¥¼ ëŒ€í‘œí•˜ëŠ” ìƒìœ„ íƒ€ì… ë„ì¶œ í”íˆ ì¸í„°í˜ì´ìŠ¤ íƒ€ì…ìœ¼ë¡œ ì¶”ìƒí™” ì¶”ìƒí™” íƒ€ì…ê³¼ êµ¬í˜„ì€ íƒ€ì… ìƒì†ìœ¼ë¡œ ì—°ê²° ìƒìœ„íƒ€ì…(ì¸í„°í˜ì´ìŠ¤)ì¸ NotifierëŠ” ê¸°ëŠ¥ì— ëŒ€í•œ ì˜ë¯¸ë¥¼ ì œê³µí•œë‹¤. ì¦‰, êµ¬í˜„ì€ ì œê³µí•˜ì§€ ì•Šê³  í•˜ìœ„ í´ë˜ìŠ¤(concrete í´ë˜ìŠ¤)ì—ê²Œ ë§¡ê¸´ë‹¤. ì¶”ìƒ íƒ€ì… ì¶”ìƒ íƒ€ì…ì€ êµ¬í˜„ì„ ê°ì¶˜ë‹¤. ì¦‰, ê¸°ëŠ¥ì˜ êµ¬í˜„ì´ ì•„ë‹Œ ì˜ë„ë¥¼ ë” ì˜ ë“œëŸ¬ë‚¸ë‹¤. ì¶”ìƒ íƒ€ì…ì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ê²½ìš° ìš”êµ¬ì‚¬í•­ì˜ ë³€ê²½ìœ¼ë¡œ ì¸í•´ ê·¸ì™€ ê´€ë ¨ì—†ëŠ” ì½”ë“œê°€ ë³€ê²½ë  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì•„ë˜ì™€ ê°™ì€ ê²½ìš° ì£¼ë¬¸ ì·¨ì†Œ ìì²´ì™€ëŠ” í¬ê²Œ ìƒê´€ ì—†ëŠ” ìš”êµ¬ ì‚¬í•­ ë³€ê²½(ì·¨ì†Œì‹œ ì´ë©”ì¼ ì „ì†¡, smsì „ì†¡ ë“±)ìœ¼ë¡œ ì¸í•´ ë³¸ì§ˆì ì¸ ì·¨ì†Œ ë©”ì„œë“œì˜ ì½”ë“œê°€ ë³€ê²½ëœë‹¤. ìµœì´ˆ ìš”êµ¬ì‚¬í•­ (ì£¼ë¬¸ ì·¨ì†Œì‹œ sms ë°œì†¡)private SmsSender smsSender;public void cancel(String orderNo) { ... ì£¼ë¬¸ ì·¨ì†Œ ì²˜ë¦¬ smsSender.sendSms(...);} ìš”êµ¬ì‚¬í•­ ë³€ê²½ (ì¹´ì¹´ì˜¤ ì•Œë¦¼, ë©”ì¼ ì•Œë¦¼ ì¶”ê°€)private SmsSender smsSender;private KakaoPush kakaoPush;private MailService mailSvc;public void cancel(String orderNo) { ... ì£¼ë¬¸ ì·¨ì†Œ ì²˜ë¦¬ if(pushEnabled) { kakaoPush.push(...); } else { smsSender.sendSms(...); } mailSvc.sendMail(...);} ì´ëŸ° ê²½ìš° ì¶”ìƒ íƒ€ì…ì„ í™œìš©í•´ ìœ ì—°í•¨ì„ ì œê³µí•  ìˆ˜ ìˆë‹¤. ì•„ë˜ ì˜ˆì‹œëŠ” Notifierì˜ ì½˜í¬ë¦¬íŠ¸ í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ëŠ” ë¶€ë¶„ê¹Œì§€ NotifierFactoryë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ìš©í•´ ì¶”ìƒí™” ì‹œì¼°ë‹¤. public void cancel(String orderNo) { ... ì£¼ë¬¸ ì·¨ì†Œ ì²˜ë¦¬ Notifier notifier = NotifierFactory.instance().getNotifier(...); notifier.notify(...);}public interface NotifierFactory { Notifier getNotifier(...); static NotifierFactory instance() { return new DefaultNotifierFactory(); }}public class DefaultNotifierFactory implements NotifierFactory { public Notifier getNotifier(...) { if(pushEnabled) return new KakaoNotifier(); else return new SmsNotifier(); }}ì¶”ìƒí™”ì˜ ì‹œì  ì•„ì§ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ê¸°ëŠ¥ì— ëŒ€í•œ ì´ë¥¸ ì¶”ìƒí™”ëŠ” ì£¼ì˜í•´ì•¼ í•œë‹¤. ì¶”ìƒí™” â†’ ì¶”ìƒ íƒ€ì… ì¦ê°€ â†’ ë³µì¡ë„ ì¦ê°€ ë”°ë¼ì„œ, ì‹¤ì œ ë³€ê²½ ë° í™•ì¥ì´ ë°œìƒí•  ë–„ ì¶”ìƒí™”ë¥¼ ì‹œë„í•˜ëŠ”ê²Œ ì¢‹ë‹¤.â€» ì¶”ìƒí™” íŒ : êµ¬í˜„ì„ í•œ ì´ìœ ê°€ ë¬´ì—‡ ë•Œë¬¸ì¸ì§€ ì˜ ìƒê°í•´ë³´ê³  ìƒìœ„ íƒ€ì…ì„ ë„ì¶œí•œë‹¤.ëŠë‚€ì  ìº¡ìŠí™”ë‚˜ ì¶”ìƒí™”ì˜ ë³¸ì§ˆì€ ê²°êµ­ â€˜êµ¬ì²´ì ì¸ êµ¬í˜„ì„ í´ë¼ì´ì–¸íŠ¸(í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„)ì—ê²Œ ìˆ¨ê¸´ë‹¤â€™ì¸ ê²ƒ ê°™ë‹¤. ìº¡ìŠí™” : ê°ì²´ê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì˜ ë‚´ë¶€ êµ¬í˜„ì„ ìˆ¨ê¸´ë‹¤. í´ë¼ì´ì–¸íŠ¸ëŠ” ìì‹ ì´ ì‚¬ìš©í•˜ëŠ” íŠ¹ì • ê°ì²´ì˜ ê¸°ëŠ¥ì— ëŒ€í•œ ë‚´ë¶€ êµ¬í˜„ì€ ì•Œì§€ëª»í•˜ê³  í•´ë‹¹ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸°ë§Œ í•œë‹¤. ë”°ë¼ì„œ, í•´ë‹¹ ê°ì²´ì˜ ê¸°ëŠ¥ì˜ ë‚´ë¶€ êµ¬í˜„ì´ ë³€ê²½ë˜ë”ë¼ë„ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œëŠ” ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤. ì¶”ìƒí™” : í´ë¼ì´ì–¸íŠ¸ê°€ ì‚¬ìš©í•˜ê²Œë  êµ¬ì²´ í´ë˜ìŠ¤(ì½˜í¬ë¦¬íŠ¸ í´ë˜ìŠ¤)ë¥¼ ìˆ¨ê¸´ë‹¤. í´ë¼ì´ì–¸íŠ¸ê°€ ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ë©° êµ¬ì²´ í´ë˜ìŠ¤ëŠ” ì™¸ë¶€ì—ì„œ ê°€ì ¸ì˜´ìœ¼ë¡œì¨ ëŸ°íƒ€ì„ì‹œ ì‚¬ìš©í•˜ê²Œë  ê°ì²´ì— ëŒ€í•´ ì•Œ ìˆ˜ ì—†ë‹¤. ë”°ë¼ì„œ, êµ¬ì²´ í´ë˜ìŠ¤ê°€ ë³€ê²½ë˜ë”ë¼ë„ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œëŠ” ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤. ì‹¤ì œë¡œ ì ìš©í•´ë³´ê¸° ì¶”ìƒí™”ë¥¼ í†µí•´ ì—‘ì…€ ìƒì„± ë¡œì§ ë¦¬íŒ©í† ë§í•˜ê¸°ì—°ê´€ í¬ìŠ¤íŒ…-ê°ì²´ ì§€í–¥ ì–¸ì–´ì˜ íŠ¹ì§• - ìº¡ìŠí™”" }, { "title": "OOP - ê°ì²´ ì§€í–¥ ì–¸ì–´ì˜ íŠ¹ì§•(ìº¡ìŠí™”)", "url": "/posts/encapsulation/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "OOP", "date": "2021-08-31 00:29:00 +0900", "snippet": "í•´ë‹¹ ê¸€ì€ ìµœë²”ê·  ë‹˜ì˜ ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì…ë¬¸ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ìº¡ìŠí™” ë°ì´í„° + ê´€ë ¨ëœ ê¸°ëŠ¥ì„ ë¬¶ëŠ” ê²ƒ ê°ì²´ê°€ ê¸°ëŠ¥ì„ ì–´ë–»ê²Œ êµ¬í˜„í–ˆëŠ”ì§€ ì™¸ë¶€ì— ê°ì¶”ëŠ” ê²ƒ êµ¬í˜„ì— ì‚¬ìš©ëœ ë°ì´í„°ì˜ ìƒì„¸ ë‚´ìš©ì„ ì™¸ë¶€ì— ê°ì¶¤ ì •ë³´ ì€ë‹‰ì˜ë¯¸ í¬í•¨ ìº¡ìŠí™”ë¥¼ í•˜ì§€ ì•ŠëŠ” ê²½ìš° ìš”êµ¬ì‚¬í•­ì˜ ë³€ê²½ì´ ë°ì´í„° êµ¬ì¡°/ì‚¬ìš©ì— ë³€í™”ë¥¼ ë°œìƒ...", "content": "í•´ë‹¹ ê¸€ì€ ìµœë²”ê·  ë‹˜ì˜ ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì…ë¬¸ ê°•ì˜ë¥¼ ë“£ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ìº¡ìŠí™” ë°ì´í„° + ê´€ë ¨ëœ ê¸°ëŠ¥ì„ ë¬¶ëŠ” ê²ƒ ê°ì²´ê°€ ê¸°ëŠ¥ì„ ì–´ë–»ê²Œ êµ¬í˜„í–ˆëŠ”ì§€ ì™¸ë¶€ì— ê°ì¶”ëŠ” ê²ƒ êµ¬í˜„ì— ì‚¬ìš©ëœ ë°ì´í„°ì˜ ìƒì„¸ ë‚´ìš©ì„ ì™¸ë¶€ì— ê°ì¶¤ ì •ë³´ ì€ë‹‰ì˜ë¯¸ í¬í•¨ ìº¡ìŠí™”ë¥¼ í•˜ì§€ ì•ŠëŠ” ê²½ìš° ìš”êµ¬ì‚¬í•­ì˜ ë³€ê²½ì´ ë°ì´í„° êµ¬ì¡°/ì‚¬ìš©ì— ë³€í™”ë¥¼ ë°œìƒì‹œí‚´ ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • íšŒì›ì´ ì •íšŒì›ì¸ì§€ ì²´í¬í•´ì„œ íŠ¹ì • ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œê°€ ìˆë‹¤ê³  ê°€ì •í•´ë³´ì.if(account.getMembership() == REGULAR &amp;&amp; account.getExpDate().isAfter(now())) { ... ì •íšŒì› ê¸°ëŠ¥} ë§Œì•½ í•´ë‹¹ ê¸°ëŠ¥ì„ 5ë…„ ì´ìƒ ì‚¬ìš©ìì—ê²Œë„ ì œê³µí•´ë‹¬ë¼ëŠ” ìš”êµ¬ì‚¬í•­ì´ ì¶”ê°€ëœë‹¤ë©´ ì¡°ê±´ë¬¸ì— ë˜ ë‹¤ë¥¸ ì¡°ê±´ì´ ì¶”ê°€ë˜ì–´ì•¼í•œë‹¤. if(account.getMembership() == REGULAR &amp;&amp; ( account.getServiceDate.isAfter(fiveYearsAgo) &amp;&amp; account.getExpDate().isAfter(now()))) { ... ì •íšŒì› ê¸°ëŠ¥} ê²°ê³¼ì ìœ¼ë¡œ, accountì— ëŒ€í•œ ìš”êµ¬ì‚¬í•­ì˜ ë³€í™”ë¡œ ì¸í•´ ê¸°ì¡´ì— ìœ„ì™€ ê°™ì´ ì„ ì–¸ë˜ì–´ ìˆë˜ ëª¨ë“  ë¶€ë¶„ì—ì„œ ì½”ë“œ ìˆ˜ì •ì´ ë°œìƒí•œë‹¤.ìº¡ìŠí™”ë¥¼ í•˜ê²Œë˜ë©´ ? ë‚´ë¶€ êµ¬í˜„ì„ ê°ì¶¤ìœ¼ë¡œì¨ ì™¸ë¶€ì˜ ì˜í–¥(ë³€ê²½)ì„ ìµœì†Œí™” í•˜ë©´ì„œ ê°ì²´ ë‚´ë¶€ êµ¬í˜„ ë³€ê²½ì´ ê°€ëŠ¥í•˜ë‹¤. ì¦‰, ì´ë¥¼ í†µí•´ OCPë¥¼ ì§€í‚¨ ì„¤ê³„ê°€ ê°€ëŠ¥í•˜ë‹¤. ë‹¤ì‹œ ìœ„ ì˜ˆì œë¡œ ì˜ˆë¥¼ ë“¤ë©´ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•  ìˆ˜ ìˆë‹¤. ì¦‰, ê¸°ëŠ¥ì„ ì œê³µí•˜ê³  êµ¬í˜„ ìƒì„¸ë¥¼ ê°ì¶˜ë‹¤. if(account.hasRegularPermission()) { ... ì •íšŒì› ê¸°ëŠ¥} ë§Œì•½ ì •íšŒì› ê´€ë ¨ ìš”êµ¬ì‚¬í•­ì´ ë³€ê²½ë˜ë”ë¼ë„ Accountì˜ hasRegularPermission() ë©”ì„œë“œ ë‚´ë¶€ë§Œ ë³€ê²½í•˜ë©´ ëœë‹¤. hasRegularPermission() ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ë¶€ë¶„ì—ì„œëŠ” ë³€ê²½ë ê²Œ ì—†ë‹¤. (OCP) public class Account { private Membership membership; private Date expDate; public boolean hasRegularPermission() { return account.getMembership() == REGULAR &amp;&amp; expDate.isAfter(now()); }} ë˜í•œ ìº¡ìŠí™”ë¥¼ í†µí•´ ê¸°ëŠ¥ì— ëŒ€í•œ ì˜ë„ë¥¼ ëª…í™•í•˜ê²Œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤. ì¦‰, account.getMembership() == REGULAR &amp;&amp; account.getExpDate().isAfter(now()) ì´ëŸ°ì‹ìœ¼ë¡œ ë‹¨ìˆœíˆ ì¡°ê±´ë§Œ ë‚˜ì—´í•˜ëŠ” ê²ƒ ë³´ë‹¤ëŠ” hasRegularPermission() ë©”ì„œë“œë¥¼ í†µí•´ â€˜ì •íšŒì› ê¶Œí•œì´ ìˆëŠ”ì§€ í™•ì¸í•œë‹¤â€™ë¼ëŠ” ì˜ë„ë¥¼ í›¨ì”¬ ëª…í™•í•˜ê²Œ ë“œëŸ¬ë‚¼ ìˆ˜ ìˆë‹¤. ìº¡ìŠí™”ë¥¼ ìœ„í•œ ê·œì¹™ â€œTell, Donâ€™t Askâ€ : ë°ì´í„°ë¥¼ ë‹¬ë¼ í•˜ì§€ ë§ê³  í•´ë‹¬ë¼ê³  í•˜ê¸° ì¦‰, ì‚¬ìš©í•˜ëŠ” ì…ì¥ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ ë¬´ì–¸ê°€ í•˜ë ¤í•˜ì§€ ë§ê³ , ë°ì´í„°ë¥¼ ê°–ê³ ìˆëŠ” ê°ì²´ì—ê²Œ í•´ë‹¹ ë°ì´í„°ë¡œ ë¬´ì–¸ê°€ í•´ë‹¬ë¼ê³  ìš”ì²­í•´ë¼. accountì˜ membership ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ì„œ ë‚´ê°€ ê²€ì¦í•œë‹¤. (X)if (account.getMembership() == REGULAR) { ... ì •íšŒì› ê¸°ëŠ¥} account ê°ì²´ì—ê²Œ ë§¡ê¸´ë‹¤. (O)if (account.hasRegularPermission()) { ... ì •íšŒì› ê¸°ëŠ¥} Demeterâ€™s Law ë©”ì„œë“œì—ì„œ ìƒì„±í•œ ê°ì²´ì˜ ë©”ì„œë“œë§Œ í˜¸ì¶œ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì€ ê°ì²´ì˜ ë©”ì„œë“œë§Œ í˜¸ì¶œ í•„ë“œë¡œ ì°¸ì¡°í•˜ëŠ” ê°ì²´ì˜ ë©”ì„œë“œë§Œ í˜¸ì¶œì—°ê´€ í¬ìŠ¤íŒ…-ê°ì²´ ì§€í–¥ ì–¸ì–´ì˜ íŠ¹ì§• - ë‹¤í˜•ì„±ê³¼ ì¶”ìƒí™”" }, { "title": "MySQL - ë°ì´í„° ëª¨ë¸ë§", "url": "/posts/data-modeling/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "MySQL", "date": "2021-08-25 23:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„¤ê³„í•  ë•Œ â€˜DB í…Œì´ë¸”ì€ ì–´ë–»ê²Œ êµ¬ì„±í•´ì•¼í•˜ì§€?â€™ ì— ëŒ€í•œ ë§‰ë§‰í•¨ì´ ìˆë‹¤ë©´ ë°ì´í„° ëª¨ë¸ë§ì´ ë¬¸ì œ í•´ê²°ì˜ ì¶œë°œì ì´ë¼ê³  ìƒê°í•œë‹¤. ê³µë¶€ë¥¼ í•˜ê¸°ì— ì•ì„œ ë‚˜ì˜ ì–¸ì–´ë¡œ ì •ë¦¬í•´ë³¸ë‹¤ë©´ ë‚´ê°€ ìƒê°í•˜ê¸°ì— ëª¨ë¸ë§ì´ë¼ëŠ” ê²ƒì€ ë¨¼ì € ë¬¸ì ê·¸ëŒ€ë¡œ â€˜ëª¨ë¸í™”â€™ ì‹œí‚¨ë‹¤ëŠ” ê²ƒì¸ë°, ëª¨ë¸ì´ë€ â€˜ì–´ë–¤ ëŒ€ìƒì„ í•„ìš”í•œ íŠ¹ì§•ë§Œ ì¶”ë ¤ì„œ ë‚˜íƒ€ë‚¸ ê²ƒâ€™ ì´ë¼ëŠ” ìƒê°ì´ ë“ ë‹¤...", "content": "ë“¤ì–´ê°€ê¸° ì „ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì„¤ê³„í•  ë•Œ â€˜DB í…Œì´ë¸”ì€ ì–´ë–»ê²Œ êµ¬ì„±í•´ì•¼í•˜ì§€?â€™ ì— ëŒ€í•œ ë§‰ë§‰í•¨ì´ ìˆë‹¤ë©´ ë°ì´í„° ëª¨ë¸ë§ì´ ë¬¸ì œ í•´ê²°ì˜ ì¶œë°œì ì´ë¼ê³  ìƒê°í•œë‹¤. ê³µë¶€ë¥¼ í•˜ê¸°ì— ì•ì„œ ë‚˜ì˜ ì–¸ì–´ë¡œ ì •ë¦¬í•´ë³¸ë‹¤ë©´ ë‚´ê°€ ìƒê°í•˜ê¸°ì— ëª¨ë¸ë§ì´ë¼ëŠ” ê²ƒì€ ë¨¼ì € ë¬¸ì ê·¸ëŒ€ë¡œ â€˜ëª¨ë¸í™”â€™ ì‹œí‚¨ë‹¤ëŠ” ê²ƒì¸ë°, ëª¨ë¸ì´ë€ â€˜ì–´ë–¤ ëŒ€ìƒì„ í•„ìš”í•œ íŠ¹ì§•ë§Œ ì¶”ë ¤ì„œ ë‚˜íƒ€ë‚¸ ê²ƒâ€™ ì´ë¼ëŠ” ìƒê°ì´ ë“ ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, â€˜ì•„íŒŒíŠ¸ ë‹¨ì§€ ëª¨í˜•â€™ ì´ë¼ê³  í•œë‹¤ë©´ ì•„íŒŒíŠ¸, ë¶€ëŒ€ì‹œì„¤ ë“±ì„ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆì„ ê²ƒì´ë©° ì´ ë•Œ, ì•„íŒŒíŠ¸ ì°½ë¬¸ì˜ ê°œìˆ˜, ì£¼ì°¨ì¥ì˜ ì£¼ì°¨ ê°€ëŠ¥ ëŒ€ìˆ˜, ë‚´ë¶€ ì—˜ë¦¬ë² ì´í„° ë“±ì€ ë¶ˆí•„ìš”í•œ ì •ë³´ì¼ ê²ƒì´ë‹¤.ë‚´ê°€ ìƒê°í•˜ëŠ” ëª¨ë¸ë§ì˜ ì¥ì ìœ¼ë¡œëŠ” í˜„ì‹¤ì˜ ë³µì¡ì„±ì„ ì¶”ìƒí™”ë¥¼ í†µí•´ ë‹¨ìˆœí™” í•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ë‹¨ìˆœí™”í•˜ëŠ”ê²Œ ì–´ë–¤ ì¥ì ì´ ìˆì„ì§€ ë°ì´í„°ë² ì´ìŠ¤ ê´€ì ì—ì„œ ìƒê°í•´ë³´ë©´ ìµœì†Œí•œì˜ ìì›ì„ í™œìš©í•˜ì—¬ ëŒ€ìƒì„ ì €ì¥í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ ìˆì„ ê²ƒ ê°™ë‹¤.ë°ì´í„° ëª¨ë¸ë§ì´ë€ ?ë°ì´í„° ëª¨ë¸ë§(data modeling)ì´ë€ ì£¼ì–´ì§„ ê°œë…ìœ¼ë¡œë¶€í„° ë…¼ë¦¬ì ì¸ ë°ì´í„° ëª¨ë¸ì„ êµ¬ì„±í•˜ëŠ” ì‘ì—…ì„ ë§í•˜ë©°, ì¼ë°˜ì ìœ¼ë¡œ ì´ë¥¼ ë¬¼ë¦¬ì ì¸ ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ë¡œ í™˜ì›í•˜ì—¬ ê³ ê°ì˜ ìš”êµ¬ì— ë”°ë¼ íŠ¹ì • ì •ë³´ ì‹œìŠ¤í…œì˜ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ëŠ” ì‘ì—…ì„ í¬í•¨í•œë‹¤. í›„ìì˜ ì˜ë¯¸ë¡œ í”íˆ â€˜ë°ì´í„°ë² ì´ìŠ¤ ëª¨ë¸ë§â€™ìœ¼ë¡œ ë¶ˆë¦¬ê¸°ë„ í•œë‹¤. ì¶œì²˜ : https://www.trifacta.com/blog/what-is-data-modeling/ ë°ì´í„° ëª¨ë¸ë§ì˜ í•„ìš”ì„± ì´ ê¸€ ì— ë‚˜ì™€ìˆëŠ” ë‚´ìš© ì¤‘ ì¼ë¶€ë¥¼ ì •ë¦¬í•´ë³´ì•˜ë‹¤. â€˜ì•„ ì´ë˜ì„œ ëª¨ë¸ë§ì„ í•´ì•¼í•˜ëŠ”êµ¬ë‚˜â€™ ì •ë„ì˜ ëŠë‚Œë§Œ ê°€ì ¸ê°€ë©´ ë  ê²ƒ ê°™ë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë” ë‚˜ì€ í’ˆì§ˆ í‰ê· ì ìœ¼ë¡œ ì†Œí”„íŠ¸ì›¨ì–´ ê°œë°œ ì‘ì—…ì˜ ì•½ 70%ê°€ ì‹¤íŒ¨í•˜ë©°, ì£¼ìš” ì‹¤íŒ¨ ì›ì¸ì€ ì„£ë¶€ë¥´ê²Œ ì½”ë”©ì„ ì‹œì‘í•˜ëŠ” ê²ƒ ë•Œë¬¸ì´ë‹¤. ë°ì´í„° ëª¨ë¸ì€ ë¬¸ì œë¥¼ ì •ì˜í•˜ëŠ” ë° ë„ì›€ì´ ë˜ë¯€ë¡œ, ì‹¤ì œ ì½”ë“œë¥¼ ì‘ì„±í•˜ê¸° ì „ì— ì´ë¥¼ í†µí•´ ì—¬ëŸ¬ ê°€ì§€ ë¬¸ì œ ì ‘ê·¼ ë°©ë²•ì„ ê³ ë ¤í•´ë³¼ ìˆ˜ ìˆë‹¤. ë¹„ìš© ì ˆê°(ì˜¤ë¥˜ ì¡°ê¸° í¬ì°©) ë°ì´í„° ëª¨ë¸ë§ì€ ì˜¤ë¥˜ì™€ ê°ì‹œë¥¼ ìˆ˜ì •í•˜ê¸° ì‰¬ìš´ ì‹œê¸°ì— ì¡°ê¸°ì— í¬ì°©í•œë‹¤. ì´ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë§Œë“¤ì–´ì§„ í›„ ì˜¤ë¥˜ë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒ ë³´ë‹¤ ë¹„ìš©ì´ ì ê²Œ ë“ ë‹¤. ì†Œí†µì˜ ë„êµ¬ ë°ì´í„° ëª¨ë¸ì„ í†µí•´ ê°œë°œì ë¿ ì•„ë‹ˆë¼ ê¸°íšì ë“± ë‹¤ì–‘í•œ ì´í•´ê´€ê³„ìë“¤ ê°„ì— ì›ë§Œí•œ ì†Œí†µì´ ê°€ëŠ¥í•´ì§„ë‹¤. ì´ë¥¼ í†µí•´, ì• í”Œë¦¬ì¼€ì´ì…˜ì— í¬í•¨ëœ ê²ƒê³¼ ìƒëµëœ ê²ƒì´ ë¬´ì—‡ì¸ì§€ ëŒ€í•´ ì„œë¡œ ê°„ì— ë™ì˜í•˜ëŠ” ë° ë„ì›€ì„ ì¤€ë‹¤. ë” ë‚˜ì€ ì„±ëŠ¥ ìµœì ì˜ ì„±ëŠ¥ì„ ì–»ìœ¼ë ¤ë©´ ë°ì´í„° ëª¨ë¸ì˜ ê°œë…ì´ ëª…í™•í•˜ê³  ì¼ê´€ì„±ì´ ìˆì–´ì•¼ í•œë‹¤. ë˜í•œ, ëª¨ë¸ì„ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„ë¡œ ë³€í™˜í•˜ëŠ” ë° ì ì ˆí•œ ê·œì¹™ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ëª¨ë¸ë§ì€ ë¹ ë¥¸ ì„±ëŠ¥ì„ ìœ„í•´ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¡°ì •í•  ìˆ˜ ìˆë„ë¡ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì´í•´í•˜ëŠ” ìˆ˜ë‹¨ì„ ì œê³µí•œë‹¤. ë¦¬ìŠ¤í¬ ê´€ë¦¬ ë°ì´í„° ëª¨ë¸ì˜ í¬ê¸°ì™€ í…Œì´ë¸” ê°„ì˜ ì—°ê²° ê°•ë„ ë“±ì„ ë°”íƒ•ìœ¼ë¡œ, ì†Œí”„íŠ¸ì›¨ì–´ì˜ ë³µì¡ì„±ì„ ì¶”ì •í•˜ê³  ê°œë°œ ì‘ì—… ë° í”„ë¡œì íŠ¸ ìœ„í—˜ ìˆ˜ì¤€ì— ëŒ€í•œ í†µì°°ë ¥ì„ ì–»ì„ ìˆ˜ ìˆë‹¤. ë°ì´í„° ëª¨ë¸ë§ì„ ìœ„í•œ ìš©ì–´ ëª¨ë¸ë§ì„ í•™ìŠµí•˜ê¸°ì— ì•ì„œ í•„ìš”í•œ ìš©ì–´ì— ëŒ€í•´ ê³µë¶€í•´ë³´ìEntity(ì—”í„°í‹°) ì¼ë°˜ì ìœ¼ë¡œ â€˜í…Œì´ë¸”â€™ì´ë¼ê³  ì¹­í•˜ëŠ” ê°œì²´ì´ë‹¤. í•˜ì§€ë§Œ í•­ìƒ í…Œì´ë¸”ê³¼ 1:1ë¡œ ë§µí•‘ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë©°, 2ê°œ ì´ìƒì˜ ì—”í„°í‹°ê°€ ë¬¼ë¦¬ ëª¨ë¸ë§ ë‹¨ê³„ì—ì„œ í†µí•©ë˜ê¸°ë„ í•˜ê³ , í•˜ë‚˜ì˜ ì—”í„°í‹°ê°€ ì—¬ëŸ¬ ê°œì˜ ë¬¼ë¦¬ì  í…Œì´ë¸”ë¡œ êµ¬í˜„ë˜ê¸°ë„ í•œë‹¤. ì—”í„°í‹°ë¥¼ ë„ì¶œí•  ë•Œ ê°€ì¥ ì¤‘ìš”í•œ ê²ƒì€, í•´ë‹¹ ìš©ì–´ê°€ ì˜ë¯¸í•˜ëŠ” ë²”ìœ„ê°€ ì–´ë””ê¹Œì§€ì¸ì§€ë¥¼ ëª…í™•íˆ í•˜ê³  ê·¸ì— ê±¸ë§ëŠ” ì´ë¦„ì„ ë¶€ì—¬í•˜ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì†ì„±, ì‹ë³„ì, ì—”í„°í‹° ê°„ì˜ ê´€ê³„ê°€ ëª…í™•í•´ì§„ë‹¤. ì—”í„°í‹°ì˜ ì‘ëª… ë§Œì•½ ì—”í„°í‹° ì´ë¦„ì— ìˆ˜ì‹ì–´ê°€ ìˆë‹¤ë©´ ê²€í† í•´ë³´ê³  í•„ìš”í•˜ë‹¤ë©´ í†µí•©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, â€˜ìƒí’ˆâ€™ì„ â€˜ì§ì›ìš©ìƒí’ˆâ€™, â€˜ê³ ê°ìš©ìƒí’ˆâ€™ ë“±ìœ¼ë¡œ ë²”ìœ„ë¥¼ ì œí•œí•´ì„œ ì—¬ëŸ¬ ê°œì˜ ì—”í„°í‹°ë¥¼ ì •ì˜í•˜ëŠ” ê²ƒì€ ì¢‹ì§€ ì•Šë‹¤. â€˜ë¦¬ìŠ¤íŠ¸, â€˜ëª©ë¡â€™ê³¼ ê°™ì€ ë³µìˆ˜í˜• í‘œí˜„ì„ ì§€ì–‘í•œë‹¤. ì´ë¯¸ ì—”í„°í‹° ìì²´ê°€ ë ˆì½”ë“œì˜ ëª©ë¡ì„ ì €ì¥í•˜ëŠ” ê°œì²´ì´ê¸° ë•Œë¬¸ì´ë‹¤. â€˜ì‚¬ì›ì •ë³´â€™ì™€ ê°™ì€ ëª¨í˜¸í•œ ë‹¨ì–´ë³´ë‹¤ëŠ” â€˜ì‚¬ì›â€™ì´ë¼ëŠ” ì¢€ ë” ëª…í™•í•˜ê³  ê°„ê²°í•œ ë²”ìœ„ë¥¼ í•œì •í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.Attribute(ì†ì„±) ë”ëŠ” ë¶„ë¦¬ë  ìˆ˜ ì—†ëŠ” ìµœì†Œì˜ ë°ì´í„° ë³´ê´€ ë‹¨ìœ„.(í…Œì´ë¸”ì˜ ì»¬ëŸ¼ê³¼ ë§µí•‘ëœë‹¤.) ì¦‰, í•˜ë‚˜ì˜ ì—”í„°í‹° ë‚´ì—ì„œ ë‹¤ë¥¸ ì–´íŠ¸ë¦¬ë·°íŠ¸ì™€ ë¹„êµí–ˆì„ ë•Œ, ë…ìì ì¸ ì„±ì§ˆì„ ê°€ì§€ëŠ” ê²ƒì´ì–´ì•¼ í•œë‹¤. ê°€ê³µí•˜ì§€ ì•Šì€ ê·¸ëŒ€ë¡œì˜ ê°’ì´ë¼ëŠ” ì˜ë¯¸ë„ ë‚´í¬í•˜ê³  ìˆë‹¤. ê°€ê³µí•˜ì§€ ì•Šì€ ê²ƒì˜ ë°˜ëŒ€ ì˜ë¯¸ë¡œ â€˜ì¶”ì¶œ ì¹¼ëŸ¼â€™ì´ ìˆë‹¤. ì¶”ì¶œ ì¹¼ëŸ¼ì€ í•˜ë‚˜ì˜ ì—”í„°í‹°ë‚˜ ë‹¤ë¥¸ ì—”í„°í‹°ì˜ ì–´íŠ¸ë¦¬ë·°íŠ¸ë¡œë¶€í„° ê³„ì‚°ëœ ê°’ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ê²Œì‹œë¬¼ì˜ ì½”ë©˜íŠ¸ ê°œìˆ˜, ê²Œì‹œíŒì— ë“±ë¡ëœ ê²Œì‹œë¬¼ì˜ ê°œìˆ˜ ë“±ì´ ìˆë‹¤. Attributeì˜ ì›ìì„± ì–´íŠ¸ë¦¬ë·°íŠ¸ëŠ” ë°˜ë“œì‹œ ë…ìì ì¸ ì„±ì§ˆì„ ê°€ì§€ëŠ” í•˜ë‚˜ì˜ ê°’ë§Œì„ ì €ì¥í•´ì•¼ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ íšŒì›ì˜ ì·¨ë¯¸ ì •ë³´ë¥¼ í•˜ë‚˜ì˜ ì–´íŠ¸ë¦¬ë·°íŠ¸ì— êµ¬ë¶„ìë¥¼ ì‚¬ìš©í•´ì„œ í•œêº¼ë²ˆì— ì €ì¥í•  ë•Œë„ ìˆë‹¤. í•˜ì§€ë§Œ ì´ëŸ¬í•œ ë°©ë²•ì€ ì–´íŠ¸ë¦¬ë·°íŠ¸ì˜ ê¸°ë³¸ ì¡°ê±´ì— ìœ„ë°°ë˜ëŠ” ëª¨ë¸ë§ ë°©ë²•ì´ë©°, ì¶”í›„ ë¬¼ë¦¬ ëª¨ë¸ë§ ë‹¨ê³„ë‚˜ ì¸ë±ìŠ¤ ì„¤ê³„ì— ë‚˜ìœ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆë‹¤. ë¬¼ë¦¬ ëª¨ë¸ ë‹¨ê³„ì—ì„œëŠ” ì„±ëŠ¥ì„ ìœ„í•´ ì–´ëŠì •ë„ ìœ„ë°°í•´ì„œ ì„¤ê³„í•  ìˆ˜ë„ ìˆì§€ë§Œ, ë…¼ë¦¬ ëª¨ë¸ì—ì„œëŠ” ì›ìì„±ì„ ìœ„ë°°í•˜ëŠ” ì–´íŠ¸ë¦¬ë·°íŠ¸ëŠ” ê³ ë ¤í•˜ì§€ ì•ŠëŠ”ê²Œ ì¢‹ë‹¤.ì‹ë³„ì(Primary Key) í•˜ë‚˜ì˜ ì—”í‹°í‹°ì—ì„œ ê°œë³„ ë ˆì½”ë“œë¥¼ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ì–´íŠ¸ë¦¬ë·°íŠ¸ì˜ ì¡°í•© ì¼ë°˜ì ìœ¼ë¡œ ì‹ë³„ìë¡œ ì–´íŠ¸ë¦¬ë·°íŠ¸ í•˜ë‚˜ë¥¼ ê°€ì§ˆ ë•Œê°€ ë§ìœ¼ë©°, ë‘ ê°œ ì´ìƒì˜ ì–´íŠ¸ë¦¬ë·°íŠ¸ê°€ ì¡°í•©ë˜ëŠ” ê²½ìš°ë„ ìˆë‹¤.ì¸ì¡° ì‹ë³„ì(Surrogate Key) ì˜ˆë¥¼ ë“¤ì–´ ê³ ê°, ìƒí’ˆ ì—”í„°í‹°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì£¼ë¬¸ ì—”í„°í‹°ë¥¼ ë§Œë“ ë‹¤ê³  ê°€ì •í•´ë³´ì. ì£¼ë¬¸ ì—”í„°í‹°ì˜ ì‹ë³„ìëŠ” (ê³ ê°ID, ìƒí’ˆì½”ë“œ, ì£¼ë¬¸ì¼ì‹œ)ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆì„ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì£¼ë¬¸ ì—”í„°í‹°ëŠ” ì£¼ë¬¸ ì´ë ¥, ìƒíƒœ ë³€í™” ë“±ê³¼ ê°™ì€ ìˆ˜ë§ì€ ìì‹ ì—”í„°í‹°ë¥¼ ë§Œë“¤ì–´ë‚¼ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. ì£¼ë¬¸ ì—”í„°í‹°ì˜ ì‹ë³„ìê°€ 3ê°œì˜ ì–´íŠ¸ë¦¬ë·°íŠ¸ë¡œ êµ¬ì„±ë˜ê¸° ë•Œë¬¸ì— ìì‹ ì—”í„°í‹°ëŠ” ê·¸ ì´ìƒì˜ ì–´íŠ¸ë¦¬ë·°íŠ¸ë¥¼ ì‚¬ìš©í•´ì•¼ í•  ìˆ˜ë„ ìˆë‹¤. ë”°ë¼ì„œ â€˜ì£¼ë¬¸ë²ˆí˜¸â€™ì™€ ê°™ì€ ì¸ìœ„ì ì¸ ìˆ«ì ê°’ì„ ì‹ë³„ìë¡œ ëŒ€ì²´í•´ì„œ ì‚¬ìš©í•  ë•Œê°€ ë§ë‹¤. ì¸ì¡° ì‹ë³„ìë¥¼ ë„ì…í•œë‹¤ë©´ ë³¸ì§ˆ ì‹ë³„ì(ìœ„ì˜ ê²½ìš° ê³ ê°ID, ìƒí’ˆì½”ë“œ, ì£¼ë¬¸ì¼ì‹œ)ëŠ” ëŒ€ì²´í‚¤(ìœ ë‹ˆí¬ ì¸ë±ìŠ¤)ë¡œ ìƒì„±í•œë‹¤.ìŠˆí¼ í‚¤(Super Key) í•œ ë¦´ë ˆì´ì…˜ ë‚´ì— ìˆëŠ” ì†ì„±ë“¤ì˜ ì§‘í•©ìœ¼ë¡œ êµ¬ì„±ëœ í‚¤. ë¦´ë ˆì´ì…˜ì„ êµ¬ì„±í•˜ëŠ” ëª¨ë“  íŠœí”Œ ì¤‘ ìŠˆí¼í‚¤ë¡œ êµ¬ì„±ëœ ì†ì„±ì˜ ì§‘í•©ê³¼ ë™ì¼í•œ ê°’ì€ ë‚˜íƒ€ë‚´ì§€ ì•ŠëŠ”ë‹¤. ë¦´ë ˆì´ì…˜ì„ êµ¬ì„±í•˜ëŠ” ëª¨ë“  íŠœí”Œì— ëŒ€í•´ ìœ ì¼ì„±(Unique)ì€ ë§Œì¡±í•˜ì§€ë§Œ, ìµœì†Œì„±(Minimality)ì€ ë§Œì¡±í•˜ì§€ ëª»í•œë‹¤.í›„ë³´ í‚¤(Candidate Key) ì—”í„°í‹°ë¥¼ êµ¬ì„±í•˜ëŠ” ì–´íŠ¸ë¦¬ë·°íŠ¸ë“¤ ì¤‘ì—ì„œ ë ˆì½”ë“œë¥¼ ìœ ì¼í•˜ê²Œ ì‹ë³„í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” ì–´íŠ¸ë¦¬ë·°íŠ¸ë“¤ì˜ ë¶€ë¶„ ì§‘í•©. ìœ ì¼ì„±ê³¼ ìµœì†Œì„±ì„ ëª¨ë‘ ë§Œì¡±. ìœ ì¼ì„± : í•˜ë‚˜ì˜ í‚¤ ê°’ìœ¼ë¡œ í•˜ë‚˜ì˜ íŠœí”Œë§Œì„ ìœ ì¼í•˜ê²Œ ì‹ë³„í•  ìˆ˜ ìˆì–´ì•¼í•œë‹¤. ìµœì†Œì„± : í‚¤ë¥¼ êµ¬ì„±í•˜ëŠ” ì†ì„± í•˜ë‚˜ë¥¼ ì œê±°í•˜ë©´ ìœ ì¼í•˜ê²Œ ì‹ë³„í•  ìˆ˜ ì—†ë„ë¡ ê¼­ í•„ìš”í•œ ìµœì†Œì˜ ì†ì„±ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ì•¼ í•œë‹¤. 2ê°œ ì´ìƒì˜ ì–´íŠ¸ë¦¬ë·°íŠ¸ë¥¼ ì¡°í•©í•˜ì—¬ ë§Œë“  í›„ë³´ í‚¤ë¥¼ ë³µí•© í‚¤(Composite Key)ë¼ê³  í•œë‹¤.ëŒ€ì²´ í‚¤(Alternate Key) í›„ë³´ í‚¤ ì¤‘ì—ì„œ ê¸°ë³¸ í‚¤ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ë¥¼ ì˜ë¯¸í•œë‹¤.ì™¸ë˜ í‚¤(Foreign Key) ë‹¤ë¥¸ ì—”í„°í‹°ì˜ ê¸°ë³¸ í‚¤ë¥¼ ì°¸ì¡°í•˜ëŠ” ì†ì„± ë˜ëŠ” ì†ì„±ë“¤ì˜ ì§‘í•©ì„ ì˜ë¯¸í•œë‹¤. ì—”í„°í‹° ê°„ì˜ ê´€ê³„ë¥¼ í‘œí˜„í•  ë•Œ ì‚¬ìš©í•œë‹¤. ì¦‰, ì™¸ë˜í‚¤ëŠ” ë‘ ì—”í„°í‹°ë¥¼ ì„œë¡œ ì—°ê²°í•˜ëŠ” ë° ì‚¬ìš©ë˜ëŠ” í‚¤ì´ë‹¤. ì™¸ë˜í‚¤ê°€ í¬í•¨ëœ í…Œì´ë¸”ì„ ìì‹ í…Œì´ë¸”ì´ë¼ê³  í•˜ê³  ì™¸ë˜í‚¤ ê°’ì„ ì œê³µí•˜ëŠ” í…Œì´ë¸”ì„ ë¶€ëª¨ í…Œì´ë¸”ì´ë¼ê³  í•œë‹¤. ë¶€ëª¨ ì—”í„°í‹°ì˜ ê¸°ë³¸ í‚¤ì™€ ë™ì¼í•œ í‚¤ ì†ì„±ì„ ê°€ì§„ë‹¤. ë¶€ëª¨ í…Œì´ë¸”ì˜ ê¸°ë³¸í‚¤, ê³ ìœ í‚¤ê°€ ì—¬ëŸ¬ê°œì˜ ì»¬ëŸ¼ìœ¼ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤ë©´ ë¶€ëª¨ê°€ ê°€ì§„ ê¸°ë³¸í‚¤, ê³ ìœ í‚¤ ì»¬ëŸ¼ì„ ì›í•˜ëŠ” ê°œìˆ˜ë§Œí¼ ë¬¶ì–´ì„œ ì™¸ë˜í‚¤ë¡œ ì§€ì •í•  ìˆ˜ ìˆë‹¤.ì°¸ê³ . Primary Key vs Unique Key Â  Primary Key Unique Key ìš©ë„ í…Œì´ë¸”ì˜ ê° í–‰ì— ëŒ€í•œ ê³ ìœ  ì‹ë³„ì ì—­í•  ê¸°ë³¸ í‚¤ê°€ ì•„ë‹Œ ê²ƒ ì¤‘ í–‰ì„ ìœ ì¼í•˜ê²Œ ì‹ë³„í•˜ëŠ” ì—­í•  NULL í—ˆìš© ì—¬ë¶€ X O ê°œìˆ˜ ì˜¤ì§ í•œ ê°œ í•œ ê°œ ì´ìƒ ì¸ë±ìŠ¤ clustered index non-clustered index Relation(ê´€ê³„) ì—”í„°í‹° ê°„ì˜ ìƒí˜¸ì‘ìš©ì„ í‘œí˜„í•œ ê²ƒ ê´€ê³„ëŠ” ë‹¤ë¥¸ ì—”í„°í‹°ì˜ ì–´íŠ¸ë¦¬ë·°íŠ¸ë¡œ ì°¸ì—¬í•˜ê¸°ë„ í•˜ì§€ë§Œ ê´€ê³„ ìì²´ê°€ ë³„ë„ì˜ ì—”í„°í‹°ë¡œ êµ¬í˜„ë¼ì•¼ í•  ë•Œë„ ë§ë‹¤.ì‹ë³„, ë¹„ì‹ë³„ ê´€ê³„ ì‹ë³„ ê´€ê³„ ë¶€ëª¨ì˜ ì‹ë³„ìê°€ ìì‹ ì—”í„°í‹°ì˜ ë ˆì½”ë“œë¥¼ ì‹ë³„í•˜ëŠ”ë° ê¼­ í•„ìš”í•œ ê´€ê³„ ê²Œì‹œíŒê³¼ ê²Œì‹œë¬¼ì˜ ê´€ê³„ë¥¼ ë³´ë©´, ê²Œì‹œë¬¼ì˜ ê²½ìš° ë¶€ëª¨ ì—”í„°í‹°ì¸ ê²Œì‹œíŒì˜ ì‹ë³„ì ê²Œì‹œíŒIDê°€ ê²Œì‹œë¬¼ì˜ ì‹ë³„ìë¡œ ë°˜ë“œì‹œ í¬í•¨ë˜ì–´ì•¼ í•œë‹¤. ë¹„ì‹ë³„ ê´€ê³„ ë¶€ëª¨ ì—”í„°í‹°ì˜ ì‹ë³„ìê°€ ì—†ì–´ë„ ìì‹ ì—”í„°í‹°ì˜ ë ˆì½”ë“œê°€ ìƒì„± ê°€ëŠ¥í•œ ê´€ê³„ íšŒì›ê³¼ ê²Œì‹œë¬¼ì˜ ê´€ê³„ë¥¼ ë³´ë©´, ê²Œì‹œë¬¼ì˜ ê²½ìš° ê²Œì‹œë¬¼IDë§Œ ìˆìœ¼ë©´ ë ˆì½”ë“œ ìƒì„±ì´ ê°€ëŠ¥í•˜ê³  ë¶€ëª¨ ì—”í„°í‹°ì˜ ì‹ë³„ìì¸ íšŒì›IDëŠ” ì™¸ë˜í‚¤ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤. Cardinality(ê¸°ìˆ˜ì„±) ë¶€ëª¨ ì—”í„°í‹°ì˜ ë ˆì½”ë“œ í•˜ë‚˜ì— ëŒ€í•´ ìì‹ ì—”í„°í‹°ì˜ ë ˆì½”ë“œê°€ ì–¼ë§ˆë‚˜ ë§Œë“¤ì–´ì§ˆ ìˆ˜ ìˆëŠ”ì§€(ë°œìƒ ë¹ˆë„)ë¥¼ ì˜ë¯¸í•œë‹¤. ì£¼ë¡œ 0 ë˜ëŠ” 1, 1ê±´ ì´ìƒ(N ë˜ëŠ” M)ì˜ ìˆ˜ì¤€ìœ¼ë¡œ êµ¬ë¶„í•´ì„œ í‘œì‹œí•œë‹¤. ì¶œì²˜ : https://www.lucidchart.com/pages/ER-diagram-symbols-and-meaning ë‹¤ëŒ€ë‹¤(M:M) ê´€ê³„ ì–´íŠ¸ë¦¬ë·°íŠ¸ëŠ” í•˜ë‚˜ ì´ìƒì˜ ê°’ì„ ê°€ì§€ì§€ ëª»í•˜ë¯€ë¡œ M:M ê´€ê³„ë¥¼ 1:Mê³¼ ê°™ì´ ì–´íŠ¸ë¦¬ë·°íŠ¸ë¡œ í‘œí˜„í•  ìˆ˜ëŠ” ì—†ë‹¤. ë…¼ë¦¬ ëª¨ë¸ì—ì„œëŠ” M:M ê´€ê³„ë¥¼ í‘œê¸°í•˜ê¸°ë„ í•˜ì§€ë§Œ, ë¬¼ë¦¬ ëª¨ë¸ì—ì„œëŠ” M:M ê´€ê³„ë¥¼ ìœ„í•œ í‘œê¸°ë²•ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤. M:M ê´€ê³„ëŠ” ë¬¼ë¦¬ ëª¨ë¸ë¡œ ë„˜ì–´ ì˜¤ë©´ì„œ ë‹¤ìŒê³¼ ê°™ì´ ë‘ ê°œì˜ 1:M ê´€ê³„ë¡œ í’€ì–´ì¤˜ì•¼í•œë‹¤. ì´ë¥¼ â€˜M:M ê´€ê³„ í•´ì†Œâ€™ë¼ê³  í•œë‹¤. ê¼­ ë¬¼ë¦¬ ëª¨ë¸ì´ ì•„ë‹ˆê³  ë…¼ë¦¬ ëª¨ë¸ì—ì„œ ì„ í–‰ë  ìˆ˜ë„ ìˆë‹¤. â€˜ìˆ˜ê°•â€™ì€ ì–´ë– í•œ ì—”í„°í‹°ê°€ ì•„ë‹ˆë¼ í•™ìƒê³¼ ê³¼ëª© ê°„ì˜ â€˜ê´€ê³„â€™ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê²ƒì´ë‹¤. í•˜ì§€ë§Œ RDBì˜ êµ¬ì¡°ì  í•œê³„ë¡œ ì´ë¥¼ ìˆ˜ê°•ì´ë¼ëŠ” ì—”í„°í‹°ë¡œ ë³€í™˜í•œ ê²ƒì´ë‹¤. ì´ì²˜ëŸ¼ ê´€ê³„ë¥¼ ì €ì¥í•˜ëŠ” ì—”í„°í‹°ë¥¼ ê´€ê³„ ì—”í„°í‹°(í…Œì´ë¸”)ë¼ê³ ë„ í•œë‹¤. ë°ì´í„° ëª¨ë¸ë§ ë°©ë²• ì¼ë°˜ì ìœ¼ë¡œ ì—…ë¬´ ìš”ê±´ ì •ì˜ â†’ ê°œë… ëª¨ë¸ë§ â†’ ë…¼ë¦¬ ëª¨ë¸ë§ â†’ ë¬¼ë¦¬ ëª¨ë¸ë§ ìˆœì„œë¡œ ì§„í–‰ëœë‹¤.ê°œë… ëª¨ë¸ë§ ì •ì˜ëœ ì—…ë¬´ ìš”ê±´ì„ ê¸°ë°˜ìœ¼ë¡œ ë‹¤ìŒì„ ë„ì¶œí•œë‹¤. Entity Attribute ì‹ë³„ì(Identifier), ì§€ì • í›„ë³´í‚¤(candidate key), ê¸°ë³¸í‚¤(primary key), ëŒ€ì²´í‚¤(alternate key), ì¤‘ë³µí‚¤(composite key) ì‹ë³„ìê°€ ë ë§Œí•œ ì–´íŠ¸ë¦¬ë·°íŠ¸ê°€ ì—†ë‹¤ë©´ ì¸ì¡°í‚¤ ìƒì„± Entityê°„ì˜ ê´€ê³„ ì •ì˜(PKì™€ FK ì—°ê²°, Cardinality &amp; Optionality) ê° ì—”í„°í‹° ê°„ì˜ ê´€ê³„ë¥¼ ìµœëŒ€í•œ ê°„ê²°í•˜ê²Œ í‘œí˜„í•´ì•¼ í•œë‹¤. ERD(E-R Diagram)ì˜ ìƒëª…ì€ ê°€ë…ì„±ì´ë‹¤. ì¶œì²˜ : https://bitnine.tistory.com/446 ë…¼ë¦¬ ëª¨ë¸ë§ ê°œë…ì  ëª¨ë¸ë§ ëœ ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ íŒ¨ëŸ¬ë‹¤ì„ì— ì–´ìš¸ë¦¬ê²Œ ë°ì´í„°ë¥¼ ì •ë¦¬í•˜ëŠ” ê²ƒ ERDë¿ë§Œ ì•„ë‹ˆë¼ ì‹œìŠ¤í…œ êµ¬ì¶•ì„ ìœ„í•œ ì‚¬í•­ì„ ëª¨ë‘ ì •ì˜í•œë‹¤. ë˜í•œ, ì •ê·œí™”ë¥¼ í†µí•´ ë…¼ë¦¬ ë°ì´í„° ëª¨ë¸ì„ ìƒì„¸í™”í•˜ì—¬ ì¼ê´€ì„±ì„ í™•ë³´í•˜ê³  ì¤‘ë³µì„ ì œê±°í•œë‹¤. ê°œë… ëª¨ë¸ ë…¼ë¦¬ ëª¨ë¸ Entity Table Attribute Column Relation PK, FK ì¶œì²˜ : https://bitnine.tistory.com/446 ë¬¼ë¦¬ ëª¨ë¸ë§ ë…¼ë¦¬ì  ëª¨ë¸ë§ì—ì„œ ë„ì¶œëœ ì´ìƒì ì¸ í‘œë¥¼ ì‹¤ì œ RDBMSì— ë§ê²Œ ë³€í™˜í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤. M:M ê´€ê³„ ê°™ì´ RDBì—ì„œ êµ¬í˜„í•  ìˆ˜ ì—†ëŠ” êµ¬ì¡°ë¥¼ í•´ì†Œí•˜ëŠ” ì‘ì—… í”„ë¼ì´ë¨¸ë¦¬ í‚¤ì˜ ì»¬ëŸ¼ ìˆœì„œ ì„ ì • ì»¬ëŸ¼ì˜ ì´ë¦„ ë¶€ì—¬ ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì… ì´ ë‹¨ê³„ì—ì„œ ì¤‘ìš”í•œ ê²ƒì€ â€˜ì„±ëŠ¥â€™ì´ë‹¤. ìŠ¬ë¡œìš° ì¿¼ë¦¬ ì°¾ê¸°, ì¸ë±ìŠ¤, ë°˜ì •ê·œí™” ë“± í”„ë¼ì´ë¨¸ë¦¬ í‚¤ ìˆœì„œ ë¬¼ë¦¬ ëª¨ë¸ì—ì„œëŠ” í”„ë¼ì´ë¨¸ë¦¬ í‚¤ë¥¼ êµ¬ì„±í•˜ëŠ” ì»¬ëŸ¼ì˜ ìˆœì„œê°€ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤. í”„ë¼ì´ë¨¸ë¦¬ í‚¤ë„ í•˜ë‚˜ì˜ ì¸ë±ìŠ¤ë¡œì¨ ì‚¬ìš©ë˜ë¯€ë¡œ ë°˜ë“œì‹œ SELECTì˜ ì¡°ê±´ ì ˆì— ìì£¼ ì‚¬ìš©ë˜ëŠ” ì»¬ëŸ¼ ìœ„ì£¼ë¡œ ìˆœì„œë¥¼ ë°°ì¹˜í•´ì•¼ í•œë‹¤.ë°ì´í„° íƒ€ì… ì„ ì • ë¬¸ì, ìˆ«ì, ë‚ ì§œ, ì´ì§„ ë°ì´í„° ë“± ì—¬ëŸ¬ í˜•íƒœë¥¼ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ë°ì´í„°ì˜ íƒ€ì…ì€ ì–´ë–»ê²Œ ê²°ì •í•´ì•¼ í• ê¹Œ? ëŒ€í‘œì ì¸ ì˜ˆë¡œ IP ì£¼ì†Œë¥¼ ìƒê°í•´ë³¼ ìˆ˜ ìˆë‹¤. IP ì£¼ì†Œ ì •ë³´ëŠ” ì»´í“¨í„° ë‚´ë¶€ì ìœ¼ë¡œëŠ” ìˆ«ì(ë¶€í˜¸ ì—†ëŠ” 4ë°”ì´íŠ¸ ì •ìˆ˜)ë¡œ ì²˜ë¦¬í•˜ì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œëŠ” 4ê°œì˜ ìˆ«ì ì˜ì—­ìœ¼ë¡œ êµ¬ë¶„ëœ ë¬¸ìì—´ë¡œ í†µìš©ë˜ê³  ìˆë‹¤. 255.255.255.255 âŸ· 0xffffffff âŸ· 11111111 11111111 11111111 11111111 ë”°ë¼ì„œ, IP ì£¼ì†Œë¥¼ ì €ì¥í•˜ê¸° ìœ„í•œ ì»¬ëŸ¼ì˜ ë°ì´í„° íƒ€ì…ì„ ë¬¸ì íƒ€ì…ìœ¼ë¡œ í• ì§€ ìˆ«ì íƒ€ì…ìœ¼ë¡œ í• ì§€ ê³ ë¯¼í•˜ê²Œ ëœë‹¤. í¸ì˜ì„±ê³¼ ì„±ëŠ¥, ë ˆì½”ë“œ ê±´ìˆ˜ ë“±ì„ ë”°ì ¸ì„œ ì ì ˆí•œ ë°©ë²•ì„ ì„ íƒí•´ì•¼ í•œë‹¤. ë˜í•œ, ì—…ë¬´ì ì¸ ìš©ë„ë¥¼ ë¶„ì„í•˜ì—¬ ì¥ë‹¨ì ì„ ì¡°ìœ¨í•œ í›„ì— ì‚¬ìš©í•´ì•¼ í•œë‹¤. ë§Œì•½ 4ë°”ì´íŠ¸ ì •ìˆ˜ë¡œ IP ì£¼ì†Œë¥¼ ì €ì¥í•œë‹¤ê³  í–ˆì„ ë•Œ ë‹¤ìŒê³¼ ê°™ì€ íŠ¸ë ˆì´ë“œ ì˜¤í”„ë¥¼ ê³ ë ¤í•´ ë³¼ ìˆ˜ ìˆë‹¤. ì¥ì  ì»¬ëŸ¼ì˜ ê¸¸ì´ê°€ 15 ê¸€ìì—ì„œ 4ë°”ì´íŠ¸ë¡œ ì¤„ì–´ë“¦ ì»¬ëŸ¼ì˜ ê¸¸ì´ ì¶•ì†Œë¡œ ì„±ëŠ¥ í–¥ìƒì´ ê¸°ëŒ€ë¨ IP ì£¼ì†Œë¥¼ A,B,C ë“±ê³¼ ê°™ì€ ëŒ€ì—­ë³„ë¡œ ê²€ìƒ‰ ê°€ëŠ¥ ë‹¨ì  ê°’ì„ ì €ì¥í•˜ê±°ë‚˜ ì¡°íšŒí•  ë•Œ INET_NTOA() ë˜ëŠ” INET_ATON() í•¨ìˆ˜ì˜ ë„ì›€ì´ í•„ìš” ë‹¨ìˆœí•œ ë¬¸ìì—´ íŒ¨í„´ ê²€ìƒ‰(LIKE)ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŒ ë¬¸ìì§‘í•©(ìºë¦­í„° ì…‹) ë¬¸ìì§‘í•©ì— ë”°ë¼ ì €ì¥ ê³µê°„ì˜ ê¸¸ì´ê°€ 2~3ë°°ì”© ëŠ˜ì–´ë‚  ìˆ˜ë„ ìˆê³ , ì •ë ¬ì´ë‚˜ ê²€ìƒ‰ ê·œì¹™ë„ ë°”ë€” ìˆ˜ ìˆë‹¤. í•˜ë‚˜ì˜ DBì—ì„œ ë¬¸ìì§‘í•©ì„ í˜¼ìš©í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ì¢‹ë‹¤ëŠ” ì˜ê²¬ê³¼ ëª…í™•í•œ ê¸°ì¤€ë§Œ ìˆë‹¤ë©´ 2ê°œ ì •ë„ëŠ” í˜¼ìš©í•´ë„ ë¬´ë°©í•˜ë‹¤ëŠ” ì˜ê²¬ë„ ìˆë‹¤. ì œëŒ€ë¡œ ë¬¸ìì§‘í•© ê´€ë¦¬ê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì¿¼ë¦¬ì˜ ì„±ëŠ¥ë§Œ ë–¨ì–´ëœ¨ë¦¬ê²Œ ë  ìˆ˜ë„ ìˆë‹¤. MySQLì—ì„œëŠ” ì •ë ¬ì´ë‚˜ ê·¸ë£¹í•‘ê³¼ ê°™ì€ ì„ì‹œ í…Œì´ë¸” ë˜ëŠ” ë²„í¼ ì‘ì—…ì„ ìœ„í•´ ë³„ë„ì˜ ë©”ëª¨ë¦¬ í• ë‹¹ì´ í•„ìš”í•˜ë‹¤. ì´ë•Œ MySQL ì„œë²„ëŠ” ë°ì´í„° íƒ€ì…ì— ëª…ì‹œëœ ê¸¸ì´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë©”ëª¨ë¦¬ ê³µê°„ì„ í• ë‹¹í•˜ê³  ì‚¬ìš©í•œë‹¤. ë§Œì•½ í•´ë‹¹ ë©”ëª¨ë¦¬ ê³µê°„ì´ ì¼ì • í¬ê¸° ì´ìƒì„ ì´ˆê³¼í•˜ë©´ ë©”ëª¨ë¦¬ê°€ ì•„ë‹Œ ë””ìŠ¤í¬ì—ì„œ ì²˜ë¦¬í•˜ê²Œ ëœë‹¤. ì¦‰, ì»¬ëŸ¼ì´ ê³¼ë„í•˜ê²Œ í¬ê²Œ ì„¤ì •ë˜ë©´ ë©”ëª¨ë¦¬ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì´ ë””ìŠ¤í¬ì—ì„œ ì²˜ë¦¬ë  ê°€ëŠ¥ì„±ì´ ë†’ì•„ì§„ë‹¤. NULLê³¼ NOT NULL NULLê³¼ NOT NULLì˜ ì„ íƒì€ ì˜µí‹°ë§ˆì´ì €ê°€ ì–¼ë§ˆë‚˜ ì¿¼ë¦¬ë¥¼ ë” ìµœì í™”í•  ìˆ˜ ìˆê²Œ í™˜ê²½ì„ ë§Œë“¤ì–´ì¤„ ê²ƒì´ëƒì˜ ê´€ì ì—ì„œ ê³ ë ¤í•´ì•¼ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, NULLì´ ì €ì¥ë  ìˆ˜ ìˆëŠ” ì»¬ëŸ¼ì— ëŒ€í•´ IN í˜•íƒœì˜ ì¡°ê±´ì„ ì‚¬ìš©í•˜ë©´ MySQLì€ ìƒìƒí•˜ì§€ ëª»í–ˆë˜ ì´ìƒí•œ ë¹„êµ ì‘ì—…ì„ ë‚´ë¶€ì ìœ¼ë¡œ í•˜ê²Œ ëœë‹¤.ì •ê·œí™”(Normalization) ì •ì œë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì— ì–´ìš¸ë¦¬ëŠ” ë°ì´í„°ë¡œ ë§Œë“œëŠ” ì‘ì—…. ì¦‰, ë°ì´í„°ì˜ ì¤‘ë³µì„ ìµœì†Œí™”í•˜ì—¬ íš¨ìœ¨ì ì¸ ëª¨ë¸ì„ ë§Œë“ ë‹¤.ë…¼ë¦¬ ëª¨ë¸ë§ì—ì„œì˜ ì •ê·œí™”ëŠ” ë°ì´í„° ì €ì¥ ë¹„ìš©ì„ ìµœì†Œí™”í•˜ê³ , ë¬¼ë¦¬ ëª¨ë¸ë§ì—ì„œì˜ ë°˜ì •ê·œí™”ëŠ” ë°ì´í„°ë¥¼ ì½ì–´ ì˜¤ëŠ” ë¹„ìš©ì„ ìµœì†Œí™”í•œë‹¤.ì¼ë°˜ì ìœ¼ë¡œëŠ” 3NF(ì œ 3ì •ê·œí™”)ê¹Œì§€ ì‚¬ìš©í•œë‹¤.ì œ 1ì •ê·œí™”(No Repeating Group) ëª¨ë“  ì†ì„±ì€ ë°˜ë“œì‹œ í•˜ë‚˜ì˜ ê°’ì„ ê°€ì ¸ì•¼ í•œë‹¤.ì œ 2ì •ê·œí™”(Whole Key Dependent) ë°ì´í„°ì˜ ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•´ ë¶€ë¶„ì ìœ¼ë¡œ ì¢…ì†ë˜ëŠ” ì»¬ëŸ¼ë“¤ì„ ëª¨ìœ¼ê³  ì „ì²´ì ìœ¼ë¡œ ì¢…ì†ë˜ëŠ” ì»¬ëŸ¼ì€ ë‚˜ëˆˆë‹¤.ì œ 3ì •ê·œí™”(Non-Key Independent) ì‹ë³„ì ì´ì™¸ì˜ ì†ì„±ê°„ì— ì¢…ì† ê´€ê³„ê°€ ì¡´ì¬í•˜ë©´ ì•ˆëœë‹¤.ë°˜ì •ê·œí™”(Denormalization) ëª¨ë¸ì„ ì •ê·œí™”í• ìˆ˜ë¡ SELECT ì¿¼ë¦¬ì—ì„œ í•„ìš”í•œ í…Œì´ë¸”ì˜ ìˆ˜ ë¿ë§Œ ì•„ë‹ˆë¼ GROUP BYë‚˜ ì¿¼ë¦¬ ìì²´ì˜ ê°œìˆ˜ë„ ì¦ê°€í•œë‹¤.ë”°ë¼ì„œ, í•„ìš”í•œ ê²½ìš° ë°˜ì •ê·œí™”ë¥¼ í†µí•´ ë°ì´í„°ë¥¼ ì½ì–´ ì˜¤ëŠ” ë¹„ìš©ì„ ìµœì†Œí™”í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•´ë´ì•¼ í•œë‹¤.ë°˜ì •ê·œí™”ëŠ” ì •ê·œí™”ì²˜ëŸ¼ ì—„ê²©í•˜ê²Œ ì •í•´ì§„ ê·œì¹™ë“¤ì´ ìˆëŠ” ê²ƒì€ ì•„ë‹ˆë©°,ë°˜ì •ê·œí™” ì‹œ ì–»ëŠ” ê²ƒ(ì„±ëŠ¥ì  ì´ì )ê³¼ ìƒëŠ” ê²ƒ(ë°ì´í„° ì¤‘ë³µ ë“±)ì´ ë¶„ëª…í•˜ë¯€ë¡œ trade-offë¥¼ ì˜ ë”°ì ¸ì•¼í•œë‹¤.1. JOIN ì¤„ì´ê¸° ì´ ê³¼ì •ì„ ê±°ì¹˜ë©´ ê²°êµ­ ì •ê·œí™” ë˜ê¸° ì „ ìƒíƒœ(ë°ì´í„° ì¤‘ë³µ)ê°€ ë˜ëŠ” ê²ƒì´ë‹¤. ì¦‰, ì„±ëŠ¥ì ìœ¼ë¡œ ê°œì„ í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì´ ì´ê²ƒë°–ì— ì—†ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” ìµœí›„ì˜ ìˆ˜ë‹¨ 2. ê³„ì‚° ì‘ì—… ì¤„ì´ê¸° ì•„ë˜ ì˜ˆì˜ ê²½ìš° GROUP BYë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ë„ ì €ìê°€ ëª‡ ê°œì˜ topicì„ ì‘ì„±í–ˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆë‹¤.3. ì»¬ëŸ¼ì„ ê¸°ì¤€ìœ¼ë¡œ í…Œì´ë¸” ë¶„ë¦¬í•˜ê¸° ì•„ë˜ ì˜ˆì˜ ê²½ìš° descriptionì˜ í¬ê¸°ê°€ ë§¤ìš° í¬ê³  descriptonì„ ë”°ë¡œ ì¡°íšŒí•˜ëŠ” ê²½ìš°ë„ ë§ë‹¤ë©´ í…Œì´ë¸”ì„ ë¶„ë¦¬í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•´ ë³¼ ìˆ˜ ìˆë‹¤.4. í–‰ì„ ê¸°ì¤€ìœ¼ë¡œ í…Œì´ë¸” ë¶„ë¦¬í•˜ê¸° ê°ê°ì˜ í–‰ì„ ë‹¤ë¥¸ DB ì„œë²„ì— ë¶„ì‚°í•˜ì—¬ ì €ì¥í•  ìˆ˜ ìˆë‹¤. ì „ì²´ì ì¸ ë°ì´í„°ì˜ ê´€ë¦¬ê°€ ë§¤ìš° ì–´ë ¤ìš¸ ìˆ˜ ìˆë‹¤.ì°¸ê³  ìë£Œ https://www.linkedin.com/pulse/why-data-modelling-important-munish-goswami ìƒí™œì½”ë”© - ê´€ê³„í˜• ë°ì´í„° ëª¨ë¸ë§ https://bitnine.tistory.com/446 https://moonibot.tistory.com/61" }, { "title": "MySQL - íŠ¸ëœì­ì…˜ê³¼ ê²©ë¦¬ ìˆ˜ì¤€", "url": "/posts/transaction-and-isolation-level/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "MySQL", "date": "2021-08-24 23:00:00 +0900", "snippet": "íŠ¸ëœì­ì…˜ê³¼ ACID íŠ¸ëœì­ì…˜ì´ë€ ? ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœë¥¼ ë³€ê²½ì‹œí‚¤ëŠ” ì¼ë ¨ì˜ ì—°ì‚°ë“¤ì„ ë…¼ë¦¬ì ìœ¼ë¡œ ë¬¶ì„ ìˆ˜ ìˆëŠ” í•˜ë‚˜ì˜ ì‘ì—… ë‹¨ìœ„ ex) ì£¼ë¬¸ - ê²°ì œ - ê²°ì œ ìŠ¹ì¸ - ì£¼ë¬¸ ì ‘ìˆ˜ íŠ¸ëœì­ì…˜ì—ëŠ” ì¤‘ìš”í•œ ë‘ ê°€ì§€ ëª©ì ì´ ìˆë‹¤. ì¥ì• ë¡œë¶€í„° ì˜¬ë°”ë¥´ê²Œ ë³µ...", "content": "íŠ¸ëœì­ì…˜ê³¼ ACID íŠ¸ëœì­ì…˜ì´ë€ ? ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœë¥¼ ë³€ê²½ì‹œí‚¤ëŠ” ì¼ë ¨ì˜ ì—°ì‚°ë“¤ì„ ë…¼ë¦¬ì ìœ¼ë¡œ ë¬¶ì„ ìˆ˜ ìˆëŠ” í•˜ë‚˜ì˜ ì‘ì—… ë‹¨ìœ„ ex) ì£¼ë¬¸ - ê²°ì œ - ê²°ì œ ìŠ¹ì¸ - ì£¼ë¬¸ ì ‘ìˆ˜ íŠ¸ëœì­ì…˜ì—ëŠ” ì¤‘ìš”í•œ ë‘ ê°€ì§€ ëª©ì ì´ ìˆë‹¤. ì¥ì• ë¡œë¶€í„° ì˜¬ë°”ë¥´ê²Œ ë³µêµ¬í•˜ê³  ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì¼ê´€ë˜ê²Œ ìœ ì§€í•  ìˆ˜ ìˆëŠ” ì•ˆì •ì ì¸ ì‘ì—… ë‹¨ìœ„ë¥¼ ì œê³µ ë™ì‹œì— ë°ì´í„°ë² ì´ìŠ¤ì— ì•¡ì„¸ìŠ¤í•˜ëŠ” í”„ë¡œê·¸ë¨ ê°„ì˜ ê²©ë¦¬ ì œê³µ ACID DBMSëŠ” ê°ê°ì˜ íŠ¸ëœì­ì…˜ì— ëŒ€í•´ ë‹¤ìŒ 4ê°€ì§€ íŠ¹ì§•ì„ ë³´ì¥í•œë‹¤.íŠ¸ëœì­ì…˜ì˜ ì´ëŸ¬í•œ íŠ¹ì§•ì€ ë°ì´í„° ì •í•©ì„±ì„ ë³´ì¥í•´ì¤€ë‹¤. Atomicity(ì›ìì„±) íŠ¸ëœì­ì…˜ì´ í•œ ë²ˆì— ì´ë£¨ì–´ì§€ê±°ë‚˜ ì „í˜€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ, ë³€ê²½ì´ ë¶€ë¶„ì ìœ¼ë¡œ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. ë‹¤ìŒ ë‘ ê°€ì§€ ì‘ì—…ì„ í¬í•¨í•œë‹¤. ì¤‘ë‹¨(abort): íŠ¸ëœì­ì…˜ì´ ì¤‘ë‹¨ë˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì˜ ë³€ê²½ ë‚´ìš©ì´ ë°˜ì˜ë˜ì§€ ì•ŠëŠ”ë‹¤. ì»¤ë°‹(commit): íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹í•˜ë©´ ë³€ê²½ ë‚´ìš©ì´ ë°˜ì˜ëœë‹¤. ì›ìì„±ì€ â€˜All or nothing ruleâ€™ì´ë¼ê³ ë„ í•œë‹¤. Consistency(ì¼ê´€ì„±) íŠ¸ëœì­ì…˜ ì „í›„ì— ë°ì´í„°ë² ì´ìŠ¤ê°€ ì¼ê´€ë˜ë„ë¡ ë¬´ê²°ì„±(ë°ì´í„°ì˜ ì¼ê´€ì„±, ìœ íš¨ì„±)ì´ ìœ ì§€ë˜ì–´ì•¼ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ Aê°€ Bì—ê²Œ ì†¡ê¸ˆí•˜ëŠ” ìƒí™©ì´ë¼ë©´, ê±°ë˜ ì „í›„ì˜ ë‘ ì‚¬ëŒì´ ê°–ê³  ìˆëŠ” ê¸ˆì•¡ì˜ ì´í•©ì€ ë™ì¼í•´ì•¼ í•œë‹¤. Isolation(ê³ ë¦½ì„±) ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì€ ì„œë¡œ ê°„ì˜ ê°„ì„­ ì—†ì´ ë…ë¦½ì ìœ¼ë¡œ ë°œìƒí•´ì•¼ í•œë‹¤. ì¦‰, íŠ¹ì • íŠ¸ëœì­ì…˜ì—ì„œ ë°œìƒí•˜ëŠ” ë³€ê²½ ì‚¬í•­ì€ í•´ë‹¹ íŠ¸ëœì­ì…˜ì˜ íŠ¹ì • ë³€ê²½ ì‚¬í•­ì´ ë©”ëª¨ë¦¬ì— ê¸°ë¡ë˜ê±°ë‚˜ ì»¤ë°‹ë  ë•Œê¹Œì§€ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ë³¼ ìˆ˜ ì—†ë‹¤. ì´ë¡œ ì¸í•´, ë°ì´í„°ë² ì´ìŠ¤ ìƒíƒœì˜ ë¶ˆì¼ì¹˜ ì—†ì´ ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì´ ë™ì‹œì— ë°œìƒí•  ìˆ˜ ìˆë‹¤. Durability(ì˜êµ¬ì„±) íŠ¸ëœì­ì…˜ ì‹¤í–‰ì´ ì™„ë£Œë˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ì— ëŒ€í•œ ì—…ë°ì´íŠ¸ ë° ìˆ˜ì • ë‚´ìš©ì´ ë””ìŠ¤í¬ì— ì €ì¥ë˜ê³  ì‹œìŠ¤í…œì— ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë”ë¼ë„ ìœ ì§€ëœë‹¤. ì´ëŸ¬í•œ ì—…ë°ì´íŠ¸ëŠ” ì˜êµ¬ì ì´ë©° ë¹„íœ˜ë°œì„± ë©”ëª¨ë¦¬ì— ì €ì¥ëœë‹¤. íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€(Isolation Level)ì´ë€ ? ë™ì‹œì— ì—¬ëŸ¬ íŠ¸ëœì­ì…˜ì´ ì²˜ë¦¬ë  ë•Œ, íŠ¹ì • íŠ¸ëœì­ì…˜ì´ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ë³€ê²½í•˜ê±°ë‚˜ ì¡°íšŒí•˜ëŠ” ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ìˆë„ë¡ í—ˆìš©í• ì§€ ë§ì§€ ê²°ì •í•˜ëŠ” ê²ƒ. ê²©ë¦¬ ìˆ˜ì¤€ì€ í¬ê²Œ 4ê°€ì§€ë¡œ ë‚˜ë‰œë‹¤ (ë°‘ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ê²©ë¦¬ ìˆ˜ì¤€ ë†’ì•„ì§) READ UNCOMMITTED(DIRTY READ) READ COMMITTED REPEATABLE READ SERIALIZABLE ê²©ë¦¬ ìˆ˜ì¤€ì´ ë†’ì•„ì§ˆìˆ˜ë¡ ë™ì‹œì„±ì´ ë–¨ì–´ì§€ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤. í•˜ì§€ë§Œ, SERIALIZABLE ê²©ë¦¬ ìˆ˜ì¤€ì´ ì•„ë‹ˆë¼ë©´ í¬ê²Œ ì„±ëŠ¥ì˜ ê°œì„ ì´ë‚˜ ì €í•˜ëŠ” ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. READ UNCOMMITTED ì»¤ë°‹ë˜ì§€ ì•Šì€ ë³€ê²½ì— ëŒ€í•´ ì¡°íšŒê°€ ê°€ëŠ¥í•˜ë‹¤. íŠ¹ì • íŠ¸ëœì­ì…˜ì—ì„œ ì²˜ë¦¬í•œ ì‘ì—…ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ëŠ”ë° ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ë³¼ ìˆ˜ ìˆê²Œ ë˜ëŠ” í˜„ìƒì„ â€˜Dirty Readâ€™ë¼ê³  í•œë‹¤. ì´ë¡œ ì¸í•´ ë°ì´í„°ê°€ ë‚˜íƒ€ë‚¬ë‹¤ ì‚¬ë¼ì¡Œë‹¤ í•˜ëŠ” í˜„ìƒì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. RDBMS í‘œì¤€ì—ì„œëŠ” íŠ¸ëœì­ì…˜ì˜ ê²©ë¦¬ ìˆ˜ì¤€ìœ¼ë¡œ ì¸ì •í•˜ì§€ ì•Šì„ ì •ë„ë¡œ ë°ì´í„° ì •í•©ì„±ì— ë¬¸ì œê°€ ë§ì€ ê²©ë¦¬ ìˆ˜ì¤€ì´ë‹¤. ì¶œì²˜ : https://lng1982.tistory.com/287 READ COMMITTED íŠ¹ì • íŠ¸ëœì­ì…˜ì—ì„œ ì»¤ë°‹ ì™„ë£Œëœ ë°ì´í„°ë§Œ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤. Oracle DBMSì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê²©ë¦¬ ìˆ˜ì¤€ì´ë©°, ì¼ë°˜ì ìœ¼ë¡œ ê°€ì¥ ë§ì´ ì‚¬ìš©ëœë‹¤. ì¶œì²˜ : https://lng1982.tistory.com/287 Dirty ReadëŠ” ë°œìƒí•˜ì§€ ì•Šì§€ë§Œ, NON-REPEATABLE READ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì¦‰, í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ë˜‘ê°™ì€ SELECT ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í–ˆëŠ”ë° ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¬ ìˆ˜ ìˆê²Œëœë‹¤. (Bobì´ post í…Œì´ë¸”ì—ì„œ idê°€ 1ì¸ ê²ƒì„ ì¡°íšŒí•˜ëŠ”ë° ì²˜ìŒì—” Transactions, ê·¸ ë‹¤ìŒì—” ACIDê°€ ì¡°íšŒëœë‹¤.) ì¶œì²˜ : https://vladmihalcea.com/non-repeatable-read/ ì´ëŸ¬í•œ ë¶€ì •í•© í˜„ìƒì€ ì¼ë°˜ì ì¸ ì›¹ í”„ë¡œê·¸ë¨ì—ì„œëŠ” í¬ê²Œ ë¬¸ì œë˜ì§€ ì•Šì„ ìˆ˜ ìˆì§€ë§Œ, í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì—ì„œ ë™ì¼í•œ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ë²ˆ ì½ê³  ë³€ê²½í•˜ëŠ” ì‘ì—…ì´ ê¸ˆì „ì ì¸ ì²˜ë¦¬ì™€ ì—°ê²°ë˜ë©´ ë¬¸ì œê°€ ë  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì…ì¶œê¸ˆ ì²˜ë¦¬ê°€ ê³„ì† ì§„í–‰ë˜ëŠ”ë° ë˜ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ì˜¤ëŠ˜ ì…ê¸ˆëœ ê¸ˆì•¡ì˜ ì´í•©ì„ ì¡°íšŒí•˜ëŠ” ê²½ìš°, ì¡°íšŒí•  ë•Œë§ˆë‹¤ ë‹¤ë¥¸ ê²°ê³¼ê°€ ë‚˜ì˜¤ê²Œëœë‹¤. REPEATABLE READ NON-REPEATABLE READ ë¶€ì •í•© ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. MySQLì˜ InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê²©ë¦¬ ìˆ˜ì¤€ì´ë‹¤. íŠ¸ëœì­ì…˜ì´ ë¡¤ë°±ë  ê°€ëŠ¥ì„±ì— ëŒ€ë¹„í•´ ë³€ê²½ ì „ ë°ì´í„°ë¥¼ ì–¸ë‘(Undo) ê³µê°„ì— ë°±ì—…í•´ë‘ê³  ì‹¤ì œ ë ˆì½”ë“œ ê°’ì„ ë³€ê²½í•œë‹¤. ì´ëŸ¬í•œ ë³€ê²½ ë°©ì‹ì„ MVCC(Multi Version Concurrency Control)ì´ë¼ê³  í•œë‹¤. READ COMMITTEDë„ MVCCë¥¼ ì´ìš©í•´ COMMIT ë˜ê¸° ì „ì˜ ë°ì´í„°ë¥¼ ë³´ì—¬ì¤€ë‹¤. ì°¨ì´ëŠ” ì–¸ë‘ ì˜ì—­ì— ë°±ì—…ëœ ë ˆì½”ë“œì˜ ì—¬ëŸ¬ ë²„ì „ ê°€ìš´ë° ëª‡ ë²ˆì§¸ ì´ì „ ë²„ì „ê¹Œì§€ ì°¾ì•„ ë“¤ì–´ê°€ëŠ”ì§€ì— ìˆë‹¤. ëª¨ë“  InnoDBì˜ íŠ¸ëœì­ì…˜ì€ ê³ ìœ í•œ íŠ¸ëœì­ì…˜ ë²ˆí˜¸(ìˆœì°¨ì ìœ¼ë¡œ ì¦ê°€í•˜ëŠ” ê°’)ë¥¼ ê°€ì§„ë‹¤. ì–¸ë‘ ì˜ì—­ì— ë°±ì—…ëœ ëª¨ë“  ë ˆì½”ë“œì—ëŠ” ë³€ê²½ì„ ë°œìƒì‹œí‚¨ íŠ¸ëœì­ì…˜ ë²ˆí˜¸ê°€ í¬í•¨ëœë‹¤. ì–¸ë‘ ì˜ì—­ì˜ ë°±ì—…ëœ ë°ì´í„°ëŠ” InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì´ ë¶ˆí•„ìš”í•˜ë‹¤ê³  íŒë‹¨í•˜ëŠ” ì‹œì ì— ì£¼ê¸°ì ìœ¼ë¡œ ì‚­ì œí•œë‹¤. REPEATABLE READ ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œëŠ” ì‹¤í–‰ ì¤‘ì¸ íŠ¸ëœì­ì…˜ ê°€ìš´ë° ê°€ì¥ ì˜¤ë˜ëœ íŠ¸ëœì­ì…˜ ë²ˆí˜¸ë³´ë‹¤ ì•ì„  íŠ¸ëœì­ì…˜ ë²ˆí˜¸ë¥¼ ê°–ëŠ” ë ˆì½”ë“œë¥¼ ì–¸ë‘ ì˜ì—­ì—ì„œ ì‚­ì œí•  ìˆ˜ ì—†ë‹¤. ì•„ë˜ ì˜ˆì—ì„œ T2ì˜ íŠ¸ëœì­ì…˜ ë²ˆí˜¸ëŠ” 10ì´ë¯€ë¡œ, í•´ë‹¹ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ì‹¤í–‰ë˜ëŠ” ëª¨ë“  SELECT ì¿¼ë¦¬ëŠ” íŠ¸ëœì­ì…˜ ë²ˆí˜¸ê°€ 10ë³´ë‹¤ ì‘ì€ íŠ¸ëœì­ì…˜ ë²ˆí˜¸ì—ì„œ ë³€ê²½í•œ ê²ƒë§Œ ë³´ê²Œ ëœë‹¤. ë§Œì•½ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ì´ ì¥ì‹œê°„ ë™ì•ˆ ì§€ì†ë˜ë©´ ì–¸ë‘ ì˜ì—­ì´ ë°±ì—…ëœ ë°ì´í„°ë¡œ ë¬´í•œì • ì»¤ì§ˆ ìˆ˜ë„ ìˆë‹¤. ë°±ì—…ëœ ë ˆì½”ë“œê°€ ë§ì•„ì§€ë©´ DB ì„œë²„ì˜ ì²˜ë¦¬ ì„±ëŠ¥ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆë‹¤. REPEATABLE READì—ì„œëŠ” PHANTOM READ(PHANTOM ROW) ë¶€ì •í•© ë¬¸ì œê°€ ë‚˜íƒ€ë‚  ìˆ˜ ìˆë‹¤. PHANTOM READ : ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ìˆ˜í–‰í•œ ë³€ê²½ ì‘ì—…ì— ì˜í•´ ë ˆì½”ë“œê°€ ë³´ì˜€ë‹¤ ì•ˆ ë³´ì˜€ë‹¤ í•˜ëŠ” í˜„ìƒ SELECT ... FOR UPDATE ì¿¼ë¦¬ëŠ” SELECT í•˜ëŠ” ë ˆì½”ë“œì— ì“°ê¸° ì ê¸ˆì„ ê±¸ì–´ì•¼ í•˜ëŠ”ë°, ì–¸ë‘ ì˜ì—­ì˜ ë ˆì½”ì—ëŠ” ì ê¸ˆì„ ê±¸ ìˆ˜ ì—†ë‹¤. ë”°ë¼ì„œ, ì–¸ë‘ ì˜ì—­ì´ ì•„ë‹Œ ì‹¤ì œë¡œ ë³€ê²½ëœ í…Œì´ë¸”ì—ì„œ ê°’ì„ ê°€ì ¸ì˜¤ê²Œ ëœë‹¤.SERIALIZABLE ê°€ì¥ ë‹¨ìˆœí•˜ë©´ì„œ ì—„ê²©í•œ ê²©ë¦¬ ìˆ˜ì¤€ì´ë‹¤. ë™ì‹œ ì²˜ë¦¬ ì„±ëŠ¥ë„ ë‹¤ë¥¸ ê²©ë¦¬ ìˆ˜ì¤€ì— ë¹„í•´ ë–¨ì–´ì§„ë‹¤. InnoDB í…Œì´ë¸”ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ìˆœìˆ˜í•œ SELECT ì‘ì—…ì€(INSERT ... SELECT ... ë˜ëŠ” CREATE TABLE ... AS SELECT ...ê°€ ì•„ë‹Œ) ì•„ë¬´ëŸ° ë ˆì½”ë“œ ì ê¸ˆì„ ì„¤ì •í•˜ì§€ ì•Šê³  ì‹¤í–‰ëœë‹¤. í•˜ì§€ë§Œ SERIALIZABLE ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œëŠ” ì´ëŸ¬í•œ ì½ê¸° ì‘ì—…ë„ ê³µìœ  ì ê¸ˆì„ íšë“í•´ì•¼ í•œë‹¤. ë”°ë¼ì„œ ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œëŠ” ì ˆëŒ€ ì ‘ê·¼í•  ìˆ˜ ì—†ë‹¤. ì°¸ê³ . DBë³„ ê²©ë¦¬ ìˆ˜ì¤€(default)MS-SQL : READ COMMITTEDMySQL : REPEATABLE READORACLE : READ COMMITTEDH2 : READ COMMITTEDê²©ë¦¬ ìˆ˜ì¤€ì— ë”°ë¥¸ ë¶€ì •í•© ë¬¸ì œ ì •ë¦¬ ìœ„ì—ì„œ ì‚´í´ë³¸ ê²©ë¦¬ ìˆ˜ì¤€ë³„ ë¶€ì •í•© ë¬¸ì œë¥¼ ë‹¤ì‹œ í•œ ë²ˆ ì •ë¦¬í•´ë³´ì. Dirty Read : íŠ¸ëœì­ì…˜ì´ ì•„ì§ ì»¤ë°‹ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì½ëŠ” ê²ƒ. Non Repeatable read : ë™ì¼í•œ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ ì‹¤í–‰í•œ ë™ì¼í•œ SELECT ì¿¼ë¦¬ê°€ ë‹¤ë¥¸ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒ. Phantom Read : ë‹¤ë¥¸ íŠ¸ëœì­ì…˜ì—ì„œ ìˆ˜í–‰í•œ ë³€ê²½ ì‘ì—…ì— ì˜í•´ ë ˆì½”ë“œê°€ ë³´ì˜€ë‹¤ ì•ˆ ë³´ì˜€ë‹¤ í•˜ëŠ” ê²ƒ. ê²©ë¦¬ ìˆ˜ì¤€ DIRTY READ NON-REPEATABLE READ PHANTOM READ READ UNCOMMITTED O O O READ COMMITTED X O O REPEATABLE READ X X O (InnoDBëŠ” X) SERIALIZABLE X X X ì°¸ê³  ìë£Œ ì´ì„±ìš±, ã€ê°œë°œìì™€ DBAë¥¼ ìœ„í•œ Real MySQLã€, ìœ„í‚¤ë¶ìŠ¤(2012), 4ì¥ https://www.geeksforgeeks.org/acid-properties-in-dbms/ https://en.wikipedia.org/wiki/Database_transaction https://lng1982.tistory.com/287" }, { "title": "Java - ìë°”ì˜ ë©”ëª¨ë¦¬ êµ¬ì¡°ì™€ ë³€ìˆ˜ ì¢…ë¥˜ ì‚´í´ë³´ê¸°", "url": "/posts/java-variable-type-and-jvm-memory/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-08-23 23:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ìŠ¤í”„ë§ ë¹ˆì€ ê¸°ë³¸ì ìœ¼ë¡œ ì‹±ê¸€í†¤ìœ¼ë¡œ ìƒì„±ë˜ê¸° ë•Œë¬¸ì—, ë§Œì•½ @Serviceë¡œ ì„ ì–¸ëœ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í´ë˜ìŠ¤ì— ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ê°€ ì„ ì–¸ë˜ì–´ ìˆë‹¤ë©´ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ëª¨ë“  ìŠ¤ë ˆë“œëŠ” í•´ë‹¹ ë°ì´í„°ë¥¼ ê³µìœ í•˜ê²Œ ëœë‹¤. ì´ê²ƒì„ ê³ ë ¤í•˜ì§€ ì•Šê³  ë¬´ì‘ì • ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ì„ ì–¸í•˜ë©´, ë©€í‹° ìŠ¤ë ˆë”© í™˜ê²½ì—ì„œ ë°ì´í„°ê°€ ê¼¬ì—¬ì„œ ì‹œìŠ¤í…œ ì¥ì• ë¥¼ ì´ˆë˜í•  ìˆ˜ë„ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ...", "content": "ë“¤ì–´ê°€ê¸° ì „ìŠ¤í”„ë§ ë¹ˆì€ ê¸°ë³¸ì ìœ¼ë¡œ ì‹±ê¸€í†¤ìœ¼ë¡œ ìƒì„±ë˜ê¸° ë•Œë¬¸ì—, ë§Œì•½ @Serviceë¡œ ì„ ì–¸ëœ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í´ë˜ìŠ¤ì— ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ê°€ ì„ ì–¸ë˜ì–´ ìˆë‹¤ë©´ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²˜ë¦¬í•˜ëŠ” ëª¨ë“  ìŠ¤ë ˆë“œëŠ” í•´ë‹¹ ë°ì´í„°ë¥¼ ê³µìœ í•˜ê²Œ ëœë‹¤. ì´ê²ƒì„ ê³ ë ¤í•˜ì§€ ì•Šê³  ë¬´ì‘ì • ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¡œ ì„ ì–¸í•˜ë©´, ë©€í‹° ìŠ¤ë ˆë”© í™˜ê²½ì—ì„œ ë°ì´í„°ê°€ ê¼¬ì—¬ì„œ ì‹œìŠ¤í…œ ì¥ì• ë¥¼ ì´ˆë˜í•  ìˆ˜ë„ ìˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ì™œ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ëŠ” ìŠ¤ë ˆë“œ ê°„ì— ê³µìœ ë˜ëŠ” ê²ƒì¼ê¹Œ? ì´ë¥¼ ì´í•´í•˜ê¸° ìœ„í•´ JVMì´ ê´€ë¦¬í•˜ëŠ” ë©”ëª¨ë¦¬ êµ¬ì¡°ì— ëŒ€í•´ ì•Œì•„ë³´ì.Run-Time Data Areas Java Virtual Machine(JVM)ì€ í”„ë¡œê·¸ë¨ ì‹¤í–‰ ì¤‘ì— ì‚¬ìš©ë˜ëŠ” ë‹¤ì–‘í•œ ëŸ°íƒ€ì„ ë°ì´í„° ì˜ì—­ì„ ì •ì˜í•œë‹¤. ë°ì´í„° ì˜ì—­ì€ í¬ê²Œ JVM ë‹¨ìœ„ì˜ ì˜ì—­ê³¼ ìŠ¤ë ˆë“œ ë‹¨ìœ„ì˜ ì˜ì—­ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤. JVM ë‹¨ìœ„ : JVMì„ ì‹œì‘í•  ë•Œ ìƒì„±ë˜ë©° JVMì´ ì¢…ë£Œë  ë•Œ ì‚­ì œë˜ëŠ” ë°ì´í„° ì˜ì—­. Heap Method Area JVM ë‹¨ìœ„ì˜ ë°ì´í„° ì˜ì—­ì€ ëª¨ë“  ìŠ¤ë ˆë“œ ê°„ì— ê³µìœ ëœë‹¤. ìŠ¤ë ˆë“œ ë‹¨ìœ„ : ìŠ¤ë ˆë“œê°€ ìƒì„±ë  ë•Œ ë§Œë“¤ì–´ì§€ê³  ìŠ¤ë ˆë“œê°€ ì¢…ë£Œë  ë•Œ ì‚­ì œë˜ëŠ” ë°ì´í„° ì˜ì—­. PC Register JVM Stack Native Method Stack ì¶œì²˜ : https://homoefficio.github.io/2019/01/31/Back-to-the-Essence-Java-%EC%BB%B4%ED%8C%8C%EC%9D%BC%EC%97%90%EC%84%9C-%EC%8B%A4%ED%96%89%EA%B9%8C%EC%A7%80-2/Heap í™ì€ ëª¨ë“  í´ë˜ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ë° ë°°ì—´ì´ í• ë‹¹ë˜ëŠ” ì˜ì—­ì´ë‹¤. í™ì— ì €ì¥ëœ ê°ì²´ì— í• ë‹¹ëœ ë©”ëª¨ë¦¬ëŠ” ëª…ì‹œì ì¸ ë°©ë²•ìœ¼ë¡œëŠ” ì ˆëŒ€ íšŒìˆ˜ë˜ì§€ ëª»í•˜ë©°, ì˜¤ì§ ê°€ë¹„ì§€ ì»¬ë ‰í„°(garbage collector)ì— ì˜í•´ì„œë§Œ íšŒìˆ˜ë  ìˆ˜ ìˆë‹¤. í™ì€ ê³ ì •ëœ í¬ê¸°ì´ê±°ë‚˜ ê³„ì‚°ì— ë”°ë¼ í™•ì¥/ì¶•ì†Œë  ìˆ˜ ìˆë‹¤. ì—°ì‚°ì— í•„ìš”í•œ í™ì˜ í¬ê¸°ê°€ ë¶€ì¡±í•  ê²½ìš° JVMì´ OutOfMemoryErrorë¥¼ ë°œìƒì‹œí‚¨ë‹¤.Method Area ëŸ°íƒ€ì„ ìƒìˆ˜ í’€, í•„ë“œì™€ ë©”ì„œë“œ ë°ì´í„°, ìƒì„±ì ë° ë©”ì„œë“œì˜ ì½”ë“œì™€ ê°™ì€ í´ë˜ìŠ¤ ë‹¨ìœ„ì˜ ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤. ë©”ì„œë“œ ì˜ì—­ì€ ë…¼ë¦¬ì ìœ¼ë¡œ í™ì˜ ì¼ë¶€ì´ê¸° ë•Œë¬¸ì— GC ëŒ€ìƒì´ ë˜ì§€ë§Œ ë‹¨ìˆœ êµ¬í˜„ì—ì„œëŠ” garbage collecting ë˜ëŠ” compacting(ì••ì¶•)í•˜ì§€ ì•Šë„ë¡ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. í• ë‹¹ ìš”ì²­ì„ ìœ„í•´ ë©”ì„œë“œ ì˜ì—­ì˜ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ê²½ìš° JVM OutOfMemoryErrorë¥¼ ë°œìƒì‹œí‚¨ë‹¤.Run-Time Constant Pool ëŸ°íƒ€ì„ ìƒìˆ˜ í’€ì—ëŠ” ì»´íŒŒì¼ íƒ€ì„ì— ì´ë¯¸ ì•Œ ìˆ˜ ìˆëŠ” ìˆ«ì ë¦¬í„°ëŸ´ ê°’ë¶€í„° ëŸ°íƒ€ì„ì— í•´ì„ë˜ëŠ” ë©”ì„œë“œì™€ í•„ë“œì˜ ì°¸ì¡°ê¹Œì§€ë¥¼ í¬ê´„í•˜ëŠ” ì—¬ëŸ¬ ì¢…ë¥˜ì˜ ìƒìˆ˜ê°€ í¬í•¨ëœë‹¤. ëŸ°íƒ€ì„ ìƒìˆ˜ í’€ì€ ë‹¤ë¥¸ ì „í†µì ì¸ ì–¸ì–´ì—ì„œ ë§í•˜ëŠ” ì‹¬ë³¼ í…Œì´ë¸”ê³¼ ë¹„ìŠ·í•œ ê¸°ëŠ¥ì„ í•œë‹¤ê³  ë³´ë©´ ëœë‹¤.PC Register JVMì€ í•œ ë²ˆì— ì—¬ëŸ¬ ìŠ¤ë ˆë“œì˜ ì‹¤í–‰ì„ ì§€ì›í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ê° ìŠ¤ë ˆë“œì—ëŠ” ìì²´ PC(í”„ë¡œê·¸ë¨ ì¹´ìš´í„°) ë ˆì§€ìŠ¤í„°ê°€ ìˆë‹¤. ê° JVM ìŠ¤ë ˆë“œëŠ” ë‹¨ì¼ ë©”ì„œë“œì˜ ì½”ë“œ, ì¦‰ í•´ë‹¹ ìŠ¤ë ˆë“œì˜ í˜„ì¬ ë©”ì„œë“œë¥¼ ì‹¤í–‰í•œë‹¤. ì´ ë©”ì„œë“œê°€ nativeê°€ ì•„ë‹Œ ê²½ìš° pc ë ˆì§€ìŠ¤í„°ì—ëŠ” í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ JVM ëª…ë ¹ì˜ ì£¼ì†Œë¥¼ ì €ì¥í•œë‹¤. ìŠ¤ë ˆë“œì—ì„œ í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ ë©”ì„œë“œê°€ nativeì´ë©´ JVMì˜ pc ë ˆì§€ìŠ¤í„° ê°’ì´ ì •ì˜ë˜ì§€ ì•ŠëŠ”ë‹¤.Java Virtual Machine Stacks ê° ìŠ¤ë ˆë“œì—ëŠ” ìŠ¤ë ˆë“œì™€ ë™ì‹œì— ìƒì„±ëœ ì „ìš© JVM ìŠ¤íƒì´ ìˆë‹¤. JVM ìŠ¤íƒì€ í”„ë ˆì„(Frame)ì„ ì €ì¥í•œë‹¤. JVM ìŠ¤íƒì€ ë¡œì»¬ ë³€ìˆ˜ì™€ ë¶€ë¶„ ê²°ê³¼ë¥¼ ë³´ìœ í•˜ê³  ìˆìœ¼ë©° ë©”ì„œë“œ í˜¸ì¶œ ë° ë°˜í™˜ì„ ë‹´ë‹¹í•œë‹¤. ìŠ¤ë ˆë“œì˜ ê³„ì‚°ì— í—ˆìš©ëœ í¬ê¸°ë³´ë‹¤ í° JVM ìŠ¤íƒì´ í•„ìš”í•œ ê²½ìš° JVMì´ StackOverflowErrorë¥¼ ë°œìƒì‹œí‚¨ë‹¤. JVM ìŠ¤íƒì„ ë™ì ìœ¼ë¡œ í™•ì¥í•  ìˆ˜ ìˆì§€ë§Œ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•˜ê±°ë‚˜, ìƒˆ ìŠ¤ë ˆë“œì— ëŒ€í•œ ì´ˆê¸° JVM ìŠ¤íƒì„ ë§Œë“œëŠ” ë° ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•œ ê²½ìš°JVMì´ OutOfMemoryErrorë¥¼ ë°œìƒì‹œí‚¨ë‹¤.ì°¸ê³ . Stack Frame JVM ìŠ¤íƒì„ êµ¬ì„±í•˜ëŠ” í”„ë ˆì„ì€ ë‹¤ìŒê³¼ ê°™ì€ ìš©ë„ë¡œ ì‚¬ìš©ëœë‹¤. ë°ì´í„° ë° ë¶€ë¶„ ê²°ê³¼ë¥¼ ì €ì¥ ë™ì  ì—°ê²°(dynamic linking) ìˆ˜í–‰ ë©”ì„œë“œì— ëŒ€í•œ ê°’ì„ ë°˜í™˜ ì˜ˆì™¸ ì „ë‹¬ ê° í”„ë ˆì„ì˜ êµ¬ì„± ìš”ì†ŒëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ë¡œì»¬ ë³€ìˆ˜ ë°°ì—´(array of local variables) í”¼ì—°ì‚°ì ìŠ¤íƒ(operand stack) í˜„ì¬ ë©”ì„œë“œ í´ë˜ìŠ¤ì˜ ëŸ°íƒ€ì„ ìƒìˆ˜ í’€ì— ëŒ€í•œ ì°¸ì¡° ë©”ì„œë“œê°€ í˜¸ì¶œë  ë•Œë§ˆë‹¤ ìƒˆ í”„ë ˆì„ì´ ìƒì„±ëœë‹¤. í”„ë ˆì„ì€ ë©”ì„œë“œ í˜¸ì¶œì´ ì™„ë£Œë˜ë©´ í•´ë‹¹ ì™„ë£Œê°€ ì •ìƒì¸ì§€ ì—¬ë¶€ì— ê´€ê³„ì—†ì´ ì‚­ì œëœë‹¤.Native Method Stack JVM êµ¬í˜„ì‹œ native ë©”ì„œë“œ(Java í”„ë¡œê·¸ë˜ë° ì–¸ì–´ê°€ ì•„ë‹Œ ì–¸ì–´ë¡œ ì‘ì„±ëœ ë©”ì„œë“œ)ë¥¼ ì§€ì›í•˜ê¸° ìœ„í•´ ì¼ë°˜ì ìœ¼ë¡œ â€œC ìŠ¤íƒâ€ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ê¸°ì¡´ ìŠ¤íƒì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. native ë©”ì„œë“œë¥¼ ë¡œë“œí•  ìˆ˜ ì—†ê³  ê¸°ì¡´ ìŠ¤íƒì— ì˜ì¡´í•˜ì§€ ì•ŠëŠ” JVM êµ¬í˜„ì—ì„œëŠ” Native Method Stackì„ ì œê³µí•  í•„ìš”ê°€ ì—†ë‹¤. ì œê³µëœ ê²½ìš° Native Method Stackì€ ì¼ë°˜ì ìœ¼ë¡œ ê° ìŠ¤ë ˆë“œê°€ ìƒì„±ë  ë•Œ ìŠ¤ë ˆë“œë³„ë¡œ í• ë‹¹ëœë‹¤. ì´ ìŠ¤í™ì„ ì‚¬ìš©í•˜ë©´ Native Method Stackì´ ê³ ì •ëœ í¬ê¸°ì´ê±°ë‚˜ ê³„ì‚°ì— í•„ìš”í•œ ëŒ€ë¡œ ë™ì ìœ¼ë¡œ í™•ì¥ ë° ì¶•ì†Œë  ìˆ˜ ìˆë‹¤. Native Method Stackì˜ í¬ê¸°ê°€ ê³ ì •ëœ ê²½ìš° í•´ë‹¹ ìŠ¤íƒì„ ë§Œë“¤ ë•Œ ê°ê°ì˜ í¬ê¸°ë¥¼ ê°œë³„ì ìœ¼ë¡œ ì„ íƒí•  ìˆ˜ ìˆë‹¤. ìŠ¤ë ˆë“œì˜ ê³„ì‚°ì— í—ˆìš©ëœ ê²ƒë³´ë‹¤ í° Native Method Stackì´ í•„ìš”í•œ ê²½ìš° JVMì´ StackOverflowErrorë¥¼ ë°œìƒì‹œí‚¨ë‹¤. Native Method Stackì„ ë™ì ìœ¼ë¡œ í™•ì¥í•˜ë ¤ê³  í–ˆìœ¼ë‚˜ ì‚¬ìš© ê°€ëŠ¥í•œ ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•˜ê±°ë‚˜, ìƒˆ ìŠ¤ë ˆë“œì— ëŒ€í•œ ì´ˆê¸° Native Method Stackì„ ë§Œë“œëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ê²½ìš° JVMì—ì„œ OutOfMemoryErrorë¥¼ ë°œìƒì‹œí‚¨ë‹¤.ë³€ìˆ˜ì˜ ì¢…ë¥˜ ìë°”ì˜ ë³€ìˆ˜ì—ëŠ” í´ë˜ìŠ¤ ë³€ìˆ˜ / ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ / ë§¤ê°œ ë³€ìˆ˜ / ì§€ì—­ ë³€ìˆ˜ê°€ ìˆë‹¤.ìœ„ì—ì„œ ê³µë¶€í•œ ë©”ëª¨ë¦¬ êµ¬ì¡°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°ê°ì˜ ë³€ìˆ˜ê°€ ì–´ë””ì— ì €ì¥ë ì§€ ìƒê°í•´ë³´ì.public class VariableType { static int í´ë˜ìŠ¤_ë³€ìˆ˜; int ì¸ìŠ¤í„´ìŠ¤_ë³€ìˆ˜; public void test(int ë§¤ê°œ_ë³€ìˆ˜) { int ì§€ì—­_ë³€ìˆ˜; }} í´ë˜ìŠ¤ ë³€ìˆ˜ í´ë˜ìŠ¤ê°€ ì²˜ìŒ í˜¸ì¶œë  ë•Œ ìƒëª…ì´ ì‹œì‘ë˜ê³ , ìë°” í”„ë¡œê·¸ë¨ì´ ëë‚  ë•Œ ì†Œë©¸ëœë‹¤. ì €ì¥ë˜ëŠ” ì˜ì—­ : Method Area ì£¼ì˜ : JVM ë‹¨ìœ„ì˜ ì˜ì—­ì´ë¯€ë¡œ ëª¨ë“  ìŠ¤ë ˆë“œ ê°„ì— ë°ì´í„°ê°€ ê³µìœ ëœë‹¤. ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ ê°ì²´ê°€ ìƒì„±ë  ë•Œ ìƒëª…ì´ ì‹œì‘ë˜ê³ , ê·¸ ê°ì²´ë¥¼ ì°¸ì¡°í•˜ê³  ìˆëŠ” ë‹¤ë¥¸ ê°ì²´ê°€ ì—†ìœ¼ë©´ ì†Œë©¸ëœë‹¤. ì €ì¥ë˜ëŠ” ì˜ì—­ : Heap ì£¼ì˜ : JVM ë‹¨ìœ„ì˜ ì˜ì—­ì´ë¯€ë¡œ ëª¨ë“  ìŠ¤ë ˆë“œ ê°„ì— ë°ì´í„°ê°€ ê³µìœ ëœë‹¤. ë§¤ê°œ ë³€ìˆ˜ ë©”ì„œë“œê°€ í˜¸ì¶œë  ë•Œ ìƒëª…ì´ ì‹œì‘ë˜ê³ , ë©”ì†Œë“œê°€ ëë‚˜ë©´ ì†Œë©¸ëœë‹¤. ì €ì¥ë˜ëŠ” ì˜ì—­ : JVM Stack(Stack Frame) ì§€ì—­ ë³€ìˆ˜ ì§€ì—­ ë³€ìˆ˜ë¥¼ ì„ ì–¸í•œ ì¤‘ê´„í˜¸ ë‚´ì—ì„œë§Œ ìœ íš¨ ì €ì¥ë˜ëŠ” ì˜ì—­ : JVM Stack(Stack Frame) â€» ì°¸ê³  : ë©”ì†Œë“œ ë°–ì—ì„œ ì„ ì–¸ëœ ë³€ìˆ˜ë¥¼ â€˜ë©¤ë²„ ë³€ìˆ˜â€™ë¼ê³  í•˜ë©° í´ë˜ìŠ¤ ë³€ìˆ˜ì™€ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ê°€ í¬í•¨ëœë‹¤.ì°¸ê³ ìë£Œ https://docs.oracle.com/javase/specs/jvms/se7/html/jvms-2.html https://homoefficio.github.io/2019/01/31/Back-to-the-Essence-Java-%EC%BB%B4%ED%8C%8C%EC%9D%BC%EC%97%90%EC%84%9C-%EC%8B%A4%ED%96%89%EA%B9%8C%EC%A7%80-2/ ì´ìƒë¯¼, ã€ìë°”ì˜ ì‹  1ã€, ë¡œë“œë¶(2017), 4ì¥" }, { "title": "CompletableFuture, Parellel Streamì„ í†µí•´ ì„±ëŠ¥ ê°œì„ í•´ë³´ê¸°", "url": "/posts/applying-java-async-for-performance/", "categories": "ê²½í—˜í•˜ê¸°, ì‘ì—… ë…¸íŠ¸", "tags": "Java", "date": "2021-08-18 14:00:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „í˜„ì¬ ìš´ì˜í•˜ê³  ìˆëŠ” ì‹œìŠ¤í…œ(ìë°” ë²„ì „8)ì—ì„œ ì¡°íšŒ ì‹œê°„ì´ ê½¤ ì˜¤ë˜ ì†Œìš”ë˜ëŠ” í™”ë©´ë“¤ì´ ìˆì—ˆë‹¤. ëª¨ë“  í™”ë©´ì´ ê·¸ëŸ°ê²ƒì€ ì•„ë‹ˆì—ˆì§€ë§Œ ëª‡ëª‡ í™”ë©´ì˜ ë°±ì—”ë“œ ë¡œì§ì€ ì•„ë˜ì™€ ê°™ì´ ë˜ì–´ìˆì—ˆë‹¤.public Map&lt;String, Object&gt; retrieve() { Object result1 = testProxy.findSomething(param...", "content": "ë“¤ì–´ê°€ê¸° ì „í˜„ì¬ ìš´ì˜í•˜ê³  ìˆëŠ” ì‹œìŠ¤í…œ(ìë°” ë²„ì „8)ì—ì„œ ì¡°íšŒ ì‹œê°„ì´ ê½¤ ì˜¤ë˜ ì†Œìš”ë˜ëŠ” í™”ë©´ë“¤ì´ ìˆì—ˆë‹¤. ëª¨ë“  í™”ë©´ì´ ê·¸ëŸ°ê²ƒì€ ì•„ë‹ˆì—ˆì§€ë§Œ ëª‡ëª‡ í™”ë©´ì˜ ë°±ì—”ë“œ ë¡œì§ì€ ì•„ë˜ì™€ ê°™ì´ ë˜ì–´ìˆì—ˆë‹¤.public Map&lt;String, Object&gt; retrieve() { Object result1 = testProxy.findSomething(param1); // blocking Object result2 = testProxy.findSomething(param2); // blocking Object result3 = testProxy.findSomething(param3); // blocking Map&lt;String, Object&gt; toClient = new HashMap&lt;&gt;(); toClient.put(\"result1\", result1); toClient.put(\"result2\", result2); toClient.put(\"result3\", result3); return toClient;}ì¦‰, ëª¨ë“  ê²°ê³¼ë¥¼ í•˜ë‚˜ì˜ Mapì— ë‹´ì•„ì„œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ë¦¬í„´í•˜ëŠ” í˜•ì‹ì´ì—ˆë‹¤. í•˜ì§€ë§Œ, ì¡°íšŒ ê²°ê³¼ë“¤ì€ ì„œë¡œ ë…ë¦½ì ì´ì—ˆê¸° ë•Œë¬¸ì— êµ³ì´ sequentialí•˜ê²Œ ì²˜ë¦¬í•  í•„ìš”ê°€ ì—†ì„ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ ë“¤ì—ˆë‹¤.ë”°ë¼ì„œ ìë°”ì—ì„œì˜ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ê³µë¶€ í•˜ê³  í•´ë‹¹ ë¡œì§ì„ ê°œì„ í•´ë³´ì•˜ë‹¤.Before ë¡œì§ì€ ìœ„ì—ì„œ ì‚´í´ë³¸ ê²ƒê³¼ ê°™ê³ , insomniaë¥¼ í™œìš©í•´ ì‘ë‹µ ì‹œê°„ì„ ì¸¡ì •í•´ë³´ì•˜ë‹¤. ê°œì„  ì „(ì•½ 5.7ì´ˆ ì†Œìš”) (í•¸ë“œí° ì¹´ë©”ë¼ë¡œ ì°ì–´ í™”ì§ˆì´ ì¢‹ì§€ ì•Šì€ ì  ì–‘í•´ë¶€íƒë“œë¦½ë‹ˆë‹¤.)After. CompletableFuture ì ìš©Case1. ì„±ëŠ¥ ê°œì„ ë¨ìœ„ì—ì„œ ì‚´í´ë³¸ ë¡œì§ì„ ë‹¤ìŒê³¼ ê°™ì´ ë³€ê²½í•˜ì—¬ ì•½ 2ë°° ì´ìƒ ë¹ ë¥´ê²Œ ì¡°íšŒë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.public Map&lt;String, Object&gt; retrieve() { CompletableFuture&lt;Object&gt; future1 = CompletableFuture.supplyAsync(() -&gt; testProxy.findSomething(param1)); CompletableFuture&lt;Object&gt; future2 = CompletableFuture.supplyAsync(() -&gt; testProxy.findSomething(param2)); CompletableFuture&lt;Object&gt; future3 = CompletableFuture.supplyAsync(() -&gt; testProxy.findSomething(param3)); Map&lt;String, Object&gt; toClient = new HashMap&lt;&gt;(); toClient.put(\"result1\", future1.join()); toClient.put(\"result2\", future2.join()); toClient.put(\"result3\", future3.join()); return toClient;} CompletableFuture ì ìš© í›„(ì•½ 2.2ì´ˆ ì†Œìš”) (í•¸ë“œí° ì¹´ë©”ë¼ë¡œ ì°ì–´ í™”ì§ˆì´ ì¢‹ì§€ ì•Šì€ ì  ì–‘í•´ë¶€íƒë“œë¦½ë‹ˆë‹¤.)get() vs join() Futureì˜ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ ë©”ì„œë“œë¡œëŠ” get()ê³¼ join()ì´ ìˆëŠ”ë° get()ì˜ ê²½ìš° checked exception/unchecked exception, join()ì˜ ê²½ìš° unchecked exceptionì„ ë°œìƒì‹œí‚¨ë‹¤. ì¢€ ë” ê³µë¶€í•´ë´ì•¼ê² ì§€ë§Œ, í˜„ì¬ ë“œëŠ” ìƒê°ìœ¼ë¡œëŠ” get()ì—ì„œ ì²´í¬í•˜ëŠ” ExecutionException, InterruptedException, TimeoutException(timeout ì†ì„± ì‚¬ìš©ì‹œ)ì´ ë°œìƒí•˜ë”ë¼ë„ í˜¸ì¶œí•˜ëŠ” ì…ì¥ì—ì„œëŠ” ëª…í™•í•œ ë³µêµ¬ ëŒ€ì±…ì´ ì—†ì„ ê²ƒ ê°™ë‹¤. ë”°ë¼ì„œ, join()ì„ í™œìš©í•˜ê³  í˜¹ì—¬ë‚˜ ëŸ°íƒ€ì„ì‹œ ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©´ ExceptionHandler(@ControllerAdvice, @ExceptionHandler)ì—ì„œ ì²˜ë¦¬í•˜ì—¬ ê²°ê³¼ì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸(ë¸Œë¼ìš°ì €)ì— ë¬¸ì œê°€ ìƒê²¼ë‹¤ëŠ” ê²ƒì„ ì „ë‹¬í•œë‹¤. ì‚¬ìš©ìëŠ” ëª‡ ë²ˆì˜ ì¡°íšŒ ì‹œë„ë¥¼ ë” í•´ë³´ê³  ì•ˆë˜ë©´ ê´€ë¦¬ìì—ê²Œ ì—°ë½í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.CompletableFuture ì‚¬ìš©ì‹œ whileë¬¸ì„ í†µí•´ ê²°ê³¼ í™•ì¸ ?CompletableFutureë¥¼ ê³µë¶€í•˜ë©´ì„œ Futureì˜ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ê¸°ì „ì— ì‘ì—…ì´ ì™„ë£ŒëëŠ”ì§€ í™•ì¸í•˜ëŠ” ì•„ë˜ì™€ ê°™ì€ ìƒ˜í”Œì½”ë“œë¥¼ ì ‘í•  ìˆ˜ ìˆì—ˆë‹¤.ExecutorService executorService = Executors.newSingleThreadExecutor();CompletableFuture&lt;String&gt; future = new CompletableFuture&lt;&gt;(); // creating an incomplete futureexecutorService.submit(() -&gt; { Thread.sleep(500); future.complete(\"value\"); // completing the incomplete future return null;});while (!future.isDone()) { // checking the future for completion Thread.sleep(1000);}String result = future.get(); // reading value of the completed futurelogger.info(\"result: {}\", result);executorService.shutdown();ë‚´ê°€ ì•Œê¸°ë¡œ get, joinì€ ì‘ì—…ì´ ì™„ë£Œë ë•Œê¹Œì§€ blocking í•˜ëŠ” ë©”ì„œë“œì¸ë° ì™œ êµ³ì´ whileì´ í•„ìš”í• ê¹Œ? ë¼ëŠ” ìƒê°ì´ ë“¤ì–´ StackOverflowì— ì§ˆë¬¸ì„ í•´ë´¤ê³ , ê²°ê³¼ì ìœ¼ë¡œ ë‹µë³€ìë“¤ì€ whileë¬¸ì´ í•„ìš”í•˜ì§€ ì•Šë‹¤ëŠ” ë‹µë³€ì„ ë‚¨ê²¼ë‹¤. ì´ ì‚¬ëŒë“¤ë„ ëª¨ë¥´ëŠ” ë¬´ì–¸ê°€ê°€ ìˆì„ì§€ëŠ” ëª°ë¼ë„, ë‚˜ ë˜í•œ êµ³ì´ whileë¬¸ì´ í•„ìš”í•˜ì§€ ì•Šì€ ê²ƒ ê°™ë‹¤ëŠ” ìƒê°ì´ì—ˆê¸°ì— ê°œì„ í•œ ì½”ë“œì—ì„œ ì•Œ ìˆ˜ ìˆë“¯ì´ whileë¬¸ì€ ë°°ì œí–ˆë‹¤.ì°¸ê³ . StackOverflow ë‹µë³€â€œwhileë¬¸ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤ë©´ ì œ ì½”ë“œì˜ ê²½ìš° ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•´ì•¼í•˜ëŠ”ê²Œ ì¢‹ì„ê¹Œìš”?â€ ì— ëŒ€í•œ ë‹µë³€ì´ë‹¤.CompletableFuture&lt;Void&gt; allFutures = CompletableFuture.allOf(future1, future2, future3); while(!allFutures.isDone()){} Map&lt;String, Object&gt; toClient = new HashMap&lt;&gt;(); toClient.put(\"result1\", future1.get()); toClient.put(\"result2\", future2.get()); toClient.put(\"result3\", future3.get()); ë‹µë³€1. The actively blocking loop while(!allFutures.isDone()){} is not okay and will melt your CPU (100% CPU usage). If you want to wait until all futures are done, just do allFutures.join() or allFutures.get(). That will be much better. â†’ whileë¬¸ì´ CPUì— ê³¼ë¶€í•˜ë¥¼ ì¤„ ê²ƒì´ê³  get ì´ë‚˜ joinì´ë©´ ì¶©ë¶„í•˜ë‹¤. ë‹µë³€2. The first â€œCode after refactoringâ€ is fine, the subsequent stuff is horrible. Why do you think you have to compare your code to something you â€œfound somewhereâ€? Either, itâ€™s a reputable source you can cite (which also usually explains why it does something in a certain way), or itâ€™s not worth discussing. â†’ ë”ì°í•œ ì½”ë“œì´ë©°, ë‹¤ë¥¸ ì‚¬ëŒì˜ ì½”ë“œì— ê·¼ê±°ê°€ ë¶€ì¡±í•˜ë‹¤ë©´ êµ³ì´ ë¹„êµí•˜ì§€ ë§ˆë¼. (í˜¼ë‚¬ìŒ..) Case2. ì„±ëŠ¥ ê°œì„  ë˜ì§€ ì•ŠìŒë¹„ìŠ·í•œ ë¡œì§ì„ ê°€ì§„ ë‹¤ë¥¸ í™”ë©´ì—ë„ ë™ì¼í•˜ê²Œ ì ìš©í•´ë´¤ì§€ë§Œ ì„±ëŠ¥ ê°œì„ ì´ ë˜ì§€ ì•ŠëŠ” ê²½ìš°ë„ ìˆì—ˆë‹¤. ì›ì¸ì„ ì‚´í´ë³´ë‹ˆ, ì—¬ëŸ¬ ê°œì˜ ì¡°íšŒ ë©”ì„œë“œ ì¤‘, íŠ¹ì • í•˜ë‚˜ì—ì„œ ì‹œê°„ì´ ì˜¤ë˜ê±¸ë¦¬ëŠ” ê²½ìš°ì˜€ë‹¤.ê·¸ë ‡ê²Œ ë˜ë©´, ì•„ë˜ ì½”ë“œ ê¸°ì¤€ìœ¼ë¡œ retrieve()ëŠ” ê°€ì¥ ì˜¤ë˜ ê±¸ë¦¬ëŠ” ì‘ì—…(future2)ì´ ëë‚ ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼í•˜ë¯€ë¡œ, context switchingê³¼ ê°™ì€ ë©€í‹° ìŠ¤ë ˆë”© ì˜¤ë²„í—¤ë“œë¥¼ ê³ ë ¤í–ˆì„ ë•Œ,sequentialí•˜ê²Œ ì²˜ë¦¬í•˜ëŠ”ê²Œ ë” ë‚˜ì„ìˆ˜ë„ ìˆë‹¤. Case1ì˜ ê²½ìš° ì¸¡ì •í•´ë³´ë‹ˆ ì„¸ ê°œì˜ ë©”ì„œë“œê°€ ê±°ì˜ ë™ì¼í•œ ì‹œê°„ì´ ê±¸ë ¸ë‹¤.ì¦‰, ì ìš©í•˜ê³ ì í•˜ëŠ” ë¡œì§ì´ ì–´ë–¤ íŠ¹ì„±ì„ ê°–ëŠ”ì§€ íŒŒì•…í•˜ê³  ì ìš©í•´ì•¼ ê°œì„  íš¨ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.public Map&lt;String, Object&gt; retrieve() { CompletableFuture&lt;Object&gt; future1 = CompletableFuture.supplyAsync(() -&gt; testProxy.findSomething(param1)); CompletableFuture&lt;Object&gt; future2 = CompletableFuture.supplyAsync(() -&gt; testProxy.findSomething(param2)); CompletableFuture&lt;Object&gt; future3 = CompletableFuture.supplyAsync(() -&gt; testProxy.findSomething(param3)); Map&lt;String, Object&gt; toClient = new HashMap&lt;&gt;(); toClient.put(\"result1\", future1.join()); // 10ms toClient.put(\"result2\", future2.join()); // 2000ms toClient.put(\"result3\", future3.join()); // 10ms return toClient;}After. Parellel Stream ì ìš©ìœ„ì—ì„œ ì‚´í´ë³¸ ë¡œì§ì„ ë‹¤ìŒê³¼ ê°™ì´ ë³€ê²½í•˜ì˜€ê³ , ê°œì„  ì „ì— ë¹„í•´ ë¹¨ë¼ì¡Œì§€ë§Œ CompletableFutureì™€ ë¹„êµí–ˆì„ ë•ŒëŠ” ì¢€ ë” ëŠë¦° ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.ë‘˜ ë‹¤ ê¸°ë³¸ì ìœ¼ë¡œ fork-join common poolì„ ì‚¬ìš©í•˜ì§€ë§Œ, Streamì—ì„œëŠ” ê·¸ë£¹í™”í•˜ëŠ” ë¶€ë¶„(toMap()) ë•Œë¬¸ì— CompletableFutureì— ë¹„í•´ ì‹œê°„ì´ ì¢€ ë” ê±¸ë¦¬ëŠ” ê²ƒ ê°™ë‹¤.public Map&lt;String, Object&gt; retrieve() { Map&lt;String, String&gt; queries = new HashMap&lt;&gt;(); queries.put(\"result1\", \"queryId\"); queries.put(\"result2\", \"queryId2\"); queries.put(\"result3\", \"queryId3\"); return queries.entrySet().parallelStream() .collect(Collectors.toMap( e -&gt; e.getKey(), e -&gt; testProxy.findSomething(e.getValue(), params)) );} CompletableFuture ì ìš© í›„(ì•½ 3.8ì´ˆ ì†Œìš”) (í•¸ë“œí° ì¹´ë©”ë¼ë¡œ ì°ì–´ í™”ì§ˆì´ ì¢‹ì§€ ì•Šì€ ì  ì–‘í•´ë¶€íƒë“œë¦½ë‹ˆë‹¤.)ê²°ë¡  ì‚¬ì‹¤ 5ì´ˆì—ì„œ 2ì´ˆë¡œ ê°œì„ ì€ ë˜ì—ˆì§€ë§Œ, 2ì´ˆë„ ì ˆëŒ€ ë¹ ë¥¸ì†ë„ëŠ” ì•„ë‹ˆë¼ê³  ìƒê°í•œë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ë¿ ì•„ë‹ˆë¼, ê·¼ë³¸ì ì¸ ì¿¼ë¦¬ë¥¼ ìˆ˜ì •í•´ì„œ ì„±ëŠ¥ì„ ê°œì„ í•´ë³´ê³  ì‹¶ë‹¤.ì•„ì§ì€ í•™ìŠµì´ ë¶€ì¡±í•˜ê¸°ì— ì°¨ê·¼ì°¨ê·¼ ê³µë¶€í•´ì„œ ì¿¼ë¦¬ íŠœë‹ë„ í•  ìˆ˜ ìˆë„ë¡ í•´ë³´ì. supplyThen() ë“± ë‹¤ì–‘í•œ ë©”ì„œë“œë¥¼ í™œìš©í•˜ì—¬ ë¹„ë™ê¸°ì ìœ¼ë¡œ íŒŒì´í”„ë¼ì¸ì„ êµ¬ì¶•í•  ìˆ˜ ìˆë‹¤ëŠ”ê²Œ CompletableFutureì˜ í° ì¥ì ì¸ ê²ƒ ê°™ë‹¤. ì•„ì§ì€ ë§›ë³´ê¸°ì— ë¶ˆê³¼í•˜ì§€ë§Œ ì•ìœ¼ë¡œ ì ì°¨ ë‹¤ì–‘í•œ ë©”ì„œë“œë¥¼ í™œìš©í•´ì„œCompletableFutureë¥¼ ì˜ í™œìš©í•´ë³´ì. ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ ì¿¼ë¦¬ ì„±ëŠ¥ ê°œì„ " }, { "title": "Java - Exceptionê³¼ Error", "url": "/posts/java-exception-error/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-08-10 00:29:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „CompletableFutureë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¬ ë•Œ, get()ê³¼ join()ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°, get()ì˜ ê²½ìš° checkedException join()ì˜ ê²½ìš° uncheckedExceptionì„ ë°œìƒì‹œí‚¨ë‹¤ê³  í•œë‹¤.ì´ ë‘˜ì˜ ì°¨ì´ëŠ” ë¬´ì—‡ì´ê³  ê·¸ëŸ¼ ì–´ë–¤ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì•¼í• ê¹Œì— ëŒ€í•œ íŒë‹¨ì„ ë‚´ë¦¬ê¸° ìœ„í•´ ê³µë¶€í•´ë³´ì.Error vs ...", "content": "ë“¤ì–´ê°€ê¸° ì „CompletableFutureë¥¼ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¬ ë•Œ, get()ê³¼ join()ì„ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ë°, get()ì˜ ê²½ìš° checkedException join()ì˜ ê²½ìš° uncheckedExceptionì„ ë°œìƒì‹œí‚¨ë‹¤ê³  í•œë‹¤.ì´ ë‘˜ì˜ ì°¨ì´ëŠ” ë¬´ì—‡ì´ê³  ê·¸ëŸ¼ ì–´ë–¤ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ì•¼í• ê¹Œì— ëŒ€í•œ íŒë‹¨ì„ ë‚´ë¦¬ê¸° ìœ„í•´ ê³µë¶€í•´ë³´ì.Error vs ExceptionErrorì™€ Exceptionì€ ëª¨ë‘ java.lang.Throwableì˜ í•˜ìœ„ í´ë˜ìŠ¤ì´ë‹¤. ê°ê°ì˜ íŠ¹ì§•ì„ í•œ ë²ˆ ì‚´í´ë³´ì. ì¶œì²˜ : https://facingissuesonit.com/java-exception-handling/Error ì—ëŸ¬ëŠ” Unchecked Exceptionì´ë©° ê°œë°œìëŠ” ì´ ê²ƒì— ëŒ€í•œ ì–´ë– í•œ ì²˜ë¦¬ë¥¼ í•˜ì§€ ì•Šì•„ë„ëœë‹¤.(ì‚¬ì‹¤ í•  ìˆ˜ ìˆëŠ”ê²Œ ì—†ë‹¤.) ì˜ˆë¥¼ ë“¤ì–´ OutOfMemoryError, StackOverflowError ë“±ì´ ìˆë‹¤. ì¦‰, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ í•´ë‹¹ ì—ëŸ¬ë¥¼ ë³µêµ¬í•  ë°©ë²•ì´ ì—†ê¸° ë•Œë¬¸ì—, try-catch ì ˆì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ëŒ€ë¶€ë¶„ì˜ ê²½ìš° ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì¢…ë£Œë˜ë„ë¡ í—ˆìš©í•´ì•¼ í•œë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜ì¤€ì—ì„œ ë³µêµ¬í•  ë°©ë²•ì´ ì—†ëŠ” ì´ìœ ëŠ”, ëŒ€ë¶€ë¶„ì˜ ì˜¤ë¥˜ê°€ JVMì— ì˜í•´(ì‹œìŠ¤í…œ ë ˆë²¨) ë°œìƒí•˜ê¸° ë•Œë¬¸ì´ë‹¤. Exception â€˜Exception Eventâ€™ì˜ ì¤„ì„ë§ë¡œì¨, í”„ë¡œê·¸ë¨ì˜ ì •ìƒì ì¸ íë¦„ì„ ì¤‘ë‹¨(interrupt)í•˜ëŠ” ì´ë²¤íŠ¸ì´ë‹¤. ê°œë°œìê°€ ì‘ì„±í•œ ì½”ë“œì— ì˜í•´ ë°œìƒí•˜ë©°, try-catchë¥¼ í†µí•´ í‚¤ì›Œë“œë¥¼ throw í•¨ìœ¼ë¡œì¨ ë³µêµ¬í•  ìˆ˜ ìˆë‹¤. ë‘ ê°€ì§€ ìœ í˜•ì˜ ì˜ˆì™¸ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤. Checked Exception : ì»´íŒŒì¼ ì‹œì ì— ì»´íŒŒì¼ëŸ¬ì— ì˜í•´ ì²´í¬ë˜ëŠ” ì˜ˆì™¸ Unchecked Exception : ì»´íŒŒì¼ ì‹œì ì— ì»´íŒŒì¼ëŸ¬ì— ì˜í•´ ì²´í¬ë˜ì§€ ì•ŠëŠ” ì˜ˆì™¸ Exceptionê³¼ Error ë¹„êµ ìš”ì•½ Â  Exception Error ë³µêµ¬ ì—¬ë¶€ try-catch ì‚¬ìš©í•˜ì—¬ í˜¸ì¶œìì—ê²Œ ë‹¤ì‹œ ì˜ˆì™¸ throw ë¶ˆê°€ëŠ¥ ìœ í˜• Checked type, Unchecked type Unchecked type ë°œìƒ ì›ì¸ í”„ë¡œê·¸ë¨ì— ì˜í•´ ë°œìƒ ëŒ€ë¶€ë¶„ í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰ë˜ëŠ” í™˜ê²½ì— ì˜í•´ ë°œìƒ ë°œìƒ ì‹œì  ëŸ°íƒ€ì„(Checked typeì˜ ê²½ìš° ì»´íŒŒì¼ ì‹œì ì— ì»´íŒŒì¼ëŸ¬ê°€ ì²´í¬) ëŸ°íƒ€ì„ Checked Exception vs Unchecked Exceptionìë°”ì—ì„œ ì˜ˆì™¸ëŠ” ëª…ì‹œì ìœ¼ë¡œ ë°˜ë“œì‹œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” Checked Exception(SQLException, IOException ë“±)ê³¼ëª…ì‹œì ìœ¼ë¡œ ì²˜ë¦¬í•˜ì§€ ì•Šì•„ë„ ë˜ëŠ” Unchecked Exception(NullPointerException, NumberFormatException)ìœ¼ë¡œ ë‚˜ëˆ ì§„ë‹¤.Unchecked Exceptionì€ RuntimeExceptionì„ ìƒì†ë°›ëŠ”ë‹¤.ì˜ˆì™¸ ì²˜ë¦¬ì˜ ê°•ì œì„±ì— ëŒ€í•´ìë°” ê³µì‹ë¬¸ì„œ ì— ë³´ë©´ ì˜ˆì™¸ ì²˜ë¦¬ì™€ ê´€ë ¨í•˜ì—¬ ì„¤ëª…í•˜ê³  ìˆë‹¤. Checked Exceptionì˜ ê²½ìš° ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ê°•ì œí•˜ëŠ” ì´ìœ  í•´ë‹¹ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆëŠ” ì—¬ì§€ë¥¼ í¬í•¨í•˜ê³  ìˆëŠ” ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” í˜¸ì¶œìê°€ ì˜ˆì™¸ì— ëŒ€í•´ ì¸ì§€í•˜ê³  ì ì ˆí•˜ê²Œ ì²˜ë¦¬í•˜ë„ë¡ í•  ìˆ˜ ìˆê²Œ í•˜ê¸° ìœ„í•´. public FileInputStream(File file) throws FileNotFoundException { String name = (file != null ? file.getPath() : null); SecurityManager security = System.getSecurityManager(); if (security != null) { security.checkRead(name); } if (name == null) { throw new NullPointerException(); } if (file.isInvalid()) { throw new FileNotFoundException(\"Invalid file path\"); } fd = new FileDescriptor(); fd.attach(this); path = name; open(name);}public FileInputStream(String name) throws FileNotFoundException { this(name != null ? new File(name) : null);}private static void checkedExceptionWithTryCatch() { File file = new File(\"not_existing_file.txt\"); try { FileInputStream stream = new FileInputStream(file); } catch (FileNotFoundException e) { e.printStackTrace(); }} ì™œ Unchecked Excpetionì˜ ê²½ìš°ëŠ” ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ê°•ì œí•˜ì§€ ì•Šì•˜ì„ê¹Œ? Runtime Exceptionì€ í”„ë¡œê·¸ë¨ì˜ ì–´ë””ì—ì„œë‚˜ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë©° ë§¤ìš° ë‹¤ì–‘í•œ ê²½ìš°ê°€ ìˆë‹¤. ë§Œì•½, ëª¨ë“  ë©”ì„œë“œ ì„ ì–¸ì— ì´ëŸ¬í•œ ì˜ˆì™¸ë¥¼ ì¶”ê°€í•´ì•¼ í•˜ë©´ í”„ë¡œê·¸ë¨ì˜ ëª…í™•ì„±ì´ ë–¨ì–´ì§„ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë°°ì—´ì„ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œì—ì„œ ArrayIndexOutOfBoundException, ê°ì²´ ì°¸ì¡°í•˜ëŠ” ì½”ë“œê°€ ìˆëŠ” ê³³ì—ì„œ NullPointerException ì¼ì¼ì´ ì²˜ë¦¬í•´ì¤˜ì•¼í•œë‹¤ë©´ ì½”ë“œê°€ ë§¤ìš° ì§€ì €ë¶„í•´ì§ˆ ê²ƒì´ë‹¤. ê²°ë¡ ì ìœ¼ë¡œ, í•´ë‹¹ ê¸€ì—ì„œëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë§ˆë¬´ë¦¬í•œë‹¤. í´ë¼ì´ì–¸íŠ¸(í˜¸ì¶œì)ê°€ ì˜ˆì™¸ë¡œë¶€í„° ë³µêµ¬í•  ê²ƒìœ¼ë¡œ í•©ë¦¬ì ìœ¼ë¡œ ê¸°ëŒ€í•  ìˆ˜ ìˆëŠ” ê²½ìš° checked exceptionì„ ì‚¬ìš©í•  ê²ƒ. í´ë¼ì´ì–¸íŠ¸(í˜¸ì¶œì)ê°€ ì˜ˆì™¸ì—ì„œ ë³µêµ¬í•˜ê¸° ìœ„í•´ ì•„ë¬´ ê²ƒë„ í•  ìˆ˜ ì—†ìœ¼ë©´ unchecked exceptionì„ ì‚¬ìš©í•  ê²ƒ. ì‹¤ì œë¡œ ì ìš©í•´ë³´ê¸° completableFuture ì‚¬ìš©ì‹œ get(), fork() ì¤‘ ì–´ë–¤ ê²ƒì„ ì‚¬ìš©í•´ì•¼í• ê¹Œ?ì°¸ê³ ìë£Œ https://stackoverflow.com/questions/5813614/what-is-difference-between-errors-and-exceptions https://madplay.github.io/post/java-checked-unchecked-exceptions https://cheese10yun.github.io/checked-exception/#unchecked-exception-1 https://www.geeksforgeeks.org/errors-v-s-exceptions-in-java/ https://docs.oracle.com/javase/tutorial/essential/exceptions/runtime.html https://www.baeldung.com/java-checked-unchecked-exceptions" }, { "title": "Java - ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•œ ìë°” í´ë˜ìŠ¤ ì‚´í´ë³´ê¸°", "url": "/posts/java-asyncronous-programming/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-08-09 00:29:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „íšŒì‚¬ì—ì„œ í™”ë©´ ì¡°íšŒ ì„±ëŠ¥ ê°œì„ ì„ ìœ„í•´ ì–´ë–¤ ë¶€ë¶„ì„ ë¦¬íŒ©í† ë§ í•˜ë©´ë ê¹Œ ê³ ë¯¼í•˜ë˜ ì¤‘, ëª‡ëª‡ í™”ë©´ì´ í˜¸ì¶œí•˜ëŠ” apiì—ì„œ ìˆ˜í–‰í•˜ëŠ” ë¡œì§ì´ ê°ê° ë…ë¦½ì ì¸ ì¡°íšŒ ê²°ê³¼ë“¤ì„ Mapì— ë‹´ì•„ í™”ë©´ì— ë¦¬í„´í•´ì£¼ëŠ” í˜•íƒœë¡œ ë˜ì–´ìˆëŠ” ê²ƒì„ ë³´ì•˜ë‹¤.ë”°ë¼ì„œ, ì´ëŸ° ê²½ìš° ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤ë©´ ì„±ëŠ¥ì´ ê°œì„ ë˜ì§€ ì•Šì„ê¹Œ ? í•˜ëŠ” ìƒê°ì´ë“¤ì–´ ì–´ë–¤ì‹ìœ¼ë¡œ ìë°”ì—ì„œ ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°...", "content": "ë“¤ì–´ê°€ê¸° ì „íšŒì‚¬ì—ì„œ í™”ë©´ ì¡°íšŒ ì„±ëŠ¥ ê°œì„ ì„ ìœ„í•´ ì–´ë–¤ ë¶€ë¶„ì„ ë¦¬íŒ©í† ë§ í•˜ë©´ë ê¹Œ ê³ ë¯¼í•˜ë˜ ì¤‘, ëª‡ëª‡ í™”ë©´ì´ í˜¸ì¶œí•˜ëŠ” apiì—ì„œ ìˆ˜í–‰í•˜ëŠ” ë¡œì§ì´ ê°ê° ë…ë¦½ì ì¸ ì¡°íšŒ ê²°ê³¼ë“¤ì„ Mapì— ë‹´ì•„ í™”ë©´ì— ë¦¬í„´í•´ì£¼ëŠ” í˜•íƒœë¡œ ë˜ì–´ìˆëŠ” ê²ƒì„ ë³´ì•˜ë‹¤.ë”°ë¼ì„œ, ì´ëŸ° ê²½ìš° ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤ë©´ ì„±ëŠ¥ì´ ê°œì„ ë˜ì§€ ì•Šì„ê¹Œ ? í•˜ëŠ” ìƒê°ì´ë“¤ì–´ ì–´ë–¤ì‹ìœ¼ë¡œ ìë°”ì—ì„œ ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ì„ í•˜ë©´ë˜ëŠ”ì§€ ê³µë¶€í•´ë³´ì•˜ë‹¤.Thread ìë°”ì—ì„œ ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°ì„ ìœ„í•œ ì²« ë²ˆì§¸ ë°©ë²•ì€ JDK 1.0ì— ìˆëŠ” Runnable ì¸í„°í˜ì´ìŠ¤ì™€ Thread í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ë‹¤. í´ë˜ìŠ¤ëŠ” Runnableì„ êµ¬í˜„í•˜ê³  run() ë©”ì„œë“œë¥¼ ì¬ì •ì˜í•˜ê±°ë‚˜, Threadë¥¼ ìƒì†ë°›ì•„ ë™ì¼í•œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. ì°¨ì´ì ì€ ì‹¤í–‰ ë©”ì„œë“œê°€ Runnableì—ì„œ ì§ì ‘ í˜¸ì¶œë  ë•Œ ìƒˆ ìŠ¤ë ˆë“œê°€ ìƒì„±ë˜ì§€ ì•Šê³  í˜¸ì¶œ ì¤‘ì¸ ìŠ¤ë ˆë“œì—ì„œ ì‹¤í–‰ëœë‹¤. thread.start()ë¥¼ ìˆ˜í–‰í•˜ë©´ ìƒˆ ìŠ¤ë ˆë“œê°€ ìƒì„±ëœë‹¤. JDK 1.5ì˜ ìŠ¤ë ˆë“œ ê´€ë¦¬ë¥¼ ê°œì„ í•˜ê¸° ìœ„í•´ Executor í”„ë ˆì„ì›Œí¬ê°€ ë“±ì¥í–ˆë‹¤. ë”°ë¼ì„œ, ì—¬ëŸ¬ ìŠ¤ë ˆë“œ í’€ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, ìˆ˜ë™ìœ¼ë¡œ ìŠ¤ë ˆë“œë¥¼ ì‘ì„±í•  í•„ìš”ê°€ ì—†ë‹¤. ë˜í•œ, ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìœ¼ë©° ìŠ¤ë ˆë“œë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. ì´ì „ì— ê³µë¶€í–ˆë“¯ì´, ë©€í‹° ìŠ¤ë ˆë”©ì„ ìœ„í•´ì„œëŠ” ìŠ¤ë ˆë“œ í’€ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¥ì ì´ ë§ê¸° ë•Œë¬¸ì— ì¼ë°˜ì ìœ¼ë¡œëŠ” ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•´ êµ³ì´ ìŠ¤ë ˆë“œë¥¼ ì§ì ‘ ìƒì„±í•˜ê³  ê´€ë¦¬í•˜ì§„ ì•ŠëŠ” ê²ƒ ê°™ë‹¤.Future Java 5 ë¶€í„°, Future ì¸í„°í˜ì´ìŠ¤ëŠ” FutureTaskë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸° ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ë°©ë²•ì„ ì œê³µí•œë‹¤. ExecutorServiceì˜ sumbit() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³  FutureTask ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤. ì´ ê°ì²´ëŠ” ì‘ì—…ì´ ëë‚˜ë©´ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤ëŠ” ì•½ì†(promise)ì´ë©°, get() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ ê²°ê³¼ë¥¼ ì–»ëŠ”ë‹¤. ExecutorService threadpool = Executors.newCachedThreadPool();Future&lt;Long&gt; futureTask = threadpool.submit(() -&gt; factorial(number));while (!futureTask.isDone()) { System.out.println(\"FutureTask is not finished yet...\");}long result = futureTask.get();threadpool.shutdown();Futureì˜ í•œê³„ Future APIëŠ” ëª‡ ê°€ì§€ ì¤‘ìš”í•˜ê³  ìœ ìš©í•œ ê¸°ëŠ¥ì´ ë¶€ì¡±í•˜ë‹¤.1. ìˆ˜ë™ìœ¼ë¡œ ì™„ë£Œë  ìˆ˜ ì—†ë‹¤. ì™¸ë¶€ APIë¥¼ í˜¸ì¶œí•˜ëŠ” ë“±ì˜ ê³¼ì •ì„ ê±°ì³ ê²°ê³¼ì ìœ¼ë¡œ Futureë¥¼ ë°˜í™˜í•˜ëŠ” ë©”ì„œë“œê°€ ìˆë‹¤ê³  ê°€ì •í•˜ì. ë§Œì•½ API ì„œë¹„ìŠ¤ê°€ ë‹¤ìš´ëœ ê²½ìš°, ìºì‹œëœ ê°€ì¥ ìµœê·¼ì˜ ê°’ ë“±ì„ Futureì— ì„¸íŒ…í•˜ì—¬ ìˆ˜ë™ìœ¼ë¡œ ë¦¬í„´í•œë‹¤ë©´ ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•Šì„ ê²ƒì´ë‹¤. í•˜ì§€ë§Œ, Futureì— ì´ëŸ¬í•œ ê¸°ëŠ¥ì€ ì—†ë‹¤.2. ë¸”ë¡œí‚¹ ì—†ì´ ì¶”ê°€ì ì¸ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ì—†ë‹¤. Futureì— ì½œë°± í•¨ìˆ˜ë¥¼ ì¶”ê°€í•˜ê³  Futureì˜ ê²°ê³¼ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ë•Œ, ìë™ìœ¼ë¡œ í˜¸ì¶œí•˜ë„ë¡ í•  ìˆ˜ ì—†ë‹¤. ì¦‰, ê²°ê³¼ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆì„ ë•Œê¹Œì§€ ë¸”ë¡œí‚¹í•˜ëŠ” get() ë©”ì„œë“œë§Œ ì œê³µí•œë‹¤. 3. ì—¬ëŸ¬ê°œì˜ ì‘ì—…ì„ ë³‘í•©í•  ìˆ˜ ì—†ë‹¤. ë³‘ë ¬ë¡œ ì‹¤í–‰í•˜ë ¤ëŠ” 10ê°œì˜ ì‘ì—…ì´ ìˆê³  ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œëœ í›„ ì¼ë¶€ ê¸°ëŠ¥ì„ ì‹¤í–‰í•œë‹¤ê³  ê°€ì •í–ˆì„ ë•Œ, Futureì—ëŠ” 10ê°œë¥¼ í•œêº¼ë²ˆì— ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì€ ì—†ë‹¤.4. ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤. Future APIì—ëŠ” ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”ì„œë“œ ë“±ì´ ì—†ë‹¤.CompletableFuture ìœ„ì—ì„œ ì‚´í´ë´¤ë“¯ì´ Futureì—ëŠ” ì—¬ëŸ¬ê°€ì§€ í•œê³„ì ì´ ìˆì—ˆë‹¤. ë”°ë¼ì„œ, ìë°”8ì—ì„œëŠ” Futureë¥¼ ì—…ê·¸ë ˆì´ë“œ ì‹œí‚¨ CompletableFutureê°€ ë“±ì¥í–ˆë‹¤. CompletableFutureëŠ” Future ë¿ì•„ë‹ˆë¼ CompletionStage ì¸í„°í˜ì´ìŠ¤ë„ êµ¬í˜„í•œë‹¤. CompletionStageëŠ” ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ì„œ ê³„ì‚°ëœ ê²°ê³¼ë¥¼ ê°„ë‹¨í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤. ì¦‰, ì¤‘ì²©ëœ ì½œë°±(callback hell) ì—†ì´ ë‹¨ì¼ ê²°ê³¼ì— ì—¬ëŸ¬ ë¹„ë™ê¸° ì—°ì‚°ì„ ì—°ê²°, ê²°í•©í•˜ëŠ” íŒŒì´í”„ë¼ì¸ì„ ì§€ì›í•œë‹¤. CompletableFuture&lt;Integer&gt; priceInEur = CompletableFuture.supplyAsync(this::getPriceInEur);CompletableFuture&lt;Integer&gt; exchangeRateEurToUsd = CompletableFuture.supplyAsync(this::getExchangeRateEurToUsd);CompletableFuture&lt;Integer&gt; netAmountInUsd = priceInEur .thenCombine(exchangeRateEurToUsd, (price, exchangeRate) -&gt; price * exchangeRate);logger.info(\"this task started\");netAmountInUsd .thenCompose(amount -&gt; CompletableFuture.supplyAsync(() -&gt; amount * (1 + getTax(amount)))) .whenComplete((grossAmountInUsd, throwable) -&gt; { if (throwable == null) { logger.info(\"this task finished: {}\", grossAmountInUsd); } else { logger.warn(\"this task failed: {}\", throwable.getMessage()); } }); // non-blockinglogger.info(\"another task started\"); ë‚´ë¶€ì ìœ¼ë¡œ ForkJoinPoolì„ ì‚¬ìš©í•˜ì—¬ ì‘ì—…ì„ ë¹„ë™ê¸°ì‹ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤. ì¦‰, ì „ì—­ ForkJoinPool.commonPool()ë©”ì„œë“œì—ì„œ ì–»ì€ ìŠ¤ë ˆë“œì—ì„œ ì‘ì—…ì„ ì‹¤í–‰í•œë‹¤. ForkJoinPool.commonPool() ë©”ì„œë“œì— ì˜í•´ ë°˜í™˜ëœ ìŠ¤ë ˆë“œ í’€ì€ ëª¨ë“  CompletableFutures ë° ëª¨ë“  ë³‘ë ¬ ìŠ¤íŠ¸ë¦¼ì— ì˜í•´ JVM ì „ì²´ì—ì„œ ê³µìœ ëœë‹¤. ì „ì—­ì ìœ¼ë¡œ ê³µìœ ë˜ê¸° ë•Œë¬¸ì— common pool ì‚¬ìš©ì‹œ ì£¼ì˜í•´ì•¼ í•œë‹¤.(ì‹¤ì œ ì¥ì•  ì‚¬ë¡€) private static final Executor ASYNC_POOL = USE_COMMON_POOL ? ForkJoinPool.commonPool() : new ThreadPerTaskExecutor(); ì‚¬ìš©ìê°€ ìŠ¤ë ˆë“œ í’€ì„ ëª…ì‹œì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ í•´ë‹¹ ìŠ¤ë ˆë“œ í’€ì—ì„œ ê°€ì ¸ì˜¨ ìŠ¤ë ˆë“œë¡œ ì‘ì—…ì„ ì²˜ë¦¬í•  ìˆ˜ë„ ìˆë‹¤. ì¦‰, CompletableFutureì˜ ì—¬ëŸ¬ ë©”ì†Œë“œì—ëŠ” ë‘ ê°€ì§€ ë³€í˜•ì´ ìˆë‹¤. í•˜ë‚˜ëŠ” ì‚¬ìš©ìê°€ ìƒì„±í•œ ìŠ¤ë ˆë“œ í’€ì„ ì‚¬ìš©í•˜ê³ , ë‹¤ë¥¸ í•˜ë‚˜ëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ìƒì„±ëœ ìŠ¤ë ˆë“œ í’€ì„ ì‚¬ìš©í•œë‹¤. public static &lt;U&gt; CompletableFuture&lt;U&gt; supplyAsync(Supplier&lt;U&gt; supplier) { return asyncSupplyStage(ASYNC_POOL, supplier);}public static &lt;U&gt; CompletableFuture&lt;U&gt; supplyAsync(Supplier&lt;U&gt; supplier, Executor executor) { return asyncSupplyStage(screenExecutor(executor), supplier);} CompletableFuture&lt;Long&gt; completableFuture = CompletableFuture.supplyAsync(() -&gt; factorial(number));long result = completableFuture.get(); CompletableFuture ë©”ì„œë“œ ì‚´í´ë³´ê¸° CompletableFuture ë©”ì„œë“œëŠ” í¬ê²Œ 5ê°œ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ë‰  ìˆ˜ ìˆë‹¤. CompletableFuture ìƒì„± ì‘ì—… ì™„ë£Œ ìƒíƒœ ì²´í¬ ì‘ì—… ì™„ë£Œ ì‹œí‚¤ê¸° ì²˜ë¦¬ ê²°ê³¼ ì½ê¸° ì—¬ëŸ¬ê°œì˜ ì‘ì—… ì²˜ë¦¬(bulk futures) ì¶œì²˜ : https://www.linkedin.com/pulse/asynchronous-programming-java-completablefuture-aliaksandr-liakh 1. CompletableFuture ìƒì„± ë©”ì„œë“œ ì¼ë°˜ì ìœ¼ë¡œ í•œ ìŠ¤ë ˆë“œì—ì„œ ì™„ë£Œë˜ì§€ ì•Šì€ Futureê°€ ìƒì„±ë˜ê³  ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ì„œ ì™„ë£Œëœë‹¤. ê·¸ëŸ¬ë‚˜ ê²½ìš°ì— ë”°ë¼ ì´ë¯¸ ì™„ë£Œëœ Futureë¥¼ ë§Œë“¤ ìˆ˜ë„ ìˆë‹¤. íŒŒë¼ë¯¸í„°ê°€ ì—†ëŠ” CompletableFuture ìƒì„±ìëŠ” ì™„ë£Œë˜ì§€ ì•Šì€ Futureë¥¼ ìƒì„±í•œë‹¤. ì¶œì²˜ : https://www.linkedin.com/pulse/asynchronous-programming-java-completablefuture-aliaksandr-liakh 2. ì™„ë£Œ ìƒíƒœ ì²´í¬ ë©”ì„œë“œ CompletableFuture í´ë˜ìŠ¤ì—ëŠ” ì‘ì—…ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ëŠ”ì§€, ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆëŠ”ì§€, ì˜ˆì™¸ì ìœ¼ë¡œ ì™„ë£Œë˜ì—ˆëŠ”ì§€, ì·¨ì†Œë˜ì—ˆëŠ”ì§€ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ê¸° ìœ„í•œ non-blocking ë©”ì„œë“œê°€ ìˆë‹¤. ì´ë¯¸ ì™„ë£Œëœ ì‘ì—…ì€ ì·¨ì†Œê°€ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ì¶œì²˜ : https://www.linkedin.com/pulse/asynchronous-programming-java-completablefuture-aliaksandr-liakh 3. ì‘ì—… ì™„ë£Œë¥¼ ìœ„í•œ ë©”ì„œë“œ CompletableFutureì—ëŠ” ì•„ì§ ì™„ë£Œë˜ì§€ ì•Šì€ ì‘ì—…ì„ ì •ìƒì™„ë£Œ, ì˜ˆì™¸ì™„ë£Œ, ì·¨ì†Œ ìƒíƒœë¥¼ ê°–ëŠ” ì™„ë£Œëœ ì‘ì—…ìœ¼ë¡œ ë°”ê¾¸ëŠ” ë©”ì„œë“œê°€ ìˆë‹¤. cancel ë©”ì„œë“œê°€ í˜¸ì¶œë˜ë©´ CancellationExceptionê³¼ í•¨ê»˜ ì—°ì‚°ì´ ì·¨ì†Œëœë‹¤. í•˜ì§€ë§Œ, í•´ë‹¹ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ìŠ¤ë ˆë“œë¥¼ ì¤‘ë‹¨í•˜ê¸° ìœ„í•œ Thread.interrupt()ëŠ” í˜¸ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤. ì¶œì²˜ : https://www.linkedin.com/pulse/asynchronous-programming-java-completablefuture-aliaksandr-liakh 4. ì²˜ë¦¬ ê²°ê³¼ ì½ê¸° ë©”ì„œë“œ CompletableFutureëŠ” ì‘ì—…ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì½ëŠ”(ì•„ì§ ì™„ë£Œë˜ì§€ ì•Šì€ ê²½ìš°ëŠ” ëŒ€ê¸°) ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤. ì´ëŸ¬í•œ ë©”ì„œë“œëŠ” ëŒ€ë¶€ë¶„ì˜ ê²½ìš°, ê³„ì‚° íŒŒì´í”„ë¼ì¸ì˜ ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ ì‚¬ìš©í•´ì•¼ í•œë‹¤. get(), get(timeout, timeUnit) ë©”ì„œë“œëŠ” â€˜checked exceptionâ€™ì„ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤. ExecutionException : ì‘ì—…ì´ ì˜ˆì™¸ì ìœ¼ë¡œ ì™„ë£Œëœ ê²½ìš° InterruptedException : í˜„ì¬ ìŠ¤ë ˆë“œê°€ ì¤‘ë‹¨ëœ ê²½ìš° TimeoutException : get(timeout, timeUnit) ë©”ì„œë“œ ì‚¬ìš©ì‹œ íƒ€ì„ì•„ì›ƒ ë°œìƒí•˜ëŠ” ê²½ìš° join(), getNow(valueIfAbsent) ë©”ì„œë“œëŠ” â€˜unchecked exceptionâ€™ì„ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤. CompletionException : ì‘ì—…ì´ ì˜ˆì™¸ì ìœ¼ë¡œ ì™„ë£Œë˜ëŠ” ê²½ìš° ì‘ì—…ì´ ì·¨ì†Œë˜ëŠ” ê²½ìš°, ëª¨ë“  ë©”ì„œë“œê°€ CancellationException(unchecked exception)ì„ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤. ì¶œì²˜ : https://www.linkedin.com/pulse/asynchronous-programming-java-completablefuture-aliaksandr-liakh 5. ì—¬ëŸ¬ê°œì˜ ì‘ì—… ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”ì„œë“œ CompletableFutureì—ëŠ” ë§ì€ ì‘ì—…ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ëŒ€ê¸°í•˜ëŠ” ë‘ ê°€ì§€ ì •ì  ë©”ì„œë“œê°€ ìˆë‹¤. ê°ê° ë‹¤ë¥¸ íƒ€ì…ì˜ CompletableFutureê°€ ë©”ì„œë“œ íŒŒë¼ë¯¸í„°ë¡œ ì…ë ¥ë  ìˆ˜ ìˆë‹¤. ì •ì˜ëœ íŒŒë¼ë¯¸í„° : CompletableFuture&lt;?&gt;... cfs ì¶œì²˜ : https://www.linkedin.com/pulse/asynchronous-programming-java-completablefuture-aliaksandr-liakh CompletionStage CompletionStage ì¸í„°í˜ì´ìŠ¤ëŠ” ì—¬ëŸ¬ ë‹¨ê³„ë¥¼ ê±°ì¹˜ëŠ” ì—°ì‚°ì—ì„œ, fork, chain, joiní•  ìˆ˜ ìˆëŠ” ê° ë‹¨ê³„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ë˜í•œ, future/promise êµ¬í˜„ì— ëŒ€í•œ íŒŒì´í”„ë¼ì´ë‹ì„ ëª…ì‹œí•œë‹¤. íŒŒì´í”„ë¼ì´ë‹ ê° ë‹¨ê³„ëŠ” ì—°ì‚°ì„ ìˆ˜í–‰í•œë‹¤. ê°’ì„ ê³„ì‚°í•˜ê±°ë‚˜(ê²°ê³¼ ë°˜í™˜) ì‘ì—… ìˆ˜í–‰ë§Œ í•  ìˆ˜ë„ ìˆë‹¤(ê²°ê³¼ ë°˜í™˜ ì•ˆ í•¨). ê° ë‹¨ê³„ë¥¼ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ì—°ê²°í•œë‹¤. í•˜ë‚˜ ë˜ëŠ” ë‘ ê°œì˜ ì´ì „ ë‹¨ê³„ë¥¼ ì™„ë£Œí•˜ì—¬ í˜„ì¬ ë‹¨ê³„ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆë‹¤. ê° ë‹¨ê³„ëŠ” ì—°ì‚°ì´ ì™„ë£Œë˜ë©´ ì¢…ë£Œëœë‹¤. ê° ë‹¨ê³„ëŠ” ë™ê¸°ì‹ ë˜ëŠ” ë¹„ë™ê¸°ì‹ìœ¼ë¡œ ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤. ì²˜ë¦¬ë  ë°ì´í„°ì— ë”°ë¼ ì ì ˆí•œ ë°©ë²•ì„ ì„ íƒí•´ì•¼ í•œë‹¤. CompletionStage ì¸í„°í˜ì´ìŠ¤ì˜ ë©”ì„œë“œëŠ” í¬ ë‘ ê·¸ë£¹ìœ¼ë¡œ ë‚˜ëˆŒ ìˆ˜ ìˆë‹¤. íŒŒì´í”„ë¼ì´ë‹ ì—°ì‚°ì„ ìœ„í•œ ë©”ì„œë“œ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”ì„œë“œ ì¶œì²˜ : https://www.linkedin.com/pulse/asynchronous-programming-java-completablefuture-aliaksandr-liakh 1. íŒŒì´í”„ë¼ì´ë‹ ì—°ì‚°ì„ ìœ„í•œ ë©”ì„œë“œ CompletionStage ì¸í„°í˜ì´ìŠ¤ì—ëŠ” 43ê°œì˜ public ë©”ì„œë“œê°€ ìˆìœ¼ë©°, ëŒ€ë¶€ë¶„ ì„¸ ê°€ì§€ì˜ ì´ë¦„ íŒ¨í„´ì„ ê°–ëŠ”ë‹¤.ì²«ì§¸, ìƒˆë¡œìš´ ë‹¨ê³„ê°€ ì‹œì‘ë˜ëŠ” ë°©ë²•ì„ ì„¤ëª…í•œë‹¤. ë©”ì„œë“œ ì´ë¦„ì— â€œthenâ€ì´ ìˆìœ¼ë©´, í•˜ë‚˜ì˜ ì´ì „ ë‹¨ê³„ê°€ ì™„ë£Œëœ í›„ ìƒˆ ë‹¨ê³„ê°€ ì‹œì‘ëœë‹¤. ë©”ì„œë“œ ì´ë¦„ì— â€œeitherâ€ê°€ ìˆìœ¼ë©´, ì´ì „ ë‘ ë‹¨ê³„ ì¤‘ ì²« ë²ˆì§¸ ë‹¨ê³„ê°€ ì™„ë£Œëœ í›„ ìƒˆ ë‹¨ê³„ê°€ ì‹œì‘ëœë‹¤. ë©”ì„œë“œ ì´ë¦„ì— â€œbothâ€ê°€ ìˆìœ¼ë©´, ì´ì „ ë‘ ë‹¨ê³„ë¥¼ ëª¨ë‘ ì™„ë£Œí•œ í›„ ìƒˆ ë‹¨ê³„ê°€ ì‹œì‘ëœë‹¤.ë‘˜ì§¸, ìƒˆë¡œìš´ ë‹¨ê³„ê°€ ìˆ˜í–‰í•˜ëŠ” ì—°ì‚°ì— ëŒ€í•´ ì„¤ëª…í•œë‹¤. ë©”ì„œë“œ ì´ë¦„ì— â€œapplyâ€ê°€ ìˆìœ¼ë©´, ìƒˆë¡œìš´ ë‹¨ê³„ëŠ” ì£¼ì–´ì§„ Functionì„ ê¸°ì¤€ìœ¼ë¡œ ì¸ìˆ˜ë¥¼ ë³€í™˜í•œë‹¤. ë©”ì„œë“œ ì´ë¦„ì— â€œacceptâ€ê°€ ìˆìœ¼ë©´, ìƒˆë¡œìš´ ë‹¨ê³„ëŠ” ì£¼ì–´ì§„ Consumerë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì¸ìˆ˜ë¥¼ ì²˜ë¦¬í•œë‹¤. ë©”ì„œë“œ ì´ë¦„ì— â€œrunâ€ì´ ìˆìœ¼ë©´, ìƒˆë¡œìš´ ë‹¨ê³„ëŠ” ì£¼ì–´ì§„ Runnableë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤. ì¶œì²˜ : https://www.linkedin.com/pulse/asynchronous-programming-java-completablefuture-aliaksandr-liakh ì…‹ì§¸, ì–´ë–¤ ìŠ¤ë ˆë“œê°€ ìƒˆë¡œìš´ ë‹¨ê³„ë¥¼ ì‹¤í–‰í•˜ëŠ”ì§€ ì„¤ëª…í•œë‹¤. ë©”ì„œë“œì— â€œsomething(â€¦)â€ì˜ í˜•íƒœì´ë©´, ìƒˆ ë‹¨ê³„ëŠ” ê¸°ë³¸ ìŠ¤ë ˆë“œ í’€ì— ì˜í•´ ì‹¤í–‰ëœë‹¤.(ë™ê¸° ë˜ëŠ” ë¹„ë™ê¸°) ë©”ì„œë“œì— â€œsomethingAsync()â€ì˜ í˜•íƒœì´ë©´, ìƒˆ ë‹¨ê³„ëŠ” ê¸°ë³¸ ë¹„ë™ê¸° ìŠ¤ë ˆë“œ í’€(ForkJoinPool)ì— ì˜í•´ ì‹¤í–‰ëœë‹¤. ë©”ì„œë“œì— â€œsomethingAsync(â€¦, Executor))â€ì˜ í˜•íƒœì´ë©´,ìƒˆ ë‹¨ê³„ëŠ”ì§€ì •ëœ Executor(ì‚¬ìš©ì ì •ì˜ ìŠ¤ë ˆë“œ í’€)ì— ì˜í•´ ì‹¤í–‰ëœë‹¤.CompletableFuture&lt;Double&gt; pi = CompletableFuture.supplyAsync(() -&gt; Math.PI);CompletableFuture&lt;Integer&gt; radius = CompletableFuture.supplyAsync(() -&gt; 1);// area of a circle = Ï€ * r^2CompletableFuture&lt;Void&gt; area = radius .thenApply(r -&gt; r * r) .thenCombine(pi, (multiplier1, multiplier2) -&gt; multiplier1 * multiplier2) .thenAccept(a -&gt; logger.info(\"area: {}\", a)) .thenRun(() -&gt; logger.info(\"operation completed\"));area.join();2. ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”ì„œë“œ ê° ë‹¨ê³„ë³„ ì—°ì‚°ì€ ì •ìƒì ìœ¼ë¡œ ë˜ëŠ” ì˜ˆì™¸ì ìœ¼ë¡œ ì™„ë£Œë  ìˆ˜ ìˆë‹¤.ë˜í•œ, ë¹„ë™ê¸° ì—°ì‚°ì—ì„œëŠ” ì˜ˆì™¸ê°€ ë°œìƒí•œ ê³³ê³¼ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”ì„œë“œëŠ” ì„œë¡œ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì— ìˆì„ ìˆ˜ ìˆë‹¤.ë”°ë¼ì„œ ì´ ê²½ìš° try-catch-finally ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì—CompletionStageëŠ” ì˜ˆì™¸ë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ íŠ¹ë³„í•œ ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤. ì´ì „ ë‹¨ê³„ê°€ ì •ìƒì ìœ¼ë¡œ ì™„ë£Œë˜ë©´, ë‹¤ìŒ ë‹¨ê³„ê°€ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ë˜ê¸° ì‹œì‘í•©ë‹ˆë‹¤. ì´ì „ ë‹¨ê³„ê°€ ì˜ˆì™¸ì ìœ¼ë¡œ ì™„ë£Œë˜ë©´, íŒŒì´í”„ë¼ì¸ì— ì˜ˆì™¸ ë³µêµ¬ ë‹¨ê³„ê°€ ì—†ëŠ” í•œ ë‹¤ìŒ ë‹¨ê³„ëŠ” ì˜ˆì™¸ì ìœ¼ë¡œ ì™„ë£Œëœë‹¤. whenComplete ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ê²°ê³¼(ì—†ëŠ” ê²½ìš° null)ì™€ ì˜ˆì™¸(ì—†ëŠ” ê²½ìš° null)ë¥¼ ëª¨ë‘ ì½ì„ ìˆ˜ ìˆì§€ë§Œ ê²°ê³¼ë¥¼ ë³€ê²½í•  ìˆ˜ëŠ” ì—†ìŠµë‹ˆë‹¤. ì˜ˆì™¸ ë°œìƒì‹œ ë³µêµ¬í•´ì•¼ í•˜ëŠ” ê²½ìš° handleê³¼ exceptionally ë©”ì„œë“œë¥¼ ì‚¬ìš©í•œë‹¤. handle ë©”ì†Œë“œì˜ BiFunction ì¸ìˆ˜ëŠ” ì´ì „ ë‹¨ê³„ê°€ ì •ìƒì ìœ¼ë¡œ ë˜ëŠ” ì˜ˆì™¸ì ìœ¼ë¡œ ì™„ë£Œë  ë•Œ ëª¨ë‘ í˜¸ì¶œëœë‹¤. exceptionally ë©”ì„œë“œì˜ Function ì¸ìˆ˜ëŠ” ì´ì „ ë‹¨ê³„ê°€ ì˜ˆì™¸ì ìœ¼ë¡œ ì™„ë£Œë  ë•Œ í˜¸ì¶œëœë‹¤. ë‘ ê²½ìš° ëª¨ë‘ ì˜ˆì™¸ê°€ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì „íŒŒë˜ì§€ ì•ŠëŠ”ë‹¤. ì¶œì²˜ : https://www.linkedin.com/pulse/asynchronous-programming-java-completablefuture-aliaksandr-liakh CompletableFuture.supplyAsync(() -&gt; 0) .thenApply(i -&gt; { logger.info(\"stage 1: {}\", i); return 1 / i; }) // executed and failed .thenApply(i -&gt; { logger.info(\"stage 2: {}\", i); return 1 / i; }) // skipped .whenComplete((value, t) -&gt; { if (t == null) { logger.info(\"success: {}\", value); } else { logger.warn(\"failure: {}\", t.getMessage()); // executed } }) .thenApply(i -&gt; { logger.info(\"stage 3: {}\", i); return 1 / i; }) // skipped .handle((value, t) -&gt; { if (t == null) { return value + 1; } else { return -1; // executed and recovered } }) .thenApply(i -&gt; { logger.info(\"stage 4: {}\", i); return 1 / i; }) // executed .join();CompletableFuture ì‚¬ìš©ì‹œ ì£¼ì˜ì‚¬í•­ ì–´ë–¤ ìŠ¤ë ˆë“œê°€ ì–´ë–¤ ë‹¨ê³„ë¥¼ ì‹¤í–‰í•˜ëŠ”ì§€ ì•Œê³ , ë˜ë„ë¡ì´ë©´ ìš°ì„  ìˆœìœ„ê°€ ë†’ì€ ìŠ¤ë ˆë“œê°€ ì˜¤ë˜ ì‹¤í–‰ë˜ëŠ” ë‚®ì€ ìš°ì„  ìˆœìœ„ì˜ ì‘ì—…ì„ ì²˜ë¦¬í•˜ì§€ ì•Šê²Œ í•œë‹¤. íŒŒì´í”„ë¼ì¸ ë‚´ì—ì„œ ë¸”ë¡œí‚¹ ë©”ì„œë“œ ì‚¬ìš©ì„ ì§€ì–‘í•œë‹¤. ë¹ˆë²ˆí•œ context switchë¡œ ì¸í•´ ìƒë‹¹í•œ ì˜¤ë²„í—¤ë“œê°€ ë°œìƒí•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì§§ì€(ìˆ˜ë°± ë°€ë¦¬ì´ˆ) ë¹„ë™ê¸°ì‹ ê³„ì‚°ì„ ì§€ì–‘í•œë‹¤. try-catch-finally ë¬¸ê³¼ ë‹¤ë¥´ê²Œ ì‘ë™í•˜ëŠ” ìƒˆë¡œìš´ ì˜ˆì™¸ ì²˜ë¦¬ ë©”ì»¤ë‹ˆì¦˜ì— ìœ ì˜í•  ê²ƒ. ì‘ì—…ì´ ì™„ë£Œë˜ëŠ” ê²ƒì„ ë„ˆë¬´ ì˜¤ë˜ ê¸°ë‹¤ë¦¬ì§€ ì•Šë„ë¡ íƒ€ì„ì•„ì›ƒì„ ê´€ë¦¬í•œë‹¤.Parallel Stream Fork-Join Frameworkë¥¼ ì´ìš©í•˜ì—¬ ì‘ì—…ë“¤ì„ ë¶„í• í•˜ê³ , ë³‘ë ¬ì ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤. Fork-Join FrameworkëŠ” ì‘ì—… ë°ì´í„°ë¥¼ worker ìŠ¤ë ˆë“œ ê°„ì— ë¶„í• í•˜ê³ , ì‘ì—… ì™„ë£Œ ì‹œ ì½œë°± ì²˜ë¦¬ë¥¼ ë‹´ë‹¹í•œë‹¤. ê³µí†µ í’€ì˜ ìŠ¤ë ˆë“œ ìˆ˜ëŠ” í”„ë¡œì„¸ì„œ ì½”ì–´ ìˆ˜(ë…¼ë¦¬ ì½”ì–´ ìˆ˜, Runtime.getRuntime().availableProcessors())ì™€ ë™ì¼í•˜ë‹¤. ê·¸ëŸ¬ë‚˜ JVM ë§¤ê°œ ë³€ìˆ˜ë¥¼ ì „ë‹¬í•˜ì—¬ ì‚¬ìš©í•  ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ë„ ìˆë‹¤. -D java.util.concurrent.ForkJoinPool.common.parallelism=4 ê·¸ëŸ¬ë‚˜ ì´ ì„¤ì •ì€ ì „ì—­ ì„¤ì •ì´ë¯€ë¡œ ëª¨ë“  ë³‘ë ¬ ìŠ¤íŠ¸ë¦¼ê³¼ ê³µí†µ í’€ì„ ì‚¬ìš©í•˜ëŠ” fork-join ì‘ì—…ì— ì˜í–¥ì„ ë¯¸ì¹˜ê¸° ë•Œë¬¸ì—, í•©ë‹¹í•œ ì´ìœ ê°€ ì•„ë‹Œ ì´ìƒ ê¸°ë³¸ ì„¤ì •ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•œë‹¤. ì „ì—­ì ìœ¼ë¡œ ê³µìœ ë˜ê¸° ë•Œë¬¸ì— common pool ì‚¬ìš©ì‹œ ì£¼ì˜í•´ì•¼ í•œë‹¤.(ì‹¤ì œ ì¥ì•  ì‚¬ë¡€) ë³‘ë ¬ ì²˜ë¦¬ì˜ ì´ì ì„ ì™„ë²½íˆ í™œìš©í•˜ë ¤ë©´, ë‹¤ìŒê³¼ ê°™ì€ ì˜¤ë²„í—¤ë“œë¥¼ ê³ ë ¤í•´ì•¼í•œë‹¤.Splitting Costs(ë¶„í•  ë¹„ìš©) ë°ì´í„° ì†ŒìŠ¤ë¥¼ ê³ ë¥´ê²Œ ë¶„í• í•˜ëŠ” ë° ë“œëŠ” ë¹„ìš©ì´ë‹¤. ì¦‰, Parallel Streamì€ ì‘ì—…ì„ ë¶„í• í•˜ê¸° ìœ„í•´ Spliteratorì˜ trySplit()ì„ ì‚¬ìš©í•˜ëŠ”ë°, ë¶„í• ë˜ëŠ” ì‘ì—…ì˜ ë‹¨ìœ„ê°€ ê· ë“±í•˜ê²Œ ë‚˜ëˆ„ì–´ì ¸ì•¼ í•˜ë©°, ë‚˜ëˆ„ì–´ì§€ëŠ” ì‘ì—…ì— ëŒ€í•œ ë¹„ìš©ì´ ë†’ì§€ ì•Šì•„ì•¼ ìˆœì°¨ì  ë°©ì‹ë³´ë‹¤ íš¨ìœ¨ì ìœ¼ë¡œ ì´ë£¨ì–´ì§ˆ ìˆ˜ ìˆë‹¤. 0 ~ 1,000,000ê¹Œì§€ ArrayListì™€ LinkedListì— í• ë‹¹í•œ ë’¤, ì¼ë°˜ ìŠ¤íŠ¸ë¦¼ê³¼ ë³‘ë ¬ ìŠ¤íŠ¸ë¦¼ ì‚¬ìš©í•˜ì—¬ ì„±ëŠ¥ ë¹„êµ ArrayListëŠ” ìœ„ì¹˜ ì†ì„±ì„ í™œìš©í•˜ì—¬ ì €ë ´í•˜ê³  ê³ ë¥´ê²Œ ë¶„í• í•  ìˆ˜ ìˆëŠ” ë°˜ë©´, LinkedListì—ëŠ” ì´ëŸ¬í•œ ì†ì„±ì´ ì—†ë‹¤. Benchmark Mode Cnt Score Error UnitsDifferentSourceSplitting.differentSourceArrayListParallel avgt 25 2004849,711 Â± 5289,437 ns/opDifferentSourceSplitting.differentSourceArrayListSequential avgt 25 5437923,224 Â± 37398,940 ns/opDifferentSourceSplitting.differentSourceLinkedListParallel avgt 25 13561609,611 Â± 275658,633 ns/opDifferentSourceSplitting.differentSourceLinkedListSequential avgt 25 10664918,132 Â± 254251,184 ns/op Merging Costs(ë³‘í•© ë¹„ìš©) ë³‘ë ¬ ì—°ì‚°ì„ ìœ„í•´ ë¶„í• í•œ ë°ì´í„° ì†ŒìŠ¤ë¥¼ ì²˜ë¦¬í•˜ê³  ë‚œ ë’¤ì—ëŠ” ê°ê°ì˜ ê²°ê³¼ë¥¼ ë³‘í•©í•´ì•¼ í•œë‹¤. ë‹¤ìŒì€ 0 ~ 1,000,000ê¹Œì§€ ArrayListì— í• ë‹¹í•œ ë’¤ reduce()ë¥¼ í†µí•´ ë³‘í•©í•˜ëŠ” ê²½ìš°ì™€, collect()ë¥¼ í†µí•´ Setìœ¼ë¡œ ê·¸ë£¹í™”í•˜ëŠ” ê²½ìš°ì— ëŒ€í•œ ì„±ëŠ¥ë¹„êµì´ë‹¤. reduce ê°™ì€ ì—°ì‚°ì˜ ê²½ìš° ë¹„ìš©ì´ ì €ë ´í•œ ë°˜ë©´, Setì´ë‚˜ Mapì— ê·¸ë£¹í™”í•˜ëŠ” ê²ƒê³¼ ê°™ì€ ë³‘í•© ì‘ì—…ì€ ìƒë‹¹í•œ ë¹„ìš©ì´ ë“¤ ìˆ˜ ìˆë‹¤. Benchmark Mode Cnt Score Error UnitsMergingCosts.mergingCostsGroupingParallel avgt 25 135093312,675 Â± 4195024,803 ns/opMergingCosts.mergingCostsGroupingSequential avgt 25 70631711,489 Â± 1517217,320 ns/opMergingCosts.mergingCostsSumParallel avgt 25 2074483,821 Â± 7520,402 ns/opMergingCosts.mergingCostsSumSequential avgt 25 5509573,621 Â± 60249,942 ns/op ë…ë¦½ì ì¸ ì‘ì—… distinct(), sorted()ì™€ ê°™ì€ ì¤‘ê°„ ë‹¨ê³„ ì—°ì‚°ë“¤(intermediate operation) ì¤‘ ì¼ë¶€ ì—°ì‚°ìë“¤ì€ ì—°ì‚°ì ë‚´ë¶€ì— ìƒíƒœ(State) ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆë‹¤. ë”°ë¼ì„œ, ëª¨ë“  Workerë“¤ì€ ë…ë¦½ì ìœ¼ë¡œ ë‹¤ë¥¸ Threadì— ì˜í•´ ì‹¤í–‰ë˜ì§€ë§Œ ì²˜ë¦¬ ê²°ê³¼ë¥¼ ì´ëŸ° ìƒíƒœ ì •ë³´ì— ì €ì¥í•˜ê³ , distinct() ì—°ì‚°ìëŠ” ì´ ì •ë³´ë¥¼ ì´ìš©í•˜ì—¬ ì •í•´ì§„ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•œë‹¤. ì¦‰, ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–¤ ê³µìš© ë³€ìˆ˜ë¥¼ ë§Œë“¤ì–´ ë†“ê³  ê° workerë“¤ì´ ì´ ë³€ìˆ˜ì— ì ‘ê·¼í•  ê²½ìš° ë™ê¸°í™” ì‘ì—…(synchronized) ë“±ì„ í†µí•´ ë³€ìˆ˜ë¥¼ ì•ˆì „í•˜ê²Œ ìœ ì§€í•˜ë©´ì„œ ì²˜ë¦¬í•˜ê³  ìˆë‹¤. ë”°ë¼ì„œ, ì˜ëª» ì‚¬ìš©í•  ê²½ìš° ìˆœì°¨ì  ì‹¤í–‰ë³´ë‹¤ ë” ëŠë¦´ ìˆ˜ë„ ìˆë‹¤.NQ Model Oracleì—ì„œ ì œì‹œí•œ ê°„ë‹¨í•œ ëª¨ë¸ë¡œì¨, ë³‘ë ¬í™”ê°€ ì„±ëŠ¥ í–¥ìƒì„ ì œê³µí•  ìˆ˜ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆë‹¤. N : ì†ŒìŠ¤ ë°ì´í„° ìš”ì†Œì˜ ìˆ˜ Q : ë°ì´í„° ìš”ì†Œë‹¹ ìˆ˜í–‰ë˜ëŠ” ê³„ì‚°ì˜ ì–‘ N*Q ì œí’ˆì´ í´ìˆ˜ë¡ ë³‘ë ¬í™”ë¥¼ í†µí•´ ì„±ëŠ¥ì´ í–¥ìƒë  ê°€ëŠ¥ì„±ì´ ë†’ë‹¤. ìˆ«ì í•©ê³„ì™€ ê°™ì´ Qê°€ ì•„ì£¼ ì‘ì€ ë¬¸ì œì˜ ê²½ìš°, Nì€ 10,000ë³´ë‹¤ ì»¤ì•¼ í•œë‹¤. ê³„ì‚° ìˆ˜ê°€ ì¦ê°€í•¨ì— ë”°ë¼ ë³‘ë ¬ ì²˜ë¦¬ë¡œ ì„±ëŠ¥ì„ ë†’ì´ëŠ” ë° í•„ìš”í•œ ë°ì´í„° í¬ê¸°ëŠ” ê°ì†Œí•œë‹¤. ì¢€ ë” ìƒì„¸í•œ ë‚´ìš©ì€ ì´ ê¸€ ì„ ì°¸ì¡°í•˜ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤.CompletableFuture vs Parallel Stream CompletableFutureì™€ Parallel Streamì´ ë™ì¼í•œ fork join common poolì„ ì‚¬ìš©í•˜ëŠ” ë™ì•ˆ ì„±ëŠ¥ì€ ë¹„ìŠ·í•  ìˆ˜ ìˆë‹¤. CompletableFutureì˜ ì„±ëŠ¥ì€ ì„ íƒí•œ ìŠ¤ë ˆë“œ ìˆ˜ë¡œ ì‚¬ìš©ì ì •ì˜ ìŠ¤ë ˆë“œ í’€ì„ êµ¬ì„±í•´ì•¼ í•˜ëŠ” ìƒí™©ì—ì„œ ë” ì¢‹ì„ ìˆ˜ ìˆë‹¤. ë˜í•œ, ë‹¤ë¥¸ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë™ì•ˆ URLì—ì„œ ë‹¤ìš´ë¡œë“œí•˜ë ¤ëŠ” ê²½ìš°ì™€ ê°™ì´ ë¹„ë™ê¸°ì‹ ë°©ë²•ì„ ì°¾ê³  ìˆë‹¤ë©´ CompletableFutureë¥¼ ì„ íƒí•  ìˆ˜ ìˆë‹¤. Parallel Streamì€ ëª¨ë“  ì‘ì—…ì´ ì¼ë¶€ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸°ë¥¼ ì›í•˜ëŠ” CPU ì§‘ì•½ì  ì‘ì—…, ì¦‰ ëª¨ë“  ìŠ¤ë ˆë“œê°€ ë‹¤ë¥¸ ë°ì´í„°ë¡œ ë™ì¼í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê¸°ë¥¼ ì›í•˜ëŠ” ê²½ìš° ì¢‹ì€ ì„ íƒì´ ë  ìˆ˜ ìˆë‹¤.ì‹¤ì œë¡œ ì ìš©í•˜ê¸° íšŒì‚¬ ì½”ë“œ ë¹„ë™ê¸°ì ìœ¼ë¡œ ë¦¬íŒ©í† ë§ í•´ë³´ê³  ì„±ëŠ¥ ë¹„êµí•´ë³´ê¸°ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ stream ê¸°ì´ˆ, ë‚´ë¶€ì ì¸ ì‘ë™ë°©ì‹ ë“±ì°¸ê³ ìë£Œ https://www.baeldung.com/java-asynchronous-programming https://www.cognizantsoftvision.com/blog/async-in-java/ https://www.linkedin.com/pulse/java-8-future-vs-completablefuture-saral-saxena https://www.callicoder.com/java-8-completablefuture-tutorial/ https://www.linkedin.com/pulse/asynchronous-programming-java-completablefuture-aliaksandr-liakh https://www.baeldung.com/java-when-to-use-parallel-stream https://www.popit.kr/java8-stream%EC%9D%98-parallel-%EC%B2%98%EB%A6%AC/ https://m.blog.naver.com/tmondev/220945933678 https://roytuts.com/difference-between-parallel-stream-and-completablefuture-in-java/" }, { "title": "Java - Thread Poolì„ ìœ„í•œ Java Executor Framework", "url": "/posts/java-threadpool-executor-framework/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-08-07 00:29:00 +0900", "snippet": "ìë°”ì—ì„œì˜ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•´ CompletableFutureì— ëŒ€í•´ ê³µë¶€í•˜ë©° í´ë˜ìŠ¤ ë‚´ë¶€ë¥¼ ë³´ë‹¤ë³´ë‹ˆ Executor, ForkJoinPool ë“±ì´ ëˆˆì— ë„ì—ˆë‹¤.ìƒì†Œí•œ ë¶€ë¶„ì´ë¼ ê³µë¶€í•˜ë©° ë‚˜ë¦„ëŒ€ë¡œ ì •ë¦¬í•´ë³´ì•˜ë‹¤.Thread Pool Executor, ForkJoinPoolì— ëŒ€í•´ ì•Œê¸° ì „ì— ë¨¼ì € ìŠ¤ë ˆë“œ í’€ì˜ ê°œë…ì— ëŒ€í•´ ì‚´í´ë³´ì. ìŠ¤ë ˆë“œë¥¼ ë§Œë“¤ê³  ê´€ë¦¬...", "content": "ìë°”ì—ì„œì˜ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•´ CompletableFutureì— ëŒ€í•´ ê³µë¶€í•˜ë©° í´ë˜ìŠ¤ ë‚´ë¶€ë¥¼ ë³´ë‹¤ë³´ë‹ˆ Executor, ForkJoinPool ë“±ì´ ëˆˆì— ë„ì—ˆë‹¤.ìƒì†Œí•œ ë¶€ë¶„ì´ë¼ ê³µë¶€í•˜ë©° ë‚˜ë¦„ëŒ€ë¡œ ì •ë¦¬í•´ë³´ì•˜ë‹¤.Thread Pool Executor, ForkJoinPoolì— ëŒ€í•´ ì•Œê¸° ì „ì— ë¨¼ì € ìŠ¤ë ˆë“œ í’€ì˜ ê°œë…ì— ëŒ€í•´ ì‚´í´ë³´ì. ìŠ¤ë ˆë“œë¥¼ ë§Œë“¤ê³  ê´€ë¦¬í•˜ëŠ” ë°ëŠ” ë¹„ìš©ì´ ë§ì´ ë“¤ê¸° ë•Œë¬¸ì—, ìŠ¤ë ˆë“œë¥¼ í•„ìš”í•  ë•Œ ë§ˆë‹¤ ìƒì„±í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ë¯¸ë¦¬ ìƒì„±í•´ë†“ê³  í•„ìš”í•  ë•Œ ë§ˆë‹¤ ì¬ì‚¬ìš©í•œë‹¤. ì´ë¥¼ ìœ„í•´ ìŠ¤ë ˆë“œë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ìŠ¤ë ˆë“œ í’€ì´ë¼ëŠ” ê°œë…ì´ ë‚˜ì˜¤ê²Œ ëœë‹¤. ì¦‰, ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œë§ˆë‹¤ ìƒˆ ìŠ¤ë ˆë“œë¥¼ ë§Œë“œëŠ” ëŒ€ì‹  ìŠ¤ë ˆë“œ í’€ì„ ì‚¬ìš©í•˜ì—¬ taskë¥¼ ë³‘ë ¬ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ìŠ¤ë ˆë“œ í’€ ì¸ìŠ¤í„´ìŠ¤ëŠ” ì´ëŸ¬í•œ ì‘ì—…ì„ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ì¬ì‚¬ìš©ë˜ëŠ” ì—¬ëŸ¬ ìŠ¤ë ˆë“œë¥¼ ì œì–´í•œë‹¤. ìŠ¤ë ˆë“œë¥¼ ì¬ì‚¬ìš©í•¨ìœ¼ë¡œì¨, ë©€í‹° ìŠ¤ë ˆë“œë¥¼ í™œìš©í•˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì•„ë‚„ ìˆ˜ ìˆë‹¤. ìŠ¤ë ˆë“œ í’€ì„ í†µí•´ ìƒì„±í•˜ëŠ” ìŠ¤ë ˆë“œ ìˆ˜ì™€ ìŠ¤ë ˆë“œì˜ ìƒëª…ì£¼ê¸°ë¥¼ ì œì–´í•  ìˆ˜ ìˆë‹¤. ë˜í•œ ì‘ì—…(task)ì„ ìŠ¤ì¼€ì¤„ë§í•˜ê³  íì— ì‘ì—…ì„ ë³´ê´€í•  ìˆ˜ ìˆë‹¤. ìŠ¤ë ˆë“œ ê°¯ìˆ˜ë¥¼ ì •í•¨ìœ¼ë¡œì¨ ë™ì‹œì„±ì˜ ì •ë„ë¥¼ ì œí•œí•  ìˆ˜ ìˆë‹¤. ì¶œì²˜ : https://www.baeldung.com/thread-pool-java-and-guava ìŠ¤ë ˆë“œ í’€ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ì´ìœ  ìë°”ì—ì„œ ìŠ¤ë ˆë“œëŠ” ìš´ì˜ ì²´ì œì˜ ë¦¬ì†ŒìŠ¤ì¸ ì‹œìŠ¤í…œ ìˆ˜ì¤€ ìŠ¤ë ˆë“œ(system-level thread)ì— ë§¤í•‘ë˜ê¸° ë•Œë¬¸ì—, ìŠ¤ë ˆë“œë¥¼ ë¬´ë¶„ë³„í•˜ê²Œ ìƒì„±í•˜ë©´ ë¦¬ì†ŒìŠ¤ê°€ ë¹ ë¥´ê²Œ ì†Œì§„ë  ìˆ˜ ìˆë‹¤. ex) java.lang.OutOfMemoryError: unable to create new native thread ìš´ì˜ ì²´ì œëŠ” ì—¬ëŸ¬ taskë¥¼ ë™ì‹œì— ì²˜ë¦¬(ì‹¤ì œë¡œëŠ” í•œ ë²ˆì— í•˜ë‚˜ì˜ task)í•˜ê¸° ìœ„í•´ ìŠ¤ë ˆë“œ ê°„ context switchingì„ ìˆ˜í–‰í•œë‹¤. ë”°ë¼ì„œ, ìŠ¤ë ˆë“œë¥¼ ë§ì´ ìƒì„±í• ìˆ˜ë¡ ê° ìŠ¤ë ˆë“œê°€ ì‹¤ì œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë° ê±¸ë¦¬ëŠ” ì‹œê°„ì´ ì¤„ì–´ë“ ë‹¤. reqeust ë˜ëŠ” task ì²˜ë¦¬ ì¤‘ì— ìŠ¤ë ˆë“œê°€ ìƒì„±ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì‘ë‹µ ì‹œê°„ì´ ë‹¨ì¶•ëœë‹¤. í•„ìš”ì— ë”°ë¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‹¤í–‰ ì •ì±…ì„ ìœ ì—°í•˜ê²Œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìë°”ì˜ ExecutorService êµ¬í˜„ì²´ë¥¼ êµì²´í•˜ê¸°ë§Œ í•˜ë©´ ë‹¨ì¼ ìŠ¤ë ˆë“œì—ì„œ ë©€í‹° ìŠ¤ë ˆë“œë¡œ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤. ì‹œìŠ¤í…œ ë¶€í•˜ ë° ì‚¬ìš© ê°€ëŠ¥í•œ ë¦¬ì†ŒìŠ¤ì— ê¸°ë°˜í•˜ì—¬ ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ê²°ì •í•˜ê¸° ë•Œë¬¸ì—, ì‹œìŠ¤í…œì˜ ì•ˆì •ì„±ì„ ë†’ì¸ë‹¤. ìŠ¤ë ˆë“œ ê´€ë¦¬ë³´ë‹¤ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ì§‘ì¤‘í•  ìˆ˜ ìˆë‹¤.ìë°”ì—ì„œì˜ ìŠ¤ë ˆë“œ í’€ ê´€ë¦¬ Java 1.5 ì´ì „ê¹Œì§€ëŠ” ìŠ¤ë ˆë“œ í’€ì„ ë§Œë“¤ê³  ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ê°œë°œìì˜ ì±…ì„ì´ì—ˆì§€ë§Œ, JDK 5 ë¶€í„°ëŠ” Executor í”„ë ˆì„ì›Œí¬ì—ì„œ Javaì— ë‚´ì¥ëœ ë‹¤ì–‘í•œ ìŠ¤ë ˆë“œ í’€(fixed thread pool, cached thread pool ë“±)ì„ ì œê³µí•œë‹¤.Executor, ExecutorService, ExecutorsëŠ” Executor í”„ë ˆì„ì›Œí¬ì˜ í•µì‹¬ì´ë‹¤.Executor / ExecutorService / Executors ë¹„êµExecutor ExecutorëŠ” ë³‘ë ¬ ì‹¤í–‰(parallel execution)ì„ ìœ„í•´ ì¶”ìƒí™”ëœ í•µì‹¬ ì¸í„°í˜ì´ìŠ¤ì´ë‹¤. public interface Executor { void execute(Runnable command);} ExecutorëŠ” ì‘ì—…(task)ê³¼ ì‹¤í–‰(execution)ì„ ê²°í•©í•œ Thread(new Thread(RunnableTask()).start())ì™€ëŠ” ë‹¤ë¥´ê²Œ ì‘ì—…ê³¼ ì‹¤í–‰ì„ êµ¬ë¶„í•œë‹¤. ë”°ë¼ì„œ, ExecutorëŠ” taskë¥¼ ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ìŠ¤ë ˆë“œë¥¼ ì§ì ‘ í˜¸ì¶œí•˜ëŠ” ëŒ€ì‹  ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©ë  ìˆ˜ ìˆë‹¤. static &lt;U&gt; CompletableFuture&lt;U&gt; asyncSupplyStage(Executor e, Supplier&lt;U&gt; f) { if (f == null) throw new NullPointerException(); CompletableFuture&lt;U&gt; d = new CompletableFuture&lt;U&gt;(); e.execute(new AsyncSupply&lt;U&gt;(d, f)); return d;} ExecutorService ExecutorServiceëŠ” Executor ì¸í„°í˜ì´ìŠ¤ì˜ í™•ì¥ìœ¼ë¡œ, Future ê°œì²´ë¥¼ ë°˜í™˜í•˜ê³ , ìŠ¤ë ˆë“œ í’€ì„ ì¢…ë£Œí•˜ëŠ” ë“±ì˜ ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.public interface ExecutorService extends Executor {...} shutdown()ì´ í˜¸ì¶œë˜ë©´ ìŠ¤ë ˆë“œ í’€ì€ ìƒˆë¡œìš´ taskë¥¼ ìˆ˜ë½í•˜ì§€ ì•Šê³  ë³´ë¥˜ ì¤‘ì¸ taskë¥¼ ì™„ë£Œí•œë‹¤. submit()ì„ í†µí•´ Future ê°ì²´ë¥¼ ë¦¬í„´í•œë‹¤.&lt;T&gt; Future&lt;T&gt; submit(Callable&lt;T&gt; task);&lt;T&gt; Future&lt;T&gt; submit(Runnable task, T result);Future&lt;?&gt; submit(Runnable task); Future ê°ì²´ëŠ” ë¹„ë™ê¸° ì‹¤í–‰ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ì¦‰, taskì— ëŒ€í•œ ì‹¤í–‰ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦´ í•„ìš”ì—†ì´, ì¶”í›„ì— Future ê°ì²´ì— ê²°ê³¼ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  ì‹¤í–‰ì´ ì™„ë£Œë˜ë©´ Future.get()ì„ ì‚¬ìš©í•˜ì—¬ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. get()ì€ blocking methodì´ë‹¤. ì¦‰, taskì˜ ì‹¤í–‰ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦¬ê³  ì•„ì§ ì™„ë£Œë˜ì§€ ì•Šì€ ê²½ìš° ê²°ê³¼ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. cancel()ì„ í†µí•´ ë³´ë¥˜ ì¤‘ì¸ ì‹¤í–‰ì„ ì·¨ì†Œí•  ìˆ˜ ìˆë‹¤. ì´ì™¸ì—ë„ invokeAny(), invokeAll() ë“± ë‹¤ì–‘í•œ ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤. (ìì„¸í•œ ë‚´ìš©ì€ ê³µì‹ ë¬¸ì„œ ì°¸ì¡°)Executors ExecutorsëŠ” Collectionsì™€ ìœ ì‚¬í•œ ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ë¡œ, fixed thread pool, cached thread poolê³¼ ê°™ì€ ì„œë¡œ ë‹¤ë¥¸ ìœ í˜•ì˜ ìŠ¤ë ˆë“œ í’€ì„ ë§Œë“œëŠ” íŒ©í† ë¦¬ ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤.public static ExecutorService newFixedThreadPool(int nThreads, ThreadFactory threadFactory) { return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;(), threadFactory);}public static ExecutorService newSingleThreadExecutor() { return new FinalizableDelegatedExecutorService (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()));}Executor í”„ë ˆì„ì›Œí¬ ì‚¬ìš©ì‹œ ì£¼ì˜í•  ì  fixed length thread pool ì‚¬ìš©ì‹œ ìŠ¤ë ˆë“œ í’€ ìš©ëŸ‰ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ taskë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ìŠ¤ë ˆë“œ ìˆ˜ë¥¼ ê²°ì •í•˜ëŠ” ê²ƒì€ ë§¤ìš° ì¤‘ìš”í•˜ë‹¤. ë„ˆë¬´ í° ìŠ¤ë ˆë“œ í’€ì€ ëŒ€ë¶€ë¶„ì˜ ìŠ¤ë ˆë“œê°€ ëŒ€ê¸° ëª¨ë“œì— ìˆê²Œë˜ê³ , ì´ëŸ¬í•œ ìŠ¤ë ˆë“œë¥¼ ë§Œë“œëŠ”ë° ë¶ˆí•„ìš”í•œ ì˜¤ë²„í—¤ë“œê°€ ë°œìƒí•œë‹¤. ë„ˆë¬´ ì ìœ¼ë©´ íì— ìˆëŠ” taskëŠ” ëŒ€ê¸°í•˜ëŠ” ì‹œê°„ì´ ê¸¸ì–´ì§€ê¸° ë•Œë¬¸ì—, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì‘ë‹µí•˜ì§€ ì•ŠëŠ” ê²ƒì²˜ëŸ¼ ë³´ì¼ ìˆ˜ ìˆë‹¤. ì‘ì—… ì·¨ì†Œ í›„ Future.get() ë©”ì„œë“œ í˜¸ì¶œ ì´ë¯¸ ì·¨ì†Œëœ ì‘ì—…ì˜ ê²°ê³¼ë¥¼ ê°€ì ¸ì˜¤ë ¤ê³  í•˜ë©´ CancellationExceptionì´ ë°œìƒí•œë‹¤. Future.get() ë©”ì„œë“œë¡œ ì¸í•´ ì˜ˆê¸°ì¹˜ ì•Šê²Œ ê¸´ blocking ì´ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì œí•œ ì‹œê°„ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ThreadPoolExecutor ThreadPoolExecutorëŠ” ë¯¸ì„¸ ì¡°ì •ì„ ìœ„í•œ ë§ì€ ë§¤ê°œë³€ìˆ˜ì™€ í›„í¬ê°€ ìˆëŠ” í™•ì¥ ê°€ëŠ¥í•œ ìŠ¤ë ˆë“œ í’€ êµ¬í˜„ì²´ì´ë‹¤. ExecutorServiceë¥¼ ìŠ¤ë ˆë“œ í’€ì„ ê´€ë¦¬í•˜ëŠ” ì—­í• ì„ ì •ì˜í•œ ê²ƒì´ë¼ê³  í•œë‹¤ë©´, ThreadPoolExecutorëŠ” ê·¸ ì—­í• ì„ êµ¬í˜„í•˜ëŠ” êµ¬í˜„ì²´ë¼ê³  ìƒê°í•˜ë©´ ë  ê²ƒ ê°™ë‹¤. ì¶œì²˜ : https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ThreadPoolExecutor.html ì£¼ìš” êµ¬ì„± ë§¤ê°œë³€ìˆ˜ëŠ” corePoolSize, maximumPoolSize, keepAliveTimeì´ë‹¤. corePoolSize ë§¤ê°œë³€ìˆ˜ëŠ” ì¸ìŠ¤í„´ìŠ¤í™”ë˜ì–´ í’€ì— ë³´ê´€ë  ì½”ì–´ ìŠ¤ë ˆë“œì˜ ìˆ˜ì´ë‹¤. ìƒˆ ì‘ì—…ì´ ë“¤ì–´ì˜¬ ë•Œ ëª¨ë“  ì½”ì–´ ìŠ¤ë ˆë“œê°€ ì‚¬ìš© ì¤‘ì´ê³  ë‚´ë¶€ íê°€ ê°€ë“ ì°¨ë©´ í’€ì´ maximumPoolSizeê¹Œì§€ ì»¤ì§ˆ ìˆ˜ ìˆë‹¤. í’€ì€ í•­ìƒ ë‚´ë¶€ì— ìœ ì§€ë˜ëŠ” ê³ ì •ëœ ìˆ˜ì˜ ì½”ì–´ ìŠ¤ë ˆë“œë¡œ êµ¬ì„±ëœë‹¤. ìƒì„±ëœ ë‹¤ìŒ ë” ì´ìƒ í•„ìš”í•˜ì§€ ì•Šì„ ë•Œ ì¢…ë£Œë  ìˆ˜ ìˆëŠ” excessive ìŠ¤ë ˆë“œë¡œ êµ¬ì„±ë˜ê¸°ë„ í•œë‹¤. public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue) { this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue, Executors.defaultThreadFactory(), defaultHandler);}public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory) { this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue, threadFactory, defaultHandler);}public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, RejectedExecutionHandler handler) { this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue, Executors.defaultThreadFactory(), handler);}public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler) { if (corePoolSize &lt; 0 || maximumPoolSize &lt;= 0 || maximumPoolSize &lt; corePoolSize || keepAliveTime &lt; 0) throw new IllegalArgumentException(); if (workQueue == null || threadFactory == null || handler == null) throw new NullPointerException(); this.corePoolSize = corePoolSize; this.maximumPoolSize = maximumPoolSize; this.workQueue = workQueue; this.keepAliveTime = unit.toNanos(keepAliveTime); this.threadFactory = threadFactory; this.handler = handler;}FixedThreadPool corePoolSizeì™€ maximumPoolSizeê°€ ê°™ìœ¼ë©° keepAliveTimeì´ 0ì¸ ThreadPoolExecutor. ë”°ë¼ì„œ, ì´ ìŠ¤ë ˆë“œ í’€ì˜ ìŠ¤ë ˆë“œ ìˆ˜ëŠ” í•­ìƒ ë™ì¼í•˜ë‹¤.public static ExecutorService newFixedThreadPool(int nThreads, ThreadFactory threadFactory) { return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;(), threadFactory);} ì•„ë˜ ì˜ˆì‹œì˜ ê²½ìš°, ë™ì‹œì— ì‹¤í–‰ë˜ëŠ” ì‘ì—…ì˜ ìˆ˜ê°€ í•­ìƒ 2ê°œë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ìœ¼ë©´ ì¦‰ì‹œ ì‹¤í–‰ëœë‹¤. ì¦‰, ì²˜ìŒ ë‘ íƒœìŠ¤í¬ëŠ” í•œ ë²ˆì— ì‹¤í–‰ë˜ê³  ì„¸ ë²ˆì§¸ íƒœìŠ¤í¬ëŠ” ëŒ€ê¸°ì—´ì—ì„œ ëŒ€ê¸°í•´ì•¼ í•œë‹¤. ThreadPoolExecutor executor = (ThreadPoolExecutor) Executors.newFixedThreadPool(2);executor.submit(() -&gt; { Thread.sleep(1000); return null;});executor.submit(() -&gt; { Thread.sleep(1000); return null;});executor.submit(() -&gt; { Thread.sleep(1000); return null;});assertEquals(2, executor.getPoolSize());assertEquals(1, executor.getQueue().size());CachedThreadPool corePoolSizeëŠ” 0, maximumPoolSizeëŠ” Integer.MAX_VALUE, keepAliveTimeì€ 60ì´ˆì¸ ThreadPoolExecutor. ì¦‰, ìŠ¤ë ˆë“œ í’€ì´ ëª¨ë“  taskë¥¼ ìˆ˜ìš©í•  ìˆ˜ ìˆë„ë¡ ì œí•œ ì—†ì´ ì»¤ì§ˆ ìˆ˜ ìˆìŒì„ ì˜ë¯¸í•œë‹¤. ë˜í•œ ìŠ¤ë ˆë“œê°€ 60ì´ˆ ë™ì•ˆ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ íê¸°ëœë‹¤. CachedThreadPoolì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì£¼ë¡œ short-living taskë¥¼ ì²˜ë¦¬í•˜ëŠ” ê²½ìš° í™œìš©í•œë‹¤. ë‚´ë¶€ì ìœ¼ë¡œ SynchronousQueueê°€ ì‚¬ìš©ë˜ë¯€ë¡œ ëŒ€ê¸°ì—´ í¬ê¸°ëŠ” í•­ìƒ 0ì´ë‹¤. SynchronousQueueì—ì„œëŠ” ì‚½ì… ë° ì œê±° ì‘ì—… ìŒì´ í•­ìƒ ë™ì‹œì— ìˆ˜í–‰ë˜ê¸° ë•Œë¬¸ì—, ì‹¤ì œë¡œ ì•„ë¬´ê²ƒë„ í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤. public static ExecutorService newCachedThreadPool() { return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;());}public static ExecutorService newCachedThreadPool(ThreadFactory threadFactory) { return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;(), threadFactory);}ThreadPoolExecutor executor = (ThreadPoolExecutor) Executors.newCachedThreadPool();executor.submit(() -&gt; { Thread.sleep(1000); return null;});executor.submit(() -&gt; { Thread.sleep(1000); return null;});executor.submit(() -&gt; { Thread.sleep(1000); return null;});assertEquals(3, executor.getPoolSize());assertEquals(0, executor.getQueue().size());SingleThreadExecutor Executors.newSingleThreadExecutor()ëŠ” ë‹¨ì¼ ìŠ¤ë ˆë“œë¥¼ í¬í•¨í•˜ëŠ” ë˜ ë‹¤ë¥¸ ì¼ë°˜ì ì¸ í˜•íƒœì˜ ThreadPoolExecutorë¥¼ ë§Œë“ ë‹¤. SingleThreadExecutorëŠ” ì´ë²¤íŠ¸ ë£¨í”„ë¥¼ ë§Œë“œëŠ” ë° ì´ìƒì ì´ë‹¤. corePoolSize, maximumPoolSizeëŠ” 1ì´ê³  keepAliveTimeì€ 0ì´ë‹¤.public static ExecutorService newSingleThreadExecutor() { return new FinalizableDelegatedExecutorService (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()));}public static ExecutorService newSingleThreadExecutor(ThreadFactory threadFactory) { return new FinalizableDelegatedExecutorService (new ThreadPoolExecutor(1, 1, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;(), threadFactory));}AtomicInteger counter = new AtomicInteger();ExecutorService executor = Executors.newSingleThreadExecutor();executor.submit(() -&gt; { counter.set(1);});executor.submit(() -&gt; { counter.compareAndSet(1, 2);});ScheduledThreadPoolExecutor ScheduledThreadPoolExecutorëŠ” ThreadPoolExecutor í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ê³  ScheduledExecutorService ì¸í„°í˜ì´ìŠ¤ë„ êµ¬í˜„í•˜ì—¬ ë¶€ê°€ì ì¸ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. schedule() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì§€ì •ëœ ì§€ì—° í›„ ì‘ì—…ì„ í•œ ë²ˆ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. scheduleAtFixedRate() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ì§€ì •ëœ ì´ˆê¸° ì§€ì—° í›„ì— ì‘ì—…ì„ ì‹¤í–‰í•œ ë‹¤ìŒ íŠ¹ì • ê¸°ê°„ ë™ì•ˆ ë°˜ë³µ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. ì¦‰, task ìˆ˜í–‰ ì‹œì‘ ì‹œê°„ì€ (initialDelay + delay), (initialDelay + 2 * period), â€¦ ì´ëŸ°ì‹ìœ¼ë¡œ ê³„ì‚°ëœë‹¤. scheduleWithFixedDelay() ë©”ì„œë“œëŠ” ì§€ì •ëœ íƒœìŠ¤í¬ë¥¼ ë°˜ë³µì ìœ¼ë¡œ ì‹¤í–‰í•œë‹¤ëŠ” ì ì—ì„œ scheduleAtFixedRate()ì™€ ìœ ì‚¬í•˜ë‹¤. í•˜ì§€ë§Œ, delayëŠ” ì´ì „ taskì˜ ì¢…ë£Œì™€ ë‹¤ìŒ taskì˜ ì‹œì‘ ì‚¬ì´ì—ì„œ ì¸¡ì •ëœë‹¤. ì¦‰, task ìˆ˜í–‰ ì‹œì‘ ì‹œê°„ì€ (ì´ì „ taskì˜ ëë‚˜ëŠ” ì‹œì  + delay)ê°€ ëœë‹¤. public class ScheduledThreadPoolExecutor extends ThreadPoolExecutor implements ScheduledExecutorService {...}public ScheduledThreadPoolExecutor(int corePoolSize) { super(corePoolSize, Integer.MAX_VALUE, DEFAULT_KEEPALIVE_MILLIS, MILLISECONDS, new DelayedWorkQueue());}public ScheduledThreadPoolExecutor(int corePoolSize, ThreadFactory threadFactory) { super(corePoolSize, Integer.MAX_VALUE, DEFAULT_KEEPALIVE_MILLIS, MILLISECONDS, new DelayedWorkQueue(), threadFactory);}public ScheduledThreadPoolExecutor(int corePoolSize, RejectedExecutionHandler handler) { super(corePoolSize, Integer.MAX_VALUE, DEFAULT_KEEPALIVE_MILLIS, MILLISECONDS, new DelayedWorkQueue(), handler);}public ScheduledThreadPoolExecutor(int corePoolSize, ThreadFactory threadFactory, RejectedExecutionHandler handler) { super(corePoolSize, Integer.MAX_VALUE, DEFAULT_KEEPALIVE_MILLIS, MILLISECONDS, new DelayedWorkQueue(), threadFactory, handler);}public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) { return new ScheduledThreadPoolExecutor(corePoolSize);}public static ScheduledExecutorService newScheduledThreadPool( int corePoolSize, ThreadFactory threadFactory) { return new ScheduledThreadPoolExecutor(corePoolSize, threadFactory);}ScheduledExecutorService executor = Executors.newScheduledThreadPool(5);executor.schedule(() -&gt; { System.out.println(\"Hello World\");}, 500, TimeUnit.MILLISECONDS); ë‹¤ìŒ ì½”ë“œëŠ” 500ë°€ë¦¬ì´ˆ ì§€ì—° í›„ ì‘ì—…ì„ ì‹¤í–‰í•œ í›„ 100ë°€ë¦¬ì´ˆë§ˆë‹¤ ë°˜ë³µí•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ì¤€ë‹¤. ë˜í•œ, ì‘ì—…ì„ ì˜ˆì•½í•œ í›„ CountDownLatch lockì„ ì‚¬ìš©í•˜ì—¬ ì‘ì—…ì´ ì„¸ ë²ˆ ì‹¤í–‰ë  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦° í›„, Future.cancel() ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì‘ì—…ì„ ì·¨ì†Œí•œë‹¤.CountDownLatch lock = new CountDownLatch(3);ScheduledExecutorService executor = Executors.newScheduledThreadPool(5);ScheduledFuture&lt;?&gt; future = executor.scheduleAtFixedRate(() -&gt; { System.out.println(\"Hello World\"); lock.countDown();}, 500, 100, TimeUnit.MILLISECONDS);lock.await(1000, TimeUnit.MILLISECONDS);future.cancel(true);ë” ê³µë¶€í•  ë¶€ë¶„ Fork/Join Frameworkì°¸ê³ ìë£Œ https://docs.oracle.com/javase/7/docs/api/java/util/concurrent/Executor.html https://stackoverflow.com/questions/26938210/executorservice-vs-casual-thread-spawner https://stackoverflow.com/questions/3984076/what-are-the-advantages-of-using-an-executorservice https://www.baeldung.com/thread-pool-java-and-guava https://www.baeldung.com/java-executor-service-tutorial https://javarevisited.blogspot.com/2017/02/difference-between-executor-executorservice-and-executors-in-java.html#axzz72wOdvf6F" }, { "title": "Sync/Async, Blocking/Non-Blocking", "url": "/posts/sync-async-block-nonblock/", "categories": "", "tags": "", "date": "2021-08-07 00:29:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „í•­ìƒ ë™ê¸°ì ìœ¼ë¡œë§Œ í”„ë¡œê·¸ë˜ë°ì„ í•´ì™”ì—ˆì§€ë§Œ, ë¹„ë™ê¸°ì ìœ¼ë¡œ í”„ë¡œê·¸ë˜ë° í•˜ëŠ” ê²ƒë„ ë°˜ë“œì‹œ ì•Œê³ ìˆì–´ì•¼ í•œë‹¤ê³  ìƒê°í•œë‹¤. (reactive app ?? -&gt; Spring Webflux ë“± ?)ë¹„ë™ê¸°ë©´ non-blocking, ë™ê¸°ë©´ blocking ì´ë¼ê³  ìƒê°í–ˆëŠ”ë°, ì˜ëª» ìƒê°í•˜ê³ ìˆì—ˆë‹¤.ì œëŒ€ë¡œ ì•Œì•„ë³´ì.Synchronous vs Asynchro...", "content": "ë“¤ì–´ê°€ê¸° ì „í•­ìƒ ë™ê¸°ì ìœ¼ë¡œë§Œ í”„ë¡œê·¸ë˜ë°ì„ í•´ì™”ì—ˆì§€ë§Œ, ë¹„ë™ê¸°ì ìœ¼ë¡œ í”„ë¡œê·¸ë˜ë° í•˜ëŠ” ê²ƒë„ ë°˜ë“œì‹œ ì•Œê³ ìˆì–´ì•¼ í•œë‹¤ê³  ìƒê°í•œë‹¤. (reactive app ?? -&gt; Spring Webflux ë“± ?)ë¹„ë™ê¸°ë©´ non-blocking, ë™ê¸°ë©´ blocking ì´ë¼ê³  ìƒê°í–ˆëŠ”ë°, ì˜ëª» ìƒê°í•˜ê³ ìˆì—ˆë‹¤.ì œëŒ€ë¡œ ì•Œì•„ë³´ì.Synchronous vs Asynchronous Synchronous : ë™ì‹œ ë°œìƒ[ì¡´ì¬]í•˜ëŠ”, â€œsynchronize(ì¼ì¹˜ì‹œí‚¤ë‹¤, ë™ì‹œì— ì¼ì–´ë‚˜ë‹¤)â€ëŠ” [syn ê°™ì´] + [chron ì‹œê°„] + [ze ë™ì‚¬]ë¡œ ë§Œë“¤ì–´ì§€ëŠ” ë‹¨ì–´ì˜ˆìš”.Asynchronous : ë™ì‹œì— ì¡´ì¬[ë°œìƒ]í•˜ì§€ ì•ŠëŠ”â€“&gt; ì˜ì–´ ëœ»ë§Œë³´ë©´ syncê°€ ì—¬ëŸ¬ê°œë¥¼ ë™ì‹œì— ì‹¤í–‰ì‹œí‚¤ëŠ” ëŠë‚Œì“° ??â€“&gt; ë™ì‹œì— ë°œìƒí•œë‹¤ëŠ”ê²Œ (ëë‚¨ê³¼) ë™ì‹œì— ë°œìƒ ??Synchronous, AsynchronousëŠ” í˜•ìš©ì‚¬. ê·¸ëŸ¼ ì»´í“¨í„° ì„¸ê³„ì—ì„  ë’¤ì— ì–´ë–¤ ëª…ì‚¬ë‘ ìì£¼ ì“°ì¼ê¹Œ ?Synchronous Programming, Asynchronous Programming ?Synchronous Execution, Asynchronous Execution ?taskë¥¼ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ ??clockì„ ì•Œì•„ì•¼í•˜ëŠ”ê±´ê°€ ??â€“&gt; ìŠ¤ë ˆë“œ, í”„ë¡œì„¸ìŠ¤ ì…ì¥ì—ì„œ ìƒê° ??https://www.makeuseof.com/synchronous-asynchronous-programming-different/Blocking vs Non-BlockingSynchronous / Asynchronous ì™€ Blocking / Non-Blocking ê´€ê³„syncë©´ blocking, asyncë©´ non-blocking ì•„ë‹Œê°€ ??https://www.cs.unc.edu/~dewan/242/s07/notes/ipc/node9.htmlë‹¤ì–‘í•œ ê´€ì  ê´€ì‹¬ì‚¬ì˜ ì°¨ì´ Synchronous/AsynchronousëŠ” í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì˜ ì‘ì—… ì™„ë£Œ ì—¬ë¶€ë¥¼ ëˆ„ê°€ ì‹ ê²½ì“°ëƒê°€ ê´€ì‹¬ì‚¬ë‹¤. í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì—ê²Œ callbackì„ ì „ë‹¬í•´ì„œ, í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì˜ ì‘ì—…ì´ ì™„ë£Œë˜ë©´ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ê°€ ì „ë‹¬ë°›ì€ callbackì„ ì‹¤í–‰í•˜ê³ , í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ëŠ” ì‘ì—… ì™„ë£Œ ì—¬ë¶€ë¥¼ ì‹ ê²½ì“°ì§€ ì•Šìœ¼ë©´ Asynchronousë‹¤. í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì˜ ì‘ì—… ì™„ë£Œ í›„ ë¦¬í„´ì„ ê¸°ë‹¤ë¦¬ê±°ë‚˜, ë˜ëŠ” í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë¡œë¶€í„° ë°”ë¡œ ë¦¬í„´ ë°›ë”ë¼ë„ ì‘ì—… ì™„ë£Œ ì—¬ë¶€ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ ìŠ¤ìŠ¤ë¡œ ê³„ì† í™•ì¸í•˜ë©° ì‹ ê²½ì“°ë©´ Synchronousë‹¤. Blocking/NonBlockingì€ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ê°€ ë°”ë¡œ ë¦¬í„´í•˜ëŠëƒ ë§ˆëŠëƒê°€ ê´€ì‹¬ì‚¬ë‹¤. í˜¸ì¶œëœ í•¨ìˆ˜ê°€ ë°”ë¡œ ë¦¬í„´í•´ì„œ í˜¸ì¶œí•œ í•¨ìˆ˜ì—ê²Œ â€˜ì œì–´ê¶Œâ€™ì„ ë„˜ê²¨ì£¼ê³ , í˜¸ì¶œí•œ í•¨ìˆ˜ê°€ ë‹¤ë¥¸ ì¼ì„ í•  ìˆ˜ ìˆëŠ” ê¸°íšŒë¥¼ ì¤„ ìˆ˜ ìˆìœ¼ë©´ NonBlockingì´ë‹¤. ê·¸ë ‡ì§€ ì•Šê³  í˜¸ì¶œëœ í•¨ìˆ˜ê°€ ìì‹ ì˜ ì‘ì—…ì„ ëª¨ë‘ ë§ˆì¹  ë•Œê¹Œì§€ í˜¸ì¶œí•œ í•¨ìˆ˜ì—ê²Œ ì œì–´ê¶Œì„ ë„˜ê²¨ì£¼ì§€ ì•Šê³  ëŒ€ê¸°í•˜ê²Œ ë§Œë“ ë‹¤ë©´ Blockingì´ë‹¤. ì…ì¥ì˜ ì°¨ì´ Blocking/NonBlockingì€ í˜¸ì¶œí•œ ì…ì¥ì—ì„œì˜ íŠ¹ì§• Sync/AsyncëŠ” ì²˜ë¦¬ë˜ëŠ” ë°©ì‹ì˜ íŠ¹ì§• ë™ì‘ê´€ì ì˜ ì°¨ì´ Non-Blockingì€ ì œì–´ë¬¸ ìˆ˜ì¤€ì—ì„œ ì§€ì²´ì—†ì´ ë°˜í™˜í•˜ëŠ” ê²ƒ AsynchronousëŠ” ë³„ë„ì˜ ì“°ë ˆë“œë¡œ ë¹¼ì„œ ì‹¤í–‰í•˜ê³ , ì™„ë£Œë˜ë©´ í˜¸ì¶œí•˜ëŠ” ì¸¡ì— ì•Œë ¤ì£¼ëŠ” ê²ƒ 4. Synchronous VS Asynchronousë‘ ê°€ì§€ ì´ìƒì˜ ëŒ€ìƒ(ë©”ì„œë“œ, ì‘ì—…, ì²˜ë¦¬ ë“±)ê³¼ ì´ë¥¼ ì²˜ë¦¬í•˜ëŠ” ì‹œê°„ìœ¼ë¡œ êµ¬ë¶„í•œë‹¤.Synchronous: í˜¸ì¶œëœ í•¨ìˆ˜ì˜ ë¦¬í„´í•˜ëŠ” ì‹œê°„ê³¼ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ì‹œê°„ì´ ì¼ì¹˜í•˜ëŠ” ê²½ìš°Asynchronous: í˜¸ì¶œëœ í•¨ìˆ˜ì˜ ë¦¬í„´í•˜ëŠ” ì‹œê°„ê³¼ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ëŠ” ì‹œê°„ì´ ì¼ì¹˜í•˜ì§€ ì•ŠëŠ” ê²½ìš° Blocking VS Non-Blockingí˜¸ì¶œë˜ëŠ” ëŒ€ìƒì´ ì§ì ‘ ì œì–´í•  ìˆ˜ ì—†ëŠ” ê²½ìš° ì´ë¥¼ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.Blocking: ì§ì ‘ ì œì–´í•  ìˆ˜ ì—†ëŠ” ëŒ€ìƒì˜ ì‘ì—…ì´ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•˜ëŠ” ê²½ìš°Non-Blocking: ì§ì ‘ ì œì–´í•  ìˆ˜ ì—†ëŠ” ëŒ€ìƒì˜ ì‘ì—…ì´ ì™„ë£Œë˜ê¸° ì „ì— ì œì–´ê¶Œì„ ë„˜ê²¨ì£¼ëŠ” ê²½ìš° 5. Blocking VS Non-Blockingë¸”ëŸ­í‚¹ê³¼ ë…¼ë¸”ëŸ­í‚¹ì€ ëŒ€ê¸°íì™€ í˜¸ì¶œ ê²°ê³¼ ì‹œì ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤. ì„¤ëª…í•˜ê¸° ì‰½ê²Œ í”„ë¡œê·¸ë¨ Aì™€ Bê°€ ìˆë‹¤ê³  ê°€ì •í•˜ê² ë‹¤. í”„ë¡œì„¸ìŠ¤ëŠ” í”„ë¡œê·¸ë¨ Aì—ì„œ Bë¥¼ í˜¸ì¶œí•˜ëŠ” ìˆœì„œë¡œ ì§„í–‰í•œë‹¤.Blockingí”„ë¡œê·¸ë¨ A ì—ì„œëŠ” í”„ë¡œê·¸ë¨ B ë¡œì§ì´ ìˆ˜í–‰ ì™„ë£Œë  ë•Œ ê¹Œì§€ ëŒ€ê¸°íì— ë“¤ì–´ê°€ ë¡œì§ì´ ì™„ë£Œëœ ì´í›„ì—ë‚˜ ëŒ€ê¸°íì—ì„œ í”„ë¡œê·¸ë¨ Aê°€ ë°˜í™˜ë˜ì–´ ì´í›„ ë¡œì§ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.í”„ë¡œê·¸ë¨ BëŠ” í˜¸ì¶œ ê²°ê³¼ë¥¼ ë¡œì§ ìˆ˜í–‰ ì™„ë£Œ ì´í›„ì— í”„ë¡œê·¸ë¨ Aì—ê²Œ ëŒë ¤ì£¼ê²Œ ëœë‹¤.Non Blockingí”„ë¡œê·¸ë¨ AëŠ” í”„ë¡œê·¸ë¨ Bë¥¼ í˜¸ì¶œí•œ ì´í›„ì—ë„ ì œì–´ê¶Œì„ ê°€ì§€ê³  ìˆì–´ ëŒ€ê¸°íì— ë“¤ì–´ê°€ì§€ ì•Šê³  ë‹¤ë¥¸ ë¡œì§ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤.í”„ë¡œê·¸ë¨ Bê°€ í˜¸ì¶œëœ ìˆœê°„ í˜¸ì¶œë˜ì—ˆë‹¤ëŠ” ê²°ê³¼ë§Œ í”„ë¡œê·¸ë¨ Aì—ê²Œ ëŒë ¤ì¤€ë‹¤. Synchronous VS Asynchronousë™ê¸°ì™€ ë¹„ë™ê¸°ëŠ” í˜¸ì¶œí•œ ê²°ê³¼ì˜ ì™„ë£Œ ì—¬ë¶€ë¥¼ í™•ì¸ í•˜ëŠ”ê°€ì— ë”°ë¼ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.Syncí”„ë¡œê·¸ë¨ Bê°€ ì™„ë£Œí•  ë•Œê¹Œì§€ í”„ë¡œê·¸ë¨ AëŠ” ê¸°ë‹¤ë¦¬ê²Œ ë˜ë¯€ë¡œ ì•„ë¬´ëŸ° ë¡œì§ë„ ìˆ˜í–‰í•˜ì§€ ëª»í•œë‹¤.ASyncí”„ë¡œê·¸ë¨ Bë¥¼ í˜¸ì¶œí•œ ì´í›„ì— í”„ë¡œê·¸ë¨ AëŠ” í”„ë¡œê·¸ë¨ Bì˜ ì™„ë£Œ ì—¬ë¶€ë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ë‹¤ìŒ ë¡œì§ì„ ìˆ˜í–‰í•œë‹¤.sync vs async Synchronous/AsynchronousëŠ” í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì˜ ì‘ì—… ì™„ë£Œ ì—¬ë¶€ë¥¼ ëˆ„ê°€ ì‹ ê²½ì“°ëƒê°€ ê´€ì‹¬ì‚¬ë‹¤. í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì—ê²Œ callbackì„ ì „ë‹¬í•´ì„œ, í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì˜ ì‘ì—…ì´ ì™„ë£Œë˜ë©´ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ê°€ ì „ë‹¬ë°›ì€ callbackì„ ì‹¤í–‰í•˜ê³ , í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ëŠ” ì‘ì—… ì™„ë£Œ ì—¬ë¶€ë¥¼ ì‹ ê²½ì“°ì§€ ì•Šìœ¼ë©´ Asynchronousë‹¤. í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì˜ ì‘ì—… ì™„ë£Œ í›„ ë¦¬í„´ì„ ê¸°ë‹¤ë¦¬ê±°ë‚˜, ë˜ëŠ” í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ë¡œë¶€í„° ë°”ë¡œ ë¦¬í„´ ë°›ë”ë¼ë„ ì‘ì—… ì™„ë£Œ ì—¬ë¶€ë¥¼ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ ìŠ¤ìŠ¤ë¡œ ê³„ì† í™•ì¸í•˜ë©° ì‹ ê²½ì“°ë©´ Synchronousë‹¤. ë™ê¸°ëŠ” ë‘ ê°€ì§€ ì´ìƒì˜ ëŒ€ìƒ(í•¨ìˆ˜, ì• í”Œë¦¬ì¼€ì´ì…˜ ë“±)ì´ ì„œë¡œ ì‹œê°„ì„ ë§ì¶° í–‰ë™í•˜ëŠ” ê²ƒì´ë‹¤. ì˜ˆë¥¼ë“¤ì–´ í˜¸ì¶œí•œ í•¨ìˆ˜ê°€ í˜¸ì¶œëœ í•¨ìˆ˜ì˜ ì‘ì—…ì´ ëë‚˜ì„œ ê²°ê³¼ê°’ì„ ë°˜í™”í•˜ê¸°ë¥¼ ê¸°ë‹¤ë¦¬ê±°ë‚˜, ì§€ì†ì ìœ¼ë¡œ í˜¸ì¶œëœ í•¨ìˆ˜ì—ê²Œ í™•ì¸ ìš”ì²­ì„í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤. Aì™€ Bê°€ ì‹œì‘ ì‹œê°„ ë˜ëŠ” ì¢…ë£Œ ì‹œê°„ì´ ì¼ì¹˜í•˜ë©´ ë™ê¸°ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ A, B ì“°ë ˆë“œê°€ ë™ì‹œì— ì‘ì—…ì„ ì‹œì‘í•˜ëŠ” ê²½ìš° (ì˜ˆë¥¼ ë“¤ë©´ ìë°”ì—ì„œ CyclicBarrier) ë©”ì„œë“œ ë¦¬í„´ ì‹œê°„(A)ê³¼ ê²°ê³¼ë¥¼ ì „ë‹¬ë°›ëŠ” ì‹œê°„(B)ì´ ì¼ì¹˜í•˜ëŠ” ê²½ìš° Aê°€ ëë‚˜ëŠ” ì‹œê°„ê³¼ Bê°€ ì‹œì‘í•˜ëŠ” ì‹œê°„ì´ ê°™ìœ¼ë©´ ë™ê¸°ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ìë°”ì—ì„œ synchronizedì™€ BlockingQueueê°€ ìœ„ì™€ ê°™ì€ ê²½ìš°ì´ë‹¤. ë¹„ë™ê¸°ëŠ” ë™ê¸°ì™€ ë°˜ëŒ€ë¡œ ëŒ€ìƒì´ ì„œë¡œ ì‹œê°„ì„ ë§ì¶”ì§€ ì•ŠëŠ” ê²ƒì„ ë§í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ í˜¸ì¶œí•˜ëŠ” í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì—ê²Œ ì‘ì—…ì„ ë§¡ê²¨ë†“ê³  ì‹ ê²½ì„ ì“°ì§€ ì•ŠëŠ” ê²ƒì„ ë§í•œë‹¤. ë¹„ë™ê¸°ì— ëŒ€í•œ ìì„¸í•œ ì˜ˆì œëŠ” ì•„ë˜ì—ì„œ ë‹¤ë£° ê²ƒì´ë‹¤.blocking vs non-blocking Blocking/NonBlockingì€ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ê°€ ë°”ë¡œ ë¦¬í„´í•˜ëŠëƒ ë§ˆëŠëƒê°€ ê´€ì‹¬ì‚¬ë‹¤. í˜¸ì¶œëœ í•¨ìˆ˜ê°€ ë°”ë¡œ ë¦¬í„´í•´ì„œ í˜¸ì¶œí•œ í•¨ìˆ˜ì—ê²Œ â€˜ì œì–´ê¶Œâ€™ì„ ë„˜ê²¨ì£¼ê³ , í˜¸ì¶œí•œ í•¨ìˆ˜ê°€ ë‹¤ë¥¸ ì¼ì„ í•  ìˆ˜ ìˆëŠ” ê¸°íšŒë¥¼ ì¤„ ìˆ˜ ìˆìœ¼ë©´ NonBlockingì´ë‹¤. ê·¸ë ‡ì§€ ì•Šê³  í˜¸ì¶œëœ í•¨ìˆ˜ê°€ ìì‹ ì˜ ì‘ì—…ì„ ëª¨ë‘ ë§ˆì¹  ë•Œê¹Œì§€ í˜¸ì¶œí•œ í•¨ìˆ˜ì—ê²Œ ì œì–´ê¶Œì„ ë„˜ê²¨ì£¼ì§€ ì•Šê³  ëŒ€ê¸°í•˜ê²Œ ë§Œë“ ë‹¤ë©´ Blockingì´ë‹¤. ë¸”ëŸ­í‚¹ê³¼ ë…¼ë¸”ëŸ­í‚¹ì€ ëŒ€ê¸°íì™€ í˜¸ì¶œ ê²°ê³¼ ì‹œì ìœ¼ë¡œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤. ë¸”ë¡í‚¹/ë…¼ë¸”ë¡í‚¹ì„ ë™ê¸°/ë¹„ë™ê¸°ì™€ ê°™ì´ ìƒê°í•˜ëŠ” ê²½ìš°ê°€ ë§ì€ë°, ì´ëŠ” ì„œë¡œ ê´€ì ì´ ë‹¤ë¥´ë‹¤. ë¸”ë¡í‚¹/ë…¼ë¸”ë¡í‚¹ì€ ì§ì ‘ ì œì–´í•  ìˆ˜ ì—†ëŠ” ëŒ€ìƒì„ ì²˜ë¦¬í•˜ëŠ” ë°©ë²•ì— ë”°ë¼ ë‚˜ëˆˆë‹¤. ì§ì ‘ ì œì–´í•  ìˆ˜ ì—†ëŠ” ëŒ€ìƒì€ ëŒ€í‘œì ìœ¼ë¡œ IO, ë©€í‹°ì“°ë ˆë“œ ë™ê¸°í™”ê°€ ìˆë‹¤.asynchronous programming vs multithreading programming IntroductionIn this tutorial, weâ€™ll show a simple explanation for asynchronous programming and multithreading programming. Then, weâ€™ll discuss the differences between them. What Is Asynchronous Programming?An asynchronous model allows multiple things to happen at the same time. When your program calls a long-running function, it doesnâ€™t block the execution flow, and your program continues to run. When the function finishes, the program knows and gets access to the result (if thereâ€™s a need for that). Letâ€™s take an example of a program that fetches two files over a network and combines them:In an asynchronous system, the solution is to start an additional thread of control. The first thread fetches the first file, and the second thread fetches the second file without waiting for the first thread to finish, and then both threads wait for their results to come back, after which they resynchronize to combine their results.Another example with a single-thread approach is a program that requests a file from the OS and needs to make a mathematical operation.In an asynchronous system, the program asks the OS for the file and returns the control to the mathematical operation to be executed on the CPU, while waiting for the file.One approach to asynchronous programming is to make functions that perform a slow action and take an extra argument, a callback function. The action is started, and when it finishes, the callback function is called with the result. What Is Multithreading Programming?Multithreading refers to the concurrent/parallel execution of more than one sequential set (thread) of instructions.On a single processor, multithreading gives the illusion of running in parallel. In reality, the processor is switching by using a scheduling algorithm. Or, itâ€™s switching based on a combination of external inputs (interrupts) and how the threads have been prioritized.On multiple processor cores, threads are truly parallel. Individual microprocessors work together to achieve the result more efficiently. There are multiple parallel, concurrent tasks happening at once.A basic example of multithreading is downloading two files from two different tabs in a web browser. Each tab uses a new thread to download the requested file. No tab waits for the other one to finish, they are downloading concurrently.The following picture shows a simple explanation of concurrent execution of a multithreaded application: Asynchronous vs MultithreadingFrom the definitions we just provided, we can see that multithreading programming is all about concurrent execution of different functions. Async programming is about non-blocking execution between functions, and we can apply async with single-threaded or multithreaded programming.So, multithreading is one form of asynchronous programming.Letâ€™s take a simple analogy; you have a friend, and you decided to make dinner together.Async is when you say to your friend, â€œYou go to the store and buy pasta. Let me know when you get back, to make dinner together. Meanwhile, Iâ€™ll prepare sauce and drinks.â€Threading is, â€œYou boil the water. Iâ€™ll heat the tomato sauce. While the water is boiling, ask me and Iâ€™ll put the pasta in. When the sauce is hot, you can add cheese. When both are done, Iâ€™ll sit down and you serve dinner. Then we eat.â€. In the threading analogy, we can see the sequence of â€œWhen, Doâ€ events, which represent the sequential set of instructions per each person (thread).From that analogy, we can conclude that Multithreading is about workers, Asynchronous is about tasks. Which One To Use?Choosing between the two programming models depends mainly on performance.Given all possible combinations between sync/async and single/multi-threading, which model should perform better?In a nutshell, for large scale applications with a lot of I/O operations and different computations, using asynchronous multithreading programming flow, will utilize the computation resources, and take care of non-blocking functions. This is the programming model of any OS!With more power, comes more responsibility! So if we decided to implement this model, we have to take care of different issues like race condition, deadlocks, shared resources, and callbacks events.ì°¸ê³ ìë£Œ https://www.baeldung.com/cs/async-vs-multi-threading http://homoefficio.github.io/2017/02/19/Blocking-NonBlocking-Synchronous-Asynchronous/ https://velog.io/@codemcd/Sync-VS-Async-Blocking-VS-Non-Blocking-sak6d01fhx https://incheol-jung.gitbook.io/docs/q-and-a/java/or-or-or" }, { "title": "(ë¯¸í•´ê²°) ì¹´í”„ì¹´ í”„ë¡œë“€ì„œ ì¬ì†¡ì‹  í…ŒìŠ¤íŠ¸", "url": "/posts/kafka-producer-message-retry-test/", "categories": "", "tags": "", "date": "2021-07-31 14:00:00 +0900", "snippet": "ìƒí™©ì¹´í”„ì¹´ì˜ ì „ë‹¬ ë³´ì¦ì— ëŒ€í•´ ê³µë¶€í–ˆê³  at most once, at least once, exactly once ì„¸ ì¢…ë¥˜ê°€ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆë‹¤.ê° ì „ë‹¬ ë³´ì¦ ìˆ˜ì¤€ì— ëŒ€í•´ ê³µë¶€í•˜ë©´ì„œ, ë¸Œë¡œì»¤ì—ì„œ ì‘ë‹µí•˜ëŠ” ackê°€ ì˜¤ì§€ì•ŠëŠ”(ìœ ì‹¤ë˜ëŠ”) ê²½ìš° í”„ë¡œë“€ì—ì„œ ë©”ì‹œì§€ë¥¼ ì¬ì „ì†¡ í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ë‹¤ìŒê³¼ ê°™ì€ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ê³  ì‹¶ì—ˆë‹¤. at most once ...", "content": "ìƒí™©ì¹´í”„ì¹´ì˜ ì „ë‹¬ ë³´ì¦ì— ëŒ€í•´ ê³µë¶€í–ˆê³  at most once, at least once, exactly once ì„¸ ì¢…ë¥˜ê°€ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆë‹¤.ê° ì „ë‹¬ ë³´ì¦ ìˆ˜ì¤€ì— ëŒ€í•´ ê³µë¶€í•˜ë©´ì„œ, ë¸Œë¡œì»¤ì—ì„œ ì‘ë‹µí•˜ëŠ” ackê°€ ì˜¤ì§€ì•ŠëŠ”(ìœ ì‹¤ë˜ëŠ”) ê²½ìš° í”„ë¡œë“€ì—ì„œ ë©”ì‹œì§€ë¥¼ ì¬ì „ì†¡ í•˜ëŠ” ë¶€ë¶„ì— ëŒ€í•´ë‹¤ìŒê³¼ ê°™ì€ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ê³  ì‹¶ì—ˆë‹¤. at most once ackê°€ ì˜¤ì§€ ì•Šì•„ë„ ë©”ì‹œì§€ë¥¼ ì¬ì „ì†¡í•˜ì§€ ì•ŠëŠ”ë‹¤. at least once ackê°€ ì˜¤ì§€ ì•Šìœ¼ë©´ ë©”ì‹œì§€ë¥¼ ì¬ì „ì†¡í•œë‹¤. ì´ë¯¸ ë¸Œë¡œì»¤ì—ì„œ ì €ì¥ëœ ë©”ì‹œì§€ì— ëŒ€í•´ ì¬ì „ì†¡ í•˜ê²Œë˜ë©´, ë©”ì‹œì§€ê°€ ì¤‘ë³µìœ¼ë¡œ ì €ì¥ë  ìˆ˜ ìˆë‹¤. exactly once ackê°€ ì˜¤ì§€ ì•Šìœ¼ë©´ ë©”ì‹œì§€ë¥¼ ì¬ì „ì†¡í•œë‹¤. ì´ë¯¸ ë¸Œë¡œì»¤ì—ì„œ ì €ì¥ëœ ë©”ì‹œì§€ì— ëŒ€í•´ ì¬ì „ì†¡ í•˜ë”ë¼ë„, ë¸Œë¡œì»¤ì—ì„œëŠ” ì¤‘ë³µ ë©”ì‹œì§€ ì²˜ë¦¬ ì•Œê³ ë¦¬ì¦˜ì„ í™œìš©í•´ ë©”ì‹œì§€ë¥¼ ì¤‘ë³µ ì €ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤. í•˜ì§€ë§Œ, ìƒê°ì²˜ëŸ¼ ìƒí™©ì„ ì‹œë®¬ë ˆì´ì…˜ í•  ìˆ˜ê°€ ì—†ì—ˆê³  ì–´ë–¤ ë¶€ë¶„ì„ ë” ê³µë¶€í•´ì•¼ ì›í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ì œëŒ€ë¡œ í•  ìˆ˜ ìˆëŠ”ì§€ ëª¨ë¥´ê² ë‹¤â€¦ì¼ë‹¨ ì‹œë„í•´ë³¸ ê²ƒê³¼ ì‹¤íŒ¨ì— ëŒ€í•œ ì›ì¸ì„ ì ì–´ë³´ê³ , ì•ìœ¼ë¡œ ë” ê³µë¶€í•˜ë©´ì„œ ì–´ë–¤ê±¸ ëª°ëê³  ì˜ëª» ìƒê°í•˜ê³  ìˆë˜ê±´ì§€ ê¹¨ë‹«ê²Œ ë  ë•Œ, ë‹¤ì‹œ ì œëŒ€ë¡œ í…ŒìŠ¤íŠ¸í•´ì„œ ì´ ê¸€ì„ ë³´ì™„í•  ì˜ˆì •ì´ë‹¤.ì‹œë„í•´ë³¸ ê²ƒë“¤Case 1. at least once ìˆ˜ì¤€ì—ì„œì˜ ì¬ì†¡ì‹  í™˜ê²½ ë° ì˜µì…˜ ì„¸íŒ… ë¸Œë¡œì»¤ 1ëŒ€ / acks = 1(default) / request.timeout.ms = 1000 (1ì´ˆ) / retries = 10 í† í”½ ìƒì„± ./bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 1 --partitions 1 --topic í† í”½ëª… í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ë¸Œë¡œì»¤ë¥¼ ëˆë‹¤. í”„ë¡œë“€ì„œì—ì„œ ë©”ì‹œì§€ë¥¼ ì†¡ì‹ í•œë‹¤. request.timeout.msì— ì •ì˜ëœ ì‹œê°„ ë‚´ì— ack ì‘ë‹µì´ ì˜¤ì§€ ì•Šìœ¼ë©´ 10ë²ˆ ì¬ì†¡ì‹ ëœë‹¤. send ë©”ì„œë“œ ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì¸ Callback ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬, ì¬ì†¡ì‹ ëœ 10ê±´ì˜ ë©”ì‹œì§€ì— ëŒ€í•œ exceptionì´ 10ë²ˆ ëœ¨ëŠ”ì§€ í™•ì¸í•œë‹¤. í…ŒìŠ¤íŠ¸ ê²°ê³¼ exception : org.apache.kafka.common.errors.TimeoutException: Failed to update metadata after 60000 ms. í”„ë¡œë“€ì„œ ì½”ë“œimport org.apache.kafka.clients.producer.*;import org.apache.kafka.common.serialization.StringSerializer;import java.util.Properties;import java.util.Scanner;public class SampleProducer { private static final String TOPIC_NAME = \"jaeyoon\"; private static final String FIN_MESSAGE = \"exit\"; public static void main(String[] args) { Properties properties = new Properties(); properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \"localhost:9092\"); properties.put(ProducerConfig.ACKS_CONFIG, \"1\"); properties.put(ProducerConfig.REQUEST_TIMEOUT_MS_CONFIG, 1000); properties.put(ProducerConfig.RETRIES_CONFIG, 10); properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(properties); while(true) { Scanner sc = new Scanner(System.in); System.out.print(\"Input &gt; \"); String message = sc.nextLine(); ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(TOPIC_NAME, message); try { producer.send(record, (metadata, exception) -&gt; { System.out.println(\"metadata : \"+metadata); if (exception != null) { // some exception System.out.println(\"exception : \"+exception); } }); } catch (Exception e) { // exception } finally { producer.flush(); } if(message.equals(FIN_MESSAGE)) { producer.close(); break; } } }}ê²°ê³¼ ë¶„ì„ ë¸Œë¡œì»¤ê°€ êº¼ì ¸ìˆì—ˆê¸° ë•Œë¬¸ì— metadataë¥¼ ì œí•œ ì‹œê°„ë‚´ì— ê°€ì ¸ì˜¤ì§€ ëª»í•´ì„œ ë°œìƒí•œ ì—ëŸ¬ì´ë‹¤. send ë©”ì„œë“œëŠ” ì‹¤í–‰ í›„ max.block.ms(default 60000)ì— ì •ì˜ëœ ë§Œí¼ metadata fetch ë° ë²„í¼ í• ë‹¹ì„ ê¸°ë‹¤ë¦¬ëŠ” ì´ ì‹œê°„ì„ ì œí•œí•œë‹¤. í•´ë‹¹ ì‹œê°„ì´ ì´ˆê³¼í•˜ë©´ TimeoutExceptionì´ ë°œìƒí•œë‹¤. ë©”íƒ€ë°ì´í„°ëŠ” ì–¸ì œ ê°€ì ¸ì˜¤ë‚˜ ? í”„ë¡œë“€ì„œê°€ ì²˜ìŒìœ¼ë¡œ ë©”íƒ€ë°ì´í„° ìš”ì²­ì„ í•˜ëŠ” ë•ŒëŠ” í´ë¼ì´ì–¸íŠ¸ êµ¬ì„±ì—ì„œ ì„¤ì •í•œ ë¶€íŠ¸ìŠ¤íŠ¸ë© ì„œë²„(bootstrap.server)ì— ì—°ê²°í•  ë•Œë‹¤. ë¬¼ë¡ , í•œ ëŒ€ ì´ìƒì˜ ë¸Œë¡œì»¤ì¼ ìˆ˜ ìˆì§€ë§Œ ë°˜ë“œì‹œ í´ëŸ¬ìŠ¤í„°ì— ìˆëŠ” ëª¨ë“  ë¸Œë¡œì»¤ì¼ í•„ìš”ëŠ” ì—†ë‹¤(ë”°ë¼ì„œ ë©”íƒ€ë°ì´í„° ìš”ì²­ì€ ê° ë¸Œë¡œì»¤ì— ëŒ€í•œ ê²ƒì´ ì•„ë‹˜). ë©”íƒ€ë°ì´í„°ë¥¼ í†µí•´, í”„ë¡œë“€ì„œëŠ” ìì‹ ì´ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ê³ ì í•˜ëŠ” í† í”½ì´ ì–´ë””ì— ìˆëŠ”ì§€ ì •ë³´ë¥¼ ì–»ëŠ”ë‹¤. ë˜ëŠ”, í† í”½ì˜ ë¦¬ë” ë ˆí”Œë¦¬ì¹´ë¥¼ ê°€ì§„ ë¸Œë¡œì»¤ì— ì—°ê²° ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ë©”íƒ€ë°ì´í„° ìš”ì²­ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. ì´ ê²½ìš° ë¸Œë¡œì»¤ì— ì—°ê²°í•˜ê¸° ìœ„í•´(ë‹¤ë¥¸ í† í”½ì— ëŒ€í•´ ì•„ì§ ì—°ê²°ë˜ì§€ ì•Šì€ ê²½ìš°) ì–´ë–¤ ë¸Œë¡œì»¤ê°€ ìƒˆ ë¦¬ë”ì¸ì§€ ì•Œì•„ì•¼ í•œë‹¤. Case 2. 1ë²ˆ ì¼€ì´ìŠ¤ì—ì„œ ë©”íƒ€ë°ì´í„° ì–»ì–´ì˜¨ í›„ ë¸Œë¡œì»¤ ì¢…ë£Œ í™˜ê²½ ë° ì˜µì…˜ ì„¸íŒ… (case1ê³¼ ë™ì¼) ë¸Œë¡œì»¤ 1ëŒ€ / acks = 1(default) / request.timeout.ms = 1000 (1ì´ˆ) / retries = 10 í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ì£¼í‚¤í¼ì™€ ë¸Œë¡œì»¤ë¥¼ ì¼œê³  ë©”ì‹œì§€ë¥¼ í•œ ë²ˆ ì†¡ì‹ í•œë‹¤.(ë©”íƒ€ë°ì´í„°ë¥¼ ë°›ì•„ì˜¨ë‹¤.) ë¸Œë¡œì»¤ë¥¼ ëˆë‹¤. ë©”ì‹œì§€ë¥¼ ì†¡ì‹ í•œë‹¤. request.timeout.msì— ì •ì˜ëœ ì‹œê°„ ë‚´ì— ack ì‘ë‹µì´ ì˜¤ì§€ ì•Šìœ¼ë©´ 10ë²ˆ ì¬ì†¡ì‹ ëœë‹¤. send ë©”ì„œë“œ ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì¸ Callback ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬, ì¬ì†¡ì‹ ëœ 10ê±´ì˜ ë©”ì‹œì§€ì— ëŒ€í•œ exceptionì´ 10ë²ˆ ëœ¨ëŠ”ì§€ í™•ì¸í•œë‹¤. í”„ë¡œë“€ì„œ ì½”ë“œ (case1ê³¼ ë™ì¼) í…ŒìŠ¤íŠ¸ ê²°ê³¼Input &gt; byeexception : org.apache.kafka.common.errors.TimeoutException: Expiring 1 record(s) for jaeyoon-0: 1018 ms has passed since batch creation plus linger timeê²°ê³¼ ë¶„ì„ í•´ë‹¹ ì—ëŸ¬ëŠ” ë²„í¼ì— ìŒ“ì¸ ë ˆì½”ë“œê°€ request.timeout.ms(default 30000)ì— ì„¸íŒ…ëœ ì‹œê°„ + linger.ms (default 0)ì— ì„¸íŒ…ëœ ì‹œê°„ì„ ì´ˆê³¼í•  ë•Œ ê¹Œì§€ ë¸Œë¡œì»¤ì— ì†¡ì‹ ë˜ì§€ ì•Šìœ¼ë©´ ë°œìƒí•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë ˆì½”ë“œê°€ ë²„í¼ì— ìŒ“ì´ëŠ” ì†ë„ &gt;&gt;&gt; ë ˆì½”ë“œë¥¼ ì†¡ì‹ í•˜ëŠ” ì†ë„ì¸ ê²½ìš° ë ˆì½”ë“œê°€ ë²„í¼ì—ì„œ ëŒ€ê¸°í•˜ëŠ” ì‹œê°„ì´ ê¸¸ì–´ì ¸ ì´ëŸ¬í•œ ì—ëŸ¬ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ìœ„ í…ŒìŠ¤íŠ¸ì˜ ê²½ìš°ì—ëŠ” í”„ë¡œë“€ì„œê°€ ì†¡ì‹ í•  ë¸Œë¡œì»¤ë¥¼ ì°¾ì§€ ëª»í•´ ë²„í¼ì— ë ˆì½”ë“œê°€ ìŒ“ì—¬ìˆë‹¤ê°€ request.timeout.msì— ì„¸íŒ…ëœ 1ì´ˆë¥¼ ë„˜ê²¨ ì—ëŸ¬ê°€ ë°œìƒí–ˆë‹¤. linger.ms í”„ë¡œë“€ì„œëŠ” í•´ë‹¹ ì˜µì…˜ì— ì„¸íŒ…ëœ ì‹œê°„ë§Œí¼(default 0) ì§€ì—° í›„ ë¸Œë¡œì»¤ë¡œ ë©”ì‹œì§€ë¥¼ ì†¡ì‹ í•œë‹¤. ì¦‰, ë²„í¼ì— ìŒ“ì¸ ë ˆì½”ë“œë¥¼ ì¦‰ì‹œ ë‚´ë³´ë‚´ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ë‹¤ë¥¸ ë ˆì½”ë“œê°€ í•¨ê»˜ ì „ì†¡ë  ìˆ˜ ìˆë„ë¡(batch ì²˜ë¦¬) ê¸°ë‹¤ë¦°ë‹¤. batch ì²˜ë¦¬ ë ˆì½”ë“œëŠ” ë¸Œë¡œì»¤ì—ê²Œ ì „ì†¡í•˜ê¸° ìœ„í•œ ë¬¶ìŒìœ¼ë¡œ(batch) ê·¸ë£¹í™”ë˜ì–´ ë©”ì‹œì§€ë‹¹ ì „ì†¡ ì˜¤ë²„í—¤ë“œë¥¼ ì¤„ì´ê³  ì²˜ë¦¬ëŸ‰ì„ ì¦ê°€ì‹œí‚¨ë‹¤. send ë©”ì„œë“œë¥¼ í˜¸ì¶œí•˜ë©´ ë¸Œë¡œì»¤ì—ê²Œ ë³´ë‚¼ ìˆ˜ ìˆë„ë¡ ProducerRecordê°€ ë‚´ë¶€ ë²„í¼ì— ì €ì¥ëœë‹¤. send ë©”ì„œë“œëŠ” ì „ì†¡ ì—¬ë¶€ì™€ ê´€ê³„ì—†ì´ ProducerRecordê°€ ë²„í¼ë§ë˜ë©´ ì¦‰ì‹œ return í•œë‹¤. ë°°ì¹˜ê°€ ì œí•œ ì‹œê°„ë³´ë‹¤ ì˜¤ë˜ ëŒ€ê¸°í•œ ê²½ìš° ì˜ˆì™¸ê°€ ë°œìƒí•˜ë©°, í•´ë‹¹ ë°°ì¹˜ì˜ ë ˆì½”ë“œëŠ” ì „ì†¡ ëŒ€ê¸°ì—´ì—ì„œ ì œê±°ëœë‹¤. (ìœ„ í…ŒìŠ¤íŠ¸ì˜ ê²½ìš°) Case3. min.insync.replicas í™œìš©í•˜ì—¬ ì—ëŸ¬ ë°œìƒì‹œí‚¤ê¸° í™˜ê²½ ë° ì˜µì…˜ ì„¸íŒ… ë¸Œë¡œì»¤ 3ëŒ€ / replication.factor = 3 / min.insync.replicas = 2 / acks = all / retries = 5 í† í”½ ìƒì„± ./bin/kafka-topics.sh --create --zookeeper localhost:2181 --config min.insync.replicas=2 --replication-factor 3 --partitions 1 --topic í† í”½ëª… í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ì£¼í”¼ì»¤ì™€ ë¸Œë¡œì»¤ë¥¼ 3ëŒ€ë¥¼ ì¼ ë‹¤. ë©”ì‹œì§€ë¥¼ í•œ ë²ˆ ì†¡ì‹ í•˜ê³  ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬ë˜ëŠ”ì§€ í™•ì¸í•œë‹¤. ë¸Œë¡œì»¤ ë‘ ëŒ€ë¥¼ ë‹¤ìš´ì‹œí‚¨ë‹¤. ë¸Œë¡œì»¤ê°€ í•œ ëŒ€ë§Œ ë‚¨ì•„ìˆìœ¼ë¯€ë¡œ min.insync.replicas=2ë¥¼ ë§Œì¡±í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ì—ëŸ¬ê°€ ë°œìƒí•  ê²ƒì´ê³  ë©”ì‹œì§€ëŠ” ì¬ì „ì†¡ ë  ê²ƒì´ë‹¤. send ë©”ì„œë“œ ë‘ ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì¸ Callback ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ì—¬, ì¬ì†¡ì‹ ëœ 10ê±´ì˜ ë©”ì‹œì§€ì— ëŒ€í•œ exceptionì´ 10ë²ˆ ëœ¨ëŠ”ì§€ í™•ì¸í•œë‹¤. í…ŒìŠ¤íŠ¸ ê²°ê³¼ í”„ë¡œë“€ì„œ ì¸¡ Input &gt; down test!exception : org.apache.kafka.common.errors.NotEnoughReplicasException: Messages are rejected since there are fewer in-sync replicas than required. ë¸Œë¡œì»¤ ì¸¡ (1ëŒ€ ë‚¨ì€ ë¸Œë¡œì»¤) ì²« ë²ˆì§¸ ì—ëŸ¬ ë°œìƒ í›„, í”„ë¡œë“€ì„œ ì¸¡ì— ì„¸íŒ…í•œ ëŒ€ë¡œ 5ë²ˆ ì¬ì‹œë„ í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. [2021-08-02 04:05:07,937] ERROR [ReplicaManager broker=0] Error processing append operation on partition dawn-0 (kafka.server.ReplicaManager)org.apache.kafka.common.errors.NotEnoughReplicasException: The size of the current ISR Set(0) is insufficient to satisfy the min.isr requirement of 2 for partition dawn-0[2021-08-02 04:05:08,043] ERROR [ReplicaManager broker=0] Error processing append operation on partition dawn-0 (kafka.server.ReplicaManager)org.apache.kafka.common.errors.NotEnoughReplicasException: The size of the current ISR Set(0) is insufficient to satisfy the min.isr requirement of 2 for partition dawn-0[2021-08-02 04:05:08,150] ERROR [ReplicaManager broker=0] Error processing append operation on partition dawn-0 (kafka.server.ReplicaManager)org.apache.kafka.common.errors.NotEnoughReplicasException: The size of the current ISR Set(0) is insufficient to satisfy the min.isr requirement of 2 for partition dawn-0[2021-08-02 04:05:08,258] ERROR [ReplicaManager broker=0] Error processing append operation on partition dawn-0 (kafka.server.ReplicaManager)org.apache.kafka.common.errors.NotEnoughReplicasException: The size of the current ISR Set(0) is insufficient to satisfy the min.isr requirement of 2 for partition dawn-0[2021-08-02 04:05:08,363] ERROR [ReplicaManager broker=0] Error processing append operation on partition dawn-0 (kafka.server.ReplicaManager)org.apache.kafka.common.errors.NotEnoughReplicasException: The size of the current ISR Set(0) is insufficient to satisfy the min.isr requirement of 2 for partition dawn-0[2021-08-02 04:05:08,465] ERROR [ReplicaManager broker=0] Error processing append operation on partition dawn-0 (kafka.server.ReplicaManager)org.apache.kafka.common.errors.NotEnoughReplicasException: The size of the current ISR Set(0) is insufficient to satisfy the min.isr requirement of 2 for partition dawn-0 í”„ë¡œë“€ì„œ ì½”ë“œimport org.apache.kafka.clients.producer.*;import org.apache.kafka.common.serialization.StringSerializer;import java.util.Properties;import java.util.Scanner;public class SampleProducer { private static final String TOPIC_NAME = \"dawn\"; private static final String FIN_MESSAGE = \"exit\"; public static void main(String[] args) { Properties properties = new Properties(); properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \"localhost:9092,localhost:9093,localhost:9094\"); properties.put(ProducerConfig.ACKS_CONFIG, \"all\"); properties.put(ProducerConfig.REQUEST_TIMEOUT_MS_CONFIG, 1000); properties.put(ProducerConfig.RETRIES_CONFIG, 5); properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(properties); while (true) { Scanner sc = new Scanner(System.in); System.out.print(\"Input &gt; \"); String message = sc.nextLine(); ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(TOPIC_NAME, message); try { producer.send(record, (metadata, exception) -&gt; { if (exception != null) { // some exception System.out.println(\"exception : \" + exception); } }); } catch (Exception e) { // exception } finally { producer.flush(); } if (message.equals(FIN_MESSAGE)) { producer.close(); break; } } }}ê²°ê³¼ ë¶„ì„ ë¸Œë¡œì»¤ ì¸¡ì—ì„œ í”„ë¡œë“€ì„œì— ì„¸íŒ…í•œ ì¬ì†¡ì‹  íšŸìˆ˜ ë§Œí¼ì˜ ì˜ˆì™¸ ë©”ì‹œì§€ë¥¼ ì¶œë ¥í•œë‹¤. ê·¸ë ‡ë‹¤ëŠ”ê±´ ì´ˆê¸°ì— ì„¸íŒ…í•œ íšŸìˆ˜ë§Œí¼ ë©”ì‹œì§€ë¥¼ ì¬ì „ì†¡ í–ˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì¬ì „ì†¡ì„ í•˜ê¸´ í–ˆëŠ”ë°, í”„ë¡œë“€ì„œ ì¸¡ì—ì„œì˜ ì½œë°±ì€ í•œ ë²ˆë§Œ ë°œìƒí–ˆë‹¤. ì¬ì „ì†¡ì´ë¼ëŠ”ê²Œ send ë©”ì„œë“œê°€ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œë˜ëŠ” ê°œë…ì´ ì•„ë‹ˆë¼, sendë¥¼ í•œ ë²ˆ í˜¸ì¶œí•˜ë©´ ê·¸ ì•ˆì—ì„œ í•„ìš”í•œ ê²½ìš° ìë™ìœ¼ë¡œ ì¬ì „ì†¡ì´ ë˜ê³  ê·¸ì— ëŒ€í•œ ìµœì¢…ì ì¸ ê²°ê³¼ë¥¼ ì½œë°± ë©”ì„œë“œì— ë„˜ê²¨ì£¼ëŠ”ê±´ê°€ ? ì •í™•íˆ send ë©”ì„œë“œ ë‚´ë¶€ì˜ ì½”ë“œë¥¼ ì´í•´í•˜ì§€ëŠ” ëª»í–ˆì§€ë§Œ, ì´ì— ëŒ€í•œ ì˜ë¬¸ì€ RetriableExceptionì— ëŒ€í•´ ê³µë¶€í•˜ë©´ì„œ ì¡°ê¸ˆì€ í•´ì†Œë˜ì—ˆë‹¤. RetriableException í”„ë¡œë“€ì„œì˜ ì—ëŸ¬ ì²˜ë¦¬ì—ëŠ” ë‘ ê°€ì§€ê°€ ìˆë‹¤. í”„ë¡œë“€ì„œê°€ ìë™ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ì—ëŸ¬(=ì¬ì‹œë„ ê°€ëŠ¥í•œ ì—ëŸ¬) ê°œë°œìê°€ í”„ë¡œë“€ì„œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì„œ ì²˜ë¦¬í•´ì•¼í•˜ëŠ” ì—ëŸ¬ ì˜ˆë¥¼ ë“¤ì–´, LEADER_NOT_AVAILABE ê°™ì€ ì—ëŸ¬ëŠ” ë¦¬ë”ê°€ ë‹¤ì‹œ ì„ ì¶œë˜ë©´ í•´ê²°ë˜ëŠ” ë¬¸ì œì´ë¯€ë¡œ ì¬ì‹œë„ ê°€ëŠ¥í•œ ì—ëŸ¬(retriable error) ë¼ê³  í•œë‹¤. ë°˜ë©´, INVALD_CONFIGì—ëŸ¬ (êµ¬ì„±ì´ ì˜ëª»ë˜ì–´ ë°œìƒí•œ ì—ëŸ¬)ì˜ ê²½ìš°ëŠ” ì•„ë¬´ë¦¬ ë©”ì‹œì§€ë¥¼ ì¬ì „ì†¡í•´ë„ êµ¬ì„±ì´ ë³€ê²½ë˜ì§€ ì•Šìœ¼ë¯€ë¡œ ì¬ì‹œë„ ë¶ˆê°€ëŠ¥í•œ ì—ëŸ¬ì´ë‹¤. ì¬ì‹œë„ ê°€ëŠ¥í•œ ì—ëŸ¬ëŠ” ì¹´í”„ì¹´ í”„ë¡œë“€ì„œ ê°ì²´ê°€ ì•Œì•„ì„œ í•´ì£¼ë¯€ë¡œ ìš°ë¦¬ ì½”ë“œì—ì„œ ì§ì ‘ ì²˜ë¦¬í•  í•„ìš”ê°€ ì—†ë‹¤. ìœ„ì—ì„œ ë°œìƒí•œ NotEnoughReplicasException ë˜í•œ ì¬ì‹œë„ ê°€ëŠ¥í•œ ì—ëŸ¬ì´ë‹¤.ReplicaManager í…ŒìŠ¤íŠ¸ ê²°ê³¼ì˜ ë¸Œë¡œì»¤ ì¸¡ ì˜ˆì™¸ ë©”ì‹œì§€ë¥¼ ë³´ë©´ kafka.server.ReplicaManagerì—ì„œ ì—ëŸ¬ë¥¼ ë°œìƒì‹œí‚¤ëŠ” ê²ƒ ê°™ì•„ ì°¾ì•„ë³´ë‹ˆ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì„±ìœ¼ë¡œ ë˜ì–´ìˆëŠ” ê²ƒ ê°™ë‹¤. â€œReplicaManager manages log replicas using the LogManager.â€ ë¼ê³  ì„¤ëª… ë˜ì–´ìˆëŠ”ë°, ì¹´í”„ì¹´ ì„œë²„ì¸¡ ë¡œê·¸ë¥¼ ë‹´ë‹¹í•˜ëŠ” ì—­í• ì„ í•˜ëŠ” ê²ƒ ê°™ë‹¤. ì¶œì²˜ : https://jaceklaskowski.gitbooks.io/apache-kafka/content/kafka-server-ReplicaManager.html Case4. at most once vs at least once ë©”ì‹œì§€ ìœ ì‹¤ ì •ë„ ë¹„êµ í™˜ê²½ ë° ì˜µì…˜ ì„¸íŒ… ë¸Œë¡œì»¤ 3ëŒ€ / replication.factor = 3 / min.insync.replicas = 2 / retries = Integer.MAX acks = 0 (at most once) acks = 1 (at least once) í† í”½ ìƒì„± ./bin/kafka-topics.sh --create --zookeeper localhost:2181 --config min.insync.replicas=2 --replication-factor 3 --partitions 1 --topic í† í”½ëª… í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ ì£¼í‚¤í¼ì™€ ë¸Œë¡œì»¤ 3ëŒ€ë¥¼ ì¼ ë‹¤. ./bin/kafka-topics.sh --describe --topic í† í”½ëª… --zookeeper localhost:2181 ëª…ë ¹ì–´ë¥¼ í†µí•´ ë¦¬ë” ë ˆí”Œë¦¬ì¹´ë¥¼ íŒŒì•…í•œë‹¤. ./bin/kafka-consumer-groups.sh --bootstrap-server localhost:í¬íŠ¸ë²ˆí˜¸ --group dawn --describe ëª…ë ¹ì–´ë¥¼ í†µí•´ ë¸Œë¡œì»¤ 3ëŒ€ì˜ LOG-END-OFFSETì„ íŒŒì•…í•œë‹¤. í”„ë¡œë“€ì„œì—ì„œ 10ë§Œê±´ì˜ ë©”ì‹œì§€ë¥¼ ì†¡ì‹ í•˜ê²Œ í•˜ê³  ë„ì¤‘ì— ë¦¬ë” ë ˆí”Œë¦¬ì¹´ë¥¼ ê°€ì§„ ë¸Œë¡œì»¤ë¥¼ ë‹¤ìš´ì‹œí‚¨ë‹¤. ë©”ì‹œì§€ ì†¡ì‹ ì´ ì™„ë£Œë˜ê³  ë‚œ ë’¤, ìƒˆë¡œìš´ ë¦¬ë” ë ˆí”Œë¦¬ì¹´ë¥¼ íŒŒì•…í•˜ê³  3ë²ˆ ëª…ë ¹ì–´ í†µí•´ í˜„ì¬ LOG-END-OFFSETì„ í™•ì¸í•œë‹¤. ìƒˆë¡œìš´ ë¦¬ë”ê°€ ì„ ì¶œë  ë•Œ LeaderNotAvailableExceptionê°€ ë°œìƒí•  ê²ƒì´ê³ , ê·¸ë¡œ ì¸í•´ ì²˜ë¦¬ë˜ì§€ ëª»í•œ ë©”ì‹œì§€ê°€ ì–¼ë§ˆë‚˜ ì°¨ì´ê°€ ë‚˜ëŠ”ì§€ í™•ì¸í•´ë³¸ë‹¤. at most onceì¸ ê²½ìš°ì—ëŠ” ë¦¬ë” ì„ ì¶œë¡œ ì¸í•´ ë©”ì‹œì§€ ì²˜ë¦¬ê°€ ë˜ì§€ ì•Šë”ë¼ë„ ì¬ì†¡ì‹  í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ìœ ì‹¤ë˜ëŠ” ë©”ì‹œì§€ê°€ ìˆì„ ê²ƒì´ë‹¤. at least onceì¸ ê²½ìš°ì— ë¦¬ë” ì„ ì¶œë¡œ ì¸í•´ ì—ëŸ¬ê°€ ë‚˜ëŠ” ê²½ìš° ë©”ì‹œì§€ë¥¼ ì¬ì†¡í•  ê²ƒì´ë¯€ë¡œ at most once ê²½ìš°ë³´ë‹¤ëŠ” ë” ë§ì€ ë©”ì‹œì§€ê°€ ì²˜ë¦¬ë  ê²ƒì´ë‹¤. í…ŒìŠ¤íŠ¸ ê²°ê³¼ (at most once) before GROUP TOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAGdawn dawn 0 5 5 0 after GROUP TOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAGdawn dawn 0 100005 100005 0 í…ŒìŠ¤íŠ¸ ê²°ê³¼ (at least once) before GROUP TOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAGdawn dawn 0 100005 100005 0 after GROUP TOPIC PARTITION CURRENT-OFFSET LOG-END-OFFSET LAGdawn dawn 0 200005 200005 0 í”„ë¡œë“€ì„œ ì½”ë“œpackage basic;import org.apache.kafka.clients.producer.*;import org.apache.kafka.common.serialization.StringSerializer;import java.util.Properties;import java.util.Scanner;public class SampleProducer { private static final String TOPIC_NAME = \"dawn\"; private static final String FIN_MESSAGE = \"exit\"; public static void main(String[] args) { Properties properties = new Properties(); properties.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, \"localhost:9092,localhost:9093,localhost:9094\"); properties.put(ProducerConfig.ACKS_CONFIG, \"1\"); // at most once : 0 , at least once : 1 properties.put(ProducerConfig.RETRIES_CONFIG, Integer.MAX_VALUE); properties.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); properties.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class.getName()); KafkaProducer&lt;String, String&gt; producer = new KafkaProducer&lt;&gt;(properties); while (true) { Scanner sc = new Scanner(System.in); System.out.print(\"Input &gt; \"); String message = sc.nextLine(); ProducerRecord&lt;String, String&gt; record = new ProducerRecord&lt;&gt;(TOPIC_NAME, message); try { for(int i=0; i&lt;100000; i++) { producer.send(record, (metadata, exception) -&gt; { if (exception != null) { // some exception System.out.println(\"exception : \" + exception); } }); if(i%10000==0) { Thread.sleep(1000); } } } catch (Exception e) { // exception } finally { producer.flush(); } if (message.equals(FIN_MESSAGE)) { producer.close(); break; } } }}ê²°ê³¼ ë¶„ì„ ë‘ ê°€ì§€ ì „ë‹¬ ë³´ì¦ ìˆ˜ì¤€ ëª¨ë‘ì—ì„œ ë©”ì‹œì§€ ìœ ì‹¤ì€ ì—†ì—ˆë‹¤. ì´ë ‡ê²Œ í…ŒìŠ¤íŠ¸í•˜ëŠ”ê²Œ ì•„ë‹Œê°€ â€¦ ?? ë¦¬ë”ê°€ ì„ ì¶œë˜ëŠ” ê³¼ì •ê³¼ ê·¸ ë•Œì˜ ë©”ì‹œì§€ ì²˜ë¦¬ì— ëŒ€í•´ ì¢€ ë” ìì„¸í•˜ê²Œ ê³µë¶€í•´ë³´ìCase ë³„ë¡œ ë°°ìš´ ë¶€ë¶„ì¶”ì¸¡ì´ë‚˜ í™•ì‹¤íˆ ëª¨ë¥´ê² ëŠ”ê±´ ì¶”í›„ ë³´ì™„ ì˜ˆì • !Case1~2 ë¸Œë¡œì»¤ì—ì„œ ack ì‘ë‹µì´ ì˜¤ì§€ ì•ŠëŠ” ìƒí™©ì„ ë¸Œë¡œì»¤ë¥¼ ë‹¤ìš´ì‹œí‚´ìœ¼ë¡œì¨ ì‹œë®¬ë ˆì´ì…˜ í•˜ë ¤ê³  í–ˆìœ¼ë‚˜, ë¸Œë¡œì»¤ê°€ êº¼ì ¸ìˆìœ¼ë©´ í”„ë¡œë“€ì„œì—ì„œ ë¸Œë¡œì»¤ë¡œ ì†¡ì‹  ìì²´ê°€ ë˜ì§€ ì•ŠëŠ”ë‹¤. ackë¥¼ ìœ ì‹¤í•˜ëŠ” ê²½ìš°ë¥¼ ì–´ë–»ê²Œ ì‹œë®¬ë ˆì´ì…˜ í•  ìˆ˜ ìˆì„ê¹Œ ??Case3 ì¬ì‹œë„ ê°€ëŠ¥í•œ ì—ëŸ¬ëŠ” í”„ë¡œë“€ì„œ ë‚´ë¶€ì—ì„œ ìë™ìœ¼ë¡œ ì¬ì „ì†¡í•´ì¤€ë‹¤. (í•´ë‹¹ ì½”ë“œëŠ” ì–´ë””ì— ìˆì„ê¹Œ ?) ì¶”ì¸¡ : ì¬ì „ì†¡ì´ ì—¬ëŸ¬ë²ˆ ë˜ë”ë¼ë„ send ë©”ì„œë“œì— ëŒ€í•œ ì½œë°±ì€ í•œ ë²ˆë§Œ ë°œìƒí•˜ëŠ” ê²ƒ ê°™ë‹¤.ì°¸ê³ ìë£Œ https://kafka.apache.org/documentation/#producerconfigs https://stackoverflow.com/questions/56794122/metadata-requests-in-kafka-producer https://stackoverflow.com/questions/46750420/kafka-producer-error-expiring-10-records-for-topicxxxxxx-6686-ms-has-passed https://bistros.tistory.com/152 ë„¤í•˜ ë‚˜í¬í—¤ë° ì™¸ 2ì¸ ã€ì¹´í”„ì¹´ í•µì‹¬ ê°€ì´ë“œã€, ì œì´í(2018), chapter6" }, { "title": "ì¹´í”„ì¹´ ì „ë‹¬ë³´ì¦ êµ¬í˜„í•˜ê¸° - Exactly Once", "url": "/posts/kafka-delivery-guarantees-exactly-once/", "categories": "", "tags": "", "date": "2021-07-29 14:00:00 +0900", "snippet": "Exactly Once ë©”ì‹œì§€ ìœ ì‹¤ì—†ì´ ì •í™•íˆ í•œ ë²ˆ ì „ë‹¬í•œë‹¤ ?? â€“&gt; ì „ë‹¬ë³´ë‹¤ëŠ” â€˜ë¸Œë¡œì»¤ì—ì„œâ€™ ì •í™•íˆ í•œë²ˆë§Œ â€˜ì²˜ë¦¬ëœë‹¤â€™ë¼ëŠ”ê²Œ ë§ëŠ”ê±°ê°™ë‹¤ -&gt; ê·¼ë° ì»¨ìŠˆë¨¸ì¸¡ì—ì„œ ì²˜ë¦¬í•˜ë‹¤ ì—ëŸ¬ë‚˜ë©´, ì¬ì†¡ì‹ í•˜ëŠ”ê±° ì•„ë‹Œê°€ ? -&gt; ì¦‰, at least onceë‘ ê°™ì€ë° ë©”ì‹œì§€ ì¤‘ë³µì²˜ë¦¬ë§Œ ì•ˆë˜ê²Œí•˜ëŠ”ê±° ì•„ë‹Œê°€ ??v -&gt; ì•„ë‹Œê±° ê°™ë‹¤, ë§Œì•½ ë¸Œë¡œì»¤ì—...", "content": "Exactly Once ë©”ì‹œì§€ ìœ ì‹¤ì—†ì´ ì •í™•íˆ í•œ ë²ˆ ì „ë‹¬í•œë‹¤ ?? â€“&gt; ì „ë‹¬ë³´ë‹¤ëŠ” â€˜ë¸Œë¡œì»¤ì—ì„œâ€™ ì •í™•íˆ í•œë²ˆë§Œ â€˜ì²˜ë¦¬ëœë‹¤â€™ë¼ëŠ”ê²Œ ë§ëŠ”ê±°ê°™ë‹¤ -&gt; ê·¼ë° ì»¨ìŠˆë¨¸ì¸¡ì—ì„œ ì²˜ë¦¬í•˜ë‹¤ ì—ëŸ¬ë‚˜ë©´, ì¬ì†¡ì‹ í•˜ëŠ”ê±° ì•„ë‹Œê°€ ? -&gt; ì¦‰, at least onceë‘ ê°™ì€ë° ë©”ì‹œì§€ ì¤‘ë³µì²˜ë¦¬ë§Œ ì•ˆë˜ê²Œí•˜ëŠ”ê±° ì•„ë‹Œê°€ ??v -&gt; ì•„ë‹Œê±° ê°™ë‹¤, ë§Œì•½ ë¸Œë¡œì»¤ì—ì„œ í”„ë¡œë“€ì„œë¡œë¶€í„° ë°›ì€ ë©”ì‹œì§€ ì €ì¥í–ˆëŠ”ë° ackë¥¼ ë‹¤ì‹œ í”„ë¡œë“€ì„œë¡œ ëª» ë³´ë‚´ì„œí”„ë¡œë“€ì„œì—ì„œ ì¬ì†¡ì‹ ì˜¤ëŠ” ê²½ìš°, transaction id í†µí•´ ë©”ì‹œì§€ ì¤‘ë³µì²˜ë¦¬ ë°©ì§€í•´ì¤„ê±°ê°™ë‹¤.-&gt; ë”°ë¼ì„œ, ì»¨ìŠˆë¨¸ì¸¡ì—ì„œëŠ” ì¤‘ë³µëœ ë©”ì‹œì§€ë¥¼ consume í•˜ëŠ” ì¼ì€ ì—†ëŠ”ê²ƒ ?? ì¹´í”„ì¹´ëŠ” ì´ˆê¸°ì— at-most-onceì™€ at-least-once ìˆ˜ì¤€ì˜ ì „ë‹¬ ë³´ì¦ë§Œ ì§€ì›í–ˆì—ˆë‹¤. í•˜ì§€ë§Œ, ì¹´í”„ì¹´ì˜ ìœ ìš©ì„±ì´ ë†’ì•„ì§€ë©´ì„œ Exactly Once ìˆ˜ì¤€ì˜ ì „ë‹¬ì„ ë³´ì¦í•˜ê³ ì í•˜ëŠ” ìš”êµ¬ê°€ ë†’ì•„ì¡Œë‹¤. ì´ë¥¼ ìœ„í•´ ì¹´í”„ì¹´ì— íŠ¸ëœì­ì…˜ ê°œë…ì´ ë„ì…ë˜ì—ˆë‹¤.exactly-once ì „ë‹¬ ë³´ì¦ì€ 0.11 ë²„ì „ë¶€í„°(Released June 28, 2017, ì°¸ê³  ) idempotentì™€ transactional producers ë‘ ê°€ì§€ ì˜µì…˜ì„ í†µí•´ ì§€ì›í•œë‹¤. ê²°ê³¼ì ìœ¼ë¡œ ë©”ì‹œì§€ëŠ” í•œ ë²ˆë§Œ ì „ë‹¬ë˜ë©° ìœ ì‹¤ë˜ì§€ ì•ŠëŠ”ë‹¤. exactly-once deliveryëŠ” í”„ë¡œë“€ì„œë¶€í„° ì»¨ìŠˆë¨¸ê¹Œì§€ ì—°ê²°ë˜ëŠ” íŒŒì´í”„ë¼ì¸ì˜ ì²˜ë¦¬ë¥¼ ëœ»í•©ë‹ˆë‹¤. ê¸°ì¡´ í”„ë¡œë“€ì„œì˜ ê²½ìš° íŠ¸ëœì­ì…˜ì²˜ë¦¬ë¥¼ í•˜ì§€ ì•Šìœ¼ë©´ ì¹´í”„ì¹´ í´ëŸ¬ìŠ¤í„°ì— ë‘ë²ˆì´ìƒ ë°ì´í„°ê°€ ì €ì¥ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.ë°ì´í„°ê°€ í´ëŸ¬ìŠ¤í„°ì— ì €ì¥ë˜ì—ˆìœ¼ë‚˜ ackê°€ ìœ ì‹¤ë˜ì–´ í”„ë¡œë“€ì„œê°€ ì¬ì²˜ë¦¬í•˜ëŠ” ê²½ìš°ê°€ ëŒ€í‘œì ì…ë‹ˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ ì¹´í”„ì¹´ íŠ¸ëœì­ì…˜ ì²˜ë¦¬ë¥¼ í•˜ë”ë¼ë„ ì»¨ìŠˆë¨¸ê°€ ì¤‘ë³µí•´ì„œ ë°ì´í„° ì²˜ë¦¬í•˜ëŠ” ê²ƒì— ëŒ€í•´ ë³´ì¥í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ,ì»¨ìŠˆë¨¸ì˜ ì¤‘ë³µì²˜ë¦¬ëŠ” ë”°ë¡œ ë¡œì§ì„ ì‘ì„±í•´ì•¼í•©ë‹ˆë‹¤. enable.idempotenceë¥¼ trueë¡œ í•˜ê²Œ ë˜ë©´ ì¹´í”„ì¹´ëŠ” ì¤‘ë³µ ë©”ì‹œì§€ ì œê±° ì•Œê³ ë¦¬ì¦˜ì—ì„œ transactional.idë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œë“€ì„œê°€ ë³´ë‚´ëŠ” ëª¨ë“  ë©”ì‹œì§€ì˜ ë©±ë“±ì„±(idempotence)ì„ ë³´ì¥í•œë‹¤. ê°„ë‹¨íˆ ë§í•´, í”„ë¡œë“€ì„œê°€ ê°™ì€ ë©”ì‹œì§€ë¥¼ ë‘ ë²ˆ ì´ìƒ ì†¡ì‹ í•˜ê²Œ ë˜ë©´, KafkaëŠ” ì´ëŸ¬í•œ ì„¤ì •ì„ í†µí•´ ì•Œì•„ì°¨ë¦´ ìˆ˜ ìˆë‹¤. í”„ë¡œë“€ì„œë§ˆë‹¤ íŠ¸ëœì­ì…˜ IDëŠ” êµ¬ë³„ë˜ì–´ì•¼ í•œë‹¤. at-most-onceì™€ at-least-once ìˆ˜ì¤€ì˜ ì „ë‹¬ ë³´ì¦ì— ë¹„í•´ ì²˜ë¦¬ëŸ‰ì´ ë‚®ê³ (lower throughput) ëŒ€ê¸° ì‹œê°„ì´ ë” ê¸¸ ìˆ˜ ìˆë‹¤(higher latency).êµ¬í˜„í•˜ê¸° To work with the transaction API, weâ€™ll need Kafkaâ€™s Java client&lt;dependency&gt; &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt; &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt;&lt;/dependency&gt;1. í”„ë¡œë“€ì„œ-producerProps.put(\"enable.idempotence\", \"true\");producerProps.put(\"transactional.id\", \"prod-1\");producerProps.put(\"acks\", \"all\"); max.in.flight.requests.per.connection ???enable.idempotenceWhen set to â€˜trueâ€™, the producer will ensure that exactly one copy of each message is written in the stream. If â€˜falseâ€™, producer retries due to broker failures, etc., may write duplicates of the retried message in the stream. Note that enabling idempotence requires max.in.flight.requests.per.connection to be less than or equal to 5, retries to be greater than 0 and acks must be â€˜allâ€™.If these values are not explicitly set by the user, suitable values will be chosen. If incompatible values are set, a ConfigException will be thrown.-&gt; https://docs.confluent.io/platform/current/installation/configuration/producer-configs.html í”„ë¡œë“€ì„œ ì¤€ë¹„ producer.initTransactions(); íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ëŠ” í”„ë¡œë“€ì„œë¡œ ë¸Œë¡œì»¤ì— ë“±ë¡ëœë‹¤. í”„ë¡œë“€ì„œëŠ” transactional.idì™€ ì‹œí€€ìŠ¤ ë²ˆí˜¸ ë˜ëŠ” ì—í¬í¬(epoch)ë¡œ ì‹ë³„ëœë‹¤. ë¸Œë¡œì»¤ëŠ” ì´ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¸ëœì­ì…˜ ë¡œê·¸ì— ëª¨ë“  ì‘ì—…ì„ ë¯¸ë¦¬ ê¸°ë¡í•œë‹¤. ê²°ê³¼ì ìœ¼ë¡œ ë¸Œë¡œì»¤ëŠ” ë™ì¼í•œ íŠ¸ëœì­ì…˜ IDì™€ ì´ì „ ì—í¬í¬ë¥¼ ê°€ì§„ í”„ë¡œë“€ì„œì— ì†í•˜ëŠ” ëª¨ë“  ì‘ì—…ì„ í•´ë‹¹ ë¡œê·¸ì—ì„œ ì œê±°í•˜ê³ , ì´ëŸ¬í•œ ì‘ì—…ì´ ì¡´ì¬í•˜ì§€ ì•ŠëŠ” íŠ¸ëœì­ì…˜ì—ì„œ ë°œìƒí•œ ê²ƒìœ¼ë¡œ ê°€ì •í•œë‹¤. (??) ??? producer.beginTransaction(); ??? ë©”ì‹œì§€ëŠ” íŒŒí‹°ì…”ë‹ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—, íŠ¸ëœì­ì…˜ ë©”ì‹œì§€ê°€ ì—¬ëŸ¬ íŒŒí‹°ì…˜ì— ê±¸ì³ ìˆê³  ê° íŒŒí‹°ì…˜ë§ˆë‹¤ ë³„ë„ì˜ ì»¨ìŠˆë¨¸ê°€ ë©”ì‹œì§€ë¥¼ ì½ëŠ”ë‹¤. ë”°ë¼ì„œ KafkaëŠ” íŠ¸ëœì­ì…˜ì— ëŒ€í•´ ì—…ë°ì´íŠ¸ëœ ëª¨ë“  íŒŒí‹°ì…˜ ëª©ë¡ì„ ì €ì¥í•œë‹¤. íŠ¸ëœì­ì…˜ ë‚´ì—ì„œ í”„ë¡œë“€ì„œëŠ” ë©€í‹° ìŠ¤ë ˆë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ë ˆì½”ë“œë¥¼ ë³‘ë ¬ë¡œ ì „ì†¡í•  ìˆ˜ ìˆë‹¤. 2. ë¸Œë¡œì»¤ min.insync.replicas -&gt; When a producer sets acks to â€œallâ€ (or â€œ-1â€), min.insync.replicas specifies the minimum number of replicas that must acknowledge a write for the write to be considered successful. If this minimum cannot be met, then the producer will raise an exception (either NotEnoughReplicas or NotEnoughReplicasAfterAppend). When used together, min.insync.replicas and acks allow you to enforce greater durability guarantees. A typical scenario would be to create a topic with a replication factor of 3, set min.insync.replicas to 2, and produce with acks of â€œallâ€. This will ensure that the producer raises an exception if a majority of replicas do not receive a write.3. Consumer isolation.levelì„ ì‚¬ìš©í•˜ì—¬ ì—°ê´€ëœ íŠ¸ëœì­ì…˜ì´ ì»¤ë°‹ë  ë•Œê¹Œì§€ íŠ¸ëœì­ì…˜ ë©”ì‹œì§€ë¥¼ ê¸°ë‹¤ë¦´ ìˆ˜ ìˆë‹¤. read_committed : íŠ¸ëœì­ì…˜ì´ ì™„ë£Œë˜ê¸° ì „ê¹Œì§€ íŠ¸ëœì­ì…˜ ë©”ì‹œì§€ë¥¼ ì½ì§€ ì•ŠëŠ”ë‹¤. (default ê°’) read_uncommitted : ì•„ì§ ì»¤ë°‹ë˜ì§€ ì•Šì€ ë©”ì‹œì§€ë¿ ì•„ë‹ˆë¼ íŠ¸ëœì­ì…˜ì´ abortëœ ë©”ì‹œì§€ë„ ì½ëŠ”ë‹¤. (ì¦‰ ëª¨ë“  ë©”ì‹œì§€ë¥¼ ì½ëŠ”ë‹¤) íŠ¸ëœì­ì…˜ê³¼ ë¬´ê´€í•œ ë©”ì‹œì§€ëŠ” isolation.levelê³¼ ìƒê´€ì—†ì´ ëª¨ë“  ê²½ìš°ì— ì½ì„ ìˆ˜ ìˆë‹¤. consumerProps.put(\"enable.auto.commit\", \"false\");consumerProps.put(\"isolation.level\", \"read_committed\"); ë§ˆì§€ë§‰ìœ¼ë¡œ ë°©ê¸ˆ ì†Œë¹„í•œ ì˜¤í”„ì…‹ì„ ì ìš©í•´ì•¼ í•©ë‹ˆë‹¤. íŠ¸ëœì­ì…˜ì„ ì‚¬ìš©í•˜ë©´ ì˜¤í”„ì…‹ì„ ì •ìƒì ìœ¼ë¡œ ì½ì€ ì…ë ¥ í•­ëª©ì— ë‹¤ì‹œ ì ìš©í•©ë‹ˆë‹¤. ë˜í•œ, ìš°ë¦¬ëŠ” ìƒì‚°ìì˜ ê±°ë˜ì— ê·¸ê²ƒë“¤ì„ ë³´ëƒ…ë‹ˆë‹¤.í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤ enable.idempotenceë¥¼ trueë¡œ í•˜ê²Œ ë˜ë©´ ì¹´í”„ì¹´ëŠ” ì¤‘ë³µ ë©”ì‹œì§€ ì œê±° ì•Œê³ ë¦¬ì¦˜ì—ì„œ transactional.idë¥¼ ì‚¬ìš©í•˜ì—¬ í”„ë¡œë“€ì„œê°€ ë³´ë‚´ëŠ” ëª¨ë“  ë©”ì‹œì§€ì˜ ë©±ë“±ì„±(idempotence)ì„ ë³´ì¥í•œë‹¤.-&gt; ì–´ì¼€ í…ŒìŠ¤íŠ¸í•˜ì§€ ??? producer.sendOffsetsToTransaction(offsetsToCommit, CONSUMER_GROUP_ID); ì—†ìœ¼ë©´ ì˜¤í”„ì…‹ ë³€ë™ ì—†ì„ì§€2.í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì •í™•íˆ í•œë²ˆë§Œ ì „ë‹¬ë˜ì–´ì•¼ë¨ ë©”ì‹œì§€ ì¤‘ë³µ ì—†ì–´ì•¼ë¨ì „ì²´ ì½”ë“œ#íŠ¸ëœì­ì…˜ ì²˜ë¦¬ë¥¼ ìœ„í•œ STATE ê°™ì€ê²Œ ìˆë‚˜ ??ì‹¤ì œ ìš´ì˜í™˜ê²½ ? acks=1ì´ë¼ê³  í•´ì„œ ë©”ì‹œì§€ ì†ì‹¤ë¥ ì´ ì „í˜€ ì—†ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤. í•˜ì§€ë§Œ ë°©ê¸ˆ ì„¤ëª…ë“œë¦° í˜„ìƒì´ ë¹ˆë²ˆí•˜ê²Œ ì¼ì–´ë‚˜ëŠ” ì¼ì€ ì•„ë‹ˆê³ , ë©”ì‹œì§€ë¥¼ ë³´ë‚´ëŠ” ì†ë„ ì—­ì‹œ ê³ ë ¤ì‚¬í•­ì¤‘ í•˜ë‚˜ì´ê¸° ë•Œë¬¸ì— ì‹¤ì œ ìš´ì˜í™˜ê²½ì—ì„œëŠ” acks=1ë¡œ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì œê°€ ìš´ì˜í•˜ëŠ” ì¹´í”„ì¹´ì—ì„œë„ í”„ë¡œë“€ì„œ ì˜µì…˜ì€ acks=1ì„ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì´ì–´ì„œ ë§ˆì§€ë§‰ ì˜µì…˜ì— ëŒ€í•´ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ì‹¤ì œ ìš´ì˜í™˜ê²½ì—ì„œ ë¸Œë¡œì»¤ ë…¸ë“œ 2ê°œê°€ ë™ì‹œì— ë‹¤ìš´ë˜ëŠ” ì¼ì€ ê±°ì˜ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ Replication Factorë¥¼ 3ìœ¼ë¡œ ìš´ì˜í•˜ì‹œê³ , ì•ˆì •ì ì¸ êµ¬í˜„ì„ ìœ„í•´ì„œëŠ” min.insync.replicasëŠ” 2ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì´ ê°€ì¥ ë°”ëŒì§í•˜ë‹¤ê³  ìƒê°ë©ë‹ˆë‹¤. ì œê°€ ì„¤ëª…ë“œë¦° ì—¬ëŸ¬ ì˜ˆì œì¤‘ ê°€ì¥ ì•ˆì •ì ì¸ ì˜ˆì œë¡œ acks=all, Replication Factor=3ê³¼ min.insync.replicas=2ë¡œ ì„¤ëª…ë“œë ¸ì§€ë§Œ, ì‹¤ì œ ìš´ì˜í™˜ê²½ì—ì„œ ê°€ì¥ ë§ì´ ì“°ì´ëŠ” ì˜µì…˜ì€ ì•„ë‹™ë‹ˆë‹¤. ìš´ì˜í™˜ê²½ì—ì„œ ê°€ì¥ ë§ì´ ì“°ì´ëŠ” ì˜µì…˜ì€ í”„ë¡œë“€ì„œì˜ acks=allë³´ë‹¤ëŠ” acks=1ë¥¼ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ê³  ìˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ì €ëŠ” ìš´ì˜í•˜ë©´ì„œ ë¸Œë¡œì»¤ì˜ min.insync.replicasì˜µì…˜ì— ëŒ€í•´ í¬ê²Œ ì‹ ê²½ì“°ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì•ìœ¼ë¡œ ì¶”ê°€ë˜ëŠ” ë©”ì‹œì§€ì˜ ì¤‘ìš”ë„ì— ë”°ë¼ í•´ë‹¹ ì˜µì…˜ë“¤ì„ ë³€ê²½í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— í•´ë‹¹ ì˜µì…˜ë“¤ì— ëŒ€í•´ ì™„ë²½í•˜ê²Œ ì´í•´í•˜ì‹œê³  ë³¸ì¸ì˜ ìš´ì˜í™˜ê²½ì„ íŒŒì•…í•œ í›„ ê·¸ì— ì•Œë§ì€ ì„¤ì •ì„ í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì¤‘ìš”í•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤. ìš°ë¦¬íšŒì‚¬ëŠ” ?? ???Invalid transition attempted from state READY to state ABORTING_TRANSACTIONconsumer.commitInSyncë‘ ì°¨ì´ ??TransactionalId prod-0: Invalid transition attempted from state READY to state ABORTING_TRANSACTION ì „ë‹¬ë³´ì¦ì€ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ëŠ” íšŸìˆ˜ì™€ ê´€ë ¨ì´ ìˆëŠ”ê±°ê³ , ë©”ì‹œì§€ ìœ ì‹¤ê³¼ ê´€ë ¨ëœê±´ acksì™€ replication ?? ìƒí˜¸ ë³´ì™„ì ì¸ê²ƒ ?? at least onceë¥¼ êµ¬í˜„í•˜ë ¤ë©´ acksê°€ í•„ìš”í•˜ë‹¤ ?? â˜… í”„ë¡œë“€ì„œì—ì„œì˜ ì „ë‹¬ ë³´ì¦ì€ acksë¥¼ í†µí•´ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤ !-&gt; acksê°€ 0ì´ë©´ at most once-&gt; acksê°€ 1ì´ë©´ at least once-&gt; acksê°€ allì´ë©´ exactly once ?? (allì´ë¼ëŠ”ê±´ min.insync.replicaì— ì •ì˜ëœ ìµœì†Œ ISR ìˆ˜, min.insync.replicas ì˜µì…˜ì€ ë¸Œë¡œì»¤ì˜ ì˜µì…˜ì´ë‹¤ - config/server.properties) -&gt; all ì´ì—¬ë„-&gt; acksê°€ allì´ì–´ë„ at least once ë  ìˆ˜ ìˆì§€ ì•Šë‚˜ ??? ì „ë‹¬ë³´ì¦ì´ë¼ëŠ”ê±´ ë¸Œë¡œì»¤ -&gt; ì»¨ìŠˆë¨¸ë¡œì˜ ì „ë‹¬ì„ ì˜ë¯¸ ??-&gt;ì°¸ê³ ìë£Œ https://www.baeldung.com/kafka-exactly-once https://supergloo.com/kafka/kafka-architecture-delivery/ https://blog.voidmainvoid.net/354 https://dzone.com/articles/kafka-producer-delivery-semantics https://gunju-ko.github.io/kafka/2019/01/07/%EC%B9%B4%ED%94%84%EC%B9%B4%EC%BB%A8%EC%8A%88%EB%A8%B8.html https://www.popit.kr/kafka-%EC%9A%B4%EC%98%81%EC%9E%90%EA%B0%80-%EB%A7%90%ED%95%98%EB%8A%94-producer-acks/" }, { "title": "XSSFë¡œ ì¸í•œ OOM ì—ëŸ¬ ê·¸ë¦¬ê³  SXSSFì™€ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¹„êµí•´ë³´ê¸°", "url": "/posts/xssf-oom-analyze/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "Java, Heap Memory, Eclipse Memory Analyzer, apache poi", "date": "2021-07-23 23:00:00 +0900", "snippet": "ìƒí™© ì´ ê¸€ ì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´, poi ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•´ì„œ ì—‘ì…€ì„ ë§Œë“¤ ë•Œ, XSSF í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ë°ì´í„° ê±´ìˆ˜(ì—‘ì…€ row)ê°€ ë§ì€ ê²½ìš° OOM ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. XSSFë¥¼ ê°œì„ í•œ SXSSFë¥¼ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤ê³  í•˜ëŠ”ë°, ì‹¤ì œë¡œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ë¹„êµí•´ë³´ê³ ì í•œë‹¤. ë©”ëª¨ë¦¬ ë‹¨ë©´ì„ ë¶„ì„í•˜ëŠ” ë°©ë²•ì€ ì´ ê¸€ ì„ ì°¸ê³ ...", "content": "ìƒí™© ì´ ê¸€ ì—ì„œ ì–¸ê¸‰í–ˆë“¯ì´, poi ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ í™œìš©í•´ì„œ ì—‘ì…€ì„ ë§Œë“¤ ë•Œ, XSSF í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ë©´ë°ì´í„° ê±´ìˆ˜(ì—‘ì…€ row)ê°€ ë§ì€ ê²½ìš° OOM ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. XSSFë¥¼ ê°œì„ í•œ SXSSFë¥¼ ì‚¬ìš©í•˜ë©´ í•´ë‹¹ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤ê³  í•˜ëŠ”ë°, ì‹¤ì œë¡œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ë¹„êµí•´ë³´ê³ ì í•œë‹¤. ë©”ëª¨ë¦¬ ë‹¨ë©´ì„ ë¶„ì„í•˜ëŠ” ë°©ë²•ì€ ì´ ê¸€ ì„ ì°¸ê³ í•œë‹¤. ë¶„ì„í•˜ê¸° jps ëª…ë ¹ì–´ë¡œ pidë¥¼ í™•ì¸í•œ ë’¤, jmap dump:&lt;dump-options&gt; &lt;pid&gt;ë¥¼ í™œìš©í•˜ì—¬ ë¤í”„ íŒŒì¼ì„ ìƒì„±í•˜ê³  í•´ë‹¹ íŒŒì¼ì„ MAT(Eclipse Memory Analyzer)ë¡œ ë¶„ì„í•˜ì˜€ë‹¤. í…ŒìŠ¤íŠ¸ í™˜ê²½ CPU : 2.6 GHz 6ì½”ì–´ Intel Core i7 ë©”ëª¨ë¦¬ : 32GB 2667 MHz DDR4 java 8 ë©”ì´ë¸ ë””íœë˜ì‹œ ì„¤ì • &lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;properties&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;/properties&gt; &lt;groupId&gt;org.example&lt;/groupId&gt; &lt;artifactId&gt;performance-test&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.8.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi&lt;/artifactId&gt; &lt;version&gt;4.0.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.poi&lt;/groupId&gt; &lt;artifactId&gt;poi-ooxml&lt;/artifactId&gt; &lt;version&gt;4.0.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-compress&lt;/artifactId&gt; &lt;version&gt;1.19&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt;í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ í´ë˜ìŠ¤import org.apache.poi.ss.usermodel.Cell;import org.apache.poi.ss.usermodel.Row;import org.apache.poi.ss.usermodel.Sheet;import org.apache.poi.ss.usermodel.Workbook;import org.apache.poi.ss.util.CellReference;import java.io.FileOutputStream;public class PoiTester { private final int ROW_CNT = 10000; private final int COL_CNT = 10; private final long THREAD_WAIT_TIME = 60000L; private Workbook workbook; private String fileName; public PoiTester(Workbook workbook, String fileName) { this.workbook = workbook; this.fileName = fileName; } public void test() { long beginTime = System.currentTimeMillis(); Workbook wb = workbook; Sheet sh = wb.createSheet(); for (int rownum = 0; rownum &lt; ROW_CNT; rownum++) { Row row = sh.createRow(rownum); for (int cellnum = 0; cellnum &lt; COL_CNT; cellnum++) { Cell cell = row.createCell(cellnum); String address = new CellReference(cell).formatAsString(); cell.setCellValue(address); } } try { long endTime = System.currentTimeMillis(); long totalTime = ( endTime - beginTime ) / 1000; System.out.println(fileName+\" ê²½ê³¼ ì‹œê°„ : \"+totalTime+\"ì´ˆ\"); Thread.sleep(THREAD_WAIT_TIME); FileOutputStream out = new FileOutputStream(fileName+\".xlsx\"); wb.write(out); out.close(); } catch (Exception e) { e.printStackTrace(); } }}í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤1. XSSFí…ŒìŠ¤íŠ¸ ì½”ë“œimport org.apache.poi.xssf.usermodel.XSSFWorkbook;public class XssfTest { public static void main(String[] args) { XSSFWorkbook workbook = new XSSFWorkbook(); String fileName = \"xssf_ver\"; PoiTester tester = new PoiTester(workbook, fileName); tester.test(); }} ì‹¤í–‰ ê²°ê³¼ : xssf_ver ê²½ê³¼ ì‹œê°„ : 1ì´ˆHistogram íˆìŠ¤í† ê·¸ë¨ì„ ì‚´í´ë³´ë©´ ElementXobj í´ë˜ìŠ¤ XSSFSheet í´ë˜ìŠ¤ì—ì„œ ë©”ëª¨ë¦¬ì˜ ëŒ€ë¶€ë¶„ì„ ì°¨ì§€í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. XSSFSheet í•˜ë‚˜ê°€ ì°¨ì§€í•˜ëŠ” ë©”ëª¨ë¦¬ í¬ëŠ” 80byte ì´ì§€ë§Œ, í•´ë‹¹ ê°ì²´ê°€ ì ìœ í•˜ê³  ìˆëŠ” ê°ì²´ë“¤ì„ ëª¨ë‘ í•©ì¹˜ë©´ ì•½ 70Mb ì •ë„ë¥¼ ì°¨ì§€í•˜ê³  ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë˜í•œ, ì•„ë˜ìª½ì— ë³´ë©´ XSSFRow ì¦‰, í–‰ì´ 10000ê°œ ë§Œë“¤ì–´ì§„ ê²ƒë„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.Dominator Tree Dominator Treeë¥¼ ì‚´í´ë³´ë©´ ElementXobj ê°ì²´ë¡œ ì¸í•´ ëŒ€ë¶€ë¶„ì˜ ë©”ëª¨ë¦¬ê°€ ì ìœ ë˜ê³  ìˆë‹¤. .xlsx íŒŒì¼ì€ XML ê¸°ë°˜ì´ë¼ê³  í•˜ëŠ”ë°, XSSFëŠ” ì´ XMLì„ ì²˜ë¦¬í•˜ëŠ”ë° ë©”ëª¨ë¦¬ë¥¼ ìƒë‹¹íˆ ë§ì´ ì°¨ì§€í•˜ëŠ” ê²ƒ ê°™ë‹¤. .xlsx ì˜ XMLê³¼ ê´€ë ¨ëœ ê¸€ì€ ë„¤ì´ë²„ ê¸°ìˆ ë¸”ë¡œê·¸ì˜ ë‹¤ìŒ ê¸€ ì„ ì°¸ê³ í•´ë³´ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤. í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤2. SXSSF(auto-flush ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)í…ŒìŠ¤íŠ¸ ì½”ë“œimport org.apache.poi.xssf.streaming.SXSSFWorkbook;public class SxssfNoAutoFlush { public static void main(String[] args) { SXSSFWorkbook workbook = new SXSSFWorkbook(-1); // -1 : not use auto-flush String fileName = \"sxssf_no_autoflush_ver\"; PoiTester tester = new PoiTester(workbook, fileName); tester.test(); }} ì‹¤í–‰ ê²°ê³¼ : sxssf_no_autoflush_ver ê²½ê³¼ ì‹œê°„ : 10ì´ˆHistogram íˆìŠ¤í† ê·¸ë¨ì„ ì‚´í´ë³´ë©´ XSSFSheetì— ë¹„í•´ SXSSFSheet ê°ì²´ ìì²´ê°€ ì ìœ í•˜ëŠ” ë©”ëª¨ë¦¬ê°€ ì‘ê³ , ëª¨ë“  ê°ì²´ê°€ ì ìœ í•˜ëŠ” ë©”ëª¨ë¦¬ë¥¼ í•©ì³ë„ 15Mb ì •ë„ë¡œ ì´ì „ 70Mbì— ë¹„í•´ ì•½ 5ë°° ì¤„ì–´ë“  ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ë˜í•œ, ì•„ë˜ìª½ì— ë³´ë©´ SXSSFRow ì¦‰, í–‰ì´ 10000ê°œ ë§Œë“¤ì–´ì§„ ê²ƒë„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. 10000ê°œì˜ í–‰ì´ ëª¨ë‘ ë©”ëª¨ë¦¬ ìƒì— ìˆëŠ” ê²ƒì„ í†µí•´ auto-flushê°€ ì ìš©ë˜ì§€ ì•Šì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. XSSFRowê°€ 10000ê°œ ì˜€ì„ ë•Œ 0.24Mbë¥¼ ì°¨ì§€í–ˆëŠ”ë°, SXSSFRowëŠ” 0.4Mbë¥¼ ì°¨ì§€í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. Dominator Tree XSSFë¥¼ ì‚¬ìš©í•  ë•Œì™€ëŠ” ë‹¤ë¥´ê²Œ ElementXobj ê°ì²´ë¡œ ì¸í•œ ë‚­ë¹„ëŠ” ë³´ì´ì§€ ì•ŠëŠ” ê²ƒ ê°™ë‹¤.í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤3. SXSSF(auto-flush ì‚¬ìš©)í…ŒìŠ¤íŠ¸ ì½”ë“œimport org.apache.poi.xssf.streaming.SXSSFWorkbook;public class SxssfAutoFlush { public static void main(String[] args) { SXSSFWorkbook workbook = new SXSSFWorkbook(1000); // keep 1000 rows in memory, exceeding rows will be flushed to disk String fileName = \"sxssf_autoflush_ver\"; PoiTester tester = new PoiTester(workbook, fileName); tester.test(); }} ì‹¤í–‰ ê²°ê³¼ : sxssf_autoflush_ver ê²½ê³¼ ì‹œê°„ : 2ì´ˆì°¸ê³ . SXSSFWorkbookì˜ ê¸°ë³¸ ìœˆë„ìš° ì‚¬ì´ì¦ˆëŠ” 100ì´ë‹¤.public static final int DEFAULT_WINDOW_SIZE = 100;public SXSSFWorkbook() { this((XSSFWorkbook)null);}public SXSSFWorkbook(XSSFWorkbook workbook) { this(workbook, 100);}Histogram SXSSFSheet ê°ì²´ì™€ ê·¸ ì•ˆì— ëª¨ë“  ê°ì²´ê°€ ì ìœ í•˜ëŠ” ë©”ëª¨ë¦¬ë¥¼ í•©ì³ë„ 1.6Mb ì •ë„ì´ë‹¤. XSSFì— ë¹„í•´ ì•½ 50ë°°, auto-flushë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì„ ë•Œì— ë¹„í•´ ì•½ 10ë°°ì˜ ë©”ëª¨ë¦¬ë¥¼ ëœ ì ìœ í•œë‹¤. ë˜í•œ, ì•„ë˜ìª½ì— ë³´ë©´ SXSSFRow ì¦‰, í–‰ì´ 1000ê°œë§Œ ìˆëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤. ì§€ì •í•œ row access window size(ìœ„ ì½”ë“œì—ì„œëŠ” 1000) ì´ìƒì´ ë©”ëª¨ë¦¬ì— ì ì¬ë˜ë©´ ë””ìŠ¤í¬ë¡œ flushí•˜ëŠ” auto-flush ê¸°ëŠ¥ì´ ì˜ ì‘ë™í•˜ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤. Dominator Tree ë©”ëª¨ë¦¬ ë‚­ë¹„ê°€ ì—†ë‹¤ê³  ë´ë„ ë¬´ë°©í•  ê²ƒ ê°™ë‹¤.íšŒì‚¬ ì½”ë“œì— ì ìš©í•˜ê¸° ì´ì œ íšŒì‚¬ ì½”ë“œì— ì ìš©í•´ë³´ê³  ì–¼ë§Œí¼ì˜ íš¨ê³¼ê°€ ìˆì„ì§€ í™•ì¸í•´ë³´ì. ë°ì´í„° ê±´ìˆ˜ëŠ” ì•½ 5600ê±´ ì´ë‹¤. (ë³´ì•ˆë§ìœ¼ë¡œ ì¸í•´ í…ŒìŠ¤íŠ¸ ê²°ê³¼ëŠ” í•¸ë“œí° ì¹´ë©”ë¼ë¡œ ì°ì—ˆìŠµë‹ˆë‹¤. í™”ì§ˆì´ ì¢‹ì§€ ì•Šìœ¼ì  ì–‘í•´ ë¶€íƒë“œë¦½ë‹ˆë‹¤.)Before (XSSF ì‚¬ìš©) ë©”ëª¨ë¦¬ ì•½ 300Mb ì°¨ì§€ ì—‘ì…€ íŒŒì¼ ìƒì„±ì „ê¹Œì§€ ëª¨ë“  rowë¥¼ ë©”ëª¨ë¦¬ì— ì €ì¥After (SXSSF ì‚¬ìš© - default window size) ë©”ëª¨ë¦¬ ì•½ 8Mb ì°¨ì§€ window size ë§Œí¼(default : 100) ë©”ëª¨ë¦¬ì— ì €ì¥ê²°ë¡  ì¶”ì¸¡ : XSSFëŠ” XML ê¸°ë°˜ì˜ ë¬´ì–¸ê°€ë¥¼ ì²˜ë¦¬í•¨ì— ìˆì–´ì„œ ë©”ëª¨ë¦¬ ë‚­ë¹„ê°€ ì‹¬í•˜ë‹¤. XSSFëŠ” ì—‘ì…€ íŒŒì¼ ìƒì„± ì „ê¹Œì§€ ëª¨ë“  í–‰ì„ ë©”ëª¨ë¦¬ì— ì˜¬ë ¤ë‘ê¸° ë•Œë¬¸ì—, ë°ì´í„°ê°€ ë§ì€ ê²½ìš° OOMì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. poië¥¼ í™œìš©í•´ ì—‘ì…€ì„ ë§Œë“ ë‹¤ë©´ SXSSFë¥¼ auto-flush ê¸°ëŠ¥ì„ í™œì„±í™”í•´ì„œ ì‚¬ìš©í•˜ì.(íŠ¹ë³„í•œ ì´ìœ ê°€ ì—†ë‹¤ë©´ default sizeë¥¼ ì‚¬ìš©í•˜ë©´ ë  ê²ƒ ê°™ë‹¤.)" }, { "title": "Java - ìë°”ë¡œ ì—‘ì…€ì„ ë§Œë“¤ê¸° ìœ„í•œ POI ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚´í´ë³´ê¸°", "url": "/posts/excel-using-poi-library/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-07-22 00:29:00 +0900", "snippet": "íšŒì‚¬ í”„ë¡œì íŠ¸ì—ì„œ ì¡°íšŒí•œ í™”ë©´ì— ëŒ€í•´ ì—‘ì…€ íŒŒì¼ë¡œ ë‹¤ìš´ë°›ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì•¼ í–ˆë‹¤. ë°©ë²•ì„ ì°¾ë‹¤ë³´ë‹ˆ POI ë¼ì´ë¸ŒëŸ¬ë¦¬ë¼ëŠ”ê²Œ ìˆì—ˆê³  ì´ë¥¼ í™œìš©í•´ì„œ êµ¬í˜„í•  ìˆ˜ ìˆì—ˆë‹¤.í•˜ì§€ë§Œ, ë‹¤ë¥¸ íŒŒíŠ¸ì—ì„œ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë‹¤ OOM(Out Of Memory)ì—ëŸ¬ê°€ ë°œìƒí–ˆê³ , êµ¬í˜„ì²´ë¥¼ ì‚´í´ë³´ë‹ˆ XSSFì˜ usermodelì„ ì‚¬ìš©í•˜ê³  ìˆì—ˆë‹¤.í•´ë‹¹ íŒŒíŠ¸ì—ì„œëŠ” ...", "content": "íšŒì‚¬ í”„ë¡œì íŠ¸ì—ì„œ ì¡°íšŒí•œ í™”ë©´ì— ëŒ€í•´ ì—‘ì…€ íŒŒì¼ë¡œ ë‹¤ìš´ë°›ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì•¼ í–ˆë‹¤. ë°©ë²•ì„ ì°¾ë‹¤ë³´ë‹ˆ POI ë¼ì´ë¸ŒëŸ¬ë¦¬ë¼ëŠ”ê²Œ ìˆì—ˆê³  ì´ë¥¼ í™œìš©í•´ì„œ êµ¬í˜„í•  ìˆ˜ ìˆì—ˆë‹¤.í•˜ì§€ë§Œ, ë‹¤ë¥¸ íŒŒíŠ¸ì—ì„œ í•´ë‹¹ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ë‹¤ OOM(Out Of Memory)ì—ëŸ¬ê°€ ë°œìƒí–ˆê³ , êµ¬í˜„ì²´ë¥¼ ì‚´í´ë³´ë‹ˆ XSSFì˜ usermodelì„ ì‚¬ìš©í•˜ê³  ìˆì—ˆë‹¤.í•´ë‹¹ íŒŒíŠ¸ì—ì„œëŠ” ë¬¸ì œ í•´ê²°ì„ ìœ„í•´ ì•Œì•„ë³´ë˜ ì¤‘, SXSSFê°€ ë” íš¨ìœ¨ì ì´ë¼ëŠ” ê²ƒì„ ì°¾ì•„ëƒˆê³  ì´ë¥¼ ì ìš©í•˜ì—¬ OOM ë¬¸ì œë¥¼ í•´ê²°í–ˆë‹¤.(ì´ ê¸€ ì—ì„œë„ ë¹„ìŠ·í•œ ê²½í—˜ì„ ê³µìœ í•´ì£¼ì‹ ë‹¤.)ì•„ì§ ìš°ë¦¬ íŒŒíŠ¸ì—ì„  OOMì´ ë°œìƒí•˜ì§„ ì•Šì•˜ì§€ë§Œ, í˜„ì¬ XSSFë¥¼ ì‚¬ìš©í•˜ê³  ìˆê¸° ë•Œë¬¸ì— OOMì´ ë°œìƒí•  ì ì¬ì  ê°€ëŠ¥ì„±ì„ ê°–ê³ ìˆëŠ” ê²ƒì´ë‹¤.ë”°ë¼ì„œ, SXSSFë¥¼ ì ìš©í•˜ê¸°ì— ì•ì„œ ì–´ë–¤ ì›ë¦¬ë¡œ ì´ëŸ° ì°¨ì´ê°€ ë§Œë“¤ì–´ì§€ëŠ”ê±´ì§€ ì•Œê³  ì‹¶ì—ˆë‹¤.HSSF &amp; XSSF HSSFëŠ” Excel â€˜97(-2007) íŒŒì¼ í˜•ì‹(.xls)ë¥¼ ì§€ì›í•œë‹¤. XSSFëŠ” Excel 2007 OOXML(.xlsx) íŒŒì¼ í˜•ì‹ì„ ì§€ì›í•œë‹¤. HSSF, XSSFëŠ” ë‹¤ìŒê³¼ ê°™ì€ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. low level structures íš¨ìœ¨ì ì¸ ì½ê¸° ì „ìš© ì•¡ì„¸ìŠ¤ë¥¼ ìœ„í•œ ì´ë²¤íŠ¸ ëª¨ë¸(eventmodel) API XLS íŒŒì¼ì„ ë§Œë“¤ê³ , ì½ê³ , ìˆ˜ì •í•˜ê¸° ìœ„í•œ ì „ì²´ ì‚¬ìš©ì ëª¨ë¸(usermodel) API ê¶Œê³ ì‚¬í•­ ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë°ì´í„°ë§Œ ì½ëŠ” ê²½ìš°, íŒŒì¼ í˜•ì‹ì— ë”°ë¼ org.apache.poi.hssf.eventusermodel íŒ¨í‚¤ì§€ ë˜ëŠ” org.apache.poi.xssf.eventusermodel íŒ¨í‚¤ì§€ì˜ eventmodel apië¥¼ ì‚¬ìš© ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë°ì´í„°ë¥¼ ìˆ˜ì •, ìƒì„±í•˜ëŠ” ê²½ìš° usermodel APIë¥¼ ì‚¬ìš© usermodel ì‹œìŠ¤í…œì€ low levelì˜ eventusermodelë³´ë‹¤ memory footprintê°€ ë” ë†’ì§€ë§Œ ì‘ì—…í•˜ê¸°ëŠ” í›¨ì”¬ ê°„ë‹¨í•˜ë‹¤. XSSFê°€ ì§€ì›ë˜ëŠ” Excel 2007(.xlsx) íŒŒì¼ì€ XML ê¸°ë°˜, HSSFê°€ ì§€ì›ë˜ëŠ” Excel â€˜97 íŒŒì¼(.xls)ì€ ë°”ì´ë„ˆë¦¬ ê¸°ë°˜ì´ë‹¤. XMLì„ ì²˜ë¦¬í•˜ëŠ”ë° í•„ìš”í•œ memory footprintê°€ ë” ë†’ë‹¤. â€» memory footprint : í”„ë¡œê·¸ë¨ì´ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ ì‚¬ìš©í•˜ê±°ë‚˜ ì°¸ì¡°í•˜ëŠ” ê¸°ë³¸ ë©”ëª¨ë¦¬ì˜ ì–‘SXSSF Since 3.8-beta3, POI provides a low-memory footprint SXSSF API built on top of XSSF. SXSSFëŠ” ë§¤ìš° í° ìŠ¤í”„ë ˆë“œì‹œíŠ¸ë¥¼ ìƒì„±í•˜ê±°ë‚˜ í™ ê³µê°„ì´ ì œí•œë  ë•Œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” XSSFì˜ API í˜¸í™˜ ìŠ¤íŠ¸ë¦¬ë° í™•ì¥ì´ë‹¤. SXSSFëŠ” sliding window ë‚´ì— ìˆëŠ” í–‰ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ì œí•œí•˜ì—¬ low memory footprintë¥¼ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤. (window : ë©”ëª¨ë¦¬ ë²„í¼ì˜ ì¼ì • ì˜ì—­) ë°˜ë©´, XSSFëŠ” ë¬¸ì„œì˜ ëª¨ë“  í–‰ì— ëŒ€í•œ ì•¡ì„¸ìŠ¤ë¥¼ ì œê³µí•œë‹¤. Sliding Window Memory Buffer Architecture (ì¶œì²˜ : https://www.researchgate.net/figure/Sliding-Window-Memory-Buffer-Architecture_fig1_272854151) ë” ì´ìƒ windowì— ì—†ëŠ” ì´ì „ í–‰ì€ ë””ìŠ¤í¬ì— ê¸°ë¡ë  ë•Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ì—†ê²Œ ëœë‹¤. auto-flush ëª¨ë“œì—ì„œëŠ” access windowì˜ í¬ê¸°ë¥¼ ì§€ì •í•˜ì—¬ ì¼ì •í•œ ìˆ˜ì˜ í–‰ì„ ë©”ëª¨ë¦¬ì— ë³´ê´€í•  ìˆ˜ ìˆë‹¤. ì´ ê°’ì— ë„ë‹¬í–ˆì„ ë•Œ ì¶”ê°€ í–‰ì„ ë§Œë“¤ë©´, ê°€ì¥ ë‚®ì€ ì¸ë±ìŠ¤ë¥¼ ê°€ì§„ í–‰ì´ access windowì—ì„œ ì œê±°ë˜ê³  ë””ìŠ¤í¬ì— ê¸°ë¡ëœë‹¤. public static void main(String[] args) throws Throwable { SXSSFWorkbook wb = new SXSSFWorkbook(100); // keep 100 rows in memory, exceeding rows will be flushed to disk Sheet sh = wb.createSheet(); for(int rownum = 0; rownum &lt; 1000; rownum++){ Row row = sh.createRow(rownum); for(int cellnum = 0; cellnum &lt; 10; cellnum++){ Cell cell = row.createCell(cellnum); String address = new CellReference(cell).formatAsString(); cell.setCellValue(address); } } // Rows with rownum &lt; 900 are flushed and not accessible for(int rownum = 0; rownum &lt; 900; rownum++){ Assert.assertNull(sh.getRow(rownum)); } // ther last 100 rows are still in memory for(int rownum = 900; rownum &lt; 1000; rownum++){ Assert.assertNotNull(sh.getRow(rownum)); } FileOutputStream out = new FileOutputStream(\"/temp/sxssf.xlsx\"); wb.write(out); out.close(); // dispose of temporary files backing this workbook on disk wb.dispose(); } window í¬ê¸°ë¥¼ ë™ì ìœ¼ë¡œ ì¡°ì •í•˜ê³  í•„ìš”ì— ë”°ë¼ í–‰ì„ flushRows(int keepRows)í•˜ëŠ” ëª…ì‹œì  í˜¸ì¶œë¡œ ì£¼ê¸°ì ìœ¼ë¡œ ì˜ë¼ë‚¼ ìˆ˜ ìˆë‹¤. public static void main(String[] args) throws Throwable { SXSSFWorkbook wb = new SXSSFWorkbook(-1); // turn off auto-flushing and accumulate all rows in memory Sheet sh = wb.createSheet(); for(int rownum = 0; rownum &lt; 1000; rownum++){ Row row = sh.createRow(rownum); for(int cellnum = 0; cellnum &lt; 10; cellnum++){ Cell cell = row.createCell(cellnum); String address = new CellReference(cell).formatAsString(); cell.setCellValue(address); } // manually control how rows are flushed to disk if(rownum % 100 == 0) { ((SXSSFSheet)sh).flushRows(100); // retain 100 last rows and flush all others // ((SXSSFSheet)sh).flushRows() is a shortcut for ((SXSSFSheet)sh).flushRows(0), // this method flushes all rows } } FileOutputStream out = new FileOutputStream(\"/temp/sxssf.xlsx\"); wb.write(out); out.close(); // dispose of temporary files backing this workbook on disk wb.dispose();} ìŠ¤íŠ¸ë¦¬ë° íŠ¹ì„±ìœ¼ë¡œ ì¸í•´ XSSFì™€ ë¹„êµí•  ë•Œ ë‹¤ìŒê³¼ ê°™ì€ ì œí•œì´ ìˆë‹¤. í•œ ì‹œì ì—ëŠ” ì œí•œëœ ìˆ˜ì˜ í–‰ë§Œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. Sheet.clone()ì€ ì§€ì›ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. Formula evaluationì´ ì§€ì›ë˜ì§€ ì•ŠëŠ”ë‹¤. Spreadsheet API Feature Summary ì¶œì²˜ : https://poi.apache.org/components/spreadsheet/ì‹¤ì œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¹„êµí•´ë³´ê¸° XSSF vs SXSSF í´ë˜ìŠ¤ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¹„êµí•´ë³´ê¸°ë” ê³µë¶€í•  ë¶€ë¶„ sliding window memory ì•„í‚¤í…ì²˜ì°¸ê³  ìë£Œ https://poi.apache.org/components/spreadsheet/how-to.html#sxssf" }, { "title": "Java - ìë°” ë©”ëª¨ë¦¬ ë‹¨ë©´ ë¶„ì„í•˜ê¸°", "url": "/posts/heap-analyze-with-jmap-and-mat/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-07-20 23:00:00 +0900", "snippet": "ì–¸ì œ ë©”ëª¨ë¦¬ ë‹¨ë©´ì„ ë¶„ì„í•´ì•¼í• ê¹Œ ?ë©”ëª¨ë¦¬ ë‹¨ë©´ì¸ â€˜í™ ë¤í”„(Heap Dump)â€™ëŠ” ìƒì„±í•˜ëŠ”ë° ë¹„ìš©ì´ ë¹„ì‹¸ê¸° ë•Œë¬¸ì—, ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•´ì§€ëŠ” í˜„ìƒì´ ì§€ì†í•´ì„œ ë°œìƒí•˜ê±°ë‚˜ OOM ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ ìƒì„±í•´ì•¼ í•œë‹¤.ì—¬ê¸°ì„œ ë§í•˜ëŠ” ë¹„ìš©ì´ë€ ë‹¤ìŒê³¼ ê°™ë‹¤ ë¤í”„ íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ë™ì•ˆ ì„œë¹„ìŠ¤ê°€ ë¶ˆê°€ëŠ¥í•œ ìƒí™©ì´ ëœë‹¤. ë¤í”„ ìƒì„±ì‹œ ë§ì€ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆë‹¤. í° íŒŒ...", "content": "ì–¸ì œ ë©”ëª¨ë¦¬ ë‹¨ë©´ì„ ë¶„ì„í•´ì•¼í• ê¹Œ ?ë©”ëª¨ë¦¬ ë‹¨ë©´ì¸ â€˜í™ ë¤í”„(Heap Dump)â€™ëŠ” ìƒì„±í•˜ëŠ”ë° ë¹„ìš©ì´ ë¹„ì‹¸ê¸° ë•Œë¬¸ì—, ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•´ì§€ëŠ” í˜„ìƒì´ ì§€ì†í•´ì„œ ë°œìƒí•˜ê±°ë‚˜ OOM ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ ë•Œ ìƒì„±í•´ì•¼ í•œë‹¤.ì—¬ê¸°ì„œ ë§í•˜ëŠ” ë¹„ìš©ì´ë€ ë‹¤ìŒê³¼ ê°™ë‹¤ ë¤í”„ íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ë™ì•ˆ ì„œë¹„ìŠ¤ê°€ ë¶ˆê°€ëŠ¥í•œ ìƒí™©ì´ ëœë‹¤. ë¤í”„ ìƒì„±ì‹œ ë§ì€ ì‹œê°„ì´ ì†Œìš”ë  ìˆ˜ ìˆë‹¤. í° íŒŒì¼(ëŒ€ë¶€ë¶„ ì ìœ í•˜ê³  ìˆëŠ” ë©”ëª¨ë¦¬ í¬ê¸°ë§Œí¼ì˜ íŒŒì¼)ì´ ìƒì„±ëœë‹¤. ëª‡ëª‡ JDK ë²„ì „ì€ jmapê³¼ ê°™ì€ ë„êµ¬ë¥¼ ì‚¬ìš©í•  ê²½ìš°, í•œ ë²ˆë°–ì— ë¤í”„ íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ì—†ë‹¤.OOMì€ ì—ëŸ¬ê°€ ë°œìƒí•˜ë¯€ë¡œ ì¸ì‹í•  ìˆ˜ ìˆê² ì§€ë§Œ, ë©”ëª¨ë¦¬ê°€ ì ì  ë¶€ì¡±í•´ì§€ëŠ” ê²ƒì€ ì–´ë–»ê²Œ íŒŒì•…í•  ìˆ˜ ìˆì„ê¹Œ? jstat ì‚¬ìš© WASì˜ ëª¨ë‹ˆí„°ë§ ì½˜ì†” Java Visual VM, Jconsoleê³¼ ê°™ì€ JMX ê¸°ë°˜ì˜ ëª¨ë‹ˆí„°ë§ ë„êµ¬ APM(Application Performance Management) í™œìš© verbosegc, Xlog ì˜µì…˜ í™œìš©jstat ì˜ˆì‹œ (JDK 11 ì‚¬ìš©) ì‹¤í–‰í•˜ëŠ” ìë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ pidë¥¼ ì•Œê¸° ìœ„í•´ jps ëª…ë ¹ì–´ë¥¼ í™œìš©í•œë‹¤ $ jps18387 Launcher18388 HoldMemory3339618389 Jps jstat -gcutil &lt;pid&gt; &lt;interval&gt;ì„ í™œìš©í•˜ì—¬ ëª¨ë‹ˆí„°ë§ í•  ìˆ˜ ìˆë‹¤. ì•„ë˜ í•­ëª© ì¤‘ 4ë²ˆì§¸ ì»¬ëŸ¼ì¸ O(Old ë˜ëŠ” Tenured ì˜ì—­)ì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ GC ì´í›„ì—ë„ ì¦ê°€í•œë‹¤ë©´ ë©”ëª¨ë¦¬ ë¦­ì´ ë°œìƒí•˜ê³  ìˆë‹¤ê³  íŒë‹¨í•  ìˆ˜ ìˆë‹¤. í•´ë‹¹ ì˜ì—­ì˜ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë™ì‘í•˜ëŠ” ë™ì•ˆì—ëŠ” ê³„ì† ì¦ê°€í•˜ëŠ” ê²ƒì´ ê¸°ë³¸ì´ë‹¤. ë”°ë¼ì„œ, ì¼ë°˜ì ì¸ ìƒí™©ì—ì„œ Old ì˜ì—­ì˜ ë©”ëª¨ë¦¬ê°€ ê³„ì† ì¦ê°€í•œë‹¤ê³  í•´ì„œ ë©”ëª¨ë¦¬ ë¦­ì´ë¼ê³  íŒë‹¨í•´ì„  ì•ˆëœë‹¤. $ jstat -gcutil 18388 2sS0 S1 E O M CCS YGC YGCT FGC FGCT CGC CGCT GCT0.00 100.00 9.09 10.13 95.47 88.35 2 0.032 0 0.000 0 0.000 0.0320.00 100.00 9.09 10.13 95.47 88.35 2 0.032 0 0.000 0 0.000 0.0320.00 100.00 18.18 21.23 95.47 88.35 4 0.062 0 0.000 0 0.000 0.0620.00 100.00 18.18 21.23 95.47 88.35 4 0.062 0 0.000 0 0.000 0.0620.00 100.00 45.45 30.12 95.47 88.35 6 0.093 0 0.000 0 0.000 0.0930.00 100.00 45.45 30.12 95.47 88.35 6 0.093 0 0.000 0 0.000 0.0930.00 100.00 16.67 46.96 95.47 88.35 8 0.129 0 0.000 0 0.000 0.1290.00 100.00 16.67 46.96 95.47 88.35 8 0.129 0 0.000 0 0.000 0.1290.00 100.00 17.24 58.04 95.47 88.35 9 0.162 0 0.000 0 0.000 0.1620.00 100.00 17.24 58.04 95.47 88.35 9 0.162 0 0.000 0 0.000 0.1620.00 100.00 8.70 63.48 95.51 88.35 10 0.199 0 0.000 2 0.001 0.2000.00 100.00 8.70 63.48 95.51 88.35 10 0.199 0 0.000 2 0.001 0.2000.00 100.00 43.24 64.98 95.51 88.35 11 0.215 0 0.000 4 0.002 0.216 ë©”ëª¨ë¦¬ ë‹¨ë©´ ìƒì„±í•˜ê¸° ë©”ëª¨ë¦¬ ë‹¨ë©´ì€ ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ìë°” í”„ë¡œì„¸ìŠ¤ ì‹¤í–‰ ì‹œ ì˜µì…˜ì— í¬í•¨í•˜ì—¬ ìë™ íŒŒì¼ ìƒì„± -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=ê²½ë¡œ OOM ì—ëŸ¬ê°€ ë°œìƒí•˜ì§€ ì•Šì€ ì´ìƒ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ì— ì „í˜€ ì˜í–¥ì„ ë¼ì¹˜ì§€ ì•ŠëŠ”ë‹¤. ì‹¤í–‰ ì˜µì…˜ê³¼ ìƒê´€ì—†ì´ ëª…ë ¹ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ìƒì„± jmap ëª…ë ¹ì–´ ë¦¬ëˆ…ìŠ¤ì˜ gcoreì™€ ê°™ì€ OSì—ì„œ ì œê³µí•˜ëŠ” ì½”ì–´ ë¤í”„ ëª…ë ¹ì–´ (íŒŒì¼ í¬ê¸°ê°€ ìë°” í™ ë¤í”„ì— ë¹„í•´ í›¨ì”¬ í¬ë‹¤) jmap ì‚¬ìš©í•´ì„œ í™ ë¤í”„ ìƒì„±í•˜ê¸° ì˜µì…˜ ë‚´ìš© -dump:[live],format=&lt;format&gt;,file=&lt;filename&gt; í™ ë¤í”„ íŒŒì¼ì„ ìƒì„± -finalizerinfo GCê°€ ë˜ë ¤ê³  ê¸°ë‹¤ë¦¬ê³  ìˆëŠ” ê°ì²´ë“¤ì˜ ì •ë³´ ì¶œë ¥ -clstats í´ë˜ìŠ¤ ë¡œë”ì˜ í†µê³„ ì •ë¥¼ ì œê³µ -histo[:live] í™ ì˜ì—­ì˜ ë©”ëª¨ë¦¬ ì ìœ  ìƒíƒœë¥¼ ê°€ì¥ ë§ì´ ì ìœ í•œ ê°ì²´ë¶€í„° ì¶œë ¥ -F -dumpì™€ -histo ì˜µì…˜ê³¼ ê°™ì´ ì‚¬ìš©ë˜ë©°, ë¤í”„ë¥¼ ê°•ì œë¡œ ë°œìƒì‹œí‚¬ ë•Œ ì‚¬ìš© jmap -dump:&lt;dump-options&gt; &lt;pid&gt; ëª…ë ¹ì–´ ì‚¬ìš©í•˜ì—¬ ì•„ë˜ì™€ ê°™ì´ íŒŒì¼ì„ ìƒì„±í•  ìˆ˜ ìˆë‹¤. $ jmap -dump:format=b,file=dumptest.bin 20195Heap dump file created MAT í™œìš©í•˜ì—¬ ë©”ëª¨ë¦¬ ë‹¨ë©´ ë¶„ì„í•˜ê¸° MATëŠ” Eclipse Memory Analyzerë¡œì„œ í™œë°œí•˜ê²Œ ê°œë°œ ë° ìœ ì§€ë³´ìˆ˜ê°€ ì´ë£¨ì–´ì§€ê³  ìˆë‹¤. MAT ì´ì™¸ì—ë„ ë‹¤ì–‘í•œ ë©”ëª¨ë¦¬ ë¶„ì„ ë„êµ¬ê°€ ìˆë‹¤. ë¨¼ì € MATë¥¼ ë‹¤ìš´ ë°›ëŠ”ë‹¤. ìƒì„±í•œ í™ ë¤í”„ íŒŒì¼ì„ MATì—ì„œ ì—´ê²Œë˜ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‹¤.Leak Suspect Detailsë¥¼ ëˆ„ë¥´ë©´ ì•„ë˜ í•­ëª©ë“¤ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. Description í•´ë‹¹ ê°ì²´ì— ëŒ€í•œ ì„¤ëª… Shortest Paths To the Accumulation Point ë©”ëª¨ë¦¬ë¥¼ ì ìœ í•˜ê³  ìˆëŠ” ê°ì²´ê°€ ê°€ì¥ ìƒë‹¨ì—, ê·¸ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  í˜¸ì¶œí•œ ê°ì²´ê°€ í•˜ë‹¨ì— íŠ¸ë¦¬ í˜•íƒœë¡œ ë‚˜íƒ€ë‚œë‹¤. Accumulated Objects ë©”ëª¨ë¦¬ë¥¼ ì ìœ í•˜ê³  ìˆëŠ” ê°ì²´ê°€ ê°€ì¥ í•˜ë‹¨ì—, ê·¸ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  í˜¸ì¶œí•œ ê°ì²´ê°€ ê°€ì¥ ìƒë‹¨ì— íŠ¸ë¦¬ í˜•íƒœë¡œ ë‚˜íƒ€ë‚œë‹¤. Accumulated Objects by Class í´ë˜ìŠ¤ë³„ë¡œ ê°ì²´ë¥¼ ì ìœ í•˜ëŠ” ëŒ€ìƒ ëª©ë¡ Histogram í´ë˜ìŠ¤ë³„ ê°ì²´ì˜ ê°œìˆ˜ì™€ ê·¸ í¬ê¸°ë¥¼ ê°€ì¥ í° ê°’ë¶€í„° í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì–´ë–¤ í´ë˜ìŠ¤ íƒ€ì…ì´ ê°€ì¥ ë§ì€ ë©”ëª¨ë¦¬ë¥¼ ê°€ì§€ê³  ìˆëŠ”ì§€ ì‰½ê²Œ íŒŒì•…í•  ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ, ë©”ëª¨ë¦¬ë¥¼ ê°€ì¥ ë§ì´ ì‚¬ìš©í•˜ëŠ” ê°ì²´ë¥¼ ì‹ë³„í•˜ê¸°ëŠ” ì‰½ì§€ ì•Šë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ì•„ë˜ í™”ë©´ì—ì„œ byte[]ëŠ” ê°€ì¥ ë§ì€ ì–‘ì˜ ë©”ëª¨ë¦¬ë¥¼ ì°¨ì§€í•˜ê³  ìˆë‹¤. ê·¸ëŸ¬ë‚˜ ì–´ë–¤ ê°ì²´ê°€ ì‹¤ì œë¡œ í•´ë‹¹ ë°”ì´íŠ¸ ë°°ì—´ì„ ë³´ìœ í•˜ê³  ìˆëŠ”ì§€ ì‹ë³„í•  ìˆ˜ ì—†ë‹¤. Shallow Heap/Retained Heap Shallow Heapì€ ê°ì²´ ìì²´ì˜ í¬ê¸°ì´ë‹¤. Retained Heapì€ ê°ì²´ ìì²´ì˜ í¬ê¸° + í•´ë‹¹ ê°ì²´ì—ì„œ ê°–ê³ ìˆëŠ” ê°ì²´ë“¤ì˜ í¬ê¸°ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì•„ë˜ HoldMemory ê°ì²´ ìì²´ëŠ” 16ë°”ì´íŠ¸ì˜ í¬ê¸°ë¥¼ ê°€ì§„ë‹¤. ê·¸ëŸ¬ë‚˜ í•´ë‹¹ ê°ì²´ê°€ ê°–ê³  ìˆëŠ” ëª¨ë“  ê°ì²´ì˜ í¬ê¸°ê°€ 700Mbë¥¼ ì´ˆê³¼í•œë‹¤. ë”°ë¼ì„œ, HoldMemoryì— ì˜í•´ ìœ ì§€ë˜ëŠ” HashMapì´ ë©”ëª¨ë¦¬ ë¬¸ì œì˜ ì›ì¸ì¼ ê²ƒìœ¼ë¡œ ì¶”ë¡ í•  ìˆ˜ ìˆë‹¤. Dominator Tree ê° í´ë˜ìŠ¤ë³„(í´ë˜ìŠ¤ ë¡œë” ë‹¨ìœ„)ë¡œ ì ìœ í•˜ê³  ìˆëŠ” ë©”ëª¨ë¦¬ì˜ ì–‘ì´ ê°€ì¥ ë§ì€ í´ë˜ìŠ¤ë¶€í„° íŠ¸ë¦¬ í˜•íƒœë¡œ ë‚˜íƒ€ë‚¸ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì•„ë˜ í™”ë©´ì—ì„œëŠ” HoldMemory ê°ì²´ê°€ ê°€ì¥ í° ë©”ëª¨ë¦¬ë¥¼ ì°¨ì§€í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. ë˜í•œ, í•´ë‹¹ ê°ì²´ê°€ 700Mb ì´ìƒì˜ ë©”ëª¨ë¦¬ë¥¼ í¬í•¨í•˜ëŠ” í•´ì‹œ ë§µì„ ë³´ìœ í•˜ê³  ìˆìŒì„ ì•Œ ìˆ˜ ìˆë‹¤. Dominator Tree í•˜ë‚˜ì˜ ê°ì²´ê°€ ë§ì€ ì–‘ì˜ ë©”ëª¨ë¦¬ë¥¼ ì°¨ì§€í•  ë•Œ ë¶„ì„í•˜ê¸°ì— ìœ ìš©í•˜ë‹¤. ë§Œì•½ ì—¬ëŸ¬ ê°œì˜ ì‘ì€ ê°ì²´ë¡œ ì¸í•´ ë©”ëª¨ë¦¬ ë¦­ì´ ë°œìƒí•œë‹¤ë©´, íˆìŠ¤í† ê·¸ë¨ì„ ì‚¬ìš©í•˜ì—¬ ë©”ëª¨ë¦¬ë¥¼ ê°€ì¥ ë§ì´ ì¸ìŠ¤í„´ìŠ¤ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.Duplicated Classes ì—¬ëŸ¬ í´ë˜ìŠ¤ ë¡œë”ì—ì„œ ì¤‘ì²©ë˜ê²Œ ë¡œë”©í•œ í´ë˜ìŠ¤ì˜ ëŒ€í•œ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤. í´ë˜ìŠ¤ ë¡œë”ì— ë¬¸ì œê°€ ìˆì„ ê²½ìš° í™•ì¸í•˜ëŠ” ìš©ë„ë¡œ ì£¼ë¡œ ì‚¬ìš©í•œë‹¤.ì‹¤ì œë¡œ ì‚¬ìš©í•´ë³´ê¸° XSSF vs SXSSF í´ë˜ìŠ¤ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë¹„êµí•´ë³´ê¸°ì°¸ê³  ìë£Œ ì´ìƒë¯¼, ã€ìë°” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ã€, ì œì´í(2019), 13~14ì¥. https://www.cleantutorials.com/jconsole/heap-dump-analysis-using-eclipse-memory-analyzer-tool-mat https://eclipsesource.com/blogs/2013/01/21/10-tips-for-using-the-eclipse-memory-analyzer/" }, { "title": "Java - ìë°” í™ ë©”ëª¨ë¦¬ ì‚¬ì´ì¦ˆì™€ OutOfMemoryError", "url": "/posts/heap-size-and-oome/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-07-20 23:00:00 +0900", "snippet": "ì§€ê¸ˆê¹Œì§€ OutOfMemoryError(OOM)ì„ ë§Œë‚˜ê²Œ ë˜ë©´, ì •í™•í•œ ì§„ë‹¨ì—†ì´ ê·¸ëƒ¥ ì„±ëŠ¥ íŒ€ì—ì„œ í•˜ë¼ëŠ” ëŒ€ë¡œ Xms, Xmx ì˜µì…˜ì„ í™œìš©í•´ì„œ í™ í¬ê¸°ë¥¼ ì¡°ì ˆí–ˆë˜ ê²ƒ ê°™ë‹¤.ë‚´ê°€ ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•  ìˆ˜ ìˆê²Œë” ì§€ì‹ì„ ê°–ì¶”ê³  ì—°ìŠµí•´ë³´ì.í™ ë©”ëª¨ë¦¬ ì‚¬ì´ì¦ˆê¸°ë³¸ê°’ ê³µì‹ ë¬¸ì„œ ì— ë³´ë©´ defaultë¡œ ì„¸íŒ…ë˜ëŠ” ì´ˆê¸° í™ì‚¬ì´ì¦ˆì™€ ìµœëŒ€ í™ì‚¬ì´ì¦ˆì— ëŒ€í•´ ë‚˜ì™€ìˆë‹¤. ê²°ë¡ ë¶€...", "content": "ì§€ê¸ˆê¹Œì§€ OutOfMemoryError(OOM)ì„ ë§Œë‚˜ê²Œ ë˜ë©´, ì •í™•í•œ ì§„ë‹¨ì—†ì´ ê·¸ëƒ¥ ì„±ëŠ¥ íŒ€ì—ì„œ í•˜ë¼ëŠ” ëŒ€ë¡œ Xms, Xmx ì˜µì…˜ì„ í™œìš©í•´ì„œ í™ í¬ê¸°ë¥¼ ì¡°ì ˆí–ˆë˜ ê²ƒ ê°™ë‹¤.ë‚´ê°€ ìŠ¤ìŠ¤ë¡œ íŒë‹¨í•  ìˆ˜ ìˆê²Œë” ì§€ì‹ì„ ê°–ì¶”ê³  ì—°ìŠµí•´ë³´ì.í™ ë©”ëª¨ë¦¬ ì‚¬ì´ì¦ˆê¸°ë³¸ê°’ ê³µì‹ ë¬¸ì„œ ì— ë³´ë©´ defaultë¡œ ì„¸íŒ…ë˜ëŠ” ì´ˆê¸° í™ì‚¬ì´ì¦ˆì™€ ìµœëŒ€ í™ì‚¬ì´ì¦ˆì— ëŒ€í•´ ë‚˜ì™€ìˆë‹¤. ê²°ë¡ ë¶€í„° ì–˜ê¸°í•˜ë©´, ì´ˆê¸° í™ì‚¬ì´ì¦ˆëŠ” ë¬¼ë¦¬ ë©”ëª¨ë¦¬ì˜ 1/64, ìµœëŒ€ í™ì‚¬ì´ì¦ˆëŠ” ë¬¼ë¦¬ ë©”ëª¨ë¦¬ì˜ 1/4ì´ë‹¤. ë‚˜ì˜ ê²½ìš° RAMì´ 32G ì´ë¯€ë¡œ, ì´ˆê¸° í™ì‚¬ì´ì¦ˆ, ìµœëŒ€ í™ì‚¬ì´ì¦ˆëŠ” ê°ê° 500MB, 8GB ì •ë„ê°€ ë‚˜ì™€ì•¼í•  ê²ƒì´ë‹¤. ì•„ë˜ì˜ InitialHeapSizeì™€ MaxHeapSizeë¥¼ í™•ì¸í•´ë³´ë©´ ì˜ˆìƒëŒ€ë¡œ ê³„ì‚°ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.$ java -XX:+PrintFlagsFinal -version 2&gt;&amp;1 | grep -i -E 'heapsize|metaspacesize|version' size_t ErgoHeapSizeLimit = 0 {product} {default} size_t HeapSizePerGCThread = 43620760 {product} {default} size_t InitialBootClassLoaderMetaspaceSize = 4194304 {product} {default} size_t InitialHeapSize = 536870912 {product} {ergonomic} size_t LargePageHeapSizeThreshold = 134217728 {product} {default} size_t MaxHeapSize = 8589934592 {product} {ergonomic} size_t MaxMetaspaceSize = 18446744073709535232 {product} {default} size_t MetaspaceSize = 21807104 {pd product} {default} size_t MinHeapSize = 8388608 {product} {ergonomic} uintx NonNMethodCodeHeapSize = 5839372 {pd product} {ergonomic} uintx NonProfiledCodeHeapSize = 122909434 {pd product} {ergonomic} uintx ProfiledCodeHeapSize = 122909434 {pd product} {ergonomic} size_t SoftMaxHeapSize = 8589934592 {manageable} {ergonomic} java version \"15.0.1\" 2020-10-20ë‚´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì ì ˆí•œ í™ ì‚¬ì´ì¦ˆëŠ” ? ë”± ë‚˜ëˆ  ë–¨ì–´ì§€ëŠ” ê³µì‹ ê°™ì€ ê²ƒì€ ì—†ëŠ” ê²ƒ ê°™ë‹¤. ì•„ë˜ ì‚¬í•­ì„ ì°¸ê³ í•˜ì—¬ ì ì ˆí•œ í™ ì‚¬ì´ì¦ˆë¥¼ ì°¾ê¸° ìœ„í•´ ë…¸ë ¥í•´ë³´ì.ì•„ë˜ ë‚´ìš©ë“¤ì€ ê³µì‹ ë¬¸ì„œ ì—ì„œ ë°œì·Œí•˜ì˜€ë‹¤.í•´ë‹¹ ë¬¸ì„œëŠ” WebLogic Serverë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì‘ì„±ë˜ì—ˆë‹¤.í™ ì‚¬ì´ì¦ˆì™€ GC GCì— ëŒ€í•œ í—ˆìš© ì†ë„ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë”°ë¼ ë‹¤ë¥´ë©° GCì˜ ì‹¤ì œ ì‹œê°„ê³¼ ë¹ˆë„ë¥¼ ë¶„ì„í•œ í›„ ì¡°ì •í•´ì•¼ í•œë‹¤. í™ í¬ê¸°ê°€ í´ìˆ˜ë¡ Full GC ì†ë„ê°€ ëŠë ¤ì§€ê³  ë¹ˆë„ëŠ” ì¤„ì–´ë“ ë‹¤. í™ í¬ê¸°ê°€ ì‘ì„ìˆ˜ë¡ Full GCëŠ” ë¹ ë¥´ì§€ë§Œ ìì£¼ ë°œìƒí•œë‹¤. í™ í¬ê¸°ë¥¼ ì¡°ì •í•˜ëŠ” ëª©ì ì€ JVMì´ GC ìˆ˜í–‰í•˜ëŠ” ë° ë“œëŠ” ì‹œê°„ì„ ìµœì†Œí™”í•˜ëŠ” ë™ì‹œì—, í•œ ë²ˆì— ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” í´ë¼ì´ì–¸íŠ¸ ìˆ˜ë¥¼ ìµœëŒ€í™”í•˜ëŠ” ê²ƒì´ë‹¤.verbosegc ì‚¬ìš©í•˜ê¸° HotSpot VMì˜ GC ì˜µì…˜(verbosec)ì„ ì‚¬ìš©í•˜ë©´ GCì— íˆ¬ì…ë˜ëŠ” ì‹œê°„ê³¼ ë¦¬ì†ŒìŠ¤ì˜ ì–‘ì„ ì •í™•í•˜ê²Œ ì¸¡ì •í•  ìˆ˜ ìˆë‹¤. ë¡œê·¸ íŒŒì¼ì„ í†µí•´ ì§„ë‹¨ ê²°ê³¼ë¥¼ í™•ì¸í•œë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ ìµœëŒ€ ë¶€í•˜ì—ì„œ ì„±ëŠ¥ì„ ëª¨ë‹ˆí„°ë§ í•œë‹¤. verbosec ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ JVMì— ëŒ€í•œ ìì„¸í•œ ê°€ë¹„ì§€ ìˆ˜ì§‘ ì¶œë ¥ì„ ì¼œê³  í‘œì¤€ ì˜¤ë¥˜ ë° í‘œì¤€ ì¶œë ¥ì„ ëª¨ë‘ ë¡œê·¸ íŒŒì¼ì„ í†µí•´ ë‹¤ìŒì„ í™•ì¸í•œë‹¤. ì‹¤í–‰ì˜µì…˜ ì˜ˆì‹œ : -XX:+UseSerialGC -Xms1024m -Xmx1024m -verbose:gc ìë°”9 ë¶€í„°ëŠ” -verbose:gc ì˜µì…˜ ëŒ€ì‹  -Xlog:gcë¼ëŠ” ì˜µì…˜ì„ ì‚¬ìš©í•´ì•¼í•œë‹¤. GC ìˆ˜í–‰ ë¹ˆë„ì™€ ìˆ˜í–‰ ì‹œê°„(Full GCëŠ” 3~5ì´ˆ ì´ìƒ ê±¸ë¦¬ì§€ ì•Šì•„ì•¼ í•œë‹¤.) Full GC í›„ ì‚¬ìš© ê°€ëŠ¥í•œ í™ ë©”ëª¨ë¦¬. í™ì˜ 85% ì´ìƒì´ ì‚¬ìš© ê°€ëŠ¥í•œ ìƒíƒœë¼ë©´ ê²½ìš° í™ í¬ê¸°ë¥¼ ë” ì‘ê²Œ ì„¤ì •í•˜ëŠ” ê²ƒì„ ê³ ë ¤í•´ë³¼ ìˆ˜ ìˆë‹¤. í™ í¬ê¸°ê°€ ì‹œìŠ¤í…œì—ì„œ ì‚¬ìš© ê°€ëŠ¥í•œ RAMë³´ë‹¤ í¬ì§€ ì•Šì•„ì•¼ í•œë‹¤. ì‹œìŠ¤í…œì´ í˜ì´ì§€ë¥¼ ë””ìŠ¤í¬ë¡œ â€œswapâ€ í•˜ì§€ ì•Šë„ë¡ ê°€ëŠ¥í•œ í° í™ í¬ê¸°ë¥¼ ì‚¬ìš©í•œë‹¤. ì‹œìŠ¤í…œì˜ ì‚¬ìš© ê°€ëŠ¥í•œ RAM í¬ê¸°ëŠ” í•˜ë“œì›¨ì–´ êµ¬ì„±ê³¼ ì‹œìŠ¤í…œì—ì„œ í”„ë¡œì„¸ìŠ¤ë¥¼ ì‹¤í–‰í•˜ëŠ” ë° í•„ìš”í•œ ë©”ëª¨ë¦¬ ìš”êµ¬ ì‚¬í•­ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤. ì‹œìŠ¤í…œì´ GCì— ë„ˆë¬´ ë§ì€ ì‹œê°„ì„ ì†Œë¹„í•˜ëŠ” ê²½ìš° í™ í¬ê¸°ë¥¼ ì¤„ì¸ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥í•œ RAMì˜ 80%(ìš´ì˜ ì²´ì œë‚˜ ë‹¤ë¥¸ í”„ë¡œì„¸ìŠ¤ì—ì„œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)ë¥¼ JVMì— ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì£¼ì˜ì‚¬í•­ JVMì—ì„œ ì‚¬ìš©í•˜ëŠ” ìµœëŒ€ ë©”ëª¨ë¦¬ ì–‘ì´ ì‚¬ìš© ê°€ëŠ¥í•œ ë¬¼ë¦¬ì  RAM ì–‘ì„ ì´ˆê³¼í•˜ì§€ ì•Šë„ë¡ ì„¤ì •í•´ì•¼ í•œë‹¤. ì´ ê°’ì„ ì´ˆê³¼í•˜ë©´ OSê°€ í˜ì´ì§•ì„ ì‹œì‘í•˜ê³  ì„±ëŠ¥ì´ í¬ê²Œ ì €í•˜ëœë‹¤. í”„ë¡œë•ì…˜ í™˜ê²½ì—ì„œëŠ” ìµœì†Œ í™ í¬ê¸°ì™€ ìµœëŒ€ í™ í¬ê¸°ë¥¼ ë™ì¼í•œ ê°’ìœ¼ë¡œ ì„¤ì •í•œë‹¤. í™ì„ ì§€ì†ì ìœ¼ë¡œ ëŠ˜ë¦¬ê±°ë‚˜ ì¤„ì´ëŠ” ë° ì‚¬ìš©ë˜ëŠ” JVM ë¦¬ì†ŒìŠ¤ë¥¼ ë‚­ë¹„í•˜ì§€ ì•Šë„ë¡ í•˜ê¸° ìœ„í•´ OutOfMemoryErrorì˜ ë‹¤ì–‘í•œ ì›ì¸ ì‚´í´ë³´ê¸° OutOfMemoryErrorê°€ ë°œìƒí•˜ëŠ” ê²½ìš°ëŠ” ëŒ€í‘œì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ë‹¤. ê°€ë¹„ì§€ ì»¬ë ‰í„°ê°€ ìƒˆë¡œìš´ ê°ì²´ë¥¼ ìƒì„±í•  ê³µê°„ì„ ë” ì´ìƒ ë§Œë“¤ì–´ì£¼ì§€ ëª»í•˜ê³ , í™ ì˜ì—­ì˜ ë©”ëª¨ë¦¬ ë˜í•œ ì¦ê°€ë  ìˆ˜ ì—†ì„ ë•Œ ë„¤ì´í‹°ë¸Œ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì½”ë“œì—ì„œ ìŠ¤ì™‘ ì˜ì—­ì´ ë¶€ì¡±í•˜ì—¬, ë” ì´ìƒ ë„¤ì´í‹°ë¸Œ í• ë‹¹ì„ í•  ìˆ˜ ì—†ì„ ë•Œ ë‹¤ì–‘í•œ ì‹œìŠ¤í…œ ë¡œê·¸ë¥¼ í†µí•´ OutOfMemoryErrorê°€ ë°œìƒí•˜ëŠ” ì—¬ëŸ¬ê°€ì§€ ì›ì¸ì— ëŒ€í•´ ì‚´í´ë³´ì1. Java heap space ìë°”ì˜ í™ ì˜ì—­ì—ì„œ ë” ì´ìƒ ê°ì²´ë¥¼ ìƒì„±í•˜ê¸° ì–´ë ¤ìš¸ ë•Œ ë°œìƒí•œë‹¤.ì´ë¥¼ ìœ ë°œí•˜ëŠ” ë‹¤ì–‘í•œ ì¼€ì´ìŠ¤ê°€ ìˆì„ ìˆ˜ ìˆë‹¤. Exception in thread \"main\".: java.lang.OutOfMemoryError: Java heap space ë©”ëª¨ë¦¬ í¬ê¸°ë¥¼ ë„ˆë¬´ ì‘ê²Œ ì¡ê±°ë‚˜, ë©”ëª¨ë¦¬ í¬ê¸°ë¥¼ ì§€ì •í•˜ì§€ ì•Šì€ ê²½ìš° -Xms, -Xmx ì‹¤í–‰ì˜µì…˜ í™•ì¸í•˜ê¸° ì˜¤ë˜ëœ ê°ì²´ë“¤ì´ ê³„ì† ì°¸ì¡°ë˜ê³  ìˆì–´ GCê°€ ë˜ì§€ ì•ŠëŠ” ê²½ìš° staticì„ ì˜ëª» ì‚¬ìš©í•˜ê³  ìˆì§„ ì•Šì€ì§€, ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì˜ë„ì¹˜ ì•Šê²Œ íŠ¹ì • ê°ì²´ë¥¼ ê³„ì† ì°¸ì¡°í•˜ê³  ìˆì§€ëŠ” ì•Šì€ì§€ í™•ì¸í•˜ê¸° finalize ë©”ì„œë“œë¥¼ ê°œë°œìê°€ ê°œë°œí•œ í´ë˜ìŠ¤ì— êµ¬í˜„í•´ ë†“ì€ ê²½ìš° JVMì—ëŠ” GC ëŒ€ìƒ ê°ì²´ë“¤ì„ íì— ìŒ“ê³  ì²˜ë¦¬í•˜ê¸° ìœ„í•œ ë°ëª¬ ìŠ¤ë ˆë“œê°€ ì¡´ì¬í•œë‹¤. ì´ ìŠ¤ë ˆë“œê°€ ê°ì²´ë“¤ì„ ì²˜ë¦¬í•˜ê¸°ë„ ì „ì— finalizeë¡œ ì¸í•´ íì— ë„ˆë¬´ ë§ì€ ê°ì²´ê°€ ë³´ê´€ë˜ì–´ ìˆê³ , ì²˜ë¦¬ê°€ ë¶ˆê°€ëŠ¥í•œ ê²½ìš° ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ìŠ¤ë ˆë“œì˜ ìš°ì„ ìˆœìœ„ë¥¼ ë„ˆë¬´ ë†’ì¼ ê²½ìš° ê°œë°œëœ í”„ë¡œê·¸ë¨ì˜ ìŠ¤ë ˆë“œ ìš°ì„ ìˆœìœ„ë¥¼ ë„ˆë¬´ ë†’ê²Œ ì§€ì •í•´ ë†“ì•„ì„œ, ìŠ¤ë ˆë“œë¥¼ ë©”ëª¨ë¦¬ì— ìƒì„±í•˜ëŠ” ì†ë„ê°€ GCë¥¼ ì²˜ë¦¬í•˜ëŠ” ì†ë„ë³´ë‹¤ ë¹ ë¥´ë©´ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤. í° ë©ì–´ë¦¬ì˜ ê°ì²´ê°€ ì—¬ëŸ¬ ê°œ ìˆì„ ê²½ìš° ì˜ˆë¥¼ ë“¤ì–´, í™ ë©”ëª¨ë¦¬ë¥¼ 256MBë¡œ ì§€ì •í•˜ê³  í•œë²ˆ í˜¸ì¶œë˜ë©´ 100MBì˜ ë©”ëª¨ë¦¬ë¥¼ ì ìœ í•˜ëŠ” í™”ë©´ì„ ì„¸ ë²ˆ í˜¸ì¶œí•˜ëŠ” ê²½ìš° 2. Metaspace (Java 8 ë¶€í„°) Java 8 ë¶€í„°ëŠ” Permanentì´ ì—†ì–´ì§€ê³  Metaspaceê°€ ìƒê²¼ë‹¤. Exception in thread \"main\".: java.lang.OutOfMemoryError: Metaspace Java 8 ì´ì „ì˜ JVMì—ì„œëŠ” Permgen Spaceë¼ëŠ” ë©”ì‹œì§€ê°€ ë‚˜ì™”ì§€ë§Œ, Java 8 ë¶€í„°ëŠ” Metaspace ì—ëŸ¬ê°€ ë°œìƒí•œë‹¤. ë„ˆë¬´ ë§ì€ í´ë˜ìŠ¤ê°€ ìë°” í”„ë¡œì„¸ìŠ¤ì— ë¡œë”©ë  ê²½ìš° ë°œìƒí•  ìˆ˜ ìˆë‹¤. -XX:MaxMetaspaceSize ì˜µì…˜ì„ ì‚¬ìš©í•˜ì—¬ í¬ê¸°ë¥¼ ì¡°ì ˆí•  ìˆ˜ ìˆë‹¤.3. Requested array size exceeds VM limit Exception in thread \"main\".: java.lang.OutOfMemoryError: Requested array size exceeds VM limit ë°°ì—´ì˜ í¬ê¸°ê°€ í™ ì˜ì—­ì˜ í¬ê¸°ë³´ë‹¤ ë” í¬ê²Œ ì§€ì •ë˜ì—ˆì„ ë•Œ ë°œìƒí•œë‹¤. ê³ ì •ëœ í¬ê¸°ê°€ ì•„ë‹Œ ê³„ì‚°ëœ ë³€ìˆ˜ë¡œ ë°°ì—´ í¬ê¸°ë¥¼ ì§€ì •í•  ê²½ìš° ë°œìƒí•  ìˆ˜ ìˆë‹¤.4. request &lt;size&gt; bytes for &lt;reason&gt;. Out of swap space? Exception in thread \"main\".: java.lang.OutOfMemoryError: request &lt;size&gt; bytes for &lt;reason&gt;. Out of swap space? ë„¤ì´í‹°ë¸Œ í™ ì˜ì—­ì´ ë¶€ì¡±í•  ë•Œ, ì¦‰ OSì˜ ë©”ëª¨ë¦¬(Swap ì˜ì—­)ê°€ ë¶€ì¡±í•œ ìƒí™©ì´ ë˜ì—ˆì„ ë•Œ ë°œìƒí•œë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ í˜¸ì¶œí•˜ëŠ” ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œì—ì„œ ë©”ëª¨ë¦¬ë¥¼ ë°˜í™˜í•˜ì§€ ì•ŠëŠ” ê²½ìš° ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë©”ëª¨ë¦¬ë¥¼ ë°˜í™˜í•˜ì§€ ì•ŠëŠ” ê²½ìš° 5. &lt;reason&gt; &lt;stacktrace&gt; (Native method) Exception in thread \"main\".: java.lang.OutOfMemoryError: &lt;reason&gt; &lt;stacktrace&gt; (Native method) 4ë²ˆê³¼ ë§ˆì°¬ê°€ì§€ë¡œ ë„¤ì´í‹°ë¸Œ í™ ì˜ì—­ì— ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•  ë•Œ ë°œìƒë˜ëŠ” ì—ëŸ¬ì´ë‹¤. 4ë²ˆì˜ ê²½ìš°ëŠ” JVM ì½”ë“œì—ì„œ ë°œìƒë  ë•Œ, ì´ ê²½ìš°ëŠ” JNIë‚˜ ë„¤ì´í‹°ë¸Œ ì½”ë“œì—ì„œ ë°œìƒí•œë‹¤ëŠ” ëœ»ì´ë‹¤.ë©”ëª¨ë¦¬ ë¬¸ì œì™€ GC íŠœë‹ ë„ˆë¬´ ì¦ì€ Full GCê°€ ë°œìƒí•˜ë©´ ì„±ëŠ¥ì— ë§ì€ ì˜í–¥ì„ ë¯¸ì¹œë‹¤.ì´ëŸ° ê²½ìš°, ë¬´ì‘ì • GCë¥¼ íŠœë‹í•˜ê¸° ë³´ë‹¤ëŠ” GCê°€ ë§ì´ ë°œìƒí•˜ì§€ ì•Šë„ë¡ í•˜ëŠ” ê²ƒì´ ë¨¼ì €ì´ë‹¤.ë”°ë¼ì„œ, ë‹¤ìŒê³¼ ê°™ì€ ê·œì¹™ì„ ì˜ ë”°ëëŠ”ì§€ ì‚´í´ë´ì•¼í•œë‹¤. ì„ì‹œ ë©”ëª¨ë¦¬ì˜ ì‚¬ìš©ì„ ìµœì†Œí™” ê°ì²´ì˜ ì¬ì‚¬ìš© XML ì²˜ë¦¬ ì‹œ ë©”ëª¨ë¦¬ë¥¼ ë§ì´ ì ìœ í•˜ëŠ” DOM ë³´ë‹¤ SAXë¥¼ ì‚¬ìš© ë„ˆë¬´ ë§ì€ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ë³´ì—¬ì£¼ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì œê±°â€» ìë°” í”„ë¡œì„¸ìŠ¤ id(pid)ë§Œ ì•Œë©´ jstatì„ ì‚¬ìš©í•˜ì—¬(java -gcutil &lt;pid&gt; &lt;interval&gt;) ê° ì˜ì—­ë³„ë¡œ ë©”ëª¨ë¦¬ë¥¼ ì–¼ë§ˆë‚˜ ì‚¬ìš©í•˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.jstatì€ $JAVA_HOME/bin ë””ë ‰í† ë¦¬ì— ì¡´ì¬í•œë‹¤.ë” ê³µë¶€í•  ë¶€ë¶„ finalizeë¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆë˜ëŠ” ì´ìœ  ìŠ¤ë ˆë“œ ìš°ì„ ìˆœìœ„ gc ë¡œê·¸ ë³´ëŠ” ë²• swap ì˜ì—­ ?ì°¸ê³  ìë£Œ ì´ìƒë¯¼, ã€ìë°” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…ã€, ì œì´í(2019), 12ì¥. https://docs.oracle.com/javase/8/docs/technotes/guides/vm/gc-ergonomics.html https://docs.oracle.com/cd/E12839_01/web.1111/e13814/jvm_tuning.htm#PERFM150" }, { "title": "ì¹´í”„ì¹´ì˜ ì „ë°˜ì ì¸ êµ¬ì„±ê³¼ ë™ì‘ ë°©ì‹ ì‚´í´ë³´ê¸°", "url": "/posts/kafka-basic-concept/", "categories": "", "tags": "", "date": "2021-07-15 14:00:00 +0900", "snippet": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´(í•œë¹›ë¯¸ë””ì–´)â€™ 2ì¥ì„ ì½ê³  í•„ìš”í•œ ë¶€ë¶„ì„ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ë¶„ì‚° ë©”ì„¸ì§• ì²˜ë¦¬ë¥¼ ìœ„í•œ ì‹œìŠ¤í…œ êµ¬ì„± ì¶œì²˜ : https://www.gavstech.com/all-about-apache-kafka-an-evolved-log/1. íŒŒí‹°ì…˜ ë¸Œë¡œì»¤ìƒì˜ ë°ì´í„°ë¥¼ ì½ê³  ì“°ëŠ” ê²ƒì€ íŒŒí‹°ì…˜ì´ë¼ëŠ” ë‹¨ìœ„ë¡œ ë¶„í• ë˜ì–´ ìˆë‹¤. íŒŒí‹°...", "content": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´(í•œë¹›ë¯¸ë””ì–´)â€™ 2ì¥ì„ ì½ê³  í•„ìš”í•œ ë¶€ë¶„ì„ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ë¶„ì‚° ë©”ì„¸ì§• ì²˜ë¦¬ë¥¼ ìœ„í•œ ì‹œìŠ¤í…œ êµ¬ì„± ì¶œì²˜ : https://www.gavstech.com/all-about-apache-kafka-an-evolved-log/1. íŒŒí‹°ì…˜ ë¸Œë¡œì»¤ìƒì˜ ë°ì´í„°ë¥¼ ì½ê³  ì“°ëŠ” ê²ƒì€ íŒŒí‹°ì…˜ì´ë¼ëŠ” ë‹¨ìœ„ë¡œ ë¶„í• ë˜ì–´ ìˆë‹¤. íŒŒí‹°ì…˜ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ëŠ” ì´ìœ ëŠ” í† í”½ì— ëŒ€í•œ ëŒ€ëŸ‰ì˜ ë©”ì„¸ì§€ ì…ì¶œë ¥ì„ ì§€ì›í•˜ê¸° ìœ„í•¨ì´ë‹¤. ì¦‰, íŒŒí‹°ì…˜ì€ ë¸Œë¡œì»¤ í´ëŸ¬ìŠ¤í„° ì•ˆì— ë¶„ì‚° ë°°ì¹˜ë˜ì–´ ë©”ì„¸ì§€ ìˆ˜ì‹ /ì „ë‹¬ì„ ë¶„ì‚°í•´ì„œ ìˆ˜í–‰í•¨ìœ¼ë¡œì¨ ì²˜ë¦¬ëŸ‰ì„ ë†’ì¸ë‹¤. 2. ì»¨ìŠˆë¨¸ ê·¸ë£¹ ë‹¨ì¼ í† í”½ì´ë‚˜ ì—¬ëŸ¬ íŒŒí‹°ì…˜ì—ì„œ ë©”ì„¸ì§€ë¥¼ ì·¨ë“í•˜ê¸° ìœ„í•´ â€˜ì»¨ìŠˆë¨¸ ê·¸ë£¹â€™ì´ë¼ëŠ” ê°œë…ì´ ì¡´ì¬í•œë‹¤. ì¹´í”„ì¹´ í´ëŸ¬ìŠ¤í„° ì „ì²´ì—ì„œ ê¸€ë¡œë²Œ IDë¥¼ ì»¨ìŠˆë¨¸ ê·¸ë£¹ ì „ì²´ì—ì„œ ê³µìœ í•œë‹¤. ì—¬ëŸ¬ ì»¨ìŠˆë¨¸ëŠ” ìì‹ ì´ ì†Œì†í•œ ì»¨ìŠˆë¨¸ ê·¸ë£¹ì„ ì‹ë³„í•´, ì½ì–´ë“¤ì¼ íŒŒí‹°ì…˜ì„ ë¶„ë¥˜í•˜ê³  ì¬ì‹œë„ë¥¼ ì œì–´í•œë‹¤.3. ì˜¤í”„ì…‹ íŒŒí‹°ì…˜ ë‚´ì—ì„œ ë©”ì„¸ì§€ì˜ ìœ„ì¹˜(íŒŒí‹°ì…˜ì—ì„œ ìˆ˜ì‹ í•œ ë©”ì„¸ì§€ì—ëŠ” ì¼ë ¨ë²ˆí˜¸ê°€ ë¶€ì—¬ëœë‹¤)ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ë³´ ì˜¤í”„ì…‹ì„ í™œìš©í•´ ì»¨ìŠˆë¨¸ê°€ ì·¨ë“í•˜ëŠ” ë©”ì„¸ì§€ì˜ ë²”ìœ„ ë° ì¬ì‹œë„ë¥¼ ì œì–´í•œë‹¤. ì˜¤í”„ì…‹ì˜ ì¢…ë¥˜ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. Log-End-Offset(LEO) : íŒŒí‹°ì…˜ ë°ì´í„°ì˜ ëì„ ë‚˜íƒ€ë‚¸ë‹¤. ë¸Œë¡œì»¤ì— ì˜í•´ íŒŒí‹°ì…˜ì— ê´€í•œ ì •ë³´ë¡œ ê´€ë¦¬, ì—…ë°ì´íŠ¸ëœë‹¤. Current Offset : ì»¨ìŠˆë¨¸ê°€ ì–´ë””ê¹Œì§€ ë©”ì„¸ì§€ë¥¼ ì½ì—ˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì»¨ìŠˆë¨¸ì—ì„œ ë°ì´í„°ë¥¼ ì·¨ë“í•˜ë©´ ì—…ë°ì´íŠ¸ëœë‹¤. Commit Offset : ì»¨ìŠˆë¨¸ê°€ ì–´ë””ê¹Œì§€ ì»¤ë°‹í–ˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ì»¨ìŠˆë¨¸ ê·¸ë£¹ë§ˆë‹¤ ë³´ê´€, ê´€ë¦¬, ì—…ë°ì´íŠ¸ëœë‹¤. 4. ì£¼í‚¤í¼ Apache ZookeeperëŠ” ë¶„ì‚° ì²˜ë¦¬ë¥¼ ìœ„í•œ ê´€ë¦¬ ë„êµ¬ì´ë‹¤.(coordination service system) ì¹´í”„ì¹´ì˜ ë¶„ì‚° ë©”ì„¸ì§• ì²˜ë¦¬ë¥¼ ìœ„í•œ ë©”íƒ€ ë°ì´í„°(í† í”½, íŒŒí‹°ì…˜ ë“±)ë¥¼ ê´€ë¦¬í•œë‹¤. ì£¼í‚¤í¼ í´ëŸ¬ìŠ¤í„°ì˜ êµ¬ì¡°ìƒ í™€ìˆ˜ë¡œ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ì¼ë°˜ì ì´ë‹¤.ì½”ë””ë„¤ì´ì…˜ ì„œë¹„ìŠ¤ì˜ í•„ìš”ì„± (ì¶œì²˜ : ì¡°ëŒ€í˜‘ë‹˜ ë¸”ë¡œê·¸) ë¶„ì‚° ì‹œìŠ¤í…œì„ ì„¤ê³„ í•˜ë‹¤ë³´ë©´, ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œì— ë¶€ë”ªíŒë‹¤. ë¶„ì‚°ëœ ì‹œìŠ¤í…œê°„ì˜ ì •ë³´ ê³µìœ ë¥¼ ì–´ë–»ê²Œ í•  ê²ƒì¸ì§€ í´ëŸ¬ìŠ¤í„°ì— ìˆëŠ” ì„œë²„ë“¤ì˜ ìƒíƒœ ì²´í¬ë¥¼ ì–´ë–»ê²Œ í•  ê²ƒì¸ì§€ ë¶„ì‚°ëœ ì„œë²„ë“¤ê°„ì— ë™ê¸°í™”ë¥¼ ìœ„í•œ ë½(lock) ì²˜ë¦¬ë¥¼ ì–´ë–»ê²Œ í•  ê²ƒì¸ì§€ ì½”ë””ë„¤ì´ì…˜ ì„œë¹„ìŠ¤ëŠ” ë¶„ì‚° ì‹œìŠ¤í…œ ë‚´ì—ì„œ ì¤‘ìš”í•œ ìƒíƒœ ì •ë³´ë‚˜ ì„¤ì • ì •ë³´ ë“±ì„ ìœ ì§€í•¨ìœ¼ë¡œì¨ ìœ„ì™€ ê°™ì€ ë¬¸ì œë¥¼ í•´ê²°í•´ì¤€ë‹¤. ë”°ë¼ì„œ, ì½”ë””ë„¤ì´ì…˜ ì„œë¹„ìŠ¤ì˜ ì¥ì• ëŠ” ì „ì²´ ì‹œìŠ¤í…œì˜ ì¥ì• ë¥¼ ìœ ë°œí•˜ê¸° ë•Œë¬¸ì—, ì´ì¤‘í™” ë“±ì„ í†µí•˜ì—¬ ê³ ê°€ìš©ì„±ì„ ì œê³µí•´ì•¼ í•œë‹¤. ZooKeeperëŠ” ì´ëŸ¬í•œ íŠ¹ì„±ì„ ì˜ ì œê³µí•˜ê¸° ë•Œë¬¸ì— ìœ ëª…í•œ ë¶„ì‚° ì†”ë£¨ì…˜ì— ë§ì´ ì‚¬ìš©ë˜ê³  ìˆë‹¤. ì½”ë””ë„¤ì´ì…˜ ì„œë¹„ìŠ¤ëŠ” ë°ì´í„° ì•¡ì„¸ìŠ¤ê°€ ë¹¨ë¼ì•¼ í•˜ë©°, ìì²´ì ìœ¼ë¡œ ì¥ì• ì— ëŒ€í•œ ëŒ€ì‘ì„±ì„ ê°€ì ¸ì•¼ í•œë‹¤. ZookeeperëŠ” ìì²´ì ìœ¼ë¡œ í´ëŸ¬ìŠ¤í„°ë§ì„ ì œê³µí•˜ì—¬ ì¥ì• ì—ë„ ë°ì´í„° ìœ ì‹¤ ì—†ì´ fail over/fail backì´ ê°€ëŠ¥í•˜ë‹¤. ë©”ì„¸ì§€ ì†¡ìˆ˜ì‹ ì„ ìœ„í•œ ì‹œìŠ¤í…œ êµ¬ì„±1. ë©”ì„¸ì§€ì™€ í† í”½ ë©”ì„¸ì§€ ì¹´í”„ì¹´ì—ì„œ ë‹¤ë£¨ëŠ” ë°ì´í„°ì˜ ìµœì†Œ ë‹¨ìœ„ Key, Valueë¥¼ ê°–ëŠ”ë‹¤. í† í”½ ë©”ì„¸ì§€ë¥¼ ì¢…ë¥˜ë³„ë¡œ ê´€ë¦¬í•˜ëŠ” ìŠ¤í† ë¦¬ì§€ ë¸Œë¡œì»¤ì— ë°°ì¹˜ë˜ì–´ ê´€ë¦¬ëœë‹¤. 2. ë¸Œë¡œì»¤ ë©”ì„¸ì§€ë¥¼ ìˆ˜ì‹ /ì „ë‹¬í•˜ëŠ” ì—­í• ì„ ë‹´ë‹¹í•œë‹¤. í•˜ë‚˜ì˜ ì„œë²„(ë˜ëŠ” ì¸ìŠ¤í„´ìŠ¤)ë‹¹ í•˜ë‚˜ì˜ ë°ëª¬ í”„ë¡œì„¸ìŠ¤ë¡œ ë™ì‘í•œë‹¤. ì—¬ëŸ¬ ëŒ€ì˜ í´ëŸ¬ìŠ¤í„°ë¡œ êµ¬ì„±í•  ìˆ˜ ìˆìœ¼ë©°, ë¸Œë¡œì»¤ë¥¼ ì¶”ê°€í•¨ìœ¼ë¡œì¨ ì²˜ë¦¬ëŸ‰ í–¥ìƒ(ìŠ¤ì¼€ì¼ ì•„ì›ƒ)ì´ ê°€ëŠ¥í•˜ë‹¤. â€» í´ëŸ¬ìŠ¤í„° : ì—¬ëŸ¬ ëŒ€ì˜ ì»´í“¨í„°ë“¤ì´ ì—°ê²°ë˜ì–´ í•˜ë‚˜ì˜ ì‹œìŠ¤í…œì²˜ëŸ¼ ë™ì‘í•˜ëŠ” ì»´í“¨í„°ë“¤ì˜ ì§‘í•©ë¸Œë¡œì»¤ì˜ ë°ì´í„° ë³´ê´€ ê¸°ê°„ ìŠ¤í† ë¦¬ì§€ ìš©ëŸ‰ ì œí•œì´ ìˆê¸° ë•Œë¬¸ì— ê¸°ê°„ì„ ë¬´ì œí•œìœ¼ë¡œ ë‘˜ ìˆ˜ëŠ” ì—†ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë°ì´í„° ì‚­ì œë¥¼ ìœ„í•´ ë‹¤ìŒ ë‘ ê°€ì§€ ì •ì±…ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤. ì˜¤ë˜ëœ ë©”ì„¸ì§€ ì‚­ì œ ë¸Œë¡œì»¤ íŒŒë¼ë¯¸í„° : cleanup.policy : delete ì§€ì •í•œ ì‹œê°„ë³´ë‹¤ ì˜¤ë˜ëœ ë°ì´í„°ê°€ ì‚­ì œëœë‹¤(default : 1ì£¼) ì¶•ì  ë°ì´í„° í¬ê¸°ê°€ ì§€ì •í•œ ë°ì´í„° í¬ê¸°ë³´ë‹¤ ì»¤ì§„ ê²½ìš°(default : í¬ê¸° ì œí•œ ì—†ìŒ) ì••ì¶• ë¸Œë¡œì»¤ íŒŒë¼ë¯¸í„° : cleanup.policy : compact ìµœì‹  Keyì˜ ë°ì´í„°ë¥¼ ë‚¨ê²¨ë‘ê³  ì¤‘ë³µí•˜ëŠ” Keyì˜ ì˜¤ë˜ëœ ë©”ì„¸ì§€ê°€ ì‚­ì œëœë‹¤. ë™ì¼í•œ Keyì— ëŒ€í•´ì„œëŠ” í•­ìƒ ìµœì‹ ì˜ Valueë§Œ ì–»ì„ ìˆ˜ ìˆìœ¼ë©´ ë˜ëŠ” ìƒí™©ì—ì„œ ì‚¬ìš©í•œë‹¤. 3. í”„ë¡œë“€ì„œ í”„ë¡œë“€ì„œ/ì»¨ìŠˆë¨¸ë¥¼ êµ¬í˜„í•˜ëŠ” ê¸°ëŠ¥ì€ ë¸Œë¡œì»¤ë¡œ ë°ì´í„°ë¥¼ ë³´ë‚´ê³  ë¸Œë¡œì»¤ì—ì„œ ë°ì´í„°ë¥¼ ë°›ê¸° ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì œê³µëœë‹¤. í”„ë¡œë“€ì„œ APIë¥¼ ì´ìš©í•˜ì—¬ ë¸Œë¡œì»¤ì— ë°ì´í„°ë¥¼ ì†¡ì‹ í•˜ê¸° ìœ„í•´ êµ¬í˜„ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‹¤. í”„ë¡œë“€ì„œ APIë¥¼ ë‚´í¬í•œ ë„êµ¬, ë¯¸ë“¤ì›¨ì–´ë¥¼ í†µí•´ ì´ìš©í•˜ëŠ” í˜•íƒœ ë“± ë‹¤ì–‘í•˜ë‹¤.í”„ë¡œë“€ì„œì˜ ë©”ì„¸ì§€ ì†¡ì‹  íŒŒí‹°ì…˜ì— ë©”ì„¸ì§€ë¥¼ ì†¡ì‹ í•  ë•Œ, ë²„í¼ ê¸°ëŠ¥ì²˜ëŸ¼ í”„ë¡œë“€ì„œì˜ ë©”ëª¨ë¦¬ë¥¼ ì´ìš©í•˜ì—¬ ì¼ì •ëŸ‰ ì¶•ì  í›„ ì†¡ì‹ (ë°°ì¹˜ ì²˜ë¦¬)í•  ìˆ˜ ìˆë‹¤. ìˆ˜ ë°”ì´íŠ¸ ~ ìˆ˜ì‹­ ë°”ì´íŠ¸ì˜ ì‘ì€ ë©”ì„¸ì§€ë¥¼ ëŒ€ëŸ‰ìœ¼ë¡œ ë¸Œë¡œì»¤ì— ì†¡ì‹ í•˜ëŠ” ìƒí™©ì„ ê°€ì •í•´ë³´ì. ì´ëŸ° ê²½ìš° í•˜ë‚˜ì˜ ë©”ì„¸ì§€ë‹¹ 1íšŒì”© ì†¡ì‹ ë˜ë©´, ë„¤íŠ¸ì›Œí¬ì˜ ì§€ì—°ìœ¼ë¡œ ì¸í•´ ì²˜ë¦¬ëŸ‰ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆë‹¤. í•˜ì§€ë§Œ, ì²˜ë¦¬ì˜ ì§€ì—°ì‹œê°„ì€ ì¦ê°€ë˜ë¯€ë¡œ ì²˜ë¦¬ëŸ‰ê³¼ ì§€ì—° ì‹œê°„ì˜ íŠ¸ë ˆì´ë“œ ì˜¤í”„ë¥¼ ê³ ë ¤í•œ ì„¤ê³„ê°€ í•„ìš”í•˜ë‹¤. ë°°ì¹˜ ì²˜ë¦¬ì‹œ, ë©”ì„¸ì§€ë¥¼ ì†¡ì‹ í•˜ëŠ” íŠ¸ë¦¬ê±°ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ì§€ì •ëœ í¬ê¸°ì— ë„ë‹¬í•œ ê²½ìš° (ì„¤ì •ê°’ : batch.size) ì§€ì •í•œ ëŒ€ê¸° ì‹œê°„ì— ë„ë‹¬í•œ ê²½ìš° (ì„¤ì •ê°’ : linger.ms) íŒŒí‹°ì…”ë‹ í”„ë¡œë“€ì„œì—ì„œ ì†¡ì‹ í•˜ëŠ” ë©”ì„¸ì§€ë¥¼ ì–´ë–»ê²Œ íŒŒí‹°ì…˜ì„ ë³´ë‚¼ì§€ ê²°ì •í•˜ëŠ” ê²ƒ ë©”ì„¸ì§€ Keyì˜ í•´ì‹œ ê°’ì„ ì‚¬ìš©í•œ ì†¡ì‹  ë©”ì„¸ì§€ì˜ Keyë¥¼ ëª…ì‹œì ìœ¼ë¡œ ì§€ì •í•¨ìœ¼ë¡œì¨ Keyì— ë”°ë¼ ì†¡ì‹ ì²˜ íŒŒí‹°ì…˜ì„ ê²°ì •í•œë‹¤. íŒŒí‹°ì…˜ í´ë˜ìŠ¤ì—ëŠ” partitionIdë¼ëŠ” ë©¤ë²„ ë³€ìˆ˜ê°€ ìˆì–´ IDì— ì˜í•´ ê´€ë¦¬ëœë‹¤. ë¼ìš´ë“œ ë¡œë¹ˆì— ì˜í•œ ì†¡ì‹  ë¼ìš´ë“œ ë¡œë¹ˆ ë°©ì‹ : ìˆœì„œëŒ€ë¡œ í• ë‹¹ ë©”ì„¸ì§€ Keyë¥¼ nullë¡œ ì§€ì •í•œ ê²½ìš°, ì—¬ëŸ¬ íŒŒí‹°ì…˜ìœ¼ë¡œì˜ ë©”ì„¸ì§€ ì†¡ì‹ ì„ ë¼ìš´ë“œ ë¡œë¹ˆ ë°©ì‹ìœ¼ë¡œ ì‹¤í–‰í•œë‹¤. ì¶œì²˜ : ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), p68 íŒŒí‹°ì…”ë‹ì„ ì´ìš©í•˜ëŠ” ê²½ìš°, ë°ì´í„° í¸ì°¨ì— ë”°ë¥¸ íŒŒí‹°ì…˜ì˜ í¸í–¥ì— ì£¼ì˜í•´ì•¼ í•œë‹¤. ê·¹ë‹¨ì ì¸ ê²½ìš°ì—ëŠ” íŒŒí‹°ì…˜ í¸í–¥ìœ¼ë¡œ ì¸í•´ ë¦¬ì†ŒìŠ¤ë¥¼ ë¶€ë¶„ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ëŠ” ìƒíƒœê°€ ëœë‹¤. ì¶œì²˜ : ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), p69ë©”ì„¸ì§€ì˜ ìˆœì„œ ë³´ì¦ ì¹´í”„ì¹´ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ íŒŒí‹°ì…˜ì„ ì—¬ëŸ¬ ê°œë¡œ êµ¬ì„±í•˜ì—¬ í™•ì¥ì„±ì„ ë†’ì¸ë‹¤. ì´ë¡œ ì¸í•´, í”„ë¡œë“€ì„œì—ì„œ ë©”ì„¸ì§€ë¥¼ ì†¡ì‹ í•œ ìˆœì„œëŒ€ë¡œ ì»¨ìŠˆë¨¸ì—ì„œ ë©”ì„¸ì§€ë¥¼ ìˆ˜ì‹ í•œë‹¤ëŠ” ë³´ì¥ì´ ì—†ë‹¤. ë©”ì„¸ì§€ ìˆœì„œ ë³´ì¦ì„ ìœ„í•´ ë‹¨ì¼ íŒŒí‹°ì…˜ìœ¼ë¡œ êµ¬ì„±í•˜ê²Œ ë˜ë©´ ì¹´í”„ì¹´ì˜ ê°•ì ì¸ í™•ì¥ì„±ì„ ìƒê²Œ ëœë‹¤. ë©”ì„¸ì§€ì˜ ì¢…ë¥˜(í† í”½)ë³„ ìˆœì„œë¥¼ ë³´ì¦í•˜ê¸° ìœ„í•´ì„œëŠ” íŒŒí‹°ì…”ë‹ì—ì„œ ì‚´í´ë³¸ â€˜í•´ì‹œì— ì˜í•œ ë¶„í• â€™ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤. ì „ì²´ ë©”ì„¸ì§€ì˜ ìˆœì„œë¥¼ ë³´ì¦í•˜ëŠ” ê²ƒì€ êµ¬í˜„ ë‚œì´ë„ê°€ ë†’ë‹¤. ë˜í•œ, ì»¨ìŠˆë¨¸ êµ¬í˜„ì´ í”„ë¡œë“€ì„œ ë°ì´í„° ì „ì†¡ ìˆœì„œì— ì˜ì¡´í•˜ê²Œ ë˜ë©´ ì¹´í”„ì¹´ ì „í›„ì˜ ì‹œìŠ¤í…œì ì¸ ë¶„ë¦¬ì— ì œí•œì„ ì¤„ ìˆ˜ ìˆë‹¤. ë©”ì„¸ì§€ ìˆœì„œ ë³´ì¦ì„ ìœ„í•œ ì •ë ¬ ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì•¼ í•œë‹¤ë©´, ì–´ë””ì—ì„œ(ë¸Œë¡œì»¤ or ì»¨ìŠˆë¨¸) êµ¬í˜„í• ì§€ëŠ” ì‹œìŠ¤í…œ ì „ì²´ë¥¼ ê³ ë ¤í•˜ì—¬ íŒë‹¨í•´ì•¼ í•œë‹¤.4. ì»¨ìŠˆë¨¸ ì»¨ìŠˆë¨¸ APIë¥¼ ì´ìš©í•´ ë¸Œë¡œì»¤ì—ì„œ ë©”ì„¸ì§€ë¥¼ ì·¨ë“í•˜ë„ë¡ êµ¬í˜„ëœ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ë‹¤.PULL í˜• ë¸Œë¡œì»¤ì— ìˆëŠ” ë©”ì„¸ì§€ë¥¼ ì»¨ìŠˆë¨¸ê°€ ì·¨ë“í•´ê°€ëŠ” ë°©ì‹(PULL í˜•)ì˜ ì´ì ì„ ì‚´í´ë³´ì. ì»¨ìŠˆë¨¸ ì‹œìŠ¤í…œì´ ë‹¤ìš´ë˜ê±°ë‚˜ ì¼ì‹œì ìœ¼ë¡œ ì´ìƒì´ ìˆì–´ë„ ë¸Œë¡œì»¤ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì´ ì ë‹¤. ë§Œì•½ ë¸Œë¡œì»¤ì—ì„œ ì»¨ìŠˆë¨¸ë¡œ PUSH í•´ì£¼ëŠ” ë°©ì‹ì´ë¼ë©´, ì»¨ìŠˆë¨¸ì˜ ì¥ì• ë¥¼ ë§¤ë²ˆ ë¸Œë¡œì»¤ì—ì„œ ëŒ€ì‘í•´ì¤˜ì•¼ í•œë‹¤. ì¹´í”„ì¹´ë¥¼ ê²½ìœ í•˜ëŠ” ë©”ì„¸ì§€ì™€ í›„ì† ì‹œìŠ¤í…œì´ ë§ì„ìˆ˜ë¡ ì‹œìŠ¤í…œ ìš´ìš© ë¶€í•˜, ì„±ëŠ¥ ë¶€í•˜ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆë‹¤. ì»¨ìŠˆë¨¸ê°€ ì£¼ì²´ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ìˆ˜ì‹ , ì§„í–‰ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì—, í›„ì† ì‹œìŠ¤í…œì˜ í™•ì¥ê³¼ ì¶•ì†Œê°€ ì‰½ë‹¤.ì»¨ìŠˆë¨¸ì˜ ë©”ì„¸ì§€ ì·¨ë“ ë©”ì„¸ì§€ ì·¨ë“ì€ ë¸Œë¡œì»¤ì˜ ë””ìŠ¤í¬ì— ë³´ê´€ë˜ì–´ ìˆëŠ” ë™ì•ˆ ê°€ëŠ¥í•˜ë‹¤. ì»¨ìŠˆë¨¸ëŠ” ì·¨ë“ ëŒ€ìƒì˜ í† í”½ê³¼ íŒŒí‹°ì…˜ì— ëŒ€í•´ Current Offset ~ LEOê¹Œì§€ ì·¨ë“ì„ ìš”ì²­í•œë‹¤. ì´ê²ƒì„ ë°˜ë³µí•¨ìœ¼ë¡œì¨ ê²Œì†ì ì¸ ë©”ì„¸ì§€ ì·¨ë“ì„ í•  ìˆ˜ ìˆë‹¤. ë©”ì„¸ì§€ì˜ ìœ ì… ë¹ˆë„ê°€ ë™ì¼í•œ ê²½ìš°, ìš”ì²­ ê°„ê²©ì´ ê¸¸ìˆ˜ë¡ ëª¨ì¸ ë©”ì„¸ì§€ê°€ ë§ì•„ì§„ë‹¤. ì¼ì • ê°„ê²©ì„ ë‘ê³  ìš”ì²­í•¨ìœ¼ë¡œì¨ ì²˜ë¦¬ëŸ‰ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤. í”„ë¡œë“€ì„œì˜ ë°°ì¹˜ ì²˜ë¦¬ì™€ ë§ˆì°¬ê°€ì§€ë¡œ, ì²˜ë¦¬ëŸ‰ê³¼ ì§€ì—° ì‹œê°„ì˜ íŠ¸ë ˆì´ë“œ ì˜¤í”„ë¥¼ ê³ ë ¤í•œ ì„¤ê³„ê°€ í•„ìš”í•˜ë‹¤. ì»¨ìŠˆë¨¸ì˜ ë¡¤ë°± Offset Commitì„ í†µí•´ ì»¨ìŠˆë¨¸ ì²˜ë¦¬ ì‹¤íŒ¨, ê³ ì¥ ì‹œ ë¡¤ë°± ë©”ì„¸ì§€ ì¬ì·¨ë“ì„ í•  ìˆ˜ ìˆë‹¤. ì»¨ìŠˆë¨¸ì— ì˜í•œ ë°ì´í„° ì·¨ë“ì´ 2íšŒ ë°œìƒí•˜ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ì‚´í´ë³´ì. ì¶œì²˜ : ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), p64~65 ìœ„ ì‹œë‚˜ë¦¬ì˜¤ì˜ 4ë²ˆì—ì„œ Current Offsetì´ Commit Offsetê¹Œì§€ ë˜ëŒì•„ì˜¨ ë§Œí¼ì˜ ë©”ì„¸ì§€(6,7,8)ì— ëŒ€í•œ ëŒ€ì²˜ëŠ” ì»¨ìŠˆë¨¸ ì¸¡ì—ê²Œ ë§¡ê¸´ë‹¤. ì¦‰, ì¬ì†¡ì‹ ëœ(At Least Once) ë©”ì„¸ì§€ 6,7,8ì— ëŒ€í•´ ì–´ë–»ê²Œ ë©”ì„¸ì§€ ì¤‘ë³µ ì²˜ë¦¬ë¥¼ í•  ê²ƒì¸ì§€ì— ëŒ€í•œ ë°©ì•ˆì´ í•„ìš”í•˜ë‹¤. ë°ì´í„°ì˜ ê²¬ê³ ì„±ì„ ë†’ì´ëŠ” ë³µì œ êµ¬ì¡° ì¹´í”„ì¹´ëŠ” ì¥ì• ì‹œì—ë„ ìˆ˜ì‹ í•œ ë©”ì„¸ì§€ë¥¼ ìƒì§€ ì•Šê¸° ìœ„í•´ ë³µì œ(Replication) êµ¬ì¡°ë¥¼ ê°–ì¶”ê³  ìˆë‹¤. íŒŒí‹°ì…˜ì€ ë‹¨ì¼ ë˜ëŠ” ì—¬ëŸ¬ ê°œì˜ ë ˆí”Œë¦¬ì¹´ë¡œ êµ¬ì„±ë˜ì–´ í† í”½ ë‹¨ìœ„ë¡œ ë ˆí”Œë¦¬ì¹´ ìˆ˜ë¥¼ ì§€ì •í•  ìˆ˜ ìˆë‹¤. ë ˆí”Œë¦¬ì¹´ ì¤‘ í•˜ë‚˜ëŠ” Leader ë‚˜ë¨¸ì§€ëŠ” Followerë¼ê³  ë¶ˆë¦°ë‹¤. FollowerëŠ” Leaderë¡œë¶€í„° ë©”ì„¸ì§€ë¥¼ ì·¨ë“í•˜ì—¬ ë³µì œë¥¼ ìœ ì§€í•œë‹¤. í”„ë¡œë“€ì„œ/ì»¨ìŠˆë¨¸ê°„ ë°ì´í„° êµí™˜ì€ Leaderê°€ ë§¡ê²Œëœë‹¤. ì¶œì²˜ : ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), p.72In-Sync Replica Leader ë ˆí”Œë¦¬ì¹´ì˜ ë³µì œ ìƒíƒœë¥¼ ìœ ì§€í•˜ê³  ìˆëŠ” ë ˆí”Œë¦¬ì¹´ëŠ” In-Sync Replica(ISR)ë¡œ ë¶„ë¥˜ëœë‹¤. íŒŒë¼ë¯¸í„° replica.lag.time.max.msì—ì„œ ì •í•œ ì‹œê°„ë³´ë‹¤ë„ ì˜¤ë«ë™ì•ˆ ë³µì œì˜ ìš”ì²­ ë° ë³µì œê°€ ì´ë£¨ì–´ì§€ì§€ ì•Šì„ ê²½ìš° Leader ë ˆí”Œë¦¬ì¹´ ë³µì œ ìƒíƒœë¥¼ ìœ ì§€í•˜ì§€ ì•ŠëŠ” ë ˆí”Œë¦¬ì¹´ë¡œ ê°„ì£¼í•œë‹¤. ëª¨ë“  ë ˆí”Œë¦¬ì¹´ê°€ ISRë¡œ ë˜ì–´ ìˆì§€ ì•Šì€ íŒŒí‹°ì…˜ì„ Under Replicated Partitionsë¼ê³  í•œë‹¤. ë³µì œ ìˆ˜ì™€ëŠ” ë³„ê°œë¡œ ìµœì†Œ ISR ìˆ˜(min.insync.replica) ì„¤ì •ì´ ê°€ëŠ¥í•˜ë‹¤. ì¶œì²˜ : https://www.javatpoint.com/kafka-topic-replicationHigh Watermark ë³µì œê°€ ì™„ë£Œëœ ìµœì‹  ì˜¤í”„ì…‹ ì»¨ìŠˆë¨¸ëŠ” High Watermarkê¹Œì§€ ê¸°ë¡ëœ ë©”ì„¸ì§€ë¥¼ ì·¨ë“í•  ìˆ˜ ìˆë‹¤. ì¶œì²˜ : ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), p.73Ack ì„¤ì • ë¸Œë¡œì»¤ â†’ í”„ë¡œë“€ì„œë¡œ Ackë¥¼ ì–´ëŠ íƒ€ì´ë°ì— ì†¡ì‹ í•  ê²ƒì¸ì§€ë¥¼ ì„¤ì •í•˜ëŠ” ê²ƒì€ ì„±ëŠ¥ê³¼ (ë¸Œë¡œì»¤ ì„œë²„ ì¥ì• ì‹œ) ë°ì´í„° ìœ ì‹¤ ë°©ì§€ì— í° ì˜í–¥ì„ ì¤€ë‹¤. Ack ì„¤ì • ì„¤ëª… 0 í”„ë¡œë“€ì„œëŠ” Ackë¥¼ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ë‹¤ìŒ ë©”ì„¸ì§€ë¥¼ ì†¡ì‹ í•œë‹¤. 1 Leader Replicaì— ë©”ì„¸ì§€ê°€ ì „ë‹¬ë˜ë©´ Ackë¥¼ ë°˜í™˜í•œë‹¤. all ëª¨ë“  ISRì˜ ìˆ˜ë§Œí¼ ë³µì œë˜ë©´ Ackë¥¼ ë°˜í™˜í•œë‹¤. í”„ë¡œë“€ì„œëŠ” Ackê°€ ëŒì•„ì˜¤ì§€ ì•Šê³  íƒ€ì„ì•„ì›ƒëœ ë©”ì„¸ì§€ì— ëŒ€í•´ ì†¡ì‹  ì‹¤íŒ¨ë¡œ ê°„ì£¼í•œë‹¤. Ackë¥¼ ë°˜í™˜í•˜ëŠ” íƒ€ì´ë°ì—ëŠ” ë©”ì„¸ì§€ê°€ ë””ìŠ¤í¬ê°€ ì•„ë‹Œ ë©”ëª¨ë¦¬(OS ë²„í¼)ì— ê¸°ë¡ë˜ì–´ìˆëŠ” ìƒíƒœì´ë‹¤.ISRê³¼ Ackë¥¼ í†µí•œ ë©”ì„¸ì§€ ì²˜ë¦¬ ì œì–´ ISRê³¼ Ack ì„¤ì •ì— ë”°ë¼ ë©”ì„¸ì§€ ì“°ê¸°ë¥¼ ì œì–´í•  ìˆ˜ ìˆë‹¤. ìƒí™©ì€ ë¸Œë¡œì»¤ 4ëŒ€, ë ˆí”Œë¦¬ì¹´ ìˆ˜ëŠ” 3ìœ¼ë¡œ ë¸Œë¡œì»¤ 1ëŒ€ê°€ ê³ ì¥ë‚˜ ë ˆí”Œë¦¬ì¹´ë¥¼ í•˜ë‚˜ ìƒì–´ë²„ë¦° ê²½ìš°ë¼ê³  ê°€ì •í•œë‹¤.1. min.insync.replicas=3 (ë ˆí”Œë¦¬ì¹´ ìˆ˜ì™€ ë™ì¼), Ack=all ë¹„ì •ìƒ ìƒíƒœë¡œ ê°„ì£¼ë˜ì–´ ìƒì–´ë²„ë¦° ë ˆí”Œë¦¬ì¹´ê°€ ISRë¡œ ë³µê·€í•  ë•Œê¹Œì§€ ë©”ì„¸ì§€ë¥¼ ì²˜ë¦¬í•˜ì§€ ì•ŠëŠ”ë‹¤. ì¶œì²˜ : ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), p.752. min.insync.replicas=2, Ack=all ë¸Œë¡œì»¤ 1ëŒ€ê°€ ê³ ì¥ë‚˜ë”ë¼ë„ ìµœì†Œ ISR ìˆ˜ë¥¼ ë§Œì¡±í•˜ë¯€ë¡œ Ackë¥¼ ë°˜í™˜í•˜ê³  ì²˜ë¦¬ë¥¼ ê³„ì†í•œë‹¤. ì²˜ë¦¬ë¥¼ ê³„ì†í•  ìˆ˜ëŠ” ìˆì§€ë§Œ, ë³µêµ¬ ì „ì— ë¸Œë¡œì»¤ê°€ ë” ê³ ì¥ë‚˜ê²Œ ë˜ë©´ ì²˜ë¦¬ ì¤‘ì¸ ë©”ì„¸ì§€ë¥¼ ì†ì‹¤í•  ìœ„í—˜ì´ ë†’ì•„ì§„ë‹¤. ì¶œì²˜ : ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), p.75 ì‹œìŠ¤í…œ ìš”êµ¬ ì‚¬í•­ê³¼ ì œì•½ ì¡°ê±´ì— ë”°ë¼, â€˜ë©”ì„¸ì§€ë¥¼ ìƒì§€ ì•ŠëŠ” ê²ƒâ€™ê³¼ â€˜ì‹œìŠ¤í…œì˜ ì²˜ë¦¬ê°€ ê³„ì† ë˜ëŠ” ê²ƒâ€™ ì‚¬ì´ì˜ ê· í˜•ì„ min.insync.replicasì™€ Ack ì„¤ì •ì„ í†µí•´ ì¡°ì ˆí•´ì•¼ í•œë‹¤.ì°¸ê³ ìë£Œ ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), 2ì¥" }, { "title": "ì¹´í”„ì¹´ ê°œìš”", "url": "/posts/kafka-introduction/", "categories": "", "tags": "", "date": "2021-07-14 22:25:00 +0900", "snippet": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´(í•œë¹›ë¯¸ë””ì–´)â€™ 1ì¥ì„ ì½ê³  í•„ìš”í•œ ë¶€ë¶„ì„ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.Apache Kafkaë€? ì¹´í”„ì¹´ëŠ” ë¶„ì‚° ë©”ì„¸ì§• ì‹œìŠ¤í…œì´ë‹¤ ë¶„ì‚° ë¶„ì‚° ì‹œìŠ¤í…œ(distributed system, ë˜ëŠ” ë¶„ì‚° ì»´í“¨íŒ…) ì„œë¡œ ë‹¤ë¥¸ ì‹œìŠ¤í…œì— ìœ„ì¹˜í•œ êµ¬ì„± ìš”ì†Œë“¤ê°„ì— í†µì‹ í•˜ê³  í˜‘ë ¥í•˜ì—¬ êµ¬ì„±ë˜ëŠ” ì‹œìŠ¤í…œ ...", "content": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´(í•œë¹›ë¯¸ë””ì–´)â€™ 1ì¥ì„ ì½ê³  í•„ìš”í•œ ë¶€ë¶„ì„ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.Apache Kafkaë€? ì¹´í”„ì¹´ëŠ” ë¶„ì‚° ë©”ì„¸ì§• ì‹œìŠ¤í…œì´ë‹¤ ë¶„ì‚° ë¶„ì‚° ì‹œìŠ¤í…œ(distributed system, ë˜ëŠ” ë¶„ì‚° ì»´í“¨íŒ…) ì„œë¡œ ë‹¤ë¥¸ ì‹œìŠ¤í…œì— ìœ„ì¹˜í•œ êµ¬ì„± ìš”ì†Œë“¤ê°„ì— í†µì‹ í•˜ê³  í˜‘ë ¥í•˜ì—¬ êµ¬ì„±ë˜ëŠ” ì‹œìŠ¤í…œ êµ¬ì„± ìš”ì†ŒëŠ” ì»´í“¨í„°, ë¬¼ë¦¬ì  ì„œë²„, ê°€ìƒ ì‹œìŠ¤í…œ, ì»¨í…Œì´ë„ˆ ë“±ì´ ë  ìˆ˜ ìˆë‹¤. ì‚¬ìš©ìì—ê²ŒëŠ” í•˜ë‚˜ì˜ ì‹œìŠ¤í…œì²˜ëŸ¼ ë³´ì¸ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë¶„ì‚° ì‹œìŠ¤í…œì€ í™•ì¥ì„±, ì•ˆì •ì„±, ì„±ëŠ¥ ë©´ì—ì„œ ì´ì ì„ ì§€ë‹ ìˆ˜ ìˆë‹¤. ë©”ì„¸ì§• ì‹œìŠ¤í…œ ë©”ì„¸ì§€ë¥¼ ë°›ê³  ë°›ì€ ë©”ì„¸ì§€ë¥¼ ë‹¤ë¥¸ ì‹œìŠ¤í…œì´ë‚˜ ì¥ì¹˜ì— ë³´ë‚¸ë‹¤ ë¶„ì‚° ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë° í”Œë«í¼ì´ë¼ê³ ë„ ë¶ˆë¦°ë‹¤ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë°ì´ë€ ? ë°ì´í„°ë² ì´ìŠ¤, ì„¼ì„œ, ëª¨ë°”ì¼ ì¥ì¹˜, í´ë¼ìš°ë“œ ì„œë¹„ìŠ¤ ë° ì†Œí”„íŠ¸ì›¨ì–´ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ ê°™ì€ ì´ë²¤íŠ¸ ì†ŒìŠ¤ë¡œë¶€í„° ìŠ¤íŠ¸ë¦¼ì˜ í˜•íƒœë¡œ ì´ë²¤íŠ¸(ë°ì´í„°)ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ìº¡ì²˜í•˜ëŠ” ì‘ì—…ì´ë‹¤. ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¬ë° í”Œë«í¼ì€ ì´ëŸ¬í•œ ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ì„ ë‚˜ì¤‘ì— ê²€ìƒ‰í•  ìˆ˜ ìˆë„ë¡ ì˜êµ¬ì ìœ¼ë¡œ ì €ì¥í•˜ê³ , ì´ë²¤íŠ¸ ìŠ¤íŠ¸ë¦¼ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì¡°ì‘, ì²˜ë¦¬ ë° ëŒ€ì‘í•œë‹¤. íƒ„ìƒ ë°°ê²½ ë§í¬ë“œì¸(LinkedIn)ì—ì„œ ìƒì„±ë˜ëŠ” ë¡œê·¸ë¥¼ ì²˜ë¦¬í•˜ì—¬, ì‚¬ìš©ìë“¤ì˜ ì›¹ì‚¬ì´íŠ¸ í™œë™ì„ ì¶”ì í•˜ëŠ” ê²ƒì„ ëª©ì ìœ¼ë¡œ ê°œë°œë˜ì—ˆë‹¤.(ë” ìì„¸í•œ ë‚´ìš©ì€ ë§í¬ë“œì¸ ë¸”ë¡œê·¸ ì°¸ì¡°) ë‹¹ì‹œ, ë§ì€ ê¸°ì—…ë“¤ì—ì„œëŠ” ë¹…ë°ì´í„°ë¥¼ ì–´ë–»ê²Œ í™œìš©í•  ê²ƒì¸ì§€ê°€ í™”ë‘ì˜€ê³  ì´ë¥¼ ìœ„í•´ ë¡œê·¸ë¥¼ í™œìš©í•˜ê¸° ì‹œì‘í–ˆë‹¤. ë§í¬ë“œì¸ì´ ì‹¤í˜„í•˜ë ¤ê³  í–ˆë˜ ëª©í‘œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤. ë°ì´í„°ë¥¼ ë†’ì€ ì²˜ë¦¬ëŸ‰ìœ¼ë¡œ ì‹¤ì‹œê°„ ì²˜ë¦¬ ìˆ˜ë°± ë°€ë¦¬ì´ˆ ~ ìˆ˜ ì´ˆ ë‚´ì— ë°ì´í„° ìˆ˜ì§‘ì—ì„œ ì²˜ë¦¬ê¹Œì§€ ì™„ë£Œí•œë‹¤. ì„ì˜ì˜ íƒ€ì´ë°ì— ë°ì´í„°ë¥¼ ì½ëŠ”ë‹¤ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ëª©ì ì— ë”°ë¼ ê¼­ ì‹¤ì‹œê°„ì´ ì•„ë‹ˆë¼ ë°°ì¹˜ ì²˜ë¦¬ë„ ê°€ëŠ¥í•˜ë„ë¡ í•œë‹¤. ë‹¤ì–‘í•œ ì œí’ˆê³¼ ì‹œìŠ¤í…œì— ì‰½ê²Œ ì—°ë™í•œë‹¤ ë§í¬ë“œì¸ì—ì„œ ë°ì´í„°ì˜ ë°œìƒì›ì´ ë˜ëŠ” ì‹œìŠ¤í…œì´ ë‹¤ì–‘í–ˆê¸° ë•Œë¬¸ì—, ì—¬ëŸ¬ ì‹œìŠ¤í…œì„ í†µí•´ ë°ì´í„°ë¥¼ ë°›ì•„ë“¤ì—¬ì•¼ í–ˆë‹¤. ë©”ì„¸ì§€ë¥¼ ìƒì§€ ì•ŠëŠ”ë‹¤ ì‚¬ìš©ì í™œë™ì„ ì¶”ì í•˜ëŠ” ê²ƒì´ ëª©í‘œì˜€ê¸° ë•Œë¬¸ì— ì•½ê°„ì˜ ì¤‘ë³µì´ ìˆë”ë¼ë„ ë©”ì„¸ì§€ë¥¼ ìƒì§€ ì•ŠëŠ” ê²ƒì´ ì¤‘ìš”í–ˆë‹¤. ë©”ì„¸ì§€ ì¤‘ë³µì„ í—ˆìš©í•˜ì§€ ì•Šë„ë¡ ê±´ë§ˆë‹¤ ê´€ë¦¬í•˜ë©´, ì²˜ë¦¬ ì˜¤ë²„í—¤ë“œê°€ ì»¤ì§€ê¸° ë•Œë¬¸ì— â€˜ë†’ì€ ì²˜ë¦¬ëŸ‰ìœ¼ë¡œ ì‹¤ì‹œê°„ ì²˜ë¦¬â€™ë¼ëŠ” ëª©ì ì„ ë‹¬ì„±í•˜ê¸°ê°€ ì–´ë µë‹¤. ëª©í‘œ ì‹¤í˜„í•˜ê¸° ë§í¬ë“œì¸ì€ ìœ„ì—ì„œ ì–¸ê¸‰í•œ ëª©í‘œë¥¼ ì‹¤í˜„í•˜ê¸° ìœ„í•´ í¬ê²Œ 4ê°€ì§€ ë°©ë²•ì„ ì‚¬ìš©í–ˆë‹¤.1. ë©”ì„¸ì§• ëª¨ë¸ê³¼ ìŠ¤ì¼€ì¼ ì•„ì›ƒí˜• ì•„í‚¤í…ì²˜ ëª©í‘œ ë†’ì€ ì²˜ë¦¬ëŸ‰ìœ¼ë¡œ ì‹¤ì‹œê°„ ì²˜ë¦¬ ì„ì˜ì˜ íƒ€ì´ë°ì— ë°ì´í„° ì½ê¸° ë‹¤ì–‘í•œ ì œí’ˆê³¼ ì‹œìŠ¤í…œì— ì‰½ê²Œ ì—°ë™ ì´ëŸ¬í•œ ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ ì¹´í”„ì¹´ëŠ” ë©”ì„¸ì§• ëª¨ë¸ì„ ì±„íƒí–ˆë‹¤.ì¼ë°˜ì ì¸ ë©”ì„¸ì§• ëª¨ë¸ ë©”ì„¸ì§• ëª¨ë¸ì€ ì¼ë°˜ì ìœ¼ë¡œ Producer, Broker, Consumerë¡œ êµ¬ì„±ëœë‹¤. ëŒ€í‘œì ì¸ ë©”ì„¸ì§• ëª¨ë¸ë¡œëŠ” Queuing ëª¨ë¸ê³¼ Publish/Subscribe(Pub/Sub) ëª¨ë¸ì´ ìˆë‹¤. Queuing ëª¨ë¸ ë¸Œë¡œì»¤ ì•ˆì— ìˆëŠ” íì— í”„ë¡œë“€ì„œì˜ ë©”ì„¸ì§€ê°€ ë‹´ê¸°ê³ , ì»¨ìŠˆë¨¸ê°€ íì—ì„œ ë©”ì„¸ì§€ë¥¼ ì¶”ì¶œí•œë‹¤. ì—¬ëŸ¬ ê°œì˜ ì»¨ìŠˆë¨¸ë¡œ í™•ì¥í•˜ì—¬ ë©”ì„¸ì§€ë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆì–´ ë³‘ëŸ´ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤. í•˜ë‚˜ì˜ ì»¨ìŠˆë¨¸ê°€ ë©”ì„¸ì§€ë¥¼ ë°›ìœ¼ë©´ ë‹¤ë¥¸ ì»¨ìŠˆë¨¸ëŠ” í•´ë‹¹ ë©”ì„¸ì§€ë¥¼ ë°›ì„ ìˆ˜ ì—†ë‹¤. ì¦‰, í•˜ë‚˜ì˜ ë©”ì„¸ì§€ëŠ” ì—¬ëŸ¬ ì»¨ìŠˆë¨¸ ì¤‘ ì–´ëŠ í•˜ë‚˜ì—ì„œ ì²˜ë¦¬ëœë‹¤. íì—ì„œ ì¶”ì¶œë˜ì–´ ì»¨ìŠˆë¨¸ì— ë„ë‹¬í•œ ë©”ì„¸ì§€ëŠ” ì‚¬ë¼ì§„ë‹¤. ì¶œì²˜ : https://www.mailgun.com/blog/set-up-message-queue-asynchronous-sending/ Pub/Sub ëª¨ë¸ Publisher = Producer Subscriber = Consumer PublisherëŠ” ë¸Œë¡œì»¤ ë‚´ì˜ Topicì´ë¼ê³  ë¶ˆë¦¬ëŠ” ìŠ¤í† ë¦¬ì§€ì— ë©”ì„¸ì§€ë¥¼ ë°œí–‰í•œë‹¤. SubscriberëŠ” ì—¬ëŸ¬ ê°œì˜ í† í”½ ì¤‘ ì›í•˜ëŠ” ê²ƒë§Œ êµ¬ë…í•˜ì—¬ ë©”ì„¸ì§€ë¥¼ ìˆ˜ì‹ í•œë‹¤. ì—¬ëŸ¬ Subscriberê°€ ë™ì¼í•œ í† í”½ì„ êµ¬ë…í•˜ë©´, íì‰ ëª¨ë¸ê³¼ëŠ” ë‹¬ë¦¬ í•˜ë‚˜ì˜ ë©”ì„¸ì§€ê°€ ì—¬ëŸ¬ Subscriber(ì»¨ìŠˆë¨¸)ì—ê²Œ ë„ë‹¬í•  ìˆ˜ ìˆë‹¤. ì¶œì²˜ : https://dev.to/tranthanhdeveloper/point-to-point-and-publish-subscribe-messaging-model-41j0ì¹´í”„ì¹´ì˜ ë©”ì„¸ì§• ëª¨ë¸ê³¼ ìŠ¤ì¼€ì¼ ì•„ì›ƒí˜• ì•„í‚¤í…ì²˜ ë†’ì€ ì²˜ë¦¬ëŸ‰ì„ ì‹¤í˜„í•˜ê¸° ìœ„í•´ì„œëŠ” ì–´ë–»ê²Œ í™•ì¥ì„± ìˆëŠ” êµ¬ì„±ì„ í•  ìˆ˜ ìˆì„ì§€ê°€ ê´€ê±´ì´ë‹¤ ì¹´í”„ì¹´ëŠ” ì»¨ìŠˆë¨¸ ê·¸ë£¹ì´ë¼ëŠ” ê°œë…ì„ ë„ì…í•´ì„œ ë‘ ê°€ì§€ ë©”ì„¸ì§• ëª¨ë¸ì˜ íŠ¹ì§•ì„ ì‚´ë¦° ëª¨ë¸ì„ êµ¬í˜„í•œë‹¤. Queuing ëª¨ë¸ì˜ íŠ¹ì§• : ë³‘ë ¬ ì²˜ë¦¬(ì—¬ëŸ¬ ì»¨ìŠˆë¨¸ê°€ ë¶„ì‚° ì²˜ë¦¬ë¡œ ë©”ì„¸ì§€ ì†Œë¹„) Pub/Sub ëª¨ë¸ì˜ íŠ¹ì§• : ë™ì¼í•œ ë©”ì„¸ì§€ë¥¼ ì—¬ëŸ¬ êµ¬ë…ìì—ê²Œ ì „ë‹¬í•˜ê³ , í† í”½ì„ ê¸°ë°˜ìœ¼ë¡œ ë©”ì„¸ì§€ ë¶„ë¥˜ ê²°ê³¼ì ìœ¼ë¡œ, ì¹´í”„ì¹´ì˜ ë©”ì„¸ì§• ëª¨ë¸ì€ Pub/Sub ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ ì»¨ìŠˆë¨¸ ê·¸ë£¹ ë‚´ì—ì„œ ë¶„ì‚° ì²˜ë¦¬ë¥¼ í•  ìˆ˜ëŠ” êµ¬ì¡°ì´ë‹¤. ì¹´í”„ì¹´ëŠ” ê³ ê°€ìš©ì„±ê³¼ í™•ì¥ì„±ì„ ìœ„í•´ ë¸Œë¡œì»¤ë¥¼ ë³µìˆ˜ë¡œ êµ¬ì„±í•˜ì—¬ ìŠ¤ì¼€ì¼ ì•„ì›ƒí˜• ì•„í‚¤í…ì²˜ë¥¼ êµ¬ì„±í•œë‹¤.2. ë””ìŠ¤í¬ë¡œì˜ ë°ì´í„° ì˜ì†í™” ëª©í‘œ ì„ì˜ì˜ íƒ€ì´ë°ì— ë°ì´í„°ë¥¼ ì½ëŠ”ë‹¤. ë©”ì„¸ì§€ë¥¼ ìƒì§€ ì•ŠëŠ”ë‹¤. ë°°ì¹˜ ì²˜ë¦¬ë¥¼ ìœ„í•´ ë°ì´í„°ë¥¼ ì¼ì • ê¸°ê°„ë§ˆë‹¤ ë©”ëª¨ë¦¬ì—ì„œë§Œ ìœ ì§€í•˜ëŠ” ê²ƒì€ ìš©ëŸ‰ ë©´ì—ì„œ ë¶ˆê°€ëŠ¥í•˜ë‹¤. ë”°ë¼ì„œ, ì¹´í”„ì¹´ì˜ ë©”ì„¸ì§€ ì˜ì†í™”ëŠ” ë””ìŠ¤í¬ì—ì„œ ì´ë£¨ì–´ì§„ë‹¤. ë””ìŠ¤í¬ì— ì˜ì†í™”í•˜ì§€ë§Œ ë†’ì€ ì²˜ë¦¬ëŸ‰ì„ ì œê³µí•œë‹¤. ì¥ê¸° ë³´ì¡´ì„ ëª©ì ìœ¼ë¡œ ì˜ì†í™”ê°€ ê°€ëŠ¥í•˜ê¸° ë•Œë¬¸ì— ì¹´í”„ì¹´ë¥¼ â€˜ìŠ¤í† ë¦¬ì§€ ì‹œìŠ¤í…œâ€™ìœ¼ë¡œë„ ê°„ì£¼í•  ìˆ˜ ìˆë‹¤. ì»¤ë°‹ ë¡œê·¸ë¥¼ ì¶•ì í•˜ê¸° ìœ„í•œ ìŠ¤í† ë¦¬ì§€ ì‹œìŠ¤í…œì„ ì˜ˆë¡œ ë“¤ ìˆ˜ ìˆë‹¤. ì¹´í”„ì¹´ì˜ ì˜ì†í™” ì¹´í”„ì¹´ëŠ” ë¸Œë¡œì»¤ì˜ ë©”ëª¨ë¦¬ì— ì‹¤ë¦¬ë©´ ì†¡ì‹  ì™„ë£Œ(ë©”ëª¨ë¦¬ì—ì„œ ë””ìŠ¤í¬ë¡œì˜ flushëŠ” OSì—ê²Œ ë§¡ê¹€)ë¼ëŠ” ì‚¬ìƒì„ ê°–ê³  ìˆë‹¤. flush ê°„ê²©ì„ OSì— ì „ì ìœ¼ë¡œ ë§¡ê¸°ì§€ ì•Šê³  ì¹´í”„ì¹´ íŒŒë¼ë¯¸í„°ë¡œ ì§€ì •í•  ìˆ˜ë„ ìˆë‹¤. ë”°ë¼ì„œ, ì¹´í”„ì¹´ì—ì„œì˜ ë°ì´í„° ì˜ì†í™”ëŠ” ë°˜ë“œì‹œ ë°ì´í„° ìì²´ì— ëŒ€í•œ ë‚´ê²°í•¨ì„±(fault-tolerance)ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ê²ƒì€ ì•„ë‹ˆë¼ê³  ì´í•´í•  ìˆ˜ ìˆë‹¤. ì˜¤íˆë ¤ ë©”ì„¸ì§€ ë³µì œ êµ¬ì¡°ë¥¼ í†µí•´, ë‹¨ì¼ ë¸Œë¡œì»¤ì˜ ê³ ì¥ì´ ë°œìƒí•˜ë”ë¼ë„ ë°ì´í„° ì†ì‹¤ë¡œ ì´ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤ê³  ì´í•´í•˜ëŠ” ê²ƒì´ ìì—°ìŠ¤ëŸ½ë‹¤.3. ì´í•´í•˜ê¸° ì‰¬ìš´ API ì œê³µ ëª©í‘œ ë‹¤ì–‘í•œ ì œí’ˆê³¼ ì‹œìŠ¤í…œì— ì‰½ê²Œ ì—°ë™ ì¹´í”„ì¹´ëŠ” í”„ë¡œë“€ì„œì™€ ì»¨ìŠˆë¨¸ê°€ ì‰½ê²Œ ì ‘ì†í•  ìˆ˜ ìˆë„ë¡ Connect APIë¥¼ ì œê³µí•œë‹¤. í”„ë¡œë“€ì„œì™€ ì»¨ìŠˆë¨¸ëŠ” ì´ë¥¼ ì´ìš©í•˜ì—¬ ë¸Œë¡œì»¤ì™€ì˜ ìƒí˜¸ êµí™˜ì´ ê°€ëŠ¥í•˜ë‹¤. APIë¥¼ ê¸°ë°˜ìœ¼ë¡œ íƒ€ ì œí’ˆê³¼ì˜ ì ‘ì†ì— ê´€í•œ ê³µí†µ ë¶€ë¶„ì„ í”„ë ˆì„ì›Œí¬í™”í•œ Kafka Connectì™€ ì œí’ˆë³„ ì»¤ë„¥í„°ë„ ìˆë‹¤. ì¹´í”„ì¹´ì˜ ìŠ¤íŠ¸ë¦¼ ë°ì´í„° ì²˜ë¦¬ë¥¼ ìœ„í•œ Streams APIì™€ ì´ë¥¼ ì´ìš©í•œ Kafka Streamsë„ ì œê³µëœë‹¤.4. ì „ë‹¬ ë³´ì¦ ëª©í‘œ ë©”ì„¸ì§€ë¥¼ ìƒì§€ ì•ŠëŠ”ë‹¤. í”„ë¡œë“€ì„œ ì…ì¥ì—ì„œëŠ” ë‹¹ì—°íˆ ì¤‘ê°„ì— ë©”ì„¸ì§€ê°€ ìœ ì‹¤ë˜ì§€ ì•Šê³  ì»¨ìŠˆë¨¸ê¹Œì§€ ì „ë‹¬ë˜ì–´ì•¼ í•œë‹¤. ì´ë¥¼ ìœ„í•´ ì¹´í”„ì¹´ëŠ” â€˜ì „ë‹¬ ë³´ì¦(delivery guarantees)â€™ ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤. ì¢…ë¥˜ ë¸Œë¡œì»¤ì—ì„œ ë©”ì‹œì§€ ì²˜ë¦¬ ì¬ì „ì†¡ ìœ ë¬´ ì¤‘ë³µ ì‚­ì œ ìœ ë¬´ ë©”ì‹œì§€ ìœ ì‹¤ ì—¬ë¶€ At Most Once 0 ë˜ëŠ” 1íšŒ X X ìœ ì‹¤ë  ìˆ˜ ìˆë‹¤. At Least Once 1íšŒ ë˜ëŠ” ê·¸ ì´ìƒ O X ìœ ì‹¤ ê°€ëŠ¥ì„±ì´ ë‚®ë‹¤. Exactly Once 1íšŒ O O ìœ ì‹¤ ê°€ëŠ¥ì„±ì´ ë§¤ìš° ë‚®ë‹¤. ì¹´í”„ì¹´ ê°œë°œ ì´ˆê¸°ì—ëŠ” ë†’ì€ ì²˜ë¦¬ëŸ‰ì„ êµ¬í˜„í•´ì•¼ í–ˆê¸° ë•Œë¬¸ì— Exactly Once ìˆ˜ì¤€ì˜ ë³´ì¦ì€ ë¯¸ë£¨ê³  ìµœì†Œí•œ ë©”ì„¸ì§€ ìœ ì‹¤ì„ ë°©ì§€í•˜ê³ ì At Least Once ìˆ˜ì¤€ìœ¼ë¡œ ì „ë‹¬ì„ ë³´ì¦í–ˆë‹¤.Ackì™€ Offset Commit Ack ë¸Œë¡œì»¤ê°€ ë©”ì„¸ì§€ë¥¼ ìˆ˜ì‹ í–ˆì„ ë•Œ í”„ë¡œë“€ì„œì—ê²Œ ìˆ˜ì‹  ì™„ë£Œí–ˆë‹¤ëŠ” ì‘ë‹µ ì´ê²ƒì„ ì´ìš©í•´ í”„ë¡œë“€ì„œëŠ” ì¬ì „ì†¡ ì—¬ë¶€ë¥¼ íŒë‹¨í•  ìˆ˜ ìˆë‹¤. acks = 0ì´ë©´ at most once ìˆ˜ì¤€ì˜ ì „ë‹¬ ë³´ì¦ acks = 1ì´ë©´ at least once ìˆ˜ì¤€ì˜ ì „ë‹¬ ë³´ì¦ (default) acks = allì´ë©´ exactly once ìˆ˜ì¤€ì˜ ì „ë‹¬ ë³´ì¦ (acks ì´ì™¸ì— enable.idempotence ë“±ì˜ ì„¤ì •ë„ í•„ìš”í•˜ë‹¤.) Offset Commit Offset : ì»¨ìŠˆë¨¸ê°€ ì–´ë””ê¹Œì§€ ë©”ì„¸ì§€ë¥¼ ë°›ì•˜ëŠ”ì§€ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì§€í‘œ Offset Commit : ì˜¤í”„ì…‹ì„ ì´ìš©í•´ ì „ë‹¬ ë³´ì¦ì„ ì‹¤í˜„í•˜ëŠ” êµ¬ì¡° ë¸Œë¡œì»¤ëŠ” ì˜¤í”„ì…‹ ì»¤ë°‹ì„ í†µí•´ ì˜¤í”„ì…‹ì„ ì—…ë°ì´íŠ¸í•œë‹¤. ì¦‰, ì»¨ìŠˆë¨¸ê°€ ë©”ì„¸ì§€ë¥¼ ì²˜ë¦¬(ìˆ˜ì‹ )í•œ ê¸°ë¡ì„ ë‚¨ê¸°ëŠ” ê²ƒì´ë‹¤. ì´ë¥¼ í†µí•´ ë©”ì„¸ì§€ë¥¼ ì¬ì „ì†¡í•  ë•Œë„ ì–´ë””ì„œë¶€í„° ì¬ì „ì†¡í•˜ë©´ ë˜ëŠ”ì§€ íŒë‹¨í•  ìˆ˜ ìˆë‹¤. Exactly Once êµ¬í˜„ ì¹´í”„ì¹´ì˜ ìœ ìš©ì„±ì´ ë†’ì•„ì§€ë©´ì„œ Exactly Once ìˆ˜ì¤€ì˜ ì „ë‹¬ì„ ë³´ì¦í•˜ê³ ì í•˜ëŠ” ìš”êµ¬ê°€ ë†’ì•„ì¡Œë‹¤. ì´ë¥¼ ìœ„í•´ ì¹´í”„ì¹´ì— íŠ¸ëœì­ì…˜ ê°œë…ì„ ë„ì…í•˜ê²Œ ë˜ì—ˆë‹¤. Exactly Onceë¥¼ ë³´ì¦í•˜ê¸° ìœ„í•´ì„œëŠ” í”„ë¡œë“€ì„œ, ì»¨ìŠˆë¨¸ ì¸¡ì—ì„œì˜ êµ¬í˜„ ë„ í•„ìš”í•˜ë‹¤. ì¶œì²˜ : ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), p51 ì¶œì²˜ : ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), p51 ìš”ì•½ì¹´í”„ì¹´ì˜ íŠ¹ì§• í™•ì¥ì„± : ì—¬ëŸ¬ ì„œë²„ë¡œ scale outí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë°ì´í„° ì–‘ì— ë”°ë¼ ì‹œìŠ¤í…œ í™•ì¥ì´ ê°€ëŠ¥í•˜ë‹¤. ì˜ì†ì„± : ìˆ˜ì‹ í•œ ë°ì´í„°ë¥¼ ë””ìŠ¤í¬ì— ìœ ì§€í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì–¸ì œë¼ë„ ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìˆë‹¤ ìœ ì—°ì„± : ì—°ê³„í•  ìˆ˜ ìˆëŠ” ì œí’ˆì´ ë§ê¸° ë•Œë¬¸ì— í—ˆë¸Œ ì—­í• ì„ í•œë‹¤. ì‹ ë¢°ì„± : ë©”ì„¸ì§€ ì „ë‹¬ ë³´ì¦ì„ í•˜ë¯€ë¡œ ë°ì´í„° ë¶„ì‹¤ì„ ê±±ì •í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.ì¹´í”„ì¹´ì˜ ëª©í‘œì™€ ì‹¤í˜„ ë°©ë²•ì°¸ê³ ìë£Œ ì‚¬ì‚¬í‚¤ ë„ë£¨ ì™¸ 4ì¸, ã€ì‹¤ì „ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ã€, í•œë¹›ë¯¸ë””ì–´(2020), 1ì¥ https://kafka.apache.org/documentation/# https://blog.stackpath.com/distributed-system/" }, { "title": "MSA ê¸°ë°˜ì˜ íšŒì‚¬ í”„ë¡œì íŠ¸ì— ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì ìš©í•˜ê¸°", "url": "/posts/applying-unit-test-code-in-company/", "categories": "", "tags": "", "date": "2021-07-13 22:25:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ë¶€ë„ëŸ¬ìš´ ì–˜ê¸°ì§€ë§Œ ë‚´ê°€ íšŒì‚¬ì—ì„œ ê²½í—˜í–ˆë˜ í”„ë¡œì íŠ¸ì—ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ ì—†ì—ˆë‹¤. ì œì‘ ë‹¹ì‹œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì— ëŒ€í•œ ì–˜ê¸°ê°€ ì•„ì˜ˆ ë‚˜ì˜¤ì§€ ì•Šì•˜ë˜ ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, ë‹¹ì‹œ ì—¬ë¡ ì€â€˜ì œì‘ ê¸°ê°„ ë§ì¶”ê¸°ë„ ì‰½ì§€ ì•Šì€ë° ì–¸ì œ ê·¸ê±¸ í•˜ê³  ì•‰ì•„ìˆëƒâ€™ë¼ëŠ” ì˜ê²¬ì´ ì£¼ë¥¼ ì´ë¤˜ë‹¤. ë‚˜ ë˜í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ ì¤‘ìš”ì„±ì— ëŒ€í•´ ì˜ ì•Œì§€ ëª»í–ˆê³ , ë¹¡ë¹¡í•œ ì œì‘ê¸°ê°„ìœ¼ë¡œ ì¸í•´ ë°¥ë¨¹ë“¯ì´ ...", "content": "ë“¤ì–´ê°€ê¸° ì „ë¶€ë„ëŸ¬ìš´ ì–˜ê¸°ì§€ë§Œ ë‚´ê°€ íšŒì‚¬ì—ì„œ ê²½í—˜í–ˆë˜ í”„ë¡œì íŠ¸ì—ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œê°€ ì—†ì—ˆë‹¤. ì œì‘ ë‹¹ì‹œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì— ëŒ€í•œ ì–˜ê¸°ê°€ ì•„ì˜ˆ ë‚˜ì˜¤ì§€ ì•Šì•˜ë˜ ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, ë‹¹ì‹œ ì—¬ë¡ ì€â€˜ì œì‘ ê¸°ê°„ ë§ì¶”ê¸°ë„ ì‰½ì§€ ì•Šì€ë° ì–¸ì œ ê·¸ê±¸ í•˜ê³  ì•‰ì•„ìˆëƒâ€™ë¼ëŠ” ì˜ê²¬ì´ ì£¼ë¥¼ ì´ë¤˜ë‹¤. ë‚˜ ë˜í•œ í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ ì¤‘ìš”ì„±ì— ëŒ€í•´ ì˜ ì•Œì§€ ëª»í–ˆê³ , ë¹¡ë¹¡í•œ ì œì‘ê¸°ê°„ìœ¼ë¡œ ì¸í•´ ë°¥ë¨¹ë“¯ì´ ì•¼ê·¼ì„ í•´ëŒ”ê¸° ë•Œë¬¸ì—ê°œë°œê¸°ê°„ ë§ì¶”ê¸°ì—ë§Œ ê¸‰ê¸‰í–ˆë˜ ê²ƒ ê°™ë‹¤.ê°œë°œ, í…ŒìŠ¤íŠ¸ ê¸°ê°„ì„ ê±°ì³ ì‹œìŠ¤í…œì„ ê°€ë™í–ˆê³ , ë‹¤ì–‘í•œ ì—ëŸ¬ë“¤ì´ í„°ì ¸ë‚˜ì˜¤ë©° ì •ë§ ë°¤ë‚®ìœ¼ë¡œ ë””ë²„ê¹…ì„ í–ˆë‹¤. ì–´ë–¤ ë¬¸ì œì— ëŒ€í•œ ë””ë²„ê¹…ì´ í•´ë‹¹ ë¬¸ì œëŠ” í•´ê²°í–ˆì§€ë§Œ,ê¸°ì¡´ì— ì˜ ë™ì‘í•˜ê³  ìˆë˜ ë¶€ë¶„ì— ì˜í–¥ì„ ë¯¸ì³ì„œ ë˜ ë‹¤ë¥¸ ë¬¸ì œë¥¼ ë°œìƒì‹œí‚¤ëŠ” ê²½ìš°ê°€ ìƒë‹¹íˆ ë§ì•˜ë‹¤. ì—¬ê¸°ì„œ ë‚˜ëŠ” í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì„ í•˜ì§€ ì•Šì€ ê²ƒì— ëŒ€í•œ ëŒ“ê°€(?)ë¥¼ ì¹˜ë£¨ëŠ” ê²ƒ ê°™ì•˜ë‹¤.í­í’ê°™ì€ ì‹œê°„ë“¤ì´ ì§€ë‚˜ê³  í˜„ì¬ëŠ” ë‚˜ë¦„ëŒ€ë¡œ ì•ˆì •í™”ê°€ ë˜ì–´ ìš´ì˜ì„ í•˜ê³  ìˆì§€ë§Œ, ì—¬ì „íˆ í…ŒìŠ¤íŠ¸ ì½”ë“œì˜ ë¶€ì¬ëŠ” ì½”ë“œë¥¼ ë¦¬íŒ©í† ë§ì„ í•œë‹¤ê±°ë‚˜ ìƒˆë¡œìš´ ìš”êµ¬ì‚¬í•­ì— ëŒ€í•œ ì½”ë“œë¥¼ ì¶”ê°€í–ˆì„ ë•Œ,ìë™í™”ëœ í…ŒìŠ¤íŠ¸ë¥¼ í•  ìˆ˜ ì—†ìœ¼ë©° ì¼ì¼ì´ ì†ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ì•¼í•œë‹¤ëŠ” ë¶ˆí¸í•¨ì´ ìˆë‹¤.ë”°ë¼ì„œ ë‚˜ëŠ” ì§€ê¸ˆì´ë¼ë„ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•´ì•¼ê² ë‹¤ê³  ìƒê°í–ˆê³ , ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í™˜ê²½ì—ì„œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë°©ë²•ì„ ê³µë¶€í•œ ë’¤íšŒì‚¬ í”„ë¡œì íŠ¸ì— ì ìš©í•´ë³´ì•˜ë‹¤.ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±í•˜ê¸°ì ìš© ë²”ìœ„ ì¼ë‹¨ì€ ê°€ì¥ í•µì‹¬ì´ ë˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§(ìŠ¤í”„ë§ ê¸°ì¤€ìœ¼ë¡œ ServiceImpl)ë“¤ì— ì ìš©ì„ í•´ë³´ì•˜ë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ì´ë²¤íŠ¸/ë©”ì‹œì§€ í•¸ë“¤ëŸ¬ í…ŒìŠ¤íŠ¸ëŠ” ì¶”í›„ì— ì ìš©í•´ë³´ê³  ë‚´ìš©ì„ ì¶”ê°€í•  ì˜ˆì •ì´ë‹¤.ë¬´ì—‡ì„ ê²€ì¦í•  ê²ƒì¸ê°€ ? ì¼ë‹¨ ë‚´ê°€ ì†í•œ íŒ€ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ íŠ¹ì„±ì€ ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ë‹¤. í•˜ë‚˜ ì´ìƒì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì—ì„œ ë°ì´í„°ë¥¼ ì¡°íšŒí•´ì˜¨ ë’¤ ë°ì´í„°ë¥¼ ê°€ê³µí•œë‹¤. ê°€ê³µí•œ ë°ì´í„°ë¥¼ í•˜ë‚˜ ì´ìƒì˜ ì„œë¹„ìŠ¤ì— CUD(CREATE / UPDATE / DELETE) ì²˜ë¦¬ë¥¼ í•œë‹¤. íƒ€ì„œë¹„ìŠ¤ì™€ í†µì‹ í•˜ëŠ” ë°©ì‹ì—ëŠ” í¬ê²Œ ë‘ ê°€ì§€ê°€ ìˆë‹¤. R(ì¡°íšŒ) : Rest API CUD : ë©”ì‹œì§€ (ë¸Œë¡œì»¤ : Kafka) ìœ„ íŠ¹ì§•ì„ ê¸°ë°˜ìœ¼ë¡œ, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ê²€ì¦í•´ì•¼ í•  ê²ƒë“¤ì€ ë‹¤ìŒê³¼ ê°™ë‹¤ê³  ìƒê°í–ˆë‹¤. ë°ì´í„° ì¡°íšŒë¥¼ ìœ„í•´ íŠ¹ì • ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí–ˆëŠ”ì§€ ì¡°íšŒí•  ë•Œ í•„ìš”í•œ í•­ëª©ì´ ì„¸íŒ…ì´ ëëŠ”ì§€ íƒ€ì„œë¹„ìŠ¤ì— CUD ì²˜ë¦¬ë¥¼ ìœ„í•´ ë°œí–‰í•˜ëŠ” ì´ë²¤íŠ¸ì— ë°ì´í„°ê°€ ì œëŒ€ë¡œ ì„¸íŒ…ì´ ë˜ì—ˆëŠ”ì§€ ê²€ì¦ ë°ì´í„° : í† í”½ëª…, ë°˜ë“œì‹œ ì„¸íŒ…ë˜ì–´ì•¼ í•  í•­ëª©ì˜ ê°’ ë“± ì˜ëª»ëœ ë°ì´í„°ê°€ ë“¤ì–´ì™”ì„ ë•Œ, ì ì ˆí•œ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ëŠ”ì§€ ì–´ë–»ê²Œ ê²€ì¦í•  ê²ƒì¸ê°€ ? ë°ì´í„° ì¡°íšŒë¥¼ ìœ„í•´ íŠ¹ì • ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí–ˆëŠ”ì§€ Mockitoë¥¼ í™œìš©í•´ì„œ íƒ€ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•˜ëŠ” OtherServiceProxy ë¶€ë¶„ì„ ëª¨í‚¹í•˜ê³ , ì¡°íšŒ ë©”ì„œë“œ í˜¸ì¶œì‹œ ê¸°ëŒ€í•œ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ë„ë¡ ìŠ¤í…í™”í•œë‹¤. verifyë¥¼ í†µí•´ í•´ë‹¹ ë©”ì„œë“œê°€ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ í™•ì¸í•œë‹¤. ì¡°íšŒí•  ë•Œ í•„ìš”í•œ í•­ëª©ì´ ì„¸íŒ…ì´ ëëŠ”ì§€ ë‹¨ìˆœ ê°’ì¸ ê²½ìš° Mockitoì˜ ArgumentMatchers eq() í™œìš© íƒ€ì„œë¹„ìŠ¤ì— CUD ì²˜ë¦¬ë¥¼ ìœ„í•´ ë°œí–‰í•˜ëŠ” ì´ë²¤íŠ¸ì— ë°ì´í„°ê°€ ì œëŒ€ë¡œ ì„¸íŒ…ì´ ë˜ì—ˆëŠ”ì§€ Mockitoì˜ ArgumentCaptor í™œìš© ì ìš© ì½”ë“œ ì‹¤ì œ íšŒì‚¬ ì½”ë“œë¥¼ ì²¨ë¶€í•  ìˆ˜ëŠ” ì—†ê¸° ë•Œë¬¸ì—, ëŒ€ëµì ì¸ íë¦„ì„ íŒŒì•…í•  ìˆ˜ ìˆëŠ” ì½”ë“œë¥¼ ì‘ì„±í–ˆë‹¤.ì´ë ‡ê²Œ í•˜ëŠ”ê²Œ ë§ëŠ”ì§€ëŠ” ëª¨ë¥´ê² ìœ¼ë‚˜, ìµœì†Œí•œ ì—†ì„ ë•Œ ë³´ë‹¤ëŠ” ë¦¬íŒ©í† ë§ í•  ë•Œ ì¢€ ë” ì•ˆì „í•˜ê²Œ í•  ìˆ˜ ìˆì„ê²ƒ ê°™ë‹¤.ì¶”í›„ì— ë” ê³µë¶€í•˜ê³  ìƒˆë¡œìš´ ê²ƒë“¤ì„ ì•Œê²Œë˜ë©´ ë³´ì™„í•  ì˜ˆì •ì´ë‹¤.public class CoreServiceImplTest { @Mock private AServiceProxy aServiceProxy; @Mock private BServiceProxy bServiceProxy; @InjectMocks private CoreServiceImpl logic; private Map&lt;String, Object&gt; inputMessage = new HashMap&lt;&gt;(); private AServiceData getAServiceSampleData() { AServiceData data = new AServiceData(); data ì„¸íŒ… ... return data; } private BServiceData getBServiceSampleData() { BServiceData data = new BServiceData(); data ì„¸íŒ… ... return data; } private void initInputMsg() { inputMessageì— ê°’ ì„¸íŒ…... } private void initStub() { when(aServiceProxy.ì¡°íšŒë©”ì„œë“œ(eq(value1), eq(value2), isNull())) .thenReturn(getAServiceSampleData); when(bServiceProxy.ì¡°íšŒë©”ì„œë“œ(anyList()) .thenReturn(getBServiceSampleData); } @Before public void initMock() { MockitoAnnotations.initMocks(this); initInputMsg(); initStub(); } @Test public void íƒ€ì„œë¹„ìŠ¤_í…Œì´ë¸”ì—_ì €ì¥() { logic.invoke(inputMessage); ArgumentCaptor&lt;SaveData&gt; captor = ArgumentCaptor.forClass(SaveData.class); verify(aServiceProxy).ì €ì¥ë©”ì„œë“œ(captor.capture()); SaveData data = captor.getValue(); assertThat(data).isNotNull(); assertThat(ì €ì¥í•œ ë°ì´í„°ì˜ ê°’).isEqualTo(ê¸°ëŒ€í•˜ëŠ” ê°’); . . . } @Test public void ì¡°íšŒê²°ê³¼_ì—†ëŠ”ê²½ìš°_ì˜ˆì™¸ì²˜ë¦¬() { when(aServiceProxy.ì¡°íšŒë©”ì„œë“œ(eq(value1), eq(value2), isNull())) .thenReturn(null); assertThrownBy(() -&gt; logic.invoke(inputMessage).isInstanceOf(íŠ¹ì •Exception.class); }// ì´í•˜ìƒëµ...}ëŠë‚€ì  ê°œë°œí•˜ëŠ” ë„ë©”ì¸ì„ ì œëŒ€ë¡œ íŒŒì•…í•˜ì§€ ëª»í•œë‹¤ë©´ ì–´ë–¤ ê°’ì´ ì¤‘ìš”í•œì§€, ì–´ë–¤ ê°’ì„ ê²€ì¦í•´ì•¼ í• ì§€ ì˜ ëª¨ë¥´ê¸° ë•Œë¬¸ì— ì œëŒ€ë¡œëœ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì‘ì„±ì´ ì–´ë ¤ìš¸ ê²ƒ ê°™ë‹¤. ë©”ì„œë“œëŠ” ìµœëŒ€í•œ ë‚˜ëˆ ì ¸ ìˆëŠ”ê²Œ í…ŒìŠ¤íŠ¸í•˜ê¸°ì— ìˆ˜ì›”í•œ ê²ƒ ê°™ë‹¤. ê¾¸ì¤€íˆ ì—°ìŠµí•˜ì.ë” ê³µë¶€í•  ë¶€ë¶„ @RunWith(MockitoJUnitRunner.class) vs initMock() JUnit5" }, { "title": "MSA í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ê¸°(2) - í†µí•© í…ŒìŠ¤íŠ¸", "url": "/posts/msa-testing-part2/", "categories": "", "tags": "", "date": "2021-07-11 22:25:00 +0900", "snippet": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´(í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨)â€™ 10ì¥ì„ ì½ê³  í•„ìš”í•œ ë¶€ë¶„ì„ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤. ì„œë¹„ìŠ¤ê°€ ì„œë¡œ ì˜¬ë°”ë¥´ê²Œ ìƒí˜¸ ì‘ìš©í•˜ëŠ”ì§€ì— ëŒ€í•´ì„œëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë§Œìœ¼ë¡œëŠ” í™•ì¸í•  ìˆ˜ ì—†ë‹¤.ì˜ˆë¥¼ ë“¤ì–´, ì‹¤ì œ DBì— ì €ì¥ì„ í–ˆëŠ”ì§€, ì»¤ë§¨ë“œ ë©”ì„¸ì§€ë¥¼ ì˜¬ë°”ë¥¸ í¬ë§·ìœ¼ë¡œ, ì˜¬ë°”ë¥¸ ì±„ë„ì— ì „ì†¡í–ˆëŠ”ì§€ ë“±ì— ëŒ€í•œ ë¶€ë¶„ì´ë‹¤.ì´ë¥¼ ìœ„í•´, ì„œë¹„ìŠ¤ë¥¼ ì „ë¶€ ë„ì›Œ ë†“ê³  ì¼...", "content": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´(í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨)â€™ 10ì¥ì„ ì½ê³  í•„ìš”í•œ ë¶€ë¶„ì„ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤. ì„œë¹„ìŠ¤ê°€ ì„œë¡œ ì˜¬ë°”ë¥´ê²Œ ìƒí˜¸ ì‘ìš©í•˜ëŠ”ì§€ì— ëŒ€í•´ì„œëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë§Œìœ¼ë¡œëŠ” í™•ì¸í•  ìˆ˜ ì—†ë‹¤.ì˜ˆë¥¼ ë“¤ì–´, ì‹¤ì œ DBì— ì €ì¥ì„ í–ˆëŠ”ì§€, ì»¤ë§¨ë“œ ë©”ì„¸ì§€ë¥¼ ì˜¬ë°”ë¥¸ í¬ë§·ìœ¼ë¡œ, ì˜¬ë°”ë¥¸ ì±„ë„ì— ì „ì†¡í–ˆëŠ”ì§€ ë“±ì— ëŒ€í•œ ë¶€ë¶„ì´ë‹¤.ì´ë¥¼ ìœ„í•´, ì„œë¹„ìŠ¤ë¥¼ ì „ë¶€ ë„ì›Œ ë†“ê³  ì¼ì¼ì´ APIë¥¼ í˜¸ì¶œí•´ ë³´ëŠ” ì¢…ë‹¨ ê°„ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ë©´ ê°€ì¥ í™•ì‹¤í•˜ê² ì§€ë§Œì´ëŸ° í…ŒìŠ¤íŠ¸ëŠ” ëŠë¦¬ê³  ì·¨ì•½í•˜ë©° ë¹„ìš©ì´ ë§ì´ ë“ ë‹¤.ë”°ë¼ì„œ, ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ ì œëŒ€ë¡œ ìƒí˜¸ ì‘ìš©í•˜ëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë°”ë¡œ ìœ— ë‹¨ê³„ì¸ â€˜í†µí•© í…ŒìŠ¤íŠ¸â€™ê°€ í•„ìš”í•˜ë‹¤.ì»¨ìŠˆë¨¸ ì£¼ë„ ê³„ì•½ í…ŒìŠ¤íŠ¸(consumer-driven contract test) í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•˜ê¸°ì— ì•ì„œ â€˜ê³„ì•½â€™ì´ë¼ëŠ” ê°œë…ì— ëŒ€í•´ ì•Œê³ ê°€ì.ë‘ ì„œë¹„ìŠ¤ ê°„ì˜ ìƒí˜¸ ì‘ìš©ì€ ë‘ ì„œë¹„ìŠ¤ ì‚¬ì´ì˜ í•©ì˜ ë˜ëŠ” ê³„ì•½ì´ë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ì£¼ë¬¸ ì„œë¹„ìŠ¤ì™€ ì£¼ë¬¸ ì´ë ¥ ì„œë¹„ìŠ¤ëŠ”ì„œë¡œì—ê²Œ ë°œí–‰ë  ì´ë²¤íŠ¸ ë©”ì„¸ì§€ì˜ êµ¬ì¡°ì™€ ì±„ë„ì— ëŒ€í•´ í•©ì˜í•´ì•¼ í•œë‹¤.API ê²Œì´íŠ¸ì›¨ì´ì™€ ë„ë©”ì¸ ì„œë¹„ìŠ¤ ì—­ì‹œ REST API ëì ì— ëŒ€í•´ í•©ì˜í•´ì•¼ í•œë‹¤. ì„œë¹„ìŠ¤ê°€ í´ë¼ì´ì–¸íŠ¸ì˜ ê¸°ëŒ€ì— ë¶€í•©í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ í´ë¼ì´ì–¸íŠ¸ëŠ” ì–´ë– í•œ ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•˜ëŠ” ì„œë¹„ìŠ¤(API ê²Œì´íŠ¸ì›¨ì´, ë‹¤ë¥¸ ë„ë©”ì¸ ì„œë¹„ìŠ¤ ë“±)ì´ë‹¤. ì»¨ìŠˆë¨¸(í˜¸ì¶œí•˜ëŠ” ì„œë¹„ìŠ¤)-í”„ë¡œë°”ì´ë”(í˜¸ì¶œë˜ëŠ” ì„œë¹„ìŠ¤)ì˜ ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤. í”„ë¡œë°”ì´ë”ì˜ APIê°€ ì»¨ìŠˆë¨¸ê°€ ê¸°ëŒ€í•œ ë°”ì™€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒ. ì¦‰, í”„ë¡œë°”ì´ë”ì— ëŒ€í•œ í†µí•© í…ŒìŠ¤íŠ¸ì´ë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ì²´í¬í•˜ëŠ” í…ŒìŠ¤íŠ¸ê°€ ì•„ë‹ˆë‹¤. ë‹¤ìŒ ì‚¬í•­ì„ í™•ì¸ ì»¨ìŠˆë¨¸ê°€ ê¸°ëŒ€í•œ HTTP ë©”ì„œë“œì™€ ê²½ë¡œì¸ê°€ ? (í—¤ë”ê°€ ìˆëŠ” ê²½ìš°) ì»¨ìŠˆë¨¸ê°€ ê¸°ëŒ€í•œ í—¤ë”ë¥¼ ë°›ëŠ”ê°€ ? (ìš”ì²­ ë³¸ë¬¸ì´ ìˆëŠ” ê²½ìš°) ìš”ì²­ ë³¸ë¬¸ì„ ë°›ëŠ”ê°€ ? ì»¨ìŠˆë¨¸ê°€ ê¸°ëŒ€í•œ ìƒíƒœ ì½”ë“œ, í—¤ë”, ë³¸ë¬¸ì´ í¬í•¨ëœ ì‘ë‹µì„ ë°˜í™˜í•˜ëŠ”ê°€ ? ì»¨ìŠˆë¨¸/í”„ë¡œë°”ì´ë”ê°„ ìƒí˜¸ ì‘ìš©ì„ ê³„ì•½(contract)ì´ë¼ëŠ” ìƒ˜í”Œ ëª¨ìŒì§‘ìœ¼ë¡œ ì •ì˜í•˜ëŠ” ê²ƒ ì˜ˆë¥¼ ë“¤ì–´, REST APIì˜ ê³„ì•½ì€ HTTP ìš”ì²­/ì‘ë‹µ ìƒ˜í”Œì„ ëª¨ì•„ ë†“ì€ ê²ƒ Spring Cloud Contractë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨ìŠˆë¨¸ ê³„ì•½ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  ìˆ˜ ìˆë‹¤. í”„ë¡œì„¸ìŠ¤ ì»¨ìŠˆë¨¸ íŒ€ì€ ê°œë°œí•œ ì„œë¹„ìŠ¤ê°€ í”„ë¡œë°”ì´ë”ì™€ ìƒí˜¸ ì‘ìš©í•˜ëŠ” ë°©ë²•ì´ ê¸°ìˆ ëœ ê³„ì•½ì„ ì‘ì„±í•´ì„œ ê¹ƒ í’€ ë¦¬í€˜ìŠ¤íŠ¸ ë“±ì„ í†µí•´ í”„ë¡œë°”ì´ë” íŒ€ì— ì „ë‹¬ í”„ë¡œë°”ì´ë” íŒ€ì€ ê³„ì•½ì„ JARë¡œ íŒ¨í‚¤ì§•í•´ì„œ ë©”ì´ë¸ ì €ì¥ì†Œì— ë°œí–‰ ì»¨ìŠˆë¨¸ ìª½ í…ŒìŠ¤íŠ¸ëŠ” ì €ì¥ì†Œì—ì„œ JAR íŒŒì¼ì„ ë‚´ë ¤ë°›ëŠ”ë‹¤. ì£¼ë¬¸ ì„œë¹„ìŠ¤ì˜ APIë¥¼ ì†Œë¹„í•˜ëŠ” ì»¨ìŠˆë¨¸ ê°œë°œ íŒ€ì€ ê³„ì•½ í…ŒìŠ¤íŠ¸ ìŠ¤ìœ„íŠ¸ë¥¼ ì¶”ê°€í•˜ê³ , ê¸°ëŒ€ëŒ€ë¡œ ì£¼ë¬¸ ì„œë¹„ìŠ¤ APIê°€ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸ ì¶œì²˜ : Chris Richardson, ã€Microservice Patternsã€, p.302 í†µí•© í…ŒìŠ¤íŠ¸ ì‘ì„±í†µí•© í…ŒìŠ¤íŠ¸ ì „ëµ í†µí•© í…ŒìŠ¤íŠ¸ëŠ” ì „ì²´ ì„œë¹„ìŠ¤ë¥¼ ì‹¤í–‰ì‹œí‚¤ì§€ ì•ŠëŠ”ë‹¤.í…ŒìŠ¤íŠ¸ íš¨ê³¼ì— ì˜í–¥ì„ ë¼ì¹˜ì§€ ì•Šìœ¼ë©´ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ê°„ì†Œí™”í•˜ê¸° ìœ„í•´ ë‘ ê°€ì§€ ì „ëµì„ ì‚¬ìš©í•œë‹¤. ê° ì„œë¹„ìŠ¤ì˜ ì–´ëŒ‘í„°(ê°€ëŠ¥í•˜ë©´ ì–´ëŒ‘í„°ì˜ ì§€ì› í´ë˜ìŠ¤ê¹Œì§€)ë¥¼ í…ŒìŠ¤íŠ¸ ì˜ˆë¥¼ ë“¤ì–´, JPA ì˜ì†í™” í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ì„œëŠ” APIë¥¼ í˜¸ì¶œí•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ OrderRepository í´ë˜ìŠ¤ë¥¼ ì§ì ‘ í…ŒìŠ¤íŠ¸ ì „ì²´ ì„œë¹„ìŠ¤ ëŒ€ì‹  ì†Œìˆ˜ì˜ í´ë˜ìŠ¤ë¡œ í…ŒìŠ¤íŠ¸ ë²”ìœ„ë¥¼ ì¢íˆë©´ í…ŒìŠ¤íŠ¸ê°€ ë‹¨ìˆœ/ì‹ ì†í•´ì§„ë‹¤. ì¶œì²˜ : Chris Richardson, ã€Microservice Patternsã€, p.319 ê³„ì•½(ë‘ ì„œë¹„ìŠ¤ ê°„ ìƒí˜¸ ì‘ìš©ì˜ êµ¬ì²´ì ì¸ ì‚¬ë¡€)ì„ í™œìš© ê³„ì•½ì˜ êµ¬ì¡°ëŠ” ì„œë¹„ìŠ¤ ê°„ ìƒí˜¸ ì‘ìš©ì˜ ì¢…ë¥˜ë§ˆë‹¤ ë‹¤ë¥´ë‹¤. ì†Œë¹„ì ì¸¡ í…ŒìŠ¤íŠ¸ ì»¨ìŠˆë¨¸ ì–´ëŒ‘í„°ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ë¡œì„œ ê³„ì•½ì„ ì´ìš©í•˜ì—¬ í”„ë¡œë°”ì´ë”ë¥¼ ëª¨í‚¹í•œ ìŠ¤í…ì„ êµ¬ì„± í”„ë¡œë°”ì´ë”ë¥¼ ì‹¤í–‰í•  í•„ìš” ì—†ì´ ì»¨ìŠˆë¨¸ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤. í”„ë¡œë°”ì´ë” ì¸¡ í…ŒìŠ¤íŠ¸ í”„ë¡œë°”ì´ë”ì˜ ì–´ëŒ‘í„°ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ë¡œì„œ ì–´ëŒ‘í„°ì˜ ë””íœë˜ì‹œë¥¼ ëª©ìœ¼ë¡œ ì¡ì•„ ë†“ê³  ê³„ì•½ì„ ì´ìš©í•˜ì—¬ ì–´ëŒ‘í„°ë¥¼ í…ŒìŠ¤íŠ¸ ì¶œì²˜ : Chris Richardson, ã€Microservice Patternsã€, p.320 ì˜ì†í™” í…ŒìŠ¤íŠ¸ ì˜ì†í™” í…ŒìŠ¤íŠ¸ ì˜ì—­ ì„œë¹„ìŠ¤ì˜ DB ì ‘ê·¼ ë¡œì§ì´ ì˜ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ì ˆì°¨ë¥¼ ê±°ì¹œë‹¤. ì„¤ì • - DB ìŠ¤í‚¤ë§ˆ ìƒì„± ë° DB íŠ¸ëœì­ì…˜ ì‹œì‘ ì‹¤í–‰ - DB ì‘ì—… ìˆ˜í–‰ í™•ì¸ - DB ìƒíƒœ, ì¡°íšŒí•œ ê°ì²´ assertion ì •ë¦¬ - íŠ¸ëœì­ì…˜ ë¡¤ë°± ë“± DBì— ë³€ê²½í•œ ë‚´ìš© undo @RunWith(SpringRunner.class)@SpringBootTest(classes = OrderJpaTestConfiguration.class)public class OrderJpaTest { @Autowired private OrderRepository orderRepository; @Autowired private TransactionTemplate transactionTemplate; @Test public void shouldSaveAndLoadOrder() { long orderId = transactionTemplate.execute((ts) -&gt; { Order order = new Order(CONSUMER_ID, AJANTA_ID, chickenVindalooLineItems()); orderRepository.save(order); return order.getId(); }); transactionTemplate.execute((ts) -&gt; { Order order = orderRepository.findById(orderId).get(); assertNotNull(order); assertEquals(OrderState.APPROVAL_PENDING, order.getState()); assertEquals(AJANTA_ID, order.getRestaurantId()); assertEquals(CONSUMER_ID, order.getConsumerId().longValue()); assertEquals(chickenVindalooLineItems(), order.getLineItems()); return null; }); }}@Configuration@EnableJpaRepositories@EnableAutoConfigurationpublic class OrderJpaTestConfiguration {} í…ŒìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©ëœ DBë¥¼ ì–´ë–»ê²Œ í”„ë¡œë¹„ì €ë‹(ì‹œìŠ¤í…œì„ ì¦‰ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìƒíƒœë¡œ ì¤€ë¹„í•´ ë‘ëŠ” ê²ƒ) í•˜ëŠëƒê°€ ì¤‘ìš”í•˜ë‹¤ í…ŒìŠ¤íŠ¸ ë„ì¤‘ì— DB ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹¤í–‰í•˜ëŠ” íš¨ê³¼ì ì¸ ë°©ë²•ì€ ë„ì»¤ë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ë‹¤. ì´ëŸ¬í•œ ë°©ë²•ì„ í†µí•´ ì˜ì†í™” í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ í•˜ëŠ” ë™ì•ˆì— MySQL ê°™ì€ DBë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. REST ìš”ì²­/ì‘ë‹µí˜• ìƒí˜¸ ì‘ìš© í…ŒìŠ¤íŠ¸ REST í´ë¼ì´ì–¸íŠ¸/ì„œë¹„ìŠ¤ëŠ” REST ëì  ë° ìš”ì²­/ì‘ë‹µ ë³¸ë¬¸ì˜ êµ¬ì¡°ì— ëŒ€í•´ í•©ì˜í•´ì•¼ í•œë‹¤.ì¦‰, í´ë¼ì´ì–¸íŠ¸ëŠ” ì •í™•í•œ ëì ì— HTTP ìš”ì²­ì„ ë³´ë‚´ì•¼í•˜ê³  ì„œë¹„ìŠ¤ëŠ” ê¸°ëŒ€í•œ ì‘ë‹µì„ ë°˜í™˜í•´ì•¼ í•œë‹¤. REST ìš”ì²­/ì‘ë‹µ í…ŒìŠ¤íŠ¸ ì˜ì—­ í…ŒìŠ¤íŠ¸ êµ¬ì„±ë„ ì¶œì²˜ : Chris Richardson, ã€Microservice Patternsã€, p.323 ì»¨ìŠˆë¨¸ ì¸¡ í…ŒìŠ¤íŠ¸ : OrderServiceProxyê°€ ì£¼ë¬¸ ì„œë¹„ìŠ¤ë¥¼ ì˜¬ë°”ë¥´ê²Œ í˜¸ì¶œí–ˆëŠ”ì§€ OrderServiceProxy âŸ· HTTP ìŠ¤í… ì„œë²„(í˜¸ì¶œë  ë„ë©”ì¸ ì„œë¹„ìŠ¤ì˜ ë™ì‘ì„ í‰ë‚´) WireMockì€ HTTP ì„œë²„ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ëª¨í‚¹í•˜ëŠ” íˆ´ë¡œì„œ, HTTP ìŠ¤í… ì„œë²„ë¥¼ êµ¬í˜„í•  ìˆ˜ ìˆë‹¤. WireMockì„ ê´€ë¦¬í•˜ê³  ê³„ì•½ì— ëª…ì‹œëœ HTTP ìš”ì²­ì— ì‘ë‹µí•˜ë„ë¡ êµ¬ì„±í•˜ëŠ” ì‘ì—…ì€ Spring Cloud Contractì˜ ëª«ì´ë‹¤. @RunWith(SpringRunner.class)@SpringBootTest(classes=TestConfiguration.class, webEnvironment= SpringBootTest.WebEnvironment.NONE)@AutoConfigureStubRunner(ids = {\"net.chrisrichardson.ftgo:ftgo-order-service-contracts\"})@DirtiesContextpublic class OrderServiceProxyIntegrationTest { @Value(\"${stubrunner.runningstubs.ftgo-order-service-contracts.port}\") private int port; private OrderDestinations orderDestinations; private OrderServiceProxy orderService; @Before public void setUp() throws Exception { orderDestinations = new OrderDestinations(); String orderServiceUrl = \"http://localhost:\" + port; System.out.println(\"orderServiceUrl=\" + orderServiceUrl); orderDestinations.setOrderServiceUrl(orderServiceUrl); orderService = new OrderServiceProxy(orderDestinations, WebClient.create()); } @Test public void shouldVerifyExistingCustomer() { OrderInfo result = orderService.findOrderById(\"99\").block(); assertEquals(\"99\", result.getOrderId()); assertEquals(\"APPROVAL_PENDING\", result.getState()); } @Test(expected = OrderNotFoundException.class) public void shouldFailToFindMissingOrder() { orderService.findOrderById(\"555\").block(); }} @Configurationpublic class TestConfiguration {} í”„ë¡œë°”ì´ë” ì¸¡ í…ŒìŠ¤íŠ¸ : REST API ëì ì´ OrderControllerì— ì œëŒ€ë¡œ êµ¬í˜„ë˜ì—ˆëŠ”ì§€ MockMvc/Rest Assured Mock Mvc âŸ· OrderController Spring Cloud ContractëŠ” ê³„ì•½ì„ ì´ìš©í•˜ì—¬ ì£¼ë¬¸ ì„œë¹„ìŠ¤ í†µí•© í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ìƒì„± public abstract class BaseHttp { private StandaloneMockMvcBuilder controllers(Object... controllers) { CommonJsonMapperInitializer.registerMoneyModule(); MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter(JSonMapper.objectMapper); return MockMvcBuilders.standaloneSetup(controllers).setMessageConverters(converter); } @Before public void setup() { OrderService orderService = mock(OrderService.class); OrderRepository orderRepository = mock(OrderRepository.class); OrderController orderController = new OrderController(orderService, orderRepository); when(orderRepository.findById(OrderDetailsMother.ORDER_ID)).thenReturn(Optional.of(OrderDetailsMother.CHICKEN_VINDALOO_ORDER)); when(orderRepository.findById(555L)).thenReturn(empty()); RestAssuredMockMvc.standaloneSetup(controllers(orderController)); }} public class OrderControllerTest extends BaseHttp { @Test public void test() { // do something }} ë°œí–‰/êµ¬ë… ìƒí˜¸ ì‘ìš© í…ŒìŠ¤íŠ¸ ë°œí–‰ê¸°/ì»¨ìŠˆë¨¸ê°€ ë°”ë¼ë³´ëŠ” ë©”ì„¸ì§€ ì±„ë„ ë° ë„ë©”ì¸ ì´ë²¤íŠ¸ êµ¬ì¡°ê°€ ì„œë¡œ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼í•œë‹¤. ë°œí–‰/êµ¬ë… í…ŒìŠ¤íŠ¸ ì˜ì—­ í…ŒìŠ¤íŠ¸ êµ¬ì„±ë„ ì¶œì²˜ : Chris Richardson, ã€Microservice Patternsã€, p.327 í”„ë¡œë°”ì´ë” ì¸¡ í…ŒìŠ¤íŠ¸ : OrderDomainEventPublisherê°€ ê³„ì•½ëŒ€ë¡œ ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•˜ëŠ”ì§€ í™•ì¸@RunWith(SpringRunner.class)@SpringBootTest(classes = MessagingBase.TestConfiguration.class, webEnvironment = SpringBootTest.WebEnvironment.NONE)@AutoConfigureMessageVerifierpublic abstract class MessagingBase { @Configuration @EnableAutoConfiguration @Import({EventuateContractVerifierConfiguration.class, TramEventsPublisherConfiguration.class, TramInMemoryConfiguration.class}) public static class TestConfiguration { @Bean public OrderDomainEventPublisher orderAggregateEventPublisher(DomainEventPublisher eventPublisher) { return new OrderDomainEventPublisher(eventPublisher); } } @Autowired private OrderDomainEventPublisher orderAggregateEventPublisher; protected void orderCreated() { orderAggregateEventPublisher.publish(CHICKEN_VINDALOO_ORDER, Collections.singletonList(new OrderCreatedEvent(CHICKEN_VINDALOO_ORDER_DETAILS, AJANTA_RESTAURANT_NAME))); }}class MessageTest extends MessagingBase { @Test public void validate_orderCreatedEvent() { // ë©”ì„¸ì§€ê°€ ê¸°ëŒ€í•œ ì±„ë„ë¡œ ë°œí–‰ë˜ì—ˆëŠ”ì§€ í™•ì¸ }} ì»¨ìŠˆë¨¸ ì¸¡ í…ŒìŠ¤íŠ¸ : OrderHistoryEventHandlersê°€ ê³„ì•½ëŒ€ë¡œ ì´ë²¤íŠ¸ë¥¼ ì†Œë¹„í•˜ëŠ”ì§€ í™•ì¸ ê° í…ŒìŠ¤íŠ¸ ë©”ì„œë“œëŠ” ìŠ¤í”Œë§ í´ë¼ìš°ë“œë¥¼ í˜¸ì¶œí•´ì„œ ê³„ì•½ì— ëª…ì‹œëœ ì´ë²¤íŠ¸ ë°œí–‰ OrderHistoryEventHandlersê°€ OrderHistoryDaoë¥¼ ì˜¬ë°”ë¥´ê²Œ í˜¸ì¶œí•˜ëŠ”ì§€ í™•ì¸ @RunWith(SpringRunner.class)@SpringBootTest(classes = OrderHistoryEventHandlersTest.TestConfiguration.class, webEnvironment = SpringBootTest.WebEnvironment.NONE)@AutoConfigureStubRunner(ids = {\"net.chrisrichardson.ftgo:ftgo-order-service-contracts\"} )@DirtiesContextpublic class OrderHistoryEventHandlersTest { @Configuration @EnableAutoConfiguration @Import({OrderHistoryServiceMessagingConfiguration.class, TramCommandProducerConfiguration.class, TramInMemoryConfiguration.class, EventuateContractVerifierConfiguration.class}) public static class TestConfiguration { @Bean public ChannelMapping channelMapping() { return new DefaultChannelMapping.DefaultChannelMappingBuilder().build(); } @Bean public OrderHistoryDao orderHistoryDao() { return mock(OrderHistoryDao.class); } } @Autowired private StubFinder stubFinder; @Autowired private OrderHistoryDao orderHistoryDao; @Test public void shouldHandleOrderCreatedEvent() throws InterruptedException { when(orderHistoryDao.addOrder(any(Order.class), any(Optional.class))).thenReturn(false); stubFinder.trigger(\"orderCreatedEvent\"); // orderCreatedEvent ìŠ¤í…ì„ íŠ¸ë¦¬ê±°í•˜ì—¬ OrderCreated ì´ë²¤íŠ¸ ë°œìƒ eventually(() -&gt; { // OrderHistoryEventHandlersê°€ orderHistoryDao.addOrder() í˜¸ì¶œí–ˆëŠ”ì§€ í™•ì¸ ArgumentCaptor&lt;Order&gt; orderArg = ArgumentCaptor.forClass(Order.class); ArgumentCaptor&lt;Optional&lt;SourceEvent&gt;&gt; sourceEventArg = ArgumentCaptor.forClass(Optional.class); verify(orderHistoryDao).addOrder(orderArg.capture(), sourceEventArg.capture()); Order order = orderArg.getValue(); Optional&lt;SourceEvent&gt; sourceEvent = sourceEventArg.getValue(); assertEquals(\"Ajanta\", order.getRestaurantName()); }); }}ë¹„ë™ê¸° ìš”ì²­/ì‘ë‹µ ìƒí˜¸ ì‘ìš© í…ŒìŠ¤íŠ¸ ì˜ˆë¥¼ ë“¤ì–´, ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” ì£¼ë°© ì„œë¹„ìŠ¤ ë“± ì—¬ëŸ¬ ì„œë¹„ìŠ¤ì— ì»¤ë§¨ë“œ ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•˜ê³  ìˆ˜ì‹ í•œ ì‘ë‹µ ë©”ì„¸ì§€ë¥¼ ì‚¬ê°€ë¡œ ì²˜ë¦¬í•œë‹¤.ë”°ë¼ì„œ, ì»¤ë§¨ë“œë¥¼ ì „ì†¡í•˜ëŠ” ì„œë¹„ìŠ¤ì¸ â€˜ìš”ì²­ìâ€™ì™€ ì»¤ë§¨ë“œ ì²˜ë¦¬ í›„ ì‘ë‹µì„ ë°˜í™˜í•˜ëŠ” ì„œë¹„ìŠ¤ì¸ â€˜ì‘ë‹µìâ€™ê°€ ë°”ë¼ë³´ëŠ”ì»¤ë§¨ë“œ ë©”ì„¸ì§€ ì±„ë„ëª…ê³¼ ì»¤ë§¨ë“œ/ì‘ë‹µ ë©”ì„¸ì§€ì˜ êµ¬ì¡°ëŠ” ë°˜ë“œì‹œ ì¼ì¹˜í•´ì•¼ í•œë‹¤. ë¹„ë™ê¸° ìš”ì²­/ì‘ë‹µ í…ŒìŠ¤íŠ¸ ì˜ì—­ í…ŒìŠ¤íŠ¸ êµ¬ì„±ë„ ì¶œì²˜ : Chris Richardson, ã€Microservice Patternsã€, p.331 ì»¨ìŠˆë¨¸ ì¸¡(ì£¼ë¬¸ ì„œë¹„ìŠ¤) í…ŒìŠ¤íŠ¸ : KitchenServiceProxyê°€ ì»¤ë§¨ë“œ ë©”ì„¸ì§€ë¥¼ ì „ì†¡í•˜ê³  ì‘ë‹µ ë©”ì„¸ì§€ë¥¼ ì œëŒ€ë¡œ ì²˜ë¦¬í•˜ëŠ”ì§€ í™•ì¸@RunWith(SpringRunner.class)@SpringBootTest(classes= KitchenServiceProxyIntegrationTest.TestConfiguration.class, webEnvironment= SpringBootTest.WebEnvironment.NONE)@AutoConfigureStubRunner(ids = // ì£¼ë°© ì„œë¹„ìŠ¤ ìŠ¤í…ì´ ë©”ì„¸ì§€ì— ì‘ë‹µí•˜ë„ë¡ êµ¬ì„± {\"net.chrisrichardson.ftgo:ftgo-kitchen-service-contracts\"} )@DirtiesContextpublic class KitchenServiceProxyIntegrationTest { @Configuration @EnableAutoConfiguration @Import({TramCommandProducerConfiguration.class, TramInMemoryConfiguration.class, EventuateContractVerifierConfiguration.class}) public static class TestConfiguration { // TramSagaInMemoryConfiguration @Bean public DataSource dataSource() { EmbeddedDatabaseBuilder builder = new EmbeddedDatabaseBuilder(); return builder.setType(EmbeddedDatabaseType.H2) .addScript(\"eventuate-tram-embedded-schema.sql\") .addScript(\"eventuate-tram-sagas-embedded.sql\") .build(); } @Bean public EventuateTramRoutesConfigurer eventuateTramRoutesConfigurer(BatchStubRunner batchStubRunner) { return new EventuateTramRoutesConfigurer(batchStubRunner); } @Bean public SagaMessagingTestHelper sagaMessagingTestHelper() { return new SagaMessagingTestHelper(); } @Bean public SagaCommandProducer sagaCommandProducer() { return new SagaCommandProducer(); } @Bean public KitchenServiceProxy kitchenServiceProxy() { return new KitchenServiceProxy(); } } @Autowired private SagaMessagingTestHelper sagaMessagingTestHelper; @Autowired private KitchenServiceProxy kitchenServiceProxy; @Test public void shouldSuccessfullyCreateTicket() { CreateTicket command = new CreateTicket(AJANTA_ID, OrderDetailsMother.ORDER_ID, new TicketDetails(Collections.singletonList(new TicketLineItem(CHICKEN_VINDALOO_MENU_ITEM_ID, CHICKEN_VINDALOO, CHICKEN_VINDALOO_QUANTITY)))); CreateTicketReply expectedReply = new CreateTicketReply(OrderDetailsMother.ORDER_ID); String sagaType = CreateOrderSaga.class.getName(); CreateTicketReply reply = sagaMessagingTestHelper // ì»¤ë§¨ë“œ ì „ì†¡ ë° ì‘ë‹µ ëŒ€ê¸° .sendAndReceiveCommand(kitchenServiceProxy.create, command, CreateTicketReply.class, sagaType); assertEquals(expectedReply, reply); // ì‘ë‹µ í™•ì¸ }} í”„ë¡œë°”ì´ë” ì¸¡(ì£¼ë°© ì„œë¹„ìŠ¤) í…ŒìŠ¤íŠ¸ : KitchenServiceCommandHandlerê°€ ì»¤ë§¨ë“œ ì²˜ë¦¬ í›„ ì‘ë‹µì„ ë°˜í™˜í•˜ëŠ”ì§€ í™•ì¸@RunWith(SpringRunner.class)@SpringBootTest(classes = AbstractKitchenServiceConsumerContractTest.TestConfiguration.class, webEnvironment = SpringBootTest.WebEnvironment.NONE)@AutoConfigureMessageVerifierpublic abstract class AbstractKitchenServiceConsumerContractTest { @Configuration @Import({KitchenServiceMessageHandlersConfiguration.class, EventuateContractVerifierConfiguration.class}) public static class TestConfiguration { @Bean public KitchenService kitchenService() { return mock(KitchenService.class); } } @Autowired private KitchenService kitchenService; @Before public void setup() { reset(kitchenService); when(kitchenService.createTicket(eq(1L), eq(99L), any(TicketDetails.class))) .thenReturn(new Ticket(1L, 99L, new TicketDetails(Collections.emptyList()))); }}ì°¸ê³ ìë£Œ í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨, ã€ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´ã€, ê¸¸ë²—(2020), 10ì¥" }, { "title": "MSA í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ê¸°(1) - ë‹¨ìœ„ í…ŒìŠ¤íŠ¸", "url": "/posts/msa-testing-part1/", "categories": "", "tags": "", "date": "2021-07-10 22:25:00 +0900", "snippet": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´(í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨)â€™ 9ì¥ì„ ì½ê³  í•„ìš”í•œ ë¶€ë¶„ì„ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.í…ŒìŠ¤íŠ¸ ê°œìš”ìë™í™” í…ŒìŠ¤íŠ¸ ì‘ì„± ì„¤ì • â†’ ì‹¤í–‰ â†’ í™•ì¸ â†’ ì •ë¦¬ ì„¤ì • - SUT(System Under Test, í…ŒìŠ¤íŠ¸í•  ëŒ€ìƒ)ì™€ ê·¸ ë””íœë˜ì‹œë¡œ êµ¬ì„±ëœ í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜(test fixture)ë¥¼ ì´ˆê¸°í™”í•œë‹¤. ì‹¤í–‰ - SUT í˜¸ì¶œ (ex : í…ŒìŠ¤íŠ¸ ...", "content": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´(í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨)â€™ 9ì¥ì„ ì½ê³  í•„ìš”í•œ ë¶€ë¶„ì„ ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.í…ŒìŠ¤íŠ¸ ê°œìš”ìë™í™” í…ŒìŠ¤íŠ¸ ì‘ì„± ì„¤ì • â†’ ì‹¤í–‰ â†’ í™•ì¸ â†’ ì •ë¦¬ ì„¤ì • - SUT(System Under Test, í…ŒìŠ¤íŠ¸í•  ëŒ€ìƒ)ì™€ ê·¸ ë””íœë˜ì‹œë¡œ êµ¬ì„±ëœ í…ŒìŠ¤íŠ¸ í”½ìŠ¤ì²˜(test fixture)ë¥¼ ì´ˆê¸°í™”í•œë‹¤. ì‹¤í–‰ - SUT í˜¸ì¶œ (ex : í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ì˜ íŠ¹ì • ë©”ì„œë“œ) í™•ì¸ - í˜¸ì¶œ ê²°ê³¼ ë° SUTì˜ ìƒíƒœë¥¼ ë‹¨ì–¸(assertion) ì •ë¦¬ - í•„ìš”í•œ ê²½ìš° ì„¤ì • ë‹¨ê³„ì—ì„œ ì´ˆê¸°í™”í•œ DB íŠ¸ëœì­ì…˜ì„ ë¡¤ë°±í•˜ëŠ” ë“±ì˜ ë’·ì •ë¦¬Stub/Mockì„ ì´ìš©í•œ í…ŒìŠ¤íŠ¸ SUTëŠ” ëŒ€ë¶€ë¶„ ë””íœë˜ì‹œë¥¼ ê°–ê³  ìˆê³ , ì´ëŸ° ë””íœë˜ì‹œ ë•Œë¬¸ì— í…ŒìŠ¤íŠ¸ê°€ ë³µì¡í•˜ê³  ëŠë ¤ì§ˆ ìˆ˜ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, OrderController í´ë˜ìŠ¤ëŠ”OrderServiceë¥¼ í˜¸ì¶œí•˜ê³ , OrderService ì—­ì‹œ ë‹¤ë¥¸ ìˆ˜ë§ì€ ì• í”Œë¦¬ì¼€ì´ì…˜/ì¸í”„ë¼ ì„œë¹„ìŠ¤ì— ì˜ì¡´í•  ìˆ˜ ìˆë‹¤. ì´ëŸ° ê²½ìš°,OrderControllerë§Œ ë”°ë¡œ í…ŒìŠ¤íŠ¸í•˜ê³  ì‹¶ë‹¤ë©´ ? SUTê°€ ì˜ì¡´í•˜ëŠ” ë””íœë˜ì‹œë¥¼ í…ŒìŠ¤íŠ¸ ë”ë¸”(ë””íœë˜ì‹œì˜ ë™ì‘ì„ í‰ë‚´ë‚¸ ê°ì²´)ë¡œ ëŒ€ì²´í•œë‹¤. í…ŒìŠ¤íŠ¸ ë”ë¸”ì€ ìŠ¤í…, ëª© ë‘ ì¢…ë¥˜ê°€ ìˆë‹¤. ìŠ¤í…(stub) - SUTì— ê°’ì„ ë°˜í™˜í•˜ëŠ” ê°ì²´ ëª©(mock) - ìŠ¤í…ì˜ ì¼ì¢…ìœ¼ë¡œ, SUTê°€ ì •í™•í•˜ê²Œ ë””íœë˜ì‹œë¥¼ í˜¸ì¶œí–ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ê°ì²´ ì¼ë°˜ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ë”ë¸”ì€ ëª© ê°ì²´ í”„ë ˆì„ì›Œí¬ì¸ Mockitoë¥¼ í™œìš©í•´ì„œ êµ¬í˜„í•œë‹¤. ì¶œì²˜ : Chris Richardson, ã€Microservice Patternsã€, p.296 ìë™í™” í…ŒìŠ¤íŠ¸ì˜ ì¢…ë¥˜ ì¼ë°˜ì ìœ¼ë¡œ â€˜ë²”ìœ„â€™ì— ë”°ë¼ í…ŒìŠ¤íŠ¸ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ë‚˜ë‰œë‹¤. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸(unit test) - ì„œë¹„ìŠ¤ì˜ ì‘ì€ ë¶€ë¶„(ex : í´ë˜ìŠ¤)ì„ í…ŒìŠ¤íŠ¸ í†µí•© í…ŒìŠ¤íŠ¸(integration test) - í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ì„œë¹„ìŠ¤ê°€ ì¸í”„ë¼ ì„œë¹„ìŠ¤, íƒ€ ì„œë¹„ìŠ¤ ë“±ê³¼ ì—°ë™ë˜ì–´ ì˜ ì‘ë™í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸ ì»´í¬ë„ŒíŠ¸ í…ŒìŠ¤íŠ¸(component test) - ê°œë³„ ì„œë¹„ìŠ¤ì— ëŒ€í•œ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸(acceptance test) ì¢…ë‹¨ ê°„ í…ŒìŠ¤íŠ¸(end-to-end test) - ì „ì²´ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ ì¸ìˆ˜ í…ŒìŠ¤íŠ¸ ì¢…ë‹¨ ê°„ í…ŒìŠ¤íŠ¸ëŠ” ì¤‘ê°„ì— ìˆëŠ” ìˆ˜ ë§ì€ ë””íœë˜ì‹œê¹Œì§€ ì‹¤í–‰ì‹œì¼œì•¼ í•˜ê¸° ë•Œë¬¸ì—, ê°€ëŠ¥í•œ í•œ ì‘ì„±í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ìµœì„ ì´ë‹¤. ì¶œì²˜ : Chris Richardson, ã€Microservice Patternsã€, p.299 ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„± ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” ì„œë¹„ìŠ¤ì˜ ì•„ì£¼ ì‘ì€ ë¶€ì†í’ˆì¸ ë‹¨ìœ„(unit)ê°€ ì œëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” í…ŒìŠ¤íŠ¸ì´ë‹¤.ì¼ë°˜ì ìœ¼ë¡œ ë‹¨ìœ„ëŠ” í´ë˜ìŠ¤ì´ë¯€ë¡œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì˜ ëª©í‘œëŠ” í•´ë‹¹ í´ë˜ìŠ¤ê°€ ì˜ ë™ì‘í•˜ëŠ”ì§€ í™•ì¸í•˜ëŠ” ê²ƒì´ë‹¤. ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ì—ëŠ” ë‘ ê°€ì§€ ì¢…ë¥˜ê°€ ìˆë‹¤. ë…ë¦½(solitary) ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ - í´ë˜ìŠ¤ ë””íœë˜ì‹œë¥¼ ëª© ê°ì²´ë¡œ ë‚˜íƒ€ë‚´ê³  í´ë˜ìŠ¤ë¥¼ ë”°ë¡œ í…ŒìŠ¤íŠ¸ ê³µë™(sociable) ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ - í´ë˜ìŠ¤ì™€ ë””íœë˜ì‹œë¥¼ í…ŒìŠ¤íŠ¸ ì–´ë–¤ ì¢…ë¥˜ì˜ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ë¥¼ í• ì§€ëŠ” í´ë˜ìŠ¤ì˜ ì±…ì„ê³¼ ì•„í‚¤í…ì²˜ì—ì„œì˜ ì—­í• ë§ˆë‹¤ ë‹¤ë¥´ë‹¤. ë‹¤ìŒì€ ì¼ë°˜ì ìœ¼ë¡œ ë§ì´ ì“°ëŠ” í…ŒìŠ¤íŠ¸ ì „ëµì´ë‹¤. ì—”í‹°í‹°ì™€ ê°’ ê°ì²´(Value Object) ê°™ì€ ë„ë©”ì¸ ê°ì²´ëŠ” ê³µë™ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ì— ê±¸ì³ ë°ì´í„° ì¼ê´€ì„±ì„ ìœ ì§€í•˜ëŠ” ì‚¬ê°€ëŠ” ê³µë™ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ë„ë©”ì¸ ì„œë¹„ìŠ¤ í´ë˜ìŠ¤ëŠ” ë…ë¦½ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ì¸ë°”ìš´ë“œ/ì•„ì›ƒë°”ìš´ë“œ ë©”ì‹œì§• ê²Œì´íŠ¸ì›¨ì´ëŠ” ë…ë¦½ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìˆ˜í–‰ ì¶œì²˜ : Chris Richardson, ã€Microservice Patternsã€, p.308 ë„ë©”ì¸ ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ ì´ í´ë˜ìŠ¤ì— ìˆëŠ” ë©”ì„œë“œëŠ” ì¼ë°˜ì ìœ¼ë¡œ ì—”í‹°í‹°ì™€ ë¦¬íŒŒì§€í† ë¦¬ë¥¼ í˜¸ì¶œí•˜ë©° ë„ë©”ì¸ ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•œë‹¤. ì´ëŸ° ì¢…ë¥˜ì˜ í´ë˜ìŠ¤ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ í•˜ë ¤ë©´,ë¦¬íŒŒì§€í† ë¦¬ ë° ë©”ì‹œì§• í´ë˜ìŠ¤ ê°™ì€ ë””íœë˜ì‹œë¥¼ ëª¨í‚¹(mocking)í•˜ê³  ë…ë¦½ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•´ì•¼ í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ë‹¤ìŒê³¼ ê°™ì€ í”„ë¡œì„¸ìŠ¤ë¡œ ì§„í–‰ëœë‹¤. ì„¤ì • : ì„œë¹„ìŠ¤ ë””íœë˜ì‹œì˜ ëª© ê°ì²´ë¥¼ êµ¬ì„± ì‹¤í–‰ : ì„œë¹„ìŠ¤ ë©”ì„œë“œë¥¼ í˜¸ì¶œ í™•ì¸ : ì„œë¹„ìŠ¤ ë©”ì„œë“œê°€ ì˜¬ë°”ë¥¸ ê°’ì„ ë°˜í™˜í•˜ê³  ë””íœë˜ì‹œê°€ ì˜¬ë°”ë¥´ê²Œ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ í™•ì¸ public class OrderServiceTest { private OrderService orderService; private OrderRepository orderRepository; private DomainEventPublisher eventPublisher; private RestaurantRepository restaurantRepository; private SagaManager&lt;CreateOrderSagaState&gt; createOrderSagaManager; private SagaManager&lt;CancelOrderSagaData&gt; cancelOrderSagaManager; private SagaManager&lt;ReviseOrderSagData&gt; reviseOrderSagaManager; private OrderDomainEventPublisher orderAggregateEventPublisher; @Before public void setup() { orderRepository = mock(OrderRepository.class); eventPublisher = mock(DomainEventPublisher.class); restaurantRepository = mock(RestaurantRepository.class); createOrderSagaManager = mock(SagaManager.class); cancelOrderSagaManager = mock(SagaManager.class); reviseOrderSagaManager = mock(SagaManager.class); // Mock DomainEventPublisher AND use the real OrderDomainEventPublisher orderAggregateEventPublisher = mock(OrderDomainEventPublisher.class); orderService = new OrderService(orderRepository, eventPublisher, restaurantRepository, createOrderSagaManager, cancelOrderSagaManager, reviseOrderSagaManager, orderAggregateEventPublisher, Optional.empty()); } @Test public void shouldCreateOrder() { when(restaurantRepository.findById(AJANTA_ID)).thenReturn(Optional.of(AJANTA_RESTAURANT)); when(orderRepository.save(any(Order.class))).then(invocation -&gt; { Order order = (Order) invocation.getArguments()[0]; order.setId(ORDER_ID); return order; }); Order order = orderService.createOrder(CONSUMER_ID, AJANTA_ID, CHICKEN_VINDALOO_MENU_ITEMS_AND_QUANTITIES); verify(orderRepository).save(same(order)); verify(orderAggregateEventPublisher).publish(order, Collections.singletonList(new OrderCreatedEvent(CHICKEN_VINDALOO_ORDER_DETAILS, RestaurantMother.AJANTA_RESTAURANT_NAME))); verify(createOrderSagaManager).create(new CreateOrderSagaState(ORDER_ID, CHICKEN_VINDALOO_ORDER_DETAILS), Order.class, ORDER_ID); } // TODO write tests for other methods}ì»¨íŠ¸ë¡¤ëŸ¬ í…ŒìŠ¤íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ëŠ” ê°ê° ì§€ì •ëœ REST API ëì ì„ ë‹´ë‹¹í•œ ì—¬ëŸ¬ ë©”ì„œë“œë¡œ êµ¬ì„±ëœë‹¤. ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ëŠ” ê²½ë¡œ ë³€ìˆ˜(path variable)ì²˜ëŸ¼HTTP ìš”ì²­ì—ì„œ ì¶”ì¶œëœ ê°’ì„ ë‚˜íƒ€ë‚¸ë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì„œë“œëŠ” ë„ë©”ì¸ ì„œë¹„ìŠ¤ ë˜ëŠ” ë¦¬íŒŒì§€í† ë¦¬ë¥¼ í˜¸ì¶œí•´ì„œ ì‘ë‹µ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ í˜¸ì¶œí•˜ëŠ” ë„ë©”ì¸ ì„œë¹„ìŠ¤, ë¦¬íŒŒì§€í† ë¦¬ ê°™ì€ ê²ƒë“¤ì„ ëª¨í‚¹í•˜ì—¬ ì»¨íŠ¸ë¡¤ëŸ¬ì— ëŒ€í•´ ë…ë¦½ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•˜ê³  ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ë„ ìˆì§€ë§Œ, ì´ë ‡ê²Œ í•˜ë©´ ìš”ì²­ ë¼ìš°íŒ… ê°™ì€ ì¤‘ìš”í•œ ê¸°ëŠ¥ì€ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ì—†ë‹¤. ë”°ë¼ì„œ ëª© MVC í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ë‹¤. Spring MockMvc, Rest Assured Mockì´ ëŒ€í‘œì ì¸ ì˜ˆì´ë‹¤. HTTP ìš”ì²­ì„ ë³´ë‚´ì„œ ë°˜í™˜ëœ HTTP ì‘ë‹µì„ ë‹¨ì–¸(assertion)í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—ì§„ì§œ ë„¤íŠ¸ì›Œí¬ í˜¸ì¶œì„ í•˜ì§€ ì•Šì•„ë„ HTTP ìš”ì²­ ë¼ìš°íŒ… ë° ìë°” ê°ì²´ âŸ· JSON ë³€í™˜ì´ ê°€ëŠ¥í•˜ë‹¤. ì¶œì²˜ : https://terasolunaorg.github.io/guideline/5.4.1.RELEASE/en/UnitTest/ImplementsOfUnitTestpublic class OrderControllerTest { private OrderService orderService; private OrderRepository orderRepository; private OrderController orderController; @Before public void setUp() throws Exception { orderService = mock(OrderService.class); orderRepository = mock(OrderRepository.class); orderController = new OrderController(orderService, orderRepository); } @Test public void shouldFindOrder() { when(orderRepository.findById(1L)).thenReturn(Optional.of(CHICKEN_VINDALOO_ORDER)); given(). standaloneSetup(configureControllers(orderController)). when(). get(\"/orders/1\"). then(). statusCode(200). body(\"orderId\", equalTo(new Long(OrderDetailsMother.ORDER_ID).intValue())). body(\"state\", equalTo(OrderDetailsMother.CHICKEN_VINDALOO_ORDER_STATE.name())). body(\"orderTotal\", equalTo(CHICKEN_VINDALOO_ORDER_TOTAL.asString())) ; } @Test public void shouldFindNotOrder() { when(orderRepository.findById(1L)).thenReturn(Optional.empty()); given(). standaloneSetup(configureControllers(new OrderController(orderService, orderRepository))). when(). get(\"/orders/1\"). then(). statusCode(404) ; } private StandaloneMockMvcBuilder configureControllers(Object... controllers) { CommonJsonMapperInitializer.registerMoneyModule(); MappingJackson2HttpMessageConverter converter = new MappingJackson2HttpMessageConverter(JSonMapper.objectMapper); return MockMvcBuilders.standaloneSetup(controllers).setMessageConverters(converter); }}ì´ë²¤íŠ¸/ë©”ì„¸ì§€ í•¸ë“¤ëŸ¬ í…ŒìŠ¤íŠ¸ ë©”ì„¸ì§€ ì–´ëŒ‘í„°ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì²˜ëŸ¼ ë„ë©”ì¸ ì„œë¹„ìŠ¤, ë ˆíŒŒì§€í† ë¦¬ ë“±ì„ í˜¸ì¶œí•˜ëŠ” ë‹¨ìˆœ í´ë˜ìŠ¤ì´ë‹¤.ì¦‰, ë©”ì„¸ì§€ ì–´ëŒ‘í„°ì˜ ê° ë©”ì„œë“œëŠ” ë©”ì„¸ì§€/ì´ë²¤íŠ¸ì—ì„œ êº¼ë‚¸ ë°ì´í„°ë¥¼ ì„œë¹„ìŠ¤ ë©”ì„œë“œì— ë„˜ê²¨ í˜¸ì¶œí•œë‹¤.ë”°ë¼ì„œ, ë©”ì„¸ì§€ ì–´ëŒ‘í„°ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì™€ ë¹„ìŠ·í•œ ë°©ë²•ìœ¼ë¡œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤. í…ŒìŠ¤íŠ¸ë³„ë¡œ ë©”ì„¸ì§€ ì–´íƒ­í„° ì¸ìŠ¤í„´ìŠ¤ë¥¼ ìƒì„±í•˜ê³  ë©”ì„¸ì§€ë¥¼ ì±„ë„ì— ì „ì†¡í•œ í›„, ì„œë¹„ìŠ¤ ëª©ì´ ì •í™•íˆ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ í™•ì¸í•œë‹¤. ë©”ì„¸ì§• ì¸í”„ë¼ëŠ” ìŠ¤í„°ë¹™í•˜ê¸° ë•Œë¬¸ì— ì‹¤ì œ ë©”ì„¸ì§€ ë¸Œë¡œì»¤ëŠ” ê´€ì—¬í•˜ì§€ ì•ŠëŠ”ë‹¤. Eventuate Tram Mock Messaging í”„ë ˆì„ì›Œí¬ë¥¼ ì´ìš©í•´ì„œ í…ŒìŠ¤íŠ¸í•œë‹¤.public class OrderEventConsumerTest { private OrderService orderService; private OrderEventConsumer orderEventConsumer; @Before public void setUp() throws Exception { orderService = mock(OrderService.class); orderEventConsumer = new OrderEventConsumer(orderService); } @Test public void shouldCreateMenu() { CommonJsonMapperInitializer.registerMoneyModule(); given(). eventHandlers(orderEventConsumer.domainEventHandlers()). when(). aggregate(\"net.chrisrichardson.ftgo.restaurantservice.domain.Restaurant\", AJANTA_ID). publishes(new RestaurantCreated(AJANTA_RESTAURANT_NAME, RestaurantMother.AJANTA_RESTAURANT_MENU)). then(). verify(() -&gt; { verify(orderService).createMenu(AJANTA_ID, AJANTA_RESTAURANT_NAME, new RestaurantMenu(RestaurantMother.AJANTA_RESTAURANT_MENU_ITEMS)); }) ; }}ì°¸ê³ ìë£Œ í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨, ã€ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´ã€, ê¸¸ë²—(2020), 9ì¥" }, { "title": "ì—”í‹°í‹°ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ í‚¤ì›Œë“œ/ì˜ˆì•½ì–´ ì‚¬ìš©ì‹œ ë°œìƒí•˜ëŠ” ë¬¸ì œ", "url": "/posts/jpa-entity-table-reserved-keyword/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "JPA", "date": "2021-07-07 00:29:00 +0900", "snippet": "ìƒí™© ì£¼ë¬¸ í…Œì´ë¸”ì— ë§µí•‘ë˜ëŠ” ì—”í‹°í‹°ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ â€˜Orderâ€™ë¼ëŠ” í´ë˜ìŠ¤ ìƒì„± @Getter@Setter@Entitypublic class Order { @Id private Long id; private OrderStatus orderStatus;} ìŠ¤í”„ë§ ë¶€íŠ¸ ì‹¤í–‰í•˜ê³  h2 dbì— í…Œì´ë¸” ìƒì„±ë˜ë‚˜ í™•ì¸í•˜ë ¤ê³  í•˜ëŠ”ë° ì•„ë˜ì™€...", "content": "ìƒí™© ì£¼ë¬¸ í…Œì´ë¸”ì— ë§µí•‘ë˜ëŠ” ì—”í‹°í‹°ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ â€˜Orderâ€™ë¼ëŠ” í´ë˜ìŠ¤ ìƒì„± @Getter@Setter@Entitypublic class Order { @Id private Long id; private OrderStatus orderStatus;} ìŠ¤í”„ë§ ë¶€íŠ¸ ì‹¤í–‰í•˜ê³  h2 dbì— í…Œì´ë¸” ìƒì„±ë˜ë‚˜ í™•ì¸í•˜ë ¤ê³  í•˜ëŠ”ë° ì•„ë˜ì™€ ê°™ì€ ì—ëŸ¬ ë°œìƒí•˜ë©´ì„œ í…Œì´ë¸” ìƒì„±ì´ ì•ˆë¨ Caused by: org.h2.jdbc.JdbcSQLSyntaxErrorException: Syntax error in SQL statement \" CREATE TABLE ORDER[*] ( ID BIGINT NOT NULL, ORDER_STATUS INTEGER, PRIMARY KEY (ID) ) \"; expected \"identifier\"; SQL statement: ì›ì¸ Orderë¼ëŠ” í´ë˜ìŠ¤ ì´ë¦„ì´ ë°ì´í„°ë² ì´ìŠ¤ í‚¤ì›Œë“œ/ì˜ˆì•½ì–´(ì˜ˆ. ORDER, GROUP, SELECT, WHERE ë“±)ì— ì´ë¯¸ ìˆê¸° ë•Œë¬¸ì— ìŠ¤í‚¤ë§ˆ ìƒì„±ì— ì‹¤íŒ¨í•œ ê²ƒí•´ê²°ë°©ë²•1. escape ë¬¸ì(\\) ì‚¬ìš©@Getter@Setter@Entity(name = \"\\\"order\\\"\")public class Order { @Id private Long id; private OrderStatus orderStatus;}2. backtick ë¬¸ì(`) ì‚¬ìš©@Getter@Setter@Entity(name = \"`order`\")public class Order { @Id private Long id; private OrderStatus orderStatus;}3. globally_quoted_identifiers ì„¤ì •ê°’ ì„¸íŒ…4. í‚¤ì›Œë“œ/ì˜ˆì•½ì–´ ì‚¬ìš©í•˜ì§€ ì•Šê¸°â€» 1~3 ë²ˆì˜ ê²½ìš° ë„¤ì´í‹°ë¸Œ ì¿¼ë¦¬ ì‘ì„±ì‹œ í…Œì´ë¸” ëª…ì„ â€œorderâ€ë¡œ ì ì–´ì¤˜ì•¼ í•œë‹¤.ì„ íƒí•œ ë°©ë²• ë„¤ì´í‹°ë¸Œ ì¿¼ë¦¬ ì‚¬ìš©ì‹œì—ë„ ë¶ˆí¸í•˜ê³ , ê¹€ì˜í•œë‹˜ ê°•ì˜ì—ì„œë„ ê´€ë¡€ì ìœ¼ë¡œ ORDERSë¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤ê³  í•˜ë‹ˆ í…Œì´ë¸” ëª…ì„ ORDERSë¡œ ì„ ì–¸í•˜ì @Getter@Setter@Entity(name = \"ORDERS\")public class Order { @Id private Long id; private OrderStatus orderStatus;} ì°¸ê³  ìë£Œ https://www.chrouki.com/posts/escape-sql-reserved-keywords-jpa-hibernate/ popit.kr/ê°€ì§œë‰´ìŠ¤ì•„ì›ƒ-í•˜ì´ë²„ë„¤ì´íŠ¸-ë°ì´í„°ë² ì´ìŠ¤-ìŠ¤í‚¤ë§ˆ/" }, { "title": "ì—”í‹°í‹°ì— ìˆëŠ” enum íƒ€ì… í•„ë“œë¥¼ DB ì»¬ëŸ¼ì— ì–´ë–»ê²Œ ë§µí•‘ì‹œí‚¬ ìˆ˜ ìˆì„ê¹Œ ?", "url": "/posts/enum-field-in-entity/", "categories": "", "tags": "", "date": "2021-07-07 00:29:00 +0900", "snippet": " ì˜ˆë¥¼ ë“¤ì–´ ì£¼ë¬¸ ì—”í‹°í‹°ì˜ â€˜ì£¼ë¬¸ ìƒíƒœâ€™ì™€ ê°™ì´ enum íƒ€ì…ìœ¼ë¡œ ì„ ì–¸í•˜ê¸° ì í•©í•œ í•„ë“œë“¤ì´ ìˆë‹¤. ë¬¸ìì—´, ìˆ«ì, ë‚ ì§œ ë“±ë„ ì•„ë‹Œ enum íƒ€ì…ì€ DBì— ì–´ë–»ê²Œ ì €ì¥ì‹œì¼œì•¼í• ê¹Œ ?@Enumerated1. EnumType.ORDINAL @Enumerated(EnumType.ORDINAL)ì„ ì‚¬ìš©í•˜ê²Œë˜ë©´ JPAëŠ” ENUM í´ë˜ìŠ¤ì˜ ordinal()ë©”ì„œë“œ...", "content": " ì˜ˆë¥¼ ë“¤ì–´ ì£¼ë¬¸ ì—”í‹°í‹°ì˜ â€˜ì£¼ë¬¸ ìƒíƒœâ€™ì™€ ê°™ì´ enum íƒ€ì…ìœ¼ë¡œ ì„ ì–¸í•˜ê¸° ì í•©í•œ í•„ë“œë“¤ì´ ìˆë‹¤. ë¬¸ìì—´, ìˆ«ì, ë‚ ì§œ ë“±ë„ ì•„ë‹Œ enum íƒ€ì…ì€ DBì— ì–´ë–»ê²Œ ì €ì¥ì‹œì¼œì•¼í• ê¹Œ ?@Enumerated1. EnumType.ORDINAL @Enumerated(EnumType.ORDINAL)ì„ ì‚¬ìš©í•˜ê²Œë˜ë©´ JPAëŠ” ENUM í´ë˜ìŠ¤ì˜ ordinal()ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê°’ì„ ì €ì¥í•œë‹¤(0ë¶€í„° ì‹œì‘í•´ì„œ ìƒìˆ˜ê°€ ì„ ì–¸ëœ ìˆœì„œëŒ€ë¡œ ê°’ì´ ë§µí•‘) ë”°ë¼ì„œ, ì•„ë˜ì˜ ê²½ìš°ëŠ” DBì˜ Article í…Œì´ë¸” status ì»¬ëŸ¼ì— 0ì´ ì €ì¥ëœë‹¤. ë¬¸ì œì  ì¤‘ê°„ì— ìƒˆ ê°’ì„ ì¶”ê°€í•˜ê±°ë‚˜ ìˆœì„œë¥¼ ì¬ì •ë ¬í•˜ë©´ ê¸°ì¡´ ë°ì´í„° ì •í•©ì„±ì´ ê¹¨ì§„ë‹¤. public enum Status { OPEN, REVIEW, APPROVED, REJECTED;}@Entitypublic class Article { @Id private int id; private String title; @Enumerated(EnumType.ORDINAL) private Status status;}Article article = new Article();article.setId(1);article.setTitle(\"ordinal title\");article.setStatus(Status.OPEN);2. EnumType.STRING @Enumerated(EnumType.STRING)ì„ ì‚¬ìš©í•˜ê²Œë˜ë©´ JPAëŠ” ENUM í´ë˜ìŠ¤ì˜ name()ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ê°’ì„ ì €ì¥í•œë‹¤(ìƒìˆ˜ ì´ë¦„ì„ ë¬¸ìì—´ë¡œ ë°˜í™˜) ë”°ë¼ì„œ, ì•„ë˜ì˜ ê²½ìš°ëŠ” DBì˜ Article í…Œì´ë¸” status ì»¬ëŸ¼ì— OPENì´ ì €ì¥ëœë‹¤. ë¬¸ì œì  enum ê°’ì„ ë³€ê²½í•˜ê²Œ ë˜ë©´ ê¸°ì¡´ ë°ì´í„° ì •í•©ì„±ì´ ê¹¨ì§„ë‹¤. í•„ìš” ì´ìƒìœ¼ë¡œ ë§ì€ ê³µê°„ì„ ì†Œë¹„í•œë‹¤. @Entitypublic class Article { @Id private int id; private String title; @Enumerated(EnumType.STRING) private Status status;}Article article = new Article();article.setId(1);article.setTitle(\"ordinal title\");article.setStatus(Status.OPEN);@PostLoad, @PrePersist JPA ì½œë°± ë©”ì„œë“œì¸ @PostLoad, @PrePersistë¥¼ í™œìš©í•˜ì—¬ DBì— ì €ì¥í•  ë•Œì˜ ê°’ê³¼ ê°€ì ¸ì™€ì„œ ë§µí•‘í•  ê°’ì„ ë¶„ë¦¬í•œë‹¤. @PrePersist : ìƒˆë¡œìš´ ì—”í‹°í‹°ë¥¼ ì €ì¥í•˜ê¸° ì´ì „ì— í˜¸ì¶œë¨ @PostPersist : ìƒˆë¡œìš´ ì—”í‹°í‹°ë¥¼ ì €ì¥í•œ ì´í›„ì— í˜¸ì¶œë¨ ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ DBì˜ Article í…Œì´ë¸” priorityValue ì»¬ëŸ¼ì— 300ì´ ì €ì¥ëœë‹¤. ë¬¸ì œì  í•˜ë‚˜ì˜ ê°’ì„ ìœ„í•´ ë‘ ê°œì˜ ì†ì„±ì„ ê°€ì ¸ì•¼í•œë‹¤. JPQL ì¿¼ë¦¬ì—ì„œ Enum ê°’ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤. public enum Priority { LOW(100), MEDIUM(200), HIGH(300); private int priority; private Priority(int priority) { this.priority = priority; } public int getPriority() { return priority; } public static Priority of(int priority) { return Stream.of(Priority.values()) .filter(p -&gt; p.getPriority() == priority) .findFirst() .orElseThrow(IllegalArgumentException::new); }}@Entitypublic class Article { @Id private int id; private String title; @Basic private int priorityValue; // DBì— ì €ì¥ë  ê°’ @Transient // ì—”í‹°í‹° ê°ì²´ì˜ ë°ì´í„°ì™€ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ê³¼ ë§¤í•‘í•˜ê³  ìˆëŠ” ê´€ê³„ë¥¼ ì œì™¸í•˜ê¸° ìœ„í•´ ì‚¬ìš© private Priority priority; // DBì—ì„œ ê°€ì ¸ì™€ì„œ ë§µí•‘ë  ê°’ @PostLoad void fillTransient() { if (priorityValue &gt; 0) { this.priority = Priority.of(priorityValue); } } @PrePersist void fillPersistent() { if (priority != null) { this.priorityValue = priority.getPriority(); } }}Article article = new Article();article.setId(3);article.setTitle(\"callback title\");article.setPriority(Priority.HIGH);@Converter ìœ„ ë°©ë²•ë“¤ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê¸° ìœ„í•´, JPA 2.1ì—ì„œëŠ” ì—”í‹°í‹° ì†ì„±ì„ DB ê°’ìœ¼ë¡œ ë³€í™˜í•  ìˆ˜ ìˆë„ë¡ @Converter, AttributeConverterë¥¼ ì œê³µí•œë‹¤. ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ DBì˜ Article í…Œì´ë¸” category ì»¬ëŸ¼ì— Mì´ ì €ì¥ëœë‹¤. ì¥ì  ìƒˆë¡œìš´ ê°’ì„ ì¶”ê°€í•˜ê±°ë‚˜ ìƒìˆ˜ëª…ì„ ë°”ê¾¼ë‹¤ í•˜ë”ë¼ë„ ê¸°ì¡´ ë°ì´í„°ì— ì§€ì¥ì„ ì£¼ì§€ì•ŠëŠ”ë‹¤. í•˜ë‚˜ì˜ ì—”í‹°í‹° ì†ì„±ìœ¼ë¡œ DB ì»¬ëŸ¼ê³¼ ë§µí•‘ë  ìˆ˜ ìˆë‹¤. êµ³ì´ ë‹¨ì (?)ì´ë¼ê³  í•œë‹¤ë©´ ë¶€ê°€ì ì¸ ì½”ë“œ(ìƒì„±ì, getter ë“±)ê°€ ì¶”ê°€ëœë‹¤ëŠ” ì  ì¼ê²ƒ ê°™ë‹¤.public enum Category { SPORT(\"S\"), MUSIC(\"M\"), TECHNOLOGY(\"T\"); private String code; private Category(String code) { this.code = code; } public String getCode() { return code; }}@Entitypublic class Article { @Id private int id; private String title; private Category category;}@Converter(autoApply = true) // Category íƒ€ì…ìœ¼ë¡œ ì„ ì–¸ëœ í•„ë“œì— ìë™ìœ¼ë¡œ ì»¨ë²„íŒ… ì ìš©public class CategoryConverter implements AttributeConverter&lt;Category, String&gt; { @Override public String convertToDatabaseColumn(Category category) { if (category == null) { return null; } return category.getCode(); } @Override public Category convertToEntityAttribute(String code) { if (code == null) { return null; } return Stream.of(Category.values()) .filter(c -&gt; c.getCode().equals(code)) .findFirst() .orElseThrow(IllegalArgumentException::new); }}Article article = new Article();article.setId(4);article.setTitle(\"converted title\");article.setCategory(Category.MUSIC);ê·¸ëŸ¼ ë¬´ì¡°ê±´ @Converterë¥¼ ì‚¬ìš©í•˜ë©´ ë ê¹Œ? ìœ„ ë‚´ìš©ì„ ê³µë¶€ë¥¼ í•˜ê³  ë‚œ ë’¤ ì¸í”„ëŸ° ê¹€ì˜í•œë‹˜ ê°•ì˜ ë¥¼ ë“£ë˜ ì¤‘@Enumerated(EnumType.String)ì„ ì‚¬ìš©í•˜ì‹œëŠ” ê²ƒì„ ë³´ê³  ì§ˆë¬¸ì„ ë‚¨ê²¼ê³  ê°“ì˜í•œë‹˜ì˜ ë‹µë³€ì„ ë“¤ì„ ìˆ˜ ìˆì—ˆë‹¤.[ì§ˆë¬¸]ì•ˆë…•í•˜ì„¸ìš” ì„ ìƒë‹˜ ê°•ì˜ ì¬ë°Œê²Œ ì˜ ë“£ê³  ìˆìŠµë‹ˆë‹¤ !ê°•ì˜ë¥¼ ë“£ê¸° ì „ì— ìŠ¤ìŠ¤ë¡œ ê³ ë¯¼í•´ë³´ëŠ” ì‹œê°„ì„ ê°–ê¸° ìœ„í•´ ê³µë¶€í•˜ë‹¤ê°€@Enumerated(EnumType.String) ê²½ìš°ëŠ” ì„ ì–¸í•œ ìƒìˆ˜ì˜ ì´ë¦„ì´ ë°”ë€Œê²Œ ë˜ë©´(ë°”ë€”ì¼ì€ ë“œë¬¼ê² ì§€ë§Œ)ê¸°ì¡´ì— ì €ì¥ëë˜ ë°ì´í„° ì™€ì˜ ì •í•©ì„± ë¬¸ì œê°€ ìˆê³ ,ë¬¸ìì—´ë¡œ ì„ ì–¸ë˜ì–´ í•„ìš” ì´ìƒìœ¼ë¡œ ë§ì€ ê³µê°„ì„ í• ë‹¹í•˜ê²Œ ëœë‹¤ëŠ” ë¬¸ì œì ì´ ìˆë‹¤ê³  ë´¤ìŠµë‹ˆë‹¤.ê²°ê³¼ì ìœ¼ë¡œ í•´ë‹¹ ê¸€ì—ì„œëŠ” JPA2.1 ë¶€í„° ë„ì…ëœ @Converterë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•œë‹¤ê³  í•˜ëŠ”ë° ì‹¤ë¬´ì—ì„œëŠ” ì–´ë–¤ì§€ ê¶ê¸ˆí•©ë‹ˆë‹¤!í˜¹ì‹œë‚˜ í•´ì„œ í•´ë‹¹ ê¸€ ì¶œì²˜ ë‚¨ê¹ë‹ˆë‹¤ : https://www.baeldung.com/jpa-persisting-enums-in-jpa[ë‹µë³€]ì•ˆë…•í•˜ì„¸ìš”. ì´ì¬ìœ¤ë‹˜ì´ë¶€ë¶„ì€ ì„ íƒì¸ë°ìš”.ì €ì˜ ê²½ìš° ì‹¤ë¬´ì—ì„œë„ @Enumerated(EnumType.String)ì„ ì£¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.@Converterë¥¼ í†µí•´ì„œ ì¢€ ë” ìµœì í™”ë¥¼ í•˜ì…”ë„ ë©ë‹ˆë‹¤. ê·¸ëŸ°ë° ENUMì˜ ê¸¸ì´ê°€ ê·¸ë ‡ê²Œ ê¸´ ê²ƒë„ ì•„ë‹ˆê³ ,ìµœê·¼ DB ì„±ëŠ¥ë„ ì¢‹ì•„ì„œ ì´ ë¶€ë¶„ì„ ìµœì í™”í•´ë„ í¬ê²Œ ë§ì€ ì´ì ì„ ì–»ì§€ëŠ” ëª»í•©ë‹ˆë‹¤.ê°ì‚¬í•©ë‹ˆë‹¤.ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ JPA Entity ë¼ì´í”„ì‚¬ì´í´ @Transient, @Basic ë“±ê³¼ ì˜ì†ì„±ì°¸ê³ ìë£Œ https://www.baeldung.com/jpa-persisting-enums-in-jpa https://www.baeldung.com/jpa-entity-lifecycle-events" }, { "title": "WEB - HTTPì˜ ì—°ê²°ëª¨ë¸", "url": "/posts/http-connection-model/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "WEB", "date": "2021-06-30 00:25:00 +0900", "snippet": " connection management allows considerable boosting of performance in HTTPShort-lived connections HTTP í†µì‹ ì„ í•œ ë²ˆ í•  ë•Œë§ˆë‹¤ TCPì— ì˜í•´ ì—°ê²°/ì¢…ë£Œ ëœë‹¤. ë”°ë¼ì„œ, ë§¤ í†µì‹  ë§ˆë‹¤ ìƒˆë¡œìš´ ì—°ê²°ì„ ë§ºì–´ì•¼í•œë‹¤. ì´ˆê¸° í†µì‹ ì—ì„œëŠ” ì‘ì€ ì‚¬ì´ì¦ˆì˜ í…ìŠ¤íŠ¸ë¥¼ ë³´ë‚´ëŠ” ì •ë„ì˜€ê¸°...", "content": " connection management allows considerable boosting of performance in HTTPShort-lived connections HTTP í†µì‹ ì„ í•œ ë²ˆ í•  ë•Œë§ˆë‹¤ TCPì— ì˜í•´ ì—°ê²°/ì¢…ë£Œ ëœë‹¤. ë”°ë¼ì„œ, ë§¤ í†µì‹  ë§ˆë‹¤ ìƒˆë¡œìš´ ì—°ê²°ì„ ë§ºì–´ì•¼í•œë‹¤. ì´ˆê¸° í†µì‹ ì—ì„œëŠ” ì‘ì€ ì‚¬ì´ì¦ˆì˜ í…ìŠ¤íŠ¸ë¥¼ ë³´ë‚´ëŠ” ì •ë„ì˜€ê¸° ë•Œë¬¸ì— ë³„ ë¬¸ì œê°€ ë˜ì§€ ì•Šì•˜ë‹¤. í•˜ì§€ë§Œ, HTTPê°€ ë„ë¦¬ ë³´ê¸‰ë˜ì–´ê°ì— ë”°ë¼ í•˜ë‚˜ì˜ HTML ë¬¸ì„œì— ì—¬ëŸ¬ ì´ë¯¸ì§€, js íŒŒì¼ ë“±ì´ í¬í•¨ë˜ê³  ê·¸ê²ƒë“¤ì„ íšë“í•˜ê¸° ìœ„í•´ ì—¬ëŸ¬ë²ˆ ìš”ì²­ì„ ë³´ë‚´ì•¼í•œë‹¤. ì¦‰, ì•„ë˜ì™€ ê°™ì€ í”„ë¡œì„¸ìŠ¤ë¥¼ ë§¤ ìš”ì²­ë§ˆë‹¤ ë°˜ë³µí•´ì•¼ í•˜ëŠ” ê²ƒì´ë‹¤.ì¥/ë‹¨ì ì¥ì  CPU, ë©”ëª¨ë¦¬ì™€ ê°™ì€ ì„œë²„ì˜ ìì›ì„ ì§€ì†ì ìœ¼ë¡œ ì ìœ í•˜ì§€ ì•ŠëŠ”ë‹¤.ë‹¨ì  ë§¤ ìš”ì²­ë§ˆë‹¤ TCP ì—°ê²°/ì¢…ë£Œê°€ ë°œìƒí•˜ê¸° ë•Œë¬¸ì— í†µì‹ ëŸ‰ì´ ëŠ˜ì–´ë‚˜ê²Œ ëœë‹¤.Persistent Connection HTTP/1.1ê³¼ ì¼ë¶€ HTTP/1.0ì—ì„œëŠ” TCP ì—°ê²° ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ â€˜ì§€ì†ì—°ê²°â€™ ì´ë¼ëŠ” ë°©ë²•ì„ ê³ ì•ˆí–ˆë‹¤. ì–´ëŠ í•œìª½ì´ ëª…ì‹œì ìœ¼ë¡œ ì—°ê²°ì„ ì¢…ë£Œí•˜ì§€ ì•ŠëŠ” ì´ìƒ TCP ì—°ê²°ì„ ê³„ì† ìœ ì§€í•œë‹¤. HTTP/1.1ì—ì„œëŠ” í‘œì¤€ ë™ì‘ì´ì§€ë§Œ HTTP/1.0ì—ì„œëŠ” ì •ì‹ ì‚¬ì–‘ì´ ì•„ë‹ˆì—ˆë‹¤. í´ë¼ì´ì–¸íŠ¸, ì„œë²„ ëª¨ë‘ ì§€ì† ì—°ê²°ì„ ì§€ì›í•´ì•¼ ì§€ì† ì—°ê²°ì´ ê°€ëŠ¥í•˜ë‹¤. ì¶œì²˜ : https://developer.mozilla.org/en-US/docs/Web/HTTP/Connection_management_in_HTTP_1.xì¥/ë‹¨ì ì¥ì  TCP ì—°ê²°/ì¢…ë£Œì— ëŒ€í•œ ì˜¤ë²„í—¤ë“œê°€ ì¤„ì–´ë“¤ê¸° ë•Œë¬¸ì— ì„œë²„ì— ëŒ€í•œ ë¶€í•˜ê°€ ê²½ê°ëœë‹¤. ì˜¤ë²„í—¤ë“œë¥¼ ì¤„ì¸ ë§Œí¼ HTTP ìš”ì²­/ì‘ë‹µì´ ë” ë¹ ë¥´ê²Œ ì´ë£¨ì–´ì§„ë‹¤. ì—¬ëŸ¬ ìš”ì²­ì„ ë³‘í–‰í•´ì„œ ë³´ë‚¼ ìˆ˜ ìˆë‹¤. ì¦‰, ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì´ ì˜¤ê¸°ì „ì— ë‹¤ë¥¸ ìš”ì²­ì„ ë˜ ë³´ë‚¼ ìˆ˜ ìˆë‹¤(íŒŒì´í”„ë¼ì¸í™”) ìƒˆë¡œìš´ ì—°ê²° ë° TLS í•¸ë“œì…°ì´í¬ ê°ì†Œë¡œ CPU ì‚¬ìš©ëŸ‰ ë° ì™•ë³µì´ ê°ì†Œí•œë‹¤.ë‹¨ì  í•„ìš”í•œ ëª¨ë“  ë°ì´í„°ê°€ ìˆ˜ì‹ ë˜ì—ˆì„ ë•Œ í´ë¼ì´ì–¸íŠ¸ê°€ ì—°ê²°ì„ ë‹«ì§€ ì•Šìœ¼ë©´ ì„œë²„ì—ì„œ ì—°ê²°ì„ ìœ ì§€í•˜ëŠ” ë° í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ë‹¤ë¥¸ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ì—†ê²Œ ëœë‹¤. ì„œë²„ê°€ TCP ì—°ê²°ì„ ë‹«ëŠ” ë™ì‹œì— í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ì— ìš”ì²­ì„ ì „ì†¡í•˜ëŠ” ê²½ìš°, ê²½í•© ì¡°ê±´(race condition)ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ, ì„œë²„ëŠ” ì—°ê²°ì„ ë‹«ê¸° ì§ì „ì— í´ë¼ì´ì–¸íŠ¸ì— 408 Request Timeout ìƒíƒœ ì½”ë“œë¥¼ ì „ì†¡í•´ì•¼ í•˜ë©°,ìš”ì²­ì„ ì „ì†¡í•œ í›„ í´ë¼ì´ì–¸íŠ¸ê°€ 408 ìƒíƒœ ì½”ë“œë¥¼ ìˆ˜ì‹ í•˜ë©´ ì„œë²„ì— ëŒ€í•œ ìƒˆ ì—°ê²°ì„ ì—´ê³  ìš”ì²­ì„ ë‹¤ì‹œ ë³´ë‚¼ ìˆ˜ ìˆë‹¤. ì¼ë¶€ í´ë¼ì´ì–¸íŠ¸ëŠ” ìš”ì²­ì„ ì¬ì „ì†¡í•˜ì§€ ì•Šìœ¼ë©°, ìš”ì²­ì„ ì¬ì „ì†¡í•˜ëŠ” ë§ì€ í´ë¼ì´ì–¸íŠ¸ëŠ” ìš”ì²­ì— ì—­ HTTP ë©”ì„œë“œê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ ì¬ì „ì†¡í•œë‹¤. ê³¼ë¶€í•˜ ìƒíƒœì—ì„œëŠ” DoS ê³µê²©ì„ ë‹¹í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.keep-alive Connection : keep-alive HTTP í—¤ë” ì†ì„± ì¤‘ í•˜ë‚˜ì´ë‹¤. HTTP 1.0ì—ì„œëŠ” keep-alive í—¤ë”ê°€ í¬í•¨ë˜ì§€ ì•ŠëŠ” í•œ ì—°ê²°ì´ ì§€ì†ë˜ì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ê°„ì£¼ë˜ì—ˆë‹¤. HTTP 1.1ì—ì„œëŠ” ê¸°ë³¸ ì†ì„±ì´ ë˜ì—ˆë‹¤. ì›í•˜ì§€ ì•ŠëŠ” ê²½ìš°ì—” Connection : closeë¥¼ í—¤ë”ì— ì¶”ê°€í•˜ë©´ â€˜Short-lived connectionsâ€™ ì—°ê²° ëª¨ë¸ì„ ì‚¬ìš©í•œë‹¤. keep-alive Timeout Socketì— I/O Accessê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ ì¢…ë£Œëœ ì‹œì ë¶€í„° ì •ì˜ëœ ì‹œê°„ê¹Œì§€ Accessê°€ ì—†ë”ë¼ë„ ì„¸ì…˜ì„ ìœ ì§€í•˜ëŠ” êµ¬ì¡°ì´ë‹¤. ì„œë²„ ìì›ì€ ìœ í•œí•˜ê¸° ë•Œë¬¸ì—, ì—¬ëŸ¬ ê°œì˜ ì»¤ë„¥ì…˜ì„ ê³„ì† ìœ ì§€í•˜ê²Œ ë˜ë©´ ì„œë²„ì˜ ê°€ìš©ì„±ì„ ë–¨ì–´ëœ¨ë¦´ ìˆ˜ ìˆë‹¤. HTTP pipelining ì»¤ë„¥ì…˜ ì§€ì—°ì„ íšŒí”¼í•˜ê³ ì ê°™ì€ ì˜ì†ì ì¸ ì»¤ë„¥ì…˜ì„ í†µí•´ì„œ, ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ì§€ ì•Šê³  ìš”ì²­ì„ ì—°ì†ì ìœ¼ë¡œ ë³´ë‚´ëŠ” ê¸°ëŠ¥ì´ë‹¤. GET, HEAD, PUT, DELETE ë©”ì„œë“œê°™ì€ idempotent(ë©±ë“±í•œ) ë©”ì„œë“œë§Œ ê°€ëŠ¥í•˜ë‹¤(POSTëŠ” ë¶ˆê°€ëŠ¥).ì™œëƒí•˜ë©´ ì‹¤íŒ¨ê°€ ë°œìƒí•œ ê²½ìš°ì—ëŠ” ë‹¨ìˆœíˆ íŒŒì´í”„ë¼ì¸ ì»¨í…ì¸ ë¥¼ ë‹¤ì‹œ ë°˜ë³µí•˜ë©´ ë˜ê¸° ë•Œë¬¸ì´ë‹¤. ëŒ€ë¶€ë¶„ì˜ ëª¨ë˜ ë¸Œë¼ìš°ì €ëŠ” ì´ ê¸°ëŠ¥ì„ ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”í•˜ì§€ ì•ŠëŠ”ë‹¤. ëª¨ë“  HTTP/1.1 í˜¸í™˜ í”„ë¡ì‹œì™€ ì„œë²„ë“¤ì€ íŒŒì´í”„ë¼ì´ë‹ì„ ì§€ì›í•´ì•¼ í•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ë§ì€ í”„ë¡ì‹œì™€ ì„œë²„ë“¤ì€ ì œí•œì„ ê°€ì§€ê³  ìˆë‹¤. ë²„ê·¸ê°€ ìˆëŠ” í”„ë¡ì‹œë“¤ì´ ë§ì€ë°, ì´ë“¤ì€ ì›¹ ê°œë°œìë“¤ì´ ì‰½ê²Œ ì˜ˆìƒí•˜ê±°ë‚˜ ë¶„ì„í•˜ê¸° í˜ë“  ì´ìƒí•˜ê³  ì˜¤ë¥˜ê°€ ìˆëŠ” ë™ì‘ì„ ì•¼ê¸°í•œë‹¤. íŒŒì´í”„ë¼ì´ë‹ì€ ì •í™•íˆ êµ¬í˜„í•´ë‚´ê¸° ë³µì¡í•©ë‹ˆë‹¤: ì „ì†¡ ì¤‘ì¸ ë¦¬ì†ŒìŠ¤ì˜ í¬ê¸°, ì‚¬ìš©ë  íš¨ê³¼ì ì¸ RTT, ê·¸ë¦¬ê³  íš¨ê³¼ì ì¸ ëŒ€ì—­í­ì€ íŒŒì´í”„ë¼ì¸ì´ ì œê³µí•˜ëŠ” ì„±ëŠ¥ í–¥ìƒì— ì§ì ‘ì ìœ¼ë¡œ ì˜í–¥ì„ ë¯¸ì¹œë‹¤. íŒŒì´í”„ë¼ì´ë‹ì€ HOL(Head-of-line blocking) ë¬¸ì œì— ì˜í–¥ì„ ë°›ìŠµë‹ˆë‹¤. ì´ëŸ° ì´ìœ ë“¤ë¡œ, íŒŒì´í”„ë¼ì´ë‹ì€ ë” ë‚˜ì€ ì•Œê³ ë¦¬ì¦˜ì¸ ë©€í‹°í”Œë ‰ì‹±ìœ¼ë¡œ ëŒ€ì²´ë˜ì—ˆëŠ”ë°, ì´ëŠ” HTTP/2ì—ì„œ ì‚¬ìš©ëœë‹¤. â€» HOL(Head-of-line blocking) : ë‹¨ì¼ TCP ì—°ê²°ì—ì„œ, ì´ì „ ìš”ì²­ì´ ì™„ë£Œë  ë•Œê¹Œì§€ ì´í›„ì˜ ìš”ì²­ì´ ê¸°ë‹¤ë ¤ì•¼ í•˜ëŠ” ê²ƒ ì¶œì²˜ : https://developer.mozilla.org/en-US/docs/Web/HTTP/Connection_management_in_HTTP_1.xMultiplexing ì—¬ëŸ¬ê°€ì§€ì˜ ìì›ì„ í•œ ë²ˆì˜ ìš”ì²­ì„ í†µí•´ ë°›ì„ ìˆ˜ ìˆì–´ clientë§ˆë‹¤ í•˜ë‚˜ì˜ TCP connectionì´ë©´ ì¶©ë¶„í•˜ë‹¤ëŠ” ê°œë…ì´ë‹¤ HTTP2.0ë¶€í„° ì§€ì› ê°€ëŠ¥í•˜ê²Œëœ ë°°ê²½ HTTP2ì—ì„œëŠ” ë°ì´í„°ë¥¼ ì „ì†¡í•  ë•Œ, ì¼ë°˜ ë¬¸ìì—´ì´ ì•„ë‹Œ ë°”ì´ë„ˆë¦¬ë¡œ ì¸ì½”ë”©í•˜ì—¬ ì „ì†¡í•œë‹¤. ë°”ì´ë„ˆë¦¬ í¬ë§·ì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ê²Œ ë˜ì–´, ì´ì „ì—ëŠ” í•˜ë‚˜ë¡œ ëª¨ì—¬ìˆë˜ ë°ì´í„°ë¥¼ í”„ë ˆì„ì´ë¼ëŠ” ë‹¨ìœ„ë¡œ ë‚˜ëˆ ì„œ ê´€ë¦¬ / ì „ì†¡í•  ìˆ˜ ìˆê²Œë˜ì—ˆë‹¤. HTTP2ì—ì„œëŠ” Frameê³¼ Streamì´ë¼ëŠ” ê°œë…ì´ ì¶”ê°€ë˜ì—ˆë‹¤. Frameì€ HTTP2 í†µì‹ ì—ì„œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ì„ ìˆ˜ ìˆëŠ” ê°€ì¥ ì‘ì€ ë‹¨ìœ„ì´ë‹¤. í—¤ë” í”„ë ˆì„, ë°ì´í„° í”„ë ˆì„ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. ìŠ¤íŠ¸ë¦¼ì€ í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ ì‚¬ì´ì— ë§ºì–´ì§„ ì—°ê²°ì„ í†µí•´ ì–‘ë°©í–¥ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” í•œê°œ ì´ìƒì˜ ë©”ì‹œì§€ë¥¼ ì˜ë¯¸í•œë‹¤. ë©”ì‹œì§€ëŠ” HTTP1.1ì²˜ëŸ¼ ìš”ì²­ê³¼ ì‘ë‹µì˜ ë‹¨ìœ„ì´ë‹¤. ë©”ì‹œì§€ëŠ” ë‹¤ìˆ˜ì˜ Frameìœ¼ë¡œ êµ¬ì„±ë˜ì–´ ìˆë‹¤. ì¦‰, í”„ë ˆì„ â†’ ë©”ì‹œì§€ â†’ ìŠ¤íŠ¸ë¦¼ì´ ë˜ëŠ” êµ¬ì¡°ì´ë‹¤ ì¶œì²˜ : https://developers.google.com/web/fundamentals/performance/http2 HTTP2ì—ì„œëŠ” ìŠ¤íŠ¸ë¦¼ í•˜ë‚˜ê°€ ë‹¤ìˆ˜ê°œì˜ ìš”ì²­ê³¼ ì‘ë‹µì„ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ” êµ¬ì¡°ë¡œ ë°”ë€Œì—ˆë‹¤. HTTP1 ì‹œì ˆì—ëŠ”, ìš”ì²­ê³¼ ì‘ë‹µì´ ë©”ì‹œì§€ë¼ëŠ” ë‹¨ìœ„ë¡œ ì™„ë²½í•˜ê²Œ êµ¬ë¶„ë˜ì–´ ìˆì—ˆì§€ë§Œ, HTTP2ì—ì„œëŠ” ìŠ¤íŠ¸ë¦¼ì´ë¼ëŠ” ë‹¨ìœ„ë¡œ ìš”ì²­ê³¼ ì‘ë‹µì´ ë¬¶ì¼ ìˆ˜ ìˆëŠ” êµ¬ì¡°ê°€ ë§Œë“¤ì–´ì¡Œë‹¤. ë”°ë¼ì„œ, ì‘ë‹µ í”„ë ˆì„ë“¤ì€ ìš”ì²­ ìˆœì„œì— ìƒê´€ì—†ì´ ë§Œë“¤ì–´ì§„ ìˆœì„œëŒ€ë¡œ í´ë¼ì´ì–¸íŠ¸ì— ì „ë‹¬ë  ìˆ˜ ìˆë‹¤. ê²°ê³¼ì ìœ¼ë¡œ, HTTP1 ë•Œì²˜ëŸ¼ ì¤‘ê°„ì— ì‘ë‹µì´ ë§‰íˆë©´ ëŒ€ê¸°í•˜ê³  ìˆë˜ Responseë“¤ì´ ëª¨ë‘ ê¸°ë‹¤ë ¤ì•¼í•˜ëŠ” HOL ì´ìŠˆì—ì„œ ë²—ì–´ë‚  ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤. ì¶œì²˜ : https://developers.google.com/web/fundamentals/performance/http2 ì¶œì²˜ : https://www.programmersought.com/article/86161816904/ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ TCP/IP HTTP2, HTTP3 HTTP Connection Poolingì°¸ê³  ìë£Œ ìš°ì—ë…¸ ì„¼, ã€ê·¸ë¦¼ìœ¼ë¡œ ë°°ìš°ëŠ” Http &amp; Network Basicã€, ì˜ì§„ë‹·ì»´(2015) https://www.tutorialspoint.com/Connectionless-Services https://en.wikipedia.org/wiki/HTTP_persistent_connection https://developer.mozilla.org/en-US/docs/Web/HTTP/Connection_management_in_HTTP_1.x https://goodgid.github.io/HTTP-Keep-Alive/ https://nuli.navercorp.com/community/article/1132452?email=true https://americanopeople.tistory.com/115 https://developers.google.com/web/fundamentals/performance/http2" }, { "title": "Message Broker ë¹„êµí•´ë³´ê¸°", "url": "/posts/message-broker-comparison/", "categories": "", "tags": "", "date": "2021-06-29 00:25:00 +0900", "snippet": " â€˜ë‚˜ë§Œì˜ ì›¨ë”© í”Œë˜ë„ˆâ€™ë¼ëŠ” MSA ê¸°ë°˜ì˜ í† ì´ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ”ë° í•„ìš”í•œ Message Brokerë¥¼ ì„ íƒí•˜ê¸° ìœ„í•´ëª‡ ê°€ì§€ Message Brokerì— ëŒ€í•´ ì•Œì•„ë³´ê³  ê²°ì •í•˜ìRabbitMQ 2007ë…„ì— ì¶œì‹œë˜ì—ˆìœ¼ë©° ê°€ì¥ ë¨¼ì € ë§Œë“¤ì–´ì§„ ë©”ì‹œì§€ ë¸Œë¡œì»¤ ì¤‘ í•˜ë‚˜ì´ë‹¤. Erlangìœ¼ë¡œ ê°œë°œë˜ì—ˆìœ¼ë©°, Erlangì€ ê¸°ë³¸ì ìœ¼ë¡œ Erlang í´ëŸ¬ìŠ¤í„° ë…¸ë“œ...", "content": " â€˜ë‚˜ë§Œì˜ ì›¨ë”© í”Œë˜ë„ˆâ€™ë¼ëŠ” MSA ê¸°ë°˜ì˜ í† ì´ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ”ë° í•„ìš”í•œ Message Brokerë¥¼ ì„ íƒí•˜ê¸° ìœ„í•´ëª‡ ê°€ì§€ Message Brokerì— ëŒ€í•´ ì•Œì•„ë³´ê³  ê²°ì •í•˜ìRabbitMQ 2007ë…„ì— ì¶œì‹œë˜ì—ˆìœ¼ë©° ê°€ì¥ ë¨¼ì € ë§Œë“¤ì–´ì§„ ë©”ì‹œì§€ ë¸Œë¡œì»¤ ì¤‘ í•˜ë‚˜ì´ë‹¤. Erlangìœ¼ë¡œ ê°œë°œë˜ì—ˆìœ¼ë©°, Erlangì€ ê¸°ë³¸ì ìœ¼ë¡œ Erlang í´ëŸ¬ìŠ¤í„° ë…¸ë“œì˜ ì¿ í‚¤ë¥¼ ë™ê¸°í™”í•˜ì—¬ ë¶„ì‚° ì»´í“¨íŒ…ì„ ì§€ì›í•œë‹¤. ë”°ë¼ì„œ, Zookeeperì™€ ê°™ì€ third-party í´ëŸ¬ìŠ¤í„° ê´€ë¦¬ìë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. í´ëŸ¬ìŠ¤í„°ì—ëŠ” ì¼ë°˜ í´ëŸ¬ìŠ¤í„° ëª¨ë“œì™€ ë¯¸ëŸ¬ í´ëŸ¬ìŠ¤í„° ëª¨ë“œì˜ ë‘ ê°€ì§€ ëª¨ë“œê°€ ìˆë‹¤. priority queuing, delay queuingê³¼ ê°™ì€ ë‹¤ì–‘í•œ ê¸°ëŠ¥ ì œê³µ ì˜ì†ì„± : ì˜êµ¬ ë° ì„ì‹œ ë©”ì‹œì§€ê°€ ëª¨ë‘ ì§€ì› AMQP(Advanced Message Queuing Protocol)ë¥¼ êµ¬í˜„í•œë‹¤. ë”°ë¼ì„œ, STOMP, MQTT, WebSocketsê³¼ ê°™ì€ ë‹¤ì–‘í•œ í”„ë¡œí† ì½œì„ ì§€ì›í•œë‹¤. ì ëŒ€ì , ìš”ì²­/ì‘ë‹µ, pub/sub ëª¨ë¸ ëª¨ë‘ ì§€ì› (ë™ê¸°, ë¹„ë™ê¸° í†µì‹  ëª¨ë‘ ì§€ì›) RabbitMQ ì‚¬ìš©ìëŠ” ë©”ì‹œì§€ ì „ë‹¬ì„ ìœ„í•œ ì •êµí•œ ê·œì¹™ì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤(ë³´ì•ˆ, ì¡°ê±´ë¶€ ë¼ìš°íŒ… ë“±) ê°•ë ¥í•œ ì¸ì¦ ë° í‘œí˜„ì‹ ê¸°ë°˜ì˜ ì¸ê°€ë¥¼ ê°–ëŠ”ë‹¤. ê´€ë¦¬ìê°€ ìŠ¤íŠ¸ë¦¼ ê¸°ë¡ì— ì•¡ì„¸ìŠ¤í•˜ë ¤ëŠ” ê²½ìš°, ì•„íŒŒì¹˜ ì¹´ì‚°ë“œë¼ì™€ ì¢…ì¢… í•¨ê»˜ ì‚¬ìš©ëœë‹¤. ë””ìŠ¤í¬ì— ë©”ì‹œì§€ë¥¼ ì €ì¥í•  ìˆ˜ ìˆì§€ë§Œ ë©”ì‹œì§€ì˜ ìˆœì„œê°€ ë³´ì¥ë˜ì§€ëŠ” ì•ŠëŠ”ë‹¤. í ëª¨ë‹ˆí„°ë§ì„ ìœ„í•œ GUIì™€ ìµœì ì˜ REST APIë¥¼ ì œê³µí•œë‹¤. RabbitMQëŠ” í ë¯¸ëŸ¬ë§ì„ í†µí•´ ê³ ê°€ìš©ì„±ì„ ì‹¤í˜„í•œë‹¤. RabbitMQì˜ í ê°œë…ì€ Kafkaì˜ íŒŒí‹°ì…˜ê³¼ ìœ ì‚¬í•˜ë‹¤. complex routingì„ ì§€ì›í•˜ëŠ” ë§ì€ ê¸°ëŠ¥ì„ ê°–ì¶”ê³  ìˆë‹¤. master-slave êµ¬ì¡°ë¥¼ ê°–ëŠ”ë‹¤ RabbitMQì˜ ì•„í‚¤í…ì²˜ëŠ” ì™„ë²½í•œ ë³µì œ ì„¤ê³„ë¡œ ì¸í•´ í™•ì¥ì„±ì´ ë–¨ì–´ì§„ë‹¤. ì¶œì²˜ : https://www.researchgate.net/publication/347866161_A_Fair_Comparison_of_Message_Queuing_SystemsActiveMQ JMS(Java Message Service) í´ë¼ì´ì–¸íŠ¸ì™€ í•¨ê»˜ Javaë¡œ ì‘ì„±ë˜ì—ˆë‹¤. ì´ë¥¼ í†µí•´ OpenWire, STOMP, REST, XMPP, AMQPì™€ ê°™ì€ ë‹¤ì–‘í•œ í†µì‹  í”„ë¡œí† ì½œì„ ì§€ì›í•œë‹¤. master-slave êµ¬ì¡°ë¥¼ ê°–ëŠ”ë‹¤ master ë¸Œë¡œì»¤ë§Œ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•  ìˆ˜ ìˆë‹¤. slave ë¸Œë¡œì»¤ëŠ” master ë¸Œë¡œì»¤ì™€ ë™ê¸°í™”í•˜ë©°, ì˜¤ë¥˜ë¡œ ì¸í•´ masterê°€ ë¶ˆëŠ¥ì´ ë˜ë©´, Zookeeperê°€ slave ì¤‘ ìƒˆë¡œìš´ masterë¥¼ ì„ íƒí•œë‹¤. pub/sub, ì ëŒ€ì  ëª¨ë¸ì„ ëª¨ë‘ ì§€ì›í•œë‹¤. íì™€ í† í”½ì„ ë‹¤ë¥´ê²Œ ê´€ë¦¬í•œë‹¤. í† í”½ì— ëŒ€í•œ ë©”ì„¸ì§€ ìˆœì„œ ë³´ì¥ì€ ì—†ë‹¤. ë°˜ë©´, íëŠ” Exclusive Queueë¥¼ ì‚¬ìš©í•¨ìœ¼ë¡œì¨ ë©”ì„¸ì§€ ìˆœì„œê°€ ë³´ì¥ëœë‹¤. íì— ëŒ€í•´ì„œëŠ” ìµœì†Œ í•œë²ˆì˜ ì „ë‹¬ì´ ë³´ì¥ë˜ë©°, í† í”½ì˜ ê²½ìš°ì— ì „ë‹¬ì´ ë³´ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤. íì— ìˆëŠ” ë©”ì„¸ì§€ëŠ” ë””ìŠ¤í¬ íŒŒì¼ì´ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥ë˜ì§€ë§Œ, í† í”½ì— ìˆëŠ” ë©”ì„¸ì§€ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ë³´ì¡´ë˜ì§€ ì•ŠëŠ”ë‹¤. JMSëŠ” ë©”ì‹œì§• ë¯¸ë“¤ì›¨ì–´ì˜ ìƒ¤ë”© ë©”ì»¤ë‹ˆì¦˜ì„ ëª…ì‹œí•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ìƒ¤ë”© ê¸°ëŠ¥ì´ ì—†ìœ¼ë©°, ì‚¬ìš©ìê°€ í•„ìš”ì— ë”°ë¼ ì§ì ‘ êµ¬í˜„í•´ì•¼ í•œë‹¤. ì¶œì²˜ : https://www.researchgate.net/publication/347866161_A_Fair_Comparison_of_Message_Queuing_SystemsApache Kafka 2011ë…„ Linkedinì—ì„œ ë†’ì€ ì²˜ë¦¬ëŸ‰ê³¼ ì§§ì€ ì§€ì—° ì‹œê°„ ì²˜ë¦¬ë¥¼ ë‹¤ë£¨ê¸° ìœ„í•´ ë§Œë“¤ì—ˆë‹¤. peer-to-peer êµ¬ì¡°ë¥¼ ê°–ëŠ”ë‹¤. ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì¥ê¸°ê°„ ì €ì¥í•˜ë„ë¡ êµ¬ì¶•ëœ ë†’ì€ ì²˜ë¦¬ëŸ‰ ë¶„ì‚° í ì‹œìŠ¤í…œì´ë‹¤. ë¶„ì‚° ìŠ¤íŠ¸ë¦¬ë° í”Œë«í¼ì¸ KafkaëŠ” pub/sub ì„œë¹„ìŠ¤ë¥¼ ë³µì œí•œë‹¤. ì˜ì†ì„±ì´ ìš”êµ¬ë˜ëŠ” ì¼ëŒ€ë‹¤ ìƒí™©ì— ì´ìƒì ì´ë‹¤. pub/sub ëª¨ë¸ì„ ì‚¬ìš©í•˜ì§€ë§Œ publisher ëŒ€ì‹  producerë¥¼ subscriber ëŒ€ì‹  consumerë¼ëŠ” ìš©ì–´ë¥¼ ì‚¬ìš©í•œë‹¤. í† í”½ì„ íŒŒí‹°ì…˜ìœ¼ë¡œ ë¶„í• í•  ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´, ì—¬ëŸ¬ ì»¨ìŠˆë¨¸ê°€ ìŠ¤íŠ¸ë¦¼ì˜ ì¼ë¶€ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆê³  ìˆ˜í‰ ìŠ¤ì¼€ì¼ë§ì„ ê°€ëŠ¥í•˜ê²Œ í•´ì¤€ë‹¤. ì¹´í”„ì¹´ëŠ” ë©”ì‹œì§€ê°€ ë°°ì¹˜ë  ë•Œ ê°€ì¥ ì˜ ì‘ë™í•œë‹¤. ì¦‰, ì‘ì€ ë©”ì‹œì§€ë¥¼ ë§ì´ ìˆ˜ì‹ í•˜ëŠ” ëŒ€ì‹  ëŒ€ê·œëª¨ ë°ì´í„° ë°°ì¹˜ë¡œ ì ê²Œ ìˆ˜ì‹ í•˜ë¯€ë¡œì¨ ì„±ëŠ¥ì´ í–¥ìƒëœë‹¤. ê°€ì¥ ì‘ì€ ë°°ì¹˜ì˜ í¬ê¸°ëŠ” 100ë°”ì´íŠ¸, ê°€ê¸‰ì ì´ë©´ 1-10KBê°€ ì¢‹ë‹¤. ë°°ì¹˜ í¬ê¸°ê°€ í´ìˆ˜ë¡ êµ¬í˜„ì— ë”°ë¼ ì§€ì—° ì‹œê°„ì´ ì•½ê°„ ì¦ê°€í•œë‹¤(ì¼ë°˜ì ìœ¼ë¡œ ëª‡ ë°€ë¦¬ì´ˆ) í•˜ë‚˜ì˜ íŒŒí‹°ì…˜ ë‚´ì˜ ë©”ì„¸ì§€ëŠ” ìˆœì„œê°€ ë³´ì¥ëœë‹¤. ê¸°ë³¸ì ìœ¼ë¡œ ìµœì†Œ í•œë²ˆì˜ ì „ë‹¬ì„ ë³´ì¦í•˜ë©°, producerê°€ ë¹„ë™ê¸°ì‹ìœ¼ë¡œ ì œì¶œí•˜ë„ë¡ ì„¤ì •í•˜ë©´ ìµœëŒ€ í•œ ë²ˆê¹Œì§€ ì „ë‹¬ì„ ë³´ì¦í•œë‹¤. ëª¨ë‹ˆí„°ë§ì„ ìœ„í•´ GUIê°€ ì‚¬ì „ ì œê³µë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì¼ë°˜ì ìœ¼ë¡œ Kibanaë¥¼ í•¨ê»˜ ì‚¬ìš©í•œë‹¤. ì¶œì²˜ : https://www.researchgate.net/publication/347866161_A_Fair_Comparison_of_Message_Queuing_SystemsRedis ê³ ì„±ëŠ¥ key-value ì €ì¥ì†Œ ë˜ëŠ” ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” in-memory ì €ì¥ì†Œì´ë‹¤. ì˜ì†ì„±ì´ ì—†ì§€ë§Œ Disk/DBì— ë©”ëª¨ë¦¬ë¥¼ ë¤í”„í•œë‹¤. ì‹¤ì‹œê°„ ë°ì´í„° ì²˜ë¦¬ì—ë„ ì´ìƒì ì´ë‹¤. ì›ë˜, ë ˆë””ìŠ¤ëŠ” ì¼ëŒ€ì¼ë„ ì•„ë‹ˆì—ˆê³  ì¼ëŒ€ë‹¤ë„ ì•„ë‹ˆì—ˆë‹¤. í•˜ì§€ë§Œ Redis5.0 pub/subì„ ë„ì…í•˜ë©´ì„œ ê¸°ëŠ¥ì´ í–¥ìƒëê³  ì¼ëŒ€ë‹¤ ì˜µì…˜ì´ ëë‹¤. ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥í•˜ê¸° ë•Œë¬¸ì— ì¹´í”„ì¹´ë³´ë‹¤ë„ ë¹ ë¥´ë‹¤.ë¹„êµí•´ë³´ê¸°ì „ë°˜ì ì¸ íŠ¹ì§• ì¶œì²˜ : https://www.researchgate.net/publication/347866161_A_Fair_Comparison_of_Message_Queuing_Systemsì„±ëŠ¥ì²˜ë¦¬ëŸ‰(Throughput) ì¶œì²˜ : https://www.researchgate.net/publication/347866161_A_Fair_Comparison_of_Message_Queuing_Systems ëª¨ë‘ ë°°ì¹˜ ì²˜ë¦¬ ê¸°ìˆ ì„ ì‚¬ìš©í–ˆë‹¤. ì¦‰,ë©”ì‹œì§€ê°€ ì„ê³„ê°’ì— ë„ë‹¬í•˜ê¸° ìœ„í•´ ëˆ„ì ëœë‹¤. ê· ì¼í•˜ê²Œ ì „ì†¡ë˜ë¯€ë¡œ ì „ì†¡ ì˜¤ë²„í—¤ë“œê°€ ê°ì†Œí•˜ê³  ì²˜ë¦¬ëŸ‰ì´ ì¦ê°€í•œë‹¤. ë”°ë¼ì„œ ë©”ì‹œì§€ í¬ê¸°ê°€ ì»¤ì§ˆìˆ˜ë¡ ë°°ì¹˜ ì²˜ë¦¬ë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ì‹œê°„ì´ ì¤„ì–´ë“¤ê³  ê·¸ì— ë”°ë¼ ì²˜ë¦¬ëŸ‰ë„ ì¦ê°€í•œë‹¤.ì§€ì—°(Latency) ì¶œì²˜ : https://www.researchgate.net/publication/347866161_A_Fair_Comparison_of_Message_Queuing_Systems ì¹´í”„ì¹´ì™€ Rabbit MQëŠ” ë‹¤ë¥¸ ì‹œìŠ¤í…œë³´ë‹¤ ê¸´ ì§€ì—° ì‹œê°„ì„ ë³´ì´ëŠ”ë°, ì´ëŠ” ë°°ì¹˜ ì²˜ë¦¬ë¥¼ ì±„íƒí•˜ì—¬ ì§€ì—° ì‹œê°„ì„ ë†’ì´ëŠ” ëŒ€ì‹  ì²˜ë¦¬ëŸ‰ì„ ê°œì„ í–ˆê¸° ë•Œë¬¸ì´ë‹¤.ë‚˜ì˜ ì„ íƒì€ ? ì†”ì§íˆ, ì•„ì§ í•˜ë‚˜ë„ ì œëŒ€ë¡œ ì¨ë³¸ ê²½í—˜ì´ ì—†ì–´ì„œ ìœ„ì—ì„œ ì¡°ì‚¬í•œ íŠ¹ì§•ë“¤ì´ ì–´ë–¤ ì˜ë¯¸ë¥¼ ê°–ëŠ” ê²ƒì¸ì§€ ì˜ ëª¨ë¥´ê² ë‹¤ .. Kafkaê°€ ì²˜ë¦¬ëŸ‰, ë°ì´í„° ì˜ì†ì„± ë“±ì—ì„œ ìš°ìˆ˜í•œ ê²ƒ ê°™ìœ¼ë‹ˆ Kafkaë¥¼ ë¨¼ì € ê³µë¶€í•˜ê³  ì‚¬ìš©í•´ë³´ë©´ì„œ ì§ì ‘ ëŠê»´ë³´ìë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ ë©”ì„¸ì§€ ë¸Œë¡œì»¤ì— ëŒ€í•œ ì „ë°˜ì ì¸ ì´í•´ Kafkaì°¸ê³  ìë£Œ https://otonomo.io/redis-kafka-or-rabbitmq-which-microservices-message-broker-to-choose/ https://dattell.com/data-architecture-blog/kafka-vs-rabbitmq-how-to-choose-an-open-source-message-broker/ https://www.confluent.io/blog/kafka-fastest-messaging-system/ https://www.researchgate.net/publication/347866161_A_Fair_Comparison_of_Message_Queuing_Systems" }, { "title": "WEB - HTTPì˜ statelessí•œ íŠ¹ì§•ê³¼ ì¿ í‚¤, ì„¸ì…˜", "url": "/posts/stateless-cookie-session/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "WEB", "date": "2021-06-27 00:25:00 +0900", "snippet": " ì¿ í‚¤ì™€ ì„¸ì…˜ì„ ë¹„êµí•˜ë©° íŠ¹ì§•ì„ ì™¸ìš°ê¸°ëŠ” í–ˆì§€ë§Œ, ì •ì‘ ë‚˜ì˜¤ê²Œëœ ë°°ê²½ì— ëŒ€í•´ì„œëŠ” í¬ê²Œ ìƒê°í•´ë³´ì§€ ì•Šì•˜ë˜ ê²ƒ ê°™ë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì„ í†µí•´ ì¿ í‚¤, ì„¸ì…˜ì´ ë‚˜ì˜¤ê²Œ ëœ ë°°ê²½ì¸ HTTPì˜ ë¬´ìƒíƒœì„±ê³¼ ì¿ í‚¤, ì„¸ì…˜ì˜ íŠ¹ì§•ì— ëŒ€í•´ ì •ë¦¬í•´ë³´ì.HTTPì˜ íŠ¹ì§• - Stateless HTTPì˜ ëŒ€í‘œì ì¸ íŠ¹ì§• ì¤‘ í•˜ë‚˜ëŠ” ìƒíƒœë¥¼ ê°–ì§€ ì•ŠëŠ”ë‹¤(Stateless)ëŠ” ê²ƒì´ë‹¤. ...", "content": " ì¿ í‚¤ì™€ ì„¸ì…˜ì„ ë¹„êµí•˜ë©° íŠ¹ì§•ì„ ì™¸ìš°ê¸°ëŠ” í–ˆì§€ë§Œ, ì •ì‘ ë‚˜ì˜¤ê²Œëœ ë°°ê²½ì— ëŒ€í•´ì„œëŠ” í¬ê²Œ ìƒê°í•´ë³´ì§€ ì•Šì•˜ë˜ ê²ƒ ê°™ë‹¤. ì´ë²ˆ í¬ìŠ¤íŒ…ì„ í†µí•´ ì¿ í‚¤, ì„¸ì…˜ì´ ë‚˜ì˜¤ê²Œ ëœ ë°°ê²½ì¸ HTTPì˜ ë¬´ìƒíƒœì„±ê³¼ ì¿ í‚¤, ì„¸ì…˜ì˜ íŠ¹ì§•ì— ëŒ€í•´ ì •ë¦¬í•´ë³´ì.HTTPì˜ íŠ¹ì§• - Stateless HTTPì˜ ëŒ€í‘œì ì¸ íŠ¹ì§• ì¤‘ í•˜ë‚˜ëŠ” ìƒíƒœë¥¼ ê°–ì§€ ì•ŠëŠ”ë‹¤(Stateless)ëŠ” ê²ƒì´ë‹¤. ê·¸ë ‡ë‹¤ë©´ â€˜ìƒíƒœâ€™ë€ ë¬´ì—‡ì¼ê¹Œ ? ëª‡ ê°€ì§€ ìë£Œë¥¼ ì°¾ì•„ë³¸ ê²°ê³¼, â€˜AëŠ” Bì´ë‹¤â€™ ì²˜ëŸ¼ â€˜ìƒíƒœëŠ” OOë‹¤â€™ ë¼ê³  ë”± ë–¨ì–´ì§€ê²Œ ë§í•˜ëŠ” ê²ƒì€ ì–´ë ¤ìš´ ê²ƒ ê°™ê³ , ã€The Definitive Guide to Linux Network Programmingã€ 4ì¥ ì—ì„œëŠ” ìƒíƒœë¥¼ ë‹¤ìŒê³¼ ê°™ì´ í‘œí˜„í•˜ê³  ìˆë‹¤. If a server maintains state, it means that the server maintains information about all of the current connections with its clients and the communications sent between them. ì¦‰, ìƒíƒœë€ â€˜ì„œë²„ì™€ í´ë¼ì´ì–¸íŠ¸ ì‚¬ì´ì— ë§ºì€ ì»¤ë„¥ì…˜ì„ í†µí•´ ì„œë¡œê°„ì— ì£¼ê³ ë°›ëŠ” ëª¨ë“  ì •ë³´â€™ ë¼ê³  ì´í•´í•˜ë©´ ë  ê²ƒ ê°™ë‹¤. â€˜ì£¼ê³ ë°›ëŠ” ì •ë³´â€™ì˜ ê°€ì¥ ëŒ€í‘œì ì¸ ì˜ˆë¡œ ì‚¬ìš©ìì˜ ë¡œê·¸ì¸ ì—¬ë¶€ë¥¼ ìƒê°í•´ ë³¼ ìˆ˜ ìˆë‹¤. ì´ëŸ¬í•œ í•˜ë‚˜ì˜ ë°ì´í„°ë¿ ì•„ë‹ˆë¼, ì–´ë–¤ ìš”ì²­ì´ ì™”ì—ˆëŠ”ì§€ ì–´ë–¤ ì‘ë‹µì„ í–ˆì—ˆëŠ”ì§€ ë˜í•œ ì£¼ê³ ë°›ëŠ” ì •ë³´ê°€ ë  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ stateless í•˜ë‹¤ëŠ” ê²ƒì€ ì´ëŸ¬í•œ ì •ë³´ë¥¼ ì„œë²„ì¸¡ì—ì„œ ìœ ì§€(ì €ì¥)í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ìƒíƒœë¥¼ ê°–ì§€ ì•ŠìŒìœ¼ë¡œì¨(ì •ë³´ë¥¼ ì €ì¥í•˜ì§€ ì•ŠìŒìœ¼ë¡œì¨) ì–»ëŠ” ì¥/ë‹¨ì  ì¥ì  ì„œë²„ í™•ì¥ì„±ì´ ì¢‹ë‹¤. ì¦‰, ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì— ëŒ€í•œ ì •ë³´ë¥¼ ì €ì¥í•˜ê³  ìˆì§€ ì•Šê¸° ë•Œë¬¸ì—, ì—¬ëŸ¬ ëŒ€ì˜ ì„œë²„ ì¤‘ ì–´ë–¤ ì„œë²„ë¡œ ìš”ì²­ì„ í•´ë„ ë™ì¼í•œ ì‘ë‹µì„ í•´ì¤„ ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ì‹œìŠ¤í…œ ì„¤ê³„ì‹œ, ìƒíƒœ ìœ ì§€ëŠ” ìµœì†Œí•œìœ¼ë¡œë§Œ ì‚¬ìš©í•˜ë©´ì„œ ì„¤ê³„í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. ì„œë²„ì˜ ë¦¬ì†ŒìŠ¤(CPU, ë©”ëª¨ë¦¬ ë“±)ë¥¼ ì•„ë‚„ ìˆ˜ ìˆë‹¤. ë‹¨ì  ë°˜ë³µë˜ëŠ” ë°ì´í„° ì „ì†¡ìœ¼ë¡œ ì¸í•´, ë„¤íŠ¸ì›Œí¬ ì„±ëŠ¥ì„ ì €í•˜ì‹œí‚¬ ìˆ˜ ìˆë‹¤. ì¿ í‚¤ ì¿ í‚¤ë€ ì›¹ ë¸Œë¼ìš°ì €ê°€ (ë¡œì»¬ PCì—)ë³´ê´€í•˜ëŠ” ë°ì´í„°(key-value pair)ì´ë‹¤. ì›¹ ì„œë²„ì™€ ì›¹ ë¸Œë¼ìš°ì € ì–‘ìª½ì—ì„œ ìƒì„±í•  ìˆ˜ ìˆë‹¤. ë™ì‘ ë°©ì‹ì€ ìƒì„± â†’ ì €ì¥ â†’ ì „ì†¡ ë‹¨ê³„ë¡œ êµ¬ì„±ëœë‹¤. ì¿ í‚¤ê°€ ë“±ì¥í•˜ê²Œ ëœ ë°°ê²½ ì¶”ì¸¡í•´ë³´ê¸° ì²˜ìŒì—ëŠ” ì›¹ì´ ì •ë³´ ê³µìœ ì˜ ëª©ì ìœ¼ë¡œ ì‹œì‘ë˜ì—ˆë‹¤ê³  ë“¤ì—ˆë‹¤. ê·¸ë ‡ë‹¤ë³´ë‹ˆ html ë¬¸ì„œ ì •ë„ë§Œ ë³´ì—¬ì£¼ë©´ ëì„ ê²ƒì´ë¯€ë¡œ ìƒíƒœìœ ì§€ì— ëŒ€í•œ í•„ìš”ì„±ì„ ëŠë‚„ ìˆ˜ ì—†ì—ˆì„ ê²ƒ ê°™ë‹¤. í•˜ì§€ë§Œ ì›¹ì„ í†µí•´ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•˜ëŠ” ë“±, ê¸°ìˆ ê³¼ ìš”êµ¬ì‚¬í•­ì´ ë°œì „í•¨ì— ë”°ë¼ ìƒíƒœë¥¼ ì €ì¥í•˜ì§€ ì•Šê³ ì„œëŠ” ê·¹ë³µí•  ìˆ˜ ì—†ëŠ” í•œê³„ì— ìì—°ìŠ¤ëŸ½ê²Œ ë„ë‹¬í•œ ê²ƒ ê°™ë‹¤. ì¥ì  ì‚¬ìš©ì ì»´í“¨í„°ì— ì €ì¥ë˜ê¸° ë•Œë¬¸ì— ì„œë²„ ë¦¬ì†ŒìŠ¤ì— ë¶€í•˜ë¥¼ ì£¼ì§€ ì•ŠëŠ”ë‹¤. ì„¤ì •ì— ë”°ë¼, ì„¸ì…˜ë³´ë‹¤ í›¨ì”¬ ì˜¤ë˜ ì§€ì†ë  ìˆ˜ë„ ìˆë‹¤. ë‹¨ì  ì¿ í‚¤ëŠ” ì¼ë°˜ í…ìŠ¤íŠ¸ë¡œ ì €ì¥ë˜ê³ , ëˆ„êµ¬ë‚˜ ì¿ í‚¤ë¥¼ ì—´ê±°ë‚˜ ë³€ì¡°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë³´ì•ˆ ìœ„í—˜ì´ ë°œìƒí•  ìˆ˜ ìˆë‹¤. ì¿ í‚¤ë¥¼ ìˆ˜ë™ìœ¼ë¡œ ì•”í˜¸í™” ë° ì•”í˜¸ í•´ë…í•  ìˆ˜ ìˆì§€ë§Œ ì•”í˜¸í™” ë° ì•”í˜¸ í•´ë…ì— í•„ìš”í•œ ì‹œê°„ ë•Œë¬¸ì— ì¶”ê°€ ì½”ë”©ì´ í•„ìš”í•˜ê³  ì• í”Œë¦¬ì¼€ì´ì…˜ ì„±ëŠ¥ì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆë‹¤. ì¿ í‚¤ ì‚¬ì´ì¦ˆ, ê°œìˆ˜ì— ì œí•œì´ ìˆë‹¤. ì‚¬ìš©ìê°€ ë¸Œë¼ìš°ì € ì„¤ì •ì—ì„œ ì¿ í‚¤ë¥¼ ë¹„í™œì„±í™”í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ, ê·¸ëŸ¬í•œ ê°€ëŠ¥ì„±ì„ ì˜ˆì¸¡í•´ì„œ ì½”ë”©í•´ì•¼ í•œë‹¤. ë³µì¡í•œ ë°ì´í„° êµ¬ì¡°ëŠ” ì €ì¥í•  ìˆ˜ ì—†ê³  ì¼ë°˜ í…ìŠ¤íŠ¸(ë¬¸ìì—´)ë§Œ í—ˆìš©í•œë‹¤. ì°¸ê³  : 2018ë…„ ê¸°ì¤€ ë¸Œë¼ìš°ì €ë³„ ìµœëŒ€ ì¿ í‚¤ ì‚¬ì´ì¦ˆ, ê°œìˆ˜ Web Browser Maximum cookies Maximum size per cookie í¬ë¡¬ 180 4096 bytes íŒŒì´ì–´í­ìŠ¤ 150 4097 bytes ì˜¤í˜ë¼ 180 4096 bytes ì„¸ì…˜ ì„¸ì…˜ì´ë€ ì›¹ ì»¨í…Œì´ë„ˆì— ì €ì¥í•˜ëŠ” ìƒíƒœ ì •ë³´ì´ë‹¤. ì›¹ ì»¨í…Œì´ë„ˆëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í•œ ì›¹ ë¸Œë¼ìš°ì €ë§ˆë‹¤ í•œ ì„¸ì…˜ì„ ìƒì„±í•œë‹¤. ì„¸ì…˜ì€ ì‚¬ìš©ìê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë¡œê·¸ì•„ì›ƒí•˜ê±°ë‚˜ ì›¹ ë¸Œë¼ìš°ì €ë¥¼ ë‹«ìœ¼ë©´ ì¢…ë£Œëœë‹¤. ì„¸ì…˜ì€ ì£¼ë¡œ ì¿ í‚¤ì™€ í•¨ê»˜ ì‚¬ìš©ëœë‹¤. ì„œë²„ê°€ í´ë¼ì´ì–¸íŠ¸ ID(í†°ìº£ì˜ ê²½ìš° JSESSIONID)ë¥¼ ì–´ë–¤ ë°©ë²•ìœ¼ë¡œ ì¶”ì í•  ê²ƒì¸ì§€ ì •ì˜í•œ ê²ƒì„ â€˜ì„¸ì…˜ íŠ¸ë˜í‚¹ ëª¨ë“œâ€™ë¼ê³  í•œë‹¤. íŠ¸ë˜í‚¹ ëª¨ë“œì—ëŠ” ì¿ í‚¤ ì‚¬ìš© ëª¨ë“œ, URL Rewriting ëª¨ë“œ, SSL ëª¨ë“œ ê°€ ìˆëŠ”ë° ëŒ€ë¶€ë¶„ ì„œë²„ì—ì„œ ì¿ í‚¤ ì‚¬ìš© ëª¨ë“œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ í•˜ê³  ìˆê³  ì´ ëª¨ë“œ ì‚¬ìš©ì„ ê¶Œì¥í•˜ê³  ìˆë‹¤. ê·¸ë˜ì„œ íŠ¹ë³„í•œ ì„¤ì •ì´ ì—†ìœ¼ë©´ í´ë¼ì´ì–¸íŠ¸ë¥¼ êµ¬ë¶„í•˜ê¸° ìœ„í•´ ì¿ í‚¤ë¥¼ í™œìš©í•œë‹¤. ì¥ì  ì„œë²„ì¸¡ ë©”ëª¨ë¦¬ì˜ í•œê³„ê¹Œì§€ ì €ì¥í•  ìˆ˜ ìˆë‹¤. ì„œë²„ì— ì €ì¥ë˜ë¯€ë¡œ ì¿ í‚¤ë³´ë‹¤ ë³´ì•ˆ ì¸¡ë©´ì—ì„œ ì•ˆì „í•˜ë‹¤. ë°ì´í„°ë¥¼ Hash Tableì— ì €ì¥ : í•œë²ˆì— ë§ì€ ì •ë³´ë¥¼ í•˜ë‚˜ì˜ ì„¸ì…˜ ê°ì²´ì— ì €ì¥ê°€ëŠ¥ ë‹¨ì  ì„œë²„ì— ë°ì´í„°ë¥¼ ì €ì¥í•˜ë¯€ë¡œ ì‚¬ìš©ìê°€ ë§ì•„ì§ˆìˆ˜ë¡ ì„œë²„ì— ë¶€í•˜ê°€ ì»¤ì§„ë‹¤. ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ ì›¹, HTTP ì „ë°˜ì— ëŒ€í•œ ì´í•´ì°¸ê³  ìë£Œ ìš°ì—ë…¸ ì„¼, ã€ê·¸ë¦¼ìœ¼ë¡œ ë°°ìš°ëŠ” Http &amp; Network Basicã€, ì˜ì§„ë‹·ì»´(2015) ìµœë²”ê· , ã€JSP2.3 ì›¹í”„ë¡œê·¸ë˜ë° ê¸°ì´ˆë¶€í„° ì¤‘ê¸‰ê¹Œì§€ã€, ê°€ë©”ì¶œíŒì‚¬(2015) https://link.springer.com/chapter/10.1007%2F978-1-4302-0748-1_4 ì¸í”„ëŸ° ê¹€ì˜í•œë‹˜ ê°•ì˜ https://www.webcodeexpert.com/2013/03/what-is-cookie-advantages-and.html https://thecodinglog.github.io/web/2020/08/11/what-is-session.html" }, { "title": "API Gateway ë¹„êµí•´ë³´ê¸°", "url": "/posts/api-gateway-comparison/", "categories": "", "tags": "", "date": "2021-06-27 00:25:00 +0900", "snippet": " â€˜ë‚˜ë§Œì˜ ì›¨ë”© í”Œë˜ë„ˆâ€™ë¼ëŠ” MSA ê¸°ë°˜ì˜ í† ì´ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ”ë° í•„ìš”í•œ API Gatewayë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ì–´ë–¤ í”„ë ˆì„ì›Œí¬ë¥¼ ì„ íƒí•´ì•¼í• ì§€ëª‡ ê°€ì§€ API Gateway í”„ë ˆì„ì›Œí¬ì— ëŒ€í•´ ì•Œì•„ë³´ê³  ê²°ì •í•˜ìAPI Gateway ì—­í• ëŒ€í‘œì ì¸ ì—­í•  ëª‡ ê°€ì§€ë¥¼ ì‚´í´ë³´ì ìš”ì²­ ë¼ìš°íŒ… ìš”ì²­ì„ HTTP ë©”ì„œë“œ, ê²½ë¡œì— ë”°ë¼ ì„œë¹„ìŠ¤ë¡œ ë¼ìš°íŒ… ...", "content": " â€˜ë‚˜ë§Œì˜ ì›¨ë”© í”Œë˜ë„ˆâ€™ë¼ëŠ” MSA ê¸°ë°˜ì˜ í† ì´ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ëŠ”ë° í•„ìš”í•œ API Gatewayë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ì–´ë–¤ í”„ë ˆì„ì›Œí¬ë¥¼ ì„ íƒí•´ì•¼í• ì§€ëª‡ ê°€ì§€ API Gateway í”„ë ˆì„ì›Œí¬ì— ëŒ€í•´ ì•Œì•„ë³´ê³  ê²°ì •í•˜ìAPI Gateway ì—­í• ëŒ€í‘œì ì¸ ì—­í•  ëª‡ ê°€ì§€ë¥¼ ì‚´í´ë³´ì ìš”ì²­ ë¼ìš°íŒ… ìš”ì²­ì„ HTTP ë©”ì„œë“œ, ê²½ë¡œì— ë”°ë¼ ì„œë¹„ìŠ¤ë¡œ ë¼ìš°íŒ… API ì¡°í•© ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•œ ê²°ê³¼ë¥¼ ì¡°í•© ì—£ì§€ ê¸°ëŠ¥ ì¸ì¦, ì¸ê°€, ìºì‹±, ë¡œê¹… ë“± í”„ë¡œí† ì½œ ë³€í™˜ í´ë¼ì´ì–¸íŠ¸ ì¹œí™”ì ì¸ í”„ë¡œí† ì½œê³¼ ë¹„ì¹œí™”ì ì¸ í”„ë¡œí† ì½œê°„ì— ìƒí˜¸ ë³€í™˜ Spring Cloud Netflix Zuul Spring Cloud í”„ë¡œì íŠ¸ì—ì„œ Netflix Zuulì„ ë³‘í•©ì‹œì¼œ ë§Œë“  í”„ë ˆì„ì›Œí¬ ë™ê¸°/ë¸”ë¡œí‚¹ íŠ¹ì„±ì„ ê°–ëŠ”ë‹¤. Tomcat ì„œë²„ë¥¼ ì‚¬ìš©í•œë‹¤ ê³µì‹ì ìœ¼ë¡œ 2018ë…„ 12ì›”ë¶€í„° ë” ì´ìƒì˜ ê°œë°œì€ ì—†ê³  ìœ ì§€ë³´ìˆ˜ë§Œ ì§€ì›í•œë‹¤. Spring boot 2.4.Xë¶€í„°ëŠ” zuulì´ ë” ì´ìƒ ì§€ì›ë˜ì§€ ì•ŠëŠ”ë‹¤. ê²½ë¡œ ê¸°ë°˜ì˜ ë¼ìš°íŒ…ë§Œ ì§€ì›ëœë‹¤. ì¿¼ë¦¬ ì•„í‚¤í…ì²˜ê°€ ì§€ì›ë˜ì§€ ì•ŠëŠ”ë‹¤. ì¶œì²˜ : https://netflixtechblog.com/announcing-zuul-edge-service-in-the-cloud-ab3af5be08eeSpring Cloud Gateway ìŠ¤í”„ë§5, ìŠ¤í”„ë§ ë¶€íŠ¸2, ìŠ¤í”„ë§ ì›¹í”ŒëŸ­ìŠ¤ ë“±ì˜ í”„ë ˆì„ì›Œí¬ë¥¼ í† ëŒ€ë¡œí•œ í”„ë ˆì„ì›Œí¬ Gateway Handlerë¥¼ ì‚¬ìš©í•˜ì—¬ ìˆ˜ì‹  ìš”ì²­ì„ ì ì ˆí•œ ëŒ€ìƒìœ¼ë¡œ ê°„ë‹¨í•˜ê³  íš¨ê³¼ì ìœ¼ë¡œ ë¼ìš°íŒ… Netty ì„œë²„ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°˜ì‘í˜•/ë¹„ë™ê¸° íŠ¹ì„±ì„ ì§€ì› ì¶œì²˜ : https://cloud.spring.io/spring-cloud-gateway/reference/html/Netflix Zuul2 Netty ì„œë²„ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°˜ì‘í˜•/ë¹„ë™ê¸° íŠ¹ì„±ì„ ì§€ì› HTTP2, WebSocket ì§€ì› Zuul2ì—ëŠ” Spring Cloud Neflix Zuul(Zuul1.x)ê³¼ ê°™ì€ ë‚´ì¥ ì§€ì›ì´ ì—†ë‹¤. ë”°ë¼ì„œ, ì‚¬ìš©í•˜ê³ ì í•  ê²½ìš° Zuulë§Œ ë”°ë¡œ ì„œë¹„ìŠ¤ë¥¼ ìš´ì˜í•´ì•¼ í•œë‹¤.ì¦‰, ê¸°ì¡´ì˜ ë‹¤ë¥¸ ìŠ¤í”„ë§ ë§ˆì´í¬ë¡œ ì„œë¹„ìŠ¤ì™€ í†µí•©í•  ìˆ˜ ì—†ë‹¤. ì¶œì²˜ : https://netflixtechblog.com/open-sourcing-zuul-2-82ea476cb2b3ë‚˜ì˜ ì„ íƒì€ ? ì¼ë‹¨ì€ í† ì´ í”„ë¡œì íŠ¸ì´ê³  API Gatewayë¥¼ ì²˜ìŒ ì ìš©í•´ë³´ëŠ” ê²ƒì´ë¯€ë¡œ ëŸ¬ë‹ ì»¤ë¸Œê°€ ë¹„êµì  ë‚®ì„ ê²ƒ ê°™ì€ Spring Cloud Zuulì„ ì‚¬ìš©í•˜ê¸°ë¡œ ê²°ì • ê³µì‹ ë¬¸ì„œ ì—ë„ ë‚˜ì™€ìˆì§€ë§Œ Spring Cloud Gatewayë¥¼ ì‚¬ìš©í•˜ë ¤ë©´Spring Boot 2.0, Spring WebFlux, and Project Reactor ë“±ì— ìµìˆ™í•˜ì§€ ì•Šìœ¼ë©´ ì´ê²ƒë“¤ì— ë¨¼ì € ìµìˆ™í•´ì ¸ì•¼ í•œë‹¤ê³  ë‚˜ì™€ìˆë‹¤. ë‹¤ìŒ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë°˜ì‘í˜• í”„ë¡œê·¸ë˜ë°, WebFlux, Netty ë“±ì— ëŒ€í•´ í•™ìŠµí•˜ê³  Spring Cloud Gatewayë¥¼ ì‚¬ìš©í•´ë³´ì ì ìš© í”„ë¡œì íŠ¸ repoë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ ë°˜ì‘í˜• í”„ë¡œê·¸ë˜ë° WebFlux Netty Spring Cloud Gatewayì°¸ê³  ìë£Œ í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨, ã€ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´ã€, ê¸¸ë²—(2020), 8ì¥ https://www.programmersought.com/article/28121145498/ https://cloud.spring.io/spring-cloud-gateway/multi/multi_gateway-starter.html https://www.novatec-gmbh.de/en/blog/api-gateways-an-evaluation-of-zuul-2/ https://medium.com/@niral22/spring-cloud-gateway-tutorial-5311ddd59816" }, { "title": "ê°„ë‹¨í•œ ì›¹ ì„œë²„ êµ¬í˜„í•˜ê¸°", "url": "/posts/nextstep-toy-webserver/", "categories": "ê²½í—˜í•˜ê¸°, ì‘ì—… ë…¸íŠ¸", "tags": "HTTP", "date": "2021-06-21 22:25:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ã€ìë°” ì›¹ í”„ë¡œê·¸ë˜ë° Next Stepã€ 4ì¥ì— ë‚˜ì™€ìˆëŠ” ì›¹ ì„œë²„ ìš”êµ¬ì‚¬í•­ë“¤ì„ êµ¬í˜„í•´ë³´ì•˜ë‹¤.êµ¬í˜„í•˜ê¸° ì „, ìŠ¤ìŠ¤ë¡œ ì•„ë˜ì™€ ê°™ì€ ì‚¬í•­ì„ ë‹¤ì§í•˜ê³  ì§„í–‰í•´ë´¤ë‹¤. ìµœëŒ€í•œ ì±…ì— ë‚˜ì˜¨ íŒíŠ¸ë¥¼ ë³´ì§€ ì•Šê³  í•´ê²°í•´ë³´ì. ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ì. ë¹ ë¥´ê²Œ êµ¬í˜„í•˜ëŠ” ê²ƒ ë³´ë‹¤ ì¤‘ìš”í•œê±´ ì½”ë“œ í•œ ì¤„ í•œ ì¤„ì˜ ì˜ë¯¸ë¥¼ ì œëŒ€ë¡œ ì•„ëŠ” ê²ƒ. ì˜ì‹ì ìœ¼ë¡œ ë¦¬íŒ©í† ë§ ...", "content": "ë“¤ì–´ê°€ê¸° ì „ã€ìë°” ì›¹ í”„ë¡œê·¸ë˜ë° Next Stepã€ 4ì¥ì— ë‚˜ì™€ìˆëŠ” ì›¹ ì„œë²„ ìš”êµ¬ì‚¬í•­ë“¤ì„ êµ¬í˜„í•´ë³´ì•˜ë‹¤.êµ¬í˜„í•˜ê¸° ì „, ìŠ¤ìŠ¤ë¡œ ì•„ë˜ì™€ ê°™ì€ ì‚¬í•­ì„ ë‹¤ì§í•˜ê³  ì§„í–‰í•´ë´¤ë‹¤. ìµœëŒ€í•œ ì±…ì— ë‚˜ì˜¨ íŒíŠ¸ë¥¼ ë³´ì§€ ì•Šê³  í•´ê²°í•´ë³´ì. ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‘ì„±í•˜ì. ë¹ ë¥´ê²Œ êµ¬í˜„í•˜ëŠ” ê²ƒ ë³´ë‹¤ ì¤‘ìš”í•œê±´ ì½”ë“œ í•œ ì¤„ í•œ ì¤„ì˜ ì˜ë¯¸ë¥¼ ì œëŒ€ë¡œ ì•„ëŠ” ê²ƒ. ì˜ì‹ì ìœ¼ë¡œ ë¦¬íŒ©í† ë§ ì—°ìŠµì„ í•˜ì.ì²˜ìŒì—” html í˜ì´ì§€ë§Œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì „ë‹¬í•˜ëŠ” ìš”êµ¬ì‚¬í•­ì´ì—ˆëŠ”ë° ë‚˜ì¤‘ì—” Mapì„ ì„ì‹œ DBë¡œ í™œìš©í•˜ì—¬ íšŒì›ê°€ì…í•˜ëŠ” ê²ƒê¹Œì§€ í•˜ê²Œë˜ì—ˆë‹¤.ë‹¤ ë§Œë“¤ì–´ë³´ê³  ë‚˜ë‹ˆ ì—„ë°€íˆ ë§í•˜ë©´ ë§¤ìš° ê°„ë‹¨í•œ â€˜WASâ€™ë¼ê³  í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.ì—°ì†ìœ¼ë¡œ ì‹œê°„ì„ í• ì• í•˜ì§„ ëª»í–ˆì§€ë§Œ, ë‹¤ í•©ì¹˜ë©´ ëŒ€ëµ 2ì£¼ ì •ë„ ê±¸ë¦° ê²ƒ ê°™ë‹¤.â€» ì „ì²´ ì½”ë“œ repositoryìš”êµ¬ì‚¬í•­ ë³„ êµ¬í˜„ìš”êµ¬ì‚¬í•­ ë³„ë¡œ êµ¬í˜„ì„ í•˜ë©´ì„œ ëª°ëë˜ ë‚´ìš©ë“¤ê³¼ ë°°ìš´ ë‚´ìš©, êµ¬í˜„ ì‚¬í•­ ë“±ì„ ê¸°ë¡í•´ë³´ì•˜ë‹¤.ìš”êµ¬ì‚¬í•­ 1 http://localhost:8080/index.htmlë¡œ ì ‘ì†í–ˆì„ ë•Œ webapp ë””ë ‰í† ë¦¬ì˜ index.html íŒŒì¼ì„ ì½ì–´ í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µí•œë‹¤.êµ¬í˜„í•˜ê¸° ì „ ë“¤ì—ˆë˜ ìƒê°ë“¤ index.html íŒŒì¼ì„ ì–´ë–¤ì‹ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ì— ë„˜ê²¨ì¤˜ì•¼í• ê¹Œ ? index.html íŒŒì¼ ì½ì–´ì„œ byte í˜•íƒœë¡œ ë§Œë“¤ì–´ì¤€ ë’¤ DataOutputStreamì„ í†µí•´ response ë„˜ê¸°ë©´ ë˜ì§€ ì•Šì„ê¹Œ.. ? http://localhost:8080/index.html ë¼ëŠ” ìš”ì²­ì™”ì„ ë•Œ â€˜/â€™ ì´í›„ì˜ íŒŒì¼ëª…ì„ ì–´ë–»ê²Œ ê°€ì ¸ì˜¤ì§€ ?êµ¬í˜„ ë² ì´ìŠ¤ ì½”ë“œì— ìˆë˜ â€˜RequestHandlerâ€™ í´ë˜ìŠ¤ ë‚´ë¶€ì— êµ¬í˜„í–ˆë‹¤. // í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ html íŒŒì¼ ì´ë¦„ ê°€ì ¸ì˜¨ë‹¤ private String getRequestHtmlName(InputStream in) throws IOException { BufferedReader bufferedReader = new BufferedReader(new InputStreamReader(in)); String requestInfo = bufferedReader.readLine(); if(!requestInfo.contains(\".html\")) { return null; } String htmlPage = requestInfo.split(\" \")[1]; return htmlPage.substring(1); // ë§¨ ì•ì— '/' ì§€ìš°ê¸° ìœ„í•¨ } // http responseë¥¼ ìœ„í•´ íŒŒì¼ì„ byteë¡œ ë³€í™˜ (ì ˆëŒ€ê²½ë¡œ ver) private byte[] convertHtmlToByte(String fileName) throws IOException { String rootPath = System.getProperty(\"user.dir\"); String filePath = rootPath + \"/webapp/\" + fileName; File file = new File(filePath); return Files.readAllBytes(file.toPath()); } // http responseë¥¼ ìœ„í•´ íŒŒì¼ì„ byteë¡œ ë³€í™˜ (ìƒëŒ€ê²½ë¡œ ver) private byte[] convertHtmlToByte(String fileName) throws IOException { String filePath = \"./webapp/\" + fileName; File file = new File(filePath); return Files.readAllBytes(file.toPath()); }êµ¬í˜„í•˜ë©´ì„œ ì•Œê²Œëœ ê²ƒë“¤ ë¸Œë¼ìš°ì €ì—ì„œ ë„˜ì–´ì˜¤ëŠ” requestê°€ ì–´ë–¤ì‹ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ìˆëŠ”ì§€ connection.getInputStream()ì„ ë””ë²„ê±°ë¡œ ì°ì—ˆëŠ”ë° ìš”ì²­ì— ëŒ€í•œ ë¬¸ìì—´ ì •ë³´ê°€ ë³´ì´ì§€ ì•ŠëŠ”ë‹¤. (connectionì€ Socket ê°ì²´) InputStreamì€ ë°”ì´íŠ¸ ë‹¨ìœ„ë¡œ ìˆ«ìë¥¼ ì €ì¥í•˜ê¸° ë•Œë¬¸ì— ì›í•˜ëŠ” ê°’ ë³¼ ìˆ˜ ì—†ì—ˆë˜ ê²ƒ.(ì°¸ê³ ) BufferdReader, InputStreamReaderë¥¼ í™œìš©í•˜ì—¬ byte arrayì¸ InputStreamì„ ì½ì–´ë³´ë‹ˆ ìš”ì²­ì˜ ë§¨ ì²«ë²ˆì§¸ ì¤„ì— html íŒŒì¼ì— ê´€ë ¨ëœ ì •ë³´ê°€ ìˆë‹¤. ìƒëŒ€ê²½ë¡œë¥¼ ì‚¬ìš©í•  ê²½ìš°, ./ (í˜„ì¬ ìœ„ì¹˜)ëŠ” bin, src í´ë”ë¥¼ í¬í•¨í•˜ëŠ” í•´ë‹¹ ìë°” í”„ë¡œì íŠ¸ í´ë”ì˜ ìœ„ì¹˜ì´ë‹¤.ìš”êµ¬ì‚¬í•­ 2 GET ë°©ì‹ìœ¼ë¡œ íšŒì›ê°€ì…í•˜ê¸°êµ¬í˜„í•˜ê¸° ì „ ë“¤ì—ˆë˜ ìƒê°ë“¤ ìš”êµ¬ì‚¬í•­1 ì—ì„œ êµ¬í˜„í•œ ë©”ì„œë“œë¥¼ ê°œì„ í•´ì•¼ í•  ê²ƒ ê°™ë‹¤. js, css íŒŒì¼ì— ëŒ€í•œ ìš”ì²­ë„ responseë¡œ ë„˜ê²¨ì¤˜ì•¼ í•˜ê¸° ë•Œë¬¸ì— getRequestHtmlName(), convertHtmlToByte() ë¼ëŠ” ë©”ì„œë“œëª…ì„ ì¢€ ë” ì¶”ìƒì ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ html íŒŒì¼ ì´ì™¸ì—ë„ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë„ë¡ ë§Œë“¤ì–´ ë³´ì. client ê´€ë ¨ íŒŒì¼ ë””ë ‰í† ë¦¬ ìµœìƒìœ„ í´ë”ì¸ â€œwebappâ€ë„ ë³€ìˆ˜ì— ì¶”ê°€í•˜ì§€ ë§ê³  í´ë˜ìŠ¤ ë³€ìˆ˜ë¡œ ì„ ì–¸í•˜ê³  finalë¡œ ìƒìˆ˜í™” í•˜ëŠ”ê²Œ ë‚˜ì„ ê²ƒ ê°™ë‹¤. ë³¸ê²©ì ìœ¼ë¡œ íšŒì›ê°€ì…ì— ìš”ì²­ì— ëŒ€í•´ ìƒê°í•´ë³´ë©´, ì§€ê¸ˆê¹Œì§€ í–ˆë˜ í˜ì´ì§€ ì‘ë‹µê³¼ëŠ” ë‹¬ë¦¬ íšŒì›ê°€ì… ì´ë¼ëŠ” â€˜ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§â€™ì„ ìˆ˜í–‰í•´ì•¼ í•œë‹¤. ë”°ë¼ì„œ, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰ì„ ë‹´ë‹¹í•˜ëŠ” â€˜ë¬´ì–¸ê°€â€™ë¥¼ ë§Œë“¤ì–´ì•¼ í•  ê²ƒ ê°™ë‹¤. ë˜í•œ, RequestHandlerì—ì„œ í˜„ì¬ëŠ” í˜ì´ì§€ ì‘ë‹µì— ê´€ë ¨ëœ ê²ƒë§Œ ìˆ˜í–‰í•˜ëŠ”ë° ë‹¤ì–‘í•œ requestë¥¼ ì ì ˆí•˜ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ ë³€ê²½í•´ì•¼ í•  ê²ƒ ê°™ë‹¤. ì •ì  ìì› ìš”ì²­, ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìš”ì²­ ë“± ê°ê¸° ë‹¤ë¥¸ ìš”ì²­ì„ ì–´ë–»ê²Œ êµ¬ë¶„í•´ì•¼ í• ê¹Œ ? ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìš”êµ¬í•˜ëŠ” ìš”ì²­ì„ ì²˜ë¦¬í•  ì‹¤ì œ ë¡œì§ì— í•´ë‹¹ ìš”ì²­ì„ ì–´ë–»ê²Œ ë§µí•‘ì‹œí‚¤ë©´ ì¢‹ì„ê¹Œ ? ì‚¬ìš©ì ìš”ì²­ê³¼ í•´ë‹¹ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ”ë° í•„ìš”í•œ ë©”ì„œë“œë¥¼ ë§µí•‘ì‹œì¼œì£¼ëŠ” ì—­í• ì„ í•˜ëŠ” LogicMapper ìƒì„±. RequestHandler ë‚´ì— ì½”ë“œë¥¼ ì¶”ê°€í•´ì„œ í•  ìˆ˜ë„ ìˆê² ì§€ë§Œ, ê·¸ë ‡ê²Œ ë˜ë©´ ì±…ì„ì´ ë§ì•„ì§€ê¸° ë•Œë¬¸ì— ì½”ë“œê°€ ì ì  ë³µì¡í•´ì§ˆ ê²ƒì´ë‹¤. ë”°ë¼ì„œ, RequestHandlerì˜ ì±…ì„ì„ â€˜í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì„ ë°›ì•„ë“¤ì´ê³  ì–´ë–¤ ìš”ì²­ì¸ì§€ íŒë‹¨ í•˜ëŠ” ê²ƒâ€™ìœ¼ë¡œ í•œì •í•˜ëŠ”ê²Œ ì¢‹ì„ ê²ƒ ê°™ë‹¤ê³  ìƒê°í–ˆë‹¤. êµ¬í˜„ ìš”ì²­ì˜ íƒ€ì…ì„ ì •ì  ìì›(html, css, js ë“±) ìš”ì²­ê³¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìš”ì²­ ë‘ ê°œë¡œ ë‚˜ëˆ ë³´ì•˜ë‹¤.ì¼ë‹¨ ì•„ë˜ì²˜ëŸ¼ êµ¬í˜„í•´ë´¤ëŠ”ë° ì´ë ‡ê²Œ í•˜ë“œì½”ë”©ìœ¼ë¡œ ë¶„ê¸°ì‹œí‚¤ë©´ ë³€í™”ì— ìœ ì—°í•˜ê²Œ ëŒ€ì‘í•˜ê¸°ë„ ì–´ë µê³  ìƒê°ì§€ ëª»í•œ ì¼€ì´ìŠ¤ë„ ìˆì„ ê²ƒ ê°™ë‹¤.ì–´ë–»ê²Œ í•˜ëŠ”ê²Œ ì¢‹ì„ì§€ ê³ ë¯¼í•´ë³´ê³  ì¶”í›„ì— ì±…ë„ ì°¸ê³ í•´ë³´ìpublic enum RequestType { REQUEST_STATIC_RESOURCE, REQUEST_BUSINESS_LOGIC} private RequestType getRequestType(HttpRequest httpRequest) { String httpMethod = httpRequest.getHttpMethod(); String requestUrl = httpRequest.getRequestUrl(); switch (HttpMethod.valueOf(httpMethod)) { case GET: if(requestUrl.contains(\"?\")) { return RequestType.REQUEST_BUSINESS_LOGIC; } else if(requestUrl.equals(\"/\") || requestUrl.contains(\".\")) { return RequestType.REQUEST_FILE; } else { return RequestType.REQUEST_BUSINESS_LOGIC; } case POST: break; } return null; } ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë§µí•‘ì„ ìœ„í•´ ì¼ë‹¨ ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í–ˆëŠ”ë°, ë¦¬í”Œë ‰ì…˜ì„ ë§ˆêµ¬ ì¼ë‹¤. ì´ ë°©ë²• ë§ê³ ëŠ” ì—†ì„ê¹Œ ?ì‚¬ì‹¤, executeMethodWithParamsForGetRequestì—ì„œ íŒŒë¼ë¯¸í„° ë§µí•‘í•˜ëŠ” ë¶€ë¶„ë„ íŒŒë¼ë¯¸í„° ê°ì²´ì— ê¸°ë³¸ ìƒì„±ìê°€ ì—†ìœ¼ë©´paramClass.getDeclaredConstructor().newInstance() ì´ ë¶€ë¶„ì—ì„œ ì—ëŸ¬ ë‚œë‹¤.ê·¸ë¦¬ê³  LogicMapperê°€ ìµœì´ˆ í•œ ë²ˆë§Œ ìƒì„±ë˜ëŠ” ê²ƒë„ ë³´ì¥ë˜ì–´ì•¼ í•˜ëŠ” ë“± ì•„ì§ ë¯¸í¡í•œ ë¶€ë¶„ì´ ë§ë‹¤. public class LogicMapper { // ì‹¤í–‰í•  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì— ëŒ€í•œ ì •ë³´ static class Execution &lt;T&gt; { private T targetInstance; // ì‹¤í–‰ë  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ê°ì²´ private Class logicClass; // ì‹¤í–‰ë  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í´ë˜ìŠ¤ private String methodName; // ì‹¤í–‰ë  ë©”ì„œë“œ ëª… private Class paramClass; // íŒŒë¼ë¯¸í„° í´ë˜ìŠ¤ public Execution(T targetInstance, Class logicClass, String methodName) { this.targetInstance = targetInstance; this.logicClass = logicClass; this.methodName = methodName; } public Execution(T targetInstance, Class logicClass, String methodName, Class paramClass) { this.targetInstance = targetInstance; this.logicClass = logicClass; this.methodName = methodName; this.paramClass = paramClass; } public T getTargetInstance() { return targetInstance; } public Class getLogicClass() { return logicClass; } public String getMethodName() { return methodName; } public Class getParamClass() { return paramClass; } } private static Map&lt;String, Execution&gt; getMappingUrl = new HashMap&lt;&gt;(); static { initGetRequest(); } // ìš”ì²­ì— ë”°ë¥¸ ì‹¤í–‰ ë§µí•‘ private static void initGetRequest() { getMappingUrl.put(\"/user/create\", new Execution(UserLogic.getInstance(), UserLogic.class, \"signup\", User.class)); } // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰ë˜ë„ë¡ public byte[] doRequestLogic(HttpRequest httpRequest) throws Exception { HttpMethod httpMethod = HttpMethod.valueOf(httpRequest.getHttpMethod()); String requestUrl = httpRequest.getRequestUrl(); byte[] response = {}; switch (httpMethod) { case GET: response = requestUrl.contains(\"?\") ? executeMethodWithParamsForGetRequest(requestUrl) : executeMethodWithoutParamsForGetRequest(requestUrl); break; } return response; } // ìš”ì²­ì— íŒŒë¼ë¯¸í„° ìˆëŠ” ê²½ìš° public byte[] executeMethodWithParamsForGetRequest(String requestUrl) throws Exception { String[] info = requestUrl.split(\"\\\\?\"); String url = info[0]; Map&lt;String, String&gt; params = HttpRequestUtils.parseQueryString(info[1]); Execution execution = Optional.ofNullable(getMappingUrl.get(url)).orElseThrow(NoSuchMethodError::new); Class paramClass = execution.getParamClass(); Object instance = paramClass.getDeclaredConstructor().newInstance(); for(String key : params.keySet()) { Optional.ofNullable(paramClass.getDeclaredField(key)).ifPresent((field) -&gt; { field.setAccessible(true); try { field.set(instance, params.get(key)); } catch (IllegalAccessException e) { e.printStackTrace(); } }); } execution.getLogicClass().getMethod(execution.getMethodName(), execution.getParamClass()).invoke(execution.getTargetInstance(), instance); return \"SUCCESS\".getBytes(); } // ìš”ì²­ì— íŒŒë¼ë¯¸í„° ì—†ëŠ” ê²½ìš° public byte[] executeMethodWithoutParamsForGetRequest(String requestUrl) throws NoSuchMethodException, InvocationTargetException, IllegalAccessException { Execution execution = Optional.ofNullable(getMappingUrl.get(requestUrl)).orElseThrow(NoSuchMethodError::new); execution.getLogicClass().getMethod(execution.getMethodName(), execution.getParamClass()).invoke(execution.getTargetInstance()); return \"SUCCESS\".getBytes(); } }êµ¬í˜„í•˜ë©´ì„œ ì•Œê²Œëœ ê²ƒë“¤ ë¦¬í”Œë ‰ì…˜ ì‚¬ìš©í•´ì„œ ëŒ€ìƒí´ë˜ìŠ¤.getDeclaredConstructor().newInstance() ì‹¤í–‰ì‹œ ëŒ€ìƒ í´ë˜ìŠ¤ì— ê¸°ë³¸ ìƒì„±ì ì—†ìœ¼ë©´ ì—ëŸ¬ ë‚œë‹¤.ìš”êµ¬ì‚¬í•­ 3 POST ë°©ì‹ìœ¼ë¡œ íšŒì›ê°€ì…í•˜ê¸°êµ¬í˜„í•˜ê¸° ì „ ë“¤ì—ˆë˜ ìƒê°ë“¤ POST ë°©ì‹ìœ¼ë¡œ ë„˜ì–´ì˜¤ëŠ” (bodyì— ë‹´ê²¨ìˆëŠ”)íŒŒë¼ë¯¸í„°ëŠ” ì–´ë–»ê²Œ ë°›ì§€ ?êµ¬í˜„if(httpMethod.equals(\"POST\")) { int contentLen = 0; for(String line = bufferedReader.readLine(); (!line.isEmpty() &amp;&amp; line!=null); line=bufferedReader.readLine()) { if(line.contains(\"Content-Length\")) { String[] info = line.split(\":\"); contentLen = Integer.parseInt(info[1].trim()); break; } } if (contentLen &gt; 0) { char[] body = new char[contentLen]; bufferedReader.read(body); String params = new String(body); }}êµ¬í˜„í•˜ë©´ì„œ ì•Œê²Œëœ ê²ƒë“¤ POST ë°©ì‹ì˜ ê²½ìš° bufferedReaderì˜ readLine() ì‚¬ìš©í•˜ê²Œ ë˜ë©´ http headerëŠ” ì½ì§€ë§Œ bodyëŠ” ì½ì–´ì˜¤ì§€ ëª»í•œë‹¤. ì›ì¸ì„ ì°¾ì•„ë³´ë‹ˆ headerì˜ ë§ˆì§€ë§‰ ë¶€ë¶„(â€œâ€) readLine() í•˜ëŠ” ë¶€ë¶„ì—ì„œ ê³„ì† hanging ë˜ì–´ìˆë‹¤. hanging ë˜ëŠ” ì´ìœ ëŠ” request header ë§ˆì§€ë§‰ ë¼ì¸ì´ ê³µë°±ì¸ë° readLine()ì˜ ê²½ìš° lineì˜ ëì— ê°œí–‰ ë¬¸ìê°€ ì—†ëŠ” ê²½ìš°, ê°’ì´ ì˜¬ ë•Œ ê¹Œì§€ ê³„ì† ê¸°ë‹¤ë¦°ë‹¤ê³  í•œë‹¤. ë”°ë¼ì„œ, ê³µë°±ì¸ ê²½ìš°ë¥¼ ì²´í¬í•˜ëŠ” ë¡œì§ì´ í•„ìš”í•˜ê³ , Content-Lengthë¥¼ êµ¬í•´ì„œ ê·¸ í¬ê¸°ë§Œí¼ ë‚˜ë¨¸ì§€ë¥¼ read() í•˜ë©´ ëœë‹¤. readLine() ëŒ€ì‹  read()ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ”, bodyë¡œ ë„˜ì–´ì˜¤ëŠ” íŒŒë¼ë¯¸í„° ë˜í•œ ëì— ê°œí–‰ë¬¸ìê°€ ì—†ê¸° ë•Œë¬¸ì— readLine() ì‚¬ìš©ì‹œ ëŒ€ê¸°ìƒíƒœì— ë¹ ì§„ë‹¤. http request í¬ë§· Request-Line*(( general-header | request-header | entity-header ) CRLF)CRLF[ message-body ] ìš”êµ¬ì‚¬í•­ 4 íšŒì›ê°€ì…ì„ ì™„ë£Œí•˜ë©´ /index.html í˜ì´ì§€ë¡œ ì´ë™í•œë‹¤. url ë˜í•œ user/createê°€ ì•„ë‹Œ /index.htmlë¡œ ë³€í•´ì•¼ í•œë‹¤.êµ¬í˜„í•˜ê¸° ì „ ë“¤ì—ˆë˜ ìƒê°ë“¤ íšŒì›ê°€ì… í›„ index.htmlì„ í´ë¼ì´ì–¸íŠ¸ë¡œ ë„˜ê²¨ì£¼ë©´ í˜ì´ì§€ëŠ” ëœ¨ê² ì§€ë§Œ urlì€ user/createê°€ ê·¸ëŒ€ë¡œ ë‚¨ì•„ìˆì„ ê²ƒì´ë‹¤. íšŒì›ê°€ì… í›„ í´ë¼ì´ì–¸íŠ¸ê°€ index.htmlì„ ìš”ì²­í•˜ë„ë¡ í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ ? ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰í•˜ëŠ” ë©”ì„œë“œì˜ ë‹¤ì–‘í•œ íƒ€ì…ì˜ ë¦¬í„´ê°’ì„ LogicMapperì— ì¶”ìƒí™” ì‹œí‚¨ ë‘ ê°œì˜ ë©”ì„œë“œ executeMethodWithParams(), executeMethodWithoutParams()ì—ì„œ ì–´ë–»ê²Œ ë°›ì•„ì„œ ì²˜ë¦¬í•´ì•¼í• ê¹Œ?êµ¬í˜„ ë¨¼ì € ì›¹ ì„œë²„ì˜ ê´€ì ì—ì„œ ìƒê°í•´ë´¤ì„ë•Œ, ì›¹ ì„œë²„ì—ì„œ í´ë¼ì´ì–¸íŠ¸ë¡œ ì‘ë‹µí•˜ëŠ” í˜•íƒœëŠ” í¬ê²Œ â€˜html í˜ì´ì§€ / ë°ì´í„°(json ë“±)â€™ ì´ë¼ê³  ìƒê°í–ˆë‹¤.ë”°ë¼ì„œ, í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì— ëŒ€í•´ ì ì ˆí•œ ì‘ë‹µì„ í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ê²ƒì€ ìœ„ì—ì„œ ì •ì˜í•œ â€˜ì‘ë‹µì˜ í˜•íƒœâ€™ì™€ â€˜ì‹¤ì œ ë°ì´í„°â€™ ë‘ ê°€ì§€ë¼ê³  ìƒê°í•˜ì—¬ ì´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ExecutionResult í´ë˜ìŠ¤ë¥¼ ë§Œë“¤ì—ˆë‹¤.ì´ì— ë”°ë¼ ê¸°ì¡´ì— ì •ì˜ëœ executeMethodWithParams(), executeMethodWithoutParams() ë©”ì„œë“œì˜ ë¦¬í„´ê°’ì„ ExecutionResultë¡œ ë°”ê¾¸ê³  ë‹¤ì–‘í•œ íƒ€ì…ì˜ ë¦¬í„´ê°’ì„ í•´ë‹¹ í´ë˜ìŠ¤ì˜ ì†ì„± ì¤‘â€˜ì‹¤ì œ ë°ì´í„°â€™(Object) ë¶€ë¶„ì— ì„¸íŒ…í–ˆë‹¤.public enum ResponseType { HTML_PAGE, DATA, EMPTY} public ExecutionResult doRequestLogic(HttpRequest httpRequest, HttpResponse httpResponse) throws Exception { HttpMethod httpMethod = httpRequest.getHttpMethod(); String requestUrl = httpRequest.getRequestUrl(); Map&lt;String,String&gt; params = httpRequest.getParams(); Execution execution = null; switch (httpMethod) { case GET: execution = Optional.ofNullable(getMappingUrl.get(requestUrl)).orElseThrow(NoSuchMethodError::new); break; case POST: execution = Optional.ofNullable(postMappingUrl.get(requestUrl)).orElseThrow(NoSuchMethodError::new); break; } switch (execution.getResponseType()) { case HTML_PAGE: httpResponse.setStatusCode(HttpStatusCode3xx.REDIRECTION); break; case DATA: httpResponse.setStatusCode(HttpStatusCode2xx.OK); } ExecutionResult result = (params!=null) ? executeMethodWithParams(execution, params, httpResponse) : executeMethodWithoutParams(execution, httpRequest); return result; }public class ExecutionResult { private ResponseType responseType; private Object returnData; public ExecutionResult(ResponseType responseType, Object returnData) { this.responseType = responseType; this.returnData = returnData; } public ResponseType getResponseType() { return responseType; } public Object getReturnData() { return returnData; }} LogicMapperì—ì„œ ì‹¤í–‰í•œ ê²°ê³¼ë¥¼ RequestHandlerì—ì„œ ë°›ì€ í›„ ì‘ë‹µ íƒ€ì…ì— ë”°ë¼ HTTP Responseì— ì ì ˆí•œ ë°ì´í„° ì„¸íŒ…í•´ì¤€ë‹¤.í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸ì¸ ê²½ìš° httpResponse.setHeader(\"Location\", redirectUrl);ì„ í†µí•´ í—¤ë”ì— Location : redirectUrlì„ ì„¸íŒ…í•´ì¤€ë‹¤. case REQUEST_BUSINESS_LOGIC: ExecutionResult result = requestLogicMapper.doRequestLogic(httpRequest, httpResponse); switch (result.getResponseType()) { case HTML_PAGE: String redirectPage = (String) result.getReturnData(); String redirectUrl = \"http://localhost:8080\"+redirectPage; // TODO : í•˜ë“œì½”ë”© ë§ê³  request originìœ¼ë¡œ ? httpResponse.setHeader(\"Location\", redirectUrl); break; case DATA: break; case EMPTY: httpResponse.setStatusCode(HttpStatusCode2xx.OK); httpResponse.setHeader(\"Content-Type\", \"text/html;charset=utf-8\"); httpResponse.setHeader(\"Content-Length\", responseBody.length); break;}êµ¬í˜„í•˜ë©´ì„œ ì•Œê²Œëœ ê²ƒë“¤ HTTP Response ì‘ë‹µ í—¤ë”ì— Location : urlì„ ì„¸íŒ…í•˜ë©´ ë¸Œë¼ìš°ì €ëŠ” í•´ë‹¹ urlë¡œ ìš”ì²­ì„ ë³´ë‚¸ë‹¤. ìƒíƒœì½”ë“œ 302 Found í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ ë¦¬ì†ŒìŠ¤ê°€ Location í—¤ë”ì— ì£¼ì–´ì§„ URLì— ì¼ì‹œì ìœ¼ë¡œ ì´ë™ë˜ì—ˆìŒì„ ê°€ë¦¬í‚¨ë‹¤. ìš”êµ¬ì‚¬í•­ 5-1 ë¡œê·¸ì¸ ë©”ë‰´ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ í˜ì´ì§€ë¡œ ì´ë™í•œë‹¤. ë¡œê·¸ì¸ì´ ì„±ê³µí•˜ë©´ /index.htmlë¡œ ì´ë™í•˜ê³ , ì‹¤íŒ¨í•˜ë©´ /user/login_failed.htmlë¡œ ì´ë™í•´ì•¼ í•œë‹¤. ì•ì—ì„œ íšŒì›ê°€ì…í•œ ì‚¬ìš©ìë¡œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. êµ¬í˜„í•˜ê¸° ì „ ë“¤ì—ˆë˜ ìƒê°ë“¤ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìˆ˜í–‰í•˜ëŠ” ë©”ì„œë“œë“¤ì˜ íŒŒë¼ë¯¸í„°ëŠ” ê°œìˆ˜ë„ ë‹¤ì–‘í•˜ê³  íƒ€ì…ë„ ë‹¤ì–‘í•œë° LogicMapperì— ì¶”ìƒí™” ì‹œí‚¨ ë‘ ê°œì˜ ë©”ì„œë“œ executeMethodWithParams(), executeMethodWithoutParams()ì—ì„œ ì–´ë–»ê²Œ ë°›ì•„ì„œ ì²˜ë¦¬í•´ì•¼í• ê¹Œ? RequestHandlerì—ì„œ LogicMapperë¡œ ë„˜ì–´ì˜¤ëŠ” íŒŒë¼ë¯¸í„°ì˜ í˜•íƒœëŠ” Mapì¸ë°, LogicMapperì—ì„œ ë§µí•‘ì‹œì¼œì¤„ ë‹¤ì–‘í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë©”ì„œë“œì˜ íŒŒë¼ë¯¸í„°ë¥¼ ì¼ì¼ì´ ë§ì¶”ë ¤ë©´ ì¶”ìƒí™”ëœ ë‘ ê°œì˜ ë©”ì„œë“œë§Œ ê°–ê³ ëŠ” ë¶ˆê°€ëŠ¥í•˜ë‹¤ê³  ìƒê°í–ˆë‹¤. ì™œ ì´ë ‡ê²Œ ëì„ê¹Œë¥¼ ìƒê°í•´ë³´ë‹ˆ LogicMapper ì…ì¥ì—ì„œ ì‹¤ì œë¡œ ì‹¤í–‰ë˜ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í´ë˜ìŠ¤, íŒŒë¼ë¯¸í„° íƒ€ì…, ê°œìˆ˜ ë“± ì•Œì•„ì•¼í• ê²Œ ë„ˆë¬´ ë§ì€ ê²ƒ ê°™ì•˜ë‹¤. ìš”êµ¬ì‚¬í•­ 2ì— ë³´ë©´ LogicMapperì˜ ë¯¸í¡í•¨ì— ëŒ€í•´ ì ì–´ë†¨ëŠ”ë°, ê·¸ ë•Œ ë” ê¹Šê²Œ ìƒê°í•˜ì§€ ì•Šì•˜ë˜ê²Œ ê²°êµ­ ë°œëª©ì„ ì¡ì€ ê²ƒ ê°™ë‹¤. êµ¬í˜„ LogicMapper ê°œì„  (RequestLogicMapper) LogicMapperì—ì„œ ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ë°”ë¡œ ì‹¤í–‰í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼, ì¤‘ê°„ì— LogicExecutorë¼ëŠ” ê°ì²´ë¥¼ ë‘”ë‹¤. LogicMapperì—ì„œëŠ” ë“¤ì–´ì˜¨ ìš”ì²­ì— ë”°ë¼ ì‹¤ì œ ë¡œì§ ë©”ì„œë“œê°€ ì•„ë‹Œ LogicExecutorì˜ íŠ¹ì • ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ê³  íŒŒë¼ë¯¸í„°ë„ Map í˜•íƒœë¡œë§Œ ë„˜ê¸°ë„ë¡ ìˆ˜ì •. í•˜ì§€ë§Œ, ë¡œì§ì—ì„œ ì¶”ê°€ì ìœ¼ë¡œ í•„ìš”í•œ íŒŒë¼ë¯¸í„°ë¡œ HttpRequest, HttpResponse ë“±ë„ ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì¼ë‹¨ì€ ì•„ë˜ ì½”ë“œì²˜ëŸ¼ Map, HttpRequest, HttpResponseí–ˆëŠ”ë° í•´ë‹¹ íŒŒë¼ë¯¸í„°ê°€ í•„ìš”í•˜ì§€ ì•Šë”ë¼ ë°›ì•„ì•¼í•˜ë¯€ë¡œ ë¹„íš¨ìœ¨ì ì´ë‹¤. ì‹¤ì œ Spring MVCì—ì„œëŠ” Controller ë‹¨ì—ì„œ HttpServletRequest, HttpServletRespone ë“±ì„ ììœ ë¡­ê²Œ ë°›ì„ ìˆ˜ ìˆë˜ë°, ì–´ë–»ê²Œ ê°€ëŠ¥í•œê±´ì§€ ê³µë¶€í•´ë³´ì. public class RequestLogicMapper { static class Execution { private String methodName; private ResponseType responseType; public Execution(String methodName, ResponseType responseType) { this.methodName = methodName; this.responseType = responseType; } public String getMethodName() { return methodName; } public ResponseType getResponseType() { return responseType; } } private LogicExecutor logicExecutor = LogicExecutor.getInstance(); private static Map&lt;String, Execution&gt; getMappingUrl = new HashMap&lt;&gt;(); private static Map&lt;String, Execution&gt; postMappingUrl = new HashMap&lt;&gt;(); static { initGetRequest(); initPostRequest(); } private static void initGetRequest() { getMappingUrl.put(\"/user/create\", new Execution(\"signup\", ResponseType.HTML_PAGE)); getMappingUrl.put(\"/user/list\", new Execution(\"getUserList\", ResponseType.HTML_PAGE)); } private static void initPostRequest() { postMappingUrl.put(\"/user/create\", new Execution(\"signup\", ResponseType.HTML_PAGE)); postMappingUrl.put(\"/user/login\", new Execution(\"login\", ResponseType.HTML_PAGE)); } public ExecutionResult doRequestLogic(HttpRequest httpRequest, HttpResponse httpResponse) throws Exception { HttpMethod httpMethod = httpRequest.getHttpMethod(); String requestUrl = httpRequest.getRequestUrl(); Execution execution = null; switch (httpMethod) { case GET: execution = Optional.ofNullable(getMappingUrl.get(requestUrl)).orElseThrow(NoSuchMethodError::new); break; case POST: execution = Optional.ofNullable(postMappingUrl.get(requestUrl)).orElseThrow(NoSuchMethodError::new); break; } switch (execution.getResponseType()) { case HTML_PAGE: httpResponse.setStatusCode(HttpStatusCode3xx.Found); break; case DATA: httpResponse.setStatusCode(HttpStatusCode2xx.OK); } Map&lt;String, String&gt; params = httpRequest.getParams(); ExecutionResult result = (params != null) ? executeMethodWithParams(execution, params, httpRequest, httpResponse) : executeMethodWithoutParams(execution, httpRequest, httpResponse); return result; } public ExecutionResult executeMethodWithParams(Execution execution, Map&lt;String, String&gt; params, HttpRequest request, HttpResponse response) throws Exception { Method logic = logicExecutor.getClass().getMethod(execution.getMethodName(), Map.class, HttpRequest.class, HttpResponse.class); Object returnObj = logic.invoke(logicExecutor, params, request, response); return new ExecutionResult(execution.getResponseType(), returnObj); } public ExecutionResult executeMethodWithoutParams(Execution execution, HttpRequest request, HttpResponse response) throws Exception { Method logic = logicExecutor.getClass().getMethod(execution.getMethodName(), HttpRequest.class, HttpResponse.class); Object returnObj = logic.invoke(logicExecutor, request, response);; return new ExecutionResult(execution.getResponseType(), returnObj); }} LogicExecutor êµ¬í˜„ LogicExcecutorì—ì„œëŠ” Mapí˜•íƒœë¡œ ë°›ì€ íŒŒë¼ë¯¸í„°ë¥¼ ê°€ê³µí•˜ì—¬ ì‹¤ì œ ë¡œì§ ë©”ì„œë“œì— í•„ìš”í•œ íŒŒë¼ë¯¸í„° í˜•íƒœë¡œ ë§Œë“¤ê³  í•´ë‹¹ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤. ì´ë ‡ê²Œ í•˜ê³  ë³´ë‹ˆ LogicExecutorê°€ MVC ëª¨ë¸ì—ì„œ Controllerì™€ ì•½ê°„ ë¹„ìŠ·í•œ ì—­í• ì´ì§€ ì•Šë‚˜ í•˜ëŠ” ìƒê°ì´ ë“ ë‹¤. public class LogicExecutor { private static final LogicExecutor logicExecutor = new LogicExecutor(); private LogicExecutor(){} public static LogicExecutor getInstance() { return logicExecutor; } private UserLogic userLogic = UserLogic.getInstance(); public String signup(Map&lt;String, String&gt; params, HttpRequest request, HttpResponse response) { String id = params.get(\"userId\"); String pw = params.get(\"password\"); String name = params.get(\"name\"); String email = params.get(\"email\"); User newUser = new User(id, pw, name, email); return userLogic.signup(newUser); } public String login(Map&lt;String, String&gt; params, HttpRequest request, HttpResponse response) { String id = params.get(\"userId\"); String pw = params.get(\"password\"); return userLogic.login(id,pw,response); }}ìš”êµ¬ì‚¬í•­ 5-2 ë¡œê·¸ì¸ì´ ì„±ê³µí•˜ë©´ ë¡œê·¸ì¸ ìƒíƒœë¥¼ ìœ ì§€í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤. ì¦‰, ë¡œê·¸ì¸ì´ ì„±ê³µí•  ê²½ìš° ìš”ì²­ í—¤ë”ì˜ Cookie í—¤ë” ê°’ì´ logined = true. ë¡œê·¸ì¸ì´ ì‹¤íŒ¨í•˜ë©´ logined = falseë¡œ ì „ë‹¬ë˜ì–´ì•¼ í•œë‹¤. êµ¬í˜„public String login(String id, String pw, HttpResponse response) throws IOException { User findUser = findUser(id); if(findUser!=null &amp;&amp; pw.equals(findUser.getPassword())) { response.setCookie(\"logined=true; Path=/\"); return \"/index.html\"; } response.setCookie(\"logined=false; Path=/\"); return \"/user/login_failed.html\";}êµ¬í˜„í•˜ë©´ì„œ ì•Œê²Œëœ ê²ƒë“¤ Set-Cookie í—¤ë”ì˜ ì†ì„± ì¤‘ Pathê°’ì„ ë”°ë¡œ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ì¿ í‚¤ë¥¼ ì‘ë‹µí•œ í™”ë©´ì´ í¬í•¨ëœ ë””ë ‰í† ë¦¬ì™€ ê·¸ í•˜ìœ„ ë””ë ‰í† ë¦¬ë¡œ ìš”ì²­í•˜ëŠ” ê²½ìš°ì—ë§Œ ì¿ í‚¤ë¥¼ ì†¡ì‹ í•œë‹¤. (ì°¸ê³ )ìš”êµ¬ì‚¬í•­ 6 ì ‘ê·¼í•˜ê³  ìˆëŠ” ì‚¬ìš©ìê°€ â€œë¡œê·¸ì¸â€ ìƒíƒœì¼ ê²½ìš°(Cookieë¡œ íŒë³„) ì‚¬ìš©ì ë¦¬ìŠ¤íŠ¸ í˜ì´ì§€ë¡œ ì ‘ê·¼í–ˆì„ ë•Œ ì‚¬ìš©ì ëª©ë¡ì„ ì¶œë ¥í•œë‹¤.ë§Œì•½ ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ìƒíƒœë¼ë©´ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•œë‹¤.êµ¬í˜„ public String getUserList(HttpRequest request) { String isLogined = request.getCookie(\"logined\"); if(isLogined!=null &amp;&amp; isLogined.equals(\"true\")) { return \"/user/list.html\"; } return \"/user/login.html\"; }ìš”êµ¬ì‚¬í•­7 â€œCSS ì§€ì›í•˜ê¸°â€êµ¬í˜„í•˜ê¸° ì „ ë“¤ì—ˆë˜ ìƒê°ë“¤ ì´ˆë°˜ì— ìš”ì²­í•  ë•Œ css íŒŒì¼ë„ ìš”ì²­í•˜ê³  ì‘ë‹µë°›ëŠ”ë° ì™œ css íŒŒì¼ì´ ì ìš©ì´ ì•ˆëœ í™”ë©´ì´ ë Œë”ë§ë ê¹Œ ?êµ¬í˜„ case REQUEST_STATIC_RESOURCE: String requestUrl = httpRequest.getRequestUrl(); responseBody = (requestUrl.equals(\"/\")) ? IOUtils.convertFileToByte(indexPage) : IOUtils.convertFileToByte(requestUrl); String contentType = \"text/html;charset=utf-8\"; if(requestUrl.contains(\".css\")) { contentType = \"text/css\"; } else if(requestUrl.contains(\".js\")) { contentType = \"application/javascript\"; } httpResponse.setStatusCode(HttpStatusCode2xx.OK); httpResponse.setHeader(\"Content-Type\", contentType); httpResponse.setHeader(\"Content-Length\", responseBody.length); break;êµ¬í˜„í•˜ë©´ì„œ ì•Œê²Œëœ ê²ƒë“¤ ë¸Œë¼ìš°ì €ê°€ css íŒŒì¼ì„ ì½ê³  ì ìš©í•˜ê¸° ìœ„í•´ì„  Content-typeì„ \"text/css\"ë¡œ ì„¸íŒ…í•´ì¤˜ì•¼ í•œë‹¤ js íŒŒì¼ì€ Content-type \"application/javascript\"ë¡œ ì„¸íŒ…í•´ì¤˜ì•¼í•œë‹¤.ì •ë¦¬ êµ¬í˜„í•œ ì›¹ ì„œë²„ë¥¼ ë„ì‹í™” í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤. ìš”êµ¬ì‚¬í•­ 5~6ì—ì„œ íŒŒë¼ë¯¸í„°ë¥¼ ì›í•˜ëŠ” ê²ƒë§Œ ë°›ê²Œ í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ì§€ëŠ” ì¢€ ë” ê³µë¶€í•´ë³´ì. " }, { "title": "ã€ë‚˜ë§Œì˜ ì›¨ë”© ë§¤ë‹ˆì €ã€‘ í†µì‹  ë°©ì‹ êµ¬ì¡° ì •ì˜", "url": "/posts/my-wedding-manager-communication-architecture/", "categories": "", "tags": "", "date": "2021-06-17 22:25:00 +0900", "snippet": " ë§¤ìš° ê°„ë‹¨í•˜ê²Œ ì´ˆì•ˆì„ ê·¸ë ¤ë´¤ë‹¤. ì‚¬ì‹¤ ì§ì ‘ êµ¬í˜„í•´ë³¸ê²Œ ì•„ë‹ˆë¼ ì´ë ‡ê²Œ í•˜ëŠ”ê²Œ ë§ëŠ”ì§€ë„ ëª¨ë¥´ê² ë‹¤.ì•ìœ¼ë¡œ ì§ì ‘ êµ¬í˜„í•˜ê³  ê³µë¶€í•˜ë©´ì„œ ì•„ë˜ ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  ì‚´ì„ ë¶™ì—¬ë‚˜ê°€ì•¼ í•  ê²ƒ ê°™ë‹¤.êµ¬ì„±ë„ ê³ ê°€ìš©ì„±ì„ ìœ„í•´ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ”ê±´ ë‹¤ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•´ë³´ì. ì´ë ‡ê²Œ í•´ë´¤ì„ ë•Œ ì–´ë–¤ê²Œ ì¢‹ê³  ì•ˆ ì¢‹ì€ì§€ ë“±ì— ëŒ€í•´ ì§ì ‘ ëŠê»´ë³´ê³  ì–´ë–¤ì‹ìœ¼...", "content": " ë§¤ìš° ê°„ë‹¨í•˜ê²Œ ì´ˆì•ˆì„ ê·¸ë ¤ë´¤ë‹¤. ì‚¬ì‹¤ ì§ì ‘ êµ¬í˜„í•´ë³¸ê²Œ ì•„ë‹ˆë¼ ì´ë ‡ê²Œ í•˜ëŠ”ê²Œ ë§ëŠ”ì§€ë„ ëª¨ë¥´ê² ë‹¤.ì•ìœ¼ë¡œ ì§ì ‘ êµ¬í˜„í•˜ê³  ê³µë¶€í•˜ë©´ì„œ ì•„ë˜ ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  ì‚´ì„ ë¶™ì—¬ë‚˜ê°€ì•¼ í•  ê²ƒ ê°™ë‹¤.êµ¬ì„±ë„ ê³ ê°€ìš©ì„±ì„ ìœ„í•´ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ìˆëŠ”ê±´ ë‹¤ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•´ë³´ì. ì´ë ‡ê²Œ í•´ë´¤ì„ ë•Œ ì–´ë–¤ê²Œ ì¢‹ê³  ì•ˆ ì¢‹ì€ì§€ ë“±ì— ëŒ€í•´ ì§ì ‘ ëŠê»´ë³´ê³  ì–´ë–¤ì‹ìœ¼ë¡œ ì¬êµ¬ì„±í•˜ë©´ ì¢‹ì„ì§€ë„ ìƒê°í•´ë³´ì ì˜ ëª¨ë¥´ê² ëŠ” ë¶€ë¶„ ì˜ˆë¥¼ ë“¤ì–´ í™”ë©´ì—ì„œ ì§€ì¶œ ë“±ë¡ì„ í•˜ëŠ” ê²½ìš°, ë¹„ë™ê¸° ìš”ì²­/ì‘ë‹µ ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬í•´ì„œ ì‚¬ìš©ìì—ê²Œ â€˜ë“±ë¡ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤â€™ ë¼ëŠ” ì‹ì˜ë©”ì„¸ì§€ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆë‚˜ ?? ì‚¬ìš©ìê°€ ì¼ì •ì— ëŒ€í•´ ì•Œë¦¼ ì„¤ì •í•œ ë‚ ì§œì— ì–´ë–¤ì‹ìœ¼ë¡œ ê°ì§€í•˜ê³  ì‚¬ìš©ìì—ê²Œ ë³´ë‚´ì¤˜ì•¼í• ê¹Œ ??ì°¸ê³ ìë£Œ í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨, ã€ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´ã€, ê¸¸ë²—(2020), 3ì¥" }, { "title": "ã€ë‚˜ë§Œì˜ ì›¨ë”© ë§¤ë‹ˆì €ã€‘ DB í…Œì´ë¸” êµ¬ì„±í•˜ê¸°", "url": "/posts/my-wedding-manager-table-architecture/", "categories": "", "tags": "", "date": "2021-06-15 22:25:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ì—…ë¬´ ìš”ê±´ì„ íŒŒì•…í•˜ê³  ë°ì´í„° ëª¨ë¸ë§ì„ í†µí•´ í•„ìš”í•œ í…Œì´ë¸”ì„ ë„ì¶œí•´ë³´ì.ì—…ë¬´ ìš”ê±´ ì •ì˜ êµ¬í˜„í•´ì•¼í•  ê¸°ëŠ¥ ê´€ì ì—ì„œ ì—…ë¬´ ìš”ê±´ì„ ì •ë¦¬í•´ë³´ì•˜ë‹¤.íšŒì› ê´€ë¦¬ ë¡œê·¸ì¸ ìµœì´ˆ ë¡œê·¸ì¸ì‹œ íšŒì›ë“±ë¡ ë° ë‹¤ìŒ ì‚¬í•­ ê¸°ì… ê¶Œìœ  ê²°í˜¼ ë‚ ì§œ ë“±ë¡ (ì„ íƒ) ìµœëŒ€ ì˜ˆì‚° ë²”ìœ„ ì„¤ì • (ì„ íƒ) ê°€ê³„(ì§€ì¶œ/ìˆ˜ì…) ê´€ë¦¬ ì§€ì¶œ ë° ìˆ˜ì… ë“±ë¡,...", "content": "ë“¤ì–´ê°€ê¸° ì „ì—…ë¬´ ìš”ê±´ì„ íŒŒì•…í•˜ê³  ë°ì´í„° ëª¨ë¸ë§ì„ í†µí•´ í•„ìš”í•œ í…Œì´ë¸”ì„ ë„ì¶œí•´ë³´ì.ì—…ë¬´ ìš”ê±´ ì •ì˜ êµ¬í˜„í•´ì•¼í•  ê¸°ëŠ¥ ê´€ì ì—ì„œ ì—…ë¬´ ìš”ê±´ì„ ì •ë¦¬í•´ë³´ì•˜ë‹¤.íšŒì› ê´€ë¦¬ ë¡œê·¸ì¸ ìµœì´ˆ ë¡œê·¸ì¸ì‹œ íšŒì›ë“±ë¡ ë° ë‹¤ìŒ ì‚¬í•­ ê¸°ì… ê¶Œìœ  ê²°í˜¼ ë‚ ì§œ ë“±ë¡ (ì„ íƒ) ìµœëŒ€ ì˜ˆì‚° ë²”ìœ„ ì„¤ì • (ì„ íƒ) ê°€ê³„(ì§€ì¶œ/ìˆ˜ì…) ê´€ë¦¬ ì§€ì¶œ ë° ìˆ˜ì… ë“±ë¡, ìˆ˜ì •, ì‚­ì œ ì›í•˜ëŠ” ê¸°ê°„ ë‚´ì˜ ì§€ì¶œ/ìˆ˜ì… ë‚´ì—­ì„ ì—‘ì…€íŒŒì¼ë¡œ ë‹¤ìš´ë°›ì„ ìˆ˜ ìˆë‹¤. ì˜ˆë¹„ ì§€ì¶œ(ì§€ì¶œ ë“±ë¡ ë‚ ì§œê°€ ì˜¤ëŠ˜ ë‚ ì§œë³´ë‹¤ ì´í›„ì¸ ê²½ìš°)ì— ëŒ€í•´ ë‹¤ìŒ ë‚ ì§œ 0ì‹œë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ë¯¸ ì§€ì¶œëœ í•­ëª©ìœ¼ë¡œ ë³€ê²½í•œë‹¤.ì¼ì • ê´€ë¦¬ ì¼ì • ë“±ë¡, ìˆ˜ì •, ì‚­ì œ ì¼ì •ê³¼ ê´€ë ¨í•˜ì—¬ ì‚¬ìš©ìê°€ ì§€ì •í•´ë†“ì€ ë‚  ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ì´ ê°„ë‹¤. ì¼ì • ë‚´ì—ì„œ ë°œìƒí•˜ëŠ” ì§€ì¶œì— ëŒ€í•´ ë³µìˆ˜ë¡œ ë“±ë¡í•  ìˆ˜ ìˆë‹¤. ë“±ë¡í•œ ì¼ì •ì´ ìº˜ë¦°ë”ì— ë§µí•‘ëœë‹¤.ë°ì´í„° ëª¨ë¸ë§ê°œë… ëª¨ë¸ë§ íšŒì›ì´ ë°˜ë“œì‹œ ìˆì–´ì•¼ ì§€ì¶œ, ì¼ì •ì´ ìˆë‹¤. í•œ ëª…ì˜ íšŒì›ì´ ì—¬ëŸ¬ ë²ˆì˜ ì§€ì¶œì„ í•  ìˆ˜ ìˆìœ¼ë©°, ì—¬ëŸ¬ ê°œì˜ ì¼ì •ì´ ìˆì„ ìˆ˜ ìˆë‹¤. ì§€ì¶œê³¼ ì¼ì •ì´ ì—†ì„ ìˆ˜ë„ ìˆë‹¤. í•˜ë‚˜ì˜ ì¼ì •ì— ëŒ€í•´ ì§€ì¶œì´ ì—†ê±°ë‚˜, ì—¬ëŸ¬ ë²ˆì˜ ì§€ì¶œì´ ìˆì„ ìˆ˜ ìˆë‹¤. ë“œë ˆìŠ¤ íˆ¬ì–´(ì¼ì •) - í”¼íŒ… ë¹„ìš© + ê°€ê³„ì•½ ë¹„ìš© + ë°œë › íŒŒí‚¹ ë¹„ìš© ë“± íšŒì›ì´ ì¼ì •ì— ëŒ€í•´ ì•Œë¦¼ì„ ì‹ ì²­í•´ ë†“ëŠ” ê²½ìš° ì¼ì • ì•Œë¦¼ì— ì¶”ê°€ëœë‹¤. ì•Œë¦¼ì„ ì—¬ëŸ¬ ë²ˆ ë°›ê¸° ì›í•  ìˆ˜ë„ ìˆê¸° ë•Œë¬¸ì— 1:N ê´€ê³„ë¡œ êµ¬ì„± ì¶”í›„ ìš´ì˜ì˜ ê´€ì ì—ì„œ ìƒê°í–ˆì„ ë•Œ, ì•Œë¦¼ì— ëŒ€í•œ ì •ìƒ ì²˜ë¦¬ ì—¬ë¶€ ë“±ì„ í™•ì¸í•˜ê¸° ìœ„í•´ ì´ë ¥ì„ ê´€ë¦¬í•˜ëŠ”ê²Œ ì¢‹ì„ ê²ƒ ê°™ë‹¤ê³  íŒë‹¨í•˜ì—¬ ì¼ì • ì•Œë¦¼ ì´ë ¥ ì—”í„°í‹° ì¶”ê°€.ë…¼ë¦¬ ëª¨ë¸ë§ëª¨ë¸ë§ ê³¼ì •ì—ì„œì˜ ì˜ì‹ì˜ íë¦„.. emailë¡œ ì‚¬ìš©ìë¥¼ ì‹ë³„í•˜ëŠ” ê²ƒì˜ íƒ€ë‹¹ì„± ? ë¬¼ë¡  ì‹ë³„ì€ ë˜ì§€ë§Œ, ì¶”í›„ì— OAuthê°€ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ë°©ì‹ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ê²Œ ë˜ë©´ ê¼­ emailì´ ì•„ë‹ˆê²Œ ë  ìˆ˜ ìˆìœ¼ë¯€ë¡œ email ëŒ€ì‹  user_idê°€ ë‚˜ì„ ê²ƒ ê°™ë‹¤. ì¼ì •ì— â€˜ì „ì²´ ì§€ì¶œâ€™ ì»¬ëŸ¼ì´ ì¶”ê°€ë˜ëŠ”ê²Œ ë‚˜ì„ê¹Œ ì•„ë‹ˆë©´ ì§€ì¶œ í…Œì´ë¸”ì— ì¡°ì¸ê±¸ì–´ì„œ ê°€ì ¸ì˜¤ëŠ”ê²Œ ë‚˜ì„ê¹Œ ? JOIN ê±°ëŠ” ê²ƒ ë³´ë‹¤ëŠ” í…Œì´ë¸” ë‚´ì—ì„œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìœ¼ë©´ ì¢‹ì„ ê²ƒ ê°™ë‹¤. í˜ì´ë°±, í¬ì¸íŠ¸ ì ë¦½ ë“±ë„ ê³ ë ¤í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì§€ì¶œ ëŒ€ì‹  ë‹¤ë¥¸ ì—”í„°í‹° ì´ë¦„ì´ í•„ìš”í•  ê²ƒ ê°™ë‹¤ ! ìˆ˜ì…/ì§€ì¶œ ë‚´ì—­ ê´€ë¦¬ë¥¼ ì–´ë–¤ ë‹¨ì–´ë¡œ í‘œí˜„í•˜ë©´ ì¢‹ì„ê¹Œ ? ê³„ì¢Œë¼ëŠ” ì˜ë¯¸ë¡œ ë§ì´ ì“°ì´ì§€ë§Œ, â€˜ê°€ê³„â€™ë¼ëŠ” ëœ»ë„ ê°€ì§„ account ì •ë„ë©´ ê´œì°®ì„ ê²ƒ ê°™ë‹¤. expense, incomeì„ ë”°ë¡œ ë‘ëŠ”ê²Œ ì¢‹ì„ê¹Œ ? ì‚¬ì‹¤ ì§€ì¶œì— ë¹„í•´ ìˆ˜ì…ì€ ê±°ì˜ ì—†ì„ ê²ƒì´ë¼ê³  ìƒê°í•˜ê¸° ë•Œë¬¸ì—, êµ³ì´ í…Œì´ë¸”ì„ ë‘ ê°œë¡œ ë‚˜ëˆ„ì§€ ë§ê³  typeìœ¼ë¡œ êµ¬ë¶„í•˜ë©´ ë  ê²ƒ ê°™ë‹¤. ì¼ì •ê³¼ ê´€ë ¨ì—†ëŠ” ì§€ì¶œ/ìˆ˜ì…ì´ ìˆì„ ìˆ˜ ìˆë‹¤. (ìŠ¤ë“œë©” ì˜ˆì•½ ë¹„ìš©, í˜ì´ë°± ë“±)ì°¸ê³ . ì—”í„°í‹° ê°„ ê´€ê³„ì—ì„œ ì„  êµ¬ë¶„ ì ì„  : ë¹„ì‹ë³„ ê´€ê³„ (ë¶€ëª¨ ì—”í„°í‹°ì˜ ì‹ë³„ìê°€ ì—†ì–´ë„ ìì‹ ì—”í„°í‹°ì˜ ë ˆì½”ë“œ ìƒì„± ê°€ëŠ¥) ì„  : ì‹ë³„ ê´€ê³„ (ë¶€ëª¨ì˜ ì‹ë³„ìê°€ ìì‹ ì—”í„°í‹°ì˜ ë ˆì½”ë“œë¥¼ ì‹ë³„í•˜ëŠ”ë° ê¼­ í•„ìš”)ëŠë‚€ì ì—”í„°í‹°ì˜ ì´ë¦„, ì†ì„± ë° ì—”í„°í‹° ê°„ì˜ ê´€ê³„ëŠ” ì ì ˆí•œì§€ ë“±ì— ëŒ€í•´ ë¨¼ì € ìƒê°í•´ë´„ìœ¼ë¡œì¨, ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì œì‘í•˜ë©´ì„œ ê³ ì¹˜ë ¤ë©´ ë²ˆê±°ë¡œìš¸ ìˆ˜ ìˆì—ˆë˜ ê²ƒë“¤ì„ë¯¸ë¦¬ íŒŒì•…í•˜ê³  ì •ë¦¬í•  ìˆ˜ ìˆì—ˆë˜ ê²ƒ ê°™ë‹¤. ë˜í•œ ì—…ë¬´ ìš”ê±´ì´ ìƒì„¸í•˜ê²Œ ì •ì˜ë ìˆ˜ë¡ ì¶”í›„ì— ë³€ê²½ì´ ì ì€ í…Œì´ë¸” ì„¤ê³„ê°€ ê°€ëŠ¥í•  ê²ƒ ê°™ë‹¤.ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ íš¨ìœ¨ì ì¸ ì¿¼ë¦¬ ì§œëŠ” ë°©ë²• (JOIN ì‚¬ìš©í•  ë•Œ ì„±ëŠ¥ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ ë“±)ì°¸ê³  ìë£Œ ë°ì´í„° ëª¨ë¸ë§ ê³µë¶€í–ˆë˜ ë¶€ë¶„" }, { "title": "ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°„ í†µì‹ (3) - ë¹„ë™ê¸° ë°©ì‹", "url": "/posts/msa-pattern-chap3-3/", "categories": "", "tags": "", "date": "2021-06-14 22:25:00 +0900", "snippet": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´(í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨)â€™ 3ì¥ì„ ì½ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ë¹„ë™ê¸° ë©”ì‹œì§• íŒ¨í„´ ì‘ìš© í†µì‹  ë©”ì‹œì§•ì€ ì„œë¹„ìŠ¤ê°€ ë©”ì‹œì§€ë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì£¼ê³ ë°›ëŠ” í†µì‹  ë°©ì‹ìœ¼ë¡œì„œ ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆê³  ì„œë¹„ìŠ¤ê°„ ì§ì ‘ í†µì‹ ì„ í•  ìˆ˜ë„ ìˆë‹¤.ë¹„ë™ê¸° í†µì‹ ì´ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ê°€ ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ë©° ë¸”ë¡œí‚¹í•˜ì§€ ì•Šê³  í´ë¼ì´ì–¸íŠ¸ëŠ” ì‘ë‹µì„ ë°”ë¡œ ë°›ì§€ ...", "content": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´(í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨)â€™ 3ì¥ì„ ì½ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ë¹„ë™ê¸° ë©”ì‹œì§• íŒ¨í„´ ì‘ìš© í†µì‹  ë©”ì‹œì§•ì€ ì„œë¹„ìŠ¤ê°€ ë©”ì‹œì§€ë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì£¼ê³ ë°›ëŠ” í†µì‹  ë°©ì‹ìœ¼ë¡œì„œ ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ë„ ìˆê³  ì„œë¹„ìŠ¤ê°„ ì§ì ‘ í†µì‹ ì„ í•  ìˆ˜ë„ ìˆë‹¤.ë¹„ë™ê¸° í†µì‹ ì´ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ê°€ ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ë©° ë¸”ë¡œí‚¹í•˜ì§€ ì•Šê³  í´ë¼ì´ì–¸íŠ¸ëŠ” ì‘ë‹µì„ ë°”ë¡œ ë°›ì§€ ëª»í•  ê²ƒì´ë¼ëŠ” ì „ì œí•˜ì— ì‘ì„±í•œë‹¤.1. ë©”ì‹œì§€ì™€ ì±„ë„ ë©”ì‹œì§€ëŠ” ë©”ì‹œì§€ ì±„ë„ì„ í†µí•´ êµí™˜ëœë‹¤. ì†¡ì‹ ìê°€ ì±„ë„ì— ë©”ì‹œì§€ë¥¼ ì“°ë©´ ìˆ˜ì‹ ìëŠ” ì±„ë„ì—ì„œ ë©”ì‹œì§€ë¥¼ ì½ëŠ”ë‹¤. ë©”ì‹œì§€ í—¤ë”ì™€ ë°”ë””(ë³¸ë¬¸)ìœ¼ë¡œ êµ¬ì„± í—¤ë”ì—ëŠ” ì†¡ì‹ ëœ ë°ì´í„°ì— ê´€í•œ ë©”íƒ€ë°ì´í„°, ë©”ì‹œì§€ID, ë°˜í™˜ì£¼ì†Œ ë“±ì´ í¬í•¨ ë³¸ë¬¸ì€ ì‹¤ì œë¡œ ì†¡ì‹ í•  ë°ì´í„° í…ìŠ¤í‹‘ ë˜ëŠ” ì´ì§„ í¬ë§·ì˜ ë°ì´í„° ë©”ì‹œì§€ì˜ ì¢…ë¥˜ëŠ” ë¬¸ì„œ, ì»¤ë§¨ë“œ, ì´ë²¤íŠ¸ ë“±ìœ¼ë¡œ ë‹¤ì–‘ ë©”ì‹œì§€ ì±„ë„ ì±„ë„ì€ ì ëŒ€ì  ì±„ë„, ë°œí–‰-êµ¬ë… ì±„ë„ ë‘ ì¢…ë¥˜ê°€ ìˆë‹¤. ì ëŒ€ì  ì±„ë„ ì±„ë„ì„ ì½ëŠ” ì»¨ìŠˆë¨¸ ì¤‘ ë”± í•˜ë‚˜ë§Œ ì§€ì •í•´ì„œ ë©”ì‹œì§€ ì „ë‹¬ ì¼ëŒ€ì¼ í†µì‹  ë°©ì‹ì˜ ì„œë¹„ìŠ¤ê°€ ì´ ì±„ë„ì„ ì‚¬ìš© (ex : ì»¤ë§¨ë“œ ë©”ì‹œì§€) ë°œí–‰-êµ¬ë… ì±„ë„ ê°™ì€ ì±„ë„ì„ ë°”ë¼ëª¨ëŠ” ëª¨ë“  ì»¨ìŠˆë¨¸ì— ë©”ì‹œì§€ ì „ë‹¬ ì¼ëŒ€ë‹¤ í†µì‹  ë°©ì‹ì˜ ì„œë¹„ìŠ¤ê°€ ì´ ì±„ë„ì„ ì‚¬ìš© (ex : ì´ë²¤íŠ¸ ë©”ì‹œì§€) ì¶œì²˜ : https://thebook.io/007035/ch03/03/01/02/ 2. ë©”ì‹œì§€ ìƒí˜¸ ì‘ìš© ìŠ¤íƒ€ì¼ ìŠ¤íƒ€ì¼ì— ë”°ë¼ ë©”ì‹œì§•ìœ¼ë¡œ ì§ì ‘ êµ¬í˜„ ê°€ëŠ¥í•œ ê²ƒ, ë©”ì‹œì§•ì„ í† ëŒ€ë¡œ êµ¬í˜„í•´ì•¼ í•˜ëŠ” ê²ƒë„ ìˆë‹¤.ìš”ì²­/ì‘ë‹µ ë° ë¹„ë™ê¸° ìš”ì²­/ì‘ë‹µ í´ë¼ì´ì–¸íŠ¸ëŠ” ìˆ˜í–‰í•  ì‘ì—…ê³¼ ë§¤ê°œë³€ìˆ˜ê°€ ë‹´ê¸´ ì»¤ë§¨ë“œ ë©”ì‹œì§€ë¥¼ ì„œë¹„ìŠ¤ê°€ ì†Œìœ í•œ ì ëŒ€ì  ë©”ì‹œì§• ì±„ë„ë¡œ ì†¡ì‹  ì„œë¹„ìŠ¤ëŠ” ìš”ì²­ ì²˜ë¦¬ í›„ ì‘ë‹µ ë©”ì‹œì§€ë¥¼ í´ë¼ì´ì–¸íŠ¸ê°€ ì†Œìœ í•œ ì ëŒ€ì  ë©”ì‹œì§• ì±„ë„ë¡œ ì†¡ì‹  ìš”ì²­ ë©”ì‹œì§€ì™€ ì‘ë‹µ ë©”ì‹œì§€ëŠ” ì§ì´ ë§ì•„ì•¼ í•˜ëŠ”ë°, ì´ëŠ” MessageIdì™€ CorrelationIdë¥¼ í†µí•´ ë§ì¶°ë³¼ ìˆ˜ ìˆë‹¤. ë©”ì‹œì§•ìœ¼ë¡œ í†µì‹ í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸/ì„œë¹„ìŠ¤ ê°„ ìƒí˜¸ì‘ìš©ì€ ë¹„ë™ê¸°ì ì´ë‹¤. ì´ë¡ ì ìœ¼ë¡œ í´ë¼ì´ì–¸íŠ¸ê°€ ì‘ë‹µ ìˆ˜ì‹ ì‹œê¹Œì§€ ë¸”ë¡œí‚¹í•  ìˆ˜ëŠ” ìˆì§€ë§Œ, ì‹¤ì œë¡œ í´ë¼ì´ì–¸íŠ¸ëŠ” ì‘ë‹µì„ ë¹„ë™ê¸° ì²˜ë¦¬ í•˜ê³ í´ë¼ì´ì–¸íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ì¤‘ í•˜ë‚˜ê°€ ì‘ë‹µì„ ì²˜ë¦¬ ì¶œì²˜ : https://thebook.io/007035/ch03/03/02/01/ ë‹¨ë°©í–¥ ì•Œë¦¼ ì„œë¹„ìŠ¤ê°€ ì†Œìœ í•œ ì ëŒ€ì  ì±„ë„ë¡œ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ë©´, ì„œë¹„ìŠ¤ëŠ” ì´ ì±„ë„ì„ êµ¬ë…í•´ì„œ ë©”ì‹œì§€ ì²˜ë¦¬ ì„œë¹„ìŠ¤ëŠ” ì‘ë‹µì„ ë°˜í™˜í•˜ì§€ ì•ŠëŠ”ë‹¤.ë°œí–‰/êµ¬ë… í´ë¼ì´ì–¸íŠ¸ëŠ” ì—¬ëŸ¬ ì»¨ìŠˆë¨¸ê°€ ì½ëŠ” ë°œí–‰/êµ¬ë… ì±„ë„ì— ë©”ì‹œì§€ë¥¼ ë°œí–‰í•˜ê³ , ì„œë¹„ìŠ¤ëŠ” ë„ë©”ì¸ ê°ì²´ì˜ ë³€ê²½ ì‚¬ì‹¤ì„ ì•Œë¦¬ëŠ” ë„ë©”ì¸ ì´ë²¤íŠ¸ë¥¼ ë°œí–‰ ë„ë©”ì¸ ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í•œ ì„œë¹„ìŠ¤ëŠ” í•´ë‹¹ ë„ë©”ì¸ í´ë˜ìŠ¤ì˜ ì´ë¦„ì„ ë”´ ë°œí–‰/êµ¬ë… ì±„ë„ì„ ì†Œìœ  (ex : ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” Order ì´ë²¤íŠ¸ë¥¼ Order ì±„ë„ì— ë°œí–‰) ì„œë¹„ìŠ¤ëŠ” ìì‹ ì´ ê´€ì‹¬ ìˆëŠ” ë„ë©”ì¸ ê°ì²´ì˜ ì´ë²¤íŠ¸ ì±„ë„ì„ êµ¬ë…ë°œí–‰/ë¹„ë™ê¸° ì‘ë‹µ ë°œí–‰/êµ¬ë…ê³¼ ìš”ì²­/ì‘ë‹µ ë°©ì‹ì„ ì¡°í•© í´ë¼ì´ì–¸íŠ¸ëŠ” ì‘ë‹µ ì±„ë„ í—¤ë”ê°€ ëª…ì‹œëœ ë©”ì‹œì§€ë¥¼ ë°œí–‰/êµ¬ë… ì±„ë„ì— ë°œí–‰í•˜ê³ , ì»¨ìŠˆë¨¸ëŠ” CorrelationIdê°€ í¬í•¨ëœ ì‘ë‹µ ë©”ì‹œì§€ë¥¼ì§€ì •ëœ ì‘ë‹µ ì±„ë„ì— ì†¡ì‹  í´ë¼ì´ì–¸íŠ¸ëŠ” CorrelationIdë¡œ ì‘ë‹µì„ ì·¨í•©í•˜ì—¬ ì‘ë‹µ ë©”ì‹œì§€ì™€ ìš”ì²­ì„ ë§ì¶”ì–´ë³¸ë‹¤3. ë©”ì‹œì§€ ë¸Œë¡œì»¤ ë©”ì‹œì§€ ë¸Œë¡œì»¤ëŠ” ì„œë¹„ìŠ¤ê°€ ì„œë¡œ í†µì‹ í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì¸í”„ë¼ ì„œë¹„ìŠ¤ë¡œì„œ, ë©”ì‹œì§• ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ëŒ€ë¶€ë¶„ ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¥¼ ì‚¬ìš©í•œë‹¤.ì„œë¹„ìŠ¤ê°€ ì„œë¡œ ì§ì ‘ í†µì‹ í•˜ëŠ” ë¸Œë¡œì»¤ë¦¬ìŠ¤ ê¸°ë°˜ì˜ ë©”ì‹œì§€ ì•„í‚¤í…ì²˜ë„ ìˆì§€ë§Œ ì¼ë°˜ì ìœ¼ë¡œ ë¸Œë¡œì»¤ ê¸°ë°˜ì˜ ì•„í‚¤í…ì²˜ê°€ ê°–ëŠ” ì´ì ì´ í¬ë‹¤.ë¸Œë¡œì»¤ë¦¬ìŠ¤ ì•„í‚¤í…ì²˜ ì„œë¹„ìŠ¤ê°„ ë©”ì‹œì§€ë¥¼ ì§ì ‘ êµí™˜ ëŒ€í‘œì ì¸ ë¸Œë¡œì»¤ë¦¬ìŠ¤ ë©”ì‹œì§• ê¸°ìˆ ë¡œëŠ” ZeroMQê°€ ìˆë‹¤. ì¥ì  ì„œë¹„ìŠ¤ê°„ ì§ì ‘ ì „ë‹¬ë˜ë¯€ë¡œ ë„¤íŠ¸ì›Œí¬ íŠ¸ë˜í”½ì´ ê°€ë³ê³  ì§€ì—° ì‹œê°„ì´ ì§§ë‹¤. ë©”ì‹œì§€ ë¸Œë¡œì»¤ê°€ ì„±ëŠ¥ ë³‘ëª©ì ì´ë‚˜ SPOF(Single Poing Of Failure, ë‹¨ì¼ ì¥ì• ì )ì´ ë  ì¼ì´ ì—†ë‹¤. ë¸Œë¡œì»¤ê°€ ì—†ê¸° ë•Œë¬¸ì— ê´€ë¦¬ í¬ì¸íŠ¸ê°€ ì ì–´ì§„ë‹¤. ë‹¨ì  ì„œë¹„ìŠ¤ê°€ ì„œë¡œì˜ ìœ„ì¹˜ë¥¼ ì•Œê³  ìˆì–´ì•¼ í•˜ë¯€ë¡œ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ë§¤ì»¤ë‹ˆì¦˜ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ì†¡/ìˆ˜ì‹ ì ëª¨ë‘ ì‹¤í–‰ ì¤‘ì´ì–´ì•¼ í•˜ë¯€ë¡œ ê°€ìš©ì„±ì´ ë–¨ì–´ì§„ë‹¤. ì „ë‹¬ ë³´ì¥(delivery-guarantee) ê°™ì€ ë§¤ì»¤ë‹ˆì¦˜ì„ êµ¬í˜„í•˜ê¸° ì–´ë µë‹¤. ë¸Œë¡œì»¤ ê¸°ë°˜ ë©”ì‹œì§• ê°œìš” ëŒ€í‘œì ì¸ ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¡œì„œ ActiveMQ, RabbitMQ, ì•„íŒŒì¹˜ ì¹´í”„ì¹´ê°€ ìˆë‹¤. AWS í‚¤ë„¤ì‹œìŠ¤, AWS SQSì™€ ê°™ì€ í´ë¼ìš°ë“œ ê¸°ë°˜ì˜ ë©”ì‹œì§• ì„œë¹„ìŠ¤ë„ ìˆë‹¤. ì¥ì  ëŠìŠ¨í•œ ê²°í•© í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ëª°ë¼ë„ ë˜ê¸° ë•Œë¬¸ì— ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ë§¤ì»¤ë‹ˆì¦˜ë„ í•„ìš” ì—†ë‹¤. ë©”ì‹œì§€ ë²„í¼ë§ ë©”ì‹œì§€ ë¸Œë¡œì»¤ëŠ” ì»¨ìŠˆë¨¸ê°€ ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•  ìˆ˜ ìˆì„ ë•Œê¹Œì§€ íì— ë©”ì‹œì§€ë¥¼ ë³´ê´€í•˜ë¯€ë¡œ ê°€ìš©ì„±ì´ ë†’ì•„ì§„ë‹¤. ë‹¤ì–‘í•œ í†µì‹  ë°©ì‹ì„ ì§€ì› ë‹¨ì  ì„±ëŠ¥ ë³‘ëª© ê°€ëŠ¥ì„± ë©”ì‹œì§€ ë¸Œë¡œì»¤ê°€ ì„±ëŠ¥ ë³‘ëª©ì ì´ ë  ê°€ëŠ¥ì„±ì´ ìˆë‹¤.(ë”°ë¼ì„œ, í™•ì¥ì„±ì´ ì¢‹ì•„ì•¼í•œë‹¤) ë‹¨ì¼ ì¥ì• ì  ê°€ëŠ¥ì„± SPOFê°€ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ê°€ìš©ì„±ì´ ë†’ì•„ì•¼í•œë‹¤. ìš´ì˜ ë³µì¡ë„ ë¶€ê°€ ë¸Œë¡œì»¤ë³„ë¡œ íŠ¹ì§•ì´ ìˆë‹¤. ì–´ë–¤ ë¸Œë¡œì»¤ëŠ” ì§€ì—° ì‹œê°„ì´ ë§¤ìš° ì§§ì§€ë§Œ ë©”ì‹œì§€ ìˆœì„œ ìœ ì§€ ë° ì „ë‹¬ ë³´ì¥ì´ ì•ˆëœë‹¤ê±°ë‚˜, ë©”ì‹œì§€ë¥¼ ë©”ëª¨ë¦¬ì—ë§Œ ì €ì¥í•œë‹¤. ì–´ë–¤ ë¸Œë¡œì»¤ëŠ” ì§€ì—° ì‹œê°„ì€ ê¸¸ì§€ë§Œ, ë©”ì‹œì§€ ì „ë‹¬ì„ ë³´ì¥í•˜ê³  ë””ìŠ¤í¬ì— ì €ì¥í•œë‹¤. ë”°ë¼ì„œ, ì• í”Œë¦¬ì¼€ì´ì…˜ ìš”ê±´ì— ë”°ë¼ ì í•©í•œ ë¸Œë¡œì»¤ë¥¼ ì„ íƒí•´ì•¼ í•œë‹¤.ë©”ì‹œì§€ ë¸Œë¡œì»¤ë¡œ ë©”ì‹œì§€ ì±„ë„ êµ¬í˜„ ë©”ì‹œì§€ ì±„ë„ì€ ë¸Œë¡œì»¤ë§ˆë‹¤ êµ¬í˜„ ë°©ì‹ì´ ì¡°ê¸ˆì”© ë‹¤ë¥´ë‹¤. ë©”ì‹œì§€ ë¸Œë¡œì»¤ ì ëŒ€ì  ì±„ë„ ë°œí–‰-êµ¬ë… ì±„ë„ JMS í í† í”½ ì•„íŒŒì¹˜ ì¹´í”„ì¹´ í† í”½ í† í”½ RabbitMQ(AMQP ë¸Œë¡œì»¤) ìµìŠ¤ì²´ì¸ì§€+í íŒ¬ì•„ì›ƒ ìµìŠ¤ì²´ì¸ì§€, ì»¨ìŠˆë¨¸ ê°œë³„ í AWS í‚¤ë„¤ì‹œìŠ¤ ìŠ¤íŠ¸ë¦¼ ìŠ¤íŠ¸ë¦¼ AWS SQS í - 4. ìˆ˜ì‹ ì ê²½í•©ê³¼ ë©”ì‹œì§€ ìˆœì„œ ìœ ì§€ ì˜ˆë¥¼ ë“¤ì–´, ë™ì¼í•œ ì ëŒ€ì  ì±„ë„ì„ ì½ëŠ” ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ê°€ 3ê°œ ìˆê³ , ì†¡ì‹ ìëŠ” ì£¼ë¬¸ ìƒì„± â†’ ë³€ê²½ â†’ ì·¨ì†Œ ì´ë²¤íŠ¸ ë©”ì‹œì§€ë¥¼ ì°¨ë¡€ë¡œ ì „ì†¡í•œë‹¤ê³  ê°€ì •í•´ë³´ì.ë§Œì•½ ë„¤íŠ¸ì›Œí¬ ì´ìŠˆ, ê°€ë¹„ì§€ ì»¬ë ‰ì…˜ ë¬¸ì œ ë“±ìœ¼ë¡œ ì§€ì—°ì´ ë°œìƒí•˜ê³  ë©”ì‹œì§€ ì²˜ë¦¬ ìˆœì„œê°€ ì–´ê¸‹ë‚œë‹¤ë©´,ì£¼ë¬¸ì„ ìƒì„±í•˜ê¸°ë„ ì „ì— ì·¨ì†Œ ì²˜ë¦¬ë¥¼ í•´ì•¼í•˜ëŠ” ìƒí™©ì´ ë²Œì–´ì§ˆ ìˆ˜ë„ ìˆë‹¤.ë”°ë¼ì„œ, ë©”ì‹œì§€ë¥¼ ë™ì‹œ ì²˜ë¦¬í•˜ëŠ” ê²½ìš° ê° ë©”ì‹œì§€ë¥¼ ì •í™•íˆ í•œ ë²ˆë§Œ ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ë³´ì¥ë˜ì–´ì•¼ í•œë‹¤.ìƒ¤ë”©ëœ(íŒŒí‹°ì…”ë‹ëœ) ì±„ë„ ì´ìš©í•´ì„œ ë©”ì‹œì§€ ì²˜ë¦¬ ìˆœì„œ ë³´ì¥í•˜ê¸° ìƒ¤ë”©ëœ ì±„ë„ì€ ë³µìˆ˜ì˜ ìƒ¤ë“œë¡œ êµ¬ì„±ë˜ë©°, ê° ìƒ¤ë“œëŠ” ì±„ë„ì²˜ëŸ¼ ì‘ë™ ì†¡ì‹ ìëŠ” ë©”ì‹œì§€ í—¤ë”ì— ìƒ¤ë“œ í‚¤ë¥¼ ì§€ì •í•˜ê³ , ë©”ì‹œì§€ ë¸Œë¡œì»¤ëŠ” ìƒ¤ë“œ í‚¤ë³„ë¡œ ìƒ¤ë“œ/íŒŒí‹°ì…˜ì— ë©”ì‹œì§€ë¥¼ ë°°ì • ë©”ì‹œì§€ ë¸Œë¡œì»¤ëŠ” ì—¬ëŸ¬ ìˆ˜ì‹ ì ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë¬¶ì–´ ë§ˆì¹˜ ë™ì¼í•œ ìˆ˜ì‹ ìì¸ ê²ƒì²˜ëŸ¼ ì·¨ê¸‰í•œë‹¤(ì¹´í”„ì¹´ì—ì„  â€˜ì»¨ìŠˆë¨¸ ê·¸ë£¹â€™) ë©”ì‹œì§€ ë¸Œë¡œì»¤ëŠ” ê° ìƒ¤ë“œë¥¼ í•˜ë‚˜ì˜ ìˆ˜ì‹ ìì— ë°°ì •í•˜ê³ , ìˆ˜ì‹ ìê°€ ì‹œë™/ì¢…ë£Œí•˜ë©´ ìƒ¤ë“œë¥¼ ì¬ë°°ì •í•œë‹¤. ì•„ë˜ ê·¸ë¦¼ì—ì„œ ê°™ì€ ì£¼ë¬¸ì— ëŒ€í•œ ì´ë²¤íŠ¸(ì£¼ë¬¸ ìƒì„±, ë³€ê²½, ì·¨ì†Œ ë“±)ëŠ” ë™ì¼í•œ ìƒ¤ë“œì— ë°œí–‰ë  ê²ƒì´ê³ (ìƒ¤ë“œ í‚¤ì¸ orderIdê°€ ê°™ìœ¼ë¯€ë¡œ)ìƒ¤ë“œëŠ” í•˜ë‚˜ì˜ ìˆ˜ì‹ ì ì¸ìŠ¤í„´ìŠ¤ì— ë°°ì •ë˜ê¸° ë•Œë¬¸ì— ë©”ì‹œì§€ ì²˜ë¦¬ ìˆœì„œê°€ ë³´ì¥ëœë‹¤. ì¶œì²˜ : https://thebook.io/007035/ch03/03/05-01/ 5. ì¤‘ë³µ ë©”ì‹œì§€ ì²˜ë¦¬ ì‹œìŠ¤í…œì´ ì •ìƒì¼ ë•Œ â€˜ì ì–´ë„ í•œ ë²ˆ ì „ë‹¬â€™ì„ ë³´ì¥í•˜ëŠ” ë©”ì‹œì§€ ë¸Œë¡œì»¤ëŠ” ê° ë©”ì‹œì§€ë¥¼ í•œ ë²ˆë§Œ ì „ë‹¬í•œë‹¤.ê·¸ëŸ¬ë‚˜ í´ë¼ì´ì–¸íŠ¸ë‚˜ ë„¤íŠ¸ì›Œí¬ ë˜ëŠ” ë¸Œë¡œì»¤ ìì‹ ì´ ì‹¤íŒ¨í•  ê²½ìš°, ê°™ì€ ë©”ì‹œì§€ë¥¼ ì—¬ëŸ¬ë²ˆ ì „ë‹¬í•  ìˆ˜ë„ ìˆë‹¤.ë‹¨ì ì¸ ì˜ˆë¡œ, ì£¼ë¬¸ ìƒì„± â†’ ì·¨ì†Œ ì´ë²¤íŠ¸ë¥¼ ë°œí–‰í–ˆëŠ”ë° ë¬¸ì œê°€ ìƒê²¨ ìƒì„± ì´ë²¤íŠ¸ë§Œ ì¬ì „ì†¡í•˜ê²Œ ë˜ë©´,ê²°êµ­ ì£¼ë¬¸ì´ ì ‘ìˆ˜ë˜ëŠ” ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤.ë©±ë“±í•œ ë¡œì§ ì‘ì„± ë©±ë“±í•˜ë‹¤ : ë™ì¼í•œ ì…ë ¥ ê°’ì„ ë°˜ë³µ í˜¸ì¶œí•´ë„ ê²°ê³¼ê°€ ë‹¬ë¼ì§€ì§€ ì•ŠëŠ”ë‹¤ (ex : ì£¼ë¬¸ ì·¨ì†Œ) ë©”ì‹œì§€ ì¬ì „ì†¡ì‹œ ìˆœì„œë¥¼ ìœ ì§€í•˜ë‹¤ëŠ” ì „ì œí•˜ì— ë©±ë“±í•œ ë©”ì‹œì§€ ë¡œì§ì€ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œë˜ë„ ë³„ ë¬¸ì œê°€ ì—†ë‹¤. í•˜ì§€ë§Œ ì‹¤ì œë¡œ ì´ë ‡ê²Œ ë©±ë“±í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ì€ ë§ì§€ ì•Šë‹¤.ë©”ì‹œì§€ ì¶”ì ê³¼ ì¤‘ë³µ ë©”ì‹œì§€ ì†ì•„ ë‚´ê¸° ì˜ˆë¥¼ ë“¤ì–´, ì‹ ìš©ì¹´ë“œ ê²°ì œ ìŠ¹ì¸ê³¼ ê°™ì€ ë¡œì§ì€ ì—¬ëŸ¬ë²ˆ í˜¸ì¶œë˜ë©´ ì‹¬ê°í•œ ë¬¸ì œë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ì¤‘ë³µ ë©”ì‹œì§€ë¥¼ ì†ì•„ ë‚´ëŠ” ë©”ì‹œì§€ í•¸ë“¤ëŸ¬ê°€ í•„ìš”í•˜ë‹¤. í•˜ë‚˜ì˜ ë°©ë²•ìœ¼ë¡œ ì»¨ìŠˆë¨¸ê°€ ì†Œë¹„í•˜ëŠ” ë©”ì‹œì§€ IDë¥¼ DB í…Œì´ë¸”ì— ì €ì¥í•˜ì—¬ ë©”ì‹œì§€ IDë¥¼ ì´ìš©í•˜ì—¬ ë©”ì‹œì§€ ì²˜ë¦¬ ì—¬ë¶€ë¥¼ ì¶”ì í•˜ë©´ì„œ ì¤‘ë³µ ë©”ì‹œì§€ë¥¼ ì•Œì•„ë‚¸ë‹¤. ì¦‰, ì»¨ìŠˆë¨¸ëŠ” ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•  ë•Œ ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í„°í‹°ë¥¼ ìƒì„±/ìˆ˜ì •í•˜ëŠ” íŠ¸ëœì­ì…˜ì˜ ì¼ë¶€ë¡œ ë©”ì‹œì§€ IDë¥¼ DB í…Œì´ë¸”ì— ê¸°ë¡í•œë‹¤.6. íŠ¸ëœì­ì…”ë„ ë©”ì‹œì§• DB ì—…ë°ì´íŠ¸ì™€ ë©”ì‹œì§€ ì „ì†¡ì„ í•œ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ë¬¶ì§€ ì•Šìœ¼ë©´, DB ì—…ë°ì´íŠ¸ í›„ ë©”ì‹œì§€ëŠ” ì•„ì§ ì „ì†¡ë˜ì§€ ì•Šì€ ìƒíƒœì—ì„œ ì„œë¹„ìŠ¤ê°€ ì¤‘ë‹¨ë  ìˆ˜ ìˆë‹¤.ì´ ë‘ ì‘ì—…ì´ ì„œë¹„ìŠ¤ì—ì„œ ì›ìì ìœ¼ë¡œ ìˆ˜í–‰ë˜ì§€ ì•Šìœ¼ë©´, ì‹¤íŒ¨í•  ê²½ìš° ì‹œìŠ¤í…œì€ ë§¤ìš° ë¶ˆì•ˆì •í•œ ìƒíƒœê°€ ë  ìˆ˜ ìˆë‹¤.ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë©”ì‹œì§€ë¥¼ í™•ì‹¤í•˜ê²Œ ë°œí–‰í•˜ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ ?DB í…Œì´ë¸”ì„ ë©”ì‹œì§€ íë¡œ í™œìš© RDBMS ê¸°ë°˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ê²½ìš° DB í…Œì´ë¸”ì„ ì„ì‹œ ë©”ì‹œì§€ íë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.(íŠ¸ëœì­ì…”ë„ ì•„ì›ƒ ë°•ìŠ¤ íŒ¨í„´) ë¡œì»¬ ACID íŠ¸ëœì­ì…˜ì´ê¸° ë•Œë¬¸ì— ì›ìì„±ì€ ìë™ìœ¼ë¡œ ë³´ì¥ëœë‹¤. NoSQL DBì¸ ê²½ìš°ì—ëŠ” DBì— ë ˆì½”ë“œë¡œ ì ì¬ëœ ë¹„ì¦ˆë‹ˆìŠ¤ ì—”í„°í‹°ì— ë°œí–‰í•  ë©”ì‹œì§€ ëª©ë¡ì„ ê°€ë¦¬í‚¤ëŠ” ì†ì„±ì—DB ì—”í„°í‹° ì—…ë°ì´íŠ¸ì‹œ ë©”ì‹œì§€ë¥¼ ë§ë¶™ì¸ë‹¤. ì¶œì²˜ : https://thebook.io/007035/ch03/03/07/01/ ì´ë²¤íŠ¸ ë°œí–‰ : í´ë§ ë°œí–‰ê¸° íŒ¨í„´ ë©”ì‹œì§€ ë¦´ë ˆì´ë¡œ í…Œì´ë¸”ì„ í´ë§í•´ì„œ ë¯¸ë°œí–‰ ë©”ì‹œì§€ë¥¼ ì¡°íšŒ ë©”ì‹œì§€ ë¦´ë ˆì´ëŠ” ì¡°íšŒí•œ ë©”ì‹œì§€ë¥¼ í•˜ë‹ˆì”© ê°ìì˜ ëª©ì ì§€ ì±„ë„ë¡œ ë³´ë‚´ì„œ ë©”ì‹œì§€ ë¸Œë¡œì»¤ì— ë°œí–‰í•˜ê³  OUTBOX í…Œì´ë¸”ì—ì„œ ë©”ì‹œì§€ ì‚­ì œ DB í´ë§ì€ ê·œëª¨ê°€ ì‘ì€ ê²½ìš° ì í•©í•˜ê³ , ìì£¼ í•˜ëŠ” ê²½ìš° ë¹„ìš©ì´ ìœ ë°œëœë‹¤.ì´ë²¤íŠ¸ ë°œí–‰ : íŠ¸ëœì­ì…˜ ë¡œê·¸ í…Œì¼ë§ íŒ¨í„´ ë©”ì‹œì§€ ë¦´ë ˆì´ë¡œ DB íŠ¸ëœì­ì…˜ ë¡œê·¸(ì»¤ë°‹ ë¡œê·¸)ë¥¼ í…Œì¼ë§í•œë‹¤. íŠ¸ëœì­ì…˜ ë¡œê·¸ ë§ˆì´ë„ˆë¡œ ë¡œê·¸ë¥¼ ì½ì–´ ë³€ê²½ë¶„ì„ í•˜ë‚˜ì”© ë©”ì‹œì§€ë¡œ ë¸Œë¡œì»¤ì—ê²Œ ë°œí–‰ íŠ¸ëœì­ì…˜ ë¡œê·¸ ë§ˆì´ë„ˆëŠ” ë¡œê·¸ í•­ëª©ì„ ì½ê³ , ì‚½ì…ëœ ë©”ì‹œì§€ì— ëŒ€ì‘ë˜ëŠ” ê° ë¡œê·¸ í•­ëª©ì„ ë©”ì‹œì§€ë¡œ ì „í™˜í•˜ì—¬ ë¸Œë¡œì»¤ì— ë°œí–‰ ì´ ë°©ì‹ì„ ì‘ìš©í•œ ì‚¬ë¡€ë¡œëŠ”, ë””ë¹„ì§€ì›€, ë§í¬ë“œì¸ ë°ì´í„°ë²„ìŠ¤, DynamoDB, ì´ë²¤ì¶”ì—ì´íŠ¸ íŠ¸ë¨ ë“±ì´ ìˆë‹¤. ì¶œì²˜ : https://thebook.io/007035/ch03/03/07/03/ ë™ê¸° ìƒí˜¸ ë°©ì‹ ì œê±°í•˜ê¸° ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì—ì„œ íƒ€ ì„œë¹„ìŠ¤ì™€ ë™ê¸° í†µì‹ ì„ í•˜ë©´ ê·¸ë§Œí¼ ê°€ìš©ì„±ì´ ë–¨ì–´ì§€ë¯€ë¡œ ê°€ëŠ¥í•œ ì„œë¹„ìŠ¤ê°€ ë¹„ë™ê¸° ë©”ì‹œì§•ì„ ì´ìš©í•˜ì—¬ í†µì‹ í•˜ë„ë¡ ì„¤ê³„í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•˜ë‹¤.ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬ ë™ê¸° ë°©ì‹ìœ¼ë¡œ ì²˜ë¦¬ ì¶œì²˜ : https://thebook.io/007035/ch03/04/01/ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë°”ê¿”ë³´ê¸° ì¶œì²˜ : https://thebook.io/007035/ch03/04/02/01/ ë°ì´í„° ë³µì œ ì„œë¹„ìŠ¤ ìš”ì²­ ì²˜ë¦¬ì— í•„ìš”í•œ ë°ì´í„°ì˜ ë ˆí”Œë¦¬ì¹´ë¥¼ ìœ ì§€í•˜ëŠ” ë°©ë²• ë°ì´í„° ë ˆí”Œë¦¬ì¹´ë¥¼ í†µí•´ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ ìƒí˜¸ ì‘ìš©í•  í•„ìš”ê°€ ì—†ì–´ì§„ë‹¤. í•˜ì§€ë§Œ ëŒ€ìš©ëŸ‰ ë°ì´í„°ì˜ ë ˆí”Œë¦¬ì¹´ë¥¼ ë§Œë“œëŠ” ê²ƒì€ ë§¤ìš° ë¹„íš¨ìœ¨ì ì´ë‹¤. ì¶œì²˜ : https://thebook.io/007035/ch03/04/02/02/ ì‘ë‹µ ë°˜í™˜ í›„ ë§ˆë¬´ë¦¬ ì¶œì²˜ : https://thebook.io/007035/ch03/04/02/03-01/ ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” ë‹¤ë¥¸ ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šì€ ì±„ ì£¼ë¬¸ì„ ìƒì„±í•œ í›„, ë‹¤ë¥¸ ì„œë¹„ìŠ¤ì™€ ë©”ì‹œì§€ë¥¼ êµí™˜í•˜ì—¬ ìƒì„±í•œ Orderë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ ê²€ì¦í•œë‹¤. ì´ë ‡ê²Œ ì²˜ë¦¬í•˜ë©´ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ê°€ ë‚´ë ¤ê°€ë”ë¼ë„ ì£¼ë¬¸ ì„œë¹„ìŠ¤ëŠ” ê³„ì† ì£¼ë¬¸ì„ ìƒì„±í•˜ê³  í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µì„ í•  ìˆ˜ ìˆë‹¤.ë‚˜ì¤‘ì— ë¬¸ì œê°€ ëë˜ ì„œë¹„ìŠ¤ê°€ ì¬ê¸°ë™ ë˜ë©´ íì— ìŒ“ì¸ ë©”ì‹œì§€ë¥¼ ì²˜ë¦¬í•˜ê³  ë°€ë¦° ì£¼ë¬¸ì„ ê²€ì¦í•  ìˆ˜ ìˆë‹¤. ì´ì²˜ëŸ¼ ìš”ì²­ì„ ì™„ì „íˆ ì²˜ë¦¬í•˜ê¸° ì „ì— í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µí•˜ëŠ” ì„œë¹„ìŠ¤ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì¡°ê¸ˆ ë³µì¡í•´ì§„ë‹¤. í´ë¼ì´ì–¸íŠ¸ ì…ì¥ì—ì„œ ì£¼ë¬¸ ìƒì„± ì„±ê³µ ì—¬ë¶€ë¥¼ ì•Œì•„ë‚´ë ¤ë©´ ì£¼ê¸°ì ìœ¼ë¡œ í´ë§í•˜ê±°ë‚˜ ì£¼ë¬¸ ì„œë¹„ìŠ¤ê°€ ì•Œë¦¼ ë©”ì‹œì§€ë¥¼ ë³´ë‚´ì¤˜ì•¼ í•œë‹¤. ë³µì¡í•˜ì§€ë§Œ ë™ê¸° ë°©ì‹ë³´ë‹¤ëŠ” ì´ê²Œ ë” ë‚˜ì€ ë°©ë²•ì´ë‹¤. ì™œëƒí•˜ë©´ ë¶„ì‚° íŠ¸ëœì­ì…˜ ê´€ë¦¬ ì´ìŠˆë¥¼ ì´ëŸ° ë°©ì‹ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤. ì‹¤ì œë¡œ ì ìš©í•´ë³´ê¸° í† ì´ í”„ë¡œì íŠ¸ â€˜ë‚˜ë§Œì˜ ì›¨ë”© ë§¤ë‹ˆì €â€™ í†µì‹  ë°©ì‹ êµ¬ì¡°ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ ë…¼ë¸”ë¡œí‚¹ / ë¹„ë™ê¸° ë¡œê·¸ í…Œì¼ë§ ë©”ì‹œì§€ ë¸Œë¡œì»¤ë³„ íŠ¹ì§•ì°¸ê³  ìë£Œ í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨, ã€ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´ã€, ê¸¸ë²—(2020), p104-152." }, { "title": "ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°„ í†µì‹ (2) - ë™ê¸° ë°©ì‹", "url": "/posts/msa-pattern-chap3-2/", "categories": "", "tags": "", "date": "2021-06-14 22:25:00 +0900", "snippet": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´(í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨)â€™ 3ì¥ì„ ì½ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ë™ê¸° RPI íŒ¨í„´ ì‘ìš© í†µì‹  RPI(Remote Procedure Invocation)ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë¹„ìŠ¤ì— ìš”ì²­ì„ ë³´ë‚´ê³  ì„œë¹„ìŠ¤ê°€ ì²˜ë¦¬ í›„ ì‘ë‹µì„ íšŒì‹ í•˜ëŠ” IPC ì‘ë‹µ ëŒ€ê¸° ì¤‘ì— ë¸”ë¡œí‚¹í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸, ë¦¬ì•¡í‹°ë¸Œí•œ ë…¼ë¸”ë¡œí‚¹ ì•„í‚¤í…ì²˜ë¥¼ ê°€ì§„ í´ë¼ì´ì–¸íŠ¸ë„ ìˆì§€ë§Œ,...", "content": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´(í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨)â€™ 3ì¥ì„ ì½ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.ë™ê¸° RPI íŒ¨í„´ ì‘ìš© í†µì‹  RPI(Remote Procedure Invocation)ëŠ” í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë¹„ìŠ¤ì— ìš”ì²­ì„ ë³´ë‚´ê³  ì„œë¹„ìŠ¤ê°€ ì²˜ë¦¬ í›„ ì‘ë‹µì„ íšŒì‹ í•˜ëŠ” IPC ì‘ë‹µ ëŒ€ê¸° ì¤‘ì— ë¸”ë¡œí‚¹í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸, ë¦¬ì•¡í‹°ë¸Œí•œ ë…¼ë¸”ë¡œí‚¹ ì•„í‚¤í…ì²˜ë¥¼ ê°€ì§„ í´ë¼ì´ì–¸íŠ¸ë„ ìˆì§€ë§Œ, ë©”ì‹œì§•ìœ¼ë¡œ í†µì‹ í•˜ëŠ” í´ë¼ì´ì–¸íŠ¸ì™€ ë‹¬ë¦¬ì‘ë‹µì´ ì œë•Œ ë„ì°©í•œë‹¤ê³  ê°€ì •í•œë‹¤. RPIì˜ ì‘ë™ ì›ë¦¬ í´ë¼ì´ì–¸íŠ¸ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì€ í”„ë¡ì‹œ ì¸í„°í˜ì´ìŠ¤ í˜¸ì¶œ (í”„ë¡ì‹œ ì¸í„°í˜ì´ìŠ¤ëŠ” RPI í”„ë¡ì‹œ ì–´ëŒ‘í„° í´ë˜ìŠ¤ë¡œ êµ¬í˜„) RPI í”„ë¡ì‹œê°€ ì„œë¹„ìŠ¤ì— ì „ë‹¬í•œ ìš”ì²­ì€ RPI ì„œë²„ ì–´ëŒ‘í„° í´ë˜ìŠ¤ê°€ ì ‘ìˆ˜ ì´ í´ë˜ìŠ¤ëŠ” ì„œë¹„ìŠ¤ ì¸í„°í˜ì´ìŠ¤ë¥¼ í†µí•´ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ í˜¸ì¶œ ì¶œì²˜ : https://thebook.io/007035/ch03/02-01/ 1. ë™ê¸° RPI íŒ¨í„´ : REST HTTP ë™ì‚¬ë¥¼ ì‚¬ìš©í•´ì„œ URLë¡œ ì°¸ì¡°ë˜ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì¡°ì‘ REST API ì„¤ê³„ì‹œ, ì–´ë–»ê²Œ ìµœì†Œí•œì˜ í˜¸ì¶œ(ìš”ì²­)ë¡œ ì—°ê´€ëœ ë§ì€ ê°ì²´ë“¤ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì„ì§€ ê³ ë¯¼í•´ì•¼í•œë‹¤. ë”°ë¼ì„œ ë°ì´í„°ë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì¡°íšŒí•  ìˆ˜ ìˆê²Œ ì„¤ê³„ëœ GraphQL, Netflix Falcorë“±ì˜ ê¸°ìˆ ì´ ê°ê´‘ì„ ë°›ê¸° ì‹œì‘í–ˆë‹¤. ì¥ì  API ìì²´ê°€ ë‹¨ìˆœí•˜ê³ , Postman, curl ë“±ì˜ ë„êµ¬ë¥¼ ì‚¬ìš©í•´ì„œ í…ŒìŠ¤íŠ¸ë¥¼ ê°„í¸í•˜ê²Œ í•  ìˆ˜ ìˆë‹¤. HTTPëŠ” ë°©í™”ë²½ ì¹œí™”ì (ë°©í™”ë²½ ì…ì¥ì—ì„œ ì‰½ê²Œ ì ‘ê·¼ ê°€ëŠ¥í•œ íŠ¹ì„±ì„ ì§€ë‹Œë‹¤ - ë‹¨ì¼ í¬íŠ¸ ì‚¬ìš©, ì¸í„°ë„·ì—ì„œ ì„œë²„ ì ‘ì† ê°€ëŠ¥, TCP ì‚¬ìš©) ì¤‘ê°„ ë¸Œë¡œì»¤ê°€ í•„ìš”í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ê°€ ë‹¨ìˆœí•´ì§„ë‹¤. ë‹¨ì  ì‹œë‚˜ë¦¬ì˜¤ê°€ ë³µì¡í•´ì§ˆìˆ˜ë¡ íš¨ìœ¨ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆë‹¤. ìš”ì²­/ì‘ë‹µ ìŠ¤íƒ€ì¼ì˜ í†µì‹ ë§Œ ì§€ì›í•œë‹¤. í´ë¼ì´ì–¸íŠ¸/ì„œë¹„ìŠ¤ê°€ ì§ì ‘ í†µì‹ í•˜ê¸° ë•Œë¬¸ì— ê°€ìš©ì„±ì´ ë–¨ì–´ì§ˆ ìˆ˜ ìˆë‹¤.(í•­ìƒ ì–‘ìª½ ëª¨ë‘ê°€ ì‹¤í–‰ì¤‘ì´ì–´ì•¼ í•˜ê¸° ë•Œë¬¸ì—) ìš”ì²­ í•œ ë²ˆìœ¼ë¡œ ì—¬ëŸ¬ ë¦¬ì†ŒìŠ¤ë¥¼ ê°€ì ¸ì˜¤ê¸° ì–´ë µë‹¤. ë‹¤ì¤‘ ì—…ë°ì´íŠ¸ ì‘ì—…ì„ HTTP ë™ì‚¬ì— ë§¤í•‘í•˜ê¸° ì–´ë ¤ìš¸ ìˆ˜ ìˆë‹¤. 2. ë™ê¸° RPI íŒ¨í„´ : gRPC gRPCëŠ” êµ¬ê¸€ì—ì„œ ê°œë°œí•œ RPC(Remote Procedure Call) ì‹œìŠ¤í…œì´ë‹¤. HTTPëŠ” í•œì •ëœ ë™ì‚¬ë§Œ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ë‹¤ì–‘í•œ ì—…ë°ì´íŠ¸ ì‘ì—…ì„ ì§€ì›í•˜ëŠ” REST APIë¥¼ ì„¤ê³„í•˜ê¸°ê°€ ì‰½ì§€ ì•Šë‹¤.ë°”ë¡œ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê³ ì ë“±ì¥í•œ ê¸°ìˆ ì´ ë°”ë¡œ gRPCì´ë‹¤. ì¥ì  ë‹¤ì–‘í•œ ì—…ë°ì´íŠ¸ ì‘ì—…ì´ í¬í•¨ëœ APIë¥¼ ì„¤ê³„í•˜ê¸° ì‰½ë‹¤ í° ë©”ì‹œì§€ë¥¼ êµí™˜í•  ë•Œ ì½¤íŒ©íŠ¸í•˜ê³  íš¨ìœ¨ì ì´ë‹¤ ì–‘ë°©í–¥ ìŠ¤íŠ¸ë¦¬ë°ìœ¼ë¡œ ì¸í•´ RPI, ë©”ì‹œì§• ë‘ ê°€ì§€ í†µì‹  ë°©ì‹ì´ ëª¨ë‘ ê°€ëŠ¥í•˜ë‹¤. ë‹¤ì–‘í•œ ì–¸ì–´ë¡œ ì‘ì„±ëœ í´ë¼ì´ì–¸íŠ¸/ì„œë²„ ê°„ ì—°ë™ì´ ê°€ëŠ¥í•˜ë‹¤. ë‹¨ì  ìë°”ìŠ¤í¬ë¦½íŠ¸ í´ë¼ì´ì–¸íŠ¸ê°€ í•˜ëŠ”ì¼ì´ REST/JSON ê¸°ë°˜ API ë³´ë‹¤ ë§ë‹¤. êµ¬í˜„ ë°©í™”ë²½ì€ HTTP/2ë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. 3. ë¶€ë¶„ ì‹¤íŒ¨ ì²˜ë¦¬ ë¶„ì‚° ì‹œìŠ¤í…œì€ ì„œë¹„ìŠ¤ê°€ ë‹¤ë¥¸ ì„œë¹„ìŠ¤ë¥¼ ë™ê¸° í˜¸ì¶œí•  ë•Œë§ˆë‹¤ ë¶€ë¶„ ì‹¤íŒ¨í•  ê°€ëŠ¥ì„±ì´ í•­ìƒ ì¡´ì¬í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìš”ì²­ì— ì œë•Œ ì‘ë‹µí•˜ì§€ ëª»í•˜ê±°ë‚˜,ìš”ì²­í•œ ì„œë¹„ìŠ¤ê°€ ë‚´ë ¤ê°€ëŠ” ë“±ì˜ ìƒí™©ì´ ìˆì„ ìˆ˜ ìˆë‹¤. í´ë¼ì´ì–¸íŠ¸ëŠ” ì‘ë‹µì„ ê¸°ë‹¤ë¦¬ë©´ì„œ ë¸”ë¡œí‚¹ë˜ê¸° ë•Œë¬¸ì— ìš”ì²­í•œ ì„œë¹„ìŠ¤ì˜ ì‹¤íŒ¨ê°€í´ë¼ì´ì–¸íŠ¸ë¡œ ê±°ìŠ¬ëŸ¬ ì˜¬ë¼ê°€ë©´ì„œ ì „ì²´ ì‹œìŠ¤í…œì˜ ì¤‘ë‹¨ì„ ì´ˆë˜í•  ìˆ˜ë„ ìˆë‹¤. ë”°ë¼ì„œ, ë¶€ë¶„ ì‹¤íŒ¨ê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì— ì „íŒŒë˜ì§€ ì•Šë„ë¡ì„œë¹„ìŠ¤ë¥¼ ì„¤ê³„í•´ì•¼ í•œë‹¤.ê²¬ê³ í•œ RPI í”„ë¡ì‹œ ì„¤ê³„ë¥¼ í†µí•œ í•´ê²° ë°©ë²• Netflix HistrixëŠ” ì•„ë˜ì™€ ê°™ì€ ë‹¤ì–‘í•œ íŒ¨í„´ì´ êµ¬í˜„ëœ ì˜¤í”ˆ ì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë¯€ë¡œ JVM í™˜ê²½ì´ë¼ë©´ ì´ë¥¼ í†µí•´ RPI í”„ë¡ì‹œë¥¼ êµ¬í˜„í•´ë³´ëŠ” ê²ƒì„ ê¶Œì¥. ë„¤íŠ¸ì›Œí¬ íƒ€ì„ì•„ì›ƒ ì‘ë‹µ ëŒ€ê¸°ì‹œ ë¬´í•œì • ë¸”ë¡œí‚¹ë˜ì§€ ì•Šë„ë¡ íƒ€ì„ì•„ì›ƒ ì„¤ì •í•˜ì—¬ ë¦¬ì†ŒìŠ¤ ê³ ê°ˆ ë°©ì§€ ë¯¸ì²˜ë¦¬ ìš”ì²­ ê°œìˆ˜ ì œí•œ í´ë¼ì´ì–¸íŠ¸ê°€ íŠ¹ì • ì„œë¹„ìŠ¤ì— ìš”ì²­ ê°€ëŠ¥í•œ ë¯¸ì²˜ë¦¬ ìš”ì²­ì˜ ìµœëŒ€ ê°œìˆ˜ ì„¤ì • ìµœëŒ€ ê°œìˆ˜ì— ì´ë¥´ë©´ í•´ë‹¹ ìš”ì²­ì€ ì¦‰ì‹œ ì‹¤íŒ¨ ì²˜ë¦¬ íšŒë¡œ ì°¨ë‹¨ê¸° íŒ¨í„´ ì„±ê³µ/ì‹¤íŒ¨ ë¹„ìœ¨(ì—ëŸ¬ìœ¨)ì´ ì„ê³„ì¹˜ë¥¼ ì´ˆê³¼í•˜ë©´ ê·¸ ì´í›„ ìš”ì²­ì€ ë°”ë¡œ ì‹¤íŒ¨ë¡œ ì²˜ë¦¬ íƒ€ì„ì•„ì›ƒ ì‹œê°„ ì´í›„ í´ë¼ì´ì–¸íŠ¸ê°€ ì¬ì‹œë„í•´ì„œ ì„±ê³µí•˜ë©´ íšŒë¡œ ì°¨ë‹¨ê¸°ëŠ” ë‹«íŒë‹¤. ì‹¤íŒ¨ì‹œ ì¡°ì¹˜ ë°©ë²• ê²°ì • Netflix Histrix ê°™ì€ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë¶€ë¶„ì ì¸ ì†”ë£¨ì…˜ì— ë¶ˆê³¼í•˜ê¸° ë•Œë¬¸ì—ë¬´ì‘ë‹µ ì›ê²© ì„œë¹„ìŠ¤ë¥¼ ì–´ë–»ê²Œ ë³µêµ¬í•˜ë©´ ì¢‹ì„ì§€ëŠ” ìƒí™©ì— ë§ê²Œ íŒë‹¨í•´ì•¼ í•œë‹¤. í´ë¼ì´ì–¸íŠ¸ê°€ ì•Œ ìˆ˜ ìˆë„ë¡ ìš”ì²­ ì„œë¹„ìŠ¤ì—ì„œ í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì—ëŸ¬ ë°˜í™˜ ë¶€ë¶„ ì‹¤íŒ¨ ì‹œ ë¯¸ë¦¬ ì •í•´ì§„ ê¸°ë³¸ê°’ì´ë‚˜ ìºì‹œëœ ì‘ë‹µ ë“± ëŒ€ì²´ ê°’(fallback value) ë°˜í™˜ ìœ„ ë°©ë²• ì´ì™¸ì—ë„ ê°ê°ì˜ ì„œë¹„ìŠ¤ê°€ ì‹¤íŒ¨í•  ê²½ìš°ë¥¼ ëŒ€ë¹„í•œ ëŒ€ì‘ ë°©ì•ˆì´ ì¤€ë¹„ë˜ì–´ ìˆì–´ì•¼ í•œë‹¤.4. ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ì„œë¹„ìŠ¤ë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œëŠ” ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì˜ IP ì£¼ì†Œ ë° í¬íŠ¸ë¥¼ ì•Œê³  ìˆì–´ì•¼ í•œë‹¤. í´ë¼ìš°ë“œ ê¸°ë°˜ì˜ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ì´ëŸ¬í•œ ë„¤íŠ¸ì›Œí¬ ìœ„ì¹˜ê°€ ë™ì ì´ê¸° ë•Œë¬¸ì—ì´ë¥¼ ì‹ë³„í•˜ëŠ” ì¼ì´ ê²°ì½” ê°„ë‹¨í•˜ì§€ ì•Šë‹¤. ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ë§ˆë‹¤ ë„¤íŠ¸ì›Œí¬ ìœ„ì¹˜ê°€ ë™ì  ë°°ì •ë˜ê³ , ìë™ í™•ì¥, ì‹¤íŒ¨, ì—…ê·¸ë ˆì´ë“œ ë“± ì—¬ëŸ¬ ê°€ì§€ ì‚¬ìœ ë¡œ ê³„ì† ë‹¬ë¼ì§€ë¯€ë¡œì´ëŸ¬í•œ ë„¤íŠ¸ì›Œí¬ ìœ„ì¹˜ë¥¼ ê´€ë¦¬í•´ì¤„ â€˜ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬â€™ê°€ ë°˜ë“œì‹œ í•„ìš”í•˜ë‹¤.ì„œë¹„ìŠ¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬(Service Registry) ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ì˜ ë„¤íŠ¸ì›Œí¬ ìœ„ì¹˜ë¥¼ DBí™” í•œ ê²ƒ ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ê°€ ì‹œì‘/ì¢…ë£Œí•  ë•Œë§ˆë‹¤ ì„œë¹„ìŠ¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ ì—…ë°ì´íŠ¸ í´ë¼ì´ì–¸íŠ¸ì—ì„œ ì„œë¹„ìŠ¤ í˜¸ì¶œì‹œ, ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ê°€ ì„œë¹„ìŠ¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì—ì„œ ê°€ìš© ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ëª©ë¡ì„ ê°€ì ¸ì˜¤ê³  ê·¸ì¤‘ í•œ ì„œë¹„ìŠ¤ë¡œ ìš”ì²­ì„ ë³´ë‚¸ë‹¤. ì„œë¹„ìŠ¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ì¼ë°˜ì ì¸ ë°©ë²• í´ë¼ì´ì–¸íŠ¸/ì„œë¹„ìŠ¤ê°€ ì§ì ‘ ì„œë¹„ìŠ¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ì™€ ìƒí˜¸ ì‘ìš© ë°°í¬ ì¸í”„ë¼ë¡œ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ì²˜ë¦¬ ëŒ€í‘œì ì¸ ì„œë¹„ìŠ¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¡œëŠ” Netflix Eurekaê°€ ìˆë‹¤.ì• í”Œë¦¬ì¼€ì´ì…˜ ìˆ˜ì¤€ì˜ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ íŒ¨í„´ ì„œë¹„ìŠ¤ í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë¹„ìŠ¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬ë¡œë¶€í„° ì „ì²´ ì¸ìŠ¤í„´ìŠ¤ ëª©ë¡ì„ ê°€ì ¸ì™€ í•œ ì¸ìŠ¤í„´ìŠ¤ë¡œ ìš”ì²­ì„ ë¼ìš°íŒ…í•œë‹¤. ë¼ìš°íŒ…ì‹œ ë¼ìš´ë“œ-ë¡œë¹ˆ, ëœë¤ê³¼ ê°™ì€ ë¶€í•˜ë¶„ì‚° ì•Œê³ ë¦¬ì¦˜ ì‚¬ìš© ì¥ì  ë‹¤ì–‘í•œ í”Œë«í¼ì— ì„œë¹„ìŠ¤ê°€ ë°°í¬ëœ ê²½ìš°ì—ë„ ì²˜ë¦¬ ê°€ëŠ¥ (ex : ì„œë¹„ìŠ¤ ì¼ë¶€ëŠ” ì¿ ë²„ë„¤í‹°ìŠ¤, ë‚˜ë¨¸ì§€ëŠ” ë ˆê±°ì‹œ í™˜ê²½) ë‹¨ì  ì‚¬ìš©í•˜ëŠ” ì–¸ì–´(í”„ë ˆì„ì›Œí¬)ì— ë§ëŠ” ê°ê°ì˜ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ í•„ìš”(ë”°ë¼ì„œ, ë°°í¬ ì¸í”„ë¼ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ë§¤ì»¤ë‹ˆì¦˜ í™œìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤) ì¶œì²˜ : https://thebook.io/007035/ch03/02/04/02/ í”Œë«í¼ì— ë‚´ì¥ëœ ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ íŒ¨í„´ ë„ì»¤, ì¿ ë²„ë„¤í‹°ìŠ¤ ë“±ê³¼ ê°™ì€ ìµœì‹  ë°°í¬ í”Œë«í¼ì—ëŠ” ëŒ€ë¶€ë¶„ ì„œë¹„ìŠ¤ ë ˆì§€ìŠ¤íŠ¸ë¦¬, ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ ë§¤ì»¤ë‹ˆì¦˜ì´ íƒ‘ì¬ë˜ì–´ ìˆë‹¤. ë°°í¬ í”Œë«í¼ì€ ê°€ìƒIP(VIP) ì£¼ì†Œ, VIP ì£¼ì†Œë¡œ í•´ì„ë˜ëŠ” DNSëª…ì„ ê° ì„œë¹„ìŠ¤ë§ˆë‹¤ ë¶€ì—¬ ì„œë¹„ìŠ¤ í´ë¼ì´ì–¸íŠ¸ê°€ DNSëª…/VIPë¥¼ ìš”ì²­í•˜ë©´ ë°°í¬ í”Œë«í¼ì´ ê°€ìš© ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ ì¤‘ í•˜ë‚˜ë¡œ ìš”ì²­ì„ ë¼ìš°íŒ… ì¦‰, ë°°í¬ í”Œë«í¼ì´ ì„œë¹„ìŠ¤ ë“±ë¡, ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬, ìš”ì²­ ë¼ìš°íŒ…ì„ ì „ë¶€ ë‹´ë‹¹ ì¶œì²˜ : https://thebook.io/007035/ch03/02/04/03/ ì‹¤ì œë¡œ ì ìš©í•´ë³´ê¸° í† ì´ í”„ë¡œì íŠ¸ â€˜ë‚˜ë§Œì˜ ì›¨ë”© ë§¤ë‹ˆì €â€™ í†µì‹  ë°©ì‹ êµ¬ì¡°ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ gRPC ë¸”ë¡œí‚¹ê³¼ ë™ê¸°ì°¸ê³  ìë£Œ í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨, ã€ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´ã€, ê¸¸ë²—(2020), p104-152." }, { "title": "ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ê°„ í†µì‹ (1) - ê°œìš”", "url": "/posts/msa-pattern-chap3-1/", "categories": "", "tags": "", "date": "2021-06-14 22:25:00 +0900", "snippet": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´(í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨)â€™ 3ì¥ì„ ì½ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.Intro í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹ (Inter-Process Communication) í”„ë¡œì„¸ìŠ¤ë“¤ ì‚¬ì´ì— ì„œë¡œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” í–‰ìœ„ ë˜ëŠ” ê·¸ì— ëŒ€í•œ ë°©ë²•ì´ë‚˜ ê²½ë¡œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë¡œ êµ¬ì„±í•˜ë©°, ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´...", "content": "â€» í•´ë‹¹ ë‚´ìš©ì€ â€˜ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´(í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨)â€™ 3ì¥ì„ ì½ê³  ì •ë¦¬í•œ ë‚´ìš©ì…ë‹ˆë‹¤.Intro í”„ë¡œì„¸ìŠ¤ ê°„ í†µì‹ (Inter-Process Communication) í”„ë¡œì„¸ìŠ¤ë“¤ ì‚¬ì´ì— ì„œë¡œ ë°ì´í„°ë¥¼ ì£¼ê³ ë°›ëŠ” í–‰ìœ„ ë˜ëŠ” ê·¸ì— ëŒ€í•œ ë°©ë²•ì´ë‚˜ ê²½ë¡œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì•„í‚¤í…ì²˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì—¬ëŸ¬ ì„œë¹„ìŠ¤ë¡œ êµ¬ì„±í•˜ë©°, ì„œë¹„ìŠ¤ ì¸ìŠ¤í„´ìŠ¤ëŠ” ì—¬ëŸ¬ ë¨¸ì‹ ì—ì„œ ì‹¤í–‰ë˜ëŠ” í”„ë¡œì„¸ìŠ¤ í˜•íƒœì´ë¯€ë¡œë°˜ë“œì‹œ IPCë¥¼ í†µí•´ ìƒí˜¸ì‘ìš© í•´ì•¼í•œë‹¤. IPCëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ê°€ìš©ì„±(ì •ìƒì ìœ¼ë¡œ ì‚¬ìš©ê°€ëŠ¥í•œ ì •ë„)ì— ì˜í–¥ì„ ë¯¸ì¹˜ë©°, íŠ¸ëœì­ì…˜ ê´€ë¦¬ì™€ë„ ë§ë¬¼ë ¤ ìˆë‹¤.IPC ê°œìš”1. í†µì‹  ë°©ì‹ Â  ì¼ëŒ€ì¼ ì¼ëŒ€ë‹¤ ë™ê¸° ìš”ì²­ / ì‘ë‹µ - ë¹„ë™ê¸° ë¹„ë™ê¸° ìš”ì²­ / ì‘ë‹µ ë‹¨ë°©í–¥ ì•Œë¦¼ ë°œí–‰ / êµ¬ë… ë°œí–‰ / ë¹„ë™ê¸° ì‘ë‹µ ìš”ì²­/ì‘ë‹µ í´ë¼ì´ì–¸íŠ¸ëŠ” ì‘ë‹µì´ ì œë•Œ ë„ì°©í•  ê²ƒì„ ê¸°ë‹¤ë¦¬ë©° ëŒ€ê¸°í•˜ëŠ” ë™ì•ˆ ë¸”ë¡œí‚¹ëœë‹¤. ì„œë¹„ìŠ¤ì™€ ê°•í•˜ê²Œ ê²°í•©ëœë‹¤. ë¹„ë™ê¸° ìš”ì²­/ì‘ë‹µ í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë¹„ìŠ¤ì— ìš”ì²­í•˜ê³  ì„œë¹„ìŠ¤ëŠ” ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‘ë‹µ. í´ë¼ì´ì–¸íŠ¸ëŠ” ì‘ë‹µì— ëŒ€í•œ ëŒ€ê¸° ì¤‘ì— ë¸”ë¡œí‚¹í•˜ì§€ ì•ŠëŠ”ë‹¤. ë‹¨ë°©í–¥ ì•Œë¦¼ í´ë¼ì´ì–¸íŠ¸ëŠ” ì„œë¹„ìŠ¤ì— ìš”ì²­ì„ í•˜ê³  ì„œë¹„ìŠ¤ëŠ” ì‘ë‹µì„ ë³´ë‚´ì§€ ì•ŠëŠ”ë‹¤. (ì–´ë–¤ ê²½ìš° ??) ë°œí–‰/êµ¬ë… í´ë¼ì´ì–¸íŠ¸ëŠ” ì•Œë¦¼ ë©”ì‹œì§€ë¥¼ ë°œí–‰í•˜ê³  ì—¬ê¸°ì— ê´€ì‹¬ ìˆëŠ” 0ê°œ ì´ìƒì˜ ì„œë¹„ìŠ¤ê°€ ë©”ì‹œì§€ë¥¼ ì†Œë¹„ ë°œí–‰/ë¹„ë™ê¸° ì‘ë‹µ í´ë¼ì´ì–¸íŠ¸ëŠ” ìš”ì²­ ë©”ì‹œì§€ë¥¼ ë°œí–‰í•˜ê³  ì£¼ì–´ì§„ ì‹œê°„ ë™ì•ˆ ê´€ë ¨ ì„œë¹„ìŠ¤ê°€ ì‘ë‹µí•˜ê¸¸ ê¸°ë‹¤ë¦°ë‹¤. 2. ë©”ì‹œì§€ í¬ë§· IPCì˜ í•µì‹¬ì€ ë©”ì‹œì§€ êµí™˜ì´ë©°, ëŒ€ë¶€ë¶„ì˜ ë©”ì‹œì§€ëŠ” ë°ì´í„°ë¥¼ ë‹´ê³  ìˆê¸° ë•Œë¬¸ì— ë°ì´í„° í¬ë§·ì€ ì¤‘ìš”í•œ ì„¤ê³„ ê²°ì • í•­ëª©ì´ë‹¤. ë©”ì‹œì§€ í¬ë§·ì€ í¬ê²Œ í…ìŠ¤íŠ¸ì™€ ì´ì§„ í¬ë§·ìœ¼ë¡œ ë¶„ë¥˜ëœë‹¤.í…ìŠ¤íŠ¸ ë©”ì‹œì§€ í¬ë§· ëŒ€í‘œì ì¸ ì˜ˆë¡œ JSON, XMLì´ ìˆë‹¤. ì¥ì  ìê¸° ì„œìˆ ì (ê·¸ ìì²´ë§Œìœ¼ë¡œë„ ì˜ë¯¸ê°€ ë¶„ëª…í•œ)ì´ë‹¤. ë©”ì‹œì§€ ì»¨ìŠˆë¨¸ëŠ” ìì‹ ì´ ê´€ì‹¬ ìˆëŠ” ê°’ë§Œ ê³¨ë¼ ì“°ë©´ ë˜ë¯€ë¡œ ìŠ¤í‚¤ë§ˆê°€ ìì£¼ ë°”ë€Œì–´ë„ í•˜ìœ„ í˜¸í™˜ì„±ì´ ì‰½ê²Œ ë³´ì¥ëœë‹¤. ë‹¨ì  ë©”ì‹œì§€ê°€ ë‹¤ì†Œ ê¸¸ë‹¤ (íŠ¹íˆ, XML) ì†ì„±ê°’ ì´ì™¸ì— ì†ì„±ëª…ì´ ì¶”ê°€ë˜ëŠ” ì˜¤ë²„í—¤ë“œê°€ ìˆë‹¤. ë°ì´í„°ê°€ ë§ì€ ë©”ì‹œì§€ëŠ” í…ìŠ¤íŠ¸ë¥¼ íŒŒì‹±í•˜ëŠ” ì˜¤ë²„í—¤ë“œê°€ ìˆë‹¤. ì´ì§„ ë©”ì‹œì§€ í¬ë§· (???) ëŒ€í‘œì ìœ¼ë¡œ í”„ë¡œí† ì½œ ë²„í¼ì™€ ì•„ë¸Œë¡œê°€ ìˆë‹¤. ë©”ì‹œì§€ êµ¬ì¡° ì •ì˜ì— í•„ìš”í•œ íƒ€ì… IDL(Interface Definition Language)ë¥¼ ì œê³µ ì»´íŒŒì¼ëŸ¬ëŠ” ë©”ì‹œì§€ë¥¼ ì§ë ¬í™”/ì—­ì§ë ¬í™”í•˜ëŠ” ì½”ë“œ ìƒì„± ë”°ë¼ì„œ, ì„œë¹„ìŠ¤ë¥¼ API ìš°ì„  ì ‘ê·¼ ë°©ì‹ìœ¼ë¡œ ì„¤ê³„í•  ìˆ˜ë°–ì— ì—†ë‹¤.ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ ì´ì§„ ë©”ì„¸ì§€ í¬ë§·ì°¸ê³  ìë£Œ í¬ë¦¬ìŠ¤ ë¦¬ì²˜ë“œìŠ¨, ã€ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ íŒ¨í„´ã€, ê¸¸ë²—(2020), p104-152." }, { "title": "Multi Page Application vs Single Page Application", "url": "/posts/spa-vs-mpa/", "categories": "", "tags": "", "date": "2021-06-04 00:25:00 +0900", "snippet": "MPA(Multi Page Application) í´ë¼ì´ì–¸íŠ¸ê°€ ìƒˆë¡œìš´ í˜ì´ì§€ë¥¼ ìš”ì²­í•  ë•Œë§ˆë‹¤ ì„œë²„ì— ëœë”ë§í•˜ë„ë¡ ìš”ì²­í•œë‹¤. ì´ëŸ¬í•œ ë°©ì‹ì„ SSR(Server-Side-Rendering)ì´ë¼ê³  í•œë‹¤. MPAë¥¼ ì‚¬ìš©í•œë‹¤ê³  ì•Œë ¤ì§„ ëŒ€í‘œì ì¸ ì„œë¹„ìŠ¤ë¡œëŠ” Amazon, eBay ë“±ì´ ìˆë‹¤. ì¶œì²˜ : https://dzone.com/articles/th...", "content": "MPA(Multi Page Application) í´ë¼ì´ì–¸íŠ¸ê°€ ìƒˆë¡œìš´ í˜ì´ì§€ë¥¼ ìš”ì²­í•  ë•Œë§ˆë‹¤ ì„œë²„ì— ëœë”ë§í•˜ë„ë¡ ìš”ì²­í•œë‹¤. ì´ëŸ¬í•œ ë°©ì‹ì„ SSR(Server-Side-Rendering)ì´ë¼ê³  í•œë‹¤. MPAë¥¼ ì‚¬ìš©í•œë‹¤ê³  ì•Œë ¤ì§„ ëŒ€í‘œì ì¸ ì„œë¹„ìŠ¤ë¡œëŠ” Amazon, eBay ë“±ì´ ìˆë‹¤. ì¶œì²˜ : https://dzone.com/articles/the-comparison-of-single-page-and-multi-page-appliì¥/ë‹¨ì  ì¥ì  í•œ í˜ì´ì§€ë‹¹ í•˜ë‚˜ì˜ í‚¤ì›Œë“œì— ëŒ€í•´ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìµœì í™”í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— SEO(Search Engine Optimization, ê²€ìƒ‰ ì—”ì§„ ìµœì í™”)ê°€ ì‰½ë‹¤. í•„ìš”í•œ ë§Œí¼ í˜ì´ì§€ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. í˜ì´ì§€ì— ë§ì€ ì •ë³´ë¥¼ í‘œì‹œí•´ì•¼ í•  ë•Œ ìœ ë¦¬í•˜ë‹¤. ë‹¨ì  í”„ë¡ íŠ¸ì™€ ë°±ì—”ë“œ ê°œë°œì´ ê°•í•˜ê²Œ ê²°í•©ëœë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì»¨í…ì¸ ê°€ ì§€ì†ì ìœ¼ë¡œ ë‹¤ì‹œ ë¡œë“œë˜ë¯€ë¡œ ì„œë²„ì˜ ë¶€í•˜ê°€ ì¦ê°€í•œë‹¤. ë”°ë¼ì„œ, ì›¹ í˜ì´ì§€ ì†ë„ì™€ ì „ì²´ ì‹œìŠ¤í…œ ì„±ëŠ¥ì— ë¶€ì •ì ì¸ ì˜í–¥ì„ ë¯¸ì¹  ìˆ˜ ìˆë‹¤. SPA(Single Page Application) ì—í”Œë¦¬ì¼€ì´ì…˜ì— í•„ìš”í•œ ëª¨ë“  ì •ì  ë¦¬ì†ŒìŠ¤ë¥¼ ìµœì´ˆ í•œ ë²ˆì— ë‹¤ìš´ë¡œë“œí•œë‹¤. ê·¸ ì´í›„ ìƒˆë¡œìš´ í˜ì´ì§€ ìš”ì²­ì´ ìˆì„ ë•Œ, í˜ì´ì§€ ê°±ì‹ ì— í•„ìš”í•œ ë°ì´í„°ë§Œ ì „ë‹¬ ë°›ì•„ì„œ í˜ì´ì§€ë¥¼ ê°±ì‹ í•œë‹¤. ë¸Œë¼ìš°ì € ë‚´ì—ì„œ ì‘ë™í•˜ë©° ì‚¬ìš©í•˜ëŠ” ë™ì•ˆ í˜ì´ì§€ë¥¼ ë‹¤ì‹œ ë¡œë“œí•  í•„ìš”ê°€ ì—†ë‹¤. JavaScriptë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë“  ì»¨í…ì¸ ë¥¼ ë¡œë“œí•œë‹¤. SPAë¥¼ ì‚¬ìš©í•œë‹¤ê³  ì•Œë ¤ì§„ ëŒ€í‘œì ì¸ ì„œë¹„ìŠ¤ë¡œëŠ” Gmail, Google ì§€ë„, Facebook, GitHub ë“±ì´ ìˆë‹¤. ì´ëŸ¬í•œ ë°©ì‹ì„ CSR(Client-Side-Rendering)ì´ë¼ê³  í•œë‹¤. SPAë„ í•„ìš”ì— ë”°ë¼ SSR(Server Side Rendering) ë°©ì‹ìœ¼ë¡œ ë Œë”ë§í•  ìˆ˜ ìˆë‹¤. ì¶œì²˜ : https://dzone.com/articles/the-comparison-of-single-page-and-multi-page-appliì¥/ë‹¨ì  ì¥ì  ëŒ€ë¶€ë¶„ì˜ ë¦¬ì†ŒìŠ¤(HTML+CSS+js)ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ìµœì´ˆ í•œ ë²ˆë§Œ ë¡œë“œë˜ë¯€ë¡œ, ìµœì´ˆ ë¡œë“œëœ ì´í›„ í˜ì´ì§€ ëœë”ë§ì´ ë¹ ë¥´ë‹¤. ì„œë²„ì—ì„œ í˜ì´ì§€ë¥¼ ë Œë”ë§í•˜ê¸° ìœ„í•´ ì½”ë“œë¥¼ ì‘ì„±í•  í•„ìš”ê°€ ì—†ë‹¤. ì¼ë°˜ì ìœ¼ë¡œ ì„œë²„ë¥¼ ì „í˜€ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ ê°œë°œì„ ì‹œì‘í•  ìˆ˜ ìˆë‹¤. ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ë° ë„¤ì´í‹°ë¸Œ ëª¨ë°”ì¼ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ë™ì¼í•œ ë°±ì—”ë“œ ì½”ë“œë¥¼ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤. SPAëŠ” ëª¨ë“  ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ìºì‹œí•  ìˆ˜ ìˆë‹¤. ì• í”Œë¦¬ì¼€ì´ì…˜ì€ ìš”ì²­ì„ í•˜ë‚˜ë§Œ ì „ì†¡í•˜ê³  ëª¨ë“  ë°ì´í„°ë¥¼ ì €ì¥í•œ ë‹¤ìŒ ì´ ë°ì´í„°ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©° ì˜¤í”„ë¼ì¸ì—ì„œë„ ì‘ë™í•œë‹¤. ë‹¨ì  í˜ì´ì§€ ì»¨í…ì¸ ê°€ AJAXì— ì˜í•´ ë¡œë“œë˜ê¸° ë•Œë¬¸ì—, SEO(Search Engine Optimization)ë¥¼ ìµœì í™”í•˜ê¸°ê°€ ì–´ë µë‹¤. ìµœì´ˆì— ëª¨ë“  ì •ì  ë¦¬ì†ŒìŠ¤ë¥¼ í•œë²ˆì— ë‹¤ ë°›ê¸° ë•Œë¬¸ì— ì´ˆê¸° êµ¬ë™ ì†ë„ê°€ ëŠë¦¬ë‹¤. MPAì— ë¹„í•´ SPAì˜ ë³´ì•ˆì„±ì´ ë–¨ì–´ì§„ë‹¤. ê³µê²©ìëŠ” XSSë¥¼ í†µí•´ í´ë¼ì´ì–¸íŠ¸ ì¸¡ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì£¼ì…í•  ìˆ˜ ìˆë‹¤. ë§ì€ ê¸°ëŠ¥ì„ í†µí•©í• ìˆ˜ë¡ ë¡œë”© ì‹œê°„ì´ ê¸¸ì–´ì§€ê³  ì „ë°˜ì ì¸ ì„±ëŠ¥ì´ ì €í•˜ë  ìˆ˜ ìˆë‹¤. Hybrid Approach Gatsby JS ë° Next.jsì™€ ê°™ì€ í”„ë ˆì„ì›Œí¬ëŠ” í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹ìœ¼ë¡œ ì‘ë™í•œë‹¤. ì¦‰, SSRë¡œ ì´ˆê¸° í˜ì´ì§€ë¥¼ ë¡œë“œí•œ ë‹¤ìŒ CSRì„ ì‚¬ìš©í•˜ì—¬ í›„ì† í˜ì´ì§€ë¥¼ ë‹¤ì‹œ ë¡œë“œí•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë‘ ê°€ì§€ ì¥ì ì„ ëª¨ë‘ ëˆ„ë¦´ ìˆ˜ ìˆë‹¤.ë‚˜ì˜ ì„ íƒì€ ? ë‹¨ìˆœí•œ ìƒê°ìœ¼ë¡œëŠ” ë‘ ê°€ì§€ ë°©ì‹ì˜ ì¥ì ì„ ì·¨í•©í•œ í•˜ì´ë¸Œë¦¬ë“œ ë°©ì‹ì´ ê°€ì¥ ì¢‹ì„ ê²ƒ ê°™ë‹¤. ë§Œì•½, SPAë‚˜ MPA ë‘˜ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•´ì•¼ í•œë‹¤ë©´, ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ë³´ì—¬ì¤„ í˜ì´ì§€, ì»¨í…ì¸ ì˜ íŠ¹ì§•, ê° ë°©ì‹ì˜ ì¥/ë‹¨ì ì„ ê³ ë ¤í•´ì•¼ í•  ê²ƒ ê°™ë‹¤. ë‚´ ì„œë¹„ìŠ¤ê°€ íŠ¹ì • í‚¤ì›Œë“œì— ì˜ ë…¸ì¶œì´ ë˜ì–´ì•¼í•œë‹¤ë©´ SEOì— ê°•ì ì´ ìˆëŠ” MPAë¥¼ ì„ íƒí•´ì•¼ í•  ê²ƒ ê°™ë‹¤ ì¡°ê¸ˆ ë” ë¹ ë¥¸ í˜ì´ì§€ ë¡œë”©ì„ ì›í•˜ê³  ì„œë²„ì¸¡ ë¶€í•˜ë¥¼ ëœê³  ì‹¶ë‹¤ë©´ SPAë¥¼ ì„ íƒí•´ì•¼ í•  ê²ƒ ê°™ë‹¤ ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ SPA Framework Next.jsì°¸ê³  ìë£Œ https://medium.com/@NeotericEU/single-page-application-vs-multiple-page-application-2591588efe58 https://dzone.com/articles/the-comparison-of-single-page-and-multi-page-appli https://www.growth-rocket.com/blog/a-closer-look-at-client-side-server-side-rendering/" }, { "title": "BufferedReaderì˜ readLine() ë©”ì„œë“œ ì´í›„ì˜ ì½”ë“œë¡œ ì§„í–‰ì´ ì•ˆë˜ëŠ” í˜„ìƒ", "url": "/posts/issue-bufferedReader/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "JAVA I/O", "date": "2021-06-01 00:29:00 +0900", "snippet": "ìƒí™© â€˜ìë°” ì›¹ í”„ë¡œê·¸ë˜ë° NextStepâ€™ 3ì¥ì˜ ê³¼ì œ ì¤‘ í•˜ë‚˜ì¸ ì›¹ ì„œë²„ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ HTTP ìš”ì²­ì´ ì„œë²„ì— ì–´ë–¤ì‹ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ”ì§€ë¥¼ ë³´ê³ ì‹¶ì—ˆë‹¤. ë”°ë¼ì„œ, ë‹¨ìˆœ í™•ì¸ì„ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ ì‹¤í–‰ì‹œí‚¤ê³  ë¸Œë¼ìš°ì €ì—ì„œ localhost:8080 ìœ¼ë¡œ ìš”ì²­ì„ ë³´ëƒˆë‹¤. public class TestServer { public vo...", "content": "ìƒí™© â€˜ìë°” ì›¹ í”„ë¡œê·¸ë˜ë° NextStepâ€™ 3ì¥ì˜ ê³¼ì œ ì¤‘ í•˜ë‚˜ì¸ ì›¹ ì„œë²„ë¥¼ êµ¬í˜„í•˜ê¸° ìœ„í•´ HTTP ìš”ì²­ì´ ì„œë²„ì— ì–´ë–¤ì‹ìœ¼ë¡œ ë“¤ì–´ì˜¤ëŠ”ì§€ë¥¼ ë³´ê³ ì‹¶ì—ˆë‹¤. ë”°ë¼ì„œ, ë‹¨ìˆœ í™•ì¸ì„ ìœ„í•´ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¥¼ ì‘ì„±í•˜ì—¬ ì‹¤í–‰ì‹œí‚¤ê³  ë¸Œë¼ìš°ì €ì—ì„œ localhost:8080 ìœ¼ë¡œ ìš”ì²­ì„ ë³´ëƒˆë‹¤. public class TestServer { public void start() throws IOException { ServerSocket serverSocket = new ServerSocket(8080); Socket connection; while((connection = serverSocket.accept()) !=null) { System.out.println(String.format(\"[connection info]%nIpAddr : %s, Port : %s%n\", connection.getInetAddress(), connection.getPort())); BufferedReader br = new BufferedReader(new InputStreamReader(connection.getInputStream())); String line; while((line=br.readLine())!=null) { // ì—¬ê¸°ì„œ ë©ˆì¶˜ë‹¤ System.out.println(line); } System.out.println(\"END!\"); } } public static void main(String[] args) throws IOException { TestServer server = new TestServer(); server.start(); }} ì•„ë˜ì™€ ê°™ì´ ìš”ì²­ì´ ë“¤ì–´ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆê³ , â€˜Http Method(GET, POST, â€¦)ê°€ ë­”ì§€ í™•ì¸í•˜ë ¤ë©´ ìš”ì²­ì˜ ì²« ë²ˆì§¸ ë¼ì¸ì„ í™•ì¸í•˜ë©´ ë˜ê² êµ¬ë‚˜â€™ ë“±ì˜ íŒë‹¨ì„ í•  ìˆ˜ ìˆì—ˆë‹¤. í•˜ì§€ë§Œ, ë¬¸ì œëŠ” ì½”ë“œì˜ 15ë²ˆì§¸ ë¼ì¸ System.out.println(\"END!\"); ì— ëŒ€í•œ ì¶œë ¥ì´ ì½˜ì†”ì— ì°íˆì§€ ì•Šì•˜ë‹¤ëŠ” ê²ƒì´ì—ˆë‹¤.ë””ë²„ê±°ë¡œ í™•ì¸í•´ë³´ë‹ˆ ë¬´í•œë£¨í”„ë¥¼ ë„ëŠ” ê²ƒë„ ì•„ë‹ˆê³  ìœ„ ì½”ë“œì˜ 11ë²ˆì§¸ ë¼ì¸ì—ì„œ ëŒ€ê¸° ìƒíƒœê°€ ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤.í•´ê²° ê³¼ì • ìŠ¤íƒì˜¤ë²„í”Œë¡œìš°ì— ìˆëŠ” ê¸€ ì„ í†µí•´BufferedReaderì˜ readLine() ë©”ì„œë“œëŠ” ë¼ì¸ì´ ì¢…ë£Œë˜ì—ˆë‹¤ê³  íŒë‹¨ë˜ì§€ ì•Šìœ¼ë©´ ê°’ì„ ë¦¬í„´í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ì•Œê²Œë˜ì—ˆë‹¤. ê·¸ë ‡ë‹¤ë©´ ë¼ì¸ì´ ì¢…ë£Œë˜ì—ˆë‹¤ëŠ” ê²ƒì„ íŒë‹¨í•˜ëŠ” ê¸°ì¤€ì€ ë­˜ê¹Œ?? ìë°” ê³µì‹ë¬¸ì„œ ì— ë‚˜ì™€ìˆëŠ” readLine() ë©”ì„œë“œì— ëŒ€í•œ ì„¤ëª…ì„ ë³´ë©´ëì— ë‹¤ìŒ ë¬¸ì(â€˜\\nâ€™, â€˜\\râ€™, â€˜\\r\\nâ€™) ì¤‘ í•˜ë‚˜ê°€ ìˆì–´ì•¼ í•˜ë‚˜ì˜ ë¼ì¸ìœ¼ë¡œ ì¸ì‹í•œë‹¤ê³  í•œë‹¤. Reads a line of text. A line is considered to be terminated by any one of a line feed (â€˜\\nâ€™), a carriage return (â€˜\\râ€™), or a carriage return followed immediately by a linefeed. ë˜í•œ, BufferedReaderì˜ readLine() ë©”ì„œë“œë¥¼ ì§ì ‘ ë“¤ì—¬ë‹¤ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì€ ë¡œì§ì´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. eolì€ â€˜end of lineâ€™ì´ì§€ ì•Šì„ê¹Œ ì‹¶ë‹¤. charLoop: for (i = nextChar; i &lt; nChars; i++) { c = cb[i]; if ((c == '\\n') || (c == '\\r')) { eol = true; break charLoop; } } ê·¸ë ‡ë‹¤ë©´, HTTP ìš”ì²­ì˜ ë§ˆì§€ë§‰ ë¼ì¸ì´ ì–´ë–»ê¸¸ë˜ ì•„ì§ ë¼ì¸ì´ ì¢…ë£Œë˜ì—ˆë‹¤ê³  íŒë‹¨í•˜ì§€ ì•ŠëŠ”ê±¸ê¹Œ ? ìŠ¤íƒì˜¤ë²„í”Œë¡œìš°ì— ìˆëŠ” ê¸€ RFC ë¬¸ì„œ 34p HTTP ìš”ì²­ í˜•íƒœ (HTTP ìš”ì²­ í—¤ë”ì˜ ë§ˆì§€ë§‰ ë¼ì¸ì€ ê³µë°±ì´ì—ˆê³  ì´ë¡œ ì¸í•´ readLine() ë©”ì„œë“œê°€ ë¼ì¸ì´ ëë‚˜ì§€ ì•Šì•˜ë‹¤ê³  íŒë‹¨í•œ ê²ƒ) CRLF : Carriage Return(ì»¤ì„œì˜ ìœ„ì¹˜ë¥¼ ë§¨ ì•ìœ¼ë¡œ ì´ë™) + Line Feed(ì»¤ì„œë¥¼ í•œ ì¹¸ ì•„ë˜ë¡œ ì´ë™) Request-Line*(( general-header | request-header | entity-header ) CRLF)CRLF[ message-body ] ê²°ê³¼ì ìœ¼ë¡œ lineì´ ê³µë°±ì´ë©´ \"ê³µë°±\"ì´ë¼ëŠ” ë¬¸ìì—´ì„ ì¶œë ¥í•´ë´„ìœ¼ë¡œì¨ ì‹¤ì œ HTTP ìš”ì²­ì´ ìœ„ì™€ ê°™ì´ ë“¤ì–´ì˜¨ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆì—ˆê³ ,ê³µë°±ì¸ ê²½ìš° breakë¥¼ í†µí•´ whileë¬¸ ë‚´ì—ì„œ ê³„ì† ëŒ€ê¸°ìƒíƒœì— ë¨¸ë¬¼ëŸ¬ìˆì§€ ì•Šê²Œ í•  ìˆ˜ ìˆì—ˆë‹¤.â€» ì°¸ê³ . HTTP Response í¬ë§·Status-Line*(( general-header | response-header | entity-header ) CRLF)CRLF[ message-body ]ìš”ì•½í˜„ìƒ HTTP ìš”ì²­ì„ ë°›ì•„ì„œ BufferedReaderì˜ readLine() ë©”ì„œë“œë¡œ ì½ì–´ ì˜¬ ë•Œ íŠ¹ì • ë¼ì¸ì— ë„ë‹¬í•˜ë©´ ëŒ€ê¸° ìƒíƒœì— ë¨¸ë¬¸ë‹¤.ì›ì¸ readLine() ë©”ì„œë“œ ë‚´ì—ëŠ” â€˜í•˜ë‚˜ì˜ ë¼ì¸â€™ì´ë¼ê³  íŒë‹¨í•˜ëŠ” ê¸°ì¤€(ë¼ì¸ ë§ˆì§€ë§‰ì— â€˜\\nâ€™, â€˜\\râ€™, â€˜\\r\\nâ€™)ì´ ìˆëŠ”ë°, HTTP ìš”ì²­ì˜ ë§ˆì§€ë§‰ ë¼ì¸ì€ ê³µë°±ì´ì—ˆê¸° ë•Œë¬¸ì— ì•„ì§ í•œ ë¼ì¸ì´ ëë‚˜ì§€ ì•Šì•˜ë‹¤ê³  íŒë‹¨í•˜ì—¬ ê³„ì† ëŒ€ê¸°í•˜ê³  ìˆì—ˆë‹¤.ë°°ìš´ ê²ƒ HTTP ìš”ì²­ í˜•íƒœ BufferedReaderì˜ readLine() ë©”ì„œë“œê°€ ë¼ì¸ì„ ì¸ì‹í•˜ëŠ” ë°©ë²•ì‹¤ì œ ì½”ë“œ ì ìš© ê°„ë‹¨í•œ ì›¹ ì„œë²„ êµ¬í˜„ ë ˆíŒŒì§€í† ë¦¬ ì˜¤ëŠ˜ ë‚´ìš© ê´€ë ¨ ì½”ë“œ private static HttpRequest processGetRequest(String requestUrl, BufferedReader bufferedReader) throws IOException { Map&lt;String, String&gt; cookies = null; for (String line = bufferedReader.readLine(); (line != null &amp;&amp; !line.isEmpty()); line = bufferedReader.readLine()) { if (line.contains(\"Cookie\")) { String[] info = line.split(\":\"); cookies = parseCookies(info[1]); break; } } if (!requestUrl.contains(\"?\")) { return new HttpRequest(HttpMethod.GET, requestUrl, cookies); } String[] info = requestUrl.split(\"\\\\?\"); Map&lt;String, String&gt; params = parseQueryString(info[1]); return new HttpRequest(HttpMethod.GET, info[0], params, cookies); } private static HttpRequest processPostRequest(String requestUrl, BufferedReader bufferedReader) throws IOException { int contentLen = 0; String contentType = \"\"; Map&lt;String, String&gt; params = null; Map&lt;String, String&gt; cookies = null; for (String line = bufferedReader.readLine(); (line != null &amp;&amp; !line.isEmpty()); line = bufferedReader.readLine()) { if (line.contains(\"Content-Length\")) { String[] info = line.split(\":\"); contentLen = Integer.parseInt(info[1].trim()); } else if (line.contains(\"Content-Type\")) { String[] info = line.split(\":\"); contentType = info[1].trim(); // ex) application/x-www-form-urlencoded } else if (line.contains(\"Cookie\")) { String[] info = line.split(\":\"); cookies = parseCookies(info[1]); } } if (contentLen &gt; 0) { char[] body = new char[contentLen]; bufferedReader.read(body); if (contentType.equals(\"application/x-www-form-urlencoded\")) { String queryString = new String(body); params = parseQueryString(queryString); } else if (contentType.equals(\"application/json\")) { // TODO } } return new HttpRequest(HttpMethod.POST, requestUrl, params, cookies); } ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ JAVA I/O HTTP ì‘ë‹µ ë¶„í• (HTTP Response Splitting, CRLF) ì·¨ì•½ì ì°¸ê³ ìë£Œ https://stackoverflow.com/questions/7855822/bufferedreader-readline-method-hangs-and-block-program https://docs.oracle.com/javase/8/docs/api/java/io/BufferedReader.html https://stackoverflow.com/questions/50447483/end-of-http-header https://datatracker.ietf.org/doc/html/rfc2616" }, { "title": "í™”ë©´ ë¦¬ë””ë ‰ì…˜ì‹œ ì¿ í‚¤ ì†¡ì‹ ì´ ì•ˆë˜ëŠ” í˜„ìƒ", "url": "/posts/cookie-not-setting/", "categories": "ê²½í—˜í•˜ê¸°, ì´ìŠˆ ë…¸íŠ¸", "tags": "Cookie, Set-Cookie", "date": "2021-05-28 00:29:00 +0900", "snippet": "ìƒí™© login.html í™”ë©´ì—ì„œ ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë©´ ì¿ í‚¤ì— logined=true ê°’ì„ ì„¸íŒ…í•˜ê³  index.htmlë¡œ ë¦¬ë””ë ‰ì…˜ ì‹œí‚¨ë‹¤ í•˜ì§€ë§Œ, index.html í™”ë©´ì„ ìš”ì²­í•  ë•Œ, ê¸°ì¡´ì— ì„¸íŒ…ë˜ì—ˆë˜ cookieê°’ì´ ì—†ì–´ì§„ë‹¤. ì›ì¸ Set-Cookie í—¤ë”ì˜ ì†ì„± ì¤‘ Pathê°’ì„ ë”°ë¡œ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ì¿ í‚¤ë¥¼ ì‘ë‹µí•œ í™”ë©´ì´ í¬í•¨...", "content": "ìƒí™© login.html í™”ë©´ì—ì„œ ë¡œê·¸ì¸ì— ì„±ê³µí•˜ë©´ ì¿ í‚¤ì— logined=true ê°’ì„ ì„¸íŒ…í•˜ê³  index.htmlë¡œ ë¦¬ë””ë ‰ì…˜ ì‹œí‚¨ë‹¤ í•˜ì§€ë§Œ, index.html í™”ë©´ì„ ìš”ì²­í•  ë•Œ, ê¸°ì¡´ì— ì„¸íŒ…ë˜ì—ˆë˜ cookieê°’ì´ ì—†ì–´ì§„ë‹¤. ì›ì¸ Set-Cookie í—¤ë”ì˜ ì†ì„± ì¤‘ Pathê°’ì„ ë”°ë¡œ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´ ì¿ í‚¤ë¥¼ ì‘ë‹µí•œ í™”ë©´ì´ í¬í•¨ëœ ë””ë ‰í† ë¦¬ì™€ ê·¸ í•˜ìœ„ ë””ë ‰í† ë¦¬ë¡œ ìš”ì²­í•˜ëŠ” ê²½ìš°ì—ë§Œ ì¿ í‚¤ë¥¼ ì†¡ì‹ í•œë‹¤. íŒŒì¼ ë””ë ‰í† ë¦¬ëŠ” ì•„ë˜ì™€ ê°™ê¸° ë•Œë¬¸ì— Pathë¥¼ ë”°ë¡œ ì„¤ì •í•˜ì§€ ì•Šìœ¼ë©´, login í™”ë©´ì´ í¬í•¨ëœ /user ë””ë ‰í† ë¦¬ì™€ ê·¸ í•˜ìœ„ì— ìˆëŠ” ìì›ì„ ìš”ì²­í•˜ëŠ” ê²½ìš°ì—ë§Œ ì¿ í‚¤ê°€ ì†¡ì‹ ëœë‹¤. ê²°ê³¼ì ìœ¼ë¡œ, index í™”ë©´ì€ login í™”ë©´ë³´ë‹¤ ìƒìœ„ ë””ë ‰í† ë¦¬ì— ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì— index í™”ë©´ì— ë¦¬ë””ë ‰ì…˜ì‹œ ì¿ í‚¤ê°€ ì†¡ì‹ ë˜ì§€ ì•Šì•˜ë˜ ê²ƒì´ë‹¤. â”œâ”€â”€ ./index.htmlâ”œâ”€â”€ ./jsâ”‚Â Â  â”œâ”€â”€ ./js/bootstrap.min.jsâ”‚Â Â  â”œâ”€â”€ ./js/jquery-2.2.0.min.jsâ”‚Â Â  â””â”€â”€ ./js/scripts.jsâ”œâ”€â”€ ./qnaâ”‚Â Â  â”œâ”€â”€ ./qna/form.htmlâ”‚Â Â  â””â”€â”€ ./qna/show.htmlâ””â”€â”€ ./user â”œâ”€â”€ ./user/form.html â”œâ”€â”€ ./user/list.html â”œâ”€â”€ ./user/login.html â”œâ”€â”€ ./user/login_failed.html â””â”€â”€ ./user/profile.html í•´ê²° ë°©ë²• Path ì†ì„±ì„ ì¶”ê°€í•´ì¤€ë‹¤. public String login(String id, String pw, HttpResponse response) throws IOException { User findUser = findUser(id); if(findUser!=null &amp;&amp; pw.equals(findUser.getPassword())) { response.setCookie(\"logined=true; Path=/\"); return \"/index.html\"; } response.setCookie(\"logined=false; Path=/\"); return \"/user/login_failed.html\";} í•˜ì§€ë§Œ, ì´ ê¸€ ì— ë³´ë©´ ì—¬ëŸ¬ ê°œì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì›¹ ì„œë²„ì— ìˆëŠ” ê²½ìš°, Pathë¥¼ ë£¨íŠ¸ ë””ë ‰í† ë¦¬(/)ë¡œ ì„¸íŒ…í•˜ëŠ” ê²ƒì€ë³´ì•ˆìƒ ì¢‹ì§€ ì•Šë‹¤ê³  ë§í•œë‹¤. ì™œëƒí•˜ë©´ í•˜ìœ„ ë””ë ‰í† ë¦¬(ex : â€¦/newapp)ì— ë‹¤ë¥¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ìˆë‹¤ë©´, í•´ë‹¹ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ìš”ì²­í•˜ëŠ” ê²½ìš°ì—ë„ ì¿ í‚¤ê°€ ì†¡ì‹ ë˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ, ì—¬ëŸ¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë™ì¼í•œ ì›¹ ì„œë²„ì—ì„œ í˜¸ìŠ¤íŒ…í•˜ëŠ” ì‹œë‚˜ë¦¬ì˜¤ì—ì„œëŠ” ê°€ëŠ¥í•œ ê°œë³„ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ìì²´ í•˜ìœ„ ë””ë ‰í† ë¦¬(â€œâ€¦/myapp1â€, â€œâ€¦/myapp2â€ ë“±)ì— ë°°ì¹˜í•˜ê³ ê°œë³„ ì¿ í‚¤ë¥¼ ê°œë³„ ì• í”Œë¦¬ì¼€ì´ì…˜ ê²½ë¡œì—ë§Œ ìœ íš¨í•˜ë„ë¡ ì„ ì–¸í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤. Set-Cookie í•„ë“œ ì†ì„± ê°’ ì‚´í´ë³´ê¸° ì†ì„± ì„¤ëª… name = VALUE ì¿ í‚¤ì— ë¶€ì—¬ëœ ì´ë¦„ê³¼ ê°’(í•„ìˆ˜) Expires = DATE ì¿ í‚¤ì˜ ìœ íš¨ ê¸°ê°„(default : ë¸Œë¼ìš°ì € ë‹«ì„ ë•Œê¹Œì§€) Path = PATH ì¿ í‚¤ ì ìš©ì´ ë˜ëŠ” ì„œë²„ ìƒì˜ ë””ë ‰í† ë¦¬(default : ì¿ í‚¤ë¥¼ ìƒì„±í•œ ë„íë¨¼íŠ¸ì™€ ê°™ì€ ë””ë ‰í† ë¦¬) Domain = ë„ë©”ì¸ ëª… ì¿ í‚¤ ì ìš© ëŒ€ìƒì´ ë˜ëŠ” ë„ë©”ì¸ ëª…(default : ì¿ í‚¤ë¥¼ ìƒì„±í•œ ì„œë²„ì˜ ë„ë©”ì¸) Secure HTTPSë¡œ í†µì‹ í•˜ëŠ” ê²½ìš°ì—ë§Œ ì¿ í‚¤ ì†¡ì‹  HttpOnly ì¿ í‚¤ë¥¼ ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œ ì—‘ì„¸ìŠ¤í•˜ì§€ ëª»í•˜ë„ë¡ ì œí•œ ì°¸ê³  ìë£Œ ìš°ì—ë…¸ ì„¼, ã€ê·¸ë¦¼ìœ¼ë¡œ ë°°ìš°ëŠ” Http &amp; Network Basicã€, ì˜ì§„ë‹·ì»´(2015) https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie https://secureteam.co.uk/articles/how-to-make-the-perfect-cookies/" }, { "title": "JPA ë‚´ë¶€ êµ¬ì¡° ì‚´í´ë³´ê¸°", "url": "/posts/jpa-inside-persistence-context/", "categories": "", "tags": "", "date": "2021-05-12 00:29:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „JPA ë‚´ë¶€ êµ¬ì¡°ë¥¼ ì œëŒ€ë¡œ ëª¨ë¥´ê³  ì‚¬ìš©í•˜ë©´, ì˜¤íˆë ¤ ì„±ëŠ¥ ì €í•˜ë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ë„ ìˆë‹¤ê³  í•œë‹¤. ë”°ë¼ì„œ, JPAëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ” ê²ƒì¸ì§€ ì•Œê¸° ìœ„í•´ì¸í”„ëŸ° ê¹€ì˜í•œë‹˜ ê°•ì˜ ë¥¼ ë“¤ìœ¼ë©° ê³µë¶€í•´ë³´ì•˜ë‹¤.JPA êµ¬ë™ ë°©ì‹ persistence.xml ì˜ˆì‹œ&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;per...", "content": "ë“¤ì–´ê°€ê¸° ì „JPA ë‚´ë¶€ êµ¬ì¡°ë¥¼ ì œëŒ€ë¡œ ëª¨ë¥´ê³  ì‚¬ìš©í•˜ë©´, ì˜¤íˆë ¤ ì„±ëŠ¥ ì €í•˜ë¥¼ ë°œìƒì‹œí‚¬ ìˆ˜ë„ ìˆë‹¤ê³  í•œë‹¤. ë”°ë¼ì„œ, JPAëŠ” ë‚´ë¶€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ë™ì‘í•˜ëŠ” ê²ƒì¸ì§€ ì•Œê¸° ìœ„í•´ì¸í”„ëŸ° ê¹€ì˜í•œë‹˜ ê°•ì˜ ë¥¼ ë“¤ìœ¼ë©° ê³µë¶€í•´ë³´ì•˜ë‹¤.JPA êµ¬ë™ ë°©ì‹ persistence.xml ì˜ˆì‹œ&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;&lt;persistence version=\"2.2\" xmlns=\"http://xmlns.jcp.org/xml/ns/persistence\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_2.xsd\"&gt; &lt;persistence-unit name=\"hello\"&gt; &lt;properties&gt; &lt;!-- í•„ìˆ˜ ì†ì„± --&gt; &lt;property name=\"javax.persistence.jdbc.driver\" value=\"org.h2.Driver\"/&gt; &lt;property name=\"javax.persistence.jdbc.user\" value=\"sa\"/&gt; &lt;property name=\"javax.persistence.jdbc.password\" value=\"\"/&gt; &lt;property name=\"javax.persistence.jdbc.url\" value=\"jdbc:h2:tcp://localhost/~/test\"/&gt; &lt;property name=\"hibernate.dialect\" value=\"org.hibernate.dialect.H2Dialect\"/&gt; &lt;!-- ì˜µì…˜ --&gt; &lt;property name=\"hibernate.show_sql\" value=\"true\"/&gt; &lt;property name=\"hibernate.format_sql\" value=\"true\"/&gt; &lt;property name=\"hibernate.use_sql_comments\" value=\"true\"/&gt; &lt;property name=\"hibernate.hbm2ddl.auto\" value=\"create\" /&gt; &lt;/properties&gt; &lt;/persistence-unit&gt;&lt;/persistence&gt; EntityManagerFactory, EntityManager ì‚¬ìš©public class JpaMain { public static void main(String[] args) { EntityManagerFactory emf = Persistence.createEntityManagerFactory(\"hello\"); EntityManager em = emf.createEntityManager(); EntityTransaction tx = em.getTransaction(); tx.begin(); try { Order order = new Order(); order.setId(1L); em.persist(order); tx.commit(); } catch (Exception e) { tx.rollback(); } finally { em.close(); } emf.close(); }}ì£¼ì˜ì‚¬í•­ ì—”í‹°í‹° ë§¤ë‹ˆì € íŒ©í† ë¦¬ëŠ” í•˜ë‚˜ë§Œ ìƒì„±í•´ì„œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì „ì²´ì—ì„œ ê³µìœ ëœë‹¤. ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ì“°ë ˆë“œê°„ì— ê³µìœ X (ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ë°ì´í„° ì •í•©ì„±ì´ ê¹¨ì§ˆ ìˆ˜ ìˆë‹¤). JPAì˜ ëª¨ë“  ë°ì´í„° ë³€ê²½ì€ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œ ì‹¤í–‰ë˜ì–´ì•¼ í•œë‹¤.ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸(Peristence Context) â€œì—”í‹°í‹°ë¥¼ ì˜êµ¬ ì €ì¥í•˜ëŠ” í™˜ê²½â€ì´ë¼ëŠ” ëœ»ìœ¼ë¡œ ë…¼ë¦¬ì ì¸ ê°œë…ì´ë‹¤.Hibernateì™€ ê°™ì€ Persistence providerëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì—”í‹°í‹° ë¼ì´í”„ì‚¬ì´í´ì„ ê´€ë¦¬í•œë‹¤. EntityManager.persist(entity); EntityManagerëŠ” ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ìƒí˜¸ì‘ìš©í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ì¸í„°í˜ì´ìŠ¤ì´ë‹¤. ì¦‰, EntityManagerë¥¼ í†µí•´ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ìƒí˜¸ì‘ìš© í•  ìˆ˜ ìˆë‹¤. persist(entity)ëŠ” DBê°€ ì•„ë‹Œ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥í•˜ëŠ” ê²ƒ. ì—”í‹°í‹°ì˜ ë¼ì´í”„ì‚¬ì´í´ ì¶œì²˜ : https://thorben-janssen.com/entity-lifecycle-model/1.ë¹„ì˜ì† (new/transient) ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì™€ ì „í˜€ ê´€ê³„ê°€ ì—†ëŠ” ìƒˆë¡œìš´ ìƒíƒœë¡œ, ê°ì²´ë¥¼ ìƒì„±ë§Œ í•´ë†“ì€ ìƒíƒœì´ë‹¤.//ê°ì²´ë¥¼ ìƒì„±í•œ ìƒíƒœ(ë¹„ì˜ì†)Member member = new Member();member.setId(\"member1\");member.setUsername(\"íšŒì›1\");2. ì˜ì† (managed) ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ê´€ë¦¬ë˜ëŠ” ìƒíƒœì´ë‹¤. ì˜ì† ìƒíƒœê°€ ëœë‹¤ê³ í•´ì„œ DBì— ë°”ë¡œ ì¿¼ë¦¬ê°€ ë‚ ë¼ê°€ì§€ ì•ŠëŠ”ë‹¤. ì¿¼ë¦¬ëŠ” íŠ¸ëœì­ì…˜ ì»¤ë°‹ì‹œ ë‚ ë¼ê°„ë‹¤.//ê°ì²´ë¥¼ ìƒì„±í•œ ìƒíƒœ(ë¹„ì˜ì†)Member member = new Member();member.setId(\"member1\");member.setUsername(â€œíšŒì›1â€);EntityManager em = emf.createEntityManager();em.getTransaction().begin();//ê°ì²´ë¥¼ ì €ì¥í•œ ìƒíƒœ(ì˜ì†)em.persist(member);// DBì— ì¿¼ë¦¬ ë‚ ë¦°ë‹¤.tx.commit();3. ì¤€ì˜ì† (detached) ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì— ì €ì¥ë˜ì—ˆë‹¤ê°€ ë¶„ë¦¬ëœ ìƒíƒœì´ë‹¤. ì¤€ì˜ì† ìƒíƒœ ì˜ì† -&gt; ì¤€ì˜ì† ì˜ì† ìƒíƒœì˜ ì—”í‹°í‹°ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¶„ë¦¬(detached) ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ê°€ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì„ ì‚¬ìš© ëª»í•¨ ì¤€ì˜ì† ìƒíƒœë¡œ ë§Œë“œëŠ” ë°©ë²• em.detach(entity) íŠ¹ì • ì—”í‹°í‹°ë§Œ ì¤€ì˜ì† ìƒíƒœë¡œ ì „í™˜ em.clear() ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì™„ì „íˆ ì´ˆê¸°í™” em.close() ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ ì¢…ë£Œ //íšŒì› ì—”í‹°í‹°ë¥¼ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ë¶„ë¦¬, ì¤€ì˜ì† ìƒíƒœem.detach(member);4. ì‚­ì œ (removed) ì—”í‹°í‹°ê°€ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì—ì„œ ì‚­ì œëœ ìƒíƒœì´ë‹¤.//ê°ì²´ë¥¼ ì‚­ì œí•œ ìƒíƒœ(ì‚­ì œ)em.remove(member);ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ ì´ì 1. 1ì°¨ ìºì‹œ ê°™ì€ íŠ¸ëœì­ì…˜ ë‚´ì—ì„œë§Œ(í•˜ë‚˜ì˜ ì‚¬ìš©ì ìš”ì²­) ìœ íš¨í•˜ë‹¤. ì¦‰, ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” íŠ¸ëœì­ì…˜ ì¢…ë£Œì™€ ë™ì‹œì— ì‚¬ë¼ì§„ë‹¤. ì¡°íšŒì‹œMember member = new Member();member.setId(\"member1\");member.setUsername(\"íšŒì›1\");//1ì°¨ ìºì‹œì— ì €ì¥ë¨em.persist(member);//1ì°¨ ìºì‹œì—ì„œ ì¡°íšŒMember findMember = em.find(Member.class, \"member1\"); 1ì°¨ ìºì‹œì— ì—†ëŠ” ë°ì´í„° ì¡°íšŒì‹œ Member findMember2 = em.find(Member.class, \"member2\"); 2. ë™ì¼ì„±(identity) ë³´ì¥ 1ì°¨ ìºì‹œë¡œ ë°˜ë³µ ê°€ëŠ¥í•œ ì½ê¸°(REPEATABLE READ) ë“±ê¸‰ì˜ íŠ¸ëœì­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì„ ë°ì´í„°ë² ì´ìŠ¤ê°€ ì•„ë‹Œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì°¨ì›ì—ì„œ ì œê³µMember a = em.find(Member.class, \"member1\");Member b = em.find(Member.class, \"member1\");System.out.println(a == b); //ë™ì¼ì„± ë¹„êµ true3. íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°(transactional write-behind)EntityManager em = emf.createEntityManager();EntityTransaction transaction = em.getTransaction();//ì—”í‹°í‹° ë§¤ë‹ˆì €ëŠ” ë°ì´í„° ë³€ê²½ì‹œ íŠ¸ëœì­ì…˜ì„ ì‹œì‘í•´ì•¼ í•œë‹¤.transaction.begin(); // [íŠ¸ëœì­ì…˜] ì‹œì‘em.persist(memberA);em.persist(memberB);//ì—¬ê¸°ê¹Œì§€ INSERT SQLì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë³´ë‚´ì§€ ì•ŠëŠ”ë‹¤.//ì»¤ë°‹í•˜ëŠ” ìˆœê°„ ë°ì´í„°ë² ì´ìŠ¤ì— INSERT SQLì„ ë³´ë‚¸ë‹¤.transaction.commit(); // [íŠ¸ëœì­ì…˜] ì»¤ë°‹ ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ ë‚´ë¶€ì—ëŠ” â€˜ì“°ê¸° ì§€ì—° SQL ì €ì¥ì†Œâ€™ë¼ëŠ” ê²ƒë„ ìˆë‹¤. hibernate.jdbc.batch_size ì˜µì…˜ì„ ì£¼ê²Œë˜ë©´ í•´ë‹¹ ì‚¬ì´ì¦ˆë§Œí¼ ì¿¼ë¦¬ë¥¼ ìŒ“ì•„ë’€ë‹¤ê°€ íŠ¸ëœì­ì…˜ ì»¤ë°‹ì‹œ DBë¡œ ë‚ ë¦¬ê²Œëœë‹¤. 4. ë³€ê²½ ê°ì§€(Dirty Checking) ìë°” ì»¬ë ‰ì…˜ ë‹¤ë£¨ë“¯ì´ ë‹¤ë£¬ë‹¤ê³  ìƒê°í•˜ë©´ ëœë‹¤.EntityManager em = emf.createEntityManager();EntityTransaction transaction = em.getTransaction();transaction.begin(); // [íŠ¸ëœì­ì…˜] ì‹œì‘// ì˜ì† ì—”í‹°í‹° ì¡°íšŒMember memberA = em.find(Member.class, \"memberA\");// ì˜ì† ì—”í‹°í‹° ë°ì´í„° ìˆ˜ì •memberA.setUsername(\"hi\");memberA.setAge(10);//em.update(member) ë¶ˆí•„ìš”í•œ ì½”ë“œtransaction.commit(); // [íŠ¸ëœì­ì…˜] ì»¤ë°‹ DB íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•˜ê²Œ ë˜ë©´ ë‚´ë¶€ì ìœ¼ë¡œ flush() ì•¤í‹°í‹°ì™€ ìŠ¤ëƒ…ìƒ· ë¹„êµ ìŠ¤ëƒ…ìƒ· : 1ì°¨ ìºì‹œì— ìµœì´ˆë¡œ ë“¤ì–´ì™”ì„ ë•Œì˜ ê°’ ì¶œì²˜ : https://www.inflearn.com/course/ORM-JPA-Basic/dashboardflush ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ì˜ â€˜ì“°ê¸° ì§€ì—° SQL ì €ì¥ì†Œâ€™ì— ìˆëŠ” ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜ (1ì°¨ ìºì‹œë¥¼ ë¹„ìš°ëŠ”ê²Œ ì•„ë‹˜) íŠ¸ëœì­ì…˜ì´ë¼ëŠ” ì‘ì—… ë‹¨ìœ„ê°€ ì¤‘ìš”í•˜ë‹¤. ì¦‰, ì»¤ë°‹ ì§ì „ì—ë§Œ ë™ê¸°í™” í•˜ë©´ ë¨ í”ŒëŸ¬ì‹œ ë°œìƒ ê³¼ì • ë³€ê²½ ê°ì§€ ìˆ˜ì •ëœ ì—”í‹°í‹°ë¥¼ ì“°ê¸° ì§€ì—° SQL ì €ì¥ì†Œì— ë“±ë¡ ì“°ê¸° ì§€ì—° SQL ì €ì¥ì†Œì˜ ì¿¼ë¦¬ë¥¼ ë°ì´í„°ë² ì´ìŠ¤ì— ì „ì†¡ (ë“±ë¡, ìˆ˜ì •, ì‚­ì œ ì¿¼ë¦¬) ì˜ì†ì„± ì»¨í…ìŠ¤íŠ¸ë¥¼ í”ŒëŸ¬ì‹œí•˜ëŠ” ë°©ë²• ì§ì ‘ í˜¸ì¶œ em.flush() í”ŒëŸ¬ì‹œ ìë™ í˜¸ì¶œ íŠ¸ëœì­ì…˜ ì»¤ë°‹ JPQL ì¿¼ë¦¬ ì‹¤í–‰ í”ŒëŸ¬ì‹œ ëª¨ë“œ ì˜µì…˜ em.setFlushMode(FlushModeType.COMMIT) FlushModeType.AUTO ì»¤ë°‹ì´ë‚˜ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•  ë•Œ í”ŒëŸ¬ì‹œ (ê¸°ë³¸ê°’) FlushModeType.COMMIT ì»¤ë°‹í•  ë•Œë§Œ í”ŒëŸ¬ì‹œ ì°¸ê³ ìë£Œ ê¹€ì˜í•œ, ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë° - ê¸°ë³¸í¸ https://www.baeldung.com/jpa-hibernate-persistence-context" }, { "title": "JPA ì…ë¬¸í•˜ê¸°", "url": "/posts/jpa-introduction/", "categories": "", "tags": "", "date": "2021-05-10 00:29:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „JPAë¥¼ íšŒì‚¬ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ê¸´ í–ˆì§€ë§Œ, ë§¤ìš° ê°„ë‹¨í•œ CRUDì—ë§Œ ì‚¬ìš©í•´ì„œ ì‚¬ì‹¤ ì •í™•íˆëŠ” ì•Œì§€ ëª»í–ˆë‹¤. ë”°ë¼ì„œ, JPAê°€ ì •í™•íˆ ë¬´ì—‡ì´ê³  ì–¸ì œ, ì–´ë””ì— ì‚¬ìš©í•˜ëŠ” ê²ƒì¸ì§€ì— ëŒ€í•´ ì¸í”„ëŸ° ê¹€ì˜í•œë‹˜ ê°•ì˜ ë¥¼ ë“¤ìœ¼ë©° ê³µë¶€í•´ë³´ì•˜ë‹¤.JPAë€ ? â€˜Java Persistence APIâ€™ë¥¼ ì˜ë¯¸í•˜ë©° ìë°” ì§„ì˜ì˜ ORM ê¸°ìˆ  í‘œì¤€ì´ë‹¤. ORM? ...", "content": "ë“¤ì–´ê°€ê¸° ì „JPAë¥¼ íšŒì‚¬ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ê¸´ í–ˆì§€ë§Œ, ë§¤ìš° ê°„ë‹¨í•œ CRUDì—ë§Œ ì‚¬ìš©í•´ì„œ ì‚¬ì‹¤ ì •í™•íˆëŠ” ì•Œì§€ ëª»í–ˆë‹¤. ë”°ë¼ì„œ, JPAê°€ ì •í™•íˆ ë¬´ì—‡ì´ê³  ì–¸ì œ, ì–´ë””ì— ì‚¬ìš©í•˜ëŠ” ê²ƒì¸ì§€ì— ëŒ€í•´ ì¸í”„ëŸ° ê¹€ì˜í•œë‹˜ ê°•ì˜ ë¥¼ ë“¤ìœ¼ë©° ê³µë¶€í•´ë³´ì•˜ë‹¤.JPAë€ ? â€˜Java Persistence APIâ€™ë¥¼ ì˜ë¯¸í•˜ë©° ìë°” ì§„ì˜ì˜ ORM ê¸°ìˆ  í‘œì¤€ì´ë‹¤. ORM? Object-relational mapping(ê°ì²´ ê´€ê³„ ë§¤í•‘) ê°ì²´ëŠ” ê°ì²´ëŒ€ë¡œ ì„¤ê³„ RDBëŠ” RDBëŒ€ë¡œ ì„¤ê³„í•œë‹¤. ê°ê° ì„¤ê³„í•œ ê²ƒì„ ORM í”„ë ˆì„ì›Œí¬ê°€ ì¤‘ê°„ì—ì„œ ë§¤í•‘í•œë‹¤. ëŒ€ì¤‘ì ì¸ ì–¸ì–´ì—ëŠ” ëŒ€ë¶€ë¶„ ORM ê¸°ìˆ ì´ ì¡´ì¬í•œë‹¤. JPAëŠ” í‘œì¤€ ëª…ì„¸ì´ë‹¤. ì¦‰, JPAëŠ” ì¸í„°í˜ì´ìŠ¤ì˜ ëª¨ìŒì´ë‹¤. JPA 2.1 í‘œì¤€ ëª…ì„¸ë¥¼ êµ¬í˜„í•œ 3ê°€ì§€ ëŒ€í‘œì ì¸ êµ¬í˜„ì²´ê°€ ìˆë‹¤. Hibernate, EclipseLink, DataNucleus ë°œì „ ê³¼ì • : JDBC â†’ MyBatis, JdbcTemplate â†’ JPASQL ì¤‘ì‹¬ ì½”ë“œì˜ ë¬¸ì œì (JPAì˜ ì¶œí˜„ ë°°ê²½)1. ìƒì‚°ì„±Without JPA ëŒ€ë¶€ë¶„ì€ ê°ì²´ë¥¼ ê´€ê³„í˜• DBì— ê´€ë¦¬í•œë‹¤. ì§€ì†ì ìœ¼ë¡œ ë°˜ë³µë˜ëŠ” ì½”ë“œ ìë°” ê°ì²´ â†’ SQL SQL â†’ ìë°” ê°ì²´ SQLì„ ì¼ì¼ì´ ì‘ì„±í•´ì•¼í•œë‹¤.With JPA- ì €ì¥: jpa.persist(member)- ì¡°íšŒ: Member member = jpa.find(memberId)- ìˆ˜ì •: member.setName(â€œë³€ê²½í•  ì´ë¦„â€)- ì‚­ì œ: jpa.remove(member)2. ìœ ì§€ë³´ìˆ˜ì„±Without JPA í•„ë“œ ë³€ê²½ì‹œ ê´€ë ¨ëœ ëª¨ë“  SQL ìˆ˜ì •public class Member { private String memberId; private String name; private String tel; // í•­ëª© ì¶”ê°€ ...}INSERT INTO MEMBER(MEMBER_ID, NAME, TEL) VALUES SELECT MEMBER_ID, NAME, TEL FROM MEMBER M UPDATE MEMBER SET ... TEL = ?With JPA í•„ë“œë§Œ ì¶”ê°€í•˜ë©´ ë¨, SQLì€ JPAê°€ ì²˜ë¦¬public class Member { private String memberId; private String name; private String tel; // í•„ë“œ ì¶”ê°€ ...}3. íŒ¨ëŸ¬ë‹¤ì„ ë¶ˆì¼ì¹˜ ë°œìƒ ê°ì²´ê°€ ë‚˜ì˜¨ ì‚¬ìƒê³¼, RDBê°€ ë‚˜ì˜¨ ì‚¬ìƒì´ ë‹¤ë¥´ë‹¤. í•˜ì§€ë§Œ, RDBì— ë§ì¶° ê°ì²´ë¥¼ ë‹¤ë£¨ë‹¤ë³´ë‹ˆ ì‚¬ì‹¤ìƒ ê°œë°œìê°€ SQL Mapperì˜ ì—­í• ì„ í•˜ê²Œë˜ì—ˆë‹¤.3-1. ìƒì† ì¶œì²˜ : https://www.inflearn.com/course/ORM-JPA-Basic/dashboardWithout JPA Album ì €ì¥ ê°ì²´ ë¶„í•´ INSERT INTO ITEM â€¦ INSERT INTO ALBUM â€¦ Album ì¡°íšŒ ê°ê°ì˜ í…Œì´ë¸”ì— ë”°ë¥¸ ì¡°ì¸ SQL ì‘ì„± ê°ê°ì˜ ê°ì²´ ìƒì„± Albumë¿ ì•„ë‹ˆë¼ ë‹¤ë¥¸ ìì‹ ê°ì²´ë“¤ë„ ì´ëŸ¬í•œ ì‘ì—…ì„ í•´ì•¼í•œë‹¤ê³  ìƒê°í•˜ë©´ ë§¤ìš° ë²ˆê±°ë¡œìš¸ ê²ƒì´ë‹¤. ë”°ë¼ì„œ, ì¼ë°˜ì ìœ¼ë¡œ DBì— ì €ì¥í•  ê°ì²´ì—ëŠ” ìƒì† ê´€ê³„ë¥¼ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.With JPA Album ì €ì¥ jpa.persist(album); ë‚˜ë¨¸ì§„ JPAê°€ ì²˜ë¦¬ Album ì¡°íšŒ Album album = jpa.find(Album.class, albumId); ë‚˜ë¨¸ì§„ JPAê°€ ì²˜ë¦¬ SELECT I.*, A.* FROM ITEM I JOIN ALBUM A ON I.ITEM_ID = A.ITEM_ID 3-2. ì—°ê´€ê´€ê³„ ê°ì²´ëŠ” ì°¸ì¡°ë¥¼ ì‚¬ìš©(ë‹¨ë°©í–¥): member.getTeam() í…Œì´ë¸”ì€ ì™¸ë˜ í‚¤ë¥¼ ì‚¬ìš©(ì–‘ë°©í–¥): JOIN ON M.TEAM_ID = T.TEAM_IDWithout JPA ê°ì²´ë¥¼ í…Œì´ë¸”ì— ë§ì¶”ì–´ ëª¨ë¸ë§class Member { String id; // MEMBER_ID ì»¬ëŸ¼ ì‚¬ìš© Long teamId; // TEAM_ID FK ì»¬ëŸ¼ ì‚¬ìš© String username;// USERNAME ì»¬ëŸ¼ ì‚¬ìš©}class Team { Long id; // TEAM_ID PK ì‚¬ìš© String name; // NAME ì»¬ëŸ¼ ì‚¬ìš©}INSERT INTO MEMBER(MEMBER_ID, TEAM_ID, USERNAME) VALUES ... ê°ì²´ë‹¤ìš´ ëª¨ë¸ë§class Member { String id; // MEMBER_ID ì»¬ëŸ¼ ì‚¬ìš© Team team; // ì°¸ì¡°ë¡œ ì—°ê´€ê´€ê³„ë¥¼ ë§ºëŠ”ë‹¤. String username; // USERNAME ì»¬ëŸ¼ ì‚¬ìš© Team getTeam() { return team; }}class Team { Long id; // TEAM_ID PK ì‚¬ìš© String name; // NAME ì»¬ëŸ¼ ì‚¬ìš©}// TEAM_ID : member.getTeam().getId(); INSERT INTO MEMBER(MEMBER_ID, TEAM_ID, USERNAME) VALUES ...ì´ë ‡ê²Œ ê°ì²´ë‹¤ìš´ ëª¨ë¸ë§ì„ í–ˆì„ë•Œì˜ ë¬¸ì œì ì€ ì¡°íšŒì‹œ ë§¤ìš° ë²ˆê±°ë¡œì›Œì§ˆ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì´ë‹¤. ì•„ë˜ ì¿¼ë¦¬ë¥¼ í†µí•´ ì–»ì€ ê²°ê³¼ë¥¼ Member ê°ì²´ì— ì„¸íŒ…í•˜ëŠ” ìƒí™©ì„ ê°€ì •í•´ë³´ì. SELECT M.*, T.* FROM MEMBER M JOIN TEAM T ON M.TEAM_ID = T.TEAM_ID ì¡°íšŒ ê²°ê³¼ì— ì„ì—¬ìˆëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ Member, Team ê°ê°ì˜ ê°ì²´ì— ì•Œë§ê²Œ ì„¸íŒ…í•œ ë’¤, Team ê°ì²´ëŠ” Member ê°ì²´ì— ì„¸íŒ…í•´ì¤˜ì•¼ í•œë‹¤. ë”°ë¼ì„œ, ì‹¤ë¬´ì—ì„œëŠ” ìƒì‚°ì„±ì„ ìœ„í•´ Memberì™€ Teamì˜ í•„ë“œë¥¼ ëª¨ë‘ í•©ì¹œ SuperDTO ë“±ì„ ë§Œë“¤ê±°ë‚˜ í•˜ëŠ” ì¼ì´ ë¹„ì¼ë¹„ì¬í•˜ë‹¤. public Member find(String memberId) { //SQL ì‹¤í–‰ ... Member member = new Member(); //ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒí•œ íšŒì› ê´€ë ¨ ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥ Team team = new Team(); //ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì¡°íšŒí•œ íŒ€ ê´€ë ¨ ì •ë³´ë¥¼ ëª¨ë‘ ì…ë ¥ //íšŒì›ê³¼ íŒ€ ê´€ê³„ ì„¤ì • member.setTeam(team); return member;}With JPAMember member = list.get(memberId);Team team = member.getTeam();member.setTeam(team);jpa.persist(member);3-3. ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ ê°ì²´ëŠ” ììœ ë¡­ê²Œ ê°ì²´ ê·¸ë˜í”„ë¥¼ íƒìƒ‰í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.Without JPA ì²˜ìŒ ì‹¤í–‰í•˜ëŠ” SQLì— ë”°ë¼ ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ ë²”ìœ„ê¸° ê²°ì •ëœë‹¤. ë§Œì•½ ì•„ë˜ ì¿¼ë¦¬ì— ëŒ€í•œ ê²°ê³¼ë¡œ ê°ì²´ ê·¸ë˜í”„ë¥¼ íƒìƒ‰í•œë‹¤ë©´ member.getOrder();ëŠ” nullì„ ë°˜í™˜í•  ê²ƒì´ë‹¤. SELECT M.*, T.* FROM MEMBER M JOIN TEAM T ON M.TEAM_ID = T.TEAM_ID ì´ì™€ ê°™ì€ ìƒí™©ì€ ì—”í‹°í‹° ì‹ ë¢° ë¬¸ì œë¡œ ì´ì–´ì§„ë‹¤. ì¦‰, ì•„ë˜ ì½”ë“œì˜ ê²½ìš° getTeam(), getOrder() ë“±ì´ nullì´ ì•„ë‹Œì§€ í™•ì‹ í•˜ë ¤ë©´ memberDAO.find(memberId) ë‚´ë¶€ì— ì–´ë–¤ ì¿¼ë¦¬ê°€ ë™ì‘í•˜ëŠ”ì§€ ì‚´í´ë´ì•¼ í•œë‹¤. class MemberService {... public void process() { Member member = memberDAO.find(memberId); member.getTeam(); //??? member.getOrder().getDelivery(); // ??? }}With JPAMember member = jpa.find(Member.class, memberId);Team team = member.getTeam(); ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ì—”í‹°í‹°, ê³„ì¸µ class MemberService { ... public void process() { Member member = memberDAO.find(memberId); member.getTeam(); // ììœ ë¡œìš´ ê°ì²´ ê·¸ë˜í”„ íƒìƒ‰ member.getOrder().getDelivery(); }} 3-4. ê°ì²´ ë¹„êµWithout JPAString memberId = \"100\";Member member1 = memberDAO.getMember(memberId);Member member2 = memberDAO.getMember(memberId);member1 == member2; //ë‹¤ë¥´ë‹¤.class MemberDAO { public Member getMember(String memberId) { String sql = \"SELECT * FROM MEMBER WHERE MEMBER_ID = ?\"; ... //JDBC API, SQL ì‹¤í–‰ return new Member(...); }}With JPA ë™ì¼í•œ íŠ¸ëœì­ì…˜ì—ì„œ ì¡°íšŒí•œ ì—”í‹°í‹°ëŠ” ê°™ìŒì„ ë³´ì¥í•œë‹¤.String memberId = \"100\";Member member1 = list.get(memberId);Member member2 = list.get(memberId);member1 == member2; //ê°™ë‹¤.JPAì™€ ì„±ëŠ¥1. 1ì°¨ ìºì‹œì™€ ë™ì¼ì„±(identity) ë³´ì¥ ê°™ì€ íŠ¸ëœì­ì…˜ ì•ˆì—ì„œëŠ” ê°™ì€ ì—”í‹°í‹°ë¥¼ ë°˜í™˜ ì•½ê°„ì˜ ì¡°íšŒ ì„±ëŠ¥ì´ í–¥ìƒëœë‹¤. (ë¯¸ë¯¸í•œ ìˆ˜ì¤€) DB Isolation Levelì´ Read Committedë¼ë„ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ Repeatable Readë¥¼ ë³´ì¥í•œë‹¤. String memberId = \"100\"; Member m1 = jpa.find(Member.class, memberId); //SQL Member m2 = jpa.find(Member.class, memberId); //ìºì‹œ println(m1 == m2) //true // ê²°ê³¼ì ìœ¼ë¡œëŠ” SQL 1ë²ˆë§Œ ì‹¤í–‰ 2. íŠ¸ëœì­ì…˜ì„ ì§€ì›í•˜ëŠ” ì“°ê¸° ì§€ì—°(transactional write-behind) íŠ¸ëœì­ì…˜ì„ ì»¤ë°‹í•  ë•Œê¹Œì§€ INSERT SQLì„ ëª¨ìŒ JDBC BATCH SQL ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ì„œ í•œë²ˆì— SQL ì „ì†¡transaction.begin(); // íŠ¸ëœì­ì…˜ ì‹œì‘em.persist(memberA);em.persist(memberB);em.persist(memberC);//ì—¬ê¸°ê¹Œì§€ INSERT SQLì„ ë°ì´í„°ë² ì´ìŠ¤ì— ë³´ë‚´ì§€ ì•ŠëŠ”ë‹¤.//ì»¤ë°‹í•˜ëŠ” ìˆœê°„ ë°ì´í„°ë² ì´ìŠ¤ì— INSERT SQLì„ ëª¨ì•„ì„œ ë³´ë‚¸ë‹¤.transaction.commit(); // íŠ¸ëœì­ì…˜ ì»¤ë°‹3. ì§€ì—° ë¡œë”©ê³¼ ì¦‰ì‹œ ë¡œë”© ì˜µì…˜ì„ í†µí•´ ì§€ì—° ë¡œë”©ê³¼ ì¦‰ì‹œ ë¡œë”©ì„ ììœ ë¡­ê²Œ ì„ íƒí•  ìˆ˜ ìˆë‹¤. ë§Œì•½ SQL ì¤‘ì‹¬ì´ì—ˆë‹¤ë©´ ê´€ë ¨ëœ ì¿¼ë¦¬ë¥¼ ëª¨ë‘ ë³€ê²½í•´ì•¼ í–ˆì„ ê²ƒì´ë‹¤. ì§€ì—°ë¡œë”© : ê°ì²´ê°€ ì‹¤ì œ ì‚¬ìš©ë  ë•Œ ë¡œë”© Member member = memberDAO.find(memberId); // SELECT * FROM MEMBERTeam team = member.getTeam();String teamName = team.getName(); // SELECT * FROM TEAM ì¦‰ì‹œ ë¡œë”©: JOIN SQLë¡œ í•œë²ˆì— ì—°ê´€ëœ ê°ì²´ê¹Œì§€ ë¯¸ë¦¬ ì¡°íšŒ Member member = memberDAO.find(memberId); // SELECT * FROM M.*, T.* FROM MEMBER JOIN TEAM ...Team team = member.getTeam();String teamName = team.getName(); ì°¸ê³ ìë£Œ ê¹€ì˜í•œ, ìë°” ORM í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë° - ê¸°ë³¸í¸" }, { "title": "ê°„ë‹¨í•œ DI ì»¨í…Œì´ë„ˆ êµ¬í˜„í•´ë³´ê¸°", "url": "/posts/my-di-container/", "categories": "ê²½í—˜í•˜ê¸°, ì‘ì—… ë…¸íŠ¸", "tags": "Spring", "date": "2021-04-09 22:25:00 +0900", "snippet": "ë“¤ì–´ê°€ê¸° ì „ìˆœìˆ˜ ìë°”ì½”ë“œë¡œ ê°„ë‹¨í•œ ìŠ¤í”„ë§ DI ì»¨í…Œì´ë„ˆë¥¼ êµ¬í˜„í•´ë³´ë©´ì„œ DIì˜ í•„ìš”ì„±, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ë™ì‘ ì›ë¦¬ ë“±ì„ ì´í•´í•´ë³´ê¸° ìœ„í•´ ì•½ ì¼ì£¼ì¼ê°„ í† ì´ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í–ˆë‹¤.ì•„ë˜ì˜ ìš”êµ¬ì‚¬í•­ë“¤ì„ êµ¬í˜„í•˜ë©° ê°„ë‹¨í•œ ì»¨í…Œì´ë„ˆë¥¼ êµ¬í˜„í•´ë³´ì•˜ë‹¤. ì»¨í…Œì´ë„ˆ ìƒì„±ì íŒŒë¼ë¯¸í„°ë¡œ AppConfig.classë¥¼ ì „ë‹¬ë°›ê³  í•´ë‹¹ í´ë˜ìŠ¤ì˜ ì •ì˜ëœ ë©”ì„œë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¹ˆì„ ìƒì„±í•œë‹¤...", "content": "ë“¤ì–´ê°€ê¸° ì „ìˆœìˆ˜ ìë°”ì½”ë“œë¡œ ê°„ë‹¨í•œ ìŠ¤í”„ë§ DI ì»¨í…Œì´ë„ˆë¥¼ êµ¬í˜„í•´ë³´ë©´ì„œ DIì˜ í•„ìš”ì„±, ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ë™ì‘ ì›ë¦¬ ë“±ì„ ì´í•´í•´ë³´ê¸° ìœ„í•´ ì•½ ì¼ì£¼ì¼ê°„ í† ì´ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í–ˆë‹¤.ì•„ë˜ì˜ ìš”êµ¬ì‚¬í•­ë“¤ì„ êµ¬í˜„í•˜ë©° ê°„ë‹¨í•œ ì»¨í…Œì´ë„ˆë¥¼ êµ¬í˜„í•´ë³´ì•˜ë‹¤. ì»¨í…Œì´ë„ˆ ìƒì„±ì íŒŒë¼ë¯¸í„°ë¡œ AppConfig.classë¥¼ ì „ë‹¬ë°›ê³  í•´ë‹¹ í´ë˜ìŠ¤ì˜ ì •ì˜ëœ ë©”ì„œë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¹ˆì„ ìƒì„±í•œë‹¤. ìƒì„±ë˜ëŠ” ë¹ˆì€ ìœ ì¼í•´ì•¼ í•œë‹¤(ì‹±ê¸€í†¤). ë¹ˆì˜ ì´ë¦„ìœ¼ë¡œ ë¹ˆì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤. ë¹ˆì˜ íƒ€ì…ìœ¼ë¡œ ë¹ˆì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤. ê´€ë¦¬ë˜ëŠ” ëª¨ë“  ë¹ˆì˜ ì´ë¦„ì„ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤. ì˜ˆì™¸ ì²˜ë¦¬ ë¶€ëª¨ íƒ€ì…ìœ¼ë¡œ ì¡°íšŒì‹œ, ìì‹ì´ ë‘˜ ì´ìƒ ìˆìœ¼ë©´ ì¤‘ë³µ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. ë“±ë¡ë˜ì§€ ì•Šì€ ë¹ˆì˜ ì´ë¦„ìœ¼ë¡œ ì¡°íšŒì‹œ ì˜¤ë¥˜ê°€ ë°œìƒí•´ì•¼ í•œë‹¤. ì´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê°„ë‹¨í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œì§ ì‘ì„±â€» êµ¬í˜„ ì½”ë“œ repositoryDI(Dependency Injection) Containerë€ ? ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê°ì²´ë“¤ì„ ìƒì„±í•˜ê³  ê°ì²´ë“¤ ê°„ì˜ ì˜ì¡´ê´€ê³„ ì£¼ì…, ê°ì²´ì˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬ ë“±ì„ ë‹´ë‹¹í•˜ëŠ” ì£¼ì²´ ìŠ¤í”„ë§ DI ì»¨í…Œì´ë„ˆëŠ” ì˜ì¡´ê´€ê³„ ì£¼ì… ì´ì™¸ì—ë„ ë§¤ìš° ë§ì€ ì—­í• ì„ ìˆ˜í–‰í•œë‹¤.ì˜ì¡´ì„±(ì˜ì¡´ê´€ê³„) ì£¼ì…ì´ë€ ? í˜¸ì¶œí•  ê°ì²´ë¥¼ ì§ì ‘ ì„ ì–¸í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼ ëŸ°íƒ€ì„ì‹œ ì™¸ë¶€ì—ì„œ ì£¼ì…í•´ì£¼ëŠ” ê²ƒ DIê°€ ê°€ëŠ¥í•œ ì´ìœ ëŠ” êµ¬ì²´ì ì¸ ê°ì²´ê°€ ì•„ë‹Œ ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´í•˜ê¸° ë•Œë¬¸ì´ë‹¤. ë”°ë¼ì„œ, ê°ì²´ ê°„ì˜ ì˜ì¡´ê´€ê³„ë¥¼ ì •ì ì¸ í´ë˜ìŠ¤ ê´€ê³„ì—ì„œëŠ” ì•Œ ìˆ˜ ì—†ë‹¤.public class CustomerServiceImpl implements CustomerService { // ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´ private final CustomerRepository customerRepository; // ëŸ°íƒ€ì„ì‹œ ì™¸ë¶€ì—ì„œ ì£¼ì… public CustomerServiceImpl(CustomerRepository customerRepository) { this.customerRepository = customerRepository; }ì˜ì¡´ì„±(ì˜ì¡´ê´€ê³„) ì£¼ì…ì´ í•„ìš”í•œ ì´ìœ  DIP, SRP, OCPë¥¼ ì§€í‚¨ ì¢‹ì€ ì„¤ê³„ë¥¼ ê°€ëŠ¥í•˜ê²Œ í•´ì¤€ë‹¤. ì´ë¥¼ í†µí•´, ë³€í™”ì— ìœ ì—°í•˜ê²Œ ëŒ€ì²˜í•  ìˆ˜ ìˆë‹¤. DIP(Dependency Inversion Principle) : ì¶”ìƒí™”ì— ì˜ì¡´í•´ì•¼ì§€, êµ¬ì²´í™”ì— ì˜ì¡´í•˜ë©´ ì•ˆëœë‹¤. SRP(Single Responsibility Principle) : í•œ í´ë˜ìŠ¤ëŠ” í•˜ë‚˜ì˜ ì±…ì„ë§Œ ê°€ì ¸ì•¼ í•œë‹¤. OCP(Open Closed Principle) : ì†Œí”„íŠ¸ì›¨ì–´ ìš”ì†ŒëŠ” í™•ì¥ì—ëŠ” ì—´ë ¤ ìˆìœ¼ë‚˜ ë³€ê²½ì—ëŠ” ë‹«í˜€ ìˆì–´ì•¼ í•œë‹¤. ë§Œì•½, ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œì—ì„œ ì¸ë©”ëª¨ë¦¬ DBë¥¼ ì‚¬ìš©í•˜ëŠ” TemporaryCustomerRepositoryë¥¼ RDBë¥¼ ì‚¬ìš©í•˜ëŠ” êµ¬í˜„ì²´ë¡œ ë°”ê¿”ì•¼í•œë‹¤ê³  í–ˆì„ ë•Œ ì–´ë–¤ ë¬¸ì œê°€ ìˆì„ì§€ ì‚´í´ë³´ì CustomerServiceImplì´ TemporaryCustomerRepository() ë¼ëŠ” êµ¬ì²´ì ì¸ ê°ì²´ì— ì˜ì¡´í•˜ê³  ìˆë‹¤ (DIP ìœ„ë°˜) ë”°ë¼ì„œ êµ¬í˜„ì²´ë¥¼ ë³€ê²½í•˜ë ¤ë©´ TemporaryCustomerRepository() ë¥¼ ìƒˆë¡œìš´ êµ¬í˜„ì²´ë¡œ ë³€ê²½í•´ì¤˜ì•¼ í•œë‹¤ (OCP ìœ„ë°˜) CustomerServiceImplì˜ ì±…ì„ì€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì¸ë°, êµ¬ì²´ì ì¸ êµ¬í˜„ì²´ê¹Œì§€ ê²°ì •í•˜ê³  ìˆë‹¤ (SRP ìœ„ë°˜) public class CustomerServiceImpl implements CustomerService { private final CustomerRepository customerRepository = new TemporaryCustomerRepository(); @Override public void join(Customer customer) { customerRepository.save(customer.getId(), customer); } ë°˜ë©´, ë§¨ ì²˜ìŒ ì‚´í´ë´¤ë˜ ì˜ì¡´ê´€ê³„ ì£¼ì… ì½”ë“œì˜ ê²½ìš° CustomerRepositoryë¼ëŠ” ì¸í„°í˜ì´ìŠ¤ì—ë§Œ ì˜ì¡´í•œë‹¤ (DIP) ë”°ë¼ì„œ ë‹¤ë¥¸ êµ¬í˜„ì²´ë¡œ ë³€ê²½í•´ì•¼ í•˜ëŠ” ê²½ìš° í•´ë‹¹ ì½”ë“œì— ë³€ê²½ì‚¬í•­ì€ ì—†ë‹¤ (OCP) CustomerRepositoryì˜ êµ¬í˜„ì²´ëŠ” ëŸ°íƒ€ì„ì‹œ ì™¸ë¶€ì—ì„œ ì£¼ì…í•´ì£¼ê³  CustomerServiceImplí´ë˜ìŠ¤ëŠ” ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ë§Œ ìˆ˜í–‰í•œë‹¤ (SRP) public class CustomerServiceImpl implements CustomerService {// ì¸í„°í˜ì´ìŠ¤ì— ì˜ì¡´private final CustomerRepository customerRepository;// ëŸ°íƒ€ì„ì‹œ ì™¸ë¶€ì—ì„œ ì£¼ì…public CustomerServiceImpl(CustomerRepository customerRepository) { this.customerRepository = customerRepository;} êµ¬í˜„í•´ë³´ê¸°â€» êµ¬í˜„í•˜ë©´ì„œ ìŠ¤ìŠ¤ë¡œ í–ˆë˜ ì§ˆë¬¸ë“¤ì„ ì ì–´ë´¤ìŠµë‹ˆë‹¤1. AppConfig í´ë˜ìŠ¤ í™œìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆì— ë¹ˆ ë“±ë¡í•˜ê¸° ë¹ˆìœ¼ë¡œ ë“±ë¡í•˜ê¸° ìœ„í•´ AppConfigì— ì„ ì–¸í•œ ë‹¤ì–‘í•œ ë©”ì„œë“œì˜ ì´ë¦„, ë¦¬í„´íƒ€ì…, ì‹¤ì œ êµ¬í˜„ì²´ë¥¼ ì–´ë–»ê²Œ ê°€ì ¸ì˜¤ì§€ ? reflection, ì œë„¤ë¦­ì— ëŒ€í•´ ê³µë¶€ ë¹ˆì„ ë‹´ì•„ë‘ëŠ” ìë£Œ êµ¬ì¡°ëŠ” ë­ê°€ ì¢‹ì„ê¹Œ ? ë¹ˆ ì´ë¦„/í´ë˜ìŠ¤ íƒ€ì… or í´ë˜ìŠ¤ íƒ€ì… or ë¹ˆ ì´ë¦„ìœ¼ë¡œ ì›í•˜ëŠ” ê°ì²´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤ 2ê°œì˜ Mapì„ í™œìš©í•´ì„œ (ë¹ˆ ì´ë¦„ - ì¸ìŠ¤í„´ìŠ¤) ìŒê³¼ (íƒ€ì… - ë¹ˆ ì´ë¦„ ë¦¬ìŠ¤íŠ¸) ìŒ ë§Œë“ ë‹¤. ë‘ ë²ˆì§¸ Mapì—ì„œ valueê°€ ë¦¬ìŠ¤íŠ¸ì¸ ì´ìœ ëŠ” íƒ€ì…ì´ ê°™ì€ ë¹ˆì´ ì—¬ëŸ¬ ê°œì¸ ê²½ìš°ë„ ìˆê¸° ë•Œë¬¸ì— ê²°ê³¼ì ìœ¼ë¡œ íƒ€ì…ìœ¼ë¡œë§Œ ì¡°íšŒí•˜ëŠ” ê²½ìš° í•´ë‹¹ íƒ€ì…ì˜ ë¹ˆ ì´ë¦„ì„ ê°€ì ¸ì™€ì„œ ê·¸ ì´ë¦„ìœ¼ë¡œ ì²« ë²ˆì§¸ Mapì—ì„œ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì–»ì–´ì˜¬ ìˆ˜ ìˆë‹¤. ì»¨í…Œì´ë„ˆ í´ë˜ìŠ¤ì˜ ì˜ì¡´ ê´€ê³„ëŠ” ì–´ë–¤ì‹ìœ¼ë¡œ êµ¬ì„± í•˜ëŠ”ê²Œ ì¢‹ì„ê¹Œ ? í˜„ì¬ëŠ” ë¹ˆì„ ë“±ë¡í•˜ê³  ì¡°íšŒí•˜ëŠ” ê¸°ëŠ¥ ìœ„ì£¼ì˜ ì»¨í…Œì´ë„ˆì´ì§€ë§Œ ë‹¤ë¥¸ ê¸°ëŠ¥ì˜ í™•ì¥ì„±ì„ ê³ ë ¤í•´ì„œ Container ì¸í„°í˜ì´ìŠ¤ì— ê¸°ëŠ¥ë³„ë¡œ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìƒì†í•˜ëŠ”ê²Œ ì¢‹ì„ ê²ƒ ê°™ë‹¤ public interface BeanManagement { void registerBeans(Class&lt;?&gt;... clazz); Object getBean(String beanName) throws NoSuchBeanDefinitionException; &lt;T&gt; T getBean(String beanName, Class&lt;T&gt; beanType) throws NoSuchBeanDefinitionException; &lt;T&gt; T getBean(Class&lt;T&gt; beanType) throws NoUniqueBeanDefinitionException; String[] getBeanDefinitionNames(); int getBeanDefinitionCount(); } public interface Container extends BeanManagement, ì¶”ê°€ì ì¸ ê¸°ëŠ¥ë“¤... { } public class MyContainer implements Container { ... } ì‹¤ì œ ìŠ¤í”„ë§ì˜ ApplicationContextë„ ì•„ë˜ì™€ ê°™ì´ ë˜ì–´ìˆì—ˆë‹¤.public interface ApplicationContext extends EnvironmentCapable, ListableBeanFactory, HierarchicalBeanFactory,\t\tMessageSource, ApplicationEventPublisher, ResourcePatternResolver {2. ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ì‹ ê²°ì •í•˜ê¸° ìƒì„±ìë¥¼ í†µí•œ ì˜ì¡´ê´€ê³„ ì£¼ì…ë°©ì‹ìœ¼ë¡œ ê²°ì •ìˆ˜ì •ì(setter)ë¥¼ í†µí•œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ì‹ public ìœ¼ë¡œ setë©”ì„œë“œë¥¼ ì„ ì–¸í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ì¶”í›„ì— ì‹¤ìˆ˜ë¡œë¼ë„ ë³€ê²½ë  ê°€ëŠ¥ì„±ì´ ìˆìŒ ì‹¤ìˆ˜ë¡œ ì˜ì¡´ì„± ì£¼ì…ì„ í•´ì£¼ì§€ ì•Šìœ¼ë©´ ëŸ°íƒ€ì„ì‹œ NPE ë°œìƒí•  ìˆ˜ ìˆë‹¤.ìƒì„±ìë¥¼ í†µí•œ ì˜ì¡´ê´€ê³„ ì£¼ì… ë°©ì‹ ì¸ìŠ¤í„´ìŠ¤ ë³€ìˆ˜ë¥¼ finalë¡œ ì„ ì–¸í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ê°ì²´ê°€ ì£¼ì…ë˜ê³  ë‚˜ë©´ ë¶ˆë³€ì´ë‹¤. ëŒ€ë¶€ë¶„ì˜ ì˜ì¡´ê´€ê³„ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ì¢…ë£Œ ì „ê¹Œì§€ ë¶ˆë³€í•´ì•¼í•˜ë¯€ë¡œ ë¶ˆë³€ì´ ë³´ì¥ë˜ì–´ì•¼ í•œë‹¤. finalë¡œ ì„ ì–¸í•œ ë³€ìˆ˜ì— ëŒ€í•´ ìƒì„±ìì—ì„œ ì´ˆê¸°í™”ë¥¼ í•˜ì§€ ì•Šìœ¼ë©´ ì»´íŒŒì¼ ì˜¤ë¥˜ê°€ ë‚˜ê¸° ë•Œë¬¸ì— ì£¼ì…í•˜ì§€ ì•ŠëŠ” ì‹¤ìˆ˜ë¥¼ ë²”í•  ì¼ì´ ì—†ë‹¤. ìŠ¤í”„ë§ ê³µì‹ ë¬¸ì„œ ì—ì„œë„ ìƒì„±ìë¥¼ í†µí•œ ì£¼ì…ë°©ì‹ ê¶Œì¥ The Spring team generally advocates constructor injection as it enables one to implement application componentsas immutable objects and to ensure that required dependencies are not null.Furthermore constructor-injected components are always returned to client (calling) code in a fully initialized state.As a side note, a large number of constructor arguments is a bad code smell,implying that the class likely has too many responsibilities and should be refactored to better address proper separation of concerns. 3. ë¹ˆì„ ì‹±ê¸€í†¤ ê°ì²´ë¡œ ë§Œë“¤ê¸°ëª¨ë“  êµ¬í˜„ì²´ í´ë˜ìŠ¤ì— ì‹±ê¸€í†¤ íŒ¨í„´ ì ìš© boilerplate ì½”ë“œê°€ ë§Œë“¤ì–´ì§„ë‹¤. ì‹±ê¸€í†¤ íŒ¨í„´ì„ ì ìš©í•˜ë©´ ìœ ì—°ì„±ì´ ë–¨ì–´ì§„ë‹¤(ìƒì† ë¶ˆê°€ ë“±) ì‹±ê¸€í†¤ìœ¼ë¡œ ìƒì„±ë˜ëŠ” ê°ì²´ëŠ” êµ¬í˜„ì²´ë¥¼ ë‚´ë¶€ì— ì„ ì–¸í•˜ë¯€ë¡œ ê°ì²´ê°„ì— ê²°í•©ë„ê°€ ë†’ì•„ì§„ë‹¤.Config í´ë˜ìŠ¤ë“¤ì— ê³µí†µì ìœ¼ë¡œ ì ìš©ë  ìˆ˜ ìˆëŠ” ë¶€ëª¨ í´ë˜ìŠ¤ ìƒì„± Containerê°€ ì—¬ëŸ¬ë²ˆ ìƒì„±ë˜ë”ë¼ë„ Configì— ìˆëŠ” ë¹ˆì€ í•œ ë²ˆë§Œ ë“±ë¡ë  ìˆ˜ ìˆë„ë¡ staticìœ¼ë¡œ ì„ ì–¸ ë©€í‹°ìŠ¤ë ˆë”© í™˜ê²½ì—ì„œì˜ ë™ì‹œ ì ‘ê·¼ ë¬¸ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ConcurrentHashMap ì‚¬ìš© ë¬¸ì œì  AppConfigì—ì„œ boilerplate ì½”ë“œê°€ ìƒê¸´ë‹¤ (ë¹ˆ ìˆëŠ”ì§€ ì²´í¬, ì—†ìœ¼ë©´ ê°ì²´ ìƒì„±) ë©”ì„œë“œ ì´ë¦„ì´ ë°”ë€Œë©´ beanName ë³€ìˆ˜ì˜ ê°’ë„ ë³€ê²½í•´ì¤˜ì•¼ í•œë‹¤. ì¦‰, ì‹¤ìˆ˜í•  ì—¬ì§€ë¥¼ ì œê³µí•œë‹¤. ìƒì† êµ¬ì¡°ë¡œ ì¸í•´ AppConfigëŠ” CommonConfigì— ì˜ì¡´í•˜ê²Œëœë‹¤. CommonConfigì˜ ë³€ê²½ì´ AppConfigì— ì˜í–¥ì„ ì¤„ ìˆ˜ ìˆë‹¤. public class CommonConfig { private static Map&lt;String, Object&gt; beanStore = new ConcurrentHashMap&lt;&gt;(); private static Set&lt;String&gt; beanNames = ConcurrentHashMap.newKeySet(); public Object getBean(String beanName) { return beanStore.get(beanName); } public &lt;T&gt; void createBean(String beanName, T instance) { beanStore.put(beanName, instance); beanNames.add(beanName); } public boolean isExist(String beanName) { return beanNames.contains(beanName); }}public class AppConfig extends CommonConfig { public CustomerService customerService() { String beanName = \"customerService\"; if(!isExist(beanName)) { CustomerService customerService = new CustomerServiceImpl(customerRepository(), plannerService()); createBean(beanName, customerService); } return (CustomerService) getBean(beanName); } public PlannerService plannerService() { String beanName = \"plannerService\"; if(!isExist(beanName)) { PlannerService plannerService = new PlannerServiceImpl(customerRepository()); createBean(beanName, plannerService); } return (PlannerService) getBean(beanName); } public CustomerRepository customerRepository() { String beanName = \"customerRepository\"; if(!isExist(beanName)) { CustomerRepository customerRepository = new TemporaryCustomerRepository(); createBean(beanName, customerRepository); } return (CustomerRepository) getBean(beanName); }}4. ë§Œë“¤ì–´ì§„ ì»¨í…Œì´ë„ˆë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°„ë‹¨í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ì‘ì„±ë” ê³µë¶€í•´ì•¼í•  ë¶€ë¶„ ìŠ¤í”„ë§ì—ì„œ ì‹±ê¸€í†¤ ê°ì²´ë¥¼ ë³´ì¥í•˜ëŠ” ë°©ë²•ì°¸ê³  ìë£Œ ì¸í”„ëŸ° ê¹€ì˜í•œë‹˜ ê°•ì˜(ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬ - ê¸°ë³¸í¸) SOLID ì›ì¹™" }, { "title": "Java - ìë°” ì œë„¤ë¦­", "url": "/posts/java-generic/", "categories": "ì§€ì‹ ë”í•˜ê¸°, ì´ë¡ ", "tags": "Java", "date": "2021-04-06 23:00:00 +0900", "snippet": "ì œë„¤ë¦­ generic : í¬ê´„ì ì¸, ì´ì¹­[í†µì¹­]ì˜ ìë°”ëŠ” ì—¬ëŸ¬ íƒ€ì…ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì—, í˜• ë³€í™˜ì„ í•˜ë©´ì„œ ë§ì€ ì˜ˆì™¸ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.ë”°ë¼ì„œ, Java5 ë¶€í„° ë„ì…ëœ ì œë„¤ë¦­ì„ í†µí•´ íƒ€ì… í˜• ë³€í™˜ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œì ì„ ì‚¬ì „ì— ë°©ì§€í•´ì¤€ë‹¤.ì¦‰, ì»´íŒŒì¼ ì‹œ ì´ëŸ¬í•œ ë¶€ë¶„ì„ ì ê²€í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.public class CastingGenericDT...", "content": "ì œë„¤ë¦­ generic : í¬ê´„ì ì¸, ì´ì¹­[í†µì¹­]ì˜ ìë°”ëŠ” ì—¬ëŸ¬ íƒ€ì…ì´ ì¡´ì¬í•˜ê¸° ë•Œë¬¸ì—, í˜• ë³€í™˜ì„ í•˜ë©´ì„œ ë§ì€ ì˜ˆì™¸ê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.ë”°ë¼ì„œ, Java5 ë¶€í„° ë„ì…ëœ ì œë„¤ë¦­ì„ í†µí•´ íƒ€ì… í˜• ë³€í™˜ì—ì„œ ë°œìƒí•  ìˆ˜ ìˆëŠ” ë¬¸ì œì ì„ ì‚¬ì „ì— ë°©ì§€í•´ì¤€ë‹¤.ì¦‰, ì»´íŒŒì¼ ì‹œ ì´ëŸ¬í•œ ë¶€ë¶„ì„ ì ê²€í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.public class CastingGenericDTO&lt;T&gt; implements Serialiazble { private T object; public void setObject(T obj) { \tthis.object= obj; } public T getObejct() { \treturn object; }}public class GenricTester {\tpublic static void main(String[] args) { \tCastingGenericDTO&lt;String&gt; dto1 = new CastingGenericDTO&lt;&gt;(); dto1.setObject(\"string type\");\t\tdto1.setObject(new StringBuilder(\"builder\")); // í˜• ë¶ˆì¼ì¹˜ë¡œ ì»´íŒŒì¼ ì—ëŸ¬ ë°œìƒ ! CastingGenericDTO&lt;StringBuilder&gt; dto2 = new CastingGenericDTO&lt;&gt;(); dto2.setObject(new StringBuilder(\"builder type\")); String val1 = dto2.getObject(); // í˜• ë¶ˆì¼ì¹˜ë¡œ ì»´íŒŒì¼ ì—ëŸ¬ ë°œìƒ ! StringBuilder val2 = dto1.getObject(); // í˜• ë¶ˆì¼ì¹˜ë¡œ ì»´íŒŒì¼ ì—ëŸ¬ ë°œìƒ ! }}ì œë„¤ë¦­ íƒ€ì…ì˜ ì´ë¦„ ì•„ë˜ ê·œì¹™ì„ ë”°ë¼ì•¼ ì»´íŒŒì¼ ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆì§€ë§Œ, í†µìƒì ìœ¼ë¡œ ì“°ì´ëŠ” ê²ƒì´ë¯€ë¡œ ë‹¤ë¥¸ ì‚¬ëŒì´ ë³´ê¸°ì—ë„ ì´í•´í•˜ê¸° ì‰½ë„ë¡ í•´ë‹¹ ê·œì¹™ì„ ë”°ë¥´ëŠ”ê²Œ ì¢‹ë‹¤. E : ìš”ì†Œ (Element, ìë°” ì»¬ë ‰ì…˜ì—ì„œ ì£¼ë¡œ ì‚¬ìš©ë¨) K : í‚¤ N : ìˆ«ì T : íƒ€ì… V : ê°’ S,U,V : ë‘ ë²ˆì§¸, ì„¸ ë²ˆì§¸, ë„¤ ë²ˆì§¸ì— ì„ ì–¸ëœ íƒ€ì…wildcard : ? ë§Œì•½ ì–´ë–¤ ë©”ì„œë“œì—ì„œ CastingGenericDTO íƒ€ì…ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ë°›ê³  ì‹¶ìœ¼ë©´ ì–´ë–»ê²Œ í•´ì•¼í• ê¹Œ ? ë‹¤ìŒê³¼ ê°™ì´ í•  ìˆ˜ ìˆë‹¤. public void printValue(CastingGenericDTO&lt;?&gt; dto) { \tSystem.out.println(dto.getObejct());} í•˜ì§€ë§Œ ìœ„ì™€ ê°™ì´ í•˜ê²Œ ë˜ë©´, CastingGenericDTO íƒ€ì…ì˜ íŒŒë¼ë¯¸í„°ì— ê°’ì„ ì¶”ê°€í•˜ê±°ë‚˜ í•˜ëŠ” ë™ì‘ì„ í•  ìˆ˜ëŠ” ì—†ë‹¤. ë§Œì•½ ê·¸ëŸ¬í•œ ë¡œì§ì„ ì²˜ë¦¬í•´ì•¼ í•œë‹¤ë©´ ì•„ë˜ì™€ ê°™ì´ ë©”ì„œë“œë¥¼ ì„ ì–¸í•  ìˆ˜ ìˆë‹¤. public &lt;T&gt; void setValue(CastingGenericDTO&lt;T&gt; dto, T newValue) { dto.setObject(newValue); System.out.println(dto.getObejct()); } ì œë„¤ë¦­ ì„ ì–¸ì— ì‚¬ìš©í•˜ëŠ” íƒ€ì… ë²”ìœ„ ì§€ì •í•˜ê¸° &lt;&gt; ì•ˆì— ì–´ë–¤ íƒ€ì…ë„ ìƒê´€ ì—†ì§€ë§Œ, wildcardë¡œ ì‚¬ìš©í•˜ëŠ” íƒ€ì…ì„ ì œí•œí•  ìˆ˜ëŠ” ìˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ í•˜ë©´ Car í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ê±°ë‚˜, Car ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤ë§Œ íŒŒë¼ë¯¸í„°ë¡œ ë°›ì„ ìˆ˜ ìˆë‹¤. public void printCarType(CastingGenericDTO&lt;? extends Car&gt; car) { System.out.println(car.getType()); } public &lt;T extends Car&gt; void setCarType(CastingGenericDTO&lt;T&gt; car, T newType) { car.setType(newType); System.out.println(car.getObejct()); } ë©€í‹° ì œë„¤ë¦­ íƒ€ì… public &lt;S,T extends Car&gt; void multiValues(CastingGenericDTO&lt;S&gt; dto, T newCar, S value) { }ì‹¤ì œë¡œ ì ìš©í•˜ê¸° ê°„ë‹¨í•œ ì›¹ ì„œë²„ë¥¼ êµ¬í˜„í•´ë³¸ í† ì´ í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•´ë³´ì•˜ë‹¤. í´ë¼ì´ì–¸íŠ¸ ì¸¡ìœ¼ë¡œ HTTP ì‘ë‹µì„ ë³´ë‚¼ ë•Œ, setStatusCode()ë¡œ ìƒíƒœ ì½”ë“œ ì„¸íŒ…ì‹œ ì—‰ëš±í•œ ê°’ì´ ë“¤ì–´ì˜¤ì§€ ëª»í•˜ë„ë¡HttpStatusCode íƒ€ì…ì¸ ê°’ë§Œ ì„¸íŒ…ë  ìˆ˜ ìˆê²Œ í–ˆë‹¤.public &lt;T extends HttpStatusCode&gt; void setStatusCode(T statusCode) throws IOException { dos.writeBytes(String.format(\"HTTP/1.1 %s \\r\\n\", statusCode.getValue()));}public interface HttpStatusCode { String getValue();}public enum HttpStatusCode2xx implements HttpStatusCode { OK(\"200 OK\"), Created(\"201 Created\"), Accepted(\"202 Accepted\"), NonAuthoritativeInformation(\"203 Non-Authoritative Information\"), NoContent(\"204 No Content\"), ResetContent(\"205 Reset Content\"), PartialContent(\"206 Partial Content\"); private String statusCode; HttpStatusCode2xx(String statusCode) { this.statusCode = statusCode; } @Override public String getValue() { return this.statusCode; }}ì°¸ê³  ìë£Œ ì´ìƒë¯¼, ã€ìë°”ì˜ ì‹  2ã€, ë¡œë“œë¶(2017), 21ì¥" } ]
