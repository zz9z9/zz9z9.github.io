<!DOCTYPE html><html lang="en-US" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Java - 자바로 엑셀을 만들기 위한 POI 라이브러리 살펴보기" /><meta property="og:locale" content="en_US" /><meta name="description" content="회사 프로젝트에서 조회한 화면에 대해 엑셀 파일로 다운받게 만들어주는 기능을 구현해야 했다. 방법을 찾다보니 POI 라이브러리라는게 있었고 이를 활용해서 구현할 수 있었다. 하지만, 다른 파트에서 해당 라이브러리를 사용하다 OOM(Out Of Memory)에러가 발생했고, 구현체를 살펴보니 XSSF의 usermodel을 사용하고 있었다. 해당 파트에서는 문제 해결을 위해 알아보던 중, SXSSF가 더 효율적이라는 것을 찾아냈고 이를 적용하여 OOM 문제를 해결했다. (이 글 에서도 비슷한 경험을 공유해주신다.) 아직 우리 파트에선 OOM이 발생하진 않았지만, 현재 XSSF를 사용하고 있기 때문에 OOM이 발생할 잠재적 가능성을 갖고있는 것이다. 따라서, SXSSF를 적용하기에 앞서 어떤 원리로 이런 차이가 만들어지는건지 알고 싶었다." /><meta property="og:description" content="회사 프로젝트에서 조회한 화면에 대해 엑셀 파일로 다운받게 만들어주는 기능을 구현해야 했다. 방법을 찾다보니 POI 라이브러리라는게 있었고 이를 활용해서 구현할 수 있었다. 하지만, 다른 파트에서 해당 라이브러리를 사용하다 OOM(Out Of Memory)에러가 발생했고, 구현체를 살펴보니 XSSF의 usermodel을 사용하고 있었다. 해당 파트에서는 문제 해결을 위해 알아보던 중, SXSSF가 더 효율적이라는 것을 찾아냈고 이를 적용하여 OOM 문제를 해결했다. (이 글 에서도 비슷한 경험을 공유해주신다.) 아직 우리 파트에선 OOM이 발생하진 않았지만, 현재 XSSF를 사용하고 있기 때문에 OOM이 발생할 잠재적 가능성을 갖고있는 것이다. 따라서, SXSSF를 적용하기에 앞서 어떤 원리로 이런 차이가 만들어지는건지 알고 싶었다." /><link rel="canonical" href="https://zz9z9.github.io/posts/excel-using-poi-library/" /><meta property="og:url" content="https://zz9z9.github.io/posts/excel-using-poi-library/" /><meta property="og:site_name" content="zz9z9" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-22T00:29:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Java - 자바로 엑셀을 만들기 위한 POI 라이브러리 살펴보기" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-07-22T00:29:00+09:00","datePublished":"2021-07-22T00:29:00+09:00","description":"회사 프로젝트에서 조회한 화면에 대해 엑셀 파일로 다운받게 만들어주는 기능을 구현해야 했다. 방법을 찾다보니 POI 라이브러리라는게 있었고 이를 활용해서 구현할 수 있었다. 하지만, 다른 파트에서 해당 라이브러리를 사용하다 OOM(Out Of Memory)에러가 발생했고, 구현체를 살펴보니 XSSF의 usermodel을 사용하고 있었다. 해당 파트에서는 문제 해결을 위해 알아보던 중, SXSSF가 더 효율적이라는 것을 찾아냈고 이를 적용하여 OOM 문제를 해결했다. (이 글 에서도 비슷한 경험을 공유해주신다.) 아직 우리 파트에선 OOM이 발생하진 않았지만, 현재 XSSF를 사용하고 있기 때문에 OOM이 발생할 잠재적 가능성을 갖고있는 것이다. 따라서, SXSSF를 적용하기에 앞서 어떤 원리로 이런 차이가 만들어지는건지 알고 싶었다.","headline":"Java - 자바로 엑셀을 만들기 위한 POI 라이브러리 살펴보기","mainEntityOfPage":{"@type":"WebPage","@id":"https://zz9z9.github.io/posts/excel-using-poi-library/"},"url":"https://zz9z9.github.io/posts/excel-using-poi-library/"}</script><title>Java - 자바로 엑셀을 만들기 위한 POI 라이브러리 살펴보기 | zz9z9</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="zz9z9"><meta name="application-name" content="zz9z9"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-Q7PWLG5WYT"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-Q7PWLG5WYT'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d3/Soccerball.svg/1000px-Soccerball.svg.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">zz9z9</a></div><div class="site-subtitle font-italic">거창한 계획보다는, 꾸준한 실행을</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/zz9z9" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Java - 자바로 엑셀을 만들기 위한 POI 라이브러리 살펴보기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Java - 자바로 엑셀을 만들기 위한 POI 라이브러리 살펴보기</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Lee JaeYoon </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 22, 2021, 12:29 AM +0900" prep="on" > Jul 22, 2021 <i class="unloaded">2021-07-22T00:29:00+09:00</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1261 words">7 min</span></div></div><div class="post-content"><p>회사 프로젝트에서 조회한 화면에 대해 엑셀 파일로 다운받게 만들어주는 기능을 구현해야 했다. 방법을 찾다보니 POI 라이브러리라는게 있었고 이를 활용해서 구현할 수 있었다. 하지만, 다른 파트에서 해당 라이브러리를 사용하다 OOM(Out Of Memory)에러가 발생했고, 구현체를 살펴보니 XSSF의 usermodel을 사용하고 있었다. 해당 파트에서는 문제 해결을 위해 알아보던 중, SXSSF가 더 효율적이라는 것을 찾아냈고 이를 적용하여 OOM 문제를 해결했다. (<a href="https://lhb0517.tistory.com/entry/OOM-%EB%A7%9E%EA%B3%A0-%EB%82%98%EC%84%9C-%EC%95%8C%EC%95%84%EB%B3%B8-apache-poi-xlsx">이 글</a> 에서도 비슷한 경험을 공유해주신다.)<br /> 아직 우리 파트에선 OOM이 발생하진 않았지만, 현재 XSSF를 사용하고 있기 때문에 OOM이 발생할 잠재적 가능성을 갖고있는 것이다. 따라서, SXSSF를 적용하기에 앞서 어떤 원리로 이런 차이가 만들어지는건지 알고 싶었다.</p><h1 id="hssf--xssf">HSSF &amp; XSSF</h1><hr /><ul><li>HSSF는 Excel ‘97(-2007) 파일 형식(.xls)를 지원한다.<li>XSSF는 Excel 2007 OOXML(.xlsx) 파일 형식을 지원한다.<li>HSSF, XSSF는 다음과 같은 기능을 제공한다.<ul><li>low level structures<li>효율적인 읽기 전용 액세스를 위한 이벤트 모델(eventmodel) API<li>XLS 파일을 만들고, 읽고, 수정하기 위한 전체 사용자 모델(usermodel) API</ul><li>권고사항<ul><li>스프레드시트 데이터만 읽는 경우, 파일 형식에 따라 org.apache.poi.hssf.eventusermodel 패키지 또는 org.apache.poi.xssf.eventusermodel 패키지의 eventmodel api를 사용<li>스프레드시트 데이터를 수정, 생성하는 경우 usermodel API를 사용</ul><li>usermodel 시스템은 low level의 eventusermodel보다 memory footprint가 더 높지만 작업하기는 훨씬 간단하다.<li>XSSF가 지원되는 Excel 2007(.xlsx) 파일은 XML 기반, HSSF가 지원되는 Excel ‘97 파일(.xls)은 바이너리 기반이다.<ul><li>XML을 처리하는데 필요한 memory footprint가 더 높다.</ul></ul><h3 id="-memory-footprint--프로그램이-실행하는-동안-사용하거나-참조하는-기본-메모리의-양"><strong><em>※ memory footprint : 프로그램이 실행하는 동안 사용하거나 참조하는 기본 메모리의 양</em></strong></h3><h1 id="sxssf">SXSSF</h1><hr /><blockquote><p>Since 3.8-beta3, POI <strong><em>provides a low-memory footprint</em></strong> SXSSF API built on top of XSSF. <br /></p></blockquote><ul><li>SXSSF는 매우 큰 스프레드시트를 생성하거나 힙 공간이 제한될 때 사용할 수 있는 XSSF의 API 호환 스트리밍 확장이다.<li>SXSSF는 sliding window 내에 있는 행에 대한 액세스를 제한하여 low memory footprint를 가능하게 한다. <br /> (window : 메모리 버퍼의 일정 영역)<ul><li>반면, XSSF는 문서의 모든 행에 대한 액세스를 제공한다.</ul></ul><figure align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/64415489/126660736-7a3a3d0a-d972-4c89-b37c-2dde36b68db1.png" /><figcaption align="center"> <b>Sliding Window Memory Buffer Architecture</b> <br /> (출처 : https://www.researchgate.net/figure/Sliding-Window-Memory-Buffer-Architecture_fig1_272854151)</figcaption></figure><ul><li>더 이상 window에 없는 이전 행은 디스크에 기록될 때 액세스할 수 없게 된다.<li>auto-flush 모드에서는 access window의 크기를 지정하여 일정한 수의 행을 메모리에 보관할 수 있다.<ul><li>이 값에 도달했을 때 추가 행을 만들면, 가장 낮은 인덱스를 가진 행이 access window에서 제거되고 디스크에 기록된다.<div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
   <span class="nc">SXSSFWorkbook</span> <span class="n">wb</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SXSSFWorkbook</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span> <span class="c1">// keep 100 rows in memory, exceeding rows will be flushed to disk</span>
   <span class="nc">Sheet</span> <span class="n">sh</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">();</span>
   <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">rownum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">rownum</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="o">;</span> <span class="n">rownum</span><span class="o">++){</span>
       <span class="nc">Row</span> <span class="n">row</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="n">rownum</span><span class="o">);</span>
       <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">cellnum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">cellnum</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">cellnum</span><span class="o">++){</span>
           <span class="nc">Cell</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="n">cellnum</span><span class="o">);</span>
           <span class="nc">String</span> <span class="n">address</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CellReference</span><span class="o">(</span><span class="n">cell</span><span class="o">).</span><span class="na">formatAsString</span><span class="o">();</span>
           <span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>
       <span class="o">}</span>
   <span class="o">}</span>
   <span class="c1">// Rows with rownum &lt; 900 are flushed and not accessible</span>
   <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">rownum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">rownum</span> <span class="o">&lt;</span> <span class="mi">900</span><span class="o">;</span> <span class="n">rownum</span><span class="o">++){</span>
     <span class="nc">Assert</span><span class="o">.</span><span class="na">assertNull</span><span class="o">(</span><span class="n">sh</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="n">rownum</span><span class="o">));</span>
   <span class="o">}</span>
   <span class="c1">// ther last 100 rows are still in memory</span>
   <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">rownum</span> <span class="o">=</span> <span class="mi">900</span><span class="o">;</span> <span class="n">rownum</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="o">;</span> <span class="n">rownum</span><span class="o">++){</span>
       <span class="nc">Assert</span><span class="o">.</span><span class="na">assertNotNull</span><span class="o">(</span><span class="n">sh</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="n">rownum</span><span class="o">));</span>
   <span class="o">}</span>
   <span class="nc">FileOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"/temp/sxssf.xlsx"</span><span class="o">);</span>
   <span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">out</span><span class="o">);</span>
   <span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
   <span class="c1">// dispose of temporary files backing this workbook on disk</span>
   <span class="n">wb</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
 <span class="o">}</span>
</pre></table></code></div></div></ul><li>window 크기를 동적으로 조정하고 필요에 따라 행을 flushRows(int keepRows)하는 명시적 호출로 주기적으로 잘라낼 수 있다.<div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre> <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="nc">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="nc">Throwable</span> <span class="o">{</span>
     <span class="nc">SXSSFWorkbook</span> <span class="n">wb</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SXSSFWorkbook</span><span class="o">(-</span><span class="mi">1</span><span class="o">);</span> <span class="c1">// turn off auto-flushing and accumulate all rows in memory</span>
     <span class="nc">Sheet</span> <span class="n">sh</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="na">createSheet</span><span class="o">();</span>
     <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">rownum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">rownum</span> <span class="o">&lt;</span> <span class="mi">1000</span><span class="o">;</span> <span class="n">rownum</span><span class="o">++){</span>
         <span class="nc">Row</span> <span class="n">row</span> <span class="o">=</span> <span class="n">sh</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="n">rownum</span><span class="o">);</span>
         <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">cellnum</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">cellnum</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="o">;</span> <span class="n">cellnum</span><span class="o">++){</span>
             <span class="nc">Cell</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="n">cellnum</span><span class="o">);</span>
             <span class="nc">String</span> <span class="n">address</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">CellReference</span><span class="o">(</span><span class="n">cell</span><span class="o">).</span><span class="na">formatAsString</span><span class="o">();</span>
             <span class="n">cell</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">address</span><span class="o">);</span>
         <span class="o">}</span>
        <span class="c1">// manually control how rows are flushed to disk</span>
        <span class="k">if</span><span class="o">(</span><span class="n">rownum</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
             <span class="o">((</span><span class="nc">SXSSFSheet</span><span class="o">)</span><span class="n">sh</span><span class="o">).</span><span class="na">flushRows</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span> <span class="c1">// retain 100 last rows and flush all others</span>
             <span class="c1">// ((SXSSFSheet)sh).flushRows() is a shortcut for ((SXSSFSheet)sh).flushRows(0),</span>
             <span class="c1">// this method flushes all rows</span>
        <span class="o">}</span>
     <span class="o">}</span>
     <span class="nc">FileOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">FileOutputStream</span><span class="o">(</span><span class="s">"/temp/sxssf.xlsx"</span><span class="o">);</span>
     <span class="n">wb</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">out</span><span class="o">);</span>
     <span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
     <span class="c1">// dispose of temporary files backing this workbook on disk</span>
     <span class="n">wb</span><span class="o">.</span><span class="na">dispose</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><li>스트리밍 특성으로 인해 XSSF와 비교할 때 다음과 같은 제한이 있다.<ul><li>한 시점에는 제한된 수의 행만 액세스할 수 있습니다.<li>Sheet.clone()은 지원되지 않습니다.<li>Formula evaluation이 지원되지 않는다.</ul></ul><h1 id="spreadsheet-api-feature-summary">Spreadsheet API Feature Summary</h1><hr /><figure align="center"> <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/64415489/126656972-e65a38bf-4ea7-45b2-9cd3-164e4e0586bc.png" width="110%" /><figcaption align="center">출처 : https://poi.apache.org/components/spreadsheet/</figcaption></figure><h1 id="실제-메모리-사용량-비교해보기">실제 메모리 사용량 비교해보기</h1><hr /><ul><li><a href="https://zz9z9.github.io/posts/xssf-oom-analyze/">XSSF vs SXSSF 클래스 메모리 사용량 비교해보기</a></ul><h1 id="더-공부할-부분">더 공부할 부분</h1><hr /><ul><li>sliding window memory 아키텍처</ul><h1 id="참고-자료">참고 자료</h1><hr /><ul><li><a href="https://poi.apache.org/components/spreadsheet/how-to.html#sxssf">https://poi.apache.org/components/spreadsheet/how-to.html#sxssf</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%EC%A7%80%EC%8B%9D-%EB%8D%94%ED%95%98%EA%B8%B0/'>지식 더하기</a>, <a href='/categories/%EC%9D%B4%EB%A1%A0/'>이론</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/java/" class="post-tag no-text-decoration" >Java</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Java - 자바로 엑셀을 만들기 위한 POI 라이브러리 살펴보기 - zz9z9&url=https://zz9z9.github.io/posts/excel-using-poi-library/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Java - 자바로 엑셀을 만들기 위한 POI 라이브러리 살펴보기 - zz9z9&u=https://zz9z9.github.io/posts/excel-using-poi-library/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Java - 자바로 엑셀을 만들기 위한 POI 라이브러리 살펴보기 - zz9z9&url=https://zz9z9.github.io/posts/excel-using-poi-library/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/jpa-entity-manager-persistence-context/">EntityManager와 영속성 컨텍스트</a><li><a href="/posts/jpa-id-generation-strategy/">JPA/Hibernate ID 생성 전략</a><li><a href="/posts/aws-vpc/">AWS VPC(Virtual Private Cloud) - 기초 개념</a><li><a href="/posts/aws-efs/">AWS EFS(Elastic File System) - 기초 개념</a><li><a href="/posts/aws-intro/">AWS - 상품 살펴보기</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/mysql/">MySQL</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/web/">WEB</a> <a class="post-tag" href="/tags/infra/">Infra</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/http/">HTTP</a> <a class="post-tag" href="/tags/spring-batch/">Spring Batch</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/java-io-nio/"><div class="card-body"> <span class="timeago small" > Sep 7, 2021 <i class="unloaded">2021-09-07T00:29:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java - 자바 IO, NIO</h3><div class="text-muted small"><p> Java I/O Input, Output을 나타낸다. In, Out의 기준은 JVM이다. 즉, JVM으로 들어오는 데이터를 다루는 경우엔 Input 데이터를 내보내는 경우엔 Output이다. Stream 기반이다. 한 번에 1byte 또는 그 이상의 byte를 읽는다. 데이터가 캐시되지 않는다. 따라서 데...</p></div></div></a></div><div class="card"> <a href="/posts/java-reading-file/"><div class="card-body"> <span class="timeago small" > Sep 8, 2021 <i class="unloaded">2021-09-08T00:29:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java - 자바에서 파일 읽어오기</h3><div class="text-muted small"><p> 들어가기 전 사실 실무에서 자바 코드로 파일을 읽어와서 데이터를 처리하거나 할 일이 없어서, 파일을 다루는 부분에 대한 코드를 작성할 일이 생기면, 그 때 마다 구글링해서 사용했던 것 같다. 최근에 .json 파일에 있는 데이터를 읽어와서 처리해야할 일이 있었는데, 매번 구글링 하는 것 보다 머릿속에 한 번 확실히 정리해야 할 것 같다는 생각이 들어...</p></div></div></a></div><div class="card"> <a href="/posts/equals-and-hashcode/"><div class="card-body"> <span class="timeago small" > Sep 24, 2021 <i class="unloaded">2021-09-24T22:25:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Java - 왜 equals()와 hashCode()는 함께 오버라이딩 해야할까 ?</h3><div class="text-muted small"><p> 들어가기 전 실무에서는 equals(), hashCode() 메서드를 오버라이드 할 일이 별로 없었던 것 같다. 하지만 몇 달 전 간단한 웹 서버를 만들어보는 토이 프로젝트를 진행하던 중, 클라이언트로부터 받은 요청을 유틸 클래스의 메서드를 사용해서 HttpRequest 객체를 만드는 부분에 대한 테스트 코드를 작성했는데 원하는 결과가 나오지 않았다...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/heap-analyze-with-jmap-and-mat/" class="btn btn-outline-primary" prompt="Older"><p>Java - 자바 메모리 단면 분석하기</p></a> <a href="/posts/xssf-oom-analyze/" class="btn btn-outline-primary" prompt="Newer"><p>XSSF로 인한 OOM 에러 그리고 SXSSF와 메모리 사용량 비교해보기</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://twitter.com/username">Lee JaeYoon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/mysql/">MySQL</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/web/">WEB</a> <a class="post-tag" href="/tags/infra/">Infra</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/http/">HTTP</a> <a class="post-tag" href="/tags/spring-batch/">Spring Batch</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://zz9z9.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
