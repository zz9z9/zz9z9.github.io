<!DOCTYPE html><html lang="en-US" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="MySQL - Nested-Loop Join 알아보기" /><meta property="og:locale" content="en_US" /><meta name="description" content="Nested-Loop Join Algorithm" /><meta property="og:description" content="Nested-Loop Join Algorithm" /><link rel="canonical" href="https://zz9z9.github.io/posts/mysql-nested-loop-join/" /><meta property="og:url" content="https://zz9z9.github.io/posts/mysql-nested-loop-join/" /><meta property="og:site_name" content="zz9z9" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-10-01T21:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="MySQL - Nested-Loop Join 알아보기" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-10-12T01:27:54+09:00","datePublished":"2025-10-01T21:00:00+09:00","description":"Nested-Loop Join Algorithm","headline":"MySQL - Nested-Loop Join 알아보기","mainEntityOfPage":{"@type":"WebPage","@id":"https://zz9z9.github.io/posts/mysql-nested-loop-join/"},"url":"https://zz9z9.github.io/posts/mysql-nested-loop-join/"}</script><title>MySQL - Nested-Loop Join 알아보기 | zz9z9</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="zz9z9"><meta name="application-name" content="zz9z9"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-Q7PWLG5WYT"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-Q7PWLG5WYT'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d3/Soccerball.svg/1000px-Soccerball.svg.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">zz9z9</a></div><div class="site-subtitle font-italic">거창한 계획보다는, 꾸준한 실행을</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/zz9z9" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>MySQL - Nested-Loop Join 알아보기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>MySQL - Nested-Loop Join 알아보기</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Lee JaeYoon </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Wed, Oct 1, 2025, 9:00 PM +0900" prep="on" > Oct 1, 2025 <i class="unloaded">2025-10-01T21:00:00+09:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 12, 2025, 1:27 AM +0900" prefix="Updated " > Oct 12, 2025 <i class="unloaded">2025-10-12T01:27:54+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1595 words">8 min</span></div></div><div class="post-content"><h2 id="nested-loop-join-algorithm">Nested-Loop Join Algorithm</h2><hr /><ul><li>MySQL은 테이블 간 조인을 수행할 때, <strong>중첩 루프 조인(Nested-Loop Join, NLJ) 알고리즘(및 그 변형)</strong>을 사용한다.<ul><li>MySQL 8.0.18부터는 <a href="https://dev.mysql.com/doc/refman/8.4/en/hash-joins.html">Hash Join</a>도 지원</ul><li>NLJ : 바깥(outer) 테이블에서 한 행씩 가져와 안쪽(inner) 테이블과 조인한다.<ul><li>outer : driving 테이블 / inner : driven 테이블 이라고도 불림</ul><li>이 과정은 조인해야 할 모든 테이블에 대해 반복된다.<li>MySQL 옵티마이저는 <strong>통계 정보(테이블 크기, 인덱스 카디널리티 등)</strong>를 기반으로 자동으로 조인 순서를 선택한다.<li>필요시 <code class="language-plaintext highlighter-rouge">STRAIGHT_JOIN</code> / 힌트를 이용해 강제할 수 있다.</ul><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">FOR</span> <span class="k">each</span> <span class="k">row</span> <span class="k">in</span> <span class="k">Outer</span> <span class="p">{</span>
  <span class="k">FOR</span> <span class="k">each</span> <span class="k">row</span> <span class="k">in</span> <span class="k">Inner</span> <span class="n">matching</span> <span class="k">join</span> <span class="n">condition</span> <span class="p">{</span>
    <span class="k">OUTPUT</span> <span class="n">if</span> <span class="k">row</span> <span class="n">satisfies</span> <span class="n">conditions</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h3 id="nlj-비교">NLJ 비교</h3><div class="table-wrapper"><table><thead><tr><th>알고리즘<th>동작 방식<th>시간 복잡도<th>비고<tbody><tr><td><strong>Simple NLJ</strong><td>Outer 행마다 Inner 전체 스캔<td>O(N × M)<td>인덱스 없고 최적화 불가할 때 (거의 안 씀)<tr><td><strong>Index NLJ</strong><td>Outer 행마다 Inner 인덱스 lookup<td>O(N × logM)<td>가장 일반적인 형태, Inner 테이블에 조인 키 인덱스 존재 (데이터가 적은 테이블을 outer, 많은 테이블을 inner로 두는 것이 효율적)<tr><td><strong>Block NLJ</strong><td>Outer 여러 행을 메모리에 담아 Inner 한 번 스캔<td>O(N × M) (buffer 최적화)<td>Inner에 인덱스 없음, <code class="language-plaintext highlighter-rouge">join_buffer_size</code> 활용<tr><td><strong>Batched Key Access</strong><td>Outer 여러 키를 모아 batch로 인덱스 lookup<td>O(N × logM) (batched)<td>MySQL 5.6+, <code class="language-plaintext highlighter-rouge">optimizer_switch='batched_key_access=on'</code><tr><td><strong>Hybrid / Pushdown 변형</strong><td>조건을 가능한 바깥 루프로 이동<td>N/A (상황 의존)<td><code class="language-plaintext highlighter-rouge">EXISTS</code>, <code class="language-plaintext highlighter-rouge">IN</code> 서브쿼리 최적화 등</table></div><p><strong>※ 참고 : Block NLJ는 더 이상 사용되지 않는다.</strong></p><blockquote><p><a href="https://docs.oracle.com/cd/E17952_01/mysql-8.0-en/mysql-nutshell.html">공식 문서</a> <code class="language-plaintext highlighter-rouge">Hash Join Optimization</code> 부분 참고</p></blockquote><ul><li>MySQL 8.0.20 버전 이후부터, Block Nested Loop가 더 이상 사용되지 않으며, 이전까지 Block Nested Loop이 사용되던 경우에는 언제나 Hash Join이 대신 사용된다.</ul><h2 id="inner-join과-nlj">INNER JOIN과 NLJ</h2><hr /><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">T1</span>
    <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">T2</span> <span class="k">ON</span> <span class="n">T1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">T2</span><span class="p">.</span><span class="n">id</span>
    <span class="k">INNER</span> <span class="k">JOIN</span> <span class="n">T3</span> <span class="k">ON</span> <span class="n">T2</span><span class="p">.</span><span class="k">key</span> <span class="o">=</span> <span class="n">T3</span><span class="p">.</span><span class="k">key</span>
<span class="k">WHERE</span> <span class="n">T1</span><span class="p">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">100</span>
  <span class="k">AND</span> <span class="n">T2</span><span class="p">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">'ACTIVE'</span>
  <span class="k">AND</span> <span class="n">T3</span><span class="p">.</span><span class="k">type</span> <span class="o">=</span> <span class="s1">'X'</span><span class="p">;</span>
</pre></table></code></div></div><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">FOR</span> <span class="k">each</span> <span class="n">t1</span> <span class="k">in</span> <span class="n">T1</span> <span class="n">such</span> <span class="n">that</span> <span class="p">(</span><span class="n">t1</span><span class="p">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>    <span class="c1">-- T1에서 바로 필터링</span>
  <span class="k">FOR</span> <span class="k">each</span> <span class="n">t2</span> <span class="k">in</span> <span class="n">T2</span> <span class="n">such</span> <span class="n">that</span> <span class="p">(</span><span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span> <span class="k">AND</span> <span class="n">t2</span><span class="p">.</span><span class="n">status</span><span class="o">=</span><span class="s1">'ACTIVE'</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">-- T2 루프에서 바로 필터링</span>
    <span class="k">FOR</span> <span class="k">each</span> <span class="n">t3</span> <span class="k">in</span> <span class="n">T3</span> <span class="n">such</span> <span class="n">that</span> <span class="p">(</span><span class="n">t2</span><span class="p">.</span><span class="k">key</span> <span class="o">=</span> <span class="n">t3</span><span class="p">.</span><span class="k">key</span> <span class="k">AND</span> <span class="n">t3</span><span class="p">.</span><span class="k">type</span><span class="o">=</span><span class="s1">'X'</span><span class="p">)</span> <span class="p">{</span>     <span class="c1">-- T3 루프에서 바로 필터링</span>
      <span class="k">OUTPUT</span> <span class="n">t1</span><span class="o">||</span><span class="n">t2</span><span class="o">||</span><span class="n">t3</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><ul><li>INNER JOIN은 옵티마이저가 순서를 자유롭게 바꿀 수 있다. (<code class="language-plaintext highlighter-rouge">T1 → T2 → T3</code> or <code class="language-plaintext highlighter-rouge">T3 → T2 → T1</code> 등)</ul><h3 id="조건-푸시다운-condition-pushdown">조건 푸시다운 (Condition Pushdown)</h3><ul><li>WHERE 조건은 가능한 경우 바깥 루프로 올려 평가된다.<ul><li>조건이 참조하는 컬럼이 <strong>이미 읽혀 있는 테이블에만 의존한다면</strong>, 그 조건은 더 바깥쪽 루프로 끌어올려 평가할 수 있다.<li>이를 통해 각 단계에서 row 수를 줄여, 내부 루프의 불필요한 반복을 줄인다.<li>위 쿼리에서 <code class="language-plaintext highlighter-rouge">T1.value &gt; 100</code> 조건은, T1 테이블의 컬럼만 조건에 있으므로 T1을 읽는 가장 바깥 루프에서 바로 필터링 가능.</ul><li>푸시다운 불가능한 경우 : <code class="language-plaintext highlighter-rouge">T1.value &gt; T2.some_val</code><ul><li>두 테이블이 모두 읽힌 뒤에만 평가 가능.</ul></ul><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">FOR</span> <span class="k">each</span> <span class="n">t1</span> <span class="k">in</span> <span class="n">T1</span> <span class="p">{</span>
  <span class="k">FOR</span> <span class="k">each</span> <span class="n">t2</span> <span class="k">in</span> <span class="n">T2</span> <span class="n">such</span> <span class="n">that</span> <span class="p">(</span><span class="n">T1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">T2</span><span class="p">.</span><span class="n">id</span> <span class="k">AND</span> <span class="n">T1</span><span class="p">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="n">T2</span><span class="p">.</span><span class="n">some_val</span><span class="p">)</span> <span class="p">{</span>
    <span class="p">...</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><ul><li>WHERE 절에 있는 조건들을 보고, 어떤 조건을 어느 시점에서 평가해야 가장 효율적인지 INNER JOIN / OUTER JOIN의 제약 조건을 만족하면서 푸시 가능한지를 옵티마이저가 판단한다.</ul><h2 id="outer-join과-nlj">OUTER JOIN과 NLJ</h2><hr /><ul><li>OUTER JOIN에서는 <strong>NULL 보완(NULL-complemented row)</strong>이 추가된다.<li>외부 테이블의 각 행에 대해 내부 테이블과 매칭이 없으면 NULL로 채운 행이 생성된다.<li>따라서 OUTER JOIN은 조인 순서가 강제된다. (외부 테이블이 반드시 바깥 루프에 위치)<li>매칭이 실제 발생했을 때만 조건을 적용해야 하기 때문에(매칭 없을 때는 NULL 보완 행을 살려야 하므로), INNER JOIN처럼 조건 푸시다운을 단순 적용할 수 없다.<ul><li>플래그(flag) 기반 조건부 푸시다운을 사용한다.</ul></ul><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">T1</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">T2</span> <span class="k">ON</span> <span class="n">T1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">T2</span><span class="p">.</span><span class="n">id</span> <span class="k">AND</span> <span class="n">T2</span><span class="p">.</span><span class="n">status</span> <span class="o">=</span> <span class="s1">'ACTIVE'</span> <span class="c1">-- C2</span>
    <span class="k">LEFT</span> <span class="k">JOIN</span> <span class="n">T3</span> <span class="k">ON</span> <span class="n">T2</span><span class="p">.</span><span class="k">key</span> <span class="o">=</span> <span class="n">T3</span><span class="p">.</span><span class="k">key</span> <span class="k">AND</span> <span class="n">T3</span><span class="p">.</span><span class="k">type</span> <span class="o">=</span> <span class="s1">'X'</span> <span class="c1">-- C3</span>
<span class="k">WHERE</span> <span class="n">T1</span><span class="p">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">;</span> <span class="c1">-- C1</span>
</pre></table></code></div></div><div class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="k">FOR</span> <span class="k">each</span> <span class="n">t1</span> <span class="k">in</span> <span class="n">T1</span> <span class="n">such</span> <span class="n">that</span> <span class="p">(</span><span class="n">t1</span><span class="p">.</span><span class="n">value</span> <span class="o">&gt;</span> <span class="mi">100</span><span class="p">)</span> <span class="p">{</span>   <span class="c1">-- C1은 T1에서 바로 평가 가능</span>
  <span class="n">f1</span> <span class="p">:</span><span class="o">=</span> <span class="k">FALSE</span>   <span class="c1">-- t1이 T2와 매칭됐는지 여부</span>

  <span class="k">FOR</span> <span class="k">each</span> <span class="n">t2</span> <span class="k">in</span> <span class="n">T2</span> <span class="n">such</span> <span class="n">that</span> <span class="p">(</span><span class="n">t1</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">t2</span><span class="p">.</span><span class="n">id</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">f2</span> <span class="p">:</span><span class="o">=</span> <span class="k">FALSE</span>   <span class="c1">-- (t1,t2)가 T3와 매칭됐는지 여부</span>

    <span class="k">FOR</span> <span class="k">each</span> <span class="n">t3</span> <span class="k">in</span> <span class="n">T3</span> <span class="n">such</span> <span class="n">that</span> <span class="p">(</span><span class="n">t2</span><span class="p">.</span><span class="k">key</span> <span class="o">=</span> <span class="n">t3</span><span class="p">.</span><span class="k">key</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">IF</span> <span class="p">(</span><span class="n">t2</span><span class="p">.</span><span class="n">status</span><span class="o">=</span><span class="s1">'ACTIVE'</span> <span class="k">AND</span> <span class="n">t3</span><span class="p">.</span><span class="k">type</span><span class="o">=</span><span class="s1">'X'</span><span class="p">)</span> <span class="p">{</span>   <span class="c1">-- 매칭된 경우에만 조건 검사</span>
        <span class="k">OUTPUT</span> <span class="n">t1</span><span class="o">||</span><span class="n">t2</span><span class="o">||</span><span class="n">t3</span>
      <span class="p">}</span>
      <span class="n">f2</span> <span class="o">=</span> <span class="k">TRUE</span>
      <span class="n">f1</span> <span class="o">=</span> <span class="k">TRUE</span>
    <span class="p">}</span>

    <span class="n">IF</span> <span class="o">!</span><span class="n">f2</span> <span class="p">{</span>   <span class="c1">-- T3 매칭이 없을 때</span>
      <span class="n">IF</span> <span class="p">(</span><span class="n">t2</span><span class="p">.</span><span class="n">status</span><span class="o">=</span><span class="s1">'ACTIVE'</span><span class="p">)</span> <span class="p">{</span>   <span class="c1">-- T2 매칭은 있었으므로, 조건부 평가</span>
        <span class="k">OUTPUT</span> <span class="n">t1</span><span class="o">||</span><span class="n">t2</span><span class="o">||</span><span class="k">NULL</span>
      <span class="p">}</span>
      <span class="n">f1</span> <span class="o">=</span> <span class="k">TRUE</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">IF</span> <span class="o">!</span><span class="n">f1</span> <span class="p">{</span>   <span class="c1">-- T2 매칭이 아예 없을 때</span>
    <span class="k">OUTPUT</span> <span class="n">t1</span><span class="o">||</span><span class="k">NULL</span><span class="o">||</span><span class="k">NULL</span>   <span class="c1">-- T2, T3 NULL 보완 행 출력</span>
    <span class="c1">-- 단, WHERE 조건에서 C2, C3는 평가하지 않음 (NULL 보완이므로 무조건 통과)</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="정리">정리</h2><hr /><blockquote><p>JOIN 사용시 생각해볼만한 것들</p></blockquote><ul><li>inner 테이블을 인덱스 탐색하는지, outer / inner 순서는 적절한지 확인하자.<li>가능하면 푸시다운이 잘 적용(최대한 많은 행을 사전 필터링)될 수 있도록 WHERE 조건을 구성하자.<ul><li>즉, WHERE 조건이 최대한 일찍(outer 루프) 평가될 수 있도록</ul><li>OUTER JOIN 사용시:<ul><li><code class="language-plaintext highlighter-rouge">이 조인에서 NULL 보완이 정말 필요한지</code>, <code class="language-plaintext highlighter-rouge">WHERE 조건 때문에 어차피 INNER JOIN처럼 동작하지 않는지</code> 생각해보자.<li>가능하면 INNER JOIN으로 단순화해서 옵티마이저가 <strong>조인 순서 최적화, 조건 푸시다운</strong>을 최대한 활용하도록 유도.<li><strong>즉, OUTER JOIN이 정말 필요한지</strong> 생각해보자.</ul></ul><h2 id="참고-자료">참고 자료</h2><hr /><ul><li><a href="https://dev.mysql.com/doc/refman/8.4/en/nested-loop-joins.html">https://dev.mysql.com/doc/refman/8.4/en/nested-loop-joins.html</a><li><a href="https://dev.mysql.com/doc/refman/8.4/en/nested-join-optimization.html">https://dev.mysql.com/doc/refman/8.4/en/nested-join-optimization.html</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/%EC%A7%80%EC%8B%9D-%EB%8D%94%ED%95%98%EA%B8%B0/'>지식 더하기</a>, <a href='/categories/%EC%9D%B4%EB%A1%A0/'>이론</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/mysql/" class="post-tag no-text-decoration" >MySQL</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MySQL - Nested-Loop Join 알아보기 - zz9z9&url=https://zz9z9.github.io/posts/mysql-nested-loop-join/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MySQL - Nested-Loop Join 알아보기 - zz9z9&u=https://zz9z9.github.io/posts/mysql-nested-loop-join/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=MySQL - Nested-Loop Join 알아보기 - zz9z9&url=https://zz9z9.github.io/posts/mysql-nested-loop-join/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/jpa-entity-manager-persistence-context/">EntityManager와 영속성 컨텍스트</a><li><a href="/posts/jpa-id-generation-strategy/">JPA/Hibernate ID 생성 전략</a><li><a href="/posts/aws-vpc/">AWS VPC(Virtual Private Cloud) - 기초 개념</a><li><a href="/posts/aws-efs/">AWS EFS(Elastic File System) - 기초 개념</a><li><a href="/posts/aws-intro/">AWS - 상품 살펴보기</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/mysql/">MySQL</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/web/">WEB</a> <a class="post-tag" href="/tags/infra/">Infra</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/http/">HTTP</a> <a class="post-tag" href="/tags/spring-batch/">Spring Batch</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/transaction-and-isolation-level/"><div class="card-body"> <span class="timeago small" > Aug 24, 2021 <i class="unloaded">2021-08-24T23:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MySQL - 트랜잭션과 격리 수준</h3><div class="text-muted small"><p> 트랜잭션과 ACID 트랜잭션이란 ? 데이터베이스 상태를 변경시키는 일련의 연산들을 논리적으로 묶을 수 있는 하나의 작업 단위 ex) 주문 - 결제 - 결제 승인 - 주문 접수 트랜잭션에는 중요한 두 가지 목적이 있다. ...</p></div></div></a></div><div class="card"> <a href="/posts/data-modeling/"><div class="card-body"> <span class="timeago small" > Aug 25, 2021 <i class="unloaded">2021-08-25T23:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MySQL - 데이터 모델링</h3><div class="text-muted small"><p> 들어가기 전 애플리케이션을 설계할 때 ‘DB 테이블은 어떻게 구성해야하지?’ 에 대한 막막함이 있다면 데이터 모델링이 문제 해결의 출발점이라고 생각한다. 공부를 하기에 앞서 나의 언어로 정리해본다면 내가 생각하기에 모델링이라는 것은 먼저 문자 그대로 ‘모델화’ 시킨다는 것인데, 모델이란 ‘어떤 대상을 필요한 특징만 추려서 나타낸 것’ 이라는 생...</p></div></div></a></div><div class="card"> <a href="/posts/mysql-architecture/"><div class="card-body"> <span class="timeago small" > Oct 6, 2021 <i class="unloaded">2021-10-06T23:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>MySQL - MySQL 내부 구조 간단히 살펴보기</h3><div class="text-muted small"><p> 들어가기 전 슬로우 쿼리를 고쳐보고 싶은데 고치려면 어떻게 해야할지에 대한 지식이 전혀없다. 근데 슬로우 쿼리는 차치하고, 쿼리가 어떻게 동작하고 DB 내부는 어떻게 생긴지에 대해서도 공부해보지 않았다. 그래서 먼저 MySQL을 기준으로 내부 구조가 어떤지 세부적인 내용을 제외하고 간단하게 정리해보려고 한다. MySQL의 전체적인 구조 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/daily-note-250923/" class="btn btn-outline-primary" prompt="Older"><p>오늘 드는 생각 (250923, 정답)</p></a> <a href="/posts/mysql-hash-join/" class="btn btn-outline-primary" prompt="Newer"><p>MySQL - Hash Join 알아보기</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://twitter.com/username">Lee JaeYoon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/mysql/">MySQL</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/web/">WEB</a> <a class="post-tag" href="/tags/infra/">Infra</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/http/">HTTP</a> <a class="post-tag" href="/tags/spring-batch/">Spring Batch</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://zz9z9.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
