<!DOCTYPE html><html lang="en-US" mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="MSA 기반의 회사 프로젝트에 단위 테스트 코드 적용하기" /><meta property="og:locale" content="en_US" /><meta name="description" content="들어가기 전 부끄러운 얘기지만 내가 회사에서 경험했던 프로젝트에는 테스트 코드가 없었다. 제작 당시 테스트 코드 작성에 대한 얘기가 아예 나오지 않았던 것은 아니지만, 당시 여론은 ‘제작 기간 맞추기도 쉽지 않은데 언제 그걸 하고 앉아있냐’라는 의견이 주를 이뤘다. 나 또한 테스트 코드의 중요성에 대해 잘 알지 못했고, 빡빡한 제작기간으로 인해 밥먹듯이 야근을 해댔기 때문에 개발기간 맞추기에만 급급했던 것 같다." /><meta property="og:description" content="들어가기 전 부끄러운 얘기지만 내가 회사에서 경험했던 프로젝트에는 테스트 코드가 없었다. 제작 당시 테스트 코드 작성에 대한 얘기가 아예 나오지 않았던 것은 아니지만, 당시 여론은 ‘제작 기간 맞추기도 쉽지 않은데 언제 그걸 하고 앉아있냐’라는 의견이 주를 이뤘다. 나 또한 테스트 코드의 중요성에 대해 잘 알지 못했고, 빡빡한 제작기간으로 인해 밥먹듯이 야근을 해댔기 때문에 개발기간 맞추기에만 급급했던 것 같다." /><link rel="canonical" href="https://zz9z9.github.io/posts/applying-unit-test-code-in-company/" /><meta property="og:url" content="https://zz9z9.github.io/posts/applying-unit-test-code-in-company/" /><meta property="og:site_name" content="zz9z9" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-07-13T22:25:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="MSA 기반의 회사 프로젝트에 단위 테스트 코드 적용하기" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-11-09T14:44:11+09:00","datePublished":"2021-07-13T22:25:00+09:00","description":"들어가기 전 부끄러운 얘기지만 내가 회사에서 경험했던 프로젝트에는 테스트 코드가 없었다. 제작 당시 테스트 코드 작성에 대한 얘기가 아예 나오지 않았던 것은 아니지만, 당시 여론은 ‘제작 기간 맞추기도 쉽지 않은데 언제 그걸 하고 앉아있냐’라는 의견이 주를 이뤘다. 나 또한 테스트 코드의 중요성에 대해 잘 알지 못했고, 빡빡한 제작기간으로 인해 밥먹듯이 야근을 해댔기 때문에 개발기간 맞추기에만 급급했던 것 같다.","headline":"MSA 기반의 회사 프로젝트에 단위 테스트 코드 적용하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://zz9z9.github.io/posts/applying-unit-test-code-in-company/"},"url":"https://zz9z9.github.io/posts/applying-unit-test-code-in-company/"}</script><title>MSA 기반의 회사 프로젝트에 단위 테스트 코드 적용하기 | zz9z9</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="zz9z9"><meta name="application-name" content="zz9z9"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-Q7PWLG5WYT"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-Q7PWLG5WYT'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d3/Soccerball.svg/1000px-Soccerball.svg.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">zz9z9</a></div><div class="site-subtitle font-italic">거창한 계획보다는, 꾸준한 실행을</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/zz9z9" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['example','doamin.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>MSA 기반의 회사 프로젝트에 단위 테스트 코드 적용하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>MSA 기반의 회사 프로젝트에 단위 테스트 코드 적용하기</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Lee JaeYoon </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Jul 13, 2021, 10:25 PM +0900" prep="on" > Jul 13, 2021 <i class="unloaded">2021-07-13T22:25:00+09:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Nov 9, 2024, 2:44 PM +0900" prefix="Updated " > Nov 9, 2024 <i class="unloaded">2024-11-09T14:44:11+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1528 words">8 min</span></div></div><div class="post-content"><h1 id="들어가기-전">들어가기 전</h1><hr /><p>부끄러운 얘기지만 내가 회사에서 경험했던 프로젝트에는 테스트 코드가 없었다. 제작 당시 테스트 코드 작성에 대한 얘기가 아예 나오지 않았던 것은 아니지만, 당시 여론은 ‘제작 기간 맞추기도 쉽지 않은데 언제 그걸 하고 앉아있냐’라는 의견이 주를 이뤘다. 나 또한 테스트 코드의 중요성에 대해 잘 알지 못했고, 빡빡한 제작기간으로 인해 밥먹듯이 야근을 해댔기 때문에 개발기간 맞추기에만 급급했던 것 같다. <br /><br /></p><p>개발, 테스트 기간을 거쳐 시스템을 가동했고, 다양한 에러들이 터져나오며 정말 밤낮으로 디버깅을 했다. 어떤 문제에 대한 디버깅이 해당 문제는 해결했지만, 기존에 잘 동작하고 있던 부분에 영향을 미쳐서 또 다른 문제를 발생시키는 경우가 상당히 많았다. 여기서 나는 테스트 코드 작성을 하지 않은 것에 대한 댓가(?)를 치루는 것 같았다. <br /><br /></p><p>폭풍같은 시간들이 지나고 현재는 나름대로 안정화가 되어 운영을 하고 있지만, 여전히 테스트 코드의 부재는 코드를 리팩토링을 한다거나 새로운 요구사항에 대한 코드를 추가했을 때, 자동화된 테스트를 할 수 없으며 일일이 손으로 테스트를 해야한다는 불편함이 있다. <br /><br /></p><p>따라서 나는 지금이라도 테스트 코드를 작성해야겠다고 생각했고, 마이크로서비스 환경에서 <a href="https://zz9z9.github.io/posts/msa-testing-part1/">단위 테스트하는 방법을 공부</a>한 뒤 회사 프로젝트에 적용해보았다.</p><h1 id="단위-테스트-코드-작성하기">단위 테스트 코드 작성하기</h1><hr /><h2 id="적용-범위">적용 범위</h2><ul><li>일단은 가장 핵심이 되는 비즈니스 로직(스프링 기준으로 ServiceImpl)들에 적용을 해보았다.<li>컨트롤러와 이벤트/메시지 핸들러 테스트는 추후에 적용해보고 내용을 추가할 예정이다.</ul><h2 id="무엇을-검증할-것인가-">무엇을 검증할 것인가 ?</h2><ul><li>일단 내가 속한 팀의 비즈니스 로직 특성은 일반적으로 다음과 같다.<ul><li>하나 이상의 마이크로서비스에서 데이터를 조회해온 뒤 데이터를 가공한다.<li>가공한 데이터를 하나 이상의 서비스에 CUD(CREATE / UPDATE / DELETE) 처리를 한다.<li>타서비스와 통신하는 방식에는 크게 두 가지가 있다.<ul><li>R(조회) : Rest API<li>CUD : 메시지 (브로커 : Kafka)</ul></ul><li>위 특징을 기반으로, 비즈니스 로직에서 검증해야 할 것들은 다음과 같다고 생각했다.<ul><li>데이터 조회를 위해 특정 서비스를 호출했는지<li>조회할 때 필요한 항목이 세팅이 됐는지<li>타서비스에 CUD 처리를 위해 발행하는 이벤트에 데이터가 제대로 세팅이 되었는지<ul><li>검증 데이터 : 토픽명, 반드시 세팅되어야 할 항목의 값 등</ul><li>잘못된 데이터가 들어왔을 때, 적절한 예외를 발생시키는지</ul></ul><h2 id="어떻게-검증할-것인가-">어떻게 검증할 것인가 ?</h2><ol><li>데이터 조회를 위해 특정 서비스를 호출했는지<ul><li>Mockito를 활용해서 타서비스를 호출하는 OtherServiceProxy 부분을 모킹하고, 조회 메서드 호출시 기대한 데이터를 반환하도록 스텁화한다.<li>verify를 통해 해당 메서드가 호출되었는지 확인한다. <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="https://user-images.githubusercontent.com/64415489/126074578-7f7c72a8-21b3-43c3-a531-4cdddcc2e832.png" width="90%" /></ul><li>조회할 때 필요한 항목이 세팅이 됐는지<ul><li>단순 값인 경우 Mockito의 ArgumentMatchers eq() 활용</ul><li>타서비스에 CUD 처리를 위해 발행하는 이벤트에 데이터가 제대로 세팅이 되었는지<ul><li>Mockito의 ArgumentCaptor 활용</ul></ol><h2 id="적용-코드">적용 코드</h2><blockquote><p>실제 회사 코드를 첨부할 수는 없기 때문에, 대략적인 흐름을 파악할 수 있는 코드를 작성했다. 이렇게 하는게 맞는지는 모르겠으나, 최소한 없을 때 보다는 리팩토링 할 때 좀 더 안전하게 할 수 있을것 같다. 추후에 더 공부하고 새로운 것들을 알게되면 보완할 예정이다.</p></blockquote><div class="language-java highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">CoreServiceImplTest</span> <span class="o">{</span>

    <span class="nd">@Mock</span>
    <span class="kd">private</span> <span class="nc">AServiceProxy</span> <span class="n">aServiceProxy</span><span class="o">;</span>
    <span class="nd">@Mock</span>
    <span class="kd">private</span> <span class="nc">BServiceProxy</span> <span class="n">bServiceProxy</span><span class="o">;</span>
    <span class="nd">@InjectMocks</span>
    <span class="kd">private</span> <span class="nc">CoreServiceImpl</span> <span class="n">logic</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Object</span><span class="o">&gt;</span> <span class="n">inputMessage</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">HashMap</span><span class="o">&lt;&gt;();</span>

    <span class="kd">private</span> <span class="nc">AServiceData</span> <span class="nf">getAServiceSampleData</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">AServiceData</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AServiceData</span><span class="o">();</span>
        <span class="n">data</span> <span class="n">세팅</span> <span class="o">...</span>

        <span class="k">return</span> <span class="n">data</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="nc">BServiceData</span> <span class="nf">getBServiceSampleData</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">BServiceData</span> <span class="n">data</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">BServiceData</span><span class="o">();</span>
        <span class="n">data</span> <span class="n">세팅</span> <span class="o">...</span>

        <span class="k">return</span> <span class="n">data</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initInputMsg</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">inputMessage에</span> <span class="n">값</span> <span class="n">세팅</span><span class="o">...</span>
    <span class="o">}</span>

    <span class="kd">private</span> <span class="kt">void</span> <span class="nf">initStub</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">when</span><span class="o">(</span><span class="n">aServiceProxy</span><span class="o">.</span><span class="na">조회메서드</span><span class="o">(</span><span class="n">eq</span><span class="o">(</span><span class="n">value1</span><span class="o">),</span> <span class="n">eq</span><span class="o">(</span><span class="n">value2</span><span class="o">),</span> <span class="n">isNull</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">thenReturn</span><span class="o">(</span><span class="n">getAServiceSampleData</span><span class="o">);</span>

        <span class="n">when</span><span class="o">(</span><span class="n">bServiceProxy</span><span class="o">.</span><span class="na">조회메서드</span><span class="o">(</span><span class="n">anyList</span><span class="o">())</span>
                <span class="o">.</span><span class="na">thenReturn</span><span class="o">(</span><span class="n">getBServiceSampleData</span><span class="o">);</span>
    <span class="o">}</span>


    <span class="nd">@Before</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">initMock</span><span class="o">()</span> <span class="o">{</span>
        <span class="nc">MockitoAnnotations</span><span class="o">.</span><span class="na">initMocks</span><span class="o">(</span><span class="k">this</span><span class="o">);</span>
        <span class="n">initInputMsg</span><span class="o">();</span>
        <span class="n">initStub</span><span class="o">();</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">타서비스_테이블에_저장</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">logic</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">inputMessage</span><span class="o">);</span>

        <span class="nc">ArgumentCaptor</span><span class="o">&lt;</span><span class="nc">SaveData</span><span class="o">&gt;</span> <span class="n">captor</span> <span class="o">=</span> <span class="nc">ArgumentCaptor</span><span class="o">.</span><span class="na">forClass</span><span class="o">(</span><span class="nc">SaveData</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="n">verify</span><span class="o">(</span><span class="n">aServiceProxy</span><span class="o">).</span><span class="na">저장메서드</span><span class="o">(</span><span class="n">captor</span><span class="o">.</span><span class="na">capture</span><span class="o">());</span>

        <span class="nc">SaveData</span> <span class="n">data</span> <span class="o">=</span> <span class="n">captor</span><span class="o">.</span><span class="na">getValue</span><span class="o">();</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">data</span><span class="o">).</span><span class="na">isNotNull</span><span class="o">();</span>
        <span class="n">assertThat</span><span class="o">(</span><span class="n">저장한</span> <span class="n">데이터의</span> <span class="n">값</span><span class="o">).</span><span class="na">isEqualTo</span><span class="o">(</span><span class="n">기대하는</span> <span class="n">값</span><span class="o">);</span>
        <span class="o">.</span>
        <span class="o">.</span>
        <span class="o">.</span>
    <span class="o">}</span>

    <span class="nd">@Test</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="n">조회결과_없는경우_예외처리</span><span class="o">()</span> <span class="o">{</span>
        <span class="n">when</span><span class="o">(</span><span class="n">aServiceProxy</span><span class="o">.</span><span class="na">조회메서드</span><span class="o">(</span><span class="n">eq</span><span class="o">(</span><span class="n">value1</span><span class="o">),</span> <span class="n">eq</span><span class="o">(</span><span class="n">value2</span><span class="o">),</span> <span class="n">isNull</span><span class="o">()))</span>
                <span class="o">.</span><span class="na">thenReturn</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>

        <span class="n">assertThrownBy</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="n">logic</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="n">inputMessage</span><span class="o">).</span><span class="na">isInstanceOf</span><span class="o">(</span><span class="n">특정Exception</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>

<span class="c1">// 이하생략...</span>

<span class="o">}</span>
</pre></table></code></div></div><h1 id="느낀점">느낀점</h1><hr /><ul><li>개발하는 도메인을 제대로 파악하지 못한다면 어떤 값이 중요한지, 어떤 값을 검증해야 할지 잘 모르기 때문에 제대로된 테스트 코드 작성이 어려울 것 같다.<li>메서드는 최대한 나눠져 있는게 테스트하기에 수월한 것 같다.<li>꾸준히 연습하자.</ul><h1 id="더-공부할-부분">더 공부할 부분</h1><hr /><ul><li>@RunWith(MockitoJUnitRunner.class) vs initMock()<li>JUnit5</ul></div><div class="post-tail-wrapper text-muted"><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=MSA 기반의 회사 프로젝트에 단위 테스트 코드 적용하기 - zz9z9&url=https://zz9z9.github.io/posts/applying-unit-test-code-in-company/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=MSA 기반의 회사 프로젝트에 단위 테스트 코드 적용하기 - zz9z9&u=https://zz9z9.github.io/posts/applying-unit-test-code-in-company/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=MSA 기반의 회사 프로젝트에 단위 테스트 코드 적용하기 - zz9z9&url=https://zz9z9.github.io/posts/applying-unit-test-code-in-company/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/jpa-entity-manager-persistence-context/">EntityManager와 영속성 컨텍스트</a><li><a href="/posts/jpa-id-generation-strategy/">JPA/Hibernate ID 생성 전략</a><li><a href="/posts/aws-vpc/">AWS VPC(Virtual Private Cloud) - 기초 개념</a><li><a href="/posts/aws-efs/">AWS EFS(Elastic File System) - 기초 개념</a><li><a href="/posts/aws-intro/">AWS - 상품 살펴보기</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/mysql/">MySQL</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/web/">WEB</a> <a class="post-tag" href="/tags/infra/">Infra</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/http/">HTTP</a> <a class="post-tag" href="/tags/spring-batch/">Spring Batch</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/cautions-when-jpa-mybatis-together/"><div class="card-body"> <span class="timeago small" > Feb 10 <i class="unloaded">2026-02-10T22:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JPA / MyBatis 혼용시 주의사항 (in 배치 애플리케이션)</h3><div class="text-muted small"><p> JPA와 MyBatis는 서로의 존재를 모른다. MyBatis는 JDBC를 직접 사용하므로 JPA 영속성 컨텍스트를 우회하여 DB를 변경하고, JPA는 이를 감지할 수 없다. 결과적으로 JPA 1차 캐시에는 변경 전 데이터(stale data)가 남게 되어 데이터 불일치가 발생한다. 문제 상황 예시 1. 같은 엔티티를 JPA로 읽고 ...</p></div></div></a></div><div class="card"> <a href="/posts/how-jpa-item-writer-merge-works/"><div class="card-body"> <span class="timeago small" > Jan 29 <i class="unloaded">2026-01-29T23:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>이슈 - JpaItemWriter로 엔티티 저장시, ChunkSize만큼 SELECT 쿼리 발생하는 상황</h3><div class="text-muted small"><p> 상황 배치 애플리케이션에서 A 테이블에서 조회 -&gt; 가공 -&gt; B 테이블에 저장 흐름으로 동작하는 청크 기반의 Job이 있음 B 테이블에 저장시 JpaItemWriter 사용 B 테이블에 저장하는 엔티티의 PK는 A 테이블의 PK와 동일. 즉, A 테이블에서 조회한 엔티티의 PK가 사용됨 (Assigned ID + @Vers...</p></div></div></a></div><div class="card"> <a href="/posts/jpa-id-generation-strategy/"><div class="card-body"> <span class="timeago small" > Jan 29 <i class="unloaded">2026-01-29T23:00:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JPA/Hibernate ID 생성 전략</h3><div class="text-muted small"><p> @GeneratedValue 기본 키(primary key) 값의 생성 전략을 지정하는 데 사용 즉, 데이터베이스에 새 레코드를 삽입할 때 기본 키 값을 자동으로 생성하는 방법을 지정 @GeneratedValue는 @Id와 함께 엔티티 또는 매핑된 슈퍼클래스의 기본 키 속성이나 필드에 적용할 수 있다. @GeneratedValu...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/msa-testing-part2/" class="btn btn-outline-primary" prompt="Older"><p>MSA 환경에서 테스트하기(2) - 통합 테스트</p></a> <a href="/posts/kafka-introduction/" class="btn btn-outline-primary" prompt="Newer"><p>카프카 개요</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://twitter.com/username">Lee JaeYoon</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/mysql/">MySQL</a> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/web/">WEB</a> <a class="post-tag" href="/tags/infra/">Infra</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/http/">HTTP</a> <a class="post-tag" href="/tags/spring-batch/">Spring Batch</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://zz9z9.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
